var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=15)}({15:function(e,t,i){"use strict";var n,o,r;i.r(t),function(e){e[e.u=0]="msoulscat_ES_EWAJS",e[e.h=1]="msoulscat_ES_EWAJSGrid",e[e.v=6]="msoulscat_ES_EWAJSChart",e[e.g=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=225]="msoulscat_MSOSP_OTelJS",e[e.O=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.A=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.F=301]="msoulscat_Wac_WordViewer",e[e.R=306]="msoulscat_Wac_BrowserGeneral",e[e.P=320]="msoulscat_Wac_TaskPane",e[e.U=339]="msoulscat_Wac_OneNoteGeneral",e[e.N=340]="msoulscat_Wac_Ribbon",e[e.k=379]="msoulscat_Wac_WopiPendingApplication",e[e.H=383]="msoulscat_Wac_Telemetry",e[e.J=391]="msoulscat_Wac_WacCatchUpActivities",e[e.B=394]="msoulscat_Wac_Dictation",e[e.j=395]="msoulscat_Wac_OneNoteSync",e[e.q=700]="msoulscat_Wac_VisioApp",e[e.K=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.X=800]="msoulscat_Wac_PptAnimation",e[e.$=833]="msoulscat_Wac_PptLive",e[e.Z=834]="msoulscat_Wac_PptMWeb",e[e.Y=844]="msoulscat_Wac_PptDataSync",e[e.ee=815]="msoulscat_Wac_PptShape",e[e.te=817]="msoulscat_Wac_PptSession",e[e.ie=830]="msoulscat_Wac_PptSlideshow",e[e.ne=822]="msoulscat_Wac_PptView",e[e.oe=2300]="msoulscat_Wac_VersionHistory",e[e.re=302]="msoulscat_Wac_WordPresence",e[e.se=3005]="msoulscat_Wac_WordVersionHistory",e[e.ae=3006]="msoulscat_Wac_LivePersonaCard",e[e.ce=3012]="msoulscat_Wac_CatchUpFlyout",e[e.ue=3016]="msoulscat_Wac_WordDesigner",e[e.le=3021]="msoulscat_Wac_ModernFontPicker",e[e.fe=3027]="msoulscat_Wac_UnifiedUiHost",e[e.he=3033]="msoulscat_Wac_EquationTools",e[e.pe=1401]="msoulscat_Osf_Latency",e[e.ve=1402]="msoulscat_Osf_Notification",e[e.me=1403]="msoulscat_Osf_Runtime",e[e.we=3041]="msoulscat_Wac_AiMaker"}(n||(n={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(r||(r={}));var s=window.navigator,a=s?s.userAgent:void 0;function c(){if(a){if(a.indexOf("Firefox")>-1)return r.Firefox;if(a.indexOf("Opera")>-1||a.indexOf("OPR")>-1)return r.Opera;if(a.indexOf("Trident")>-1)return r.IE;if(a.indexOf("Electron")>-1&&a.indexOf("Teams")>-1)return r.TeamsElectron;if(a.indexOf("Edg")>-1)return r.Edge;if(a.indexOf("Chrome")>-1)return r.Chrome;if(a.indexOf("Safari")>-1)return r.Safari}return r.Unknown}function u(){"undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}})}function l(){try{return!!a&&a.indexOf("iPad")>=0||!!a&&a.indexOf("Macintosh")>=0&&v()&&!p()||!!a&&a.indexOf("Android")>=0||v()}catch(e){return!1}}function f(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function d(){return c()===r.IE&&!function(){if(c()!==r.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function h(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function p(){return!!a&&a.indexOf("iPhone")>=0}function v(){return!!s&&s.maxTouchPoints>0}var m=["eurppc"];function w(e){return 8===e.toLowerCase().indexOf("ffc")}function g(e){return 8===e.toLowerCase().indexOf("ppc")}function S(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function I(e,t){if(!t||-1===m.indexOf(t.toLowerCase()))return e;var i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?"".concat(i[1]).concat(t,"-").concat(i[3]):e}function b(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function _(e,t){var i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");var n=i[2];if(void 0===t)return n;if(t<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(t+1)).join(".")}function y(e,t,i){i&&(e[t.toLowerCase()]=i)}function T(e,t){e[t.toLowerCase()]=""}function C(e,t){var i=e.toLowerCase(),n=t.toLowerCase(),o=i.indexOf("&"+n+"=");if(-1===o&&(o=i.indexOf("?"+n+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function E(e,t,i,n){if(!i)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==s&&c){if(n){var u=c.index+1,l=o.indexOf("&",u);o=o.substring(0,u)+a+i+(-1===l?"":o.substring(l))}return o}return o.concat(s,a,i)}function O(e){var t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}})),t}function A(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),i=e.lastIndexOf("/",t);if(-1!==i&&i+1===e.indexOf("://")+"://".length)return"";i+=1;var n=e.indexOf("?");if(-1!==(n=n>=t?-1:n)&&i>n)return"";var o=-1===n?t:n;return i>=o?"":e.substring(i,o)}function F(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function R(e,t,i){var n=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(n);return!!o&&(!i||o[1]===i)}function P(e,t){var i=C(e,t);return i?decodeURI(i):i}function x(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function U(e,t){return{shouldPreload:function(t){return e(t)},preload:function(e,i,r,s){t(e,i,s).forEach((function(e){!function(e,t,i,r,s){var a=document.createElement("link");if(a.setAttribute("crossorigin","anonymous"),a.rel=M,a.href=e,t){var c=i||A(e);t.ULS.ge(561059910,n.k,o.Info,"Preloading resource: ".concat(c));a.addEventListener("error",(function(){t.ULS.ge(561059911,n.k,o.Error,"Resource failed to load: ".concat(c))}))}a.setAttribute("as","script"),r&&a.setAttribute("integrity",r);document.head.appendChild(a),s&&a.addEventListener("load",s,{once:!0})}(e[0],r,void 0,e[1])}))}}}var W,M=(W=c())===r.Firefox||W===r.IE?"prefetch":"preload";var N={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};function k(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}function H(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return J&&(!t||t(e))},preconnect:function(t){return k(e?F(t):t)}}}var D,J=!0;function B(e,t,i){if(t){var n=window.navigator;if(n&&n.sendBeacon)try{return void n.sendBeacon(t,e)}catch(e){}!function(e,t,i){var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,i),n.send(e))}(e,t,i)}}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(D||(D={}));var L= "16.0.16111.42306";function V(){return L}var j;function z(e,t,i){!function(e,t,i,n){void 0===n&&(n=!0);var o={type:t,payloadJson:JSON.stringify(i)};B(JSON.stringify(o),e,n)}(e,"JSAPI_STATE",{application:t,build:V(),state:i})}function G(e,t,i,n){var o=[],r=e.map((function(e){return function(e,t,i){var n={};if(n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category,e.correlationId){var o=i.findIndex((function(t){return t===e.correlationId}));o<0&&(o=i.push(e.correlationId)-1),n.I=o}var r=1e3*e.type+e.level;return n.D=r,n}(e,n,o)})),s=function(e,t,i,n,o){var r={};r.T=e,r.L=t,r.S=i,r.I=n,o&&o.length>0&&(r.W=o);return r.V=1,r}(n,r,t,i,o);return JSON.stringify(s)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(j||(j={}));var q,K=function(){try{var e=window.performance;return e&&e.now&&e.now()!==1/0}catch(e){return!1}}();function X(){return K?window.performance.now():Date.now()}function $(){if(!q){var e=window.performance;q=K&&e.timing&&e.timing.navigationStart?function(){return Math.round(e.now()+e.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return q()}var Z,Q,Y=function(){function e(e){var t=this;this.Se=3e4,this.Ie=30,this.be=0,this._e=[],this.ye=$(),this.Te=[],this.Ce="",this.Ee=0,this.flushOnClose=function(){t.Oe(!1,!1)},this.flush=function(){t.Ae()},this.flushAndSetNewEndpoint=function(e){var i,n=t.Fe(e);n.localeCompare(null!==(i=t.Re)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(t.Te.push((function(){t.Re=n})),t.Oe(!0,!0))},this.Fe=function(e){return e+"?usid="+t.Ce+"&officeserverversion="+V()},this.Ae=function(){window.setTimeout((function(){return t.Oe(!0,!0)}),0)},this.Oe=function(e,i){var n=X();if(window.clearTimeout(t.Pe),t.Re){if(t._e.length>0)t.be+=1,B(G(t._e.splice(0,e?t.Ie:t._e.length),t.Ce,t.be,t.ye),t.Re,i),t.ye=$();0===t._e.length&&t.Te.length>0&&(t.Te.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.Te=[]),e&&(t.Pe=window.setTimeout((function(){t.Ae()}),t._e.length>t.Ie||t.Te.length>0?1e3:t.Se)),t.Ee+=X()-n}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Ee},e.prototype.addLoggingTime=function(e){this.Ee+=e},e.prototype.configure=function(e){var t=this,i=X();if(e.uploadCadenceInMs&&(this.Se=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.Ie=e.uploadTriggerSize),e.sessionId&&(this.Ce=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Re)throw new Error("Remote ULS endpoint is already set");this.Re=this.Fe(e.remoteUlsEndpoint),this.ye=$(),window.setTimeout((function(){return t.Oe(!0,!0)}),0)}this.Ee+=X()-i},e.prototype.handleTrace=function(e){var t=X();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this._e.push(e),(this._e.length>this.Ie||e.level===o.Error)&&this.Ae(),this.Ee+=X()-t},e}(),ee=[];!function(e){e.xe="BootstrapperMaxUlsHeartbeatTime",e.Ue="BootstrapperNoCompleteWarning1Time",e.We="BootstrapperNoCompleteWarning2Time",e.Me="RemoteUlsETag",e.Ne="RemoteUlsSuppressions",e.ke="BootstrapperSettingsFetchPeriod",e.He="timestamp",e.De="BootstrapperUlsHeartbeatIntervalMs",e.Je="BootstrapperUlsHeartBeatIsEnabled",e.Be="BootstrapperUlsUploadCadenceMs",e.Le="WordConsumptionViewToEditRedirectIsEnabled",e.Ve="RequestedCallThrottlingDefaultToViewMinimumValue",e.je="BulsEndpointUrl"}(Q||(Q={}));var te;function ie(e){var t=new Y(e);function i(e,i,n,o){var r=X();if(!function(e){return 1===ee[e]}(e)){var s={timestamp:$(),category:i,tag:e,level:n,type:j.Trace,message:o,correlationId:""};t.addLoggingTime(X()-r),t.handleTrace(s)}}return{ULS:{ge:function(e,t,n,o){i(e,t,n,o)},shipAssertTag:function(e,t,n,r){n&&i(e,t,o.Error,r)},debugAssertTag:function(e,t,i,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var i,n;i=e.ze.getValue(Q.Ne,""),n=e.ze.getValue(Q.Me,""),Z&&n===Z||(ee=[],Z=n,i&&i.split(",").forEach((function(e){var t=parseInt(e,10);t&&(ee[t]=1)}))),t.configure({uploadCadenceInMs:e.ze.getValue(Q.Be,6e4)});var o=e.ze.getValue(Q.je,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},flushAndSetNewEndpoint:function(e){t.flushAndSetNewEndpoint(e)}}}function ne(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function oe(e){return JSON.stringify(e,Object.getOwnPropertyNames(e))}function re(e,t){return{isFeatureEnabled:function(i){return function(e,t,i){if(!t)return;try{return t(e)}catch(e){i&&i.ULS.ge(594883024,n.k,o.Error,"IsFeatureEnabled callback error: "+oe(e))}return}(i,e,t)}}}function se(e,t){var i={};if(Object.keys(te).forEach((function(t){var n=e.isFeatureEnabled(te[t]);void 0!==n&&(i[te[t]]=n?"1":"0")})),t&&t.wdFlights)for(var n=0,o=t.wdFlights.toLowerCase().split(",");n<o.length;n++){var r=o[n];"et-treatment"!==r&&"et-control"!==r||(i[te.Ge]="et-treatment"===r?"1":"0")}return JSON.stringify(i)}!function(e){e.Ge="EnterpriseTemplates",e.qe="ExcelAdaptiveLayoutDownload",e.Ke="ExcelLandingPageOfflineTelemetry",e.Xe="ExcelLandingPageObserverRetry",e.$e="H2StaticContent",e.Ze="HashedUrl",e.Qe="ODCShareLinkPreload",e.Ye="OfficeComExcelJsApiV2",e.et="OfficeComPptJsApiV2",e.tt="OfficeComUiHost",e.nt="OfficeComWordJsApiV2",e.ot="OfficeHwaUiHost",e.rt="OfficeUnifiedUiHostTeams",e.st="WordViewToUnifiedRead"}(te||(te={}));var ae,ce,ue,le,fe,de,he=function(){function e(){this.ct=[]}return e.prototype.add=function(e){e&&this.ct.push(e)},e.prototype.remove=function(e){if(e){var t=this.ct.indexOf(e);t>-1&&this.ct.splice(t,1)}},e.prototype.removeAll=function(){this.ct=[]},e.prototype.dispatch=function(e,t){this.ct.forEach((function(i){try{i(e)}catch(e){t&&t(e)}}))},e}(),pe=function(){function e(e,t){var i=this;this.ut=0,this.lt=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(i.ft);if(!e)return;var t=JSON.parse(e);i.dt(t)}catch(e){i.ht.ULS.ge(592836768,n.k,o.Warning,"Failed to get settings from localStorage: "+oe(e))}},this.dt=function(e){return!!i.pt(e)&&(i.vt=e,i.wt.dispatch({ze:i},(function(e){i.ht.ULS.ge(592836769,n.k,o.Error,"Settings listener error: "+oe(e))})),!0)},this.pt=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(Q.He)&&!isNaN(e.timestamp))return!0;i.ht.ULS.ge(592836770,n.k,o.Error,"Received invalid settings")}return!1},this.gt=function(){if(i.St){var e=new XMLHttpRequest;e.open("GET",i.St),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(i.It(e.response),i.ut=0):(i.ht.ULS.ge(592836771,n.k,o.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(i.ut)),i.ut+=1),!(i.ut>7)){var t=i.getValue(Q.ke,3e5);i.ut>3&&(t+=(i.ut-3+1)*(t/2)),i.bt=window.setTimeout(i.gt,t)}}}},this.It=function(e){"requestIdleCallback"in window?(i._t&&self.cancelIdleCallback(i._t),i._t=window.requestIdleCallback((function(){return i.yt(e)}),{timeout:1e4})):window.setTimeout((function(){return i.yt(e)}),0)},this.yt=function(e){if(i.dt(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(i.ft,t)}catch(e){i.ht.ULS.ge(592836800,n.k,o.Warning,"Failed to set localStorage: "+oe(e))}}},this.Tt=e,this.ft="Prod"+e+"Settings",this.ht=t,this.wt=new he,this.lt()}return e.prototype.initializePeriodicFetch=function(e,t){this.ft=(w(e)?"FF":"Prod")+this.Tt+"Settings",this.lt(),this.St=e+"AppSettingsHandler.ashx?app="+this.Tt+"&usid="+t+"&build="+V(),this.bt||(this.bt=window.setTimeout(this.gt,3e4))},e.prototype.getValue=function(e,t){if(this.vt||this.lt(),!this.vt||!this.vt.hasOwnProperty(e))return t;var i=this.vt[e],n=typeof t;if(typeof i===n)return i;if("string"==typeof i){if("number"===n)return parseInt(i,10);if("boolean"===n)return"true"===i}return t},e.prototype.addSettingsChangeListener=function(e){this.wt.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.wt.remove(e)},e.prototype.dispose=function(){this.bt&&window.clearTimeout(this.bt),this._t&&self.cancelIdleCallback(this._t),this.bt=void 0,this._t=void 0,this.vt=void 0,this.wt.removeAll()},e}();!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete"}(ae||(ae={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared"}(ce||(ce={})),function(e){e.Ct="App_AccessibilityLoopComplete",e.Et="Wac_ActionComplete",e.Ot="WacInitialize_Ready",e.At="Wac_AppFailed",e.Ft="Wac_AppBootState",e.Rt="Wac_AppCompleted",e.Pt="BrowserEvent",e.xt="UI_Close",e.Ut="App_CloseTab",e.Wt="UI_Conversation",e.Mt="UI_CopyAndEdit",e.Nt="App_CreateNewDocument",e.kt="Wac_AppDataSavedStatus",e.Ht="UI_Download",e.Dt="UI_Edit",e.Jt="Error",e.Bt="UI_FileEmbed",e.Lt="UI_FileProperties",e.Vt="File_Rename",e.jt="File_RenameFailed",e.zt="UI_FileVersions",e.Gt="StateChanged",e.qt="App_IsFrameTrusted",e.Kt="GetAccessToken",e.Xt="App_GetAuthToken",e.$t="App_GetCustomAuthConfig",e.Zt="App_GetHostKeyValue",e.Qt="App_WopiInfoFromUrl",e.Yt="App_DavUrlFromIds",e.ei="App_LoadingStatus",e.ti="App_SwitchMode",e.ii="App_MoveToFolder",e.ni="UI_OpenInMobileApp",e.oi="UI_OpenInBrowser",e.ri="UI_OpenInClient",e.si="PageChanged",e.ai="App_PushCommentContext",e.ci="App_PushState",e.li="App_DocReboot",e.di="UI_RedeemForCommenting",e.hi="App_RefreshSessionInfo",e.pi="UI_ReplyWithChanges",e.vi="UI_ReportAbuse",e.mi="App_FilePicker",e.wi="UI_SaveStatus",e.gi="WopiSession_Complete_Ack",e.Si="SetOverlayContent",e.Ii="UI_Sharing",e.bi="UI_ShareForm",e._i="UI_SignIn",e.yi="App_StoreHostKeyValue",e.Ti="App_Unloaded",e.Ci="App_UlsLog",e.Ei="Wac_UnloadingApp",e.Oi="App_UpdateBootComplete",e.Ai="PageCount",e.Fi="UI_CheckUserAccessAndGrantPermissions",e.Ri="User_Activity",e.Pi="Edit_Notification",e.xi="UI_Workflow",e.Ui="ZoomChanged",e.Wi="CAAEMessage",e.Mi="Excel_HostFrameCacheSave",e.Ni="Excel_HostFrameCacheEvict",e.ki="Excel_RegenerateFileBundle",e.Hi="App_SwitchToWacFrame",e.Di="App_SaveSSRData",e.Ji="App_PurgeDataInHostCache",e.Bi="App_SaveHostRenderingV2Data",e.Li="App_SaveHostUtilsData",e.Vi="Visio_BRS",e.ji="Visio_SendLicenseInfo",e.zi="Visio_Consumption_CLTComplete",e.Gi="Visio_SwitchMode_FromViewFrame",e.qi="Visio_ModeSwitch_ToHost_Ack",e.Ki="Visio_UpdateEditUrl",e.Xi="Visio_PageViewLoaded",e.$i="Visio_ActiveAppFrameLoadFailed",e.Zi="Visio_DisposeBkgFrame",e.Qi="Visio_ReadyToReceiveDocData",e.Yi="Visio_DocReboot_HostNav",e.tn="Visio_SwitchToVisioFrame",e.in="WacAppPerfMetric"}(ue||(ue={})),function(e){e.nn="Ack",e.on="WacInitialize_Ready_Ack",e.rn="Wac_BeforeUnloadApp",e.sn="Blur_Focus",e.an="Wac_AppFailed_Ack",e.cn="Wac_AppCompleted_Ack",e.un="WopiStartSession_Complete",e.ln="WopiPendingSession_Complete",e.fn="Host_AccessibilityLoopComplete",e.qt="Host_IsFrameTrusted",e.dn="Grab_Focus",e.hn="HostCacheDiagnostic",e.pn="Host_KeyValue",e.vn="JsApiDiagnostics",e.ii="Host_MoveToFolder",e.mn="PageChanged_Ack",e.wn="App_PopState",e.gn="File_Rename",e.mi="Host_FilePicker",e.Sn="PostAccessToken",e.In="Host_SetAuthToken",e.bn="Host_SetCustomAuthConfig",e._n="App_PushCommentContext",e.yn="CanEmbed",e.Tn="Host_RefreshSessionInfo",e.Cn="CheckUserAccessAndGrantPermissions_Result",e.En="Host_WopiInfoFromUrl",e.On="Host_DavUrlFromIds",e.An="SetCurrentPage",e.Fn="SetZoomLevel",e.Rn="WopiPendingSession_Fail",e.Pn="SetOverlayContent",e.xn="WopiPendingApplicationComplete_Received",e.Un="Host_SwitchMode",e.Wn="Host_Unload",e.Mn="PageCount_Ack",e.Nn="ZoomChanged_Ack",e.kn="Host_ShareUI",e.Hn="Host_Telemetry",e.Dn="Visio_ConsumptionCLTComplete_Ack",e.Jn="Visio_SwitchMode_FromHF_Ack",e.Bn="Visio_SwitchMode_FromHostFrame",e.Ln="Visio_FallbackToLegacySwitch",e.Vn="Visio_DocumentData"}(le||(le={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged"}(fe||(fe={}));var ve=((de={})[ce.boot]={jn:ae.boot},de[ce.createNew]={jn:ae.createNew},de[ce.dispose]={jn:ae.dispose},de[ce.rename]={jn:ae.rename},de[ce.switchMode]={jn:ae.switchMode},de[ue.Ft]={jn:ae.handleBootState},de[ue.Ut]={jn:ae.closeTab},de[ue.qt]={jn:ae.frameTrust},de[ue.Xt]={jn:ae.getAuthToken},de[ue.Zt]={jn:ae.getHostKeyValue},de[ue.li]={jn:ae.appReboot},de[ue.Si]={jn:ae.setOverlayContent},de[ue.yi]={jn:ae.storeHostKeyValue},de[ue.Oi]={jn:ae.updateBootComplete},de[ce.blurFocus]={zn:le.sn},de[ce.continueAccessibilityLoop]={zn:le.fn},de[ce.grabFocus]={zn:le.dn},de[ce.moveToFolder]={zn:le.ii},de[ce.popState]={zn:le.wn},de[ce.sendAccessToken]={zn:le.Sn},de[ce.sendAuthToken]={zn:le.In},de[ce.sendHWRTelemetry]={zn:le.Hn},de[ce.sendCustomAuthConfig]={zn:le.bn},de[ce.sendDavUrl]={zn:le.On},de[ce.sendEmbeddedViewUrl]={zn:le.yn},de[ce.sendFrameTrustResult]={zn:le.qt},de[ce.sendSessionInfo]={zn:le.Tn},de[ce.sendUserAccessAndPermissions]={zn:le.Cn},de[ce.sendWopiInfo]={zn:le.En},de[ce.signalShared]={zn:le.kn},de[ce.completeSharedFilePicker]={zn:le.mi},de[ue.Ct]={Gn:fe.AccessibilityLoopCompleted},de[ue.Et]={Gn:fe.ActionCompleted},de[ue.Pt]={Gn:fe.BrowserEvent},de[ue.Wi]={Gn:fe.CAAEMessage},de[ue.xt]={Gn:fe.Close},de[ue.Wt]={Gn:fe.Conversation},de[ue.Mt]={Gn:fe.CopyAndEdit},de[ue.Nt]={Gn:fe.CreateNewDocument},de[ue.Ht]={Gn:fe.Download},de[ue.Dt]={Gn:fe.Edit},de[ue.Jt]={Gn:fe.Error},de[ue.Bt]={Gn:fe.FileEmbed},de[ue.Lt]={Gn:fe.FileProperties},de[ue.Vt]={Gn:fe.FileRenamed},de[ue.zt]={Gn:fe.FileVersions},de[ue.Kt]={Gn:fe.GetAccessToken},de[ue.Yt]={Gn:fe.GetDavUrlFromIds},de[ue.$t]={Gn:fe.GetCustomAuthConfig},de[ue.Qt]={Gn:fe.GetWopiInfoFromUrl},de[ue.Gt]={Gn:fe.FrameStateChanged},de[ue.ti]={Gn:fe.ModeSwitched},de[ue.ii]={Gn:fe.MoveToFolder},de[ue.ni]={Gn:fe.OpenInMobileApp},de[ue.oi]={Gn:fe.OpenInBrowser},de[ue.ri]={Gn:fe.OpenInClient},de[ue.si]={Gn:fe.PageChanged},de[ue.ci]={Gn:fe.PushState},de[ue.di]={Gn:fe.RedeemForCommenting},de[ue.hi]={Gn:fe.RefreshSessionInfo},de[ue.pi]={Gn:fe.ReplyWithChanges},de[ue.mi]={Gn:fe.SharedFilePicker},de[ue.vi]={Gn:fe.ReportAbuse},de[ue.wi]={Gn:fe.SaveStatus},de[ue.Ii]={Gn:fe.Share},de[ue.bi]={Gn:fe.ShareForm},de[ue._i]={Gn:fe.SignIn},de[ue.Fi]={Gn:fe.UserAccessAndPermissions},de[ue.Ri]={Gn:fe.UserActivity},de[ue.Pi]={Gn:fe.UserEditActivity},de[ue.xi]={Gn:fe.Workflow},de[ue.Ui]={Gn:fe.ZoomChanged},de);function me(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(oe(e)))}}t.perfNow=K;for(var n=0;n<e.length;n+=1){try{if(K){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var r=0;r<o;r+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(oe(e)))}e[n]=Math.floor(16*Math.random())}return t}(e),i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[i];return i+=1,("x"===t?n:3&n|8).toString(16)})),t]}var we=function(){return(we=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function ge(e,t,i,n){return new(i||(i=Promise))((function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}function Se(e,t){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}Object.create;Object.create;function Ie(e,t){try{if(void 0===window.performance)return void t.ULS.ge(595948609,n.k,o.Info,"Performance not supported");var i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.ge(595948610,n.k,o.Info,"No resources under performance");for(var r=new RegExp(e+"(-boot.min|(.(app|preview))?.boot).js","i"),s=i.length-1;s>=0;s-=1){var a=i[s],c=a.name.match(r);if(c){var u=JSON.stringify(a);return u=u.replace(new RegExp(a.name,"g"),c[0]),void t.ULS.ge(595948616,n.k,o.Info,u)}}t.ULS.ge(595948484,n.k,o.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.ge(595948617,n.k,o.Info,"Could not trace the resource timing: ".concat(oe(e)))}}function be(e){var t,i,n=we(we({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete n.siteId,delete n.webId,delete n.uiHostTabId;var o={};if(e.wdParams){var r=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o[e]=r[e])}));var s=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!s.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!s.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}var a=we({},e.rebootOverride);delete a.ackExpected,delete a["ui-language"],delete a.wdUserSession,delete a.rebootMode,delete a.documentUrl;var c=e.wopi;return{accessToken:c?{length:c.accessToken.length,expiry:c.expiry}:"N/A",bootParams:e.bootParams,build:V(),host:n,intent:e.intent,jsApiVersion:"v2",rebootOverride:a,region:S(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function _e(){var e={perfNowSupported:K,browser:r[c()],touchMode:l(),highContrast:f(),windows10x:h()};try{var t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}var ye;!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(ye||(ye={}));var Te=function(){function e(e,t){this.qn=function(){return Ce(e,"OnBeforeUnload",t)},this.Kn=function(){return Ce(e,"OnPageHide",t)},this.Xn=function(){return Ce(e,"VisibilityChange_"+document.visibilityState,t)},this.$n=function(){return Ce(e,"OnUnload",t)},window.addEventListener("beforeunload",this.qn,{capture:!0,once:!0}),window.addEventListener("pagehide",this.Kn,{capture:!0}),window.addEventListener("visibilitychange",this.Xn,{capture:!0}),window.addEventListener("unload",this.$n,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.qn,{capture:!0}),window.removeEventListener("pagehide",this.Kn,{capture:!0}),window.removeEventListener("visibilitychange",this.Xn,{capture:!0}),window.removeEventListener("unload",this.$n,{capture:!0})},e}();function Ce(e,t,i){e.ULS.ge(595957843,n.k,o.Info,"Page lifecycle: ".concat(t," fired")+(i?", flushing logger":"")),i&&e.ULS.flush()}var Ee=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a"],Oe=function(){function e(e){var t=this;this.Zn={},this.Qn=[],this.Yn=function(e){if(e&&e.origin)try{var i=e.data;if("string"==typeof i&&i.includes("AddinTrustedOrigin")){var r=JSON.parse(i),s=r.AddinTrustId;s&&"AddinTrustedOrigin"===r.MessageId&&(t.ht.ULS.ge(560754784,n.k,o.Info,"didReceiveMessage addinTrustId ".concat(s)),t.Zn[s]=e.origin,t.Qn.forEach((function(t){t(s,e.origin)})))}}catch(e){t.ht.ULS.ge(560754785,n.k,o.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.ht=e,window.addEventListener("message",this.Yn)}return e.prototype.isResourceTrustedForMessage=function(e){return ge(this,void 0,void 0,(function(){var t,i,r,s,a,c,u,l,f=this;return Se(this,(function(d){switch(d.label){case 0:return e&&e.Resource?(t=e.Resource,i=e.AddinTrustId,(r=function(e){if(!e)return!1;for(var t=e.toLowerCase(),i=0,n=Ee;i<n.length;i++){var o=n[i];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!i?[2,r]:this.Zn[i]?[2,Ae(t,this.Zn[i])]:(a=new Promise((function(e){s=function(n,o){i===n&&e(Ae(t,o))},f.Qn.push(s)})),c=-1,2e3,u=new Promise((function(e){c=window.setTimeout((function(){f.ht.ULS.ge(560754786,n.k,o.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(i)),e(!1)}),2e3)})),[4,Promise.race([a,u])])):[2,!1];case 1:return l=d.sent(),this.Qn=this.Qn.filter((function(e){return e!==s})),window.clearTimeout(c),[2,l]}}))}))},e.prototype.dispose=function(){this.Zn={},this.Qn=[],window.removeEventListener("message",this.Yn)},e}();function Ae(e,t){try{if(!e||!t)return!1;for(var i=/[?&#%\\]/,n=0;n<e.length;n+=1){var o=e.charCodeAt(n);if(o<33||o>126)return!1;var r=e.charAt(n);if(i.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var a=new URL(s);return"https:"===a.protocol&&t.toLowerCase()===a.origin.toLowerCase()}catch(e){return!1}}var Fe=function(){function e(e,t,i,r,s,a,c){var u,l=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.appContext={},this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.eo={},this.onMessage=function(e){var t=e.MessageId,i=e.Values||{},r=l.eo[t];if(r&&r.length>0)l.to(t,i);else{var s=ve[t];if(s){var a=s.jn,c=s.Gn;a?(l.logger.ULS.ge(574654543,n.k,o.Info,"Running flow: ".concat(a)),l.io[a](t,i,l,l.no[a]).catch((function(e){l.oo(a,e)}))):c&&l.raiseEvent(c,i)}}},this.oo=function(e,t){l.logger.ULS.ge(596459925,n.k,o.Error,"".concat(e," flow error: ").concat(oe(t))),l.remoteTelemetryUrl&&z(l.remoteTelemetryUrl,l.appInfo.name,"flowException")},this.to=function(e,t){l.logger.ULS.ge(574654544,n.k,o.Info,"Dispatching action: ".concat(e));for(var i=l.eo[e].slice().reverse(),r=i.length-1;r>-1;r-=1)try{i[r](e,t)}catch(t){l.logger.ULS.ge(596444186,n.k,o.Error,"".concat(e," action handler error: ").concat(oe(t)))}return Promise.resolve({completion:"success"})},this.state=D.Unknown;var f=me(),d=f[0],h=f[1];this.logger=ie(),this.logger.ULS.ge(593506837,n.k,o.Info,JSON.stringify(h)),this.sessionId=d,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=r,this.appInfo=t,this.session=s,this.featureManager=re(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.ze=new pe(t.name,this.logger),this.preloader=t.preloader,u=a(this.featureManager),this.io=u[0],this.no=u[1],this.so=c,this.ze.addSettingsChangeListener(this.logger.settingsChangeHandler),this.clientDiagnostics=_e(),this.pageStateObserver=new Te(this.logger,!0),this.authTokenTrustValidator=new Oe(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.ge(574654541,n.k,o.Info,"Raising event: ".concat(e));try{this.so(e,t)}catch(e){this.logger.ULS.ge(593506838,n.k,o.Error,"Event handler error: ".concat(oe(e)))}},e.prototype.addActionHandler=function(e,t){this.eo[e]||(this.eo[e]=[]),this.eo[e].push(t)},e.prototype.removeActionHandler=function(e,t){var i=this.eo[e];if(i&&i.length>0){var n=i.indexOf(t);n>-1&&i.splice(n,1)}},e.prototype.run=function(e,t,i){var r=this;if(this.state===D.Disposed&&this.backgroundSession)return this.logger.ULS.ge(525203609,n.k,o.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,i);var s=[],a=this.eo[e];if(a&&a.length>0)s.push(this.to(e,t));else{var c=ve[e];if(c){var u=c.jn,l=c.zn;if(u){this.logger.ULS.ge(574654542,n.k,o.Info,"Running flow: ".concat(u));var f=this.io[u](e,t,this,this.no[u],i).catch((function(e){return r.oo(u,e),{completion:"failure",error:e}}));s.push(f)}else l&&(this.container&&this.container.postMessage(l,t),s.push(Promise.resolve({completion:"success"})))}else s.push(Promise.resolve({completion:"failure"})),this.logger.ULS.ge(593500189,n.k,o.Warning,"Unhandled command: ".concat(e))}return Promise.race(s)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.ze.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.eo={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}();var Re,Pe=function(){function e(e,t,i,n,o,r){var s=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i);this.ao=new Fe(e,t,i,n,this,r,(function(e,t){return o({type:e,data:t,session:s})})),this.ao.state=D.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.ao.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.ao.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,i){return this.ao.run(e,t,i)},e.prototype.boot=function(e,t){return this.ao.run(ce.boot,e,t)},e.prototype.dispose=function(e){return this.ao.run(ce.dispose,void 0,e)},e}(),xe=function(){function e(e,t,i){var r,s,a=this;this.co="",this.uo="",this.lo=!1,this.fo=!1,this.do=!1,this.ho=!1,this.po=function(e){var t,i=!1,r=!0,s="",c=!1;if(a.vo&&a.vo.contentWindow&&(i=!0,r=e.source===a.vo.contentWindow),e.origin&&(c=(s=_(e.origin,2).toLowerCase())===a.uo),!a.lo&&(!a.fo||c&&r)||a.ht.ULS.ge(593232850,n.k,o.Info,"Window: available["+i+"] valid["+r+"]; Origin: valid["+c+"] expected["+a.uo+"] actual["+s+"]"),c&&(!a.do||r)){var u;try{u=JSON.parse(e.data)}catch(e){return void a.ht.ULS.ge(593232851,n.k,o.Info,"Failed to parse event data: ".concat(oe(e)))}var l=u.MessageId;if(l){if(a.ht.ULS.ge(593232854,n.k,o.Info,"Received message: ".concat(l,", correlation: ").concat(u.CorrelationId)),l!==ue.Rt&&l!==ue.ei||a.setTargetOrigin(e.origin),u.Values&&u.Values.ackExpected&&a.postMessage(le.nn,void 0,u.CorrelationId),a.ho&&l===ue.in)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[u.Values.name]=u.Values.time);if(a.mo)try{a.mo(u)}catch(e){a.ht.ULS.ge(594556386,n.k,o.Error,"Message handler error: ".concat(oe(e)))}else a.ht.ULS.ge(591933923,n.k,o.Error,"No message handler")}else(a.lo||a.fo)&&a.ht.ULS.ge(593232853,n.k,o.Info,"Missing message id")}},this.ht=t,this.setTargetOrigin(e),i&&this.setMessageHandler(i),this.ho=!!(null===(s=null===(r=window.location)||void 0===r?void 0:r.search)||void 0===s?void 0:s.match(/wdpa=1/gi)),window.addEventListener("message",this.po,!1)}return e.prototype.setTargetOrigin=function(e){var t=b(e).toLowerCase();this.co&&this.co!==t&&this.ht.ULS.ge(593232847,n.k,o.Warning,"Updating origin: [".concat(x(this.co),"]->[").concat(x(t),"]")),this.co=t,this.uo=_(t,2),this.lo=w(t),this.fo=g(t)},e.prototype.setTargetFrame=function(e,t){this.vo=e,this.do=!!t},e.prototype.setMessageHandler=function(e){this.mo=e},e.prototype.removeMessageHandler=function(){this.mo=void 0},e.prototype.postMessage=function(e,t,i){if(this.vo&&this.vo.contentWindow){this.ht.ULS.ge(593232849,n.k,o.Info,"Sending message: "+e);var r={MessageId:e,SendTime:$(),CorrelationId:i,Values:t};this.vo.contentWindow.postMessage(JSON.stringify(r),this.co)}else this.ht.ULS.ge(593232848,n.k,o.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.po,!1),this.mo=void 0},e}();!function(e){e.wo="access_token",e.So="access_token_ttl",e.Io="bundleSrc",e.bo="bundleStaleness",e._o="DocID",e.yo="SiteID",e.To="WebID",e.Co="ETag",e.Eo="feature_status",e.Oo="fileExtension",e.Ao="fileGetUrl",e.Fo="customFontCatalogUrl",e.Ro="fileName",e.Po="fileSize",e.xo="forceSLR",e.Uo="frameHeightPx",e.Wo="frameWidthtPx",e.Mo="highContrast",e.No="highDpi",e.Ho="host_diagnostics",e.Do="hostName",e.Jo="huictrls",e.Bo="owner_id",e.Lo="sc",e.Vo="softBlockedBrowser",e.jo="templateUrl",e.zo="touchMode",e.Go="user_id",e.qo="hfck",e.Ko="hfcv",e.Xo="timeZoneId",e.$o="darkCssMedia",e.Zo="caae",e.Qo="meetingId",e.Yo="meetingTitle",e.er="meetingType",e.ir="scheduledStartTime",e.nr="scheduledEndTime",e.or="isPresenter",e.rr="meetingOrganizerId",e.sr="meetingJoinUrl",e.ar="isMeetingTeamsRoom",e.cr="jsapibuild",e.ur="owlver",e.lr="owlro"}(Re||(Re={}));function Ue(e,t){c()===r.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function We(e,t){y(t,Re.Uo,String(e.offsetHeight)),y(t,Re.Wo,String(e.offsetWidth)),y(t,Re.zo,String(l())),y(t,Re.Mo,String(f())),y(t,Re.xo,String(h())),y(t,Re.$o,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}()))}function Me(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.ge(591525084,n.k,o.Info,"Trust check error: ".concat(oe(t))),!1}}var Ne=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.dr=e,this.hr=t,this.pr=t+"_Form",this.vr=Me()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.dr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.hr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.pr},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.vr},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,i,r){this.ht=i,this.mr=new xe(e,i,this.mo);var s=r.useAdditionalDiv,a=r.permissionsPolicy;this.wr&&!s?(this.wr.setAttribute("allow",a),this.ht.ULS.ge(588793045,n.k,o.Info,"Wac frame reused")):(this.wr=function(e,t,i,n,o,r,s,a){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var c=e.ownerDocument,u=c.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",i),Ue(u,s),n&&(e.style.minHeight=n,u.style.minHeight=n),o&&(e.style.minWidth=o,u.style.minWidth=o),a&&u.setAttribute("role","none"),r){var l=c.createElement("div");l.style.top="0",l.style.bottom="0",l.style.left="0",l.style.right="0",l.style.height="100%",l.style.width="100%",l.style.backgroundColor="#393a3d",l.style.backfaceVisibility="hidden",n&&(l.style.minHeight=n),o&&(l.style.minWidth=o),l.appendChild(u),e.appendChild(l)}else e.appendChild(u);return u}(this.dr,this.hr,a,r.minHeight,r.minWidth,s,r.isInvisible,r.setNoneRole),this.ht.ULS.ge(588793046,n.k,o.Info,"Wac frame created")),this.mr.setTargetFrame(this.wr,r.enforceSameWindow),s&&(this.gr=this.wr.parentElement),We(this.wr,t),this.Sr=function(e,t,i,n,o){var r=e.ownerDocument,s=r.createElement("form");for(var a in s.id=i,s.name=i,s.action=n,s.target=t,s.method="POST",o){var c=r.createElement("input");c.type="hidden",c.name=a,c.value=o[a],s.appendChild(c)}return e.appendChild(s),s}(this.dr,this.hr,this.pr,e,t),this.Sr.submit()},e.prototype.setVisibility=function(e){this.wr&&Ue(this.wr,e)},e.prototype.setMessageHandler=function(e){this.mo=e,this.mr&&this.mr.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.Ir=e},e.prototype.removeMessageHandler=function(){this.mo=void 0,this.mr&&this.mr.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.Ir?this.Ir(e,t):this.mr&&this.mr.postMessage(e,t)},e.prototype.dispose=function(e,t){var i=this;return new Promise((function(n){if(i.Sr&&(i.dr.removeChild(i.Sr),i.Sr=void 0),i.mr&&(i.mr.dispose(),i.mr=void 0,i.mo=void 0),i.Ir&&(i.Ir=void 0),i.ht=void 0,!i.wr||!i.gr&&e)n();else{var o=function(){i.gr?(i.gr.removeChild(i.wr),i.dr.removeChild(i.gr)):i.dr.removeChild(i.wr),i.wr=void 0,i.gr=void 0,n()};t?o():(i.wr.src="about:blank",window.setTimeout(o,0))}}))},e}();var ke,He=function(){function e(e,t,i){var n=this;this.sessions=[],this.containers=[],this.br=function(e){n._r.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.yr=e,this.Tr=t,this.Cr=i,this._r=new he,u()}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Tr.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return V()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this._r.add(e)},e.prototype.removeEventListener=function(e){this._r.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.Tr.name,"_").concat(this.containers.length),i=new Ne(e,t);return this.containers.push(i),i},e.prototype.createSession=function(e){var t=new Pe(this.yr,this.Tr,e,this,this.br,this.Cr);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,i=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(i).then((function(e){return t._r.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}();function De(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach((function(i){return e[i]=t.Diagnostics[i]}))}function Je(e,t,i){t.ULS.ge(596459999,n.k,i,"SessionTraces: "+JSON.stringify(e))}function Be(e,t){t.stop();var i=t.getVisibilityChangeEvents();null!=i&&i.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(i)),t.dispose()}function Le(e,t,i){try{var r=function(e,t){var i=we({},t);delete i.UserId,delete i.OwnerId,delete i.SiteId,delete i.WebId,delete i.Upn,delete i.TenantId,delete i.UiHostTabId,delete i.OriginalWdParam,delete i.WdParams;var n=i,o=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};n.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){o[e]&&(n.WdParams[e]=o[e])}));var r=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;return n.WdParams.wdprevioussession&&!r.test(n.WdParams.wdprevioussession)&&delete n.WdParams.wdprevioussession,n.WdParams.wdpreviouscorrelation&&!r.test(n.WdParams.wdpreviouscorrelation)&&delete n.WdParams.wdpreviouscorrelation,n.UiEmbedMode=R(e,"uiembed"),n.UiHostName=C(e,"uih")||"N/A",n.HostDomain=location?location.hostname:"",n}(t.applicationUrl,t.sessionInformation);r.Build=V(),r.Region=S(t.applicationUrl);var s=we({},t.rebootOverrideData);delete s.ackExpected,delete s["ui-language"],delete s.wdUserSession,delete s.rebootMode,delete s.documentUrl,r.RebootOverride=s;var a=t.diagnostics.HostInitDiagnostics;a&&(e.ULS.ge(596444238,n.k,o.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),r.SessionOrigin=a.entryPoint),i&&e.ULS.ge(595937313,n.k,o.Info,JSON.stringify(i)),e.ULS.ge(595632928,n.k,o.Info,function(){if(window&&window.navigator){var e=window.navigator,t=e.connection||e.mozConnection||e.webkitConnection;if(t)return"EffectiveType: "+t.effectiveType+", BandwidthMps: "+t.downlink+", ConnectionType: "+t.type}return""}());var c=t.wopiInfo;c&&c.AccessToken&&c.AccessTokenExpiry||e.ULS.ge(595894553,n.k,o.Warning,"There are some missing parameters"),c&&(c.AccessToken&&(r.AccessTokenLength=c.AccessToken.length),r.AccessTokenExpiry=c.AccessTokenExpiry),r.JsApiVersion="v1",e.ULS.ge(596444237,n.k,o.Info,JSON.stringify({session:r,client:t.diagnostics.ClientDiagnostics}))}catch(t){e.ULS.ge(558155802,n.k,o.Error,"Failed to log initialization info: ".concat(oe(t)))}}!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(ke||(ke={}));function Ve(e,t){var i=t?"?usid="+t:"";return e+"_layouts/RemoteTelemetry.ashx"+i}function je(e,t){return Ve(Ge(e),t)}function ze(e,t,i,n,o,r){void 0===r&&(r=!1),e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){var i=e.SessionInformation;i.WdParams||(i.WdParams={});if(i.WdParams.wd)return;t.substring(1).split("&").filter((function(e){if(0===e.indexOf("wd")){var t=e.split("=");t[0].length>2&&(i.WdParams[t[0]]=t[1])}}));var n=e.RebootOverrideData;n&&n.previousSessionId&&(i.WdParams.wdprevioussession=n.previousSessionId)}(e,window.location.search);var s=o||new pe("Excel",i),a=Ge(e.ApplicationUrl);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,ClientDiagnostics:_e(),AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:V(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:a,remoteTelemetryUrl:Ve(a,t),wopiInfo:e.WopiInfo,forceSingleStepBoot:r,isCreateNew:e.WopiPrecheckInfo.IsNewFile||R(e.ApplicationUrl,"new"),featureManager:n||re(e.FnIsFeatureEnabled,i),ze:s,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData,pageStateObserver:new Te(i,!0)}}function Ge(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}var qe=function(){function e(e,t,i,n,o){this.Er=0,this.Or=[],this.lo=!1,this.lo=e,this.Ar=t,this.ht=i,this.Fr=n,this.Rr=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.Ar.getValue(Q.Je,!1);this.Er=X()+(this.Rr?this.Rr:this.Ar.getValue(Q.xe,6e5));var i=this.lo?3e3:5e3;this.Pr=window.setInterval((function(){t&&e.ht.ULS.ge(595724178,n.k,o.Info,"Boot_HeartBeat"),X()>e.Er&&(e.stop(),Ke(e.ht),e.Fr&&e.Fr())}),this.Ar.getValue(Q.De,i)),this.Or.push(window.setTimeout(Ke,this.Ar.getValue(Q.Ue,6e4),this.ht,1)),this.Or.push(window.setTimeout(Ke,this.Ar.getValue(Q.We,18e4),this.ht,2))},e.prototype.stop=function(){this.Er=0,this.Pr&&(window.clearInterval(this.Pr),this.Pr=void 0),this.Or.forEach((function(e){window.clearTimeout(e)})),this.Or=[]},e}();function Ke(e,t){e.ULS.ge(594901218,n.k,o.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}function Xe(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)return t.virtualKeyboard.overlaysContent=e}var $e,Ze=function(e,t,i,n,o){return e!==ue.Si?Promise.reject("Wrong flow"):new Promise((function(e){Xe(t.overlayContent),i.container&&i.container.postMessage(le.Pn,void 0),e({completion:"success"})}))};function Qe(e){if(!e)return"";var t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),n=t.match(i);return!n||n.length<2?"":n[1]}function Ye(e){return Qe(e.hostKey)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}($e||($e={}));var et=function(e,t,i,r,s){return e!==ue.Zt?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey;i.logger.ULS.ge(574408915,n.k,o.Info,"getHostKeyValue ".concat(r));var s=Ye(t);i.container&&s&&i.container.postMessage(le.pn,{hostKey:r,hostValue:s}),e({completion:"success"})}))};function tt(e){!function e(t,i,n,o){void 0===o&&(o=$e.none);var r=t+"="+i,s="",a=new Date;a.setTime(a.getTime()+31536e6);var c=new Date;c.setTime(c.getTime()+864e5*n),c>a&&(c=a),c&&(s=";expires="+c.toUTCString());var u=";SameSite="+$e[o];return document.cookie=r+s+u,!(!document.cookie||-1===document.cookie.indexOf(r))||o===$e.none&&e(t,i,n,$e.doNotSet)}(e.hostKey,e.hostValue,365)}var it=function(e,t,i,r,s){return e!==ue.yi?Promise.reject("Wrong flow"):new Promise((function(e){var r=t.hostKey,s=t.hostValue;i.logger.ULS.ge(574408914,n.k,o.Info,"storeHostKeyValue ".concat(r,": ").concat(s)),tt(t),e({completion:"success"})}))};function nt(e){return new RegExp("xlviewerinternal.aspx","i").test(e)}function ot(e){return new RegExp("xlembed.aspx","i").test(e)}function rt(e){return new RegExp("xlpreview.aspx","i").test(e)}var st,at,ct,ut,lt,ft,dt,ht,pt,vt;function mt(e,t,i,r){ft=e,dt=t,ht=void 0,pt=i,vt=r,st=!1,at=!1,ct=0,It(),setTimeout((function(){ft.ULS.ge(593589517,n.k,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")}),3e3),setTimeout((function(){!function e(){if(ct>=3)return void ft.ULS.ge(595350870,n.k,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3");if(It(),st)setTimeout((function(){(!at||ct>0)&&ft.ULS.ge(595350872,n.k,o.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+at+" after first flush retry attempt: "+ct)}),lt);else{if(ct+=1,ft.ULS.ge(595350871,n.k,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+ct),pt.isFeatureEnabled(te.Xe)&&1===ct)document.getElementById(dt).submit();setTimeout((function(){e()}),ut)}}()}),ut),pt.isFeatureEnabled(te.Ke)&&(window.localStorage?window.addEventListener("offline",bt):ft.ULS.ge(593589518,n.k,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),ft.ULS.ge(594622165,n.k,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+pt.isFeatureEnabled(te.Ke))}function wt(e){"PageLoadSkeleton Presented"===e?st=!0:"BootstapContext Recieved"===e&&(at=!0)}function gt(){if(pt.isFeatureEnabled(te.Ke))if(window.localStorage)for(var e=0;e<localStorage.length;e+=1)try{var t=localStorage.key(e);if("OfflineMode_"===t.substring(0,"OfflineMode_".length)){var i=localStorage.getItem(t);ft.ULS.ge(593589520,n.k,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+i),localStorage.removeItem(t)}}catch(e){ft.ULS.ge(593589521,n.k,o.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+oe(e))}else ft.ULS.ge(593589519,n.k,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}function St(e){return nt(e)||ot(e)}function It(){ut=3750,lt=6e3;var e=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return e?e.effectiveType:void 0}}();if(void 0!==e)switch(void 0!==ht&&ht!==e&&ft.ULS.ge(595350873,n.k,o.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+ht+" currentConnection: "+e+" First Flush: "+st+" Second Flush:"+at),ht=e,e){case"4g":ut=3750,lt=6e3;break;case"3g":ut=5e3,lt=8e3;break;case"2g":ut=1e4,lt=24e3;break;case"slow-2g":ut=2e4,lt=4e4}}function bt(){try{var e=$(),t="OfflineMode_"+vt+"_"+e,i={"Sessionid:":vt,OfflineTime:e};localStorage.setItem(t,JSON.stringify(i))}catch(e){ft.ULS.ge(593589522,n.k,o.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+oe(e))}}var _t,yt;function Tt(e,t){_t=e;try{window.localStorage?(t.registerMessagePayloadHandler(ue.Mi,(function(e){!function(e){if(e&&e.hasOwnProperty("cacheItemKey")&&0===e.cacheItemKey.indexOf("XlHc_")&&e.hasOwnProperty("cacheItemValue"))try{window.localStorage.setItem(e.cacheItemKey,e.cacheItemValue),_t.ULS.ge(574677249,n.k,o.Info,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: setting localstorage HostFrame cache item")}catch(e){_t.ULS.ge(574677250,n.k,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: error while saving HostFrame to local storage. error: "+oe(e))}else _t.ULS.ge(574677251,n.k,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: HostFrame cache save message does not contain all expected values, skipping HostFrame cache save")}(e)})),t.registerMessagePayloadHandler(ue.Ni,(function(e){!function(e){if(e&&e.hasOwnProperty("workbookList")&&e.hasOwnProperty("evictAllExceptListed"))try{var t=e.evictAllExceptListed,i=JSON.parse(e.workbookList);_t.ULS.ge(574677252,n.k,o.Info,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: removing items from cache. workbookList length: "+i.length+", evictAllExceptListed: "+t),!0===t?function(e){for(var t=new Date,i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).getTime(),r=0;r<localStorage.length;r+=1){var s=localStorage.key(r),a=!1;if(0===s.indexOf("XlHc_")){if(e.indexOf(s)<0)a=!0;else{var c=localStorage.getItem(s),u=void 0;try{u=JSON.parse(c)}catch(e){_t.ULS.ge(574677255,n.k,o.Warning,"ExcelHostFrameCacheManager: evictAllItemsExcept: unable to check for stale HostFrame cache, error parsing HostFrame cache item, error: "+oe(e))}if(u)i-u.LastModified>5184e6&&(a=!0);else a=!0}a&&(localStorage.removeItem(s),_t.ULS.ge(574677256,n.k,o.Verbose,"ExcelHostFrameCacheManager: EvictAllItemsExcept: Removed HostFrame cache item"))}}}(i):function(e){for(var t=0;t<e.length;t+=1)localStorage.removeItem(e[t]),_t.ULS.ge(574677257,n.k,o.Verbose,"ExcelHostFrameCacheManager: EvictSpecificItems: Removed HostFrame cache item")}(i)}catch(e){_t.ULS.ge(574677253,n.k,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: error while evicting HostFrame from local storage. error: "+oe(e))}else _t.ULS.ge(574677254,n.k,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: HostFrame cache evict message does not contain all expected values")}(e)}))):_t.ULS.ge(574677217,n.k,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){_t.ULS.ge(574677218,n.k,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: error while initializing.")}}function Ct(e,t){var i={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?yt.forceSingleStepBoot:yt.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot||(i=function(e,t){var i=e.applicationUrl,r=nt(i),s=ot(i),a=rt(i),c={isSingleStepBoot:!0,bootFlowType:yt.forceSingleStepBoot,ignoreWacFramePostMessages:!(r||s)};return r||s||a||t.ULS.ge(553673219,n.k,o.Warning,"Unknown endpoint: ".concat(A(i))),c}(e,t)),i.isSingleStepBoot){var r={singleStepBootIsRequired:!0,singleStepBootReason:i.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:i.ignoreWacFramePostMessages};t.ULS.ge(596444182,n.k,r.irmEnabled?o.Warning:o.Info,JSON.stringify(r))}else t.ULS.ge(596444183,n.k,o.Info,"Received input valid for two step flow");return i}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(yt||(yt={}));function Et(e,t,i,r,s,a,c){var u=function(e,t,i){var n=e.ownerDocument.createElement("iframe");n.name=i||"WebApplicationFrame",n.id="WebApplicationFrame",n.src="",n.title="Office Online Frame",n.width="100%",n.height="100%",n.marginWidth="0",n.marginHeight="0",n.style.left="0",n.style.top="0",n.style.right="0",n.style.bottom="0",n.style.display="block",n.style.position="absolute",n.style.backgroundColor="transparent",n.style.border="none",n.frameBorder="0",n.setAttribute("allowfullscreen","true"),n.setAttribute("allowTransparency","true");var o=b(t);return n.setAttribute("allow","microphone ".concat(o,"; autoplay ").concat(o,"; camera ").concat(o,"; clipboard-read ").concat(o,"; clipboard-write ").concat(o,"; keyboard-map ").concat(o,"; display-capture ").concat(o)),e.appendChild(n),n}(e,t,c);return St(t)&&mt(s,"office_form",r,a),function(e,t,i){try{_t||(_t=e);var r="".concat(t[Re._o],"_").concat(i,"_").concat(t[Re.Do],"_").concat(t[Re.Go]);if(r="XlHc_"+function(e){var t=0,i=e.length,n=0;if(i>0)for(;n<i;)t=(t<<5)-t+e.charCodeAt(n)|0,n+=1;return t}(r),t[Re.qo]=r,window.localStorage){var s=localStorage.getItem(r);null!==s&&(t[Re.Ko]=s)}else _t.ULS.ge(574677219,n.k,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){_t.ULS.ge(574677248,n.k,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: error while setting host frame cache post data.")}}(s,i,""),function(e,t,i,n){We(e,n);var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=i,r.target=e.name,r.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=s,a.value=n[s],r.appendChild(a)}return t.appendChild(r),r.submit(),e}(u,e,t,i)}function Ot(e,t,i){void 0===i&&(i=!1);var n=e.applicationUrl;e.wopiPrecheckInfo.IsNewFile&&n.replace("unified=1","edit=1&new=1");var o={jsApi:"1",jsapiver:"v1"};if(i&&(o.NewSession="1"),o.corrid=e.sessionId,o.usid=e.sessionId,o.sftc="1",(e.applicationCustomSettings&&e.applicationCustomSettings.IsCore||e.sessionInformation.IsCore)&&(o.core="1"),e.sessionInformation.HideViewerToolbar&&(o.hvt="1"),e.sessionInformation.HideEditUpsellDialog&&(o.hdeditdlg="1"),e.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(o.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),e.sessionInformation.SupportsDocReboot){var r=e.sessionInformation.SupportsDocReboot;o.sdr=!0===r?"1":r.toString()}e.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),e.sessionInformation.SupportsAuthToken&&(o.sat="1"),e.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),e.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),e.sessionInformation.SupportsCommonFilePicker&&(o.sfp="1"),e.sessionInformation.OpenLinksInNewWindow&&(o.onw="1"),e.sessionInformation.UseDarkTheme&&(o.udt="1"),e.sessionInformation.SupportsExcelExternalLinks&&(o.xlel="1"),e.sessionInformation.SupportsRefreshAccessToken&&(o.rat="1"),e.sessionInformation.HideHeader&&(o.hhdr="1"),e.sessionInformation.HideAppLauncherInHeader&&(o.halh="1"),e.sessionInformation.HideChatInHeader&&(o.hch="1"),e.sessionInformation.HideMeInHeader&&(o.hmh="1"),e.sessionInformation.HideSearchInHeader&&(o.hsh="1"),e.sessionInformation.HideWorkflowInHeader&&(o.hwfh="1"),e.sessionInformation.HideSettingsInHeader&&(o.hsth="1"),e.sessionInformation.ShowAppIconInHeader&&(o.sih="1"),e.sessionInformation.UseNeutralColorInHeader&&(o.unh="1"),e.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(o.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),e.sessionInformation.NoBrowserModalDialogs&&(o.nbmd="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),e.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1"),"DocGen"===e.sessionInformation.ContentAssemblyMode&&(o.readOnly="1"),e.sessionInformation.UIEmbed&&(o.uiEmbed="1"),e.sessionInformation.IsSynthetic&&(o.syn="1"),e.sessionInformation.SupportsDirectDownload&&(o.sdd="1"),e.sessionInformation.SupportsDirectPrint&&(o.sdp="1"),e.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===yt.unifiedSingleFlush&&(e.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=t.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(e.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(b(window.location.href)),e.isCreateNew&&(o.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection);var s=e.wopiPrecheckInfo.FileSize;return s&&s>=52428800&&s<=104857600&&(o.ilf="1"),e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(o=we(we({},e.applicationCustomSettings.additionalApplicationParameters),o)),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(o=we(we({},o),e.rebootOverrideData.queryOverrides)),function(e,t,i,n,o){var r=O(e);("teams"===r.uih&&"UnifiedUiHostTeams"!==t.UiHostIntegrationType||"owa"===r.uih)&&(r.hhdr="1");var s=e.indexOf("?"),a=-1===s?e.concat("?"):e.substring(0,s+1);t.UiLocale&&(r.ui=encodeURIComponent(t.UiLocale));t.DataLocale&&(r.rs=encodeURIComponent(t.DataLocale));t.HostSessionId&&(r.hid=encodeURIComponent(t.HostSessionId));t.DisableChat&&(r.dchat="1");t.SessionContext&&(r.sc=encodeURIComponent(t.SessionContext));i&&i.WopiSrc&&(r.wopisrc=encodeURIComponent(i.WopiSrc));t.CookieCompliant&&(r.mscc="1");n&&(n.entryPoint&&(r.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(r.wdhostclicktime=n.userClickTime.toString()));r=we(we(we({},r),t.WdParams),o);var c={};for(var u in r)c[u.toLowerCase()]=r[u];var l=[];for(var u in c)c[u]&&l.push(u.concat("=",c[u]));return a.concat(l.join("&"))}(n,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,o)}function At(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}var Ft=function(){function e(e,t,i,r,s,a){var c=this;if(this.xr=!1,this.Ur=function(e,t){c.Wr.officeFrameCreateTime=$(),c.Mr.frameCreateStartTime=c.Wr.officeFrameCreateTime;var i=c.Nr.applicationCustomSettings&&c.Nr.applicationCustomSettings.appFrameName;c.kr=Et(c.Nr.container,e,t,c.Nr.featureManager,c.ht,c.Nr.sessionId,i),c.Hr.activate(c.kr)},this.Dr=function(e){c.Hr.registerMessagePayloadHandler(ue.Rt,c.Jr),c.Hr.registerMessagePayloadHandler(ue.At,c.Br),c.Pe=window.setTimeout(c.Lr,15e3),c.Vr=new qe(e,c.Nr.ze,c.ht,(function(){z(c.Nr.remoteTelemetryUrl,"Excel","bootTimeout")}))},this.jr=function(e){var t=e&&e.state?e.state:"unknown";c.ht.ULS.ge(595714271,n.k,o.Info,"WAC Boot App state:[".concat(t,"]")),wt(t)},this.zr=function(e){var t=Me(c.ht);c.ht.ULS.ge(595653903,n.k,o.Info,"Top frame is trusted: ".concat(t)),c.Gr(le.qt,{isTopFrameTrusted:t})},this.qr=function(e){var t=Xe(e&&e.overlayContent);c.ht.ULS.ge(587487432,n.k,o.Info,"Overlay content: ".concat(t)),c.Gr(le.Pn,void 0)},this.Jr=function(e){if(c.ht.ULS.ge(595986314,n.k,o.Info,"Received wac complete message"),c.ht.ULS.flush(),window.clearTimeout(c.Pe),c.Vr&&c.Vr.stop(),gt(),c.xr)c.ht.ULS.ge(596444234,n.k,o.Info,"Received multiple wac complete or failure messages");else{c.xr=!0,c.Gr(le.cn,{}),De(c.Wr,e);var t=c.Kr();c.Xr(t),c.$r(c.Nr.diagnostics)}},this.Zr=function(){c.ht.ULS.ge(579342464,n.k,o.Info,"Received close tab message");try{window.close()}catch(e){c.ht.ULS.ge(579213188,n.k,o.Warning,"Failed to close the browser tab")}},this.Kr=function(){return{innerApplicationFrame:c.kr}},this.Br=function(e){if(c.ht.ULS.ge(595986315,n.k,o.Error,"Received wac failed message"),c.ht.ULS.flush(),window.clearTimeout(c.Pe),c.Vr&&c.Vr.stop(),c.xr)c.ht.ULS.ge(596444235,n.k,o.Info,"Received multiple wac complete or failure messages");else{c.xr=!0,c.Gr(le.an,{});var t={errorType:ke.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,c.Mr.error=t),c.Qr(t)}},this.Yr=function(e){var t=e.hostKey;c.ht.ULS.ge(574433173,n.k,o.Info,"GetHostKeyValue ".concat(t));var i=Ye(e);null!=i&&c.Gr(le.pn,{hostKey:t,hostValue:i})},this.ts=function(e){var t=e.hostKey,i=e.hostValue;c.ht.ULS.ge(574433174,n.k,o.Info,"storeHostKeyValue ".concat(t,": ").concat(i)),tt(e)},this.Lr=function(){c.xr||c.ht.ULS.ge(596444236,n.k,o.Warning,"Timeout. SessionTraces:"+JSON.stringify(c.Mr))},this.$r=function(e){c.Gr(le.vn,{HostInitializeDiagnostics:e.HostInitDiagnostics,ClientDiagnostics:e.ClientDiagnostics})},this.Gr=function(e,t){c.kr&&c.kr.contentWindow?c.Hr.sendPostMessage(c.kr,e,t):c.ht.ULS.ge(595955718,n.k,o.Info,"Attempted to send postmessage: "+e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.Nr=e,this.ns=t,this.ht=i,this.Hr=r,this.Xr=s,this.Qr=a,this.Wr=e.diagnostics.AppInitDiagnostics,this.Mr=e.diagnostics.SessionTraces,this.Mr.wopiInitializeTime=$()}return e.prototype.Boot=function(){this.ht.ULS.ge(596444241,n.k,o.Info,"Initializing WAC frame");var e=Ot(this.Nr,this.ns,!0),t=function(e,t){var i={};if(e.wopiInfo&&(i[Re.wo]=e.wopiInfo.AccessToken,i[Re.So]=At(e.wopiInfo)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(i[Re.Io]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){var r=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.ge(593503580,n.k,o.Info,"Content bundle staleness - "+r),i[Re.bo]=r}else t.ULS.ge(593503581,n.k,o.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(i[Re.Ao]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.CustomFontCatalogUrl&&(i[Re.Fo]=e.wopiPrecheckInfo.CustomFontCatalogUrl),e.wopiPrecheckInfo.FileName){var s=ne(e.wopiPrecheckInfo.FileName);s&&(i[Re.Oo]=s),i[Re.Ro]=e.wopiPrecheckInfo.FileName}e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?i[Re.Po]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(i[Re.Po]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(i[Re.Go]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(i[Re.Bo]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(i[Re.Lo]=e.sessionInformation.SessionContext),e.diagnostics.HostInitDiagnostics&&(i[Re.Ho]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics,ClientDiagnostics:e.diagnostics.ClientDiagnostics})),i[Re.Eo]=se(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(i[Re.Jo]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),i[Re.No]=String(window.devicePixelRatio>1.24),i[Re.Vo]=String(d()),i[Re.Do]=e.sessionInformation.HostName;var a=e.newFileTemplateSource;a&&a.FileGetUrl&&(i[Re.jo]=a.FileGetUrl),a&&a.DocUniqueId?i[Re._o]=a.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(i[Re._o]=e.wopiPrecheckInfo.DocUniqueId),a&&a.ETag?i[Re.Co]=a.ETag:e.wopiPrecheckInfo.ETag&&(i[Re.Co]=e.wopiPrecheckInfo.ETag),i[Re.Xo]=(new Intl.DateTimeFormat).resolvedOptions().timeZone,e.sessionInformation.ContentAssembly&&(i[Re.Zo]="1"),"Templatization"!==e.sessionInformation.ContentAssemblyMode&&"DocGen"!==e.sessionInformation.ContentAssemblyMode||(i[Re.Zo]="1");var c=e.sessionInformation.Meeting;c&&(c.id&&(i[Re.Qo]=c.id),c.title&&(i[Re.Yo]=c.title),c.type&&(i[Re.er]=c.type),c.scheduledStartTime&&(i[Re.nr]=c.scheduledStartTime),c.scheduledEndTime&&(i[Re.nr]=c.scheduledEndTime),c.joinUrl&&(i[Re.sr]=encodeURIComponent(c.joinUrl)),c.organizerId&&(i[Re.rr]=c.organizerId),c.isPresenter&&(i[Re.or]=c.isPresenter.toString()),c.isMeetingTeamsRoom&&(i[Re.ar]=c.isMeetingTeamsRoom.toString()));var u=e.sessionInformation.OwlVersion;u&&(i[Re.ur]=u);var l=e.sessionInformation.OwlRollout;return l&&(i[Re.lr]=l),i[Re.cr]=V(),i}(this.Nr,this.ht);if(this.Hr.registerMessagePayloadHandler(ue.Ft,this.jr),this.Hr.registerMessagePayloadHandler(ue.Ut,this.Zr),this.Nr.sessionInformation.SupportsFrameTrustCheck||this.Hr.registerMessagePayloadHandler(ue.qt,this.zr),this.Hr.registerMessagePayloadHandler(ue.Si,this.qr),this.Hr.registerMessagePayloadHandler(ue.Zt,this.Yr),this.Hr.registerMessagePayloadHandler(ue.yi,this.ts),this.ns.ignoreWacFramePostMessages||this.Dr(w(e)),this.Ur(e,t),this.ns.ignoreWacFramePostMessages){var i=this.Kr();this.Xr(i)}return this.ht.ULS.ge(595661019,n.k,o.Info,"Created Wac Frame"),this.kr},e}(),Rt=!1,Pt=!1;function xt(){Rt=!1}function Ut(e,t,i,r,s,a,c){if(t.ULS.ge(595714433,n.k,o.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(Rt,"; unloading:").concat(Pt)),Rt||Pt&&e)t.ULS.ge(595714908,n.k,o.Info,"Application is already disposed or unloading");else{var u,l={logger:t,postMessenger:i,innerApplicationFrame:r,onDisposed:s,onFrameRemoved:a,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:$(),appUnloadTimedOut:!1};if(e&&r)return Pt=!0,l.forceAppUnload=!0,(u=l).forceAppUnloadStartTime=$(),u.logger.ULS.ge(595855490,n.k,o.Info,"Sending postmessage to unload app"),u.logger.ULS.flush(),u.postMessenger.registerMessagePayloadHandler(ue.Ti,(function(e){return function(e,t){e.forceAppUnloadEndTime=$(),e.appUnloadedMessageValues=t,e.logger.ULS.ge(595855491,n.k,o.Info,"AppUnloaded received from app"),Wt(e)}(u,e)})),u.postMessenger.sendPostMessage(u.innerApplicationFrame,le.Wn,{}),void window.setTimeout((function(){return function(e){!Pt&&Rt||(e.appUnloadTimedOut=!0,e.logger.ULS.ge(595855492,n.k,o.Info,"ApplicationUnload timed out, forcing dispose"),Wt(e))}(u)}),u.unloadTimeoutInMs);Wt(l)}}function Wt(e){if(!Rt)try{Rt=!0,Pt=!1,function(e){if(!e.innerApplicationFrame)return;e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0)}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:$(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime);e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime);if(e.appUnloadedMessageValues){var i=e.appUnloadedMessageValues,r=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-e.forceAppUnloadStartTime);var s=Number(i.appMessageSent);!isNaN(s)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-s);var a=Number(i.appUnloadStart),c=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),i.serverTimings){var u=i.serverTimings;for(var l in u)t["st-"+l.toString()]=u[l]}}e.logger.ULS.ge(595855436,n.k,o.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.ge(595714434,n.k,o.Error,"Error disposing: ".concat(oe(t)))}}var Mt,Nt=function(){function e(e,t,i,r,s,a,c){var u=this;this.os=!1,this.ss=!1,this.as=!1,this.us=null,this.ls=!0,this.fs=!1,this.ds=!1,this.hs=function(){u.ht.ULS.ge(596444231,n.k,o.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(u.ps,5e3),u.Hr.registerMessagePayloadHandler(ue.Ot,u.vs),u.Hr.registerMessagePayloadHandler(ue.gi,u.ms);var e=new Ft(u.Nr,u.ns,u.ht,u.Hr,u.Xr,u.Qr);u.kr=e.Boot()},this.ws=function(){var e={ParallelizeStartSession:u.ls,WacFrameIsLoaded:u.os,WacAcceptsStartSessionComplete:u.fs};u.ht.ULS.ge(596444232,n.k,o.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!u.ls||u.os&&!u.fs?u.os&&u.gs():u.Ss()},this.Is=function(){u.ht.ULS.ge(596444233,n.k,o.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),u.Nr.wopiInfo=u.bs;var e=new Ft(u.Nr,u.ns,u.ht,u.Hr,u.Xr,u.Qr);u.kr=e.Boot()},this._s=function(e){u.os?(u.ht.ULS.ge(595968481,n.k,o.Warning,"Fail called and wacframe is able to accept postmessages"),u.ys(e)):(u.ht.ULS.ge(595968482,n.k,o.Warning,"Fail was called on the session prior to WacReady."),u.us=e)},this.ys=function(e){u.ht.ULS.ge(596444189,n.k,o.Warning,"Fail called, sending the failure postmessage to IFrame"),u.Gr(le.Rn,e)},this.Ts=function(){u.ht.ULS.ge(596444190,n.k,o.Warning,"Fail called during single step boot, calling host failure callback..."),u.Qr({errorType:ke.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.ps=function(){u.os||(u.ht.ULS.ge(596444191,n.k,o.Warning,"Timeout Wac Ready"),u.Qr({errorType:ke.TimeoutWacReady,errorObject:void 0}))},this.Cs=function(){u.as||(u.Mr.timeoutCompleteOrFail=$(),u.ht.ULS.ge(596444192,n.k,o.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(u.Mr)))},this.Es=function(e,t,i){u.ds||(u.ht.ULS.ge(596444193,n.k,o.Info,"SessionCompletion timed out with no ack."),u.Os(e,t,i+1))},this.vs=function(e){if(u.Mr.readyMessageReceiveTime=$(),u.Gr(le.on,{}),u.os)u.ht.ULS.ge(596444194,n.k,o.Info,"Received multiple ready messages - frame is already loaded.");else{u.os=!0,u.fs=e&&e.CanAcceptStartSessionComplete;var t={AcceptStartSessionComplete:u.fs,ParallelizeStartSession:u.ls,StartSessionResponseAvailable:!!u.As,WopiInfoAvailable:!!u.bs};u.ht.ULS.ge(596444195,n.k,o.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),u.as&&(u.us?u.ys(u.us):u.Gr(le.xn,{})),u.ls&&u.fs?u.As&&u.Fs():u.bs&&u.gs(),De(u.Wr,e)}},this.ms=function(e){u.ds=!0,u.Mr.sessionCompleteAckReceivedTime=$()},this.Gr=function(e,t){u.Hr.sendPostMessage(u.kr,e,t)},this.Rs=function(e,t){u.Os(e,t,1)},this.Os=function(e,t,i){if(i>3)u.ht.ULS.ge(596444224,n.k,o.Error,"Attempted to call complete, but received no ack from the frame. Time: ".concat($()));else{u.ht.ULS.ge(596444225,n.k,o.Info,"Sending completion message to frame. Attempt number: ".concat(i,", Time: ").concat($()));var r=$();1===i&&(u.As&&u.As.Diagnostics&&(u.As.Diagnostics.completeMessageCreateTime=r),u.Mr.completeMessageCreateTime=r),t.Diagnostics.completeMessageSendTime=r,u.Mr.completeMessageSendTime=r,u.Gr(e,t),window.setTimeout((function(){return u.Es(e,t,i)}),1e3)}},this.Ss=function(){u.ht.ULS.ge(596444226,n.k,o.Info,"Making parallelized startSession request.");var e=u.Ps(u.bs),t={"Content-Type":"application/x-www-form-urlencoded"},i="access_token="+encodeURIComponent(u.bs.AccessToken)+"&access_token_ttl="+encodeURIComponent(At(u.bs));u.Mr.startSessionStartTime=$(),function(e,t,i,n){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),i)o.setRequestHeader(r,i[r]);o.send(t)}(e,i,t,u.xs)},this.xs=function(e){if(u.Mr.startSessionCompleteTime=$(),u.Mr.startSessionResponseStatus=e.status,u.As={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:u.Mr.wopiPendingInitializeTime,wopiPendingCompleteTime:u.Mr.wopiPendingCompleteTime,startSessionStartTime:u.Mr.startSessionStartTime,startSessionCompleteTime:u.Mr.startSessionCompleteTime,readyMessageReceiveTime:u.Mr.readyMessageReceiveTime}},u.ht.ULS.ge(596444227,n.k,o.Info,"StartSession request completed with status code: ".concat(u.As.StartSessionResponse.RequestStatus,", Time: ").concat($())),u.os&&u.fs)u.Fs();else{var t={WacFrameIsLoaded:u.os,InitializeCompleted:u.ss};u.ht.ULS.ge(596444228,n.k,o.Info,"StartSessionCompleted not called - "+JSON.stringify(t))}},this.gs=function(){if(!u.ss){u.ss=!0,u.ht.ULS.ge(596444229,n.k,o.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:u.bs.WopiSrc,AccessToken:u.bs.AccessToken,AccessTokenTtl:At(u.bs)},Diagnostics:{wopiPendingInitializeTime:u.Mr.wopiPendingInitializeTime,wopiPendingCompleteTime:u.Mr.wopiPendingCompleteTime,readyMessageReceiveTime:u.Mr.readyMessageReceiveTime}};u.Rs(le.ln,e)}},this.Fs=function(){200===u.As.StartSessionResponse.RequestStatus?u.ss||(u.ss=!0,u.Rs(le.un,u.As)):u.gs()},this.Ps=function(e){var t=u.Nr.applicationBasePath+"wordeditorstartsession.ashx",i=Ot(u.Nr,u.ns,!1);return t=E(t+="?"+i.substring(i.indexOf("?")+1),"WOPISrc",encodeURIComponent(e.WopiSrc)),t=E(t,"build",encodeURIComponent(V())),t=E(t,"WacUserType",encodeURIComponent("WOPI")),u.Nr.wopiPrecheckInfo.FileGetUrl&&(t=E(t,"fileGetUrlPresent","1")),t},this.Us=function(e){if(u.Nr.isCreateNew){if(!e||!e.NewFilePath)return void u.ht.ULS.ge(596444230,n.k,o.Info,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},this.Nr=e,this.ns=t,this.Wr=e.diagnostics.AppInitDiagnostics,this.ht=i,this.Hr=r,this.Xr=a,this.Qr=c,this.Mr=e.diagnostics.SessionTraces,this.Mr.wopiPendingInitializeTime=$(),this.Ws=s,xt(),window.setTimeout(this.Cs,5e3)}return e.prototype.Complete=function(e,t){if(this.as)this.ht.ULS.ge(596444184,n.k,o.Warning,"Complete called after Complete/Fail already called");else{this.ht.ULS.ge(596444185,n.k,o.Info,"Complete called."),this.as=!0,this.bs=e,this.Mr.wopiPendingCompleteTime=$();try{this.ns.isSingleStepBoot?this.Is():this.ws(),this.os&&this.Gr(le.xn,{}),this.Us(t)}catch(e){this.ht.ULS.ge(596444186,n.k,o.Error,"Unexpected script error: ".concat(oe(e))),z(this.Nr.remoteTelemetryUrl,"Excel","bootException")}finally{this.ht.ULS.flush()}}},e.prototype.Fail=function(e){this.as?this.ht.ULS.ge(596444187,n.k,o.Warning,"Fail called after Complete/Fail already called"):(this.ht.ULS.ge(596444188,n.k,o.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this.as=!0,this.ns.isSingleStepBoot?this.Ts():this._s(e),this.ht.ULS.flush())},e.prototype.Dispose=function(e,t,i){var n=this;Ut(e||!1,this.ht,this.Hr,this.kr,(function(){delete n.kr,t&&t(),n.Ws(),n.Hr.dispose()}),void 0,i)},e.prototype.Boot=function(){this.ns.isSingleStepBoot||this.hs(),this.ht.ULS.flush()},e}(),kt=((Mt={})[ce.blurFocus]=le.sn,Mt[ce.continueAccessibilityLoop]=le.fn,Mt[ce.grabFocus]=le.dn,Mt[ce.moveToFolder]=le.ii,Mt[ce.popState]=le.wn,Mt[ce.rename]=le.gn,Mt[ce.sendAccessToken]=le.Sn,Mt[ce.sendAuthToken]=le.In,Mt[ce.sendCustomAuthConfig]=le.bn,Mt[ce.sendEmbeddedViewUrl]=le.yn,Mt[ce.sendSessionInfo]=le.Tn,Mt[ce.sendUserAccessAndPermissions]=le.Cn,Mt[ce.sendWopiInfo]=le.En,Mt[ce.sendDavUrl]=le.On,Mt[ce.completeSharedFilePicker]=le.mi,Mt[ce.switchMode]=le.Un,Mt[ce.signalShared]=le.kn,Mt),Ht=function(){function e(e,t){var i,r,s=this;if(this.Ms=!1,this.Ns={},this.co="",this.uo="",this.do=!1,this.lo=!1,this.fo=!1,this.ho=!1,this.ks=[],this.Hs=!0,this.Ds=function(e,t,i){if(e){var r={MessageId:le.nn,CorrelationId:i,SendTime:$()};s.ht.ULS.ge(595732176,n.k,o.Info,"Sending Ack back"),e.postMessage(JSON.stringify(r),t)}else s.ht.ULS.ge(595736136,n.k,o.Info,"Missing target to send Ack back")},this.Js=function(e){var t,i=!1,r=!0,a="",c=!1;if(s.kr&&s.kr.contentWindow&&(i=!0,r=e.source===s.kr.contentWindow),e.origin&&(c=(a=_(e.origin,2).toLowerCase())===s.uo),!s.lo&&(!s.fo||c&&r)||s.ht.ULS.ge(595730526,n.k,o.Info,"Window is available: ".concat(i,", window is valid: ").concat(r,", origin is valid: ").concat(c,", expected origin: ").concat(s.uo,", actual origin: ").concat(a)),c&&(!s.do||r)){var u;try{u=JSON.parse(e.data)}catch(e){return void s.ht.ULS.ge(596464282,n.k,o.Info,"Failed to parse event data: ".concat(oe(e),"."))}var l=u.MessageId;if(l){if(s.ht.ULS.ge(595714715,n.k,o.Info,"Received messageId: ".concat(l,", correlation: ").concat(u.CorrelationId)),l!==ue.Rt&&l!==ue.ei||s.Bs(e.origin),s.ho&&l===ue.in)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[u.Values.name]=u.Values.time);u.Values&&u.Values.ackExpected&&s.Ds(e.source,e.origin,u.CorrelationId);var f=s.Ns[l];if(!f)return s.ht.ULS.ge(596464289,n.k,o.Info,"No handler found for message id: ".concat(l)),void(s.Hs&&l===ue.Xt&&(s.ks.push(u),s.ht.ULS.ge(543207888,n.k,o.Info,"Kept for later process: ".concat(l))));s.ht.ULS.ge(596464288,n.k,o.Info,"Processing message: ".concat(l));try{f(u.Values||{})}catch(e){s.ht.ULS.ge(593773704,n.k,o.Error,"Handler error: ".concat(oe(e)))}s.Hs&&l===ue.Rt&&s.Ls()}else(s.lo||s.fo)&&s.ht.ULS.ge(595730520,n.k,o.Info,"Could not find message id")}},this.Ls=function(){s.Hs=!1,s.ks.forEach((function(e){var t=e.MessageId,i=s.Ns[t];if(i){s.ht.ULS.ge(543207890,n.k,o.Info,"Processing message after boot complete: ".concat(t));try{i(e.Values||{})}catch(e){s.ht.ULS.ge(543207891,n.k,o.Error,"Handler error: ".concat(oe(e)))}}else s.ht.ULS.ge(543207889,n.k,o.Info,"No handler found after boot complete: ".concat(t))})),s.ks=[]},this.Vs=function(e,t,i){e.postMessage(t,i)},this.Bs=function(e){var t=e.toLowerCase();s.co&&s.co!==t&&s.ht.ULS.ge(596128131,n.k,o.Warning,"Updating origin: [".concat(x(s.co),"]->[").concat(x(t),"]")),s.co=t,s.uo=_(t,2),s.lo=w(t),s.fo=g(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.lo=w(e),this.fo=g(e),this.ht=t,this.Bs(e),this.ho=!!(null===(r=null===(i=window.location)||void 0===i?void 0:i.search)||void 0===r?void 0:r.match(/wdpa=1/gi))}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.Ns[e])throw new Error("Duplicate registration!");this.Ns[e]=t},e.prototype.removeMessageHandler=function(e){delete this.Ns[e]},e.prototype.sendPostMessage=function(e,t,i){if(e&&e.contentWindow){this.ht.ULS.ge(596464334,n.k,o.Info,"Sending message: "+t);var r={MessageId:t,SendTime:$(),Values:i};this.Vs(e.contentWindow,JSON.stringify(r),this.co)}else this.ht.ULS.ge(595948308,n.k,o.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.kr=e,this.do=!!t,this.Ms||(window.addEventListener("message",this.Js,!1),this.Ms=!0)},e.prototype.postMessageForCommand=function(e,t,i){var r=kt[t];r?(this.ht.ULS.ge(595702598,n.k,o.Info,"Sending message ".concat(r," for command ").concat(t)),this.sendPostMessage(e,r,i)):this.ht.ULS.ge(595702599,n.k,o.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.Ns={},this.Ms&&(window.removeEventListener("message",this.Js,!1),this.Ms=!1)},e}(),Dt=function(){function e(){var e=this;if(this.js=[],this.Ns=[],this.zs=function(){var t={visibility:document.visibilityState,time:$(),initialState:!1};e.js.push(t);for(var i=0,n=e.Ns;i<n.length;i++){var o=n[i];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:$(),initialState:!0};this.js.push(t)}document.addEventListener("visibilitychange",this.zs)}return e.prototype.registerEventHandler=function(e){this.Ns.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.Ns.indexOf(e);this.Ns.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.zs)},e.prototype.getVisibilityChangeEvents=function(){return this.js},e.prototype.dispose=function(){this.stop(),this.Ns=[],this.js=[]},e}();var Jt="excel-boot".concat(".min",".js"),Bt=[];function Lt(e){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",(function(){try{for(var t=0,i=window.performance.getEntriesByType("resource");t<i.length;t++){var r=i[t],s=A(r.name);if("about:blank"!==r.name&&-1===s.indexOf("RemoteUls.ashx")&&-1===s.indexOf("mhtml:file"))if(s===Jt)a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.ge(574662801,n.k,o.Info,a);else if(-1!==Bt.indexOf(s)){var a;a=(a=JSON.stringify(r)).replace(new RegExp(r.name,"g"),s),e.ULS.ge(595736532,n.k,o.Info,a)}}try{var c=window.performance.getEntriesByType("navigation"),u=void 0;if(c.length>0)u=c[0].type||"UndefinedType";else u="none";e.ULS.ge(555872898,n.k,o.Info,"Navigation type is: ".concat(u))}catch(t){e.ULS.ge(556011586,n.k,o.Info,"ExcelPreloader.tryObserveResourceTiming: Exception thrown when trying to read navigation type. Exception: "+JSON.stringify(t))}window.performance.clearResourceTimings()}catch(t){e.ULS.ge(595732049,n.k,o.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(t))}}),{once:!0})}var Vt;function jt(e,t){Vt=e;try{t.registerMessagePayloadHandler(ue.ki,(function(e){!function(e){if(!e||!e.hasOwnProperty("fileUrl")||!e.hasOwnProperty("fileType"))return void Vt.ULS.ge(572383453,n.k,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: Message is missing parameter(s). values=null? ".concat(!e,",\n        fileUrl=null? ").concat(e&&!e.hasOwnProperty("fileUrl"),", fileType=null? ").concat(e&&!e.hasOwnProperty("fileType")));try{var t=function(){var e=new qt,t=new XMLHttpRequest;return t.timeout=3e4,t.withCredentials=!0,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e.IsSucceeded=!0,e.HostCorrelationId=function(e){var t,i=null;try{var r=(new window.DOMParser).parseFromString(e,"text/xml"),s=new URL(null!==(t=r.documentElement.textContent)&&void 0!==t?t:"");i=s.searchParams.get("correlationId")}catch(e){Vt.ULS.ge(572383454,n.k,o.Warning,"ExcelFileBundleRegenerationRequester.readSpoCorrelationFromResponse: ".concat(oe(e)))}return i}(t.responseText)):e.FailureReason="XhrHttp".concat(t.status),zt(e))},t.onerror=function(t){e.FailureReason="XhrError",zt(e)},t}(),i=function(e){var t=new URL(e.fileUrl).origin,i=new URL(t);return i.pathname="_api/SP.Utilities.WOPIHostUtility.GenerateFileBundle",i.searchParams.set("fileUrl",e.fileUrl),i.searchParams.set("fileType",e.fileType),i}(e);t.open("GET",i.toString(),!0),t.send()}catch(e){Vt.ULS.ge(572381152,n.k,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: ".concat(oe(e)))}}(e)}))}catch(e){Vt.ULS.ge(572383452,n.k,o.Warning,"ExcelFileBundleRegenerationRequester.initRegenerateFileBundleMessageHandler: ".concat(oe(e)))}}function zt(e){Vt.ULS.ge(572383455,n.k,o.Warning,"ExcelFileBundleRegenerationRequester.logResult: ".concat(JSON.stringify(e)))}var Gt,qt=function(){this.IsSucceeded=!1,this.HostCorrelationId=null,this.FailureReason=null},Kt=function(){function e(e,t){var i=this;this.Gs=function(e,t){return window.setInterval((function(){i.Prefetch({BootstrapperUrl:e}),t.ULS.ge(595895774,n.k,o.Info,"Prefetching "+A(e))}),36e5)},this.qs=e,this.Ks=t}return e.prototype.GetVersion=function(){return V()},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){if(null!=e&&void 0!==e){var t=document.createElement("link");t.rel="prefetch";var i=e.BootstrapperUrl;".js"!==i.toString().slice(-3)&&(i+=".js"),t.href=i;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(t)}},e.prototype.InitializeWopiPending=function(e,t,i,r,s,a){var c,l,f,d,h,p=!1;try{i?f=i:(f=(c=me())[0],d=c[1]),z(je(e.ApplicationUrl,f),"Excel","init");var v,m=$();!function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");var n=e.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),e.ApplicationUrl=I(e.ApplicationUrl,C(e.ApplicationUrl,"region")),e.ApplicationUrl=function(e,t){if(!e)return e;var i=e,n=i.indexOf("?"),o=t.toLowerCase()+"=",r=i.toLowerCase().indexOf(o,n);if(r>=0){var s=i.indexOf("&",r);return"&"===(i=i.substring(0,r)+(-1===s?"":i.substring(s+1))).slice(-1)&&(i=i.slice(0,-1)),i}return e}(e.ApplicationUrl,"region"),function(e){var t,i=e.RebootOverrideData;if(i)if(i.queryOverrides||(i.queryOverrides={}),t=i.mode)"view"===(t=t.toLowerCase())?i.queryOverrides.wdforcedmode="View":"edit"===t&&(i.queryOverrides.wdforcedmode="Edit");else{var n=i.reason;n&&"saveas"===(n=n.toLowerCase())&&(i.queryOverrides.wdforcedmode="Edit")}}(e),l=t||ie({remoteUlsEndpoint:Ge(e.ApplicationUrl)+"RemoteUls.ashx",sessionId:f}),h=ze(e,f,l,s,a,this.Ks.forceSingleStepBoot),a||(h.ze.addSettingsChangeListener(l.settingsChangeHandler),h.ze.initializePeriodicFetch(h.applicationBasePath,f)),h.diagnostics.HostInitDiagnostics&&(h.diagnostics.HostInitDiagnostics.hostInitializeCallTime=m),Le(l,h,d),p=!0;var w=e.BootstrapperUrl;w&&(v=this.Gs(w,l));var g=function(){h.ze.dispose(),h.pageStateObserver.dispose(),window.clearInterval(v)},S=b(e.ApplicationUrl),_=r||new Ht(S,l),y=new Dt,T=Ct(h,l),E=function(e,t,i,r,s,a,c){return function(u){var l=e.diagnostics;Be(l,r),Je(l.SessionTraces,i,o.Info);var f=$t(l);i.ULS.ge(596448985,n.k,o.Info,JSON.stringify(f)),z(e.remoteTelemetryUrl,"Excel","bootSuccess");var d=c(e.sessionId,i,t,s,u);try{a(d,f)}catch(e){i.ULS.ge(595719171,n.k,o.Error,"Exception thrown from host's success callback: ".concat(oe(e)))}Ie("excel",i),Xt(i)}}(h,_,l,y,g,e.FnOnInitializeSuccess,this.qs),O=function(e,t,i,r){return function(s){var a=e.diagnostics;Be(a,i),Je(a.SessionTraces,t,o.Warning);var c=$t(a);void 0!==s&&"Js Boot Failed"!==s.errorObject.errorType&&t.ULS.ge(575931487,n.k,o.Error,"Core JS failure recieved "+JSON.stringify(s)),t.ULS.ge(596448986,n.k,o.Error,JSON.stringify({error:s,appInitDiagnostics:c})),z(e.remoteTelemetryUrl,"Excel","bootFailure");try{r(s,c)}catch(e){t.ULS.ge(595719172,n.k,o.Error,"Exception thrown from host's failure callback: ".concat(oe(e)))}Ie("excel",t),Xt(t)}}(h,l,y,e.FnOnInitializeFailure);u(),e.FnOnAppModeSwitched&&_.registerMessagePayloadHandler(ue.ti,e.FnOnAppModeSwitched),Tt(l,_),jt(l,_),Lt(l),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched;var A=C(h.applicationUrl,"uih");if(w&&this.Ks.preconnector&&this.Ks.preconnector.shouldPreconnect(A)&&this.Ks.preconnector.preconnect(w),w&&this.Ks.preloader&&this.Ks.preloader.shouldPreload(h.applicationUrl))try{var R=w;h.featureManager.isFeatureEnabled(te.$e)&&(l.ULS.ge(595645891,n.k,o.Info,"HTTP2 preload enabled"),R=F(w));var P=h.sessionInformation.UiLocale;P||(P=decodeURIComponent(C(h.applicationUrl,"ui"))),this.Ks.preloader.preload(R,P,l,h.featureManager)}catch(e){l.ULS.ge(595943884,n.k,o.Error,oe(e))}var x=new Nt(h,T,l,_,g,E,O);return x.Boot(),x}catch(t){return l&&(l.ULS.ge(596459925,n.k,o.Error,"".concat(ke.AppInitError,": ").concat(oe(t))),p||Le(l,h||ze(e,f,l,s,a,this.Ks.forceSingleStepBoot),d),l.ULS.flushOnClose()),void(e&&(e.ApplicationUrl&&z(je(e.ApplicationUrl,f),"Excel","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:ke.AppInitError,errorObject:t})))}},e}();function Xt(e){e.ULS.ge(590914655,n.k,o.Info,"Time spent logging: ".concat(e.getTimeSpentLogging()))}function $t(e){return we(we(we({},e.AppInitDiagnostics),e.HostInitDiagnostics),{SessionTraces:e.SessionTraces})}!function(e){e.BrowserEvent="BrowserEvent",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(Gt||(Gt={}));var Zt=function(){function e(e,t,i,r,s){var a=this;this.Ns={},this.Xs=function(){a.Hr.registerMessagePayloadHandler(ue.li,a.$s),a.Hr.registerMessagePayloadHandler(ue.Qt,a.Zs),a.Hr.registerMessagePayloadHandler(ue.Yt,a.Qs),a.Hr.registerMessagePayloadHandler(ue.Xt,a.Ys),a.Hr.registerMessagePayloadHandler(ue.Ii,a.ea),a.Hr.registerMessagePayloadHandler(ue.$t,a.ta),a.Hr.registerMessagePayloadHandler(ue.ii,a.ia),a.Hr.registerMessagePayloadHandler(ue.mi,a.na)},this.oa=function(e,t){var i=a.Ns[e];if(i)try{i(t||{})}catch(e){a.ht.ULS.ge(593773706,n.k,o.Error,"Handler error: ".concat(oe(e)))}},this.$s=function(e){e.previousSessionId=a.ra,a.oa(Gt.DocumentReboot,e)},this.Zs=function(e){a.oa(Gt.WopiInfoFromUrl,e)},this.Qs=function(e){a.oa(Gt.DavUrlFromIds,e)},this.Ys=function(e){Promise?a.sa.isResourceTrustedForMessage(e).then((function(t){t?a.oa(Gt.GetAuthToken,e):a.Hr.sendPostMessage(a.kr,le.In,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){a.Hr.sendPostMessage(a.kr,le.In,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):a.Hr.sendPostMessage(a.kr,le.In,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.ea=function(e){a.oa(Gt.FileShare,e)},this.ta=function(e){a.oa(Gt.GetCustomAuthConfig,e)},this.ia=function(e){a.oa(Gt.MoveToFolder,e)},this.na=function(e){a.oa(Gt.SharedFilePicker,e)},this.ra=e,this.ht=t,this.kr=s.innerApplicationFrame,this.Hr=i,this.aa=r,this.sa=new Oe(t),this.Xs(),xt()}return e.prototype.GetApplicationType=function(){return"Excel"},e.prototype.GetVersion=function(){return V()},e.prototype.GetSessionId=function(){return this.ra},e.prototype.RegisterEventHandler=function(e,t){switch(e){case Gt.Unloaded:case Gt.Disposed:case Gt.DocumentReboot:case Gt.WopiInfoFromUrl:case Gt.DavUrlFromIds:case Gt.GetAuthToken:case Gt.GetCustomAuthConfig:case Gt.MoveToFolder:case Gt.SharedFilePicker:case Gt.SetOverlayContent:case Gt.FileShare:if(this.Ns[e])throw new Error("Duplicate registration");this.Ns[e]=t;break;default:this.Hr.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case Gt.Unloaded:case Gt.Disposed:case Gt.DocumentReboot:case Gt.FileShare:case Gt.WopiInfoFromUrl:case Gt.DavUrlFromIds:case Gt.GetAuthToken:case Gt.GetCustomAuthConfig:case Gt.MoveToFolder:case Gt.SharedFilePicker:case Gt.SetOverlayContent:if(this.Ns[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ns[e];break;default:this.Hr.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.Hr.postMessageForCommand(this.kr,e,t)},e.prototype.Dispose=function(e,t){var i=this;Ut(e||!1,this.ht,this.Hr,this.kr,(function(){delete i.kr,i.aa(),i.Hr.dispose(),i.oa(Gt.Unloaded,{})}),(function(){try{i.oa(Gt.Disposed,{}),i.Ns={}}catch(e){i.ht.ULS.ge(589108815,n.k,o.Error,"onFrameRemoved error: ".concat(oe(e)))}}),t)},e}();function Qt(e){return nt(e)&&!Yt}var Yt=[r.Chrome,r.Edge].includes(c())&&"https://onedrive.live.com"!==window.location.origin.toLowerCase();function ei(e,t,i,r,s){var a={};if(s)a=s;else try{a=JSON.parse( '{"ewa.strings.wac.js":{"UrlHash":"h04621391CD8377C3","SriHash":"BGITkc2Dd8PMVgmBqvijW4iClMEc/JhdtvnWtBLnSWg="},"ewrdefault.css":{"UrlHash":"h2A8463174AF008C9","SriHash":"KoRjF0rwCMnNhyF2KxHMLGw+MwZ0CcEIyW1AX5FWWK0="},"excelframe.css":{"UrlHash":"h86420382E373A1B6","SriHash":"hkIDguNzobZN75G3ql+LC6o/F0ze75Y66d7nhCOELK0="},"gridrenderer.min.js":{"UrlHash":"h07B1CD82A6CC1E49","SriHash":"B7HNgqbMHkmi6xyJK1bOypeRWOSwWDS2KKciHRidzxA="},"microsoftajaxds.js":{"UrlHash":"h16ABB4D4FBDA7915","SriHash":"Fqu01PvaeRU3AJrOEzCepf9H1zHEwRcZ16pClNhDus4="},"ewads.js":{"UrlHash":"hCD2BF749A04F6B61","SriHash":"zSv3SaBPa2FdIYrUMrKVQpehQzE5KkrZtK4cpPgUcXY="},"ewads.bootcommon.js":{"UrlHash":"hFD8C58C547F245F5","SriHash":"/YxYxUfyRfWKh+h3JBl++ml9aFrr3IEcIWFG6+JLBxw="},"ewadsesnext.js":{"UrlHash":"h485AB0BFA926344D","SriHash":"SFqwv6kmNE3Ue26gk5dOhih+gxoLgn6+JZ9wY6GhUSI="},"ewadsesnext.bootcommon.js":{"UrlHash":"hCE6939C228E8BF6E","SriHash":"zmk5wijov26J1p0wpQQdYjHeQLe3l1RjXrk9Rpjp9zg="}}')}catch(e){r&&r.ULS.ge(589178847,n.k,o.Info,"GetExcelResources failed to parse hash dictionary")}for(var c=F("".concat(b(e)).concat("/x/","s/")),u=function(e){var t=e?e.toLowerCase().split("-")[0]:"en";return N[t]}(null!=t?t:"en-US"),l=[],f=0,d=function(e){var t=function(){try{return new Function("(a = 0) => a"),!0}catch(e){return!1}}()?"EwaDSEsNext":"EwaDS",i=[["App_Scripts/".concat(t).concat("",".js"),!1],["App_Scripts/gridRenderer".concat(".min",".js"),!1],["App_Scripts/MicrosoftAjaxDS".concat("",".js"),!1],["App_Scripts/".concat(t).concat("",".bootCommon.js"),!1]];e&&(i=i.concat([["App_Scripts/".concat(e,"/Ewa.Strings.Wac").concat("",".js"),!0],["Resources/".concat(e,"/EwrDefault.css"),!0],["Resources/".concat(e,"/excelframe.css"),!0]]));return i}(u);f<d.length;f++){var h=d[f],p=h[0],v=h[1],m=p.substring(p.lastIndexOf("/")+1);if(Bt.push(m),!v||"1033"===u){var w=m.toLowerCase();if(console.log("lowerCaseFile"),a&&a[w]){var g=a[w].UrlHash,S=a[w].SriHash;if(g&&S){var I=c+g+"__layouts/"+p;l.push([I,"sha256-"+S]),r&&r.ULS.ge(589178849,n.k,o.Info,"GetExcelResources adding hashed url for ".concat(m))}}}}return l}var ti=function(e,t,i,r,s){return e!==ue.li?Promise.reject("Wrong flow"):new Promise((function(e){i.pendingReboot=!0;var r=void 0;if(t.queryOverrides)try{r=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.ge(592217694,n.k,o.Error,"Failed to parse queryOverrides: ".concat(r))}i.raiseEvent(fe.Reboot,we(we({},t),{previousSessionId:i.sessionId,queryOverrides:r})),e({completion:"success"})}))};function ii(e){return function(e,t){var i={};t&&Object.keys(t).forEach((function(e){i[e.toLowerCase()]=t[e]}));return e.split("&").forEach((function(e){if(/^wd\w+=\w+/i.test(e)){var t=e.split("=");i[t[0].toLowerCase()]=t[1]}})),i}(window.location.search.substring(1),e)}function ni(e,t,i){var n=we(we(we({},O(e.appUrl)),function(e){var t={};y(t,"jsapi","1"),y(t,"jsapiver","v2"),y(t,"corrid",e.sessionId),y(t,"usid",e.sessionId),y(t,"newsession","1"),y(t,"sftc","1"),e.hostSessionId&&y(t,"hid",encodeURIComponent(e.hostSessionId));var i=e.host;i.uiHostName&&y(t,"uih",i.uiHostName),i.uiHostIntegrationType&&y(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&y(t,"muv",encodeURIComponent(i.metaUiHostVersion));var n=i.capabilities;n&&(n.accessibilityLoop&&y(t,"accloop","1"),n.rebootDoc&&y(t,"sdr",n.rebootDoc.toString()),n.createNewDoc&&y(t,"scnd","1"),n.authToken&&y(t,"sat","1"),n.customAuthConfig&&y(t,"cac","1"),n.refreshAccessToken&&y(t,"rat","1"),n.atMentions&&y(t,"sams","1"),n.moveToFolder&&y(t,"mtf","1"),n.noBrowserModalDialogs&&y(t,"nbmd","1"),n.commonFilePicker&&y(t,"sfp","1"),n.directDownload&&y(t,"sdd","1"),n.directPrint&&y(t,"sdp","1"));var o=e.ui;o.language&&y(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&y(t,"uiembed","1"),o.hideHeader&&y(t,"hhdr","1"),o.highContrast&&y(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&y(t,"hodflp","1"),o.hideAppLauncherInHeader&&y(t,"halh","1"),o.hideChatInHeader&&y(t,"hch","1"),o.hideMeInHeader&&y(t,"hmh","1"),o.hideSearchInHeader&&y(t,"hsh","1"),o.hideWorkflowInHeader&&y(t,"hwfh","1"),o.hideSettingsInHeader&&y(t,"hsth","1"),o.showAppIconInHeader&&y(t,"sih","1"),o.useNeutralColorInHeader&&y(t,"unh","1"),o.openLinksInNewWindow&&y(t,"onw","1"),o.useDarkTheme&&y(t,"udt","1"),"DocGen"===o.contentAssemblyMode&&y(t,"readOnly","1");var r=e.wopi;r&&r.source&&y(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&y(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&y(t,"readonly","1"),s.disableChat&&y(t,"dchat","1"),s.cookieCompliant&&y(t,"mscc","1"),s.isNewFile&&(y(t,"new","1"),s.isFromHostTemplate&&y(t,"wdtpl","fromhost"))),e.user.isLicensed&&y(t,"islicenseduser","1"),e.user.isSynthetic&&y(t,"syn","1"),e.actNavId&&y(t,"actnavid",e.actNavId),e.sessionContext&&y(t,"sc",encodeURIComponent(e.sessionContext));var a=e.wdParams;if(a)for(var c in a)y(t,c,a[c]);var u=e.preseededSession;u&&(u.key&&y(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&y(t,"preseededwacsessionid",encodeURIComponent(u.id)));var l=e.throttling;l&&(l.protection&&y(t,"ctp",l.protection),l.request&&y(t,"rct",l.request));var f=e.hostInitDiagnostics;f&&(f.entryPoint&&y(t,"wdorigin",encodeURI(f.entryPoint)),f.userClickTime&&y(t,"wdhostclicktime",f.userClickTime.toString()));var d=e.rebootOverride;return d&&d.previousSessionId&&y(t,"wdprevioussession",d.previousSessionId),T(t,"region"),t}(e)),i),o=e.rebootOverride;return o&&o.queryOverrides&&(n=we(we({},n),o.queryOverrides)),function(e,t,i){var n=[];for(var o in i)i[o]&&n.push(o+"="+i[o]);return e+t+(n.length>0?"?"+n.join("&"):"")}(e.appBasePath,t,n)}function oi(e,t){var i=function(e){var t={};y(t,"highdpi",String(window.devicePixelRatio>1.24)),y(t,"softblockedbrowser",String(d())),y(t,"hostname",e.hostName),y(t,"feature_status",se(e.featureManager,e.wdParams)),y(t,"jsapibuild",V());var i=e.wopi;i&&(y(t,"access_token",i.accessToken),y(t,"access_token_ttl",i.expiry.toString()));var r=e.customFontCatalogUrl;r&&y(t,"customfontcatalogurl",r);var s=e.contentBundle;if(s&&s.url){y(t,"bundlesrc",s.url);var a=s.staleness,c=null!=a;c&&y(t,Re.bo,a.toString()),e.logger.ULS.ge(577783775,n.k,o.Info,"Content bundle staleness: "+(c?a:"N/A"))}var u=e.file,l=u.name;if(l){y(t,"filename",l);var f=ne(l);f&&y(t,"fileextension",f)}u.getUrl&&y(t,"filegeturl",u.getUrl),u.size&&y(t,"filesize",u.size.toString()),u.eTag&&y(t,"etag",u.eTag),u.cTag&&y(t,"revid",u.cTag),u.uniqueId&&y(t,"docid",u.uniqueId);var h=e.newFileTemplate;h&&(h.getUrl&&y(t,"templateurl",h.getUrl),h.size&&y(t,"filesize",h.size.toString()),h.eTag&&y(t,"etag",h.eTag),h.uniqueId&&y(t,"docid",h.uniqueId)),e.user.id&&y(t,"user_id",e.user.id),e.ownerId&&y(t,"owner_id",e.ownerId),e.sessionContext&&y(t,"sc",e.sessionContext);var p=e.ui;p.controls&&y(t,"huictrls",JSON.stringify(p.controls)),p.contentAssembly&&y(t,"caae","1"),"Templatization"!==p.contentAssemblyMode&&"DocGen"!==p.contentAssemblyMode||y(t,"caae","1");var v=e.meeting;v&&(v.id&&y(t,"meetingId",v.id),v.title&&y(t,"meetingTitle",v.title),v.type&&y(t,"meetingType",v.type),v.scheduledStartTime&&y(t,"scheduledStartTime",v.scheduledStartTime),v.scheduledEndTime&&y(t,"scheduledEndTime",v.scheduledEndTime),v.isPresenter&&y(t,"isPresenter",v.isPresenter.toString()),v.organizerId&&y(t,"meetingOrganizerId",v.organizerId),v.joinUrl&&y(t,"meetingJoinUrl",encodeURIComponent(v.joinUrl)),v.isMeetingTeamsRoom&&y(t,"isMeetingTeamsRoom",v.isMeetingTeamsRoom.toString()));var m=e.host;return m.owlVersion&&y(t,"owlver",m.owlVersion),m.owlRollout&&y(t,"owlro",m.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?i[e]=t[e]:delete i[e]})),i}var ri=function(e,t,i,r,s){return e!==ce.boot?Promise.reject("Wrong flow"):new Promise((function(e){var a,c=$();if(i.state=D.Booting,i.pendingReboot=!1,function(e,t){if(!e)throw new TypeError("SessionBootParams");var i=e.appUrl,n=e.appBaseUrl;if(!i&&!n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(i&&"string"!=typeof i)throw new TypeError("AppUrl");if(n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");var o=e.file;if(!o||!o.name)throw new TypeError("FileInfo");var r,s=e.container;if(!s||!(s instanceof Ne)&&!s.appendChild)throw new TypeError("Container");if(!t&&(!((r=e.wopi)&&r.source&&r.accessToken)||!r.expiry&&0!==r.expiry))throw new TypeError("WopiInfo")}(t,i.skipWopiValidation),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.hostInitDiagnostics=we(we({},t.diagnostics),{hostInitializeCallTime:c}),i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=ii(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},t.appUrl){var u=t.appUrl;i.appUrl=u;var l=i.bootParams;if(R(u,"new")&&(l.isNewFile=!0),!l.dataLanguage)(f=P(u,"rs"))&&(l.dataLanguage=f);var f,d=i.ui;if(R(u,"uiembed")&&(d.uiEmbed=!0),!d.language)(f=P(u,"ui"))&&(d.language=f);if(!i.hostInitDiagnostics.entryPoint){var h=P(u,"wdorigin");h&&(i.hostInitDiagnostics.entryPoint=h)}if(!i.host.uiHostName){var p=P(u,"uih");p&&(i.host.uiHostName=p)}}else i.appUrl="";i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():b(t.appUrl).toLowerCase(),i.appBaseUrl=I(i.appBaseUrl,C(i.appUrl,"region")),r.initializeAppContext(i,e,t),i.appBasePath=r.buildAppBasePath(i),i.remoteTelemetryUrl=r.buildRemoteTelemetryUrl(i),z(i.remoteTelemetryUrl,i.appInfo.name,"init");var v=!1,m=i.preseededSession;i.appInfo.usePreseededSessionId&&m&&m.id&&(i.sessionId=m.id,v=!0);var g,S=!1,_=t.hostGeneratedSessionId;!v&&_&&(i.sessionId=_,S=!0),t.rebootOverride&&(v||S||(a=me(),i.sessionId=a[0],g=a[1]),i.ze.addSettingsChangeListener(i.logger.settingsChangeHandler),i.pageStateObserver=new Te(i.logger,!0),i.authTokenTrustValidator=new Oe(i.logger)),i.logger.ULS.ge(38580693,n.k,o.Info,"User session id: ".concat(i.sessionId,", is preseeded: ").concat(v,", is host generated: ").concat(S));var y=i.ze.getValue(Q.je,"").toString();if(""===y&&(y=i.appBasePath+"RemoteUls.ashx"),i.logger.configure({remoteUlsEndpoint:y,sessionId:i.sessionId}),i.ze.initializePeriodicFetch(i.appBasePath,i.sessionId),g&&i.logger.ULS.ge(590966790,n.k,o.Info,JSON.stringify(g)),function(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.ge(558155803,n.k,o.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.ge(596444237,n.k,o.Info,JSON.stringify({session:be(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.ge(558155804,n.k,o.Error,"Failed to log init info: ".concat(oe(t)))}}(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:V(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){i.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!i.container){var T=t.container;i.container=T instanceof Ne?T:i.application.createContainer(T)}i.container.setMessageHandler(i.onMessage);var E=!!r.ignoreCompletionMessage&&r.ignoreCompletionMessage(i),O=function(e,t){var s,a;i.successTime=$(),E||(i.container.postMessage(le.cn,void 0),s=i.appInitDiagnostics,(a=t.Diagnostics)&&Object.keys(a).forEach((function(e){s[e]=a[e]}))),r.onSuccess&&r.onSuccess(i,t),i.logger.ULS.ge(596448985,n.k,o.Info,JSON.stringify(i.diagnostics)),z(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(le.vn,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=D.Booted,x({completion:"success"}),Ie(i.appInfo.name,i.logger)},A=function(e,t){i.failureTime=$(),r.onFailure&&r.onFailure(i,t.Error),i.logger.ULS.ge(596448986,n.k,o.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),z(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=D.Failed,x({completion:"failure"}),Ie(i.appInfo.name,i.logger)},x=function(t){E||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(ue.Rt,O),i.removeActionHandler(ue.At,A)),e(t)};s&&s.subscribe((function(){x({completion:"cancelled"})})),E||(i.addActionHandler(ue.Rt,O),i.addActionHandler(ue.At,A));var U=r.buildBootRequestParams(i),W=ni(i,U.appPageName,U.queryParamsOverrides),M=oi(i,U.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(W))try{r.beforePreload&&r.beforePreload(i);var N=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(te.$e)&&(i.logger.ULS.ge(590966791,n.k,o.Info,"HTTP2 preload enabled"),N=F(N)),i.preloader.preload(N,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.ge(590966792,n.k,o.Error,oe(e))}r.beforeContainerBoot&&r.beforeContainerBoot(i,W),i.appInitDiagnostics.officeFrameCreateTime=$(),i.container.boot(W,M,i.logger,r.buildContainerBootParams(i)),E?O(ue.Rt,{Diagnostics:{}}):(i.bootHeartBeat=new qe(w(i.appBaseUrl),i.ze,i.logger,(function(){i.timeoutTime=$(),r.onTimeout&&r.onTimeout(i),z(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),s?s.cancel():x({completion:"cancelled"})}),s?s.timeoutInMs:r.overrideBootTimeout?r.overrideBootTimeout(i):void 0),r.beforeBootCompletionMessage&&r.beforeBootCompletionMessage(i))})).catch((function(e){throw i.failureTime=$(),r.onException&&r.onException(i,e),i.remoteTelemetryUrl&&z(i.remoteTelemetryUrl,i.application.name,"bootException"),e}))},si=function(e,t,i,r,s){return e!==ue.Ut?Promise.reject("Wrong flow"):new Promise((function(e){try{window.close()}catch(e){i.logger.ULS.ge(579213189,n.k,o.Warning,"Failed to close the browser tab")}e({completion:"success"})}))},ai=function(e,t,i){return new Promise((function(t){i.logger.ULS.ge(590111070,n.k,o.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))},ci=function(){function e(e){var t=this;this.ca=!1,this.ua=[],this.cancel=function(){t.ca||(t.ca=!0,t.ua.map((function(e){return e()})),t.ua=[])},this.la=e,window.setTimeout(this.cancel,e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.ca},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.la},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e){this.ca?e():this.ua.push(e)},e}();function ui(e){return new ci(e)}var li=function(e,t,i,r,s){return e!==ce.dispose?Promise.reject("Wrong flow"):new Promise((function(e){i.logger.ULS.ge(595714433,n.k,o.Info,"start disposing the application");var a=i.host.requireExplicitUnload,c={disposeStartTime:$(),forceAppUnload:a};i.state=D.Disposing;var u=function(){i.state=D.Disposed,e({completion:"success"})},l=function(e){r&&r.disposeAppSpecificResources&&r.disposeAppSpecificResources(i,t),i.dispose(),c.disposeEndTime=$(),function(e,t,i){if(i){var r=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(r)&&(t.hostToAppPostMessageLatency=r-t.appUnloadStartTime);var s=Number(i.appMessageSent);!isNaN(s)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-s);var a=Number(i.appUnloadStart),c=Number(i.appUnloadEnd);if(isNaN(a)||isNaN(c)||(t.appUnloadLatency=c-a),i.serverTimings){var u=i.serverTimings;for(var l in u)t["st-"+l.toString()]=u[l]}}e.logger.ULS.ge(592524822,n.k,o.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,c,e),i.container?i.container.dispose(i.pendingReboot,a).then(u):u()};if(a){c.appUnloadStartTime=$();i.addActionHandler(ue.Ti,(function(e,t){c.appUnloadEndTime=$(),l(t)})),(s||new ci(5e3)).subscribe((function(){i.state===D.Disposing&&(c.appUnloadTimedOut=!0,l())})),i.container&&i.container.postMessage(le.Wn,void 0)}else l()}))};var fi=function(e,t,i,r,s){return e!==ue.qt?Promise.reject("Wrong flow"):new Promise((function(e){if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(fe.FrameTrust,t);else{var r=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.ge(592445957,n.k,o.Info,"Top frame is trusted: ".concat(r)),i.container&&i.container.postMessage(le.qt,{isTopFrameTrusted:r})}e({completion:"success"})}))},di=function(e,t,i,n,o){return e!==ue.Xt?Promise.reject("Wrong flow"):new Promise((function(e){i.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(n){n?i.raiseEvent(fe.GetAuthToken,t):(i.container.postMessage(le.In,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(n){i.container.postMessage(le.In,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:n})}))}))},hi=function(e,t,i,r,s){return e!==ue.Ft?Promise.reject("Wrong flow"):new Promise((function(e){var s=t&&t.state?t.state:"Unknown";i.logger.ULS.ge(592839750,n.k,o.Info,"Boot state: [".concat(s,"]")),r&&r.beforeComplete&&r.beforeComplete(s),e({completion:"success"})}))},pi=function(e,t,i,n,o){return e!==ce.rename?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,i){var n={completion:i.NewName===t.NewName?"success":"failure"};s(n)},r=function(e,t){s({completion:"failure"})},s=function(t){i.removeActionHandler(ue.Vt,n),i.removeActionHandler(ue.jt,r),e(t)};i.addActionHandler(ue.Vt,n),i.addActionHandler(ue.jt,r),(o||new ci(5e3)).subscribe((function(){s({completion:"cancelled"})})),i.container&&i.container.postMessage(le.gn,t)}))},vi=function(e,t,i,n,o){return e!==ce.switchMode?Promise.reject("Wrong flow"):new Promise((function(e){var n=function(e,t){r({completion:"success"})},r=function(t){i.removeActionHandler(ue.ti,n),e(t)};i.addActionHandler(ue.ti,n),(o||new ci(5e3)).subscribe((function(){r({completion:"cancelled"})})),i.container&&i.container.postMessage(le.Un,t)}))};function mi(e){}function wi(e){Lt(e.logger)}function gi(e){return e.appBaseUrl+"/x/"}function Si(e){return t=e.appBasePath+"_layouts/",i=e.sessionId,t+"RemoteTelemetry.ashx"+(i?"?usid="+i:"");var t,i}function Ii(e){var t=e.appUrl,i=nt(t),r=ot(t),s=rt(t);return i||r||s||e.logger.ULS.ge(553673218,n.k,o.Warning,"Unknown endpoint: ".concat(A(t))),!(i||r)}function bi(e){var t=e.appUrl,i=nt(t),n=ot(t),o=rt(t),r=i?"_layouts/xlviewerinternal.aspx":n?"_layouts/xlembed.aspx":o?"_layouts/xlpreview.aspx":function(e){var t=e.toLowerCase().indexOf("/x/");if(t<0)return"";var i=e.indexOf("?");return i<0?e.substring(t+"/x/".length):i<t?"":e.substring(t+"/x/".length,i)}(t),s={},a={};y(s,"wdredirectionreason","Force_SingleStepBoot");var c=e.host.capabilities;c&&c.excelExternalLinks&&y(s,"xlel","1");var u=e.viewMode;u&&(u.hideToolbar&&y(s,"hvt","1"),u.hideEditUpsellDialog&&y(s,"hdeditdlg","1"));var l=e.bootParams;l&&l.isNewFile?(T(s,"unified"),y(s,"edit","1"),y(s,"new","1")):y(s,"instantedit","1"),y(a,Re.Ho,JSON.stringify({HostInitializeDiagnostics:e.hostInitDiagnostics,ClientDiagnostics:e.clientDiagnostics})),y(a,Re.Xo,(new Intl.DateTimeFormat).resolvedOptions().timeZone);var f=e.rebootOverride;if(f){var d=f.mode;d&&("view"===(d=d.toLowerCase())?y(s,"wdforcedmode","View"):"edit"===d&&y(s,"wdforcedmode","Edit"))}var h=e.file.size;return h&&h>=52428800&&h<=104857600&&y(s,"ilf","1"),{appPageName:r,queryParamsOverrides:s,postDataOverrides:a}}function _i(e,t){St(t)&&mt(e.logger,e.container.formId,e.featureManager,e.sessionId)}function yi(e){return{permissionsPolicy:(t=e.appBaseUrl,"microphone ".concat(t,"; autoplay ").concat(t,"; camera ").concat(t,"; clipboard-read ").concat(t,"; clipboard-write ").concat(t,"; keyboard-map ").concat(t,"; display-capture ").concat(t))};var t}var Ti,Ci=function(){var e,t;return[(e={},e[ae.appReboot]=ti,e[ae.boot]=ri,e[ae.closeTab]=si,e[ae.createNew]=ai,e[ae.dispose]=li,e[ae.frameTrust]=fi,e[ae.getAuthToken]=di,e[ae.getHostKeyValue]=et,e[ae.handleBootState]=hi,e[ae.rename]=pi,e[ae.setOverlayContent]=Ze,e[ae.storeHostKeyValue]=it,e[ae.switchMode]=vi,e[ae.updateBootComplete]=ai,e),(t={},t[ae.boot]={initializeAppContext:mi,beforePreload:wi,buildAppBasePath:gi,buildRemoteTelemetryUrl:Si,ignoreCompletionMessage:Ii,buildBootRequestParams:bi,beforeContainerBoot:_i,buildContainerBootParams:yi,onSuccess:gt},t[ae.handleBootState]={beforeComplete:wt},t)]};!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(Ti||(Ti={})),i.d(t,"Application",(function(){return Ei})),i.d(t,"createApplication",(function(){return Oi})),i.d(t,"DocRebootSupportMode",(function(){return Ti})),i.d(t,"CommandIds",(function(){return ce})),i.d(t,"EventIds",(function(){return fe})),i.d(t,"createCancellationToken",(function(){return ui}));var Ei=new Kt((function(e,t,i,n,o){return new Zt(e,t,i,n,o)}),{forceSingleStepBoot:!1,preloader:U(Qt,ei),preconnector:H(!0)}),Oi=function(e){var t={name:"Excel",preloader:U(Qt,ei),preconnector:H(!0)};return new He(e,t,Ci)}}});

