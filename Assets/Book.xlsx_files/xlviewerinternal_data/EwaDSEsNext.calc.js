'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1163:function(t,E,a){t=a(0);var c=a(15),b=a(222),e=a(8),f=a(111);a(201);var d=a(187),h=a(83),m=a(177),l=a(185),w=a(66);class n{}n.local="Local";n.wQj="Thread";Object(t.a)(n,"RecalcServiceCreateMode",null,[]);var x=a(162);class r{constructor(ca){this.j8d=null;this.init(ca)}get V$(){return this.j8d}init(ca){this.j8d=new m.a;if(void 0!==ca&&null!==ca&&void 0!==ca.HeadersList&&null!==ca.HeadersList&&0<ca.HeadersList.length)for(const ja of ca.HeadersList)this.V$.ia(ja.Index,
ja.Name)}}Object(t.a)(r,"ColHeadersListData",null,[]);var u=a(1),v=a(33),B=a(100),z=a(22),A=a(21),y=a(175);class D{constructor(ca,ja){this.JAe=ca;this.sheetName=ja;this.vyc=!1}}Object(t.a)(D,"CalcBlockInformation",null,[]);class I{constructor(ca,ja,ua,Za,Pa){this.type=ca;this.fullName=ja;this.range=ua;this.sheetId=Za;this.attributes=Pa;this.eF=null}}Object(t.a)(I,"CalcNamedObject",null,[]);class M{constructor(ca){this.Dlg=ca;this.wle=[];this.Uig=[];this.Q0a={};this.EUd=new Map}get Tj(){return this.wle}K6f(ca,
ja){this.wle[ca]=ja;this.Dlg&&ja.S7&&this.EUd.set(ja.S7.sheetName,ca)}getSheetIndex(ca){if(this.Dlg){if(this.EUd.has(ca))return this.EUd.get(ca)}else for(let ja=1;ja<this.Tj.length;ja++)if(z.a.equals(this.Tj[ja].S7.sheetName,ca,!1))return ja;return-1}}Object(t.a)(M,"GridCache",null,[]);var T=a(685),S=a(554);class H{constructor(ca){this.S7=ca;this.y6=new T.a(S.a.ak());this.uoc=!1}}Object(t.a)(H,"SheetInformation",null,[]);var C=a(940),G;(function(ca){ca[ca.initialization=0]="initialization";ca[ca.contentReady=
1]="contentReady";ca[ca.cellEdit=2]="cellEdit"})(G||(G={}));Object(t.b)("UpdateDataTrigger",G);class J{constructor(ca){this.eLd=null;this.txd=this.dLd=this.kFd=!1;this.UId=0;this.MId=this.OId=this.PId=this.NId=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.gr=this.errorTypeNames=null;this.Rt=this.currentStateId=-1;this.Wta="";this.oaa=null;this.getNameLoc=(ja,ua)=>this.Djc()?this.Ze.ma(this.currentStateId).Tj[0].y6.kb(ua)?(ja=excelOnlineCalc.location.nameLoc(ja,
ua),excelOnlineCalc.util.success(ja)):excelOnlineCalc.util.success(null):(ja=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ja));this.getContainingTable=ja=>{if(!this.Djc())return ja=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ja);const ua=ja.range.col,Za=ja.range.row;var Pa=this.Ze.ma(this.currentStateId).Tj[0].y6,ka=null;for(let ra of Pa)if(Pa=ra.value,2===Pa.type&&z.a.equals(ja.sheet.index.toString(),Pa.sheetId,!0)){const ba=Pa.range;ua>=ba.left-1&&ua<=
ba.right-1&&Za<=ba.bottom-1&&Za>=ba.top-1&&(ka=excelOnlineCalc.location.nameScope(this.documentLoc,Pa.sheetId),ka=excelOnlineCalc.location.nameLoc(ka,Pa.fullName))}return ka?excelOnlineCalc.util.success(ka):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ja,ua)=>{if(!this.Djc()){var Za=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Za)}Za=ja.name;var Pa=this.Ze.ma(this.currentStateId).Tj[0].y6;if(Pa.kb(Za)){Pa=Pa.ma(Za);const ra=Pa.range;if(2!==Pa.type)return excelOnlineCalc.util.failure(this.d7c(5));
const ba=Pa.eF?Pa.eF.V$:null;if(!ba)return excelOnlineCalc.util.success(null);for(var ka of ba)if(z.a.equals(ka.value,ua,!0))return ja=excelOnlineCalc.location.documentLoc(ja.scope.document.path,ja.scope.document.name),ja=excelOnlineCalc.location.sheetIndex(ja,Pa.sheetId),ka=excelOnlineCalc.location.gridRange(ra.top-1,ka.key,ra.bottom-ra.top+1,1),ka=excelOnlineCalc.location.sheetGridRange(ja,ka),Za=excelOnlineCalc.location.structRefColumnLoc(Za,ka,!!(Pa.attributes&16),!!(Pa.attributes&8)),excelOnlineCalc.util.success(Za);
return ra.right-ra.left+1!==ba.count?(Za=excelOnlineCalc.util.unavailable([17,ja,ua]),excelOnlineCalc.util.failure(Za)):excelOnlineCalc.util.failure(this.d7c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ja,ua)=>{if(!this.Djc())return ua=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ua);var Za=this.Ze.ma(this.currentStateId).Tj[0].y6;if(Za.kb(ja.name)){var Pa=Za.ma(ja.name);if(2!==Pa.type)return excelOnlineCalc.util.failure(this.d7c(5));Za=!!(Pa.attributes&
16);const ka=!!(Pa.attributes&8),ra=Za?1:0,ba=ka?1:0;ja=excelOnlineCalc.location.documentLoc(ja.scope.document.path,ja.scope.document.name);ja=excelOnlineCalc.location.sheetIndex(ja,Pa.sheetId);Pa=Pa.range;let Ua={};if(1===ua)Ua=excelOnlineCalc.location.gridRange(Pa.top-ra-1,Pa.left-1,Pa.bottom+ba-Pa.top+ra+1,Pa.right-Pa.left+1);else if(2===ua)Ua=excelOnlineCalc.location.gridRange(Pa.top-1,Pa.left-1,Pa.bottom-Pa.top+1,Pa.right-Pa.left+1);else if(3===ua)if(Za)Ua=excelOnlineCalc.location.gridRange(Pa.top-
2,Pa.left-1,1,Pa.right-Pa.left+1);else return excelOnlineCalc.util.success(null);else if(4===ua)if(ka)Ua=excelOnlineCalc.location.gridRange(Pa.bottom,Pa.left-1,1,Pa.right-Pa.left+1);else return excelOnlineCalc.util.success(null);ua=excelOnlineCalc.location.sheetGridRange(ja,Ua);return excelOnlineCalc.util.success(ua)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ja,ua)=>{if((z.a.equals(ja,this.documentLoc.path,!0)||!ja)&&z.a.equals(ua,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
ja=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ja,ua)]);return excelOnlineCalc.util.failure(ja)};this.getSheetIndex=(ja,ua)=>{if(!this.Ze.kb(this.currentStateId)||!this.Ze.ma(this.currentStateId).Tj)return ua=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ua);ja=this.Ze.ma(this.currentStateId).Tj;for(let Za=1;Za<ja.length;Za++)if(z.a.equals(ja[Za].S7.sheetName,ua,!0))return excelOnlineCalc.util.success(ja[Za].S7.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(ja,ua)=>{if(!this.Ze.kb(this.currentStateId)||!this.Ze.ma(this.currentStateId).Tj)return ua=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ua);ja=this.Ze.ma(this.currentStateId).Tj;for(let Za=1;Za<ja.length;Za++)if(z.a.equals(ja[Za].S7.sheetId,ua,!0))return excelOnlineCalc.util.success(ja[Za].S7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.XGf=()=>{this.setNumberFormats()};this.$c=()=>{c.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Ze=new m.a;this.currentStateId=this.Rt=-1;this.Wta="";this.Dtb=null;this.dLd=!1;this.gr&&this.clearCache()};this.$ag=(this.Mc=ca)?ca.ya.CalcWebWorkerSmokeTestPingIntervalMS:this.$ag;this.Ze=new m.a;this.Dtb=null;this.documentLoc=
excelOnlineCalc.location.documentLoc("",this.Mc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.fpa();this.Yrd=v.a.Yrd();this.vIh=u.EwaSettings.isChangeGateEnabled("OfficeVSO:7403363_fixTextWithWhitespaces")}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.rNd(this.XGf);this.Mc&&this.Mc.ul(this.$c);this.close()}TQb(ca){if(!this.gr)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Mc.da.Aa(268),
!this.instantaneousSupportInformationManager))return c.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==ca&&(this.currentStateId=this.Mc.ea.zDb,this.currentStateId===e.a.se&&(this.currentStateId=this.Mc.ea.ye));if(1===ca&&this.currentStateId<this.Rt)return c.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Rt} - ignoring update`),!1;this.Rwj();0!==
ca&&this.dLd||(this.mBj(),this.qyj(),this.czj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Ise(this.XGf),this.Mc.$k(this.$c),this.dLd=!0);this.vcj();let ja=!1;0===ca&&(ja=this.Egi());if(0!==ca||ja)this.yAj()?(this.aBj(ca),this.$Aj(),this.Rt=this.currentStateId,this.B4g()):c.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==ca&&this.resumeRecalc();return!0}evalFormula(ca,ja,ua,Za){if(!this.gr)return c.ULS.sendTraceTag(537170195,
0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ja=excelOnlineCalc.calc.sheetCellLocation(null!==ua&&void 0!==ua?ua:w.d(this.Mc.va.na),ja.top-1,ja.left-1);ca=this.gr.evalFormula(this.Mc.ea.ye,ca,ja,Za);this.resumeRecalc();return ca}m0g(ca,ja,ua,Za=null){const Pa=w.d(this.Mc.va.na);let ka=ca.cell.gR-1,ra=ca.cell.fR-1;var ba=ka,Ua=ra;let Ka=null;Za&&(Ka=excelOnlineCalc.calc.cellLocation(ka,ra),ka=Za.top-1,ra=Za.left-1,ba=Za.bottom-1,Ua=Za.right-1);ua=this.h3d(ca,ua,"SetCell");
if(0>ua)return!1;Ua=J.laa("CalculateFormula.cell",Pa,ka,ra,ba,Ua);ba=[];Za=this.Ykd(Pa);ja=excelOnlineCalc.calc.inferredRangeFormulaEdit(Ua,ja,Ka,Za);ba.push(ja);ca=(ja=this.a$e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Pa,ka,ra,z.a.Lue(ca.cell.text),ua,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Pa,ka,ra,z.a.Lue(ca.cell.text),ua,"","","","");c.ULS.sendTraceTag(537170180,0,50,ca);this.gr.editRangeFormulas(ua,ba);this.resumeRecalc();return!0}jvb(ca,ja,ua,Za){if(!this.gr)return c.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!ua||!ja)return c.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!ua}, outputColumnRange null: ${!ja}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");
c.ULS.shipAssertTag(537170178,0,ua.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");const Pa=w.d(this.Mc.va.na),ka=this.Ykd(Pa);var ra=null;if(ca){ra=[];for(const Ua of ca)if(Ua.column!==ua.left){ca=Ua.row-1;var ba=Ua.column-1;ca=J.laa("EvalFormulaRangeOnClone.cell",Pa,ca,ba,ca,ba);ba=Ua.text;ra.push(excelOnlineCalc.calc.rangeWrite(ca,excelOnlineCalc.calc.valueCellData(ba,ba,Ua.Hj,null)))}}ua=excelOnlineCalc.calc.cellLocation(ua.top-1,ua.left-1);ja=J.laa("EvalFormulaRangeOnClone.outputColumnRange",
Pa,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1);Za=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ja,Za,ua,ka)];ra=this.gr.evalOnClonedModel(ra,Za);this.resumeRecalc();return ra}FKe(ca){let ja=null;try{if(ca)if(this.Wta=A.h(this.Mc).Da.Kva(ca),this.currentStateId=ca.vUa,this.currentStateId<this.Rt||this.currentStateId===e.a.se)c.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.Wta} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Rt}`);
else{if(this.Kgi(),!this.tWg())if(ja=this.Mc.Kb.Cc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.Wta} StateId:${this.currentStateId}`),this.Dtb=this.jyb(ca.na.sheetName),!this.Dtb){const ka=!!(this.Mc.qd&32),ra=this.Ze.kb(this.currentStateId)&&this.Ze.ma(this.currentStateId).Tj?this.Ze.ma(this.currentStateId).Tj.length:0;c.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${ra}, scratchPad:${ka}, sheetNameLength:${ca.na.sheetName?
ca.na.sheetName.length:-1} Hash:${ca.na.hash}`)}else if(A.h(this.Mc).Da.Dm.$2a(ca.Bd)){var ua=ca.rf;if(ua){var Za=ua.getCalcBlockModel();if(!Za)c.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.lWg(Za)){this.Ze.ma(this.currentStateId).Q0a[this.Wta]=new D(Za,ca.na.sheetName);var Pa=ca.pe;Pa?this.NJg(Pa.NamedObjects):c.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else c.ULS.sendTraceTag(537170146,
0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.Wta}`)}}else c.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ja&&ja.stop()}}V5a(ca){if(!this.Ze.ma(this.currentStateId).Tj||!this.Ze.ma(this.currentStateId).Tj[0])return null;var ja=this.Ze.ma(this.currentStateId).Tj[0].y6;if(!ja||!ja.kb(ca.name))return null;ca=ja.ma(ca.name);if(!ca||!ca.eF)return null;ja=new d.a;for(let ua of ca.eF.V$)ja.add(ua.value);
return ja}n0g(ca,ja,ua){var Za=A.h(this.Mc),Pa=Za.Ub(ja);Pa=this.h3d(Pa,null,"CopyPaste");ua=this.h3d(Za.Ub(ca),ua,"CopyPaste");if(0>Pa||0>ua||Pa!==ua)c.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${ua}, targetRevision:${Pa}.`);else{ua=[];Za=w.d(this.Mc.va.na);var ka=this.Ykd(Za);ca=J.laa("CalculateFormulaForCopyPaste.srcRange",Za,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1);ja=J.laa("CalculateFormulaForCopyPaste.targetRange",
Za,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1);ja=excelOnlineCalc.calc.copyPasteRangePasteEdit(ja,ca,ka);ua.push(ja);ja=ka?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",Za,Pa,ka.row,ka.column,ka.lastRow,ka.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",Za,Pa,"","","","");c.ULS.sendTraceTag(537170142,0,50,ja);this.gr.editRangePaste(Pa,ua);
this.resumeRecalc()}}Ykd(ca){const ja=this.a$e();let ua=null;ja?ua=J.laa("GetViewport.viewport",ca,ja.top-1,ja.left-1,ja.bottom-1,ja.right-1):c.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return ua}a$e(){const ca=A.h(this.Mc);let ja=ca.ui;if(A.h(this.Mc).ib.rj){ja=ca.Df(1).ui;if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!ja)return c.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),
null;ja.rea(1,1);ja.rea(3,1)}return ja}h3d(ca,ja,ua){let Za;if(!this.gr||!ca)return c.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.gr}, modifiedCell is null:${!ca}, operation:${ua}`),-1;const Pa=ca.cell.gR-1,ka=ca.cell.fR-1;if(ca.cell.sy){if(Za=ca.cell.sy.Uye,Za===e.a.se)return c.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${ca.cell.sy.Bd}, operation:${ua}`),-1}else return c.ULS.sendTraceTag(537170137,
0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${ca.cell.gR},${ca.cell.fR}), operation:${ua}`),-1;if(Za<this.Rt)return c.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Pa},${ka}) - blockRevision:${Za} < lastUpdatedStateId:${this.Rt}, operation:${ua}`),-1;if(Za<this.currentStateId)return c.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Pa},${ka}) - blockRevision:${Za} < currentStateId:${this.currentStateId}, operation:${ua}`),
-1;ja&&!this.kFd&&(this.gr.setOnRecalcResults(ja),this.kFd=!0);return this.rXj()&&!this.TQb(2)?(c.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${ua}`),-1):Za}getFormulaBarText(ca,ja,ua){return ja&&ja.startsWith("'")?ja:ca.cell.formulaBarText||ua.toString()}fgh(ca,ja,ua){let Za=null;if(this.uBe()&&this.Ze.ma(this.Rt).Q0a){const Pa=this.Ze.ma(this.Rt).Q0a[ca];if(null===Pa||void 0===Pa?0:Pa.vyc)Za=Pa.JAe}ua=this.vli(Za,ja,ua);ja=this.Y7g(Za,
ja,ua);c.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${ca} StateId:${this.currentStateId} number of formulas ${ja}`)}vli(ca,ja,ua){let Za=!1;const Pa=J.Z1e(ja);if(ca){const ka=J.Z1e(ca);z.a.equals(ka,Pa,!1)&&(Za=!0)}Za?this.rKg(ca,this.Rt,ua):this.tKg(ja,ua);return Za}uBe(){let ca=!1;this.gr&&-1!==this.Rt&&(ca=this.gr.stateIdAvailable(this.Rt));return ca&&this.Ze.kb(this.Rt)&&this.Rt<this.currentStateId}Y7g(ca,ja,ua){let Za;Za=0;let Pa,ka;
for(ja.reset();Pa=ja.getNextCell();)y.f(Pa.formula)&&Za++,(ka=ua?ca.getCell(Pa.row,Pa.col):null)?this.U7g(ja,Pa,ka):this.sKg(ja,Pa);if(ua)for(ca.reset();ka=ca.getNextCell();)(Pa=ja.getCell(ka.row,ka.col))||this.Vqe(ca,ka);return Za}czj(){this.gr.setOnUpdateRequest(()=>{})}bzj(){this.gr.setOnUnresponsive((ca,ja,ua,Za)=>{this.z_i(ca,ja,ua,Za)})}z_i(ca,ja,ua,Za){c.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${ca}, waitTime:${ja}, timeoutCount:${ua}, hasBeenClosed:${Za}.`);
Za&&(this.Tnj(),this.fpa())}Tnj(){this.$c(null,null);this.txd=this.kFd=!1;this.UId=0;this.MId=this.OId=this.PId=this.NId=-1}close(){this.gr.close()}clearCache(){this.gr.clearCache()}resumeRecalc(){this.gr.resumeRecalc()}qyj(){this.gr.setA1ReferenceStyle(!0)}vcj(){if(this.instantaneousSupportInformationManager){var ca=this.instantaneousSupportInformationManager.Lii;const ua=this.instantaneousSupportInformationManager.Oii,Za=this.instantaneousSupportInformationManager.Nii,Pa=this.instantaneousSupportInformationManager.Mii;
var ja=!1;ca!==this.NId&&(ja=!0,this.NId=ca);ua!==this.PId&&(ja=!0,this.PId=ua);Za!==this.OId&&(ja=!0,this.OId=Za);Pa!==this.MId&&(ja=!0,this.MId=Pa);const ka=[];u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ja=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),ka.push(ja),ja=!0);u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ja=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),ka.push(ja),
ja=!0);u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ja=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),ka.push(ja),ja=!0);ja&&(ca=excelOnlineCalc.calc.recalcServiceConfig(null,ca,null,ua,null,null,null,Za,ka,Pa),this.gr.reconfigure(ca))}}aBj(ca){let ja=null;if(this.Ze.kb(this.currentStateId))try{this.oaa=[],ja=this.Mc.Kb.Cc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${G[ca]}`),
f.a.forEach(this.Ze.ma(this.currentStateId).Q0a,(ua,Za)=>{Za.vyc||(this.fgh(ua,Za.JAe,Za.sheetName),Za.vyc=!0)},null),this.gr.updateRanges(this.currentStateId,this.oaa)}finally{ja&&ja.stop()}else c.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}$Aj(){const ca=[],ja=this.uBe();var ua=ja&&this.Ze.ma(this.Rt).Tj&&this.Ze.ma(this.Rt).Tj[0]&&this.Ze.ma(this.Rt).Tj[0].uoc?this.Ze.ma(this.Rt).Tj[0].y6:null;this.qGe(ua,this.Ze.ma(this.currentStateId).Tj[0].y6,
null,this.Rt,ca);this.Ze.ma(this.currentStateId).Tj[0].uoc=!0;for(let Za=1;Za<this.Ze.ma(this.currentStateId).Tj.length;Za++)ua=-1,ja&&this.Ze.ma(this.Rt).Tj&&(ua=this.ckd(this.Ze.ma(this.currentStateId).Tj[Za].S7.sheetName,this.Rt)),ua=-1!==ua&&this.Ze.ma(this.Rt).Tj[ua].uoc?this.Ze.ma(this.Rt).Tj[ua].y6:null,this.qGe(ua,this.Ze.ma(this.currentStateId).Tj[Za].y6,this.Ze.ma(this.currentStateId).Tj[Za].S7.sheetId,this.Rt,ca),this.Ze.ma(this.currentStateId).Tj[Za].uoc=!0;this.gr.updateNamedObjects(this.currentStateId,
ca)}qGe(ca,ja,ua,Za,Pa){if(void 0!==ua&&null!==ua){var ka=excelOnlineCalc.calc.undefinedNamesWrite(ua);Pa.push(ka)}if(ca){var ra=!1;ka=[];var ba=[];if(ja)for(let Ka of ja){const Oa=Ka.value;if(ca.kb(Ka.key)){var Ua=ca.ma(Ka.key);J.rKi(Ua,Oa)?ra=!0:(Ua=excelOnlineCalc.calc.namedObject(Ka.key,null),ka.push(Ua),J.AXc(Ka.key,Oa,ba))}else J.AXc(Ka.key,Oa,ba)}for(let Ka of ca)ja&&ja.kb(Ka.key)||(ca=excelOnlineCalc.calc.namedObject(Ka.key,null),ka.push(ca));ra&&(ja=excelOnlineCalc.calc.namedObjectsPromote(ua,
Za),Pa.push(ja));0<ka.length&&(ja=excelOnlineCalc.calc.namedObjectsWrite(ua,ka),Pa.push(ja));0<ba.length&&(ua=excelOnlineCalc.calc.namedObjectsWrite(ua,ba),Pa.push(ua))}else if(ja){Za=[];for(ba of ja)J.AXc(ba.key,ba.value,Za);0<Za.length&&(ua=excelOnlineCalc.calc.namedObjectsWrite(ua,Za),Pa.push(ua))}}tWg(){return this.Ze.ma(this.currentStateId).Q0a[this.Wta]?(c.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Wta} StateId:${this.currentStateId} previously handled`),
!0):!1}lWg(ca){return 1===ca.getColumnNumbers().length&&ca.getColumnNumbers()[0]===J.Tzd+1?!1:!0}Egi(){let ca=!1;A.h(this.Mc).Da.pwb(ja=>{ja.state&1&&this.Mc.ea.ye===ja.ae.Revision&&(this.FKe(ja),ca=!0)});return ca}yIe(ca,ja){var ua=ca.getRowNumbers(),Za=ca.getColumnNumbers();ca=ua[0]-1;ua=ua[ua.length-1]-1;const Pa=Za[0]-1;Za=Za[Za.length-1]-1;ja=this.jyb(ja);if(!ja){const ka=this.Ze.kb(this.currentStateId)&&this.Ze.ma(this.currentStateId).Tj?this.Ze.ma(this.currentStateId).Tj.length:0;c.ULS.sendTraceTag(537170120,
0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${ka}`)}return J.laa("CreateBlockRangeLocation",ja,ca,Pa,ua,Za)}rKg(ca,ja,ua){if(ua=this.yIe(ca,ua)){var Za=J.P6b(ca.getRowNumbers());ca=J.P6b(ca.getColumnNumbers());ja=excelOnlineCalc.calc.rangePromote(ua,ja,Za,ca);this.oaa[this.oaa.length]=ja}}tKg(ca,ja){if(ja=this.yIe(ca,ja)){var ua=J.P6b(ca.getRowNumbers());ca=J.P6b(ca.getColumnNumbers());ca=excelOnlineCalc.calc.rangeWrite(ja,null,ua,ca);this.oaa[this.oaa.length]=
ca}}U7g(ca,ja,ua){let Za=null,Pa=0,ka=0;switch(ja.valueType){case 2:Za=this.Vkd(ja);var ra=this.Vkd(ua);ra=z.a.equals(ra,Za,!1);break;case 1:null===ja.value&&null===ua.value?ra=!0:(Pa=parseFloat(ja.value),ra=parseFloat(ua.value)===Pa);break;default:null===ja.value&&null===ua.value?ra=!0:(ka=parseFloat(ja.value),ra=ka===parseFloat(ua.value))}ra&&ja.valueType===ua.valueType&&ja.ifmt===ua.ifmt&&ja.formulaType===ua.formulaType&&z.a.equals(ua.formula,ja.formula,!1)||(void 0!==ja.formula&&null!==ja.formula||
void 0!==ja.value&&null!==ja.value||void 0!==ja.text&&null!==ja.text||this.vIh&&0!==ja.valueType?this.t0b(ca,ja,Za,Pa,ka):this.Vqe(ca,ja))}NJg(ca){if(this.Mc.Cb&&this.Mc.Cb.items)for(let ka=0;ka<this.Mc.Cb.count;ka++){var ja=this.Mc.Cb.items[ka];if(2!==ja.type&&3!==ja.type)continue;var ua=0,Za=ja.name,Pa=Za.lastIndexOf("!");if(0<Pa){ua=Za.substr(0,Pa);"'"===ua.charAt(0)&&(ua=ua.substr(1,ua.length-2));ua=this.ckd(ua,this.currentStateId);if(-1===ua){ja=this.Ze.kb(this.currentStateId)&&this.Ze.ma(this.currentStateId).Tj?
this.Ze.ma(this.currentStateId).Tj.length:0;c.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ja}`);continue}Za=Za.substr(Pa+1)}ua=this.Ze.ma(this.currentStateId).Tj[ua].y6;let ra=ja.usedRange;2===ja.type&&(ra=x.a(ja));if(ua.kb(Za)){if(Pa=ua.ma(Za),Pa.range=ra,Pa.attributes=ja.attributes,2===Pa.type&&(Za=J.dZe(ja.name,ca),ja=(ua=u.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?ja.gP:null===
Za||void 0===Za?void 0:Za.ColHeadersList,Za||ua))if(!Pa.eF)Pa.eF=new r(ja);else if(ja)for(const ba of ja.HeadersList)Pa.eF.V$.ia(ba.Index,ba.Name)}else if(Pa=this.jyb(ja.sheetName)){Pa=new I(ja.type,ja.name,ra,Pa,ja.attributes);if(2===Pa.type)if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&ja.gP)Pa.eF=new r(ja.gP);else if(ja=J.dZe(ja.name,ca))Pa.eF=new r(ja.ColHeadersList);ua.ia(Za,Pa)}else ja=this.Ze.kb(this.currentStateId)&&this.Ze.ma(this.currentStateId).Tj?
this.Ze.ma(this.currentStateId).Tj.length:0,c.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ja}`)}}t0b(ca,ja,ua,Za,Pa){var ka=ca.getRowNumbers()[ja.row]-1;ca=ca.getColumnNumbers()[ja.col]-1;ka=J.laa("AddRangeUpdateCommand",this.Dtb,ka,ca,ka,ca);ca=null;let ra=ja.formula||ja.text;const ba=excelOnlineCalc.calc.blankValue;let Ua=null;void 0!==ja.text&&null!==ja.text||void 0!==ja.value&&null!==ja.value||(ua="",Ua="This cell contains blanks only",
0===ja.formulaType&&(ra=""));switch(ja.valueType){case 2:null!==ua&&(0===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ra,ua,ja.ifmt,Ua)),1===ja.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ra,ua,ja.ifmt,Ua)),2===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",ba,0,"This cell is a part of an array")));break;case 1:isNaN(Za)?c.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ja.row},${ja.col}) invalid numeric value`):(0===ja.formulaType&&
(ca=excelOnlineCalc.calc.valueCellData(ra,Za,ja.ifmt,null)),1===ja.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ra,Za,ja.ifmt,null)),2===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",ba,0,"This cell is a part of an array")));break;case 3:isNaN(Pa)?c.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ja.row},${ja.col}) invalid boolean value`):(ua=1===Pa?!0:!1,0===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ra,ua,ja.ifmt,null)),1===ja.formulaType&&
(ca=excelOnlineCalc.calc.cellFormulaCellData(ra,ua,ja.ifmt,null)),2===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",ba,0,"This cell is a part of an array")));break;case 4:isNaN(Pa)?c.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ja.row},${ja.col}) invalid error value`):(ua=excelOnlineCalc.calc.errorValue(Pa),0===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(ra,ua,ja.ifmt,null)),1===ja.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(ra,
ua,ja.ifmt,null)),2===ja.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",ba,0,"This cell is a part of an array")));break;default:ca=excelOnlineCalc.calc.valueCellData("",ba,ja.ifmt,null)}ca&&(ja=excelOnlineCalc.calc.rangeWrite(ka,ca,null,null),this.oaa[this.oaa.length]=ja)}sKg(ca,ja){switch(ja.valueType){case 2:this.t0b(ca,ja,this.Vkd(ja),null,0);break;case 1:this.t0b(ca,ja,null,parseFloat(ja.value),0);break;default:this.t0b(ca,ja,null,null,parseFloat(ja.value))}}Vqe(ca,ja){var ua=ca.getRowNumbers()[ja.row]-
1;ca=ca.getColumnNumbers()[ja.col]-1;ua=J.laa("AddRangeUpdateCommandEmptyCell",this.Dtb,ua,ca,ua,ca);ja=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ja.ifmt,null);ja=excelOnlineCalc.calc.rangeWrite(ua,ja,null,null);this.oaa[this.oaa.length]=ja}jyb(ca){ca=this.ckd(ca,this.currentStateId);return 0<ca?this.Ze.ma(this.currentStateId).Tj[ca].S7.sheetId:null}ckd(ca,ja){if(!this.Ze.kb(ja))return c.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ja} does not exist in GridCache`),
-1;const ua=this.Ze.ma(ja);return ua.Tj?ua.getSheetIndex(ca):(c.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ja}`),-1)}yAj(){if(!this.Ze.kb(this.currentStateId)||!this.Ze.ma(this.currentStateId).Tj.length)return c.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const ca=[];for(let ja=1;ja<this.Ze.ma(this.currentStateId).Tj.length;ja++){const ua=
this.Ze.ma(this.currentStateId).Tj[ja];ua&&ca.push(ua.S7)}this.gr.updateSheetNames(this.currentStateId,ca);this.gr.updateUnusedCells(this.currentStateId,this.Ze.ma(this.currentStateId).Uig);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var ca=[];for(const ja of this.instantaneousSupportInformationManager.bza){const ua=excelOnlineCalc.calc.numberFormat(ja.IfmtIndex,ja.FormatString,ja.Builtin);ca.push(ua)}this.gr.setNumberFormats(ca,!0)}}Rwj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Je){var ca=this.Igi();if(!this.txd||ca)this.O6b(),this.instantaneousSupportInformationManager.Je.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Je.TrueValueString),this.instantaneousSupportInformationManager.Je.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Je.FalseValueString),ca=C.CalcHelper.tJe(this.instantaneousSupportInformationManager,ca),this.gr.setLocale(ca),this.txd=!0}}mBj(){var ca=null;
if(void 0!==this.Mc.workbookContext.TimeZoneInformation&&null!==this.Mc.workbookContext.TimeZoneInformation){ca=null;this.Mc.workbookContext.TimeZoneInformation.StandardDate.Month&&(ca=excelOnlineCalc.date.dateTime(this.Mc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Mc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Mc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Mc.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Mc.workbookContext.TimeZoneInformation.StandardDate.Minute,
this.Mc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Mc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Mc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ja=null;this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ja=excelOnlineCalc.date.dateTime(this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Day,
this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Mc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Mc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));ca=excelOnlineCalc.date.tzData(this.Mc.workbookContext.TimeZoneInformation.Bias,ca,this.Mc.workbookContext.TimeZoneInformation.StandardBias,ja,this.Mc.workbookContext.TimeZoneInformation.DaylightBias)}else c.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");ca=excelOnlineCalc.calc.workbookProps(this.Mc.workbookContext.F1904,this.Mc.workbookContext.FDateCompatibility,ca);this.gr.setWorkbookProps(ca)}fpa(){u.EwaSettings.oa(288)&&l.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.$ag,!0)).continueWith(Za=>{Za.exception?c.ULS.sendTraceTag(537170079,0,15,`CalcAsyncEngine.TryInitialize: calc smoke test failed: ${Za.exception.toString()}`):c.ULS.sendTraceTag(537170080,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});
const ca=u.EwaSettings.oa(613)?n.local:n.wQj,[ja,ua]=v.a.TV(this.Mc)?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.eLd=l.c(excelOnlineCalc.calc.createRecalcService(ca,ja,ua));this.eLd.continueWith(Za=>{Za.exception?c.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Za.exception.toString()}`):(c.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),
(this.gr=this.eLd.result)?this.TQb(0)?this.bzj():c.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):c.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Igi(){const ca=this.instantaneousSupportInformationManager.Uja;if(!ca||this.UId===ca.length)return null;this.UId=ca.length;return C.CalcHelper.gJe(ca)}O6b(){this.errorTypeNames=C.CalcHelper.O6b()}Kgi(){if(!(this.Ze.kb(this.currentStateId)&&0<this.Ze.ma(this.currentStateId).Tj.length)){this.Ze.ia(this.currentStateId,
new M(this.Yrd));this.Ze.ma(this.currentStateId).K6f(0,new H(null));var ca=this.Mc.va;for(let Za=0;Za<ca.count;Za++){var ja=Object(h.a)(B.a,ca.getItem(Za));if(ja){void 0!==ja.sheetId&&null!==ja.sheetId&&void 0!==ja.name&&null!==ja.name&&ja.sheetId.length&&ja.sheetName.length||c.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Za} Id:${ja.sheetId} Hash:${ja.hash} NameLength:${ja.name?ja.name.length:-1}`);var ua=void 0;ua=excelOnlineCalc.calc.sheetName(ja.sheetId,
ja.name);this.Ze.ma(this.currentStateId).K6f(Za+1,new H(ua));ua=ja.usedRange.MS();ua=excelOnlineCalc.calc.rangeLocation(0,0,ua.LastRow,ua.LastColumn);ja=excelOnlineCalc.calc.unusedCellsUpdate(ja.sheetId,ua);this.Ze.ma(this.currentStateId).Uig.push(ja)}else c.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Za}`)}}}B4g(){for(let ca of this.Ze)ca.key<this.Rt&&this.Ze.remove(ca.key)}Vkd(ca){ca=ca.value||ca.text;
if(void 0===ca||null===ca)ca="";return ca}rXj(){if(!this.Ze.kb(this.currentStateId))return!1;let ca=!1;f.a.forEach(this.Ze.ma(this.currentStateId).Q0a,(ja,ua)=>{ua.vyc||(ca=!0)},null);return ca}d7c(ca){const ja={};ja.reason=ca;ja.kind=1;return ja}Djc(){return this.Ze.kb(this.currentStateId)&&this.Ze.ma(this.currentStateId).Tj&&this.Ze.ma(this.currentStateId).Tj[0]&&this.Ze.ma(this.currentStateId).Tj[0].y6?!0:!1}static fch(ca){const ja=[];if(null===ca||void 0===ca?0:ca.V$)for(let ua of ca.V$)ca=excelOnlineCalc.calc.columnData(ua.key,
ua.value),ja.push(ca);return ja}static rKi(ca,ja){if(ca.type!==ja.type||ca.attributes!==ja.attributes||!z.a.equals(ca.fullName,ja.fullName,!1)||!ca.range.equals(ja.range))return!1;if(!ca.eF&&!ja.eF)return!0;if(!ca.eF||!ja.eF||ca.eF.V$.count!==ja.eF.V$.count)return!1;for(let ua of ca.eF.V$){let Za;if(!(ua.value&&({value:Za}=ja.eF.V$.Ec(ua.key)).returnValue&&Za&&z.a.equals(ua.value,Za,!1)))return!1}return!0}static AXc(ca,ja,ua){var Za=J.laa("NamedObject",ja.sheetId,ja.range.top-1,ja.range.left-1,ja.range.bottom-
1,ja.range.right-1);if(2===ja.type){const Pa=!!(ja.attributes&16),ka=!!(ja.attributes&8);ja=J.fch(ja.eF);Za=excelOnlineCalc.calc.namedTableData(Za,Pa,ka,ja);ca=excelOnlineCalc.calc.namedObject(ca,Za)}else Za=excelOnlineCalc.calc.namedRangeData(Za),ca=excelOnlineCalc.calc.namedObject(ca,Za);ua.push(ca)}static Z1e(ca){const ja=Sys.Serialization.JavaScriptSerializer.serialize(ca.getRowNumbers());ca=Sys.Serialization.JavaScriptSerializer.serialize(ca.getColumnNumbers());return ja+ca}static P6b(ca){let ja=
null;if(1<ca.length)for(let ua=1;ua<ca.length;ua++){let Za=0;for(;ca[ua-1]+1+Za<ca[ua];)ja=ja||[],ja.push(ca[ua-1]+Za),Za++}return ja}static dZe(ca,ja){if(!ja)return null;for(let ua=0,Za=ja.length;ua<Za;++ua)if(z.a.equals(ca,ja[ua].Name,!1))return ja[ua];return null}static laa(ca,ja,ua,Za,Pa,ka){const ra=(ba,Ua,Ka,Oa)=>{(0>Ka||Ka>=Oa)&&c.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${ba} invalid ${Ua}:${Ka}`)};void 0!==ja&&null!==ja||c.ULS.sendTraceTag(537170071,
0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${ca} sheetId is null`);ra(ca,"top",ua,J.lwf);ra(ca,"left",Za,J.Tzd);ra(ca,"bottom",Pa,J.lwf);ra(ca,"right",ka,J.Tzd);return excelOnlineCalc.calc.sheetRangeLocation(ja,ua,Za,Pa,ka)}}J.lwf=1048576;J.Tzd=16384;Object(t.a)(J,"CalcAsyncEngine",null,[3]);class L{constructor(){this.GK=this.HK=this.NF=this.OF=this.L_=!1}}Object(t.a)(L,"AbsoluteRelativeReferenceInfo",null,[]);var P=a(982),aa=a(24);class U{}U.zOf="#";Object(t.a)(U,"Operators",null,
[]);var K=a(983);class Y{}Y.sheet="Sheet";Y.sheetRange="SheetRange";Y.document="Document";Y.tdi="Ident";Object(t.a)(Y,"TraverseFormulaQualifierTypes",null,[]);var na=a(984),W=a(874),X=a(792),Aa=a(40),Q=a(55),fa=a(68),Ca=a(291),ia=a(38);class Ra extends Sys.EventArgs{constructor(ca){super();this.lk=ca}}Object(t.a)(Ra,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);class Ya extends ia.a{constructor(ca){super();this.ru=null;this.ung=!1;this.xPd=this.instantaneousSupportInformationManager=this.bIb=
null;this.ECd=new Map;this.Sge=null;this.zqc=ja=>{c.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");ja.rNd(this.zqc);ja.Uja.length?this.eqc(ja,Sys.EventArgs.Empty):(c.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ja.kse(this.eqc))};this.eqc=ja=>{c.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ja.iNd(this.eqc);this.$Uj(ja)};this.onContentReady=()=>{this.ru&&(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Jpd||Q.Task.delay(0).continueWith(()=>{this.ru.TQb(1)},0,null,fa.a.current))};this.bBf=(ja,ua)=>{this.ru&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Jpd||this.ru.FKe(ua.Yc.block))};c.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.bic=!1;this.jb=ca;this.Bq=A.h(ca);this.XIc=null;this.gridView.pv(this.onContentReady);this.gridView.Da.YXc(this.bBf);this.$.da.fb(268,ja=>{ja.Je?(c.ULS.sendTraceTag(537170066,
0,50,"CalcManager.ctor: LocaleInformation already available..."),this.zqc(ja,Sys.EventArgs.Empty)):(c.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ja.Ise(this.zqc))})}JMg(ca){this.addHandler(Ya.CPe,ca)}Tyf(ca){this.raiseEvent(Ya.CPe,new Ra(ca))}get es(){return this.XIc}get gridView(){return this.Bq}get $(){return this.jb}get HB(){return this.Sge}get localeInfo(){return this.es?this.es.config.localeInfo:null}get config(){return this.es.config}dispose(){c.ULS.sendTraceTag(537170064,
0,50,"CalcManager.Dispose called");this.$.da.fb(268,ca=>{ca.rNd(this.zqc);ca.iNd(this.eqc)});this.gridView&&(this.gridView.Ny(this.onContentReady),this.gridView.Da&&this.gridView.Da.vWf(this.bBf),this.Bq=null);this.XIc=null;u.EwaSettings.isChangeGateEnabled("OfficeVSO:7108565_CalcNotInitializedAfterDisposed")&&(this.bic=!1)}o0g(ca,ja,ua,Za=null){return this.ru?this.ru.m0g(ca,ja,ua,Za):!1}evalFormula(ca,ja,ua,Za){return this.ru?this.ru.evalFormula(ca,ja,ua,Za):Promise.reject("calc engine not initialized")}jvb(ca,
ja,ua,Za){return this.ru?this.ru.jvb(ca,ja,ua,Za):Promise.reject("CalcEngine is null")}V5a(ca){return this.ru?(c.ULS.shipAssertTag(537170059,0,2===ca.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.ru.V5a(ca)):null}iue(ca,ja){if(!ja||2!==ca.type)return!1;ca=x.a(ca);return ca.right-ca.left+1===ja.count}TXe(ca,ja){if(!this.bIb)return this.ung||c.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var ua=this.Kta(aa.Range.Qc(1,
1));ua=this.bIb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ua.range),ca);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ua))return c.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let Za;if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const Pa=null!==ja&&void 0!==ja?ja:this.gridView.ha.ra.activeCell,ka=excelOnlineCalc.location.gridCell(Pa.top-1,Pa.left-1),ra=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ba=excelOnlineCalc.location.sheetIndex(ra,this.$.va.na.sheetId),Ua=this.Cgh(ka,ba);this.xPd||(this.xPd=excelOnlineCalc.util.createResolver(this.Bgh()));Za=excelOnlineCalc.parse.parseResultHelper.extractReferences(ua,this.es.config.localeInfo,u.EwaSettings.oa(552),Ua,this.xPd)}else Za=excelOnlineCalc.parse.parseResultHelper.extractReferences(ua,this.es.config.localeInfo,u.EwaSettings.oa(552));u.EwaSettings.oa(101)&&this.L_j(Za,ca);return Za}catch(Za){return c.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Za.message}`),null}}extractLetVariables(ca,ja){if(!this.bIb)return this.ung||c.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const ua=this.Kta(aa.Range.Qc(1,1));ca=this.bIb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ua.range),ca);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ca))return c.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),
null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(ca,ja,this.es.config.localeInfo)}catch(Za){return c.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Za.message}`),null}}extractReferences(ca,ja,ua,Za,Pa){if(!ja)return c.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!ua)return c.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;Pa=this.TXe(ca,Pa);if(!Pa)return c.ULS.sendTraceTag(537170049,
0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.yfh(Pa,ja,ua,ca,Za)}catch(ka){return c.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${ka.message}`),null}}S3h(ca,ja,ua,Za){if(!ca)return c.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!ja||0>=ja.length)return c.ULS.sendTraceTag(537170018,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),
null;ca=this.Kta(ca);if(!this.es||!ca)return null;const Pa=this.Wwb(ca).returnValue;if(!Pa||Pa.H7a)return null;ua=excelOnline.utils.getCharIndexInTextFromPoint(ua,Za,u.EwaSettings.oa(552));return 0>ua?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.es.config,ua,ja,ca)}d0g(ca,ja,ua,Za){if(!ca)return c.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;let Pa=null;return this.evalFormula(ja,ca,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(ka=>
{let ra;const ba=({kind:ra}=this.es.huh(ka,ua)).returnValue;8!==ra||ba.length&&ba!==C.CalcHelper.unknownError?ka=0:(c.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),ka=excelOnlineCalc.calc.getEvalFailureReason(ka),void 0!==ka&&null!==ka||c.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),ka=1);return Pa=Za?new P.a(ba,Za.start,Za.end,ka):new P.a(ba,-1,-1,ka)},ka=>
{c.ULS.sendTraceTag(537170014,0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${ka}`);return Promise.resolve(Pa)})}getSubExpressionSpan(ca){return this.es&&ca?excelOnlineCalc.runtime.getSubExpressionSpan(ca):null}getFormulaSubExpressionObject(ca,ja,ua){return this.es&&ca&&ja&&ua?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.es.config,ja,ua,this.Kta(ca)):null}V3h(ca,ja,ua){return this.es&&ca&&ja?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.es.config,ja,
ua,this.Kta(ca)):null}T3h(ca,ja,ua){return this.es&&ca&&ja?excelOnlineCalc.runtime.getSubExpressionSubspans(this.es.config.localeInfo,ja,ua):null}cYh(){return this.es?this.es.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(ca){return this.es?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.es.config.localeInfo,ca):!1}Kta(ca,ja=!0){return ca&&this.es?this.es.Zgh(this.es.Oih(),ca.top-1,ca.left-1,ja):null}Xjf(ca,ja){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:7173486_IsFormulaCellRefactor")){ca=
this.E5a(ca);if(!Object(Ca.c)(ca))return null;ja=this.HB.parseEdit(ja,ca.value);return excelOnlineCalc.util.isSuccess(ja)?ja.value.kind===W.a.formula:null}ca=this.Wdc(ca);if(void 0===ca||null===ca)return null;ca=this.HB.createFormat(ca.FormatString,ca.Builtin);if(!excelOnlineCalc.util.isSuccess(ca))return null;ja=this.HB.parseEdit(ja,ca.value);return excelOnlineCalc.util.isSuccess(ja)?ja.value.kind===W.a.formula:null}Jui(ca){ca=this.E5a(ca);return Object(Ca.c)(ca)?"Text"===ca.value.valueType:null}E5a(ca){if(null==
this.HB)return Object(Ca.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(Ca.a)("Instantaneous manager is null");if(this.ECd.has(ca))return Object(Ca.d)(this.ECd.get(ca));if("number"===typeof ca){var ja=this.Wdc(ca);if(null==ja)return Object(Ca.a)(`Invalid ifmt=${ca}`);var ua=ja.FormatString;ja=ja.Builtin}else ua=ca,ja=!1;ua=this.HB.createFormat(ua,ja);return excelOnlineCalc.util.isSuccess(ua)?(this.ECd.set(ca,ua.value),Object(Ca.d)(ua.value)):Object(Ca.a)("Could not create number format")}getWorksheetFuncId(ca){return this.localeInfo.getWorksheetFuncId(ca)}yfh(ca,
ja,ua,Za,Pa){const ka={Items:[]};for(let Ka=0;Ka<ca.length;Ka++){var ra=ca[Ka];const Oa={};Oa.Start=ra.span.start;Oa.End=ra.span.end;if(Pa||ra.kind!==K.a.func)if(Pa||ra.kind!==K.a.wzi){if(!this.wph(ra,ja,ua))continue;var ba=new L;const ib=this.O0h(ra,ja,ba,Za);if(u.EwaSettings.oa(552)){var Ua=this.UXh(ra);const La=this.TXh(ra);if(ib||La&&0<=Ua){let db={};db.Span=Oa;db.LetNumber=Ua;db.LetName=La;db.Range=ib;db.IsRangeRef=ba.L_;db.IsAbsoluteFirstRow=ba.OF;db.IsAbsoluteFirstColumn=ba.NF;db.IsAbsoluteSecondRow=
ba.HK;db.IsAbsoluteSecondColumn=ba.GK;db.IsStructRef=ra.kind===K.a.IYd;ka.Items.push(db)}}else ib&&(Ua={},Ua.Span=Oa,Ua.Range=ib,Ua.IsRangeRef=ba.L_,Ua.IsAbsoluteFirstRow=ba.OF,Ua.IsAbsoluteFirstColumn=ba.NF,Ua.IsAbsoluteSecondRow=ba.HK,Ua.IsAbsoluteSecondColumn=ba.GK,Ua.IsStructRef=ra.kind===K.a.IYd,ka.Items.push(Ua))}else ra=ra.ref.value.oper.kind,ba={},ba.Span=Oa,ba.IsString=2===ra,ba.IsBoolean=4===ra,ba.IsNumber=1===ra,ka.Items.push(ba);else Oa.End=ra.span.start+ra.ref.name.length,ra={},ra.Span=
Oa,ra.IsFunction=!0,ra.FunctionId=this.getWorksheetFuncId(Za.substring(Oa.Start,Oa.End)),ka.Items.push(ra)}ka.Items.sort((Ka,Oa)=>Ka.Span.Start-Oa.Span.Start);return ka}UXh(ca){return ca.kind===K.a.arf?ca.ref.number:-1}TXh(ca){return ca.kind===K.a.arf?ca.ref.name:null}O0h(ca,ja,ua,Za){if(ca.kind===K.a.range)return ua.L_=!0,this.yHe(ca,ja,ua,Za);if(ca.kind===K.a.namedRange){ua=ca.ref;(ca=this.$.Cb.getItemByName(ua.name))||(ca=this.$.Cb.getItemByName(ja+"!"+ua.name));if(!(ca&&ca.sheetName&&ca.usedRange&&
z.a.equals(ca.sheetName,ja,!0)))return null;ja=2===ca.type?x.a(ca):ca.usedRange;return Aa.m(ja,ca)}if(ca.kind===K.a.IYd){let Pa=ca.ref,ka;Pa.name?(ka=this.$.Cb.getItemByName(Pa.name))||(ka=this.$.Cb.getItemByName(ja+"!"+Pa.name)):ka=this.gridView.Ab.Cj(this.gridView.ha.ra.activeCell);if(!(ka&&ka.sheetName&&ka.usedRange&&z.a.equals(ka.sheetName,ja,!0)))return null;ua.L_=!1;return this.yHe(ca,ja,ua,Za)}return null}yHe(ca,ja,ua,Za){ca=ca.ref;if(ca.type){if(ca.type===na.a.column){var Pa=ca.startIndex;
ca=ca.endIndex;ua.NF=Pa.kind===X.a.abs;ua.GK=ca.kind===X.a.abs;return this.createRange(0,Pa.index,e.a.gh,ca.index,ja)}if(ca.type===na.a.row)return Pa=ca.endIndex,ua.OF=ca.startIndex.kind===X.a.abs,ua.HK=Pa.kind===X.a.abs,this.createRange(ca.startIndex.index,0,ca.endIndex.index,e.a.uh,ja);if(ca.type===na.a.cell){Pa=ca.row;var ka=ca.col;ua.OF=ua.HK=Pa.kind===X.a.abs;ua.NF=ua.GK=ka.kind===X.a.abs;return this.l4b(ca.span.end,Za)&&(ua=aa.Range.Qc(Pa.index+1,ka.index+1),ua=this.gridView.Ab.Q8e(ua))?Aa.n(ua,
ja):this.createRange(Pa.index,ka.index,Pa.index,ka.index,ja)}if(ca.type===na.a.range){Pa=ca.top;ka=ca.left;Za=ca.bottom;ca=ca.right;const ra=Math.min(Pa.index,Za.index),ba=Math.min(ka.index,ca.index),Ua=Math.max(Pa.index,Za.index),Ka=Math.max(ka.index,ca.index);ua.OF=Pa.kind===X.a.abs;ua.HK=Za.kind===X.a.abs;ua.NF=ka.kind===X.a.abs;ua.GK=ca.kind===X.a.abs;return this.createRange(ra,ba,Ua,Ka,ja)}c.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${ca.type}'`);
return null}c.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}l4b(ca,ja){return ja.length>=ca&&0<ca&&ja.charAt(ca-1)===U.zOf}j0g(ca,ja,ua){this.ru&&this.ru.n0g(ca,ja,ua)}Wdc(ca){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.bza&&this.instantaneousSupportInformationManager.bza[ca]&&this.HB?this.instantaneousSupportInformationManager.bza[ca]:null}toXLNumber(ca){if(!this.HB)return null;
ca=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.HB,ca);return excelOnlineCalc.util.isSuccess(ca)?ca.value:null}L_j(ca,ja){if(ca)for(const ua of ca)ua.ref.type&&ua.ref.type===na.a.cell&&(ca=ua.ref,Ya.i6i(ca,ja)&&(ca.span.end+=1,ua.span.end+=1))}createRange(ca,ja,ua,Za,Pa){const ka={};ka.FirstRow=ca;ka.FirstColumn=ja;ka.LastRow=ua;ka.LastColumn=Za;ka.SheetName=Pa;return ka}wph(ca,ja,ua){var Za=ca.ref.qualifier;if(!Za)return!0;switch(ca.ref.qualifier.type){case Y.sheet:return ca=Za.document,
z.a.equals(Za.sheet,ja,!0)&&(!ca||z.a.equals(ca.document,ua,!0));case Y.sheetRange:return ja=this.$.va.getItemByName(ja),ua=this.$.va.getItemByName(Za.sheet1),Za=this.$.va.getItemByName(Za.sheet2),!!ja&&!!ua&&!!Za&&(ua.index<=ja.index&&ja.index<=Za.index||Za.index<=ja.index&&ja.index<=ua.index);case Y.document:return z.a.equals(Za.document,ua,!0);case Y.tdi:return Za=Za.name,z.a.equals(Za,ja,!0)||z.a.equals(Za,ua,!0);default:return c.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Za.type}'`),
!1}}$Uj(ca){this.instantaneousSupportInformationManager=ca;ca.bza.length&&ca.Uja.length?(this.XIc=new C.CalcHelper(this.gridView.$),this.bIb=this.es.createParser(),this.Sge=this.es.createNumberFormatter(),this.bic=!0,c.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.ru||(c.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.ru=new J(this.$))):c.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${ca.bza.length}, functions info count = ${ca.Uja.length}`)}Wwb(ca){if(!ca)return{returnValue:null,
emptyCell:!1};var ja=this.getSheetName(ca.sheet.index);if(!ja)return c.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${ca.sheet.index}`),{returnValue:null,emptyCell:!1};const ua=Ya.convertToRange(ca);ja=this.gridView.Wwb(ja,ua.top,ua.left);return ja?ja.sph?{returnValue:ja,emptyCell:!1}:(c.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${ca.range.row} ${ca.range.col} is empty`),{returnValue:null,emptyCell:!0}):(c.ULS.sendTraceTag(537169997,
0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${ca.range.row} ${ca.range.col}`),{returnValue:null,emptyCell:!1})}getSheetName(ca){const ja=this.gridView.$.va.getItem(ca);return ja?ja.sheetName:(c.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${ca}`),null)}Cgh(ca,ja){const ua={allowUnqualifiedCell:!0,wrapCellReferences:!0};ua.config=this.es.config;ua.originGridCell=excelOnlineCalc.util.success(ca);ua.originSheet=excelOnlineCalc.util.success(ja);
return ua}Bgh(){const ca={};ca.config=this.es.config;ca.getNameLoc=this.ru.getNameLoc;ca.getContainingTable=this.ru.getContainingTable;ca.getStructRefColumn=this.ru.getStructRefColumn;ca.getStructRefSpecialRef=this.ru.getStructRefSpecialRef;ca.getDocumentLoc=this.ru.getDocumentLoc;ca.getSheetIndex=this.ru.getSheetIndex;ca.getSheetName=this.ru.getSheetName;ca.getUserDefinedFuncLoc=this.ru.getUserDefinedFuncLoc;ca.getSheetRangeIndexes=this.ru.getSheetRangeIndexes;return ca}static i6i(ca,ja){return ja.length>
ca.span.end&&ja.charAt(ca.span.end)===U.zOf}static convertToRange(ca){return aa.Range.Qc(ca.range.row+1,ca.range.col+1)}}Ya.CPe="ECRC";Object(t.a)(Ya,"CalcManager",ia.a,[480,3]);var Ga=a(37),da=a(52);class Z extends b.a{constructor(ca){super();this.$=ca;this.Fb()}create(){if(this.$){c.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var ca=76;var ja="Current"}else ca=79,ja="Stable";
c.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ja} JS was loaded`);Ga.TaskExtensions.za(da.a.loadScript(ca,4,this.Ya,void 0,void 0,265),()=>{c.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let ua=this.$.da.Aa(266,!1);ua||(c.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),ua=new Ya(this.$),this.$.da.Ga(266,ua));this.ob(ua)},this.ka,3)}else c.ULS.sendTraceTag(537169994,
0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static la(ca){ca&&ca.da&&ca.da.Ga(265,new Z(ca))}}Object(t.a)(Z,"CalcManagerFactory",b.a,[]);var ha=a(9);a.d(E,"a",function(){return Wa});const Wa=()=>{ha.a.Fa(Z.la)}},1209:function(t,E,a){var c=a(9);t=a(0);var b=a(15),e=a(222),f=a(89),d=a(4),h=a(187),m=a(8),l=a(38),w=a(873),n=a(226),x=a(60),r=a(872);class u extends Sys.EventArgs{constructor(){super()}}Object(t.a)(u,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var v=
a(47),B=a(46);a(35);var z=a(29),A=a(1),y=a(614);a(22);var D=a(282),I=a(21);a(175);class M{constructor(J){this.data=J}}Object(t.a)(M,"NumberFormatDataHolder",null,[]);var T=a(177);class S extends l.a{constructor(J,L){super();this.Xlc=m.a.se;this.E1c=null;this.Chb=this.Ilc=!1;this.fAf=(P,aa)=>{var U;(P=I.h(this.$))&&(aa=null!==(U=null===aa||void 0===aa?void 0:aa.cell)&&void 0!==U?U:P.Ub(null))&&this.wCa(aa.cell.Hj,!0)};this.RRi=P=>{this.isActive()&&(z.a.Nq(P.Errors)||!P.Result?(P=P.Errors?P.Errors.map(aa=>
JSON.stringify(aa)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${P}`)):(P=P.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${P.Index}, category = ${P.Category}`),this.Yyj(P.Index,P.Category),this.raiseEvent(S.D2c,new w.a(P.Index,P.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.X3b();this.isActive()&&
this.ea.dc.allowEdits&&(this.Chb||this.Gn&&!(this.ea.zDb>this.Xlc)?this.jGc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.wid=r.a(this.$.pa.xa,this.Gn?this.Gn.Digest:"",this.ySi,this.xSi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.x4e())};this.vEf=P=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${P.data.status}, HTTP status = ${P.data.httpStatus}.`);
this.uLa=null};this.s0=()=>{this.Chb=!1;this.ea.bE(this.s0);this.ASa(this.Ilc?S.OUd:S.$Bd)};this.Tc=(P,aa)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");n.a(aa)&&this.ASa(S.OUd)};this.Bf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.mCd(0===this.$.workbookContext.CalcMode)};this.$c=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.ASa(S.OUd);A.EwaSettings.oa(284)&&3!==this.$.workbookContext.CalcMode&&this.mCd(0===this.$.workbookContext.CalcMode)};this.qSi=(P,aa,U)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.uLa=null;this.isActive()?P.StateId===m.a.se?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.jGc()):!P.Result||this.qY&&this.qY.length?this.ASa(S.$Bd):this.cIf(P,
aa,U):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.cIf=P=>{this.qY=P.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.qY?this.qY.length:-1} functions.`);P=!1;if(this.qY){for(const aa of this.qY)aa&&(this.d0e[aa.NameUI.toLocaleUpperCase()]=aa.FunctionIndex.toString(),aa.NameUI!==aa.NameDataStrings&&(this.d0e[aa.NameDataStrings.toLocaleUpperCase()]=
aa.FunctionIndex.toString(),P=!0),this.fLh.ia(aa.FunctionIndex,aa.NameUI));this.raiseEvent(S.tfd,Sys.EventArgs.Empty,this)}P&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.ySi=P=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.Ilc=!1,this.Xlc=P.StateId,this.Xlc===m.a.se)this.Ilc=!0,this.jGc();else{if(P.Result){var aa=this.Gn;this.Gn=P.Result;b.ULS.sendTraceTag(537155678,
0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Gn.Digest}.`);P=[];if(aa)P=S.JYh(aa.NumberFormats,this.Gn.NumberFormats);else for(aa=0;aa<this.Gn.NumberFormats.length;aa++)this.Voc.ia(aa,this.Gn.NumberFormats[aa].NumberFormatCategory);for(const U of P)this.Voc.ia(U,this.Gn.NumberFormats[U].NumberFormatCategory);this.raiseEvent(S.JCd,new u(P),this);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&this.raiseEvent(S.$rf)}this.ASa(S.$Bd)}};
this.xSi=P=>{this.isActive()&&(10===P.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${P.data.status}, HTTP status = ${P.data.httpStatus}.`),this.Ilc=!0,this.jGc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=J;this.$=L;this.Gn=this.uLa=this.wid=this.NJb=null;this.Voc=new T.a;this.Vwb=new T.a;this.qY=
[];this.fLh=new T.a;this.d0e={};this.ea.Xj(this.Tc);this.$.$k(this.$c);I.h(this.$).ha.sha(this.fAf);A.EwaSettings.oa(284)&&this.ea.pu(this.Bf);this.ASa(S.Ref);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Ise(J){this.addHandler(S.JCd,J)}rNd(J){this.removeHandler(S.JCd,J)}gMg(J){this.addHandler(S.D2c,J)}Vhj(J){this.removeHandler(S.D2c,J)}kse(J){this.addHandler(S.tfd,J)}iNd(J){this.removeHandler(S.tfd,J)}KNg(J){this.addHandler(S.$rf,J)}get Je(){return this.Gn?
this.Gn.LocaleInformation:null}get bza(){return this.Gn?this.Gn.NumberFormats:[]}get Uja(){this.qY&&this.qY.length||this.x4e();return this.qY}get Lii(){return this.Gn&&void 0!==this.Gn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.Gn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Gn.InstantaneousCalcWebWorkerPrecisionSamplingRate:S.ukh}get Oii(){return this.Gn&&void 0!==this.Gn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Gn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?
this.Gn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:S.ykh}get Nii(){return this.Gn&&void 0!==this.Gn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.Gn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.Gn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:S.xkh}get Mii(){return this.Gn&&void 0!==this.Gn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Gn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Gn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:
S.wkh}get Igf(){return this.Gn?this.Gn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:S.vkh}get Jpd(){return null!==this.E1c?this.E1c:this.Gn?this.Gn.InstantaneousCalcManualMode:!1}RUj(J){let L;if(!J)return{returnValue:!0,category:"General"};L="";if(!({category:J}=this.wCa(J,!1)).returnValue)return{returnValue:!1,category:L};L=this.M$g(J);return{returnValue:!0,category:L}}M$g(J){let L="";switch(J){case 0:L="General";break;case 1:L="Number";break;case 2:L="Currency";break;case 3:L="Accounting";break;
case 4:L="Date";break;case 5:L="Time";break;case 6:L="Percentage";break;case 7:L="Fraction";break;case 8:L="Scientific";break;case 9:L="Text";break;case 10:L="Special";break;case 11:L="Custom"}return L}wCa(J,L){let P,aa=({value:P}=this.Voc.Ec(J,0)).returnValue;!aa&&0<J&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${J}`),this.BQh(J),L&&(P=this.AQh(J),aa=!0),y.a(J,this.$.GG)&&
(P=6));return{returnValue:aa,category:P}}xoi(J){let L=0;if(({category:L}=this.wCa(J,!0)).returnValue)return 6===L;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${J}`);return!1}HJh(J){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.uLa=x.o(this.$.pa.xa,{FilterType:0},D.b(this.cIf,J),this.vEf,null,null,null)}z_e(){this.ASa(S.Ref)}mCd(J){this.E1c=
J}BQh(J){if(this.Vwb&&this.$){var L;if(!({value:L}=this.Vwb.Ec(J)).returnValue||L.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${J}`),(L=r.c(this.$.pa.xa,J,this.RRi,null,null,null))&&this.Vwb.ia(J,L)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}AQh(J){return 1<=J&&8>=J?1:9<=J&&12>=J?2:13===J||14===J?6:15===J?8:17===J|18===J?7:19===J?4:16===J||20<=
J&&29>=J||31===J?11:30===J?9:32<=J&&35>=J?3:0}isActive(){const J=void 0===this.ea||null===this.ea,L=!J&&this.ea.Zb;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${L} - sessionStateManager IsNullOrUndefined: ${J}`);return L}Yyj(J,L){this.Voc.ia(J,L)}dispose(){f.a.Ia(this.NJb);this.NJb=null;this.X3b();for(let J of this.Vwb){const L=J.value;L&&!L.isCompleted&&d.AFrameworkApplication.zd.cu(L.tt)}this.Vwb=null;this.ea&&
(this.ea.tk(this.Tc),this.Chb&&this.ea.bE(this.s0),this.Chb=!1,this.ea.Rv(this.Bf));this.ea=null;this.$&&I.h(this.$)&&I.h(this.$).ha&&(I.h(this.$).ha.wna(this.fAf),this.$.ul(this.$c));this.$=null;super.dispose()}isFeatureEnabled(J){try{switch(J){case "LocaleLongDateFormat":return A.EwaSettings.oa(192);case "GetLocaleDayNames":return A.EwaSettings.oa(193);case "CalculateTextWidthIgnoreLetterSpacing":return A.EwaSettings.oa(269);case "OfficeVSO:3657744_CalcFixForDateFormat":return A.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return A.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcWebWorkerTest":return A.EwaSettings.oa(288);case "CalcPreventSpillingHack":return A.EwaSettings.oa(242);case "CalcDynamicArrayOperators":return A.EwaSettings.oa(101);
default:return J.startsWith("OfficeVSO:")?A.EwaSettings.isChangeGateEnabled(J):!1}}catch(L){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${J}): feature parsing failed, returning false. Exception: ${L.toString()}.`),!1}}ASa(J){this.isActive()&&this.ea.dc.allowEdits?(f.a.Ia(this.NJb),this.NJb=null,this.NJb=v.a.instance.create(this.refresh,J,B.a.Pii)):b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.ea&&null!==this.ea&&void 0!==this.ea.dc&&null!==this.ea.dc?this.ea.dc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}x4e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.uLa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.qY&&this.qY.length||(this.uLa=x.o(this.$.pa.xa,{FilterType:0},this.qSi,
this.vEf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}jGc(){this.Chb||(this.Chb=!0,this.ea.PE(this.s0))}X3b(){this.cu(this.wid);this.cu(this.uLa);this.uLa=this.wid=null}cu(J){J&&!J.isCompleted&&this.$.pa.xa.Fgb(J.tt)}static JYh(J,L){if(!J||!J.length)return[];if(!L||!L.length){L=Array(J.length);for(var P=0;P<J.length;++P)L[P]=J[P].IfmtIndex;return L}P=new T.a;for(const aa of J)P.ia(aa.IfmtIndex,
new M(aa));J=new h.a;for(const aa of L){let U;({value:U}=P.Ec(aa.IfmtIndex)).returnValue&&U.data.FormatString===aa.FormatString||J.add(aa.IfmtIndex)}return J.toArray()}}S.JCd="isim0";S.D2c="isim1";S.tfd="isim2";S.$rf="isim3";S.Ref=100;S.OUd=1E3;S.$Bd=3E5;S.ukh=.001;S.ykh=.1;S.xkh=.2;S.wkh=.001;S.vkh=50;Object(t.a)(S,"InstantaneousSupportInformationManager",l.a,[290,3]);var H=a(698);class C extends e.a{constructor(J){super();this.$=J;this.Fb()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,
"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var J=Object(H.a)(this.$.da,268,()=>new S(this.$.ea,this.$));this.ob(J)}}static la(J){if(!J)throw Error.argumentNull("ewaControl");J.da.Ga(246,new C(J))}}Object(t.a)(C,"InstantaneousSupportInformationManagerFactory",e.a,[]);a.d(E,"a",function(){return G});const G=()=>{c.a.Fa(C.la)}},1225:function(t,E,a){function c(L){if(L){var P=new w(L.IsRangeRef);P.OF=L.IsAbsoluteFirstRow;P.NF=L.IsAbsoluteFirstColumn;P.HK=L.IsAbsoluteSecondRow;
P.GK=L.IsAbsoluteSecondColumn;return P}}function b(L){var P;if(L){var aa=new w(0===L.kind);L=null===(P=null===L||void 0===L?void 0:L.rangeInfo)||void 0===P?void 0:P.positionKindInfo;if(!L)return aa;aa.OF=0===L.firstRow;aa.NF=0===L.firstColumn;aa.HK=0===L.secondRow;aa.GK=0===L.secondColumn;return aa}}t=a(0);var e=a(222),f=a(7),d=a(15),h=a(83),m=a(5),l=a(324);class w{constructor(L){this.GK=this.HK=this.NF=this.OF=!1;this.L_=L}}Object(t.a)(w,"MarqueeRangeData",null,[]);class n{constructor(L,P,aa,U=!1){this.TZd=
L;this.OPb=P;this.v8a=U;aa?(this.L_=aa.L_,this.OF=aa.OF,this.NF=aa.NF,this.HK=aa.HK,this.GK=aa.GK):d.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(t.a)(n,"MarqueeMetadata",null,[]);var x=a(40),r=a(140),u=a(35),v=a(1),B=a(22),z=a(580),A=a(21),y=a(175),D=a(346),I=a(33),M=a(728),T=a(875);const S="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class H{constructor(L,P){this.FK=this.Qfb=this.Jtf=!1;this.e9=null;this.hza=()=>{this.FK=!1};this.Mc=L;this.gridView=A.h(L);this.calcManager=P;this.Ahf=v.EwaSettings.oa(642);this.oR=I.a.oR(L);this.gla=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.Bui=v.EwaSettings.isChangeGateEnabled("OfficeVSO:7144291_logRefactorInPreviewRanges");this.gridView.Vb.Qm(this.hza)}get formulaAssistanceManager(){this.e9||(this.e9=this.Mc.da.Aa(464));return this.e9}get formulaAssistanceTelemetryManager(){this.vEa||
(this.vEa=this.Mc.da.Aa(491));return this.vEa}aC(L,P){L.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.Qfb||L.PF)return!1;const aa=void 0===P||null===P?L.text:P;if(this.calcManager&&1<aa.length&&y.f(aa)){var U=this.nka(),K=this.N6e(),Y=this.Mc.workbookContext.WorkbookFileName;let na=!1;const W=.01>Math.random()?Object(h.a)(r.a,this.Mc.Kb.Cc("LoadingUIShown","ColoredReferencesManager")):null;try{const X=this.calcManager.extractReferences(aa,K,Y,!this.Ahf);
if(!X)return d.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;K=[];Y=[];const Aa=[],Q=[];let fa=0,Ca=0;const ia=new u.a(!1);let Ra="";for(const Ga of X.Items)if(na=Ga.IsStructRef||na,Ga.IsBoolean||Ga.IsNumber||Ga.IsString){const da=Ga.IsBoolean?"rgba(0, 0, 255, 1)":Ga.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.ME(Y,aa,fa,Ga.Span.Start,null);this.ME(Y,aa,Ga.Span.Start,Ga.Span.End,da);fa=
Ga.Span.End}else if(v.EwaSettings.oa(552)){if(Ga.Range||Ga.LetName&&0<=Ga.LetNumber){let da=null;if(Ga.Range){let ha=x.D(Ga.Range);da=this.e_(ha,ia,1);K.push(new D.a(ha,U))}else Ga.LetName&&0<=Ga.LetNumber&&(da=Ra=this.nRh(Ga.LetName,Ga.LetNumber,ia,Ra),Ca!==ia.count&&L.colors.add(Ga.Span.Start+"-"+Ga.Span.End,S[(ia.count-1)%S.length]));this.ME(Y,aa,fa,Ga.Span.Start,null);this.ME(Y,aa,Ga.Span.Start,Ga.Span.End,da);fa=Ga.Span.End;Aa.push(Ga.Span);let Z=Y.length-1;Q.push(new n(Z,Y[Z].text,c(Ga)));Ca=
ia.count}}else if(Ga.Range){let da=x.D(Ga.Range),Z=this.e_(da,ia,1);this.ME(Y,aa,fa,Ga.Span.Start,null);this.ME(Y,aa,Ga.Span.Start,Ga.Span.End,Z);K.push(new D.a(da,U));fa=Ga.Span.End;Aa.push(Ga.Span);let ha=Y.length-1;Q.push(new n(ha,Y[ha].text,c(Ga)))}this.formulaAssistanceTelemetryManager?0<X.Items.length&&this.formulaAssistanceTelemetryManager.Rbc.formulaHighlightsCounter++:this.Umc("ColoredReferencesManager.tryUpdateColoredReferences: FormulaAssistanceTelemetryManager unavailable");this.ME(Y,
aa,fa,aa.length,null);this.Bzc(L,Y,!!P);const Ya=L.textBox.text;if(!B.a.equals(Ya,aa,!1)){d.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Ya.length}], originalTextLength [${aa.length}]`);let Ga=L.textBox.caretPosition;L.textBox.text=aa;L.textBox.caretPosition=Ga;return!0}this.Ez(K,ia,Q);v.EwaSettings.oa(552)&&0<K.length&&d.ULS.sendTraceTag(524039688,0,
50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");v.EwaSettings.oa(552)&&0<L.colors.count&&d.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.FK=!0}finally{W&&W.PBa(()=>{na&&d.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${W.Bc} ms`)})}}else return this.Ez(null,null),this.FK&&(this.FK=!1,U=L.textBox.caretPosition,
L.textBox.setPlainText(aa),L.textBox.caretPosition=Math.min(U,aa.length),P)?!0:!1}Igb(L,P,aa){if(this.Qfb||L.PF)return!1;const U=isNullOrUndefined(P)?L.text:P;var K=[];const Y=new u.a(!1);if(1<U.length&&Object(M.b)(aa)){const W=[],X=[],Aa=[];var na=0;const Q=this.nka();for(const fa of aa.formulaHighlights){this.ME(W,U,na,fa.span.start,null);switch(fa.kind){case 0:case 1:case 2:aa=x.B(fa.rangeInfo.sharedRange);if(isNullOrUndefined(aa)){d.ULS.sendTraceTag(521211937,0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${fa.kind.toString()},`);
this.ME(W,U,fa.span.start,fa.span.end,null);break}na=this.e_(aa,Y,1);this.ME(W,U,fa.span.start,fa.span.end,na);K.push(new D.a(aa,Q));X.push({Start:fa.span.start,End:fa.span.end});aa=W.length-1;Aa.push(new n(aa,W[aa].text,b(fa)));break;case 3:this.ME(W,U,fa.span.start,fa.span.end,null,"rgba(229, 229, 229, 1)")}na=fa.span.end}this.ME(W,U,na,U.length);this.Bzc(L,W,!!P);P=L.textBox.text;if(!B.a.equals(P,U,!1))return d.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${P.length}], originalTextLength [${U.length}]`),
P=L.textBox.caretPosition,L.textBox.text=U,L.textBox.caretPosition=P,!0;this.Ez(K,Y,Aa);return this.FK=!0}this.Ez(null,null);return this.FK&&(this.FK=!1,K=L.textBox.caretPosition,L.textBox.setPlainText(U),L.textBox.caretPosition=Math.min(K,U.length),P)?!0:!1}eFb(L,P,aa){if(!L||!P||!aa)return d.ULS.shipAssertTag(524039685,0,!!L,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),d.ULS.shipAssertTag(524039684,0,!!P,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),
d.ULS.shipAssertTag(524039683,0,!!aa,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const U=Object(h.a)(n,P.metadata);if(!U)return d.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),!1;var K=U.TZd,Y=U.OPb,na=this.gridView.Ab.vrd(aa)?aa.mxb(U.NF,U.OF):aa.GLa(U.NF,U.OF,U.GK,U.HK);if(!na)return d.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const W=Y.indexOf("!");-1!==W&&(na=
Y.substring(0,W+1)+na);if(!L.textBox.changeTextInExistingTextPart(K,Y,na))return d.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;U.OPb=na;K=!0;for(Y=1;4>=Y;Y++)(na=A.h(this.Mc).qb.Gv(3,Y,P.xU))?(na.range=aa,na.metadata=U):(d.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),K=!1);this.gridView.qb.update(!1,!1);this.gridView.Vl&&(this.gridView.jc.textBox.text=L.text);this.gridView.jc.aRa(new l.a({XAb:!0}));
return K}gqi(L){if(3!==L.Sq)return d.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;L=Object(h.a)(n,L.metadata);return L?L.L_&&!L.v8a:(d.ULS.shipAssertTag(524039650,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}UBa(L,P){d.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(P?"suspending":"resuming")+" colored references");P&&this.FK&&(this.FK=
!1,this.Ez(null,null),L.textBox.$De());this.Qfb=P}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.fm(this.hza)}yzb(L){const P=this.formulaAssistanceTelemetryManager;P||this.Umc("ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable");null===P||void 0===P?void 0:P.XB(["highlightPreviewRanges"]);this.oR?this.tci(L):this.sci(L);null===P||void 0===P?void 0:P.Cw(["highlightPreviewRanges"],!0)}tci(L){var P=
this.formulaAssistanceManager.u5a(L,T.a);if(isNullOrUndefined(P))this.gla&&this.Ez(null,null);else{var aa=this.nka(),U=[],K=new u.a(!1),Y=[];P=P.formulaHighlights;for(const na of P)if(P=na.kind,0===P||2===P||1===P)P=x.B(na.rangeInfo.sharedRange),Object(M.b)(P)&&(U.push(new D.a(P,aa)),this.e_(P,K,1),Y.push(new n(na.span.start,L.substring(na.span.start,na.span.end),b(na),!0)));this.Ez(U,K,Y)}}sci(L){const P=this.nka();var aa=this.N6e();const U=this.Mc.workbookContext.WorkbookFileName,K=[],Y=new u.a(!1),
na=[];if(aa=this.calcManager.extractReferences(L,aa,U,!this.Ahf)){for(const W of aa.Items)W.Range&&(aa=x.D(W.Range),K.push(new D.a(aa,P)),this.e_(aa,Y,1),na.push(new n(W.Span.Start,L.substring(W.Span.Start,W.Span.End),c(W),!0)));this.Ez(K,Y,na)}else this.gla&&this.Ez(null,null)}e_(L,P,aa){let U=P.getItem(L.toString());U||(U=S[P.count%S.length],P.add(L.toString(),U));return String.format(U,aa)}nRh(L,P,aa,U){L="["+L+", "+P+"]";P=aa.getItem(L);P||(P=aa.count%S.length,P=S[P],U===String.format(P,1)&&(aa.add("skip-"+
L,P),P=aa.count%S.length,P=S[P]),aa.add(L,P));return String.format(P,1)}ME(L,P,aa,U,K=null,Y=null){d.ULS.shipAssertTag(524039648,0,aa<=U,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");aa<U&&(P=P.substring(aa,U),L.push(Object(f.a)(new z.a,{text:P,color:K,backgroundColor:Y})))}Ez(L,P,aa=null){L&&L.length?(d.ULS.sendTraceTag(524039647,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+L.length),L.reverse(),aa.reverse(),this.gridView.qb.qx(L,
[3],!0,(U,K)=>{if(U&&U.range&&K){d.ULS.shipAssertTag(524039643,0,P.kb(U.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${U.range.toString()}' doesn't exist in the range to color dictionary`);var Y=this.e_(U.range,P,.1),na=this.e_(U.range,P,1);this.Mc.frame&&this.Mc.frame.wD&&this.Mc.frame.wD.MN||(K.style.background=Y);K.style.borderColor=na;aa&&(K.setAttribute(m.a.$6a,U.xU.toString()),U.metadata=aa[U.xU])}else d.ULS.shipAssertTag(524039646,0,!!U,"ColoredReferencesManager.HighlightRanges: state is null"),
d.ULS.shipAssertTag(524039645,0,!!U.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),d.ULS.shipAssertTag(524039644,0,!!K,"ColoredReferencesManager.HighlightRanges: div is null")})):(L=this.Mc.Kb.Cc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Zg([3]),this.gridView.qb.fTa(new D.a(null,this.nka()),[3]),L.stop())}Bzc(L,P,aa){const U=L.textBox;U.HF=!0;var K=U.selection;const Y=K.index;K=Y+K.length;U.setTextFromTextParts(P);P=U.text.length;U.selectRange(Math.min(Y,
P),Math.min(K,P));aa&&L.aRa(new l.a);U.HF=!1}Umc(L){this.Bui&&!this.Jtf&&(d.ULS.sendTraceTag(521211935,0,50,L),this.Jtf=!0)}nka(){return this.aec().sheetId}N6e(){return this.aec().sheetName}aec(){return this.gridView.cr&&this.gridView.cr.dG?this.gridView.cr.dG:this.Mc.na}}Object(t.a)(H,"ColoredReferencesManager",null,[479,3]);class C extends e.a{constructor(L){super();this.$=L;this.Fb()}create(){this.$.da.fb(266,L=>{L=v.EwaSettings.ll()||v.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?
this.$.da.Aa(281)||this.$.da.Ga(281,new H(this.$,L)):new H(this.$,L);this.ob(L)})}static la(L){L.da.Ga(282,new C(L))}}Object(t.a)(C,"ColoredReferencesManagerFactory",e.a,[]);var G=a(9);a.d(E,"a",function(){return J});const J=()=>{G.a.Fa(C.la)}},1273:function(t,E,a){t=a(0);var c=a(222),b=a(812);class e extends c.a{constructor(h){super();this.$=h;this.Fb()}create(){this.$.da.fb(266,h=>{h=this.$.da.Aa(294)||this.$.da.Ga(294,new b.RelativeAndAbsoluteReferencesManager(h));this.ob(h)})}static la(h){h.da.Ga(295,
new e(h))}}Object(t.a)(e,"RelativeAndAbsoluteReferencesManagerFactory",c.a,[]);var f=a(9);a.d(E,"a",function(){return d});const d=()=>{f.a.Fa(e.la)}},1397:function(t,E,a){a.r(E);t=a(1209);E=a(1163);var c=a(1225);a=a(1273);Type.registerNamespace("_Ewa");Object(t.a)();Object(E.a)();Object(c.a)();Object(a.a)()},792:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(t.a)(c,"PositionBaseType",null,[])},812:function(t,E,a){a.r(E);t=a(0);var c=a(7),b=a(15);class e{}
Object(t.a)(e,"Reference",null,[]);class f extends e{constructor(){super();this.column=this.row=null}}Object(t.a)(f,"CellReference",e,[]);class d{constructor(){this.end=this.start=0;this.Qv=null}zSg(D,I){for(let M=0;M<this.Qv.length;M++){const T=this.Y1b(D,this.Qv[M]);I+=T;M<this.Qv.length-1&&(I+=":")}return I}}Object(t.a)(d,"IReferenceSequence",null,[]);var h=a(24),m=a(792);class l extends d{constructor(){super();this.bkc=!1}Tdc(){const {RelativeAndAbsoluteReferencesManager:D}=a(812),I=this.Qv[0];
return D.yyf(I.row.kind===m.a.abs,I.column.kind===m.a.abs)}Y1b(D,I){I=h.Range.Qc(I.row.index+1,I.column.index+1);return this.bkc?I.mxb(1===D||3===D,1===D||2===D):I.GLa(1===D||3===D,1===D||2===D,!0,!0)}}Object(t.a)(l,"CellReferenceSequence",d,[]);class w extends e{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(t.a)(w,"ColumnReference",e,[]);class n extends d{constructor(){super()}Tdc(){const D=this.Qv[0];return a(812).RelativeAndAbsoluteReferencesManager.Vwf(D.firstColumn,D.secondColumn).kind===
m.a.abs?2:3}Y1b(D,I){return h.Range.zwb(I.firstColumn.index+1,I.secondColumn.index+1).GLa(1===D||3===D,!0,1===D||3===D,!0)}}Object(t.a)(n,"ColumnReferenceSequence",d,[]);class x extends e{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(t.a)(x,"RangeReference",e,[]);class r extends d{constructor(){super()}Tdc(){const {RelativeAndAbsoluteReferencesManager:D}=a(812),I=this.Qv[0];return D.yyf(I.top.kind===m.a.abs,I.left.kind===m.a.abs)}Y1b(D,I){I=new h.Range(I.top.index+1,
I.left.index+1,I.bottom.index+1,I.right.index+1,!1,!1);const M=1===D||3===D;D=1===D||2===D;return I.GLa(M,D,M,D)}}Object(t.a)(r,"RangeReferenceSequence",d,[]);class u extends e{constructor(){super();this.secondRow=this.firstRow=null}}Object(t.a)(u,"RowReference",e,[]);class v extends d{constructor(){super()}Tdc(){const D=this.Qv[0];return a(812).RelativeAndAbsoluteReferencesManager.Vwf(D.firstRow,D.secondRow).kind===m.a.abs?0:1}Y1b(D,I){return h.Range.Vbc(I.firstRow.index+1,I.secondRow.index+1).GLa(!0,
1===D||2===D,!0,1===D||2===D)}}Object(t.a)(v,"RowReferenceSequence",d,[]);var B=a(983),z=a(984),A=a(175);a.d(E,"RelativeAndAbsoluteReferencesManager",function(){return y});class y{constructor(D){this.calcManager=D}A2a(D,I,M){let T,S;T=I;S=M;if(!D||!A.f(D))return{returnValue:D,MBd:T,LBd:S};var H=this.calcManager.TXe(D);if(!H)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),
{returnValue:null,MBd:T,LBd:S};H=this.F2h(H,D,I,M);let C=0,G="",J=0,L=0;for(;L<H.length;L++)if(this.EOe(H[L],I,M)){C=H[L].Tdc();T=H[L].start;break}for(;L<H.length&&this.EOe(H[L],I,M);L++)G+=D.substring(J,H[L].start),G=H[L].zSg(C,G),J=H[L].end;J&&(S=G.length);G+=D.substring(J,D.length);return{returnValue:G,MBd:T,LBd:S}}F2h(D,I,M,T){const S=[];for(let J=0;J<D.length;J++){var H=D[J];if(H.kind===B.a.range)if(H=H.ref,H.type===z.a.cell){var C=H;H=Object(c.a)(new l,{start:H.span.start,end:H.span.end,Qv:[Object(c.a)(new f,
{column:C.col,row:C.row})],bkc:this.calcManager.l4b(H.span.end,I)});S.push(H)}else if(H.type===z.a.range)this.FOe(H.topLeftSpan,M,T)&&this.FOe(H.bottomRightSpan,M,T)?(C=new x,H.top.index<=H.bottom.index?(C.top=H.top,C.bottom=H.bottom):(C.bottom=H.top,C.top=H.bottom),H.left.index<=H.right.index?(C.left=H.left,C.right=H.right):(C.right=H.left,C.left=H.right),H=Object(c.a)(new r,{start:H.topLeftSpan.start,end:H.bottomRightSpan.end,Qv:[C]}),S.push(H)):(C=Object(c.a)(new l,{start:H.topLeftSpan.start,end:H.topLeftSpan.end,
Qv:[Object(c.a)(new f,{column:H.left,row:H.top})],bkc:this.calcManager.l4b(H.topLeftSpan.end,I)}),H=Object(c.a)(new l,{start:H.bottomRightSpan.start,end:H.bottomRightSpan.end,Qv:[Object(c.a)(new f,{column:H.right,row:H.bottom})],bkc:this.calcManager.l4b(H.topLeftSpan.end,I)}),S.push(C),S.push(H));else if(H.type===z.a.column){C=H;for(H=Object(c.a)(new n,{start:H.span.start,end:H.span.end,Qv:[Object(c.a)(new w,{firstColumn:C.startIndex,secondColumn:C.endIndex})]});H.end<I.length-1&&":"===I.charAt(H.end)&&
J<D.length-1;)if(C=D[J+1].ref,C.type===z.a.column&&C.span.start===H.end+1){var G=C;H.Qv.push(Object(c.a)(new w,{firstColumn:G.startIndex,secondColumn:G.endIndex}));H.end=C.span.end;J++}else break;S.push(H)}else if(H.type===z.a.row){C=H;for(H=Object(c.a)(new v,{start:H.span.start,end:H.span.end,Qv:[Object(c.a)(new u,{firstRow:C.startIndex,secondRow:C.endIndex})]});H.end<I.length-1&&":"===I.charAt(H.end)&&J<D.length-1;)if(C=D[J+1].ref,C.type===z.a.row&&C.span.start===H.end+1)G=C,H.Qv.push(Object(c.a)(new u,
{firstRow:G.startIndex,secondRow:G.endIndex})),H.end=C.span.end,J++;else break;S.push(H)}}return S}EOe(D,I,M){return!(D.start>M||I>D.end)}FOe(D,I,M){return!(D.start>M||I>D.end)}static Vwf(D,I){return D.index<=I.index?D:I}static yyf(D,I){return I||D?I&&D?2:!I&&D?3:0:1}}Object(t.a)(y,"RelativeAndAbsoluteReferencesManager",null,[478])},940:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(264),e;(function(v){v[v.paren=0]="paren";v[v.lead=1]="lead";v[v.intern=2]="intern";v[v.trail=3]="trail";v[v.undefined=
4]="undefined"})(e||(e={}));Object(t.b)("CurrencyFormatOption",e);var f;(function(v){v[v.none=-1]="none";v[v.mdy=0]="mdy";v[v.dmy=1]="dmy";v[v.ymd=2]="ymd";v[v.myd=3]="myd";v[v.dym=4]="dym";v[v.ydm=5]="ydm"})(f||(f={}));Object(t.b)("DateOrderOption",f);var d=a(8);class h{constructor(v,B){({CalcHelper:v}=a(940));B&&(B.Je||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.eAg=v.tJe(B,v.gJe(B.Uja));this.fAg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.fAg}get localeData(){return this.eAg}formatNumber(v){return this.localeInfo.formatNumber(v)}}
Object(t.a)(h,"LocaleHolder",null,[]);var m=a(981),l=a(52),w=a(1),n=a(22),x=a(13),r=a(201);a.d(E,"CalcHelper",function(){return u});class u{constructor(v){this.$=v;(this.vy=this.$.da.Aa(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let B;B=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?l.a.current.io(76):l.a.current.io(79);this.logger=new m.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.yca=new h(v,this.vy);excelOnlineCalc.config.initCalc(this.logger,this.vy?z=>this.vy.isFeatureEnabled(z):()=>!1,B);this.Qug=excelOnlineCalc.config.calcConfig(this.yca.localeInfo)}get config(){return this.Qug}Oih(){if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.va)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const v=this.$.va.na;
return v?v.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.va.na.index}createParser(){const v={};v.config=this.config;return excelOnlineCalc.parse.createParser(v)}createNumberFormatter(){const v=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(B,z)=>excelOnlineCalc.calc.getTime(this.config,B,z,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(v)}Zgh(v,B,z,A){if(!A)return{range:{row:B,col:z},sheet:{document:this.documentLoc,
index:v}};B=excelOnlineCalc.location.gridCell(B,z);v=excelOnlineCalc.location.sheetIndex(this.documentLoc,v);return excelOnlineCalc.location.sheetGridCell(v,B)}huh(v,B){let z;z=excelOnlineCalc.calc.getEvalResultKind(v);switch(z){case 4:return{returnValue:v?this.yca.localeInfo.trueName:this.yca.localeInfo.falseName,kind:z};case 1:return{returnValue:w.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.DDc(this.yca.formatNumber(v),B):this.yca.formatNumber(v),
kind:z};case 2:return{returnValue:w.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.DDc(v.toString(),B):v.toString(),kind:z};case 128:return{returnValue:"",kind:z};case 8:switch(v.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.yca.localeInfo.errorNames[v.type],kind:z};default:return{returnValue:u.unknownError,kind:z}}case 32:return{returnValue:w.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.DDc(this.phh(v,B),B):"##UNSUPPORTED: ARRAY",kind:z};default:return{returnValue:x.a.instance.ga(2214),kind:z}}}DDc(v,B){return v.length<=B?v:v.substring(0,B-3)+"..."}phh(v,B){let z=this.yca.localeInfo.leftBrace;for(let A=0;A<v.rows;++A){for(let y=0;y<v.cols;++y)z+=v.opers[A][y],y<v.cols-1&&(z+=this.yca.localeInfo.columnSeparator);A<v.rows-1&&(z+=this.yca.localeInfo.rowSeparator)}return this.DDc(z,B-1)+this.yca.localeInfo.rightBrace}static tJe(v,B=null){const z=u.O6b(),A=v.Je.TrueValueString,y=
v.Je.FalseValueString,D=v.Je.DecimalSeparator.toString(),I=v.Je.ListSeparator.toString(),M=v.Je.ColumnSeparator.toString(),T=v.Je.RowSeparator.toString(),S=v.Je.ThousandsDataArray,H=v.Je.ThousandSeparator.toString(),C=v.Je.Lcid,G=v.Je.Country,J=v.Je.DigitsNumber,L=v.Je.ExpSeparatedBySpace,P=v.Je.FractionSeparator.toString(),aa=v.Je.PercentSeparatedBySpace,U=n.a.T1g(Enum.toString(e,v.Je.CurrencyFormat)),K=v.Je.CurrencySymbolLead,Y=v.Je.CurrencySeparatedBySpace,na=v.Je.CurrencySymbolString,W=v.Je.DigitsCurrency,
X=-1===v.Je.DateOrder?"MDY":r.e(Enum.toString(f,v.Je.DateOrder)),Aa=v.Je.DateSeparator.toString(),Q=v.Je.DateAlternativeSeparator.toString(),fa=v.Je.Year4Digits,Ca=v.Je.Month2Digits,ia=v.Je.Day2Digits,Ra=v.Je.LongDateFormat,Ya=v.Je.TimeSeparator.toString(),Ga=v.Je.TimeAltSeparator,da=v.Je.Hour2Digits,Z=v.Je.Use24HourClock,ha=v.Je.AmPmSeparatedBySpace,Wa=[v.Je.AmString,v.Je.PmString],ca=v.Je.DayNameShortArray,ja=v.Je.DayNameLongArray,ua=v.Je.MonthNameShortArray,Za=v.Je.MonthNameLongArray,Pa=v.Je.PictureSpecialArray,
ka=b.a.map(("\x00"+v.Je.PictureSingleString).split(""),Mb=>"\x00"===Mb?null:Mb),ra=v.Je.PictureColorArray,ba=v.Je.PictureDbnumArray,Ua=v.Je.RowLetter.toString(),Ka=v.Je.ColumnLetter.toString(),Oa=v.Je.LeftBrace.toString(),ib=v.Je.RightBrace.toString(),La=v.Je.LeftBracket.toString(),db=v.Je.RightBracket.toString(),Ab=u.x3h(v.Je);return excelOnlineCalc.calc.localeData(B,z,A,y,Ua,Ka,Oa,ib,La,db,D,I,M,T,S,H,C,G,J,L,P,aa,U,K,Y,na,W,X,Aa,Q,fa,Ca,ia,Ra,Ya,Ga,da,Z,ha,Wa,ca,ja,ua,Za,Pa,ka,ra,ba,Ab,v.Je.SysDateFormatString,
v.Je.SysTimeFormatString)}static gJe(v){const B=[];if(!v)return B;for(const z of v)v=null,z.IsDynamicUdf||(v=excelOnlineCalc.calc.worksheetFunctionName(z.FunctionIndexInServer,z.NameUI)),v&&B.push(v);return B}static O6b(){const v=[],B=Object.keys(d.a.errorNames);for(let z=0;z<B.length;z++){const A=excelOnlineCalc.calc.errorTypeName(z+1,B[z]);A&&v.push(A)}return v}static x3h(v){const B=Array(6);B[1]="#"+v.AllStructRefString;B[3]="#"+v.HeadersStructRefString;B[2]="#"+v.DataStructRefString;B[4]="#"+
v.TotalsStructRefString;B[5]="#"+v.ThisRowStructRefString;return B}}u.unknownError="##ERR##";Object(t.a)(u,"CalcHelper",null,[])},983:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.wzi="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.arf="letName";c.all="*";c.IYd="structRefRange";Object(t.a)(c,"TraverseFormulaInterestTypes",null,[])},984:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.cell="cell";c.range="range";c.row=
"row";c.column="col";Object(t.a)(c,"TraverseFormulaRefTypes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/0210bb79d7e04fc07c183685a9e253ea/EwaDSEsNext.calc.js.map