'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1144:function(t,E,a){t=a(0);var c=a(84),b=a(553),e=a(15),f=a(133);class d{constructor(Oa,ib,La){this.qWd=this.rWd=this.sWd=!1;this.HWd=!Oa&&!ib;this.IWd=!Oa&&!La;this.HWd||this.IWd||(this.sWd=!Oa,this.rWd=!ib,this.qWd=!La)}}Object(t.a)(d,"RenameDisabledDialogInfo",null,[]);class h extends f.StandardDialog{constructor(Oa,ib,La,db,Ab){super();this.PZd=[];this.q2=new d(Oa,ib,La);this.asa=db;this.Tqa=Ab;this.Ee=
"RenameDisabledDialog";this.Tb=0;this.qc(1,CommonUIStrings.l_DialogClose);this.TAj();this.Wkj()}TAj(){this.q2.HWd?this.tOb(this.asa?this.Tqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.q2.IWd?this.tOb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.BJg();this.nsa(this.PZd)}tOb(Oa){Array.add(this.PZd,Oa)}BJg(){const Oa=[];this.q2.sWd||Array.add(Oa,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.q2.rWd||Array.add(Oa,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.q2.qWd||Array.add(Oa,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Oa.length&&Array.add(this.PZd,Oa)}}Object(t.a)(h,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class m extends h{constructor(Oa,ib,La,db,Ab){super(Oa,ib,La,db,Ab)}Wkj(){this.TEb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(t.a)(m,"ReactRenameDisabledDialog",h,[]);var l=a(146);class w{static get og(){return l.a.jq(w.nl,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}w.nl="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(t.a)(w,"RenameDisabledDialogHtml",null,[]);class n extends l.a{constructor(Oa,ib,La,db,Ab){super();this.q2=new d(Oa,ib,La);this.asa=db;this.Tqa=Ab;this.Ee="RenameDisabledDialog";this.Tb=0;this.qc(1,CommonUIStrings.l_DialogClose);this.og=w.og;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.wX("RenameRow")}rab(){if(this.q2.HWd){let Oa;Oa=this.asa?this.Tqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;n.tOb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Oa)}else this.q2.IWd?n.tOb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.ici()}ici(){this.q2.sWd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.q2.rWd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.q2.qWd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static tOb(Oa,ib,La){Oa.style.display="none";ib.innerText=La}}Object(t.a)(n,"RenameDisabledDialog",l.a,[]);var x=a(4),r=a(30),u=a(106),v=a(25);class B{constructor(Oa,ib){this.dFa=0;this.La=Oa;this.W8=ib}initialize(Oa){if(!this.La||!this.W8)return!1;this.dFa=Oa;this.Hg();return!0}Hg(){this.La.Nb(v.a.via,u.a.frame,Object(c.a)(this,this.via,"commitNewDocumentTitle"))}via(Oa,ib,La,db,Ab){if(1===La)return this.La.processAction(v.a.renameFile,
1);Oa=r.a.mq(this.W8.sn);Ab=(0,Ab.getNewDocumentTitle)();Ab.length>this.dFa&&(Ab=Ab.substr(0,this.dFa));if(32!==this.La.$d(v.a.renameFile,2,Ab))return this.PX(Oa),8;this.PX(Ab);return 32}PX(Oa){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Oa))}static vid(){return new B(x.AFrameworkApplication.ub,x.AFrameworkApplication.sm)}}Object(t.a)(B,"ReactRenameUIHandler",null,[406]);var z=a(94),A=a(522),y=a(555),D=a(14),I=a(108),M=a(240),T=a(87),S=a(39),H=a(27),C=a(82);class G{constructor(Oa,
ib,La,db,Ab,Mb,pb,Qb,xb,pa,Ma,ya){this._initialized=!1;this._element=null;this.dFa=0;this.HTc=this.dNc=!1;this.La=Oa;this.tIc=ib;this.Yd=La;this.IA=db;this.W8=Ab;this.zke=Mb;this.AYb=pb;this.oJc=Qb;this.j9=xb;this.ide=pa;this.EXa=Ma;this.$Nc=ya}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Oa,ib,La){if(!(this.La&&this.W8&&this.zke&&this.AYb&&this.oJc&&ib)||0>=Oa)return!1;this._element=ib;this._element.title=La;this._element.setAttribute(T.a.Ad,T.a.rt);this._element.setAttribute("Unselectable",
"on");this.dFa=Oa;this.Ss();return this._initialized=!0}Ss(){this.tIc&&(this.tIc.sa(D.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.tIc.sa(D.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.sa(D.a.Pb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.IA.sa(D.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.IA.sa(D.a.Rf,this._element,Object(c.a)(this,this.Qf,"onPointerUp"))}onBlur(){this.isActive&&!this.dNc&&
(this.ide||this.oJc(this._element),this.hGe(),this.R8c(!1));return this.dNc=!1}onPaste(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Oa){return this.isActive?this.PUi(Oa):this.QUi(Oa)}PUi(Oa){let ib=!1;switch(Oa.Ca.keyCode){case Sys.UI.Key.enter:this.hGe();this.R8c(this.EXa||this.$Nc);ib=!0;break;case Sys.UI.Key.tab:this.ide&&this.oJc(this._element);break;case Sys.UI.Key.esc:this.BPd(),this.R8c(this.EXa||this.$Nc),ib=!0}return ib}QUi(Oa){let ib=
!1;switch(Oa.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Ogg(this.$Nc),this.isActive&&this.AYb(this._element),ib=!0}return ib}onPointerDown(){this.isActive||(this.Ogg(!1),this.isActive&&(this._element.focus(),this.AYb(this._element),this.HTc=!0));return!1}Qf(){return this.HTc?(this.AYb(this._element),this.HTc=!1,!0):!1}y8a(){return 32===this.La.processAction(v.a.renameFile,1)}hGe(){const Oa=r.a.mq(this.W8.sn);let ib=this._element.innerText.trim();ib.length>this.dFa&&(ib=ib.substr(0,
this.dFa));ib!==Oa&&""!==ib?32!==this.La.$d(v.a.renameFile,2,ib)?this.BPd():this.PX(ib):this.BPd()}BPd(){this.PX(r.a.mq(this.W8.sn))}PX(Oa){this._initialized&&(this._element.innerText=Oa,this.zke())}Ogg(Oa){this.y8a()?this.isActive||(Oa&&(this.dNc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(T.a.Ad,T.a.l_c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,z.CuiHelper.BPe),
this.j9&&this.j9.execute(ib=>{ib.HRf(!0)}),Oa&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(v.a.kfb,2)}R8c(Oa){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(T.a.Ad,T.a.rt);Sys.UI.DomElement.removeCssClass(this._element,z.CuiHelper.BPe);this.j9&&this.j9.execute(ib=>{ib.HRf(!1)});Oa&&(this._element.blur(),this._element.focus())}static dA(){A.a.dA(x.AFrameworkApplication.isRtl)}static vid(){return new G(x.AFrameworkApplication.ub,
y.a.instance,I.KeyInputManager.instance,M.a.instance,x.AFrameworkApplication.sm,G.dA,S.a.ctj,S.a.n5g,C.a.instance.Rb("Common.App.Header.HeaderEventSource"),H.a.zla,H.a.$g,H.a.Jf)}}Object(t.a)(G,"RenameUIHandler",null,[406]);class J{static get instance(){return x.AFrameworkApplication.ta.Pa.Gs?J.Ma||(J.Ma=B.vid()):J.Ma||(J.Ma=G.vid())}}J.Ma=null;Object(t.a)(J,"RenameUIHandlerFactory",null,[]);var L=a(98),P=a(135);class aa{constructor(){this.dKi=this.$Ji=this.Jih=null}}Object(t.a)(aa,"RenameMruEntryProperties",
null,[]);var U=a(376),K=a(164),Y=a(644),na;(function(Oa){Oa[Oa.unknown=-1]="unknown";Oa[Oa.success=0]="success";Oa[Oa.renameInvalidFileName=1]="renameInvalidFileName";Oa[Oa.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Oa[Oa.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Oa[Oa.permissionDenied=4]="permissionDenied";Oa[Oa.serverCommunicationFailure=5]="serverCommunicationFailure";Oa[Oa.fileNameTooLong=6]="fileNameTooLong"})(na||(na={}));Object(t.b)("CommonOperationResult",
na);class W{constructor(Oa,ib,La,db,Ab,Mb,pb,Qb,xb,pa,Ma,ya){this.ude=Oa;this.La=ib;this.yJc=La;this.dw=db;this.XEa=Ab;this.gGg=Mb;this.asa=pb;this.Cne=Qb;this.HCg=xb;this.Tqa=pa;this.nb=Ma;this.GCg=ya}Hg(){x.AFrameworkApplication.ta&&x.AFrameworkApplication.ta.Pa.Gs||this.Wh.Nb(v.a.gAb,u.a.frame,Object(c.a)(this,this.gAb,"initializeRenameUIHandler"));this.Wh.Nb(v.a.kfb,u.a.frame,Object(c.a)(this,this.kfb,"showRenameDisabledDialog"));this.Wh.Nb(v.a.renameFile,u.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.Wh.Me(v.a.fileNameUpdate,u.a.frame,Object(c.a)(this,this.Cdj,"refreshFilename"),64);this.Wh.Me(v.a.loc,u.a.frame,Object(c.a)(this,this.loc,"moveToFolderCompleteByHost"),64);this.Wh.Nb(v.a.vPa,u.a.frame,Object(c.a)(this,this.vPa,"moveToFolder"));(x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||x.AFrameworkApplication.ta&&(x.AFrameworkApplication.fa.qa("PostMessageEmbedded")||x.AFrameworkApplication.fa.qa("IsJsApi"))&&
x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&x.AFrameworkApplication.AV().execute(Oa=>{Oa.vo(K.a.txf);Oa.em(K.a.txf,W.ncj);Oa.vo(K.a.xdd);Oa.em(K.a.xdd,W.lcj)})}y8a(){return 0===this.GCg.J7e()?32:8}x1j(){return this.sz?this.asa?this.sz.BOe:this.sz.Nwb:!0}gAb(){return J.instance.initialize(x.AFrameworkApplication.Sac,x.AFrameworkApplication.Z2a,x.AFrameworkApplication.TNd||CommonUIStrings.l_RenameFileTooltip)?32:8}kfb(){const Oa=this.x1j(),
ib=this.gGg();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.XEa,ib,Oa,this.asa);x.AFrameworkApplication.ta&&x.AFrameworkApplication.ta.Pa.Lv&&x.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new m(this.XEa,!ib,!Oa,this.asa,this.Tqa()):new n(this.XEa,!ib,!Oa,this.asa,this.Tqa());return 32}renameFile(Oa,ib,La,db,Ab){if(1===
La)return this.y8a();if(!x.AFrameworkApplication.rac)return 8;if(8===this.y8a())return this.Wh.processAction(v.a.kfb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");x.AFrameworkApplication.rac(Ab,Object(c.a)(this,this.cHb,"onRenameFileSuccess"),Object(c.a)(this,this.tXi,"onRenameFileFailure"));return 32}cHb(Oa,ib){Oa?0!==Oa.OperationResult?this.xaf(Oa.OperationResult):(this.ouj(ib,Oa.NewName),this.TXj(Oa,Object(c.a)(x.AFrameworkApplication.ta.Pa,x.AFrameworkApplication.ta.Pa.qkg,"updateOpenInClientDocumentUrl")),
x.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&x.AFrameworkApplication.ta.updateCommandUI(),this.HCg.Vig()):this.xaf(5)}ouj(Oa,ib){const La={};La[U.a.dGh]=ib;Oa.Sj(K.a.xdd,La)}TXj(Oa,ib){this.gYj(Oa);x.AFrameworkApplication.P8b=Oa.DirectInvokeDavUrl;ib=ib(Oa.EditDocInClientUrl);const La=new aa;La.dKi=this.dw.sn;La.Jih=ib;La.$Ji=Oa.EditDocInClientUrl;this.Wh.$d(v.a.renameMostRecentlyUsedFileEntry,2,La)}xaf(Oa){switch(Oa){case 1:Oa=new f.StandardDialog,Oa.Tb=0,Oa.CX(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null),this.s_f()}}gYj(Oa){this.dw.sn=W.$Rg(this.dw.sn,Oa.NewName);Oa.BreadcrumbFolderName&&(this.dw.breadcrumbFolderName=Oa.BreadcrumbFolderName);Oa.BreadcrumbFolderUrl&&(this.dw.breadcrumbFolderUrl=Oa.BreadcrumbFolderUrl);this.Cne(Oa.NewName)}tXi(Oa){const ib=new f.StandardDialog;ib.Tb=0;switch(Oa){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ib.FBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,
null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ib.FBa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Oa}),ib.FBa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}x.AFrameworkApplication.AV().execute(La=>{La.Sj(K.a.cGh,{["FailureMessage"]:na[Oa]})});this.s_f()}Cdj(Oa,ib,La){if(1===
La)return this.y8a();if(!x.AFrameworkApplication.nKa)return 8;x.AFrameworkApplication.nKa(Object(c.a)(this,this.crc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.brc,"onRefreshFilenameFailure"),!1);return 32}vPa(Oa,ib,La,db,Ab){if(1===La)return x.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===La){const Mb={};Oa=x.AFrameworkApplication.jca;ib=x.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");Oa=(!Oa||Oa&&ib)&&x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);Mb[U.a.lOj]=Oa;Ab&&Ab.MoveButtonClickedTime&&(Mb[U.a.AIi]=Ab.MoveButtonClickedTime.getTime());x.AFrameworkApplication.AV().execute(pb=>{pb.Sj(K.a.vPa,Mb)});if(Ab&&Ab.MoveButtonClickedTime){if(Oa=P.a.gs())Ab=(new Date).getTime()-Ab.MoveButtonClickedTime.getTime(),Oa.set("MovePostDuration",Ab.toString());L.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Oa)}return 32}return 8}loc(Oa,ib,La,db,Ab){if(1===La)return x.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.y8a():8;
if(2===La){if(!x.AFrameworkApplication.g3f)return L.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Ab)return L.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Ab[U.a.Omi])if(Ab[U.a.qlg])if(Oa=Ab[U.a.qlg].toLowerCase(),ib=x.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),La=x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ib&&x.AFrameworkApplication.jca&&
La){const Mb={};Mb[U.a.kRa]="1";Mb[U.a.documentUrl]=Oa;Mb[U.a.reason]=Y.a.saveAs;L.Health.instance.recordKpiSuccess("MoveToFolder",null);x.AFrameworkApplication.AV().execute(pb=>{pb.Sj(K.a.zua,Mb)})}else if(!x.AFrameworkApplication.jca&&La)L.Health.instance.recordKpiSuccess("MoveToFolder",null),S.a.kf(Oa,S.a.TX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return L.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else L.Health.instance.recordKpiFailure("MoveToFolder",
"Null newDocUrl",!1,!1,null);else x.AFrameworkApplication.nKa(Object(c.a)(this,this.crc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.brc,"onRefreshFilenameFailure"),!1),x.AFrameworkApplication.g3f(),L.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}fGj(Oa,ib){return Oa&&ib?Oa!==this.dw.breadcrumbFolderName||ib!==this.dw.breadcrumbFolderUrl:!1}crc(Oa,ib){Oa&&(Oa.NewName!==r.a.mq(this.dw.sn)||this.fGj(Oa.BreadcrumbFolderName,Oa.BreadcrumbFolderUrl))&&this.cHb(Oa,ib)}brc(){}s_f(){this.Cne(r.a.mq(this.dw.sn))}get Wh(){return this.La.value}get sz(){return this.yJc.value}static get instance(){return W.Ma||
(W.Ma=W.Owb())}static Owb(){return new W(x.AFrameworkApplication.z8a,new b.a(()=>x.AFrameworkApplication.ub),new b.a(()=>x.AFrameworkApplication.sz),x.AFrameworkApplication.sm,x.AFrameworkApplication.limitedEdit,()=>x.AFrameworkApplication.userCanRename,x.AFrameworkApplication.bwc,Object(c.a)(J.instance,J.instance.PX,"updateTitle"),C.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.fa,C.a.instance.resolve("Common.IRenameProps"))}static $Rg(Oa,
ib){Oa=r.a.L4(Oa);return ib+Oa}static ncj(Oa){const ib=Oa.Values[U.a.Cqi];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ib);ib?x.AFrameworkApplication.ub.$d(v.a.loc,2,Oa.Values):L.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static lcj(Oa){x.AFrameworkApplication.ub.$d(v.a.renameFile,2,Oa.Values.NewName)}}W.Ma=null;Object(t.a)(W,"RenameActor",null,[]);a(568);class X{}Object(t.a)(X,"ActivityEventName",null,[]);class Aa{}
Aa.compatMode="CompatMode";Aa.noSelection="NoSelection";Object(t.a)(Aa,"ActivityEventReason",null,[]);var Q=a(643);class fa{constructor(Oa,ib){this.La=Oa;this.OWa=ib}Hg(){this.La.Nb(v.a.R$f,u.a.frame,Object(c.a)(this,this.NIj,"showRenameDialogAction"))}NIj(Oa,ib,La){Oa=32;if(1===La)return Q.SessionStatusManager.instance.t6a||x.AFrameworkApplication.G5?8:32;2===La&&(32!==this.La.processAction(v.a.renameFile,1)?(this.La.processAction(v.a.kfb,2),Oa=8):32===this.La.processAction(v.a.sOb,1)?this.La.processAction(v.a.sOb,
2):this.OWa.value.create().EAc());return Oa}}Object(t.a)(fa,"RenameDialogActor",null,[388]);class Ca{constructor(Oa,ib,La){this.dialog=null;this.La=Oa;this.dw=ib;this.Eqa=La}m1h(){const Oa={};Oa.nameInputProps={["type"]:"AppInputProps",["id"]:Ca.Y2a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:r.a.mq(this.dw.sn),["maxLength"]:this.Eqa};return Oa}EAc(){const Oa={["id"]:"RenameDialog",["bodyControls"]:this.m1h()};this.dialog=new l.a(!1,!1,!0);this.dialog.Tb=1;this.dialog.Ee="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.RNd,"renameDialogHandler"),Oa)}RNd(Oa,ib){ib&&1===Oa&&ib[Ca.Y2a]&&(Oa=r.a.mq(this.dw.sn),ib=(ib[Ca.Y2a]||"").trim(),ib!==Oa&&""!==ib&&this.La.$d(v.a.renameFile,2,ib))}}Ca.Y2a="txtDocumentName";Object(t.a)(Ca,"ReactRenameDialog",null,[407]);class ia{static get og(){return l.a.jq(ia.nl,CommonUIStrings.l_RenameDialogLabel)}}ia.nl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(t.a)(ia,"RenameDialogHtml",null,[]);class Ra extends l.a{constructor(Oa,ib,La){super();this.La=Oa;this.dw=ib;this.Eqa=La;this.Ee="RenameDialog";this.og=ia.og}EAc(){var Oa={["txtDocumentName"]:r.a.mq(this.dw.sn)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.RNd,"renameDialogHandler"),Oa);Oa=document.getElementById(Ra.Y2a);0<this.Eqa&&(Oa.maxLength=this.Eqa);Oa.focus()}RNd(Oa,ib){1===Oa&&(Oa=r.a.mq(this.dw.sn),ib=(ib[Ra.Y2a]||"").trim(),ib!==Oa&&""!==ib&&this.La.$d(v.a.renameFile,
2,ib))}}Ra.Y2a="txtDocumentName";Object(t.a)(Ra,"RenameDialog",l.a,[407]);class Ya{constructor(Oa){this.W8=null;this.Eqa=0;this.La=Oa;this._initialized=!1}initialize(Oa,ib){this.W8=Oa;this.Eqa=ib;this._initialized=!0}create(){return this._initialized?x.AFrameworkApplication.ta&&x.AFrameworkApplication.ta.Pa.Lv&&x.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new Ca(this.La,this.W8,this.Eqa):new Ra(this.La,this.W8,this.Eqa):null}}Object(t.a)(Ya,"RenameDialogFactory",null,[387]);var Ga=
a(261),da=a(145),Z=a(137),ha=a(107),Wa=a(103);class ca{constructor(Oa,ib){this.La=Oa;this.Yb=ib}Hg(){this.La.Nb(v.a.sOb,u.a.frame,Object(c.a)(this,this.OIj,"showRenameFlyoutAction"))}m1g(){return Z.d("setDocumentTitleFlyoutOpened")&&x.AFrameworkApplication.ta.Pa.Gs}OIj(Oa,ib,La){if(1===La)return this.m1g()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}NKg(){ca.Bti&&x.AFrameworkApplication.l8a&&Wa.a.instance.Eg(new ha.a(5,1,5E3,()=>{32===this.La.processAction(v.a.sOb,
1)&&this.Yb&&this.Yb.hi.name===Ga.AFrame.waa&&(da.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(v.a.sOb,2))}))}static get Bti(){ca.ZVb&&null!=ca.ZVb||(x.AFrameworkApplication.uya("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ca.ZVb=x.AFrameworkApplication.fa?x.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ca.ZVb}}ca.ZVb=null;Object(t.a)(ca,"RenameFlyoutActor",null,
[386]);class ja{constructor(Oa,ib,La,db,Ab){this.yJc=Ab;this.vde=La;this.ude=db;this.kGg=Oa;this.Tqa=ib}get sz(){return this.yJc.value}J7e(){if(!this.ude())return 5;if(this.Tqa())return 1;if(this.sz){if(this.vde&&!this.sz.BOe)return 3;if(!this.vde&&!this.sz.Nwb)return 4}return this.kGg()?0:2}}Object(t.a)(ja,"RenameProps",null,[385]);a(187);var ua=a(99);class Za{constructor(Oa,ib,La,db,Ab,Mb){this.ln=!1;this.vPc=new ua.a;this.TWa=ib;this.kM=La;this.uug=db;this.nb=Ab;this.jme=Mb}enable(){this.ln||(this.Vig(),
this.fYd(),this.ln=!0)}generateKey(Oa,ib,La){return String.format("{0}/{1}/{2}",La,Oa,ib)}vXh(){const Oa=r.a.mq(this.TWa().sn);return this.generateKey(this.TWa().breadcrumbFolderName,this.TWa().breadcrumbFolderUrl,Oa)}wXh(Oa,ib,La){return Oa&&ib?this.generateKey(Oa,ib,La):La}fnh(Oa,ib,La){return Oa&&Oa!==this.TWa().breadcrumbFolderName||ib&&ib!==this.TWa().breadcrumbFolderUrl?!0:La!==r.a.mq(this.TWa().sn)}Vig(){const Oa=this.vXh();this.vPc.ia(Oa,new Date)}rHd(Oa){this.LEj(Oa)&&this.Koe(Oa)}LEj(Oa){const ib=
this.uug();return ib?this.jme&&this.jme.vBb||!ib.Bjf||!x.AFrameworkApplication.nKa?(this.xcg(Oa),this.ln=!1):!0:!1}WJf(Oa,ib,La,db){const Ab=this.fnh(Oa,ib,La);Oa=this.wXh(Oa,ib,La);ib=this.vPc.Ec(Oa).returnValue;Ab&&!ib&&(this.yaf(db),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Vxd));Ab||this.vPc.ia(Oa,this.kM())}}Object(t.a)(Za,"ARenamedFileChecker",null,[285]);class Pa extends Za{constructor(Oa,ib,La,db,Ab,Mb,pb,Qb){super(Oa,ib,La,db,Ab,Mb);this.tje=Ab;this.FCg=pb;this.fyg=
Qb}get Vxd(){return"RenamedFileCheckerUsingSettingsRefresh"}fYd(){this.tje.rYc(Object(c.a)(this,this.kbf,"handleSettingsRefresh"))}kbf(Oa,ib){ib&&ib.yFb&&ib.tMi&&(ib.I8a("BreadcrumbDocName")||ib.I8a("BreadcrumbFolderName")||ib.I8a("BreadcrumbFolderUrl")||ib.I8a("DirectInvokeDAVUrl")||ib.I8a("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Vxd),this.rHd(ib))}xcg(){this.tje.Ejj(Object(c.a)(this,this.kbf,"handleSettingsRefresh"))}Koe(Oa){if(Oa&&Oa.yFb){const ib=
Oa.yFb;this.WJf(ib.Xa("BreadcrumbFolderName"),ib.Xa("BreadcrumbFolderUrl"),ib.Xa("BreadcrumbDocName"),Oa)}}yaf(Oa){const ib={OperationResult:0,classId:1};Oa=Oa.yFb;ib.BreadcrumbFolderName=Oa.Xa("BreadcrumbFolderName");ib.BreadcrumbFolderUrl=Oa.Xa("BreadcrumbFolderUrl");ib.DirectInvokeDavUrl=Oa.Xa("DirectInvokeDAVUrl");ib.EditDocInClientUrl=Oa.Xa("EditDocInClientUrl");Oa=Oa.Xa("BreadcrumbDocName");ib.NewName=x.AFrameworkApplication.yua?Oa:r.a.mq(Oa);this.fyg.execute(La=>{this.fki(ib,La)})}fki(Oa,ib){this.FCg().cHb(Oa,
ib)}}Object(t.a)(Pa,"RenamedFileCheckerUsingSettingsRefresh",Za,[]);class ka extends Za{constructor(Oa,ib,La,db,Ab,Mb,pb,Qb,xb,pa){super(Oa,La,db,Ab,Mb,xb);this.Fmb=this.f_b=null;this.NBg=ib;this.La=pb;this.ke=Qb;pa&&pa.execute(Ma=>{this.Sfj(Ma)})}get Vxd(){return"RenamedFileCheckerUsingTask"}Sfj(Oa){this.f_b=Oa;this.f_b.Use(Object(c.a)(this,this.Jyb,"handleVisibilityChange"))}Jyb(Oa,ib){!this.ln||0!==ib.newState&&1!==ib.newState||this.Fmb||(this.fYd(),this.rHd(this.Fmb))}fYd(){this.Fmb=new ha.a(3,
2,this.NBg(),Object(c.a)(this,this.rHd,"performRenameFileCheckTick"),89);this.ke.Eg(this.Fmb)}xcg(Oa){this.ke.rp(Oa)}Koe(Oa){this.f_b&&2===this.f_b.S6j?this.Sgj(Oa):x.AFrameworkApplication.nKa(Object(c.a)(this,this.crc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.brc,"onRefreshFilenameFailure"),!0)}Sgj(Oa){this.ke.rp(Oa);this.Fmb=null}crc(Oa){Oa&&this.WJf(Oa.BreadcrumbFolderName,Oa.BreadcrumbFolderUrl,Oa.NewName,null)}yaf(){this.La.processAction(v.a.fileNameUpdate,2)}brc(){}}Object(t.a)(ka,"RenamedFileCheckerUsingTask",
Za,[]);var ra=a(96);class ba{constructor(){this.nb=this.$a=null}get name(){return"Common.App.RenameFile"}Oh(Oa){this.$a=Oa;this.nb=x.AFrameworkApplication.fa;this.$a.register(fa,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ac(()=>new fa(x.AFrameworkApplication.ub,this.$a.uPd("Common.App.Rename.IRenameDialogFactory"))).wc();this.$a.register(Ya,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ac(()=>new Ya(x.AFrameworkApplication.ub)).wc();
this.$a.register(285,"Common.App.Rename.IRenamedFileChecker").Ac(()=>this.sgh()).wc();this.$a.register(ca,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ac(()=>new ca(x.AFrameworkApplication.ub,ra.FocusManager.instance())).wc()}sgh(){if(this.nb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Oa=this.$a.yg("Common.IRefreshableAppSettings");if(Oa&&Oa.Atd)return new Pa(()=>Oa.ud("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>x.AFrameworkApplication.sm,()=>
new Date,()=>x.AFrameworkApplication.sz,Oa,this.$a.yg("Common.ISessionStatus"),()=>W.instance,this.$a.Rb("Postmessage.IHostPostmessenger"))}return new ka(()=>this.nb.ud("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.nb.ud("RenamedFileCheckerPingIntervalInMs",12E4),()=>x.AFrameworkApplication.sm,()=>new Date,()=>x.AFrameworkApplication.sz,x.AFrameworkApplication.fa,x.AFrameworkApplication.ub,x.AFrameworkApplication.Fi,this.$a.yg("Common.ISessionStatus"),this.$a.Rb("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.nb.Iu(Object(c.a)(this,
this.IB,"onFullAppSettingsReady"))}IB(){const Oa=x.AFrameworkApplication.ta.Pa.Gs;x.AFrameworkApplication.z8a()&&J.instance.initialize(x.AFrameworkApplication.Sac,Oa?null:x.AFrameworkApplication.Z2a,Oa?null:x.AFrameworkApplication.TNd||CommonUIStrings.l_RenameFileTooltip)&&(this.$a.register(ja,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ac(()=>new ja(()=>x.AFrameworkApplication.userCanRename,()=>x.AFrameworkApplication.isReadOnlyRecommended,x.AFrameworkApplication.bwc,x.AFrameworkApplication.z8a,
new b.a(()=>x.AFrameworkApplication.sz))).wc(),W.instance.Hg(),this.nb.qa("RenameDialogIsEnabled")&&(this.$a.resolve("Common.App.Rename.RenameDialogFactory").initialize(x.AFrameworkApplication.sm,x.AFrameworkApplication.Sac),this.$a.resolve("Common.App.Rename.IRenameDialogActor").Hg()),this.$a.resolve("Common.App.Rename.IRenameFlyoutActor").Hg(),x.AFrameworkApplication.bwc&&this.$a.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.$a.resolve("Common.App.Rename.IRenameFlyoutActor").NKg())}dispose(){}}
Object(t.a)(ba,"PackageManager",null,[4,5]);var Ua=a(249);a.d(E,"a",function(){return Ka});const Ka=()=>{Type.registerNamespace("Common.App.Rename");Ua.a.instance.vi(new ba,7)}},1452:function(t,E,a){a.r(E);t=a(1144);var c=a(9);E=a(0);var b=a(695),e=a(48),f=a(37),d=a(4),h=a(59),m=a(184),l=a(25),w=a(55);class n{constructor(W){this.renameFileManager=W}executeCommand(W,X,Aa){switch(X.command){case l.a.via:return h.a.Ag.Gs?2!==d.AFrameworkApplication.ub.$d(l.a.via,2,Aa)?w.Task.Ra(!0):m.a(X.command):m.a(X.command);
case 1897077126:return this.renameFileManager.renameFile(Aa,X),w.Task.Ra(!0);default:return m.a(X.command)}}yc(W,X,Aa,Q){switch(X.command){case l.a.via:return h.a.Ag.Gs;case 1897077126:return!!Q&&2===Q.oz}return!1}Lc(){return!1}nc(){return!1}dispose(){this.renameFileManager=null}}Object(E.a)(n,"RenameFileCommandHandler",null,[219,3]);class x extends b.a{constructor(W){super(W)}ld(){const W=e.GetServiceTaskFactory.create(this.$.da,119,this.ka,this.Ya);f.TaskExtensions.za(W,()=>{this.Zc([new n(W.result)])},
this.ka,3)}static la(W){b.a.Nd(118,new x(W))}}Object(E.a)(x,"RenameFileCommandHandlerFactory",b.a,[]);var r=a(89),u=a(222),v=a(227),B=a(15),z=a(30),A=a(78),y=a(381),D=a(76),I=a(374),M=a(188),T=a(92),S=a(283),H=a(1),C=a(22),G=a(282);class J{constructor(W){this.$=W}get Bjf(){return this.$.workbookContext.FileCoauthorable}get vBb(){return!1}get Nwb(){return this.$.ea.amIAlone}get BOe(){if(this.Nwb)return!0;for(const W of this.$.ea.Wm)if(!W.SupportsRename)return!1;return!0}}Object(E.a)(J,"EwaCoauthManager",
null,[786]);var L=a(60),P=a(70);class aa extends A.a{constructor(W,X){super();this.Nda=this.SNd=this.JXf=this.Y8c=null;this.Fka=()=>{var Aa=this.$.ea.Lo;if(Aa&&Aa.WorkbookFileName){var Q=z.a.mq(Aa.WorkbookFileName),fa=!!C.a.compare(this.$.workbookContext.WorkbookFileName,Aa.WorkbookFileName,!1),Ca=H.EwaSettings.oa(501)&&!!Aa.BreadcrumbFolderUrl&&!!C.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Aa.BreadcrumbFolderUrl,!1);if(fa||Ca)this.Nda={},this.Nda.NewFileName=Q,this.Nda.EditDocInClientUrl=
Aa.EditDocInClientUrl,this.Nda.DirectInvokeDAVUrl=Aa.DirectInvokeDAVUrl,this.Nda.DownloadACopyUrl=Aa.DownloadACopyUrl,H.EwaSettings.oa(501)&&Aa.BreadcrumbFolderUrl&&(this.Nda.BreadcrumbFolderName=Aa.BreadcrumbFolderName,this.Nda.BreadcrumbFolderUrl=Aa.BreadcrumbFolderUrl),Aa=d.AFrameworkApplication.ub.$d(l.a.fileNameUpdate,2,Q),this.Nda=null,B.ULS.shipAssertTag(537154064,0,32===Aa,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.JQi=(Aa,Q,fa)=>{this.JXf=Q;this.SNd=
fa;this.$.Ka.Lb(new T.a(1897077126,D.a.Db,2,3,null),{["newFileName"]:Aa})};this.IQi=Aa=>{this.Nda&&Aa(this.K7e(this.Nda),this.Cs)};this.cHb=Aa=>{S.a(Aa)||!Aa.Result?(Aa=aa.$Mh(Aa),P.a(this.$).hd.CM([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.SNd(Aa)):this.JXf(this.K7e(Aa.Result),this.Cs)};this.sXi=()=>{this.SNd(5)};this.$=W;this.Cs=X;this.$.ea.pu(this.Fka)}initialize(){d.AFrameworkApplication.rac=this.JQi;d.AFrameworkApplication.nKa=this.IQi;this.Y8c=d.AFrameworkApplication.sz;
d.AFrameworkApplication.sz=new J(this.$)}dispose(){d.AFrameworkApplication.rac=null;d.AFrameworkApplication.nKa=null;this.$.ea.Rv(this.Fka);d.AFrameworkApplication.sz=this.Y8c;this.$=this.Y8c=null;super.dispose()}renameFile(W,X){const Aa=W.newFileName;if(Aa&&(W=z.a.mq(this.$.workbookContext.WorkbookFileName),!H.EwaSettings.isChangeGateEnabled("OfficeVSO:7439298_CompareNewFileNameForRenameOperation")||C.a.compare(W,Aa,!1))){const Q=this.$.pa.xa.Wb();I.a(this.$.userOperationManager,(fa,Ca,ia)=>{var Ra=
this.$.pa.xa;fa=G.b(fa,this.cHb);Ca=G.a(Ca,this.sXi);const Ya=Ra.Oa(9,Q);Ya.newFileName=Aa;return L.g(Ra,"RenameFile",Ya,fa,Ca,ia,null,0)},fa=>new M.a(134,0,fa),X)}}ymi(){return 32===d.AFrameworkApplication.ub.processAction(l.a.via,1)}K7e(W){var X=this.$.workbookContext;d.AFrameworkApplication.LZ=W.DownloadACopyUrl;const Aa=H.EwaSettings.oa(501)&&!!W.BreadcrumbFolderUrl;Aa&&(d.AFrameworkApplication.sm.breadcrumbFolderName=W.BreadcrumbFolderName,d.AFrameworkApplication.sm.breadcrumbFolderUrl=W.BreadcrumbFolderUrl,
X.FullDocumentInfo.BreadcrumbFolderUrl=W.BreadcrumbFolderUrl,X.FullDocumentInfo.BreadcrumbFolderName=W.BreadcrumbFolderName);X.FullDocumentInfo.BreadcrumbDocName=W.NewFileName;y.d(X,W.NewFileName);X={};X.NewName=W.NewFileName;X.DirectInvokeDavUrl=W.DirectInvokeDAVUrl;X.EditDocInClientUrl=W.EditDocInClientUrl;Aa&&(X.BreadcrumbFolderName=W.BreadcrumbFolderName,X.BreadcrumbFolderUrl=W.BreadcrumbFolderUrl);X.OperationResult=0;return X}static $Mh(W){switch(W.Errors[0].MessageId){case -414480287:W=2;break;
case 650565124:W=1;break;case 1636785843:W=6;break;case -782844485:W=4;break;default:W=5}return W}}Object(E.a)(aa,"RenameFileManager",A.a,[745,3]);var U=a(51);class K extends u.a{constructor(W){super();this.zZ=this.renameFileManager=null;this.$=W;this.Fb()}create(){if(!this.zZ){const W=v.a.l2a(U.b(),this.ka,"Task","IRenameFileManager");this.zZ=W.task;const X=e.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Ya),Aa=e.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Aa,
X],this.ka),()=>{const Q=new aa(this.$,X.result);this.$.da.Ga(120,Q);W.setResult(Q)},this.ka,3)}this.zZ.continueWith(W=>{this.ob(W.result)})}dispose(){r.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static la(W){W.da.Ga(119,new K(W))}}Object(E.a)(K,"RenameFileManagerServiceFactory",u.a,[]);class Y{constructor(W){this.Wh=W}nc(){return!1}executeCommand(W,X,Aa){return 2!==this.Wh.$d(l.a.R$f,2,Aa)?w.Task.Ra(!0):m.a(X.command)}yc(W,X){return 1204860550===X.command}Lc(){return!1}}
Object(E.a)(Y,"RenameFileDialogCommandHandler",null,[219]);class na extends b.a{constructor(W){super(W)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),()=>{this.Zc([new Y(d.AFrameworkApplication.ub)])},this.ka,3)}static la(W){b.a.Nd(131,new na(W))}}Object(E.a)(na,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(t.a)();(()=>{c.a.Fa(W=>{K.la(W);x.la(W)})})();c.a.Fa(na.la)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/88e5d9652110caa4cb76c82b5eeedaaf/EwaDSEsNext.rn.js.map