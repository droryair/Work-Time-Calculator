'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1051:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1052:function(t,E,a){a.d(E,"a",function(){return h});t=a(0);var c=a(15),b=a(84);E=a(146);var e=a(4),f=a(45),d=a(30);class h extends E.a{constructor(m,l,w,n,x,r,u=null){super();this.sJ=null;this.La=l;this.cY=n;this.bha=r;this.nb=m;this.ht=x;this.df=w;this.Kjb=this.nb.qa("SaveToHostWithExtraCharsInFileName");this.Lh=u;this.qc(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.df}DNe(m,l){this.JL(1,!!m&&m!==l);this.sJ=document.getElementById(h.wYe);f.a.addHandler(this.sJ,"change",Object(b.a)(this,
this.aqc,"onFileNameChange"));f.a.addHandler(this.sJ,"input",Object(b.a)(this,this.aqc,"onFileNameChange"));this.sJ.focus()}Rac(m){return this.Kjb?(new RegExp("["+this.w$b('\\/:*?"<>|')+"]")).test(m):(new RegExp("["+this.w$b('\\/:*?"<>|#{}%~&')+"]")).test(m)}w$b(m){return m.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Lld(){const m=d.a.mq(e.AFrameworkApplication.sm.sn);this.JL(1,!!this.sJ&&""!==this.sJ.value&&this.sJ.value!==m)}aqc(){this.sJ&&window.setTimeout(()=>{this.Lld()},0)}Qac(m,l){if(1!==
m)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{m=l[h.wYe];l=h.hMf in l?l[h.hMf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",d.a.Euc(m),l);const w=d.a.L4(e.AFrameworkApplication.fileName);(m=m?m.trim():null)&&""!==m&&""!==w||1===this.ta.state?this.Rac(m)?this.ht.create().displayError(1,m,l):this.bha.Foa(m+w,l,this.Lh):this.ht.create().displayError(2,m,l)}}dispose(){this.sJ&&
(f.a.removeHandler(this.sJ,"change",Object(b.a)(this,this.aqc,"onFileNameChange")),f.a.removeHandler(this.sJ,"input",Object(b.a)(this,this.aqc,"onFileNameChange")),this.sJ=null);super.dispose()}}h.wYe="txtFileName";h.hMf="chkOverwrite";Object(t.a)(h,"FileNameDialogBase",E.a,[])},1053:function(t,E,a){a.d(E,"a",function(){return n});t=a(0);var c=a(15),b=a(156),e=a(84),f=a(4),d=a(643),h=a(837),m=a(377),l=a(106),w=a(25);class n{constructor(x,r,u,v){this.mYb=null;this.qDg=x;this.nb=u;this.whe=r;this.bfe=
new b.a;this.Ch=v}V8a(){return this.nb.qa("SaveToCloudStorageUIIsEnabled")}$0e(){return w.a.saveToCloudStorage}L3b(){m.a.RLd(Object(e.a)(this,this.y1f,"saveToCloudActionDispatcher"));m.a.uad([new h.a(w.a.saveToCloudStorage,l.a.frame,0)],this.whe.F5a())}Hg(){const x=this.whe.F5a();x?(x.g$(()=>{this.bfe.setResult(!0)}),this.L3b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}FTf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}y1f(x,
r,u,v,B){return r.contextId!==l.a.frame||x!==this.$0e()?2:this.V8a()?1===u?d.SessionStatusManager.instance.t6a||f.AFrameworkApplication.G5?8:32:2===u?(this.FTf(),B&&B.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ch&&(this.mYb=this.Ch.Cc("DialogShown","SaveToOneDriveReponseTime")),this.bfe.task.continueWith(()=>{this.mYb&&(this.mYb.stop(),this.mYb=null);this.qDg.start(B)}),32):8:8}}Object(t.a)(n,"SaveToCloudStorageActor",null,[712])},
1054:function(t,E,a){a.d(E,"a",function(){return x});t=a(0);var c=a(15),b=a(84),e=a(1055),f=a(4),d=a(41),h=a(39),m=a(241),l=a(376),w=a(164),n=a(769);class x{constructor(r,u,v,B,z){this.d9=this.Mm=this.FDa=null;this.qEa=!1;this.Lh=this.aha=null;this.IVc=r;this.smb=u;this.ht=v;this.df=B;this.Ch=z}xOb(){this.df&&1===this.df.state||(this.Mm=this.smb(),this.Mm.message=CommonUIStrings.l_CommentProgressTooltip,this.Mm.Tb=5,this.Mm.Lt=!1,this.Mm.HBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}EJa(){this.Mm&&
(this.Mm.close(),this.Mm=null)}ES(){1!==f.AFrameworkApplication.ta.state&&this.ht().displayError(e.a.default)}rRa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");h.a.kf(this.d9,h.a.TX(3),void 0,"UploadToCloudManager.RedirectToFolder")}qRa(r){let u=!1,v=!1;f.AFrameworkApplication.fa&&(u=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),v=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
r,u);if(u&&v){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const B={};B[l.a.kRa]="1";B[l.a.documentUrl]=r;f.AFrameworkApplication.AV().execute(z=>{z.Sj(w.a.zua,B)})}else h.a.kf(r,h.a.TX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Foa(r,u,v=null,B=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ch&&(this.aha=this.Ch.Cc("DialogShown","SaveToOneDriveUploadTime"));this.xOb();this.d9=u;this.FDa=this.IVc.create(r,
v,B);this.Lh=B;this.JQ()}JQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.FDa.execute(Object(b.a)(this,this.bYi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.aYi,"onSaveToCloudUploadFailed"))}bYi(r){this.EJa();this.qEa=!1;if(r&&r.data&&r.data.fe){var u;if(({Gt:u}=d.d(r.data.fe)).returnValue)if(r=u,r.StatusCode!==m.a.wP&&r.StatusCode!==m.a.ttb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.ES();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.qRa(r.NewDocumentUrl):this.rRa()}catch(v){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",v.toString())}this.nIb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:n.a.Egb(r.data.fe)}),this.ES()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.ES()}aYi(r){5!==r.data.status&&12!==r.data.status||
this.qEa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.EJa(),this.ES(),this.nIb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.qEa=!0,this.JQ())}nIb(){this.aha&&(this.aha.stop(),this.aha=null)}}Object(t.a)(x,"UploadToCloudManager",null,[618])},1055:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.default=0;Object(t.a)(c,"SaveToCloudErrorCodes",null,[])},1056:function(t,E,a){a.d(E,"a",
function(){return d});t=a(0);var c=a(15),b=a(84),e=a(1055),f=a(82);class d{constructor(h,m,l,w,n,x){this.Lh=null;this.iEg=h;this.E2=m;this.Nnb=l;this.nb=w;this.SSb=n;this.ht=x}start(h){this.Lh=h;if("SharePointOnlineConsumer"===this.nb.Xa("FileSource")){const m=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(m){m.start(null,h);return}}this.E2.lNa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.L0g()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.iEg.create().BQ()}uj(){this.ht().displayError(e.a.default)}L0g(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let h={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.SSb||2===this.SSb)h={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId};WL.init(h);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.N6,"onFailure"))}catch(h){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",h,h.stack),this.uj()}}onSuccess(h){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");h&&h.data&&h.data.folders&&this.Nnb.Foa(h.data.folders[0].id,h.data.folders[0].urls.viewInBrowser,null,this.Lh)}N6(h){if(h&&
h.error){if("user_canceled"===h.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",h.error.code,h.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.uj()}}Object(t.a)(d,"SaveToCloudManager",null,[655])},1057:function(t,E,a){a.d(E,"a",function(){return f});t=a(0);var c=a(15),b=a(39),e=a(80);a=a(708);class f extends a.a{constructor(d,
h){super(d,h);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.Aya;this.Iwa=!0}get linkText(){return f.Vuf}Mma(d){super.Mma(d);b.a.openWindow(4,e.a.PH(f.Uuf))}KD(d){super.KD(d);f.Pyd&&f.Pyd(null)}static initialize(d,h,m,l){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.Aya=d;f.Vuf=h;f.Uuf=m;f.Pyd=l}}f.Aya=null;f.Vuf=null;f.Uuf=null;f.Pyd=null;Object(t.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1058:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.zuh="ewa-bb";c.Auh="ewa-bb-entry";c.Buh="ewa-bb-react";c.fSe="ewa-bb-entry-body";c.lSe="ewa-bb-icon";c.hSe="ewa-bb-entry-icon";c.kSe="ewa-bb-entry-title";c.jSe="ewa-bb-entry-message";c.E$b="ewa-bb-entry-button";c.iSe="ewa-bb-entry-link";c.gSe="ewa-bb-entry-close";c.F$b="ewa-bb-entry-button-holder";c.eSe="ewa-bb-content";Object(t.a)(c,"CssClassNames",null,[])},1059:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);
a=a(708);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.Ipa;this.message=c.Gpa}get actionButton(){return c.Fpa}Ym(b){super.Ym(b);(b=c.Hpa)&&b(null)}static initialize(b,e,f,d){c.Ipa=b;c.Gpa=e;c.Fpa=f;c.Hpa=d}}c.Ipa=null;c.Gpa=null;c.Fpa=null;c.Hpa=null;Object(t.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1060:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);a=a(708);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.Ipa;this.message=
c.Gpa}get actionButton(){return c.Fpa}Ym(b){super.Ym(b);(b=c.Hpa)&&b(null)}static initialize(b,e,f,d){c.Ipa=b;c.Gpa=e;c.Fpa=f;c.Hpa=d}}c.Ipa=null;c.Gpa=null;c.Fpa=null;c.Hpa=null;Object(t.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1061:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);a=a(708);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.Ipa;this.message=c.Gpa}get actionButton(){return c.Fpa}Ym(b){super.Ym(b);(b=c.Hpa)&&b(null)}static initialize(b,
e,f,d){c.Ipa=b;c.Gpa=e;c.Fpa=f;c.Hpa=d}}c.Ipa=null;c.Gpa=null;c.Fpa=null;c.Hpa=null;Object(t.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1062:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);a=a(708);class c extends a.a{constructor(b,e){super(b,e);this.zs=!0;this.title=c.CEb;this.message=c.Aya}get actionButton(){return c.b$a}Ym(b){super.Ym(b);c.Cya&&c.Cya(null)}static initialize(b,e,f,d){c.CEb=b;c.Aya=e;c.b$a=f;c.Cya=d}}c.CEb=null;c.Aya=null;c.b$a=null;c.Cya=null;Object(t.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1063:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);a=a(708);class c extends a.a{constructor(b,e){super(b,e);c.b$a&&c.Cya&&(this.zs=!0);this.title=c.CEb;this.message=c.Aya}get actionButton(){return c.b$a}Ym(b){super.Ym(b);c.Cya&&c.Cya(null)}static initialize(b,e,f,d){c.CEb=b;c.Aya=e;c.b$a=f;c.Cya=d}}c.CEb=null;c.Aya=null;c.b$a=null;c.Cya=null;Object(t.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1065:function(t,
E,a){a.d(E,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.Lhb=function(){function b(){return l()&&(z()||3<=(u()?A("version/"):0))}function e(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(){ya||(ya=!0,Ea=h("Windows Phone"))}function h(sa){sa=(new RegExp(sa+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var qb=-1;return null!=sa&&2<=sa.length&&(qb=parseFloat(sa[1]),
isNaN(qb)&&(qb=-1)),qb}function m(){return"function"==typeof navigator.msLaunchUri&&!f()&&!B()&&!w()}function l(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function w(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function n(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function x(){return n()?8==window.document.documentMode:!1}function r(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function u(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function v(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function B(){var sa=window.navigator.userAgent.toLowerCase();return 0<=sa.indexOf("android")&&0<=sa.indexOf("chrome")}function z(){return 3<=(r()?A("firefox/"):0)}function A(sa){var qb=window.navigator.userAgent.toLowerCase(),Jb=qb.indexOf(sa),Yb,jb;return 0<=Jb?(Yb=Jb+sa.length,jb=qb.length,parseInt(qb.substring(Yb,jb))):0}function y(sa,qb,Jb,Yb,jb){if(Yb&&null!=qb)qb();
else if(m())navigator.msLaunchUri(sa,qb,Jb);else if(!(v()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&l())||w())I(sa,qb,Jb);else if(v()&&jb)a:{try{window.open(sa,"_self")}catch(ab){null!=Jb&&Jb();break a}null!=qb&&qb()}else D(sa,qb,Jb)}function D(sa,qb,Jb){var Yb=document.getElementById("OICLinkTag"),jb;null==Yb&&(Yb=document.createElement("a"),Yb.id="OICLinkTag",Yb.style.visibility="hidden",Yb.href="",Yb.target=0==(xb.Options&
kb.SupportsTopTargetNavigation)||xb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Yb),null!=Yb.addEventListener&&Yb.addEventListener("click",function(ab){null!=ab.stopPropagation&&ab.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(jb=function(ab){var vb=document.createEvent("MouseEvent");return vb.initMouseEvent(ab,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),vb},jb.prototype=Event.prototype,window.MouseEvent=jb),Yb.href=sa,Yb.dispatchEvent(new MouseEvent("click"))}catch(ab){null!=
Jb&&Jb();return}null!=qb&&qb()}function I(sa,qb,Jb){var Yb=document.getElementById("OICFrame");null==Yb&&(Yb=document.createElement("iframe"),Yb.className="ObjectInDialog",Yb.style.visibility="hidden",Yb.src="about:blank",document.body.appendChild(Yb),Yb.id="OICFrame");try{Yb.contentWindow.location.href=sa}catch(jb){null!=Jb&&Jb();return}null!=qb&&qb()}function M(sa){return 0!=(sa.Options&kb.SkipProtocolHandler)||x()}function T(sa){return sa===Na.ReadOnly||sa===Na.ReadWrite}function S(sa,qb,Jb,Yb){var jb,
ab;try{if(jb=new ActiveXObject(Ya),jb)return ab=jb.ViewDocument3(window.self,sa,qb,Yb),ab?(Q(oa.O14ActiveX),lb.None):lb.Failed}catch(vb){}if(kb.O14Only===(Jb&kb.O14Only))return xb.DescriptiveUnattemptedEnums?lb.O14AttemptFailure:lb.Unattempted;try{if(jb=new ActiveXObject(Ga),jb)return ab=jb.ViewDocument3(window.self,sa,qb,Yb),ab?(Q(oa.O12ActiveX),lb.None):lb.Failed}catch(vb){}if(kb.O12UpOnly===(Jb&kb.O12UpOnly))return xb.DescriptiveUnattemptedEnums?lb.O12UpOnlyFail:lb.Unattempted;try{if(jb=new ActiveXObject(da),
jb)return ab=T(qb)?jb.ViewDocument2(window.self,sa,Yb):jb.EditDocument2(window.self,sa,Yb),ab?(Q(oa.O11ActiveX),lb.None):lb.Failed}catch(vb){}return xb.DescriptiveUnattemptedEnums?lb.ActiveXUnattempted:lb.Unattempted}function H(sa,qb,Jb,Yb,jb){var ab,vb,Da;sa==Ba.Visio&&Jb==Na.ReadWrite&&(Jb=Na.WriteOnly);sa=jb;(Yb=Yb||f()&&!(d(),8<=Ea))||(ab="",ab+=T(Jb)?ka+ra:ba,ab+=Ua,sa+=G(ab));sa+=G(qb);xb.NewTelemetryDataIsEnabled&&(vb=xb.SessionOrigin?"|or|"+xb.SessionOrigin:"",vb+=xb.ClickTime?"|ct|"+xb.ClickTime:
"",vb+=xb.CorrelationId?"|cid|"+xb.CorrelationId:"",sa+=G(vb),xb.CorrelationIdForWinClient&&(sa+=G(xb.CorrelationIdForWinClient)));qb=window.location.href;Jb=Oa;Yb=qb.toLowerCase().indexOf("&"+Jb+"=");var Fa;Jb=-1==Yb?void 0:(Da=Yb+(Jb.length+2),Fa=qb.indexOf("&",Da),-1==Fa)?qb.substr(Da):qb.substring(Da,Fa);if(null!=Jb&&"undefined"!=typeof Jb){Da="";try{Da=decodeURIComponent(Jb)}catch(nb){}0<Da.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Da)&&(sa+=Ka,sa+=Da)}return sa}
function C(sa,qb,Jb,Yb,jb,ab){var vb=W(sa),Da;return null==vb?(fa(xb.DescriptiveUnattemptedEnums?lb.ProtocolHandlerIsNull:lb.Unattempted,xb.Application),!1):(Da=H(sa,qb,Jb,Yb,vb),y(Da,J,L,jb,ab),!0)}function G(sa){if(l()&&v()){var qb="";try{qb=decodeURI(sa)}catch(Jb){}if(qb==sa)return encodeURI(sa)}return sa}function J(){Q(oa.ProtocolHandler)}function L(){xb.Options|=kb.SkipProtocolHandler;Aa(xb,Ab,Mb)}function P(){null!=pb&&pb(oa.RoamingProtocolHandler)}function aa(){null!=Qb&&Qb(lb.ControlNeeded)}
function U(){var sa=document.getElementById(ua),qb;if(null==sa){if(qb=Z,l()&&3<=(u()?A("version/"):0)&&K(ha,!0)&&(qb=ha),!K(qb,!0))if(l()&&K(ja,!0))qb=ja;else return null;sa=document.createElement("object");sa.id=ua;sa.type=qb;sa.style.width="0px";sa.style.height="0px";sa.style.setProperty("visibility","hidden","");document.body.appendChild(sa);sa=document.getElementById(ua)}return sa}function K(sa,qb){var Jb=window.navigator.mimeTypes,Yb;return null==Jb?!1:(Yb=Jb[sa],Yb)?qb&&!Yb.enabledPlugin?!1:
!0:!1}function Y(sa){try{if(null!=new ActiveXObject(sa))return!0}catch(qb){}return!1}function na(sa){switch(sa){case Ba.OneNote:return Pa;default:return""}}function W(sa){if(sa!=Ba.OneNote&&f()&&!(d(),8<=Ea))return"office:";switch(sa){case Ba.Excel:return"ms-excel:";case Ba.OneNote:return"onenote:";case Ba.PowerPoint:return"ms-powerpoint:";case Ba.Visio:return"ms-visio:";case Ba.Word:return"ms-word:";case Ba.Project:return"ms-project:";case Ba.Publisher:return"ms-publisher:";case Ba.Infopath:return"ms-infopath:";
case Ba.Access:return"ms-access:";default:return""}}function X(sa){switch(sa){case Ba.Excel:return"root\\office15\\excel.exe";case Ba.PowerPoint:return"root\\office15\\powerpnt.exe";case Ba.Visio:return"root\\office15\\visio.exe";case Ba.Word:return"root\\office15\\winword.exe";case Ba.Project:return"root\\office15\\winproj.exe";case Ba.Publisher:return"root\\office15\\mspub.exe";case Ba.Infopath:return"root\\office15\\infopath.exe";case Ba.Access:return"root\\office15\\msaccess.exe";default:return null}}
function Aa(sa,qb,Jb){if(xb=sa,Ab=qb,Mb=Jb,sa.DocumentUrl){var Yb=Jb=qb=sa.DocumentUrl;try{Yb=decodeURIComponent(sa.DocumentUrl)}catch(nb){}try{Jb=encodeURI(sa.DocumentUrl)}catch(nb){}xb.NewTelemetryDataIsEnabled||(qb=qb+""+sa.CorrelationIdForWinClient,Yb+=sa.CorrelationIdForWinClient,Jb+=sa.CorrelationIdForWinClient);sa.Mode===Na.ReadWrite&&kb.CheckoutRequired===(sa.Options&kb.CheckoutRequired)&&(sa.Mode=Na.ForceCheckout);kb.HostIsEditOnly===(sa.Options&kb.HostIsEditOnly)&&(sa.Mode=Na.WriteOnly);
if(M(sa)?0:l()&&(sa.Application==Ba.OneNote||K(Wa,!1)||K(ca,!1))||m()||B()||!(b()||z()||"ActiveXObject"in window&&!f()||v())||15<=Ca())C(sa.Application,sa.EncodeUrl?Jb:qb,sa.Mode,sa.Application==Ba.OneNote,sa.SilentExternalHandler,sa.NavigateUsingWindowOpen);else{var jb;if(jb=x())a:{var ab=sa.EncodeUrl?qb:Yb,vb=sa.Mode,Da=na(sa.Application);try{jb=(new ActiveXObject(Ra)).ViewDocument3(window.self,ab,vb,Da);break a}catch(nb){}jb=!1}if(jb)Q(oa.O15ActiveX);else{if(b()||z()){var Fa=sa.EncodeUrl?qb:Yb;
Yb=sa.Mode;jb=na(sa.Application);ab=U();if(null==ab)Fa=xb.DescriptiveUnattemptedEnums?lb.PluginIsNull:lb.Unattempted;else{vb=!1;try{vb=ab.ViewDocument3(window.self,Fa,Yb,jb)}catch(nb){}if(!vb)try{vb=T(Yb)?ab.ViewDocument2(window.self,Fa,jb):ab.EditDocument2(window.self,Fa,jb)}catch(nb){}Fa=vb?(Q(oa.NpapiPlugin),lb.None):lb.Failed}}else{try{Fa=new ActiveXObject(Za),null!=Fa&&Fa.SaveSSOCreds()}catch(nb){}Fa=S(sa.EncodeUrl?qb:Yb,sa.Mode,sa.Options,na(sa.Application))}if(Fa!=lb.None){if(Yb=sa.CouldUseRoamingApps)pa||
(pa=!0,Ma=h("Windows NT")),Yb=6.1<=Ma&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(n()||z()||v());if(Yb&&sa.Application!=Ba.OneNote){if(!c.Lhb.e6j()){fa(lb.ControlNeeded,xb.Application);return}if(sa.RoamingAppsLauncher){"undefined"==typeof sa.RoamingAppsLauncher||null==sa.RoamingAppsLauncher?fa(xb.DescriptiveUnattemptedEnums?lb.RoamingLauncherIsNull:lb.Unattempted,xb.Application):"undefined"==typeof sa.RoamingBitsUrl||null==sa.RoamingBitsUrl?c.Lhb.p6j(sa.DocumentUrl,sa.RoamingAppsLauncher,
sa.Application,sa.ApplicationParameters,Ab,Mb):c.Lhb.nqg(sa.DocumentUrl,sa.RoamingAppsLauncher,sa.RoamingApplicationExe,sa.ApplicationParameters,sa.RoamingPlatform,sa.RoamingBitsUrl,Ab,Mb);return}if(!sa.ContinueIfLauncherIsNull){fa(lb.LauncherNeeded,xb.Application);return}}kb.NoProtocolHandlerFallback==(sa.Options&kb.NoProtocolHandlerFallback)||M(sa)||n()||l()&&!(xb.DescriptiveUnattemptedEnums?Fa>=lb.O14Unattempted&&Fa<=lb.DocumentUrlIsNull:Fa==lb.Unattempted)?fa(Fa,xb.Application):C(sa.Application,
sa.EncodeUrl?Jb:qb,sa.Mode,sa.Application==Ba.OneNote,sa.SilentExternalHandler,sa.NavigateUsingWindowOpen)}}}}else fa(xb.DescriptiveUnattemptedEnums?lb.DocumentUrlIsNull:lb.Unattempted,xb.Application)}function Q(sa){null!=Ab&&Ab(sa)}function fa(sa,qb){"undefined"==typeof qb&&(qb=null);null!=Mb&&Mb(sa,qb)}function Ca(){var sa=0;if(b()||z()||v()){var qb=U();try{null!=qb&&(sa=qb.GetOfficeVersion())}catch(Jb){}}else Y(Ra)?sa=15:Y(Ya)?sa=14:Y(Ga)?sa=12:Y(da)&&(sa=11);return sa}function ia(){return l()&&
(K(Z,!0)||K(ha,!0))}var Ra="SharePoint.OpenDocuments.5",Ya="SharePoint.OpenDocuments.4",Ga="SharePoint.OpenDocuments.3",da="SharePoint.OpenDocuments.2",Z="application/x-sharepoint",ha="application/x-sharepoint-webkit",Wa="application/x-sharepoint-protocolhandler",ca="application/x-sharepoint-webkit-protocolhandler",ja="application/officelive",ua="npSharePointPlugin",Za="IDBHO.IDBHOCtrl",Pa="OneNote.Notebook",ka="ofv|",ra="ofc|",ba="ofe|",Ua="u|",Ka="|f|",Oa="wdlor",ib="",La="",db="",Ab,Mb,pb,Qb,xb,
pa,Ma,ya,Ea,Na={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},kb={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},lb={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
oa={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Ba={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Na,OpenDocumentOptions:kb,OpenDocumentFailureType:lb,OpenDocumentControl:oa,OfficeApplication:Ba,EditDocumentInClient:Aa,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=Ba.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Ca,
IsO14MacPluginInstalled:ia,OfferOfficeInDialog:function(){return e()&&11>=Ca()},OfferOfficeNoIntrusive:function(){return e()&&15>Ca()},OfferMacOffice:function(){return l()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ia()},InstallRoamingControl:function(){r()?window.InstallTrigger.install({Office:{URL:La}}):I(db,null,null)},CanUseRoamingControl:function(){var sa,qb,Jb;if(m())return!0;if(v())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(r())return sa=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(sa),qb=document.createEvent("Events"),qb.initEvent("RoamingOfficeInstalled",!0,!1),sa.dispatchEvent(qb),!!sa.getAttribute("installed");if(n())try{return Jb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Jb.HrExists()}catch(Yb){}return!1},InitUrls:function(sa,qb,Jb){ib=sa;La=Jb;db=qb},LaunchRoamingApps:function(sa,qb,Jb,Yb,jb,ab){c.Lhb.nqg(sa,qb,X(Jb),Yb,"x86",ib,jb,ab)},LaunchRoamingApps2:function(sa,
qb,Jb,Yb,jb,ab,vb,Da){var Fa="",nb;if(null!=Yb&&(Fa+=" "+Yb),null!=sa&&(Fa+=' "'+sa+'"'),m()||v())pb=vb,Qb=Da,vb='office: "'+(ab+'" "')+(Jb+'" "ROAMING"'),vb+=' "'+qb+'"',vb+=' "'+jb+'"',vb+=" "+Fa,y(vb,P,aa,!1,!1);else if(r())sa=document.createElement("RoamingExtensionElement"),sa.setAttribute("cabUrl",ab),sa.setAttribute("app",Jb),sa.setAttribute("licensingEntitlements",qb),sa.setAttribute("platform",jb),sa.setAttribute("args",Fa),document.documentElement.appendChild(sa),qb=document.createEvent("Events"),
qb.initEvent("RoamingOfficeLaunch",!0,!1),sa.dispatchEvent(qb),null!=vb&&vb(oa.RoamingFFExtension);else if(n()){if(nb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=nb)try{nb.HrConfigureSingle(ab,Jb,qb,jb,Fa),null!=vb&&vb(oa.RoamingActiveX)}catch(Ta){}}else null!=Da&&Da(lb.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:D,OpenDocumentWithProtocolHandler:C,OpenDocumentWithProtocolHandlerNoCallBack:function(sa,qb,Jb,Yb){var jb=W(sa),ab;return null==jb?
(fa(xb.DescriptiveUnattemptedEnums?lb.ProtocolHandlerNoCallbackIsNull:lb.Unattempted,xb.Application),!1):(ab=H(sa,qb,Jb,Yb,jb),y(ab,null,null,!1,!1),!0)}}}();c.ClientUtils=c.Lhb},1066:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);var c=a(39);class b{constructor(e,f){this._url=e;this.oBg=f}Bxe(){}Z9c(){this.oBg?c.a.downloadFile(this._url):c.a.kf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(t.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,[177,
3])},1067:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1068:function(t,E,a){a.d(E,"a",function(){return d});t=a(0);var c=a(1196),b=a(4),e=a(54),f=a(82);class d{constructor(h,m,l,w,n,x){this.yY=h;this.zY=m;this.WMc=l;this.rE=w;this.iUb=n;this.mWa=x}get m$f(){return!this.zY&&!this.WMc}get Czf(){return 2===this.mWa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get GRe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get oef(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Nwa(){return CommonUIStrings.l_OICErrorHelpLink}get Pcf(){return"OICFailure"}get icon(){return 3}get t_b(){return 2===
this.mWa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Ql(){return CommonUIStrings.l_DefaultDialogTitle}xbj(h){this.Zzf(h)}Tyi(h){this.Zzf(h)}Zzf(h){let m=10;1===h?(f.a.instance.resolve("Common.IOfficeTrialExperience").imc(this.mWa),m=3):2===h&&((!this.WMc||this.WMc(this.rE))&&this.zY&&c.a.instance.hfh(this.zY,this.yY,this.rE),m=5);(0===h||1===h)&&this.yY&&this.yY(this.rE);b.AFrameworkApplication.rwc(e.a.HLf,this.iUb,m);this.dispose()}dispose(){this.rE=
this.zY=this.yY=null}}Object(t.a)(d,"AOICErrorDialogWithTrial",null,[3])},1069:function(t,E,a){a.d(E,"a",function(){return d});t=a(0);var c=a(1360),b=a(4),e=a(41),f=a(80);class d{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}VRd(){return e.c([this.dba(),this])}execute(h,m,l){let w="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=f.a.Cl(w,"wdEnableRoaming","1"));b.AFrameworkApplication.zd.Om(w,2,this.VRd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.Yxb(),h,m,l,void 0,void 0,void 0,void 0,"6")}}Object(t.a)(d,"ARoamingAppsRequest",null,[])},1070:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1071:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1072:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1078:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);var c=a(15);class b{constructor(e){this.isEnabled=Boolean.parse(e.DirectPrintIsEnabled||"false");Boolean.parse(e.DirectPrintProbeIsEnabled||"false");this.Hpi=Boolean.parse(e.DirectPrintEnabledForInternetExplorer||"false");this.yUa=(e.DirectPrintSupportedMimeTypes||
"").split(b.D9c);this.zUa=(e.DirectPrintSupportedPlugins||"").split(b.D9c);this.Qdi=(e.DirectPrintImmersivePreviewPlugins||"").split(b.D9c);this.hjf=Boolean.parse(e.DirectPrintEnabledForEdge||"false");this.gmi=Boolean.parse(e.ChromePrintLayoutFixIsEnabled||"false");this.p4g=parseInt(e.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.vAd=14;this.Wwf=14394;if(e=e.DirectPrintMinimalSupportedEdgeVersion){const f=e.split(".");2===f.length?(this.vAd=parseInt(f[0]),this.Wwf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",e)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.D9c=",";Object(t.a)(b,"DirectPrintBrsSettings",null,[])},1079:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(t.a)(c,"PrintPreviewPaneProps",null,[])},1143:function(t,E,a){var c=a(9),b=a(0),e=a(15),f=a(4),d=a(1343),h=a(695),m=a(48),l=a(37),w=a(1),n=a(904),x=a(66),r=a(40),u=a(184),v=a(21),B=a(375),z=a(573);class A{constructor(bb,Ob){this.eJd=0;this.Hbe=!1;this.tA=bb;this.ignorePrintArea=Ob}get tA(){return this.eJd}set tA(bb){0<=bb&&2>=bb?this.eJd=bb:(e.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.eJd=1)}get ignorePrintArea(){return this.Hbe}set ignorePrintArea(bb){bb||!bb?this.Hbe=bb:e.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(A,"PdfPrintDialogBrowserSessionState",null,[]);var y=a(7),D=a(133),I=a(171),M=a(98),T=a(1398);class S{constructor(bb,Ob){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=bb;this.addToPrintArea=Ob}}Object(b.a)(S,"MacroRecorderPrintAreaSetPayload",null,[145]);var H=a(374),C=a(188),G=a(11),J=a(13),L=a(282),P=
a(64);class aa{constructor(bb){this.sharedSheetCell=null;this.sharedSheetCell=bb}}Object(b.a)(aa,"MacroRecorderPageBreakInsertedPayload",null,[145]);class U{constructor(bb){this.sharedSheetCell=null;this.sharedSheetCell=bb}}Object(b.a)(U,"MacroRecorderPageBreakRemovedPayload",null,[145]);class K{constructor(bb){this.sheetName=null;this.sheetName=bb}getSheetName(){return this.sheetName}}Object(b.a)(K,"MacroRecorderPageBreaksAllResetPayload",null,[145]);class Y{constructor(bb){this.sheetName=null;this.sheetName=
bb}getSheetName(){return this.sheetName}}Object(b.a)(Y,"MacroRecorderPrintAreaClearedPayload",null,[145]);var na=a(60);const W=(bb,Ob,gc,mb,Nb,ic,gb,Eb=null)=>{Eb=bb.Oa(9,Eb);Eb.sheetName=Ob;Eb.printSettings=gc;return na.g(bb,"SetSheetPrintSettings",Eb,mb,Nb,ic,gb,0)},X=(bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=bb.Oa(1,gb);gb.ConvertInParameters=Ob;return na.g(bb,"ConvertWorkbookToPrintPdf",gb,gc,mb,Nb,ic,4)},Aa=(bb,Ob,gc,mb,Nb,ic,gb,Eb=null)=>{Eb=bb.Oa(1,Eb);Eb.sheetName=Ob;Eb.printOptions=gc;return na.g(bb,
"SetPrintOptions",Eb,mb,Nb,ic,gb,0)},Q=(bb,Ob,gc,mb,Nb,ic,gb,Eb=null)=>{Eb=bb.Oa(1,Eb);Eb.sheetName=Ob;Eb.locale=gc;return na.g(bb,"GetPrintSettings",Eb,mb,Nb,ic,gb,4)},fa=(bb,Ob,gc,mb,Nb,ic,gb,Eb=null)=>{Eb=bb.Oa(1,Eb);Eb.selectedRanges=Ob;Eb.addToPrintArea=gc;return na.g(bb,"SetPrintArea",Eb,mb,Nb,ic,gb,0)},Ca=(bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=bb.Oa(1,gb);gb.sheetName=Ob;return na.g(bb,"ClearPrintArea",gb,gc,mb,Nb,ic,0)},ia=(bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=bb.Oa(9,gb);gb.sheetCell=Ob;return na.g(bb,
"InsertPageBreak",gb,gc,mb,Nb,ic,0)},Ra=(bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=bb.Oa(9,gb);gb.sheetCell=Ob;return na.g(bb,"RemovePageBreak",gb,gc,mb,Nb,ic,0)},Ya=(bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=bb.Oa(9,gb);gb.sheetName=Ob;return na.g(bb,"ResetAllPageBreaks",gb,gc,mb,Nb,ic,0)};var Ga=a(124),da=a(112),Z=a(51),ha=a(189);class Wa{constructor(){this.Col=this.Row=null}}Object(b.a)(Wa,"PageBreaksInformation",null,[]);class ca{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(ca,"RowColBreak",null,[]);
class ja{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(ja,"SharedRange",null,[]);var ua=a(177),Za=a(55);class Pa{constructor(bb){this.ribbonCommandInfo=this.FHb=null;this.ITj=(Ob,gc,mb)=>{gc=!!Ob&&!!Ob.RequestTelemetryData;v.h(this.$).Eh&&v.h(this.$).Eh.gma(this.ZLa.ma(this.ribbonCommandInfo.command),Ob.StateId,gc?Ob.RequestTelemetryData.EcsOperationDuration:0,gc?Ob.RequestTelemetryData.EcsRequestDuration:0,gc?Ob.RequestTelemetryData.WfeRequestDuration:0);
G.HelperMethods.I_&&this.r3g(mb)};this.$=bb;this.ZLa=new ua.a;this.xwa=new ua.a;this.xwa.add(78661008,12);this.xwa.add(275604654,13);this.xwa.add(-13332329,14);this.xwa.add(-837651977,9);this.xwa.add(-1778266776,10);this.xwa.add(845325699,11)}executeCommand(bb,Ob,gc,mb,Nb=null,ic=null,gb=null){this.ribbonCommandInfo=Ob;this.PLj(Ob.command);bb=L.b(Nb,this.ITj);e.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Ob.command} command execution started`);switch(Ob.command){case 78661008:return this.jbf(Ob,
bb,ic,gb,!1);case 275604654:return this.jbf(Ob,bb,ic,gb,!0);case -13332329:return this.haf(Ob,bb,ic,gb);case -837651977:return this.l9h(Ob,bb,ic,gb);case -1778266776:return this.i$h(Ob,bb,ic,gb);case 845325699:return this.ebf(Ob,bb,ic,gb)}return u.a(Ob.command)}yc(bb,Ob){switch(Ob.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===bb;case 845325699:case -13332329:return!0}return!1}y6f(bb,Ob,gc){const mb=v.h(this.$);var Nb=mb.Da;const ic=r.r(mb.ha.ra.selectedRanges,this.$);
if((Nb=Nb.rD())&&Nb.length){for(const gb of Nb){Nb=gb;const Eb=Nb.rf;if(!Eb)continue;const Lc=r.j(Nb.nf),Ec=[];for(const Cb of ic.Ranges){if(Cb.FirstRow>Lc.LastRow+1||Cb.LastRow<Lc.FirstRow||Cb.FirstColumn>Lc.LastColumn+1||Cb.LastColumn<Lc.FirstColumn)continue;const eb=this.i0h(Lc,Cb,Eb),Sb=this.h0h(Lc,Cb,Eb);Ec.push(Object(y.a)(new ja,{FirstRow:eb.FirstRow,FirstColumn:Sb.FirstColumn,LastRow:eb.LastRow,LastColumn:Sb.LastColumn}))}0<Ec.length&&!gc?Eb.setPrintArea(Ec):0<Ec.length&&gc?Eb.addToPrintArea(Ec):
!gc&&Eb.hasPrintArea()&&Eb.clearPrintArea();!Eb.isDirty()&&Eb.hasPageLayout()&&Eb.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Nb.Bd,4)}this.vQb(mb,bb,Ob)}}j5g(bb,Ob){const gc=v.h(this.$);var mb=v.h(this.$).Da.rD();if(mb&&mb.length){for(const Nb of mb){mb=Nb;const ic=mb.rf;ic&&(ic.clearPrintArea(),!ic.isDirty()&&ic.hasPageLayout()&&ic.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+mb.Bd,4))}this.vQb(gc,bb,Ob)}}yii(bb,Ob){const gc=v.h(this.$);var mb=gc.Da;
const Nb=r.o(gc.ha.ra.activeCell,this.$);if(Nb){var ic=mb.rD();if(ic&&ic.length){mb=null;for(var gb of ic){let Eb=gb,Lc=Eb.rf;if(!Lc)continue;let Ec=r.j(Eb.nf);if(!(Nb.FirstRow>Ec.LastRow||Nb.FirstRow<Ec.FirstRow||Nb.FirstColumn>Ec.LastColumn||Nb.FirstColumn<Ec.FirstColumn)&&(mb=this.ufh(Lc,Ec,Nb),Lc.insertPageBreak(mb),!Lc.isDirty()&&Lc.hasPageLayout()&&Lc.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+Eb.Bd,4),mb))break}if(!mb)for(const Eb of ic)if(mb=Eb,gb=mb.rf)mb=r.j(mb.nf),
mb=this.RJe(gb,mb,Nb),gb.insertPageBreak(mb);this.vQb(gc,bb,Ob)}}}jhj(bb,Ob){const gc=v.h(this.$);var mb=gc.Da;const Nb=r.o(gc.ha.ra.activeCell,this.$);if(Nb&&(mb=mb.rD())&&mb.length){for(const gb of mb){mb=gb;const Eb=mb.rf;if(Eb){var ic=r.j(mb.nf);(ic=this.RJe(Eb,ic,Nb))&&Eb.removePageBreak(ic);!Eb.isDirty()&&Eb.hasPageLayout()&&Eb.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+mb.Bd,4)}}this.vQb(gc,bb,Ob)}}enj(bb,Ob){const gc=v.h(this.$);var mb=gc.Da.rD();if(mb&&mb.length){for(const Nb of mb){mb=
Nb;const ic=mb.rf;ic&&(ic.resetAllPageBreak(),!ic.isDirty()&&ic.hasPageLayout()&&ic.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+mb.Bd,4))}this.vQb(gc,bb,Ob)}}jbf(bb,Ob,gc,mb,Nb){if(!Nb){var ic=this.$.Cb.getItemByName("PRINT_AREA");if(ic&&(e.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${ic.type}`),2===ic.type))return this.dki(),Za.Task.Ra(!0)}ic=v.h(this.$).ha.ra;const gb=r.r(ic.selectedRanges,
this.$);if(1===gb.Ranges.length&&!Nb){if(ic.hca())return this.z$h(bb,gb,Ob,gc,mb,Nb),Za.Task.Ra(!0);if(r.R(gb.Ranges[0]))return this.$.va.na.hasPrintArea?this.haf(bb,Ob,gc,mb):Za.Task.Ra(!0)}this.y6f(bb.command,mb,Nb);return this.qhf(bb,Ob,gc,gb,Nb)}haf(bb,Ob,gc,mb){this.j5g(bb.command,mb);return this.Qji(bb,Ob,gc)}l9h(bb,Ob,gc,mb){this.yii(bb.command,mb);return this.aki(bb,Ob,gc)}i$h(bb,Ob,gc,mb){const Nb=r.r(v.h(this.$).ha.ra.selectedRanges,this.$);if(r.R(Nb.Ranges[0]))return this.ebf(bb,Ob,gc,
mb);this.jhj(bb.command,mb);return this.eki(bb,Ob,gc)}ebf(bb,Ob,gc,mb){this.enj(bb.command,mb);return this.hki(bb,Ob,gc)}qhf(bb,Ob,gc,mb,Nb){const ic=this.$.pa.xa,gb=()=>new S(mb,Nb);return H.a(this.$.userOperationManager,(Eb,Lc,Ec)=>fa(ic,mb,Nb,L.b(Eb,Ob),L.a(Lc,gc),Ec,null),Eb=>new C.a(241,0,Eb,64,gb),bb)}Qji(bb,Ob,gc){const mb=this.$.va.na.name,Nb=this.$.pa.xa,ic=()=>new Y(mb);return H.a(this.$.userOperationManager,(gb,Eb,Lc)=>Ca(Nb,mb,L.b(gb,Ob),L.a(Eb,gc),Lc,null),gb=>new C.a(243,0,gb,64,ic),
bb)}aki(bb,Ob,gc){const mb=v.h(this.$),Nb=r.o(mb.ha.ra.activeCell,this.$),ic=()=>new aa(Nb);return H.a(this.$.userOperationManager,(gb,Eb,Lc)=>ia(this.$.pa.xa,Nb,L.b(gb,Ob),L.a(Eb,gc),Lc,null),gb=>new C.a(244,0,gb,64,ic),bb)}eki(bb,Ob,gc){const mb=v.h(this.$),Nb=r.o(mb.ha.ra.activeCell,this.$),ic=()=>new U(Nb);return H.a(this.$.userOperationManager,(gb,Eb,Lc)=>Ra(this.$.pa.xa,Nb,L.b(gb,Ob),L.a(Eb,gc),Lc,null),gb=>new C.a(245,0,gb,64,ic),bb)}hki(bb,Ob,gc){const mb=this.$.va.na.name,Nb=()=>new K(mb);
return H.a(this.$.userOperationManager,(ic,gb,Eb)=>Ya(this.$.pa.xa,mb,L.b(ic,Ob),L.a(gb,gc),Eb,null),ic=>new C.a(246,0,ic,64,Nb),bb)}i0h(bb,Ob,gc){if(!bb||!Ob||!gc)return null;const mb=new ja;mb.FirstRow=Ob.FirstRow===bb.LastRow+1?gc.getRowIndex(bb.LastRow+1)+1:Ob.FirstRow<bb.FirstRow?0:gc.getRowIndex(Ob.FirstRow+1);mb.LastRow=Ob.FirstRow===bb.LastRow+1||Ob.LastRow>bb.LastRow?gc.getRowIndex(bb.LastRow+1)+1:gc.getRowIndex(Ob.LastRow+1);return mb}h0h(bb,Ob,gc){if(!bb||!Ob||!gc)return null;const mb=
new ja;mb.FirstColumn=Ob.FirstColumn===bb.LastColumn+1?gc.getColumnIndex(bb.LastColumn+1)+1:Ob.FirstColumn<bb.FirstColumn?0:gc.getColumnIndex(Ob.FirstColumn+1);mb.LastColumn=Ob.FirstColumn===bb.LastColumn+1||Ob.LastColumn>bb.LastColumn?gc.getColumnIndex(bb.LastColumn+1)+1:gc.getColumnIndex(Ob.LastColumn+1);return mb}ufh(bb,Ob,gc){if(!Ob||!gc||!bb)return null;const mb=bb.getPrintArea();if(!mb||!mb.length)return null;const Nb=bb.getRowIndex(gc.FirstRow+1),ic=bb.getColumnIndex(gc.FirstColumn+1);let gb=
null,Eb=null;for(const Lc of mb)if(Nb>=Lc.FirstRow&&Nb<=Lc.LastRow&&ic>=Lc.FirstColumn&&ic<=Lc.LastColumn){if(gc.FirstRow===Lc.FirstRow&&gc.FirstColumn===Lc.FirstColumn)return new Wa;Nb>Lc.FirstRow&&(gb=Object(y.a)(new ca,{Index:Nb-1,Min:Lc.FirstColumn-1,Max:Math.min(Lc.LastColumn,bb.getColumnIndex(Ob.LastColumn+1))}));ic>Lc.FirstColumn&&(Eb=Object(y.a)(new ca,{Index:ic-1,Min:Lc.FirstRow-1,Max:Math.min(Lc.LastRow,bb.getRowIndex(Ob.LastRow+1))}));break}return gb||Eb?Object(y.a)(new Wa,{Row:gb?[gb]:
null,Col:Eb?[Eb]:null}):null}Lgh(bb,Ob,gc){if(!Ob||!gc||!bb)return null;let mb=null;gc.FirstRow>Ob.FirstRow&&gc.FirstRow<=Ob.LastRow?mb=Object(y.a)(new ca,{Index:bb.getRowIndex(gc.FirstRow+1)-1,Min:-1,Max:-1}):gc.FirstRow===Ob.LastRow+1&&(mb=Object(y.a)(new ca,{Index:bb.getRowIndex(Ob.LastRow+1),Min:-1,Max:-1}));return mb}dch(bb,Ob,gc){if(!Ob||!gc||!bb)return null;let mb=null;gc.FirstColumn>Ob.FirstColumn&&gc.FirstColumn<=Ob.LastColumn?mb=Object(y.a)(new ca,{Index:bb.getColumnIndex(gc.FirstColumn+
1)-1,Min:-1,Max:-1}):gc.FirstColumn===Ob.LastColumn+1&&(mb=Object(y.a)(new ca,{Index:bb.getColumnIndex(Ob.LastColumn+1),Min:-1,Max:-1}));return mb}RJe(bb,Ob,gc){if(!gc||!bb||!Ob)return null;const mb=this.Lgh(bb,Ob,gc);bb=this.dch(bb,Ob,gc);return mb||bb?Object(y.a)(new Wa,{Row:mb?[mb]:null,Col:bb?[bb]:null}):null}dki(){const bb=new D.StandardDialog;bb.Tb=0;bb.qc(1,J.a.instance.ga(4));bb.$l(J.a.instance.ga(569),J.a.instance.ga(570),1,null)}PLj(bb){if(this.xwa.kb(bb)&&(G.HelperMethods.I_&&(this.FHb=
this.$.Kb.Cc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.ZLa.kb(bb)&&this.ZLa.remove(bb),this.ZLa.add(bb,I.a.create().toString()),v.h(this.$).Eh)){const Ob=Z.b()?Z.b().tj(bb):"";v.h(this.$).Eh.l1(this.xwa.ma(bb),this.ZLa.ma(bb),Ob)}}r3g(bb){if(this.FHb&&bb){const Ob=this.FHb.Bc;this.FHb.stop();this.FHb=null;switch(bb){case "SetPrintArea":this.Krb(Ob,1700,bb);break;case "ClearPrintArea":this.Krb(Ob,1500,bb);break;case "InsertPageBreak":this.Krb(Ob,1500,bb);break;case "RemovePageBreak":this.Krb(Ob,
1600,bb);break;case "ResetAllPageBreaks":this.Krb(Ob,1700,bb)}}}Krb(bb,Ob,gc){bb>Ob&&(Ob=Object(y.a)(new ha.a,{extendedProperties:new Map}),Ob.extendedProperties.set("OperationName",gc),Ob.extendedProperties.set("OperationExecutionTime",bb.toString()),M.Health.instance.recordQosError(Ga.a.zKj,[da.a.uKj],!1,!0,!0,!1,Ob))}z$h(bb,Ob,gc,mb,Nb,ic){const gb=new D.StandardDialog,Eb=new T.a(J.a.instance.ga(567),J.a.instance.ga(568),J.a.instance.ga(6),J.a.instance.ga(5));gb.Tb=1;gb.qc(1,Eb.confirmButton);
gb.qc(0,Eb.cancelButton);gb.$l(Eb.title,Eb.body,3,Lc=>{1===Lc&&(this.y6f(bb.command,Nb,ic),this.qhf(bb,gc,mb,Ob,ic))})}vQb(bb,Ob,gc){gc();this.ZLa.kb(Ob)&&bb.Eh.HS(this.ZLa.ma(Ob),P.BasicTelemetryCalculator.jR)}}Object(b.a)(Pa,"PrintAreaBreakManager",null,[427]);var ka=a(386),ra=a(89),ba=a(27);class Ua{constructor(){this.margin=this.P0=this.oda=this.orientation=this.tA=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.d3a=!1;this.NoColor=null}equals(bb){return bb?this.orientation===bb.orientation&&
this.oda===bb.oda&&this.P0===bb.P0&&this.margin===bb.margin&&this.sheetPrintOptions===bb.sheetPrintOptions&&this.d3a===bb.d3a&&this.NoColor===bb.NoColor:!1}static RHe(bb,Ob){bb&&Ob&&(Ob.tA=bb.tA,Ob.orientation=bb.orientation,Ob.oda=bb.oda,Ob.P0=bb.P0,Ob.margin=bb.margin,Ob.ignorePrintArea=bb.ignorePrintArea,Ob.sheetPrintOptions=bb.sheetPrintOptions,Ob.d3a=bb.d3a,Ob.NoColor=bb.NoColor)}}Object(b.a)(Ua,"PrintSettingsContainer",null,[]);var Ka=a(8),Oa=a(58),ib=a(301),La=a(969),db=a(207),Ab=a(116),Mb=
a(154),pb=a(348),Qb=a(38),xb=a(29),pa=a(22),Ma=a(767),ya=a(785),Ea=a(187),Na=a(641),kb=a(554);class lb{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(lb,"PrintSettingMarginOption",null,[]);class oa{constructor(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(oa,"PrintSettingMarginValue",null,[]);class Ba{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(Ba,"PrintSettingOption",null,[]);class sa{constructor(bb){this.DKi=
[.75,.75,.7,.7,.3,.3];this.tJi=[.75,.75,.25,.25,.3,.3];this.L4j=[1,1,1,1,.5,.5];this.Dfe=this.Ake=this.Whe=this.Fhe=this.loe=this.g7=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.im=bb;this.hhi();this.nhi()}get whatToPrintOptions(){return this.loe}get orientationOptions(){return this.Fhe}get paperSizeOptions(){return this.Whe}get scalingOptions(){return this.Ake}get marginDetailedOptions(){return this.Dfe}dispose(){}Xxb(bb){if(!bb)return null;const Ob=new oa;Ob.left=bb.Left;
Ob.right=bb.Right;Ob.top=bb.Top;Ob.bottom=bb.Bottom;Ob.header=bb.Header;Ob.footer=bb.Footer;return Ob}q7c(bb){e.ULS.shipAssertTag(537154186,0,6===bb.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Ob={};Ob.Top=bb[0];Ob.Bottom=bb[1];Ob.Left=bb[2];Ob.Right=bb[3];Ob.Header=bb[4];Ob.Footer=bb[5];return Ob}nhi(){this.loe=[Object(y.a)(new Ba,{printSettingOptionKey:1,printSettingOptionText:this.im.ga(1226)}),Object(y.a)(new Ba,{printSettingOptionKey:2,
printSettingOptionText:this.im.ga(1219)}),Object(y.a)(new Ba,{printSettingOptionKey:0,printSettingOptionText:this.im.ga(1218)})];this.Fhe=[Object(y.a)(new Ba,{printSettingOptionKey:1,printSettingOptionText:this.im.ga(1229)}),Object(y.a)(new Ba,{printSettingOptionKey:2,printSettingOptionText:this.im.ga(1228)})];this.Whe=[Object(y.a)(new Ba,{printSettingOptionKey:1,printSettingOptionText:this.im.ga(1231)}),Object(y.a)(new Ba,{printSettingOptionKey:5,printSettingOptionText:this.im.ga(1232)}),Object(y.a)(new Ba,
{printSettingOptionKey:6,printSettingOptionText:this.im.ga(1239)}),Object(y.a)(new Ba,{printSettingOptionKey:7,printSettingOptionText:this.im.ga(1233)}),Object(y.a)(new Ba,{printSettingOptionKey:8,printSettingOptionText:this.im.ga(1234)}),Object(y.a)(new Ba,{printSettingOptionKey:9,printSettingOptionText:this.im.ga(1235)}),Object(y.a)(new Ba,{printSettingOptionKey:11,printSettingOptionText:this.im.ga(1236)}),Object(y.a)(new Ba,{printSettingOptionKey:12,printSettingOptionText:this.im.ga(1237)}),Object(y.a)(new Ba,
{printSettingOptionKey:13,printSettingOptionText:this.im.ga(1238)}),Object(y.a)(new Ba,{printSettingOptionKey:3,printSettingOptionText:this.im.ga(1230)})];this.Ake=[Object(y.a)(new Ba,{printSettingOptionKey:0,printSettingOptionText:this.im.ga(1247)}),Object(y.a)(new Ba,{printSettingOptionKey:1,printSettingOptionText:this.im.ga(1248)}),Object(y.a)(new Ba,{printSettingOptionKey:2,printSettingOptionText:this.im.ga(1249)}),Object(y.a)(new Ba,{printSettingOptionKey:3,printSettingOptionText:this.im.ga(1250)})];
this.Dfe=[Object(y.a)(new lb,{printSettingOption:Object(y.a)(new Ba,{printSettingOptionKey:0,printSettingOptionText:this.im.ga(1253)}),marginValue:this.Xxb(this.normal)}),Object(y.a)(new lb,{printSettingOption:Object(y.a)(new Ba,{printSettingOptionKey:1,printSettingOptionText:this.im.ga(1254)}),marginValue:this.Xxb(this.wide)}),Object(y.a)(new lb,{printSettingOption:Object(y.a)(new Ba,{printSettingOptionKey:2,printSettingOptionText:this.im.ga(1255)}),marginValue:this.Xxb(this.narrow)}),Object(y.a)(new lb,
{printSettingOption:Object(y.a)(new Ba,{printSettingOptionKey:3,printSettingOptionText:this.im.ga(1256)}),marginValue:this.Xxb(this.g7)})]}hhi(){this.normal=this.q7c(this.DKi);this.narrow=this.q7c(this.tJi);this.wide=this.q7c(this.L4j)}}sa.Skh=1;sa.Ckh=1;sa.f9c=9;sa.Hkh=2;sa.Akh=0;sa.tkh=!1;sa.okh=!1;sa.pJa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(sa,"PrintSettingsManagerBase",null,[3]);var qb=a(121),Jb=a(283);class Yb{constructor(bb,Ob){this.sheetPrintOptions=
this.sheetName=null;this.sheetName=bb;this.sheetPrintOptions=Ob}getSheetName(){return this.sheetName}}Object(b.a)(Yb,"MacroRecorderSheetPrintOptionsSavedPayload",null,[145]);class jb{constructor(bb,Ob){this.printSettings=this.sheetName=null;this.sheetName=bb;this.printSettings=Ob}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(jb,"MacroRecorderSheetPrintSettingsSavedPayload",null,[145]);class ab extends sa{constructor(bb,Ob,gc,mb,Nb,ic){super(Nb);this.Qag=
this.Dd=!1;this.hFd=gb=>{this.XD.hFd(gb)};this.rFd=gb=>{this.XD.rFd(gb)};this.$Xi=()=>{e.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};this.ZXi=gb=>{gb=Ab.a.Oe(gb.data);e.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${xb.a.sc(gb)}.`)};this.Vz=(gb,Eb)=>{2===Eb.Kr?this.Ov.clear():1===Eb.Kr&&this.Ov&&this.Ov.contains(Eb.Sf)&&(e.ULS.sendTraceTag(537154188,
0,50,`PrintSettingsManager.OnQueueChanged: web method ${qb.a(Eb.Sf.operation.operationName)} returned, it took ${Eb.Sf.dequeueUtcTime.getTime()-Eb.Sf.enqueueUtcTime.getTime()} milliseconds to complete.`),this.Ov.remove(Eb.Sf))};this.XD=bb;this.tbb=gc;this.$=Ob;this.sheetName=mb;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.p2i=this.N$g();this.$.userOperationManager.tr(this.Vz);this.Ov=new Ea.a;this.cI=ic}Vji(bb){this.Wji(Ob=>{bb&&(Ob=this.n0h(Ob),
bb(Ob))})}FQd(bb,Ob){if(bb){var gc=new A(bb.tA,bb.ignorePrintArea);this.irj(gc);!Ob||this.Qag?e.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Ob?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Ob=this.p0h(bb.P0),Ob.IsLandscape=2===bb.orientation,Ob.PaperSize=bb.oda,this.cI&&(Ob.NoColor=bb.NoColor),Ob.PageMargin=this.ujd(bb.margin),Ob.SheetPrintOptions=sa.pJa,Ob.SheetPrintOptions.PrintGrid=bb.sheetPrintOptions.PrintGrid,
Ob.SheetPrintOptions.HorizontalCenter=bb.sheetPrintOptions.HorizontalCenter,Ob.SheetPrintOptions.VerticalCenter=bb.sheetPrintOptions.VerticalCenter,Ob.SheetPrintOptions.PrintHeaders=bb.sheetPrintOptions.PrintHeaders,this.hrj(Ob))}else e.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}ujd(bb){let Ob={};0===bb?Ob=this.normal:1===bb?Ob=this.wide:2===bb?Ob=this.narrow:3===bb&&(Ob=this.g7);return Ob}lki(bb){if(bb){e.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Ob=this.$.pa.xa,gc=this.$.pa.xa.Wb(),mb=new C.a(598,0,(Nb,ic,gb)=>Aa(Ob,this.$.va.na.name,bb,L.b(this.hFd,Nb),L.a(this.rFd,ic),gb,gc),64,()=>new Yb(this.$.va.na.name,bb));this.$.userOperationManager.Ic(mb,null)}else e.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Dd||(this.Dd=!0,this.$.userOperationManager.oo(this.Vz),
this.KY())}irj(bb){this.tbb.tA=bb.tA;this.tbb.ignorePrintArea=bb.ignorePrintArea}Wji(bb){const Ob=ic=>{Jb.a(ic)?e.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${xb.a.sc(ic.Errors)}.`):(e.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),bb(ic.Result))},gc=ic=>{ic=Ab.a.Oe(ic.data);e.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${xb.a.sc(ic)}.`);
bb(null)},mb=this.$.pa.xa.Wb();var Nb=new C.a(247,0,(ic,gb,Eb)=>Q(this.$.pa.xa,this.sheetName,this.locale,L.b(ic,Ob),L.a(gb,gc),Eb,mb),80);Nb=this.$.userOperationManager.Ic(Nb,null);this.Ov.add(Nb)}hrj(bb){e.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Ob=this.$.pa.xa.Wb();this.$.userOperationManager.Ic(new C.a(226,0,(gc,mb,Nb)=>W(this.$.pa.xa,this.sheetName,bb,L.b(gc,this.$Xi),L.a(mb,this.ZXi),Nb,Ob),
void 0,()=>new jb(this.sheetName,bb)),null)}Fri(bb){return this.Mif(bb)||!this.Tlf(bb.PaperSize)}uIh(bb){this.Mif(bb)&&(e.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),bb.ScalingWidth=ab.Jkh,bb.ScalingHeight=ab.Ikh,bb.ScalingPercent=ab.dMe,bb.FitToPage=ab.pkh);this.Tlf(bb.PaperSize)||(e.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${bb.PaperSize.toString()} present in file which is unsupported by XLO.`),
bb.PaperSize=ab.f9c);return bb}l0h(bb){if(bb.FitToPage){if(1===bb.ScalingWidth&&1===bb.ScalingHeight)return 1;if(!bb.ScalingWidth&&1===bb.ScalingHeight)return 3}else return 0;return 2}k0h(bb){return this.Wsd(bb,this.normal)?0:this.Wsd(bb,this.wide)?1:this.Wsd(bb,this.narrow)?2:3}Wsd(bb,Ob){return bb.Left===Ob.Left&&bb.Right===Ob.Right&&bb.Top===Ob.Top&&bb.Bottom===Ob.Bottom&&bb.Header===Ob.Header&&bb.Footer===Ob.Footer}p0h(bb){const Ob={};Ob.ScalingPercent=ab.dMe;Ob.FitToPage=0!==bb;2===bb?(Ob.ScalingWidth=
1,Ob.ScalingHeight=0):3===bb?(Ob.ScalingWidth=0,Ob.ScalingHeight=1):1===bb&&(Ob.ScalingWidth=1,Ob.ScalingHeight=1);return Ob}Tlf(bb){return this.p2i.contains(bb.toString())}Mif(bb){return 100!==bb.ScalingPercent||bb.FitToPage&&(1<bb.ScalingWidth||1<bb.ScalingHeight)}N$g(){const bb=new Na.a(kb.a.ak());for(let Ob=0;Ob<this.paperSizeOptions.length;Ob++)bb.add(this.paperSizeOptions[Ob].printSettingOptionKey.toString());return bb}n0h(bb){let Ob=null;if(bb){const gc=this.tbb.tA,mb=this.tbb.ignorePrintArea;
this.Fri(bb)&&(this.Qag=!0,bb=this.uIh(bb));Ob=new Ua;Ob.tA=gc;Ob.ignorePrintArea=mb;Ob.orientation=bb.IsLandscape?2:1;Ob.oda=bb.PaperSize;Ob.P0=this.l0h(bb);Ob.sheetPrintOptions=sa.pJa;Ob.sheetPrintOptions.PrintGrid=bb.SheetPrintOptions.PrintGrid;Ob.d3a=bb.Draft;this.cI&&(Ob.NoColor=bb.NoColor);Ob.sheetPrintOptions.HorizontalCenter=bb.SheetPrintOptions.HorizontalCenter;Ob.sheetPrintOptions.VerticalCenter=bb.SheetPrintOptions.VerticalCenter;Ob.sheetPrintOptions.PrintHeaders=bb.SheetPrintOptions.PrintHeaders;
Ob.margin=this.k0h(bb.PageMargin);e.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Ob.margin}`);3===Ob.margin&&(this.g7={},this.g7.Left=bb.PageMargin.Left,this.g7.Right=bb.PageMargin.Right,this.g7.Top=bb.PageMargin.Top,this.g7.Bottom=bb.PageMargin.Bottom,this.g7.Header=bb.PageMargin.Header,this.g7.Footer=bb.PageMargin.Footer)}return Ob}KY(){if(this.Ov){for(let bb of this.Ov)this.$&&this.$.userOperationManager&&(bb.operation&&e.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${qb.a(bb.operation.operationName)}.`),
this.$.userOperationManager.oua(bb)),this.Ov.remove(bb);this.Ov=null}}}ab.Jkh=1;ab.Ikh=0;ab.dMe=100;ab.f9c=9;ab.pkh=!0;Object(b.a)(ab,"PrintSettingsManager",sa,[]);var vb=a(70);class Da{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Da,"PrintSettingsTaskPaneCallbacks",null,[]);class Fa{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(Fa,"SelectedPrintSettings",null,[]);class nb{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(nb,"PrintOperationCallbacks",null,[]);class Ta{constructor(){this.onBackToSheet=null}}Object(b.a)(Ta,"PrintPreviewPaneCallbacks",
null,[]);var V=a(1079);class va{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(va,"UniversalPrintAppSettings",null,[]);var wb=a(423),fc=a(33);class Fc{constructor(bb,Ob,gc,mb){this.activeCell=this.selectedRange=this.tg=this.graphServiceEndpoint=null;this.XIb=0;this.Cda=this.Pv=null;this.VH=new Ua;this.Pk=new Ua;this.tca=0;this.r9a=null;this.pPb=!1;this.E4a=this.WHb=null;this.ptd=!1;this.q8a=
this.NBb=!0;this.Yma=this.Jza=this.x9a=null;this.OAb=!1;this.o9a=null;this.F7a=this.tOc=!1;this.XQi=Nb=>{if(!(Nb&&Nb.data&&Nb.data.fe&&Nb.data.responseHeaders&&Nb.data.fe.length)){var ic=Nb?Nb.data?Nb.data.fe?Nb.data.responseHeaders?Nb.data.fe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.tg&&(Nb=this.vSa(J.a.instance.ga(1207)),
this.GBa(Nb,0));e.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${ic}`);this.vOd&&(Nb=Object(y.a)(new ha.a,{extendedProperties:new Map}),Nb.extendedProperties.set("InvalidParameterName",ic),M.Health.instance.recordQosError(Ga.a.BPf,[da.a.CPf],!1,!0,!0,!1,Nb))}else if(0<this.tca&&Nb.data.id===this.tca){if(Nb.data.responseHeaders["Content-Type"]&&(pa.a.contains(Nb.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||pa.a.contains(Nb.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){e.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var gb=null;pa.a.contains(Nb.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(gb=this.Sbh(Nb));ic={};this.uCf(gb);Nb.data.responseHeaders["Total-Pdf-PageCount"]?(gb=parseInt(Nb.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.OAb||(this.hJd>=gb?this.Yma=gb:this.OAb=!0),this.q8a&&this.tg&&this.tg.setPageRangeSettings(gb,this.hJd,this.OAb,
this.Jza,this.Yma)):e.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else ic=Oa.a.$h(Nb.data.fe),xb.a.u$(ic.Errors)||vb.a(this.$).hd.CM(ic.Errors[0].MessageId),this.$cj(ic.Errors),this.tg&&(gb=this.vSa(ic.Errors[0].Description),-1831476778===ic.Errors[0].MessageId?(e.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.GBa(gb,0,J.a.instance.ga(1210))):
this.GBa(gb,0)),297284985===ic.Errors[0].MessageId?e.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${ic.Errors[0].MessageId}`):e.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${ic.Errors[0].MessageId}`);Nb=Nb.data.state;Nb.VTe(ic,Nb.userContext,Nb.methodName)}};this.WQi=Nb=>{if(0<this.tca&&Nb.data.id===this.tca){var ic=Ab.a.Oe(Nb.data);this.tg&&this.GBa(this.vSa(ic[0].Description),
1);e.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${xb.a.sc(ic)}]`);ic=Nb.data.state;ic.rja(Nb,ic.userContext,ic.methodName);this.$.userOperationManager.Qla.operation.qBa(()=>this.pPb)}};this.vPi=Nb=>{Nb.Errors&&0<Nb.Errors.length&&this.tg?(xb.a.u$(Nb.Errors)||vb.a(this.$).hd.CM(Nb.Errors[0].MessageId),this.GBa(this.vSa(Nb.Errors[0].Description),0),e.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${Nb.Errors[0].MessageId}`)):
(e.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.uCf(null))};this.uPi=Nb=>{Nb=Ab.a.Oe(Nb.data);this.tg&&this.GBa(this.vSa(Nb[0].Description),1);e.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${xb.a.sc(Nb)}]`);this.$.userOperationManager.Qla.operation.qBa(()=>this.pPb)};this.UGf=(Nb,ic)=>{if(ic)switch(ic.J7i){case 1:if(this.Pk&&this.E4a)switch(Nb=this.E4a.Bc,this.E4a.stop(),
this.E4a=null,this.Pk.tA){case 1:this.$2c(Nb,4800,"ActiveSheet");break;case 0:this.$2c(Nb,6100,"CurrentSelection");break;case 2:this.$2c(Nb,7500,"EntireWorkbook")}break;case 0:this.WHb&&(Nb=this.WHb.Bc,this.WHb.stop(),2400<Nb&&(ic=Object(y.a)(new ha.a,{extendedProperties:new Map}),ic.extendedProperties.set("PaneLoadTime",Nb.toString()),M.Health.instance.recordQosError(Ga.a.yKj,[da.a.Yag],!1,!0,!0,!1,ic)),this.Pv.Vji(gb=>{this.AIj(gb)}))}};this.Vz=(Nb,ic)=>{(1===ic.Kr&&this.x9a===ic.Sf||2===ic.Kr)&&
this.hPd()};this.$=bb;this.Q8b=Ob;this.E3=gc;this.SFb=mb;this.vOd=G.HelperMethods.I_;this.Qa=new Qb.a;this.hJd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.lGj();this.Qgi();this.rli=this.w3g();this.$ui=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebUniversalPrintFloodgateSurvey",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",
!1);this.cI=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);if(this.isUniversalPrintEnabled=!!mb&&mb.kNa()&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.me.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint;this.isExportPdfMode=!1}get Eri(){return this.tOc}BOg(bb){this.Qa.addHandler("ppocek",bb)}Sjj(bb){this.Qa.removeHandler("ppocek",bb)}zIj(bb,Ob,gc){this.Cnj();this.$.userOperationManager.tr(this.Vz);
this.Cda=bb;this.Qa.raiseEvent("ppocek");this.isExportPdfMode=gc;this.Cda.SelectedRanges&&this.Cda.SelectedRanges.Ranges&&0<this.Cda.SelectedRanges.Ranges.length&&this.Cda.SelectedRanges.Ranges[0]&&(this.selectedRange=r.B(this.Cda.SelectedRanges.Ranges[0]).toString());e.ULS.shipAssertTag(537154268,0,!this.Pv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Pv=new ab(this,this.$,Ob,this.$.va.na.name,J.a.instance,this.cI);e.ULS.shipAssertTag(537154267,0,!this.tg,
"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.tg=new ya.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.tg.uoh();this.tg.BIj(this.isExportPdfMode);this.tg.WNg(this.UGf)}tYh(){this.Pv.g7&&4<=this.Pv.marginDetailedOptions.length&&(this.Pv.marginDetailedOptions[3].marginValue=this.Pv.Xxb(this.Pv.g7));return this.Pv.marginDetailedOptions}w8f(){return!!this.Cda&&!!this.Cda.ObjectId||!v.h(this.$).ha.ra.Pg}q0h(){const bb=Object(y.a)(new Fa,
{selectedWhatToPrint:sa.Skh,selectedOrientation:sa.Ckh,selectedPaperSize:sa.f9c,selectedScaling:sa.Hkh,selectedMargin:sa.Akh,selectedIgnorePrintArea:sa.tkh,selectedPrintGridlines:sa.pJa.PrintGrid,selectedDraft:sa.okh,selectedHorizontalCenter:sa.pJa.HorizontalCenter,selectedVerticalCenter:sa.pJa.VerticalCenter,selectedRowAndColumnHeadings:sa.pJa.PrintHeaders});this.VH?(bb.selectedWhatToPrint=this.VH.tA,bb.selectedOrientation=this.VH.orientation,bb.selectedPaperSize=this.VH.oda,bb.selectedScaling=this.VH.P0,
bb.selectedMargin=this.VH.margin,bb.selectedIgnorePrintArea=this.VH.ignorePrintArea,bb.selectedPrintGridlines=this.VH.sheetPrintOptions.PrintGrid,bb.selectedDraft=this.VH.d3a,this.cI&&(bb.selectedColor=this.VH.NoColor?0:1),bb.selectedHorizontalCenter=this.VH.sheetPrintOptions.HorizontalCenter,bb.selectedVerticalCenter=this.VH.sheetPrintOptions.VerticalCenter,bb.selectedRowAndColumnHeadings=this.VH.sheetPrintOptions.PrintHeaders):e.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");
return bb}p7e(){return Object(y.a)(new Ta,{onBackToSheet:()=>{this.Ema()}})}m0h(){return Object(y.a)(new V.a,{backActionButtonText:J.a.instance.ga(1206),printPreviewPaneCallbacks:this.p7e(),logger:new ka.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,printOperationCallbacks:Object(y.a)(new nb,{onClosePreviewer:()=>{this.Ema()},getGraphServiceAuthorizationToken:this.ucc(),onLocalPrint:()=>{this.FHf()},onNotifyPrintJobStatus:(bb,Ob)=>{this.onNotifyPrintJobStatus(bb,Ob)}}),universalPrintAppSettings:Object(y.a)(new va,
{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.yli()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}o0h(){return Object(y.a)(new Da,{onSettingChange:bb=>{this.TWi(bb)},onPrint:()=>{this.FHf()}})}TWi(bb){this.XIb++;bb?(this.tg&&this.tg.pJj(),this.Pk.tA=bb.selectedWhatToPrint,this.Pk.P0=bb.selectedScaling,this.Pk.orientation=bb.selectedOrientation,this.Pk.oda=bb.selectedPaperSize,this.Pk.margin=bb.selectedMargin,
this.cI&&(this.Pk.NoColor=!bb.selectedColor),this.Pk.ignorePrintArea=bb.selectedIgnorePrintArea,this.izj(bb.selectedPageStart,bb.selectedPageEnd),this.Pv&&this.Nai(this.Pk,bb)?(this.Pk.sheetPrintOptions=sa.pJa,this.Pk.sheetPrintOptions.PrintGrid=bb.selectedPrintGridlines,this.Pk.sheetPrintOptions.HorizontalCenter=bb.selectedHorizontalCenter,this.Pk.sheetPrintOptions.VerticalCenter=bb.selectedVerticalCenter,this.Pk.sheetPrintOptions.PrintHeaders=bb.selectedRowAndColumnHeadings,this.Pv.lki(this.Pk.sheetPrintOptions)):
this.Ypd()):e.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}Ema(){this.F7a&&(this.pPb=!0);e.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.XIb} times before clicking on backToWorkbook icon`);this.EHf();this.KDe()}FHf(){e.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.XIb} times before clicking on print button.`);
e.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Pk.margin}, Initial margin value : ${this.VH.margin}`);if(this.useMSPdfViewer)this.DPf();else if(this.q8a)try{this.tg.printPdf(),this.i4c()}catch(bb){e.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.DPf()}else this.Q8b.yIj(this.Q6b(!0)),this.i4c()}DPf(){const bb=this.Q6b(!0);this.i4c();G.HelperMethods.kf(bb,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){ra.a.Ia(this.Qa)}Ypd(){if(this.$.C7a)this.Sji();
else{this.KY();this.F_f();var bb=null;this.Ggi();e.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.x9a=this.$.userOperationManager.Ic(new C.a(223,0,(Ob,gc,mb)=>{Ob=new ib.a(Ob,null,gc,mb,null,!0,!1,"GetFileCopyFileHandler","");Ob.correlationID=I.a.create().toString();bb=Ob;this.tca=this.E3.pha(this.Q6b(this.q8a?!1:!0,this.rli?"Base64":"Pdf"),1,null,null,Fc.UFh,!1,2,this.XQi,this.WQi,bb,void 0,void 0,void 0,12E4);Ob.requestId=
this.tca;e.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.tca}.`);return Za.Task.Ra(!0)},80),null)}}i4c(){this.EHf();this.KDe()}hFd(bb){xb.a.Nq(bb.Errors)?this.tg.showErrorMessageForPrintOptions(J.a.instance.ga(1257)):(e.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Ypd(),this.tg&&this.tg.hideErrorMessageForPrintOptions())}rFd(bb){this.tg&&this.tg.showErrorMessageForPrintOptions(J.a.instance.ga(1257));
bb=Ab.a.Oe(bb.data);e.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${xb.a.sc(bb)}.`)}Sji(){e.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.KY();const bb=this.$.pa.xa.Wb();this.x9a=this.$.userOperationManager.Ic(new C.a(133,0,(Ob,gc,mb)=>{const Nb={};Nb.WhatToPrint=this.Pk.tA;Nb.UseNamedAction=this.Q8b.C9f();Nb.SelectedSheetName=this.$.va.na.name;
Nb.ActiveCell=this.activeCell;Nb.SelectedRanges=[this.selectedRange];Nb.IsPdfDocumentRequired=!1;Nb.Orientation=this.Pk.orientation;Nb.PaperSize=this.Pk.oda;Nb.Scaling=this.Pk.P0;Nb.RichValuesEnabled=!0;Nb.IgnorePrintArea=this.Pk.ignorePrintArea;Nb.Preview=!0;this.cI&&(Nb.NoColor=this.Pk.NoColor);this.p8f()&&(Nb.PaginationStartPage=this.Jza,Nb.PaginationEndPage=this.Yma,Nb.OutputTotalPdfPageCount=!0);const ic=this.Pv.ujd(this.Pk.margin);ic&&(Nb.PageMargin={},Nb.PageMargin.Top=ic.Top,Nb.PageMargin.Bottom=
ic.Bottom,Nb.PageMargin.Left=ic.Left,Nb.PageMargin.Right=ic.Right,Nb.PageMargin.Header=ic.Header,Nb.PageMargin.Footer=ic.Footer);return this.r9a=X(this.$.pa.xa,Nb,L.b(this.vPi,Ob),L.a(this.uPi,gc),mb,bb)},80),null)}KDe(){this.$.userOperationManager.oo(this.Vz);this.KY();this.F_f();e.ULS.shipAssertTag(537154261,0,!!this.tg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.tg&&(this.tg.vjj(this.UGf),this.tg.Doh(),this.tg=null);this.Cda=
null;this.Pv&&(this.Pv.dispose(),this.Pv=null);this.E4a=this.WHb=null;this.tOc=!1;this.Qa&&this.Qa.raiseEvent("ppocek")}iEj(){return this.$.isEditMode&&!!this.VH&&!!this.Pk&&2!==this.Pk.tA&&this.Oai()}FQd(){e.ULS.shipAssertTag(537154260,0,!!this.Pv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Pv&&this.Pv.FQd(this.Pk,this.iEj())}Q6b(bb,Ob="Pdf"){const gc=new Sys.StringBuilder;gc.append(La.a(this.$,Ob,!0));db.a.zk(gc,Ka.a.RQf,""+this.Pk.tA);bb&&this.Q8b.C9f()&&
db.a.zk(gc,Ka.a.l1j,"1");db.a.zk(gc,Ka.a.Q9i,this.$.va.na.name);0===this.Pk.tA&&(db.a.zk(gc,Ka.a.P9i,this.selectedRange),db.a.zk(gc,Ka.a.H9i,this.activeCell));db.a.zk(gc,Ka.a.K9i,""+this.Pk.orientation);db.a.zk(gc,Ka.a.L9i,""+this.Pk.oda);db.a.zk(gc,Ka.a.O9i,""+this.Pk.P0);db.a.zk(gc,Ka.a.N9i,"1");db.a.zk(gc,Ka.a.G9i,this.Pk.ignorePrintArea?"1":"0");db.a.zk(gc,Ka.a.M9i,"1");this.kSg(gc);this.cI&&db.a.zk(gc,Ka.a.J9i,this.Pk.NoColor?"1":"0");this.jSg(gc);pa.a.equals(Ob,"Pdf",!0)&&(gc.append("&#toolbar=0"),
gc.append("&zoom=100"));bb=gc.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");e.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${bb}`);return bb}izj(bb,Ob){bb||Ob?(this.OAb=!0,this.Jza=bb,this.Yma=Ob):this.SZf()}kSg(bb){this.p8f()&&(db.a.zk(bb,Ka.a.S9i,""+this.Jza),db.a.zk(bb,Ka.a.R9i,""+this.Yma),db.a.zk(bb,Ka.a.T9i,"1"),e.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.Jza} to ${this.Yma}`))}p8f(){return null!=
this.Jza&&0<this.Jza&&null!=this.Yma&&0<this.Yma}jSg(bb){if(this.Pv&&this.Pk){const Ob=this.Pv.ujd(this.Pk.margin);Ob&&db.a.zk(bb,Ka.a.I9i,""+Ob.Top+" "+Ob.Bottom+" "+Ob.Left+" "+Ob.Right+" "+Ob.Header+" "+Ob.Footer)}}uCf(bb){this.tg&&(e.ULS.shipAssertTag(537154255,0,!!this.$.va.na,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.va.na&&(this.q8a?(bb||(bb=this.Q6b(!1)),this.tg.Vzi(bb)):this.tIj()))}Oai(){return!this.VH.equals(this.Pk)}EHf(){!this.pPb&&
0<this.XIb&&(this.ptd?this.FQd():e.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));e.ULS.shipAssertTag(537154250,0,!!this.tg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.tg&&this.tg.Zbi()}uj(){e.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.tg){var bb=this.vSa(J.a.instance.ga(1));this.GBa(bb,1)}else bb=xb.a.dd(1,0,26,
0,1,-1100324317,"GetPrintSettingsFailedError"),w.EwaSettings.Lz()?new pb.a(this.$,bb):(new Mb.ErrorDialog(this.$,bb)).vg()}AIj(bb){bb?(0===bb.tA&&this.w8f()&&(e.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.Cda.ObjectId?"floatingObject":"discontinuousRange"}.`),bb.tA=1),Ua.RHe(bb,this.VH),Ua.RHe(bb,this.Pk),e.ULS.shipAssertTag(537154248,0,!!this.tg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.tg&&(this.ptd=!0,this.tg.CIj(),this.Ypd())):(e.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.uj())}$2c(bb,Ob,gc){bb>Ob&&(Ob=Object(y.a)(new ha.a,{extendedProperties:new Map}),Ob.extendedProperties.set("WtpSelectedValue",gc),Ob.extendedProperties.set("FullyRenderedPdfLoadTime",bb.toString()),M.Health.instance.recordQosError(Ga.a.xKj,[da.a.Yag],!1,!0,!0,!1,Ob))}KY(){this.x9a&&(0<this.tca||this.r9a)&&(e.ULS.sendTraceTag(537154246,
0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.tca}.`),this.$.userOperationManager.oua(this.x9a),this.r9a?Ab.a.cu(this.r9a.tt):this.E3.cu(this.tca),this.hPd())}hPd(){this.r9a=this.x9a=null}Ggi(){this.vOd&&this.Pk&&(this.E4a=this.$.Kb.Cc("UserAction",(1===this.Pk.tA?"ActiveSheet":0===this.Pk.tA?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}SZf(){this.OAb=!1;this.Jza=1;this.Yma=this.hJd}vSa(bb){if(bb)return bb.replace("&#39;",
"'");e.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return bb}tIj(){e.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.NBb)e.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let bb=this.vSa(J.a.instance.ga(1212));this.GBa(bb,3)}}GBa(bb,Ob,gc=null){this.tg.iA(bb,Ob,gc)}Qgi(){this.q8a=this.NBb=!0;e.ULS.sendTraceTag(557061534,
0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.NBb}, isPdfPreviewSupportedInPreviewer: ${this.q8a}`)}Cnj(){this.o9a=null;this.hPd();this.SZf();this.WHb=this.$.Kb.Cc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.na.activeCell.toString();this.XIb=0;this.ptd=this.F7a=this.pPb=!1;this.tOc=!0}lGj(){const bb=this.zui()||this.Oui();e.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${bb}`);return bb}w3g(){let bb=
15;ba.a.aI&&ba.a.Lub&&(bb=parseFloat(ba.a.Lub));return 14<bb&&this.NBb}zui(){var bb;if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:7422060_ModifyTeamsHostCheck")){const Ob="teams"===(null===(bb=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.o8])||void 0===bb?void 0:bb.toLowerCase());e.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${ba.a.Hz} isTeamsUIHost: ${Ob} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);return ba.a.Hz||Ob}return ba.a.Hz||
f.AFrameworkApplication.isUnifiedHostMode}Oui(){return!this.$.me.get(111)}F_f(){this.o9a&&(URL.revokeObjectURL(this.o9a),this.o9a=null)}Sbh(bb){var Ob=bb.data.fe;bb=this.$.Kb.Cc("UserAction","PrintPreviewBlobFileCreation");var gc=window.self.atob(Ob);Ob=new Uint8Array(Ob.length);for(let mb=0;mb<gc.length;mb++)Ob[mb]=gc.charCodeAt(mb)&255;gc=new Blob([Ob],{type:"application/pdf"});this.o9a=URL.createObjectURL(gc);e.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${bb.Bc} ms. Blob size: ${gc.size}`);
bb.stop();return this.o9a+"#toolbar=0&zoom=100"}$cj(bb){if(this.vOd&&xb.a.fh(bb,Fc.C3i)){const Ob=Object(y.a)(new ha.a,{extendedProperties:new Map});Ob.extendedProperties.set("ErrorMessageIdName",bb[0].MessageIdName);M.Health.instance.recordQosError(Ga.a.BPf,[da.a.CPf],!1,!0,!0,!1,Ob)}}Nai(bb,Ob){return bb.sheetPrintOptions.PrintGrid!==Ob.selectedPrintGridlines||bb.sheetPrintOptions.HorizontalCenter!==Ob.selectedHorizontalCenter||bb.sheetPrintOptions.VerticalCenter!==Ob.selectedVerticalCenter||bb.sheetPrintOptions.PrintHeaders!==
Ob.selectedRowAndColumnHeadings}gUj(){this.$ui&&this.$.Xc(1936706533,-1,0,null)}yli(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){e.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.SFb.YL("Print",this.graphServiceEndpoint).then(bb=>bb?(bb.IsSuccess?e.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):
e.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${bb.ErrorCode}, Error message : ${bb.ErrorMessage}`),bb):Object(y.a)(new Ma.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(bb=>{let Ob=new Ma.a;Object.getType(bb)===Object.getType(Ob)?Ob=bb:(Ob.ErrorMessage=bb.toString(),Ob.ErrorCode="exception");return Promise.resolve(Ob)})}ucc(){return()=>{const bb=Promise.resolve("");try{if(this.SFb&&this.SFb.kNa())return this.getToken().then(Ob=>
Ob.IsSuccess?Promise.resolve(Ob.Token):bb,()=>bb)}catch(Ob){e.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return bb}}onNotifyPrintJobStatus(bb,Ob){bb=wb.a.GJ.notificationBar.iaa(bb,!1);"pending"==Ob&&(bb.displayTimeoutSeconds=3,this.gUj());if(fc.a.UBb())switch(Ob){case "failure":bb.image=1;break;case "success":bb.image=3;break;default:bb.image=0}else bb.image=0;wb.a.GJ.notificationBar.KE(bb)}}Fc.C3i=[-953554093,1773721536,-1104435974,
-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Fc.UFh=["Content-Type","Total-Pdf-PageCount"];Object(b.a)(Fc,"PrintPreviewManager",null,[425,3,426]);class Qa{constructor(bb,Ob,gc){this.ignorePrintArea=!1;this.CTj=()=>{const mb=v.h(this.$).Da;this.aUc=!0;mb.uCd()};this.xWi=()=>{this.Xld()};this.wWi=(mb,Nb,ic)=>{e.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${ic} failed to execute`);
this.Xld()};this.$=bb;this.ea=bb.ea;this.Q8b=Ob;this.tbb=new A(1,this.ignorePrintArea);this.XD=Ob=new Fc(bb,Ob,f.AFrameworkApplication.zd,gc);this.$.da.Ga(418,Ob);this.zPf=new Pa(bb);this.$.da.Ga(384,this);this.aUc=!1}get z8f(){return this.aUc}nc(){return!1}executeCommand(bb,Ob,gc,mb){const Nb=Ob.command;return 1588554917===Nb||1531172830===Nb||-2050819419===Nb?(Ob.YAb=!0,B.a(this.$)&&this.$.da.Aa(423).SAc(!1),this.eph(Ob)?Za.Task.Ra(!0):u.a(Nb)):this.zPf.executeCommand(bb,Ob,gc,mb,this.xWi,this.wWi,
this.CTj)}yc(bb,Ob){switch(Ob.command){case 1588554917:return e.ULS.shipAssertTag(537154305,0,this.$.nla,"Command execute requested for Print operation when data duplication is disallowed."),!0;case 1531172830:return w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);case -2050819419:return w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1);default:return this.zPf.yc(bb,Ob)}}Lc(){return!1}eph(bb){return this.$.ea.Zb?this.fph(bb):!1}fph(bb){e.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");const Ob=this.$.Kb.Cc("UserAction","DoPrintHtml");var gc=this.$;gc=this.j0h(gc,this.ea.isNamedObjectViewMode?gc.Cb.na.sheetName:gc.va.na.name);if(z.a(this.$))e.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened.");else{const mb=1531172830===bb.command||-2050819419===bb.command;
this.XD.zIj(gc,this.tbb,mb);e.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${mb} Command: ${n.a[bb.command]}`)}Ob.stop();this.Xld();return!0}j0h(bb,Ob){const gc={};gc.SessionId=this.ea.sessionId;gc.UsedRangeTooBig=!1;var mb=v.h(bb),Nb=mb.ha;const ic=Nb.Ne;if(x.e(bb.na))gc.Type=0,gc.ObjectId=bb.na.name,gc.UseSelection=!1;else if(x.g(bb.na))gc.Type=1,gc.ObjectId=bb.na.imageId,gc.UseSelection=!0;else if(2===ic||4===ic||64===ic)mb=Nb.Ta.$b.floatingObject,
gc.Type=1,gc.SheetName=Ob,gc.ObjectId=mb.id,gc.UseSelection=!0;else if(ic&470)gc.ObjectId=Nb.Ta.$b.floatingObject.id,gc.SheetName=Ob;else if(x.i(bb.na)){gc.Type=2;gc.SheetName=Ob;if(Nb.ra.Pg)if(Nb=Nb.ra.ed,gc.SelectedRanges=r.q(Nb,bb),20<Nb.TC)gc.UseSelection=!0;else{Ob=0;mb=mb.jk("PrintCommandHandler.DoPrintHtml",Nb);try{for(mb.$$rst();mb.$$mn()&&2>Ob;)mb.$$cu().text&&Ob++;gc.UseSelection=2<=Ob}finally{mb&&mb.dispose()}}else gc.UseSelection=!1,gc.SelectedRanges=r.q(Nb.ra.activeRange,bb);this.ea.isNamedObjectViewMode&&
(gc.UsedRange=r.v(bb.na.usedRange,bb))}gc.Title=bb.workbookContext.WorkbookFileName;return gc}Xld(){v.h(this.$);if(!this.z8f){this.aUc=!0;const bb=this.$.Kb.Cc("UserAction","HandlePageLayoutRendering");this.QTj();e.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${bb.Bc} ms.`);bb.stop()}}QTj(){const bb=v.h(this.$).Da,Ob=bb.rD();let gc=!1,mb=0;for(let Nb=0;Nb<Ob.length;Nb++){const ic=Ob[Nb],gb=ic.rf;gb&&gb.hasPageLayout()&&(gc=!0,gb.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
ic.Bd,4),mb++)}gc&&(e.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Ob.length}, number of blocks that require re-rendering is ${mb}`),bb.uCd())}}Object(b.a)(Qa,"PrintCommandHandler",null,[219,415]);var la=a(1078),hb=a(1290),Kb=a(1291);class dc extends h.a{constructor(bb){super(bb)}ld(){var bb=f.AFrameworkApplication.fa.appSettings,Ob=this.$.ya.DirectPrintSetting;bb.DirectPrintIsEnabled=Ob.DirectPrintIsEnabled.toString();bb.DirectPrintProbeIsEnabled=
Ob.DirectPrintProbeIsEnabled.toString();bb.DirectPrintEnabledForInternetExplorer=Ob.DirectPrintEnabledForInternetExplorer.toString();bb.DirectPrintSupportedMimeTypes=Ob.DirectPrintSupportedMimeTypes;bb.DirectPrintSupportedPlugins=Ob.DirectPrintSupportedPlugins;bb.DirectPrintImmersivePreviewPlugins=Ob.DirectPrintImmersivePreviewPlugins;bb.DirectPrintMinimalSupportedEdgeVersion=Ob.DirectPrintMinimalSupportedEdgeVersion;bb.DirectPrintEnabledForEdge=Ob.DirectPrintEnabledForEdge.toString();bb=new la.a(bb);
let gc=null;Ob=null;try{Ob=window.navigator.mimeTypes}catch(Nb){e.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let mb=null;try{mb=window.navigator.plugins}catch(Nb){e.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}gc=new Kb.a(bb,Ob,mb,Kb.a.jjf,Kb.a.Dnf,new hb.a(f.AFrameworkApplication.ta.IX),f.AFrameworkApplication.ta.kE,Kb.a.Enf,(Nb,ic)=>new d.a(Nb,!1,ic),!1);if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&
w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableLicenseCheckForUniversalPrint",!1)&&this.$.me.get(116)){const Nb=m.GetServiceTaskFactory.Na(this.$.da,349,350,this.Ya);l.TaskExtensions.za(Nb,()=>{const ic=new Qa(this.$,gc,Nb.result);this.Zc([ic])},this.$.ka)}else this.Zc([new Qa(this.$,gc,null)])}static la(bb){h.a.Nd(73,new dc(bb))}}Object(b.a)(dc,"PrintCommandHandlerFactory",h.a,[]);a.d(E,"a",function(){return sb});const sb=()=>{c.a.Fa(dc.la)}},1148:function(t,E,a){var c=a(9),b=
a(0),e=a(222),f=a(48),d=a(37),h=a(15),m=a(89),l=a(83),w=a(243),n=a(622),x=a(207),r=a(116),u=a(35),v=a(39),B=a(238),z=a(44),A=a(6),y=a(36),D=a(70),I=a(590);class M extends B.a{constructor(sb,bb){super(sb);this.g1j=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.EGb=()=>{const Ob=this.pUh();if(Ob){this.$.DI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const gc=D.a(this.$).hd.activityState;gc[y.a.KZa]=A.a.download;gc[I.a.UWc]=this.command}z.a(this.$).Qr(Ob.Errors)}};
this.iframe=sb;this.$=bb;this.Gc.la("load",this.EGb)}get vdi(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(sb,bb){const Ob={};(sb=this.XEh(sb,Ob))&&v.a.gtc("dlfr",sb,Ob);this.command=bb}XEh(sb,bb){var Ob=sb.split("?");if(2!==Ob.length)return sb=null,h.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),sb;Ob=Ob[1].split("&");for(const mb of Ob){var gc=
mb.split("=",2);if(2!==gc.length){sb=null;h.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}Ob=gc[0];this.g1j.includes(Ob)&&(gc=decodeURIComponent(gc[1]),bb[Ob]=gc,sb=x.a.rKb(sb,Ob))}return sb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}pUh(){try{return this.iframe.contentWindow.ewaResult}catch(sb){if(!this.$.ea.dc.isDivSyndicated){const bb=window.document.referrer.match(RegExp("://(.[^/]+)/"));
h.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<bb.length?bb[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.C7a}`);throw sb;}return null}}static Exe(sb){let bb=document.createElement("iframe");bb.id="ewaFileLoader";bb.style.cssText="height:0;width:0;display:none";bb.src="about:blank";bb.setAttribute("name","dlfr");bb=sb.domElement.appendChild(bb);return new M(bb,
sb)}}Object(b.a)(M,"FileLoader",B.a,[]);var T=a(143),S=a(55);class H{constructor(sb,bb){this.Tc=()=>{u.a.xg(D.a(this.$).hd.activityState,T.a.TCd)||this.mva.reset()};this.$=bb;this.inc=sb;this.ea=bb.ea;this.ea.Xj(this.Tc);this.mva=M.Exe(this.$)}Kph(){const sb=this.ZZg(this.$),bb=this.$.userOperationManager.operationCount;0<bb&&h.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${bb}`);this.$.userOperationManager.D4("DownloadACopyOperation.DownloadForkedFile");this.inc&&h.ULS.sendTraceTag(537154821,
0,50,"DownloadACopyOperation - Dataloss scenario");this.mva.downloadFile(sb,-21742208);d.TaskExtensions.za(S.Task.delay(1),()=>{this.Def()},this.mva.ka,3)}dispose(){this.ea&&this.ea.tk(this.Tc);this.$=this.ea=null}Def(sb=null){sb||(sb=this.$.Kb.Cc("LoadResource","DownloadACopyOperation"));!this.mva.vdi&&sb.Bc<H.Svf?window.setTimeout(()=>{this.Def(sb)},H.Lph):(sb.Bc>=H.Svf&&h.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),D.a(this.$).hd.XM())}ZZg(sb){const bb=new Sys.StringBuilder,
Ob=sb.workbookContext,gc=sb.ya;bb.append(sb.Yna);bb.append(gc.FileHandlerRelativeUri);bb.append("?id=");bb.append(encodeURIComponent(x.a.rKb(Ob.WorkbookUri,"sc")));sb.ea.Zb&&(bb.append("&sessionId="),bb.append(encodeURIComponent(sb.ea.sessionId)));bb.append("&workbookType=FullForkedWorkbook");bb.append("&dataloss=");bb.append(this.inc?"true":"false");r.a.Cpb(bb,gc);return bb.toString()}}H.Svf=1E5;H.Lph=100;Object(b.a)(H,"DownloadACopyOperation",null,[3]);class C extends w.a{constructor(sb,bb,Ob=!1){super(sb,
bb);this.tEb=null;this.iFd=gc=>{this.unsubscribe(mb=>{gc.remove_disposing(mb)});this.jh(A.a.Yj);this.Kp()};this.inc=Ob}execute(sb){const bb=Object(l.a)(7,sb.Fe);if(!bb.nla)return h.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.$pd(sb),this.jh(A.a.idle),1;this.tEb||(this.tEb=new H(this.inc,bb));this.tEb.Kph();h.ULS.shipAssertTag(537154817,0,3!==D.a(bb).gi.Cu,"The current activity should not be closed.");return 1}$pd(sb){const bb=
Object(l.a)(7,sb.Fe),Ob=new n.a(bb);this.subscribe(sb,this.iFd,gc=>{Ob.add_disposing(gc)});h.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Ob.initialize();Ob.vg()}dispose(){m.a.Ia(this.tEb);this.tEb=null;super.dispose()}}Object(b.a)(C,"DownloadAForkedCopyActivity",w.a,[]);class G extends e.a{constructor(sb){super();this.$=sb;this.Fb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),
()=>{this.ob(new C(A.a.c3a,A.a.Yj,!0))},this.ka)}}Object(b.a)(G,"DownloadACopyPreDatalossActivityFactory",e.a,[]);class J extends e.a{constructor(sb){super();this.$=sb;this.Fb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),()=>{this.ob(new C(A.a.unmergeableDownloadCopy,A.a.ipa))},this.ka)}}Object(b.a)(J,"DownloadAForkedCopyActivityFactory",e.a,[]);var L=a(84),P=a(4),aa=a(80),U=a(27),K=a(106),Y=a(25);class na{constructor(sb,bb,Ob){this.La=sb;this.fzg=bb;
this.t2=Ob}Hg(){this.La.Nb(Y.a.tryMacOffice,K.a.frame,Object(L.a)(this,this.v_i,"onTryMacOffice"));this.La.Nb(Y.a.phg,K.a.frame,Object(L.a)(this,this.IKf,"onTryMacOfficeFromViewer"));this.La.Nb(Y.a.ohg,K.a.frame,Object(L.a)(this,this.IKf,"onTryMacOfficeFromViewer"))}v_i(sb,bb,Ob,gc,mb){if(1===Ob)return 32;mb?(sb=mb.SourceControlId,"btnjTryMacOfficeForWordEditor"===sb?v.a.kf(aa.a.g_(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===sb&&v.a.kf(aa.a.g_(22),"_blank",
void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Qqf();return 32}IKf(sb,bb,Ob){if(1===Ob)return 32;switch(sb){case Y.a.phg:v.a.kf(aa.a.g_(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Y.a.ohg:v.a.kf(aa.a.g_(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Qqf(){v.a.kf(na.NEi,"_blank",void 0,"LaunchMacTrialWindow")}get nAc(){return this.fzg&&U.a.isMac&&!U.a.xri&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get IEj(){return this.nAc}static get NEi(){return aa.a.PH("522401")}}
Object(b.a)(na,"MacOfficeOffer",null,[731]);var W=a(82);class X{constructor(sb,bb,Ob){this.La=sb;this.jzg=bb;this.cIc=null;(this.XZb=P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&W.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(gc=>{this.cIc=gc});this.t2=Ob}Hg(){this.La.Nb(Y.a.tryOffice,K.a.frame,Object(L.a)(this,this.w_i,"onTryOffice"));this.La.Nb(Y.a.tryOfficeThroughTellMe,
K.a.frame,Object(L.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Nb(Y.a.shg,K.a.frame,Object(L.a)(this,this.thg,"tryOfficeThroughViewer"));this.La.Nb(Y.a.rhg,K.a.frame,Object(L.a)(this,this.thg,"tryOfficeThroughViewer"))}w_i(sb,bb,Ob,gc,mb){if(this.XZb&&1===Ob)return this.isFreemiumUpsellEnabled&&this.UNb?32:8;2===Ob&&(mb?(sb=mb.SourceControlId,"btnjTryOfficeForWordEditor"===sb?v.a.kf(aa.a.g_(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
sb?v.a.kf(aa.a.g_(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.imc()):this.imc());return 32}tryOfficeThroughTellMe(sb,bb,Ob,gc,mb){if(this.XZb&&1===Ob)return this.isFreemiumUpsellEnabled&&this.UNb?32:8;2===Ob&&(mb?(sb=mb.SourceControlId,v.a.kf(aa.a.PH("862405")+this.p_h(sb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):v.a.kf(aa.a.PH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}thg(sb,bb,Ob){if(this.XZb&&1===Ob)return this.isFreemiumUpsellEnabled&&
this.UNb?32:8;if(2===Ob)switch(sb){case Y.a.shg:v.a.kf(aa.a.g_(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Y.a.rhg:v.a.kf(aa.a.g_(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Bzf(){return this.UNb}get cMi(){return this.UNb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get UNb(){return this.jzg&&!U.a.isMac}get isFreemiumUpsellEnabled(){let sb=!1;this.cIc&&(sb=this.cIc.isFreemiumUpsellEnabled());return sb}imc(sb=null){let bb=0;sb&&(bb=sb);v.a.kf(X.$Xh(bb),"_blank",void 0,
"LaunchOfficeOffer")}p_h(sb){let bb=0;switch(sb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":bb=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":bb=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":bb=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":bb=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":bb=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":bb=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":bb=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":bb=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":bb=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":bb=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":bb=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":bb=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":bb=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":bb=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":bb=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":bb=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":bb=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":bb=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":bb=29}return 0===bb?"":String.format("&pc={0:D}",bb)}static $Xh(sb){if(U.a.$g)switch(sb){case 1:return aa.a.PH("393806");case 2:return aa.a.PH("393810");case 3:return aa.a.PH("393809");case 5:return aa.a.PH("393805")}else if(U.a.Dp)switch(sb){case 1:return aa.a.PH("521979");case 3:return aa.a.PH("521980");case 5:return aa.a.PH("521978");
case 2:return aa.a.PH("522490")}else{if(2===sb)return aa.a.PH("517778");if(1===sb)return aa.a.g_(30)}return aa.a.PH("522402")}}Object(b.a)(X,"OfficeTrialExperience",null,[730]);class Aa{Oh(sb){sb.register(X,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").wc().Ac(()=>new X(P.AFrameworkApplication.ub,P.AFrameworkApplication.JBb,P.AFrameworkApplication.lcid));sb.register(na,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").wc().Ac(()=>new na(P.AFrameworkApplication.ub,
P.AFrameworkApplication.tjc,P.AFrameworkApplication.lcid))}}Object(b.a)(Aa,"OpenInClientConfiguration",null,[5]);var Q=a(553),fa=a(1360),Ca=a(38),ia=a(1196),Ra=a(146),Ya=a(152),Ga=a(224),da=a(14),Z=a(85),ha=a(108),Wa=a(87);const ca=sb=>{for(let bb=0;bb<sb.children.length;bb++){const Ob=sb.children[bb];Ob.style.position="relative";Ob.style.top=(Ob.parentNode.offsetHeight-Ob.offsetHeight)/2+"px"}},ja=sb=>sb.Ca.keyCode===Z.a.Kh||sb.Ca.keyCode===Z.a.nfa?(sb.Gb.click(),!0):!1,ua=(sb,bb,Ob,gc,mb,Nb,ic)=>
{const gb=document.createElement("a");gb.className="ProtocolLaunchingDialogButtonAnchor";gb.className+=" OICDialog";gb.id=sb;gb.setAttribute(Wa.a.Ad,Wa.a.rt);gb.style.padding="0";gb.style.margin="0";gc&&Za(mb,bb,Ob,gc,gb);sb=document.createElement("span");sb.className="ProtocolLaunchingDialogButtonLabel";sb.innerText=mb;gb.appendChild(sb);gb.tabIndex=0;Nb&&Ga.a.instance.sa(da.a.click,gb,Nb);ic&&ha.KeyInputManager.instance.sa(da.a.Gd,gb,ic);return gb},Za=(sb,bb,Ob,gc,mb)=>{var Nb=document.createElement("img");
Nb.alt=sb;Nb.className=Ya.getImageClassWithCluster(Ob,gc);Nb.src=bb;Nb.setAttribute(Wa.a.Ad,Wa.a.Oq);sb=document.createElement("span");sb.className="ProtocolLaunchingDialogImg32Container";sb.appendChild(Nb);Nb=document.createElement("span");Nb.className="ProtocolLaunchingDialogIconContainer";Nb.appendChild(sb);mb.appendChild(Nb)};class Pa{static get og(){return Ra.a.jq(Pa.nl,CommonUIStrings.l_OICLaunchDialogTitle)}}Pa.nl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(Pa,"OICLaunchDialogHtml",null,[]);class ka extends Ra.a{constructor(sb){super();this.rWa=this.BDa=null;this.sqa=!1;this.Fq=sb;this.og=Pa.og;this.Tb=5;this.Ee="OICLaunchDialog";this.showDialog("",Object(L.a)(this,this.pMi,"oicLaunchDialogResultHandler"));this.R5f();this.wX("ProtocolLaunchingDialogTitle");4!==P.AFrameworkApplication.ta.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.RI(this.BDa);h.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}rab(){this.BDa=ua("BtnRichClient",this.Fq.uub,this.Fq.Nzb,this.Fq.sod,CommonUIStrings.l_OICLaunchRichClient,Object(L.a)(this,this.yIf,"onRichClientButtonClick"),ja);document.getElementById("OICLaunchRichClient").appendChild(this.BDa);ca(this.BDa);this.rWa=ua("BtnReturn",this.Fq.uub,this.Fq.Nzb,this.Fq.Pef,CommonUIStrings.l_OICReturnToOnlineClient,Object(L.a)(this,this.vIf,"onReturnButtonClick"),
ja);document.getElementById("OICReturnToApp").appendChild(this.rWa);ca(this.rWa)}vIf(){this.hide();this.Fq.Ddb();return!0}yIf(){h.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();P.AFrameworkApplication.ub.processAction(Y.a.gSa,2);return!0}pMi(){this.Fq.Ddb()}dispose(){this.sqa||(this.BDa&&(Ga.a.instance.Ba(da.a.click,this.BDa,Object(L.a)(this,this.yIf,"onRichClientButtonClick")),ha.KeyInputManager.instance.Ba(da.a.Gd,this.BDa,ja)),this.rWa&&(Ga.a.instance.Ba(da.a.click,
this.rWa,Object(L.a)(this,this.vIf,"onReturnButtonClick")),ha.KeyInputManager.instance.Ba(da.a.Gd,this.rWa,ja)),super.dispose(),this.sqa=!0)}}Object(b.a)(ka,"OICLaunchDialog",Ra.a,[]);class ra{static get og(){return Ra.a.jq(ra.nl,CommonUIStrings.l_OICDialogTitle)}}ra.nl="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ra,"ProtocolLaunchingDialogV2Html",null,[]);a(421);var ba=a(107);class Ua extends Ra.a{constructor(sb){super();this.qWa=this.Afa=null;this.sqa=!1;this.Ypa=null;this.Fq=sb;this.og=ra.og;this.Tb=5;this.Ee="ProtocolLaunchingDialog";this.iKc="OICRetryDialog";P.AFrameworkApplication.Fi.x6a&&P.AFrameworkApplication.Fi.Qwc();P.AFrameworkApplication.Fi.Eg(new ba.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(L.a)(this,this.MJd,"protocolLaunchingDialogResultHandler"));
this.R5f();this.wX("Issues");this.l_e();h.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}rab(){const sb=document.getElementById("Issues");if(sb){Za("",this.Fq.uub,this.Fq.Nzb,this.Fq.sod,sb);const bb=document.createElement("span");bb.className="WACDialogSectionTitle";bb.innerText=5===this.Fq.BLf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;sb.appendChild(bb);ca(sb);sb.style.display="none"}P.AFrameworkApplication.ta.Pa.lld?
(this.qWa=ua("GiveFeedback",this.Fq.uub,this.Fq.Nzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(L.a)(this,this.gqc,"onGiveFeedbackClick"),Object(L.a)(this,this.GEf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.qWa),ca(this.qWa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===P.AFrameworkApplication.ta.Pa.editMode||P.AFrameworkApplication.vnh?document.getElementById("ButtonEdit").style.display="none":
(this.Afa=ua("Edit",this.Fq.uub,this.Fq.Nzb,"",2===P.AFrameworkApplication.ta.Pa.Ij?4===P.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===P.AFrameworkApplication.ta.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(L.a)(this,this.iDf,"onEditClick"),Object(L.a)(this,this.mDf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Afa),ca(this.Afa));0===
P.AFrameworkApplication.ta.Pa.editMode&&!P.AFrameworkApplication.JBb&&sb&&(sb.style.display="none")}n_e(){return this.Ypa?(this.RI(this.Ypa),!0):!1}l_e(){return this.Afa?(this.RI(this.Afa),!0):!1}mDf(sb){return this.qDd(sb,0)}GEf(sb){return this.qDd(sb,2)}uIf(sb){return this.qDd(sb,1)}qDd(sb,bb){let Ob=!1;if(sb.Ca.keyCode===Z.a.Kh||sb.Ca.keyCode===Z.a.nfa)sb.Gb.click(),Ob=!0;else if(sb.Ca.keyCode===Sys.UI.Key.down||sb.Ca.keyCode===Sys.UI.Key.up)switch(bb){case 1:Ob=this.l_e();break;case 0:Ob=this.n_e()}return Ob}iDf(){this.hide();
4===P.AFrameworkApplication.ta.Pa.editMode?(h.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Fq.Ddb()):(h.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Fq.Jld());return!0}gqc(){h.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Fq.Iaf();return!0}jrc(){h.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";P.AFrameworkApplication.ub.processAction(Y.a.gSa,2);return!0}MJd(){this.Fq.Ddb()}switchToBackupMode(){var sb=
document.getElementById("ProtocolLaunchingDialogTitle");if(sb){sb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(sb=document.getElementById("Issues"))sb.style.display="block";(sb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!sb.children.length&&(this.Ypa=ua("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(L.a)(this,this.jrc,"onRetryOICClick"),Object(L.a)(this,this.uIf,"onRetryOICKeyUp")),sb.appendChild(this.Ypa),ca(this.Ypa),this.Afa||this.n_e())}}dispose(){this.sqa||(this.Afa&&
(Ga.a.instance.Ba(da.a.click,this.Afa,Object(L.a)(this,this.iDf,"onEditClick")),ha.KeyInputManager.instance.Ba(da.a.Gd,this.Afa,Object(L.a)(this,this.mDf,"onEditKeyUp"))),this.qWa&&(Ga.a.instance.Ba(da.a.click,this.qWa,Object(L.a)(this,this.gqc,"onGiveFeedbackClick")),ha.KeyInputManager.instance.Ba(da.a.Gd,this.qWa,Object(L.a)(this,this.GEf,"onGiveFeedbackKeyUp"))),this.Ypa&&(Ga.a.instance.Ba(da.a.click,this.Ypa,Object(L.a)(this,this.jrc,"onRetryOICClick")),ha.KeyInputManager.instance.Ba(da.a.Gd,
this.Ypa,Object(L.a)(this,this.uIf,"onRetryOICKeyUp"))),super.dispose(),this.sqa=!0)}}Object(b.a)(Ua,"ProtocolLaunchingDialog",Ra.a,[]);var Ka=a(133),Oa=a(427);class ib extends Ka.StandardDialog{constructor(sb){super();this.Fq=sb;this.Ee="ProtocolLaunchingDialog";P.AFrameworkApplication.Fi.x6a&&P.AFrameworkApplication.Fi.Qwc();P.AFrameworkApplication.ta.Pa.lld&&this.pqe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(L.a)(this,this.gqc,"onGiveFeedbackClick"));ib.Hbf?(this.Tb=12,this.qc(1,
CommonUIStrings.l_CloseFile),this.qc(2,CommonUIStrings.l_OICDialogContinueHere),this.qc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Tb=4,this.qc(1,CommonUIStrings.l_OICDialogContinueHere),this.qc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.TEb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Fq.BLf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(L.a)(this,this.MJd,"protocolLaunchingDialogResultHandler"),null)}gqc(sb){h.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.EDf(sb)}jrc(){h.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");P.AFrameworkApplication.ub.processAction(Y.a.gSa,2)}MJd(sb){ib.Hbf?3===sb?this.x_f():2===sb||0===sb?this.continueEditing():1===sb&&this.b6g():2===sb?this.x_f():(1===sb||0===sb)&&this.continueEditing()}b6g(){h.ULS.sendTraceTag(577783557,211,50,"Closing the document");P.AFrameworkApplication.ub.$d(Y.a.close,2,Oa.a)}x_f(){h.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(L.a)(this,
this.jrc,"onRetryOICClick"),0)}continueEditing(){4===P.AFrameworkApplication.ta.Pa.editMode||P.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===P.AFrameworkApplication.ta.mode?(h.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Fq.Ddb()):(h.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Fq.Jld())}static get Hbf(){return P.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===P.AFrameworkApplication.ub.processAction(Y.a.close,
1)}}Object(b.a)(ib,"StandardProtocolLaunchingDialog",Ka.StandardDialog,[]);var La=a(1241);class db{}Object(b.a)(db,"EditDocumentInClientParams",null,[]);class Ab{static L$c(sb,bb,Ob,gc,mb,Nb,ic=!1,gb=!1,Eb="",Lc=!1,Ec=!1,Cb=!1,eb="",Sb="",ld="",bd=!1){const ec=new db;ec.DocumentUrl=sb;ec.Mode=bb;ec.Options=Ob;ec.Application=gc;ec.SilentExternalHandler=ic;ec.EncodeUrl=gb;ec.CorrelationIdForWinClient=Eb;ec.NavigateUsingWindowOpen=Lc;ec.DescriptiveUnattemptedEnums=Ec;ec.NoBrowserModalDialogs=Cb;ec.SessionOrigin=
eb;ec.CorrelationId=Sb;ec.ClickTime=ld;ec.NewTelemetryDataIsEnabled=bd;MSOJS.ClientUtils.EditDocumentInClient(ec,mb,Nb)}}Object(b.a)(Ab,"ClientUtils",null,[]);var Mb=a(98),pb=a(145),Qb=a(474),xb=a(171),pa=a(824),Ma=a(376),ya=a(164),Ea=a(72),Na=a(189);class kb{constructor(sb){this.vga=this.a$d=this.xWa=null;this.akb=!1;this.bQc=this.ghe=null;this.vTb=this.tE=this.MYb="";this.application=this.pC=0;this.zOj=this.dZd=!1;this.k1j=sb&&P.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");P.AFrameworkApplication.ub.J4(Y.a.gSa)||
P.AFrameworkApplication.ub.Nb(Y.a.gSa,K.a.frame,Object(L.a)(this,this.epj,"retryOpenInClientAction"));this.zag=!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.qa("SilentExternalHandler")}get BLf(){return this.pC}zzc(sb,bb="",Ob=""){this.tE=Ob||xb.a.create().toString();this.MYb=bb||Qb.a.s6e();this.vTb=sb}epj(sb,bb,Ob){return bb.contextId!==K.a.frame?2:1===Ob?32:this.gSa()}get options(){let sb=0;P.AFrameworkApplication.bnj&&(sb|=1);P.AFrameworkApplication.openInClientEditOnly&&(sb|=4);this.wOj()&&
(sb|=64);return sb}wOj(){return!(2===this.application&&P.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get uub(){return P.AFrameworkApplication.sB}get Nzb(){return P.AFrameworkApplication.V6a}get Pef(){return""}get sod(){return""}get Cdg(){return P.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get XCc(){return this.ghe||(this.ghe=W.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.dZd||this.VDh()}Ddb(){this.zOj||this.mEh()}iTf(sb){this.k1j&&U.a.$g?new ka(this):
this.C5b(sb)}C5b(sb){const bb=({sCa:sb}=this.Txi(sb)).returnValue;h.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===bb,sb);return bb}AHa(sb,bb,Ob,gc,mb,Nb){this.xWa=sb;this.a$d=bb;this.vga=Nb;this.application=Ob;this.pC=gc;P.AFrameworkApplication.downloadCopyOnOpenInClient?this.Mqf():P.AFrameworkApplication.limitedEdit&&!P.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?P.AFrameworkApplication.S$f():this.GVg(mb)}get oMi(){return!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}gSa(){this.oMi&&this.NAi();return this.C5b(this.akb)}o3f(){const sb=new pa.a(ya.a.openInClient);sb.Values["ui-language"]=P.AFrameworkApplication.lcid.toString();sb.Values[La.a.d8c]=P.AFrameworkApplication.userSessionId;return this.vga.value.send(sb)?32:8}NAi(){Mb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Na.a,{inStaging:!0}))}zuj(sb){const bb=new pa.a(ya.a.c4j);bb.Values["ui-language"]=P.AFrameworkApplication.lcid.toString();
bb.Values[La.a.d8c]=P.AFrameworkApplication.userSessionId;bb.Values[Ma.a.b4j]=sb;this.vga.value.send(bb)}Txi(sb){this.akb=sb;this.zuj(5===this.pC?kb.V0i:kb.X0i);return 5===this.pC?this.Sxi():this.Xxi()}Sxi(){this.Uqf();return{returnValue:32,sCa:"HostEditUrl,"}}Xxi(){let sb;var bb=sb="";P.AFrameworkApplication.hre&&(bb="|f|"+P.AFrameworkApplication.userSessionId);const Ob=P.AFrameworkApplication.fa.qa("IsAssignmentMode")&&P.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
P.AFrameworkApplication.isUnifiedHostMode||U.a.Vxa,gc=P.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),mb=P.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(P.AFrameworkApplication.ub.Doc){var Nb=P.AFrameworkApplication.ub.n_(3588168074);Nb&&this.zzc(Nb.epochClickTime,Nb.sessionOrigin,Nb.correlationId);this.Ysf()}if(P.AFrameworkApplication.FOf){sb+="NewOrder,";Nb=8;this.vga&&this.vga.value&&this.vga.value.isEnabled()&&P.AFrameworkApplication.M2d&&(sb+="Post,",Nb=this.o3f());if(32===
Nb)return{returnValue:Nb,sCa:sb};h.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return P.AFrameworkApplication.sm.Wab?(h.ULS.shipAssertTag(5566816,211,!!P.AFrameworkApplication.sm.Wab),sb+="HostUrl,",{returnValue:P.AFrameworkApplication.ta.F$a(P.AFrameworkApplication.sm.Wab),sCa:sb}):this.xWa?(h.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",P.AFrameworkApplication.userSessionId),sb+="DocUrl,",Ab.L$c(this.xWa,this.pC,
this.options,this.application,Object(L.a)(this,this.lDf,"onEditInClientSuccess"),Object(L.a)(this,this.kDf,"onEditInClientFailure"),this.zag,P.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),bb,Ob,gc,mb,this.MYb,this.tE,this.vTb,P.AFrameworkApplication.ub.Doc),{returnValue:32,sCa:sb}):{returnValue:8,sCa:sb}}sb+="OldOrder,";if(!this.xWa&&P.AFrameworkApplication.sm.Wab)return this.vga&&this.vga.value&&this.vga.value.isEnabled()&&P.AFrameworkApplication.M2d?(sb+="Post,",bb=this.o3f()):(h.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),bb=8),32!==bb?(h.ULS.shipAssertTag(22595484,211,!!P.AFrameworkApplication.sm.Wab),sb+="HostUrl,",{returnValue:P.AFrameworkApplication.ta.F$a(P.AFrameworkApplication.sm.Wab),sCa:sb}):{returnValue:bb,sCa:sb};h.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",P.AFrameworkApplication.userSessionId);sb+="DocUrl,";Ab.L$c(this.xWa,this.pC,this.options,this.application,Object(L.a)(this,this.lDf,"onEditInClientSuccess"),
Object(L.a)(this,this.kDf,"onEditInClientFailure"),this.zag,P.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),bb,Ob,gc,mb,this.MYb,this.tE,this.vTb,P.AFrameworkApplication.ub.Doc);return{returnValue:32,sCa:sb}}uYf(sb){P.AFrameworkApplication.Un.setDw(8981,sb)}lDf(sb){this.uYf(sb);h.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===sb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Cdg||this.Uqf(),this.Ysf()):this.dZd||this.closeApplication()}kDf(sb,bb=0){h.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",sb,bb);if(5===sb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const Ob=!!this.a$d&&!this.akb;let gc=0;1===sb&&(gc=2);6<=sb&&13>=sb&&(gc=1,1===bb&&(this.dZd=!0));this.XCc.cMi?(h.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",gc),ia.a.instance.ifh(this.akb?Object(L.a)(this,this.Xzf,"oicErrorDialogHandlerCloseForced"):Object(L.a)(this,this.Yzf,"oicErrorDialogHandlerNoCloseForced"),
Ob?Object(L.a)(this,this.LFf,"onLaunchDownload"):null,this.rNe(!1)?Object(L.a)(this,this.cdi,"iHaveOfficeButtonHandler"):null,gc,bb)):(h.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",gc),ia.a.instance.gfh(this.akb?Object(L.a)(this,this.Xzf,"oicErrorDialogHandlerCloseForced"):Object(L.a)(this,this.Yzf,"oicErrorDialogHandlerNoCloseForced"),Ob?Object(L.a)(this,this.LFf,"onLaunchDownload"):null,gc))}}Ysf(){try{const sb=[Object.assign(new Ea.a,{name:"CorrelationId",string:this.tE}),
Object.assign(new Ea.a,{name:"SessionOrigin",string:this.MYb}),Object.assign(new Ea.a,{name:"ClickTime",string:this.vTb}),Object.assign(new Ea.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];pb.a("OpenInClientCompleted",!0,0,sb)}catch(sb){h.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+sb.toString())}}Uqf(){P.AFrameworkApplication.ta&&P.AFrameworkApplication.ta.Pa.Lv&&P.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new ib(this):new Ua(this)}Xzf(){this.closeApplication()}Yzf(){this.Ddb()}LFf(){this.Mqf()}cdi(){return this.rNe(!0)}rNe(sb){const bb=
(U.a.Ikf||U.a.aI)&&!!P.AFrameworkApplication.P8b;bb&&sb&&(v.a.kf(P.AFrameworkApplication.P8b,"_blank",void 0,"OpenInClient"),this.closeApplication());return bb}}kb.X0i="OpenInDesktop";kb.V0i="OpenInBrowser";Object(b.a)(kb,"AOpenInClientOperation",null,[]);var lb=a(5),oa=a(203),Ba=a(76),sa=a(59),qb=a(328),Jb=a(47),Yb=a(46),jb=a(192),ab=a(92),vb=a(29),Da=a(11),Fa=a(21),nb=a(478),Ta=a(251),V=a(254),va=a(150),wb=a(589);class fc extends kb{constructor(sb,bb,Ob){super(!0);this.Qa=new Ca.a;this.j$c=this.x_e=
!1;this.D5b=this.Rm=this.bFe=null;this.Tc=()=>{u.a.xg(D.a(this.$).hd.activityState,T.a.TCd)||this.mva.reset()};this.uQi=gc=>{this.uYf(gc)};this.tQi=()=>{this.jHj()};this.$=sb;this.ea=sb.ea;this.wK=bb;this.businessBar=Ob;this.ea.Xj(this.Tc);this.mva=M.Exe(this.$);this.T8g();sb.da.Ga(55,this);this.Pga=W.a.instance.Rb("Common.ISystemInitiatedFeedback")}get Pef(){return"EditInExcelWebApp_32x32x32"}get ka(){this.Rm=this.Rm||new jb.a;return this.Rm.token}get sod(){return"excel32"}get Cdg(){return this.ea.dc.inWebPart}j8g(){this.iTf(this.x_e)}n$g(){const sb=
this.$;d.TaskExtensions.za(this.wK.value,bb=>{this.AHa(sb.workbookContext.ClientUrl,P.AFrameworkApplication.LZ,1,sb.isEditMode?2:0,!0,new Q.a(()=>bb.result))},this.ka,3)}Jld(){0!==sa.a.Ag.editMode&&(this.$.rb.Mv=!1)}Iaf(){const sb={};sb[lb.a.Lac]=!1;sb[lb.a.LQ]="OpenInExcel";this.$.Xc(802602464,Ba.a.Db,8,sb)}I5c(){if(this.ea.Zb){var sb=this.$;sb.isEditMode&&d.TaskExtensions.za(this.wK.value,bb=>{this.AHa(sb.workbookContext.ClientUrl,P.AFrameworkApplication.LZ,1,2,!1,new Q.a(()=>bb.result))},this.ka,
3)}}nHe(){this.ea.Zb&&d.TaskExtensions.za(this.wK.value,sb=>{this.AHa(this.$.workbookContext.ClientUrl,P.AFrameworkApplication.LZ,1,this.$.isEditMode?2:0,!1,new Q.a(()=>sb.result))},this.ka,3)}zzc(sb){super.zzc(sb)}openInExcelClient(){this.ea.Zb&&(this.$.isEditMode||d.TaskExtensions.za(this.wK.value,sb=>{this.AHa(this.$.workbookContext.ClientUrl,P.AFrameworkApplication.LZ,1,0,!1,new Q.a(()=>sb.result))},this.ka,3))}openInBrowser(){this.ea.Zb&&d.TaskExtensions.za(this.wK.value,sb=>{this.AHa(this.$.workbookContext.ClientUrl,
P.AFrameworkApplication.LZ,1,5,!1,new Q.a(()=>sb.result))},this.ka,3)}downloadFile(sb){const bb=this.aAe(sb);this.mva.downloadFile(bb,sb);this.pBi()}pBi(){P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.Pga&&this.Pga.execute(sb=>sb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}xLf(sb,bb=0){if(this.ea.Zb){var Ob=this.$;D.a(Ob).mNa?this.yLf(sb,Ob):0<bb?this.rMj(sb,
Ob,bb):this.J9f(Ob)}}AHa(sb,bb,Ob,gc,mb,Nb){this.$.rb.Mv=!this.$.dc.inWebPart;this.x_e=mb;this.D5b=null;this.j$c=!1;this.LVg(sb,bb,gc,mb,Nb)}C5b(sb){const bb=this.$.dc;h.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${bb.inEmbedView}, InWebPart:${bb.inWebPart}, DivSyndicated:${bb.isDivSyndicated}, Mode:${this.$.isEditMode?oa.a.edit:oa.a.view}`);return fc.slf()?(this.e5b(),Ab.L$c(this.xWa,this.pC,this.options,1,this.uQi,this.tQi,!1,P.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),
32):super.C5b(sb)}VDh(){this.AZf();const sb=this.$;if(!this.ea.dc.inWebPart&&this.ea.Zb&&!sb.isEditMode){const bb=new ab.a(2145659238,Ba.a.Db,this.$.Hc,0,null);this.bFe=Jb.a.instance.create(()=>{sb.Ka.Lb(bb)},0,Yb.a.Y0i)}}dispose(){this.ea&&this.ea.tk(this.Tc);m.a.rc([this.Qa,this.bFe,this.Rm]);this.$=this.ea=null}mEh(){this.AZf()}Mqf(){Jb.a.instance.create(()=>{this.$.Ka.Lb(new ab.a(-2028960985,Ba.a.Db,0,30,null))},0,Yb.a.Z0i,!0,!0)}GVg(sb){const bb=this.$,Ob=D.a(this.$).hd.activityState;Ob[nb.a.tpe]=
!0;bb.isEditMode&&this.ea.Zb?(this.e5b(),z.a(bb).Ns(new Ta.a(A.a.ky,5,()=>{bb.DI(!1);Ob[V.a.Jq]=A.a.g5b;Ob[nb.a.NHg]=sb;Ob[T.a.ced]=!0;bb.isEditMode&&(Ob[T.a.VT]=1,Ob[T.a.PY]=!0,Ob[va.a.b0b]=!0,Ob[va.a.$Wc]=!0);Ob[nb.a.wpe]=1455037301}))):this.iTf(sb)}xbg(){const sb=P.AFrameworkApplication.LZ;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.F$a(sb,!0)){const bb=this.$.ea.dc;h.ULS.sendTraceTag(537154773,0,50,`Url:[${sb}] IsEmbedded:[${bb.inEmbedView}] InWebPart:[${bb.inWebPart}] DivSyndicated:[${bb.isDivSyndicated}], Mode:[${this.$.isEditMode?
oa.a.edit:oa.a.view}]`)}}else this.mva.downloadFile(sb,-2028960985);this.j$c=!0;this.e5b()}ryi(){this.XCc.Bzf&&this.XCc.imc(1)}syi(){this.XCc.Bzf&&Da.HelperMethods.kf(aa.a.g_(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}zyi(){Da.HelperMethods.kf(aa.a.g_(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}Ayi(){Da.HelperMethods.kf(aa.a.g_(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}aAe(sb){const bb=new Sys.StringBuilder,Ob=this.$.workbookContext,
gc=this.$.ya;bb.append(this.$.Yna);bb.append(gc.FileHandlerRelativeUri);bb.append("?id=");bb.append(encodeURIComponent(x.a.rKb(Ob.WorkbookUri,"sc")));this.$.ea.Zb&&(bb.append("&sessionId="),bb.append(encodeURIComponent(this.$.ea.sessionId)));switch(sb){case -974518828:bb.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:bb.append("&workbookType=FullWorkbook");break;case -1059172980:bb.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:bb.clear()}sb=!(this.$.isChangeGateEnabled("OfficeVSO:7396073_ShortenUrlToPreventOdsFailure")&&
-1059172980===sb);r.a.Cpb(bb,gc,sb);return bb.toString()}T8g(){fa.a.instance.c4g();const sb=this.$.ya;MSOJS.ClientUtils.InitUrls(sb.RoamingAppsX86RootUrl,sb.RoamingAppsControlInstallerUrl,sb.RoamingAppsFirefoxExtensionUrl)}AZf(){const sb=this.$;this.ea.Zb||qb.a.RJd(sb,D.a(sb).hd);this.e5b();this.D5b&&this.D5b(this,this.j$c);sb.frame.$t.rm(this.$.frame.gba());sb.frame.IX.rm(this.$.frame.gba());sb.rb.Mv=!1;Fa.h(sb).focus()}LVg(sb,bb,Ob,gc,mb){const Nb=this.$;P.AFrameworkApplication.ta&&!fc.slf()&&(Nb.frame.$t.Cn(Nb.frame.gba()),
Nb.frame.IX.Cn(Nb.frame.gba()));super.AHa(sb,bb,1,Ob,gc,mb)}e5b(){const sb=this.$;D.a(sb).gi.activityName===A.a.openInExcelClient&&D.a(sb).hd.XM()}jHj(){const sb=vb.a.dd(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");z.a(this.$).Qr([sb])}rMj(sb,bb,Ob){let gc=null;const mb=window.setTimeout(()=>{D.a(bb).zvc(gc);this.J9f(bb)},Ob);gc=()=>{D.a(bb).mNa&&(D.a(bb).zvc(gc),window.clearTimeout(mb),this.yLf(sb,bb))};D.a(bb).bYc(gc)}J9f(sb){const bb=vb.a.dd(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");
z.a(sb).Qr([bb])}yLf(sb,bb){z.a(bb).Ns(new Ta.a(A.a.ky,5,()=>{bb.DI(!1);const Ob=D.a(bb).hd,gc=Ob.activityState;gc[V.a.Jq]=A.a.QOe;gc[wb.a.d0b]=bb.ea.dc.hasUnsupportedFeaturesForEdit;gc[I.a.UWc]=sb;Ob.qr(vb.a.x4(this.businessBar.X$c,[1437034227]))}))}static slf(){return 1<sa.a.getRegisteredEwaInstances().length}}Object(b.a)(fc,"OpenInExcelOperation",kb,[652,3]);class Fc extends e.a{constructor(sb){super();this.$=sb;this.Fb();Fc.S8g()}create(){if(this.$.da.Aa(55))this.ob(this.$.da.Aa(55));else{var sb=
f.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),bb=f.GetServiceTaskFactory.Na(this.$.da,5,4,this.Ya);d.TaskExtensions.za(S.Task.jJ(sb,bb),()=>{this.ob(new fc(this.$,new Q.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Ya)),bb.result))},this.ka,3)}}static S8g(){Fc.$zf||(Fc.$zf=!0,(new Aa).Oh(W.a.instance),W.a.instance.resolve("Common.IOfficeTrialExperience").Hg(),W.a.instance.resolve("Common.IMacOfficeOffer").Hg())}}Fc.$zf=!1;Object(b.a)(Fc,"OpenInClientFactory",e.a,
[]);var Qa=a(114),la=a(390);class hb extends Qa.a{constructor(sb,bb){super(sb,bb)}execute(sb){const bb=Object(l.a)(7,sb.Fe);d.TaskExtensions.za(f.GetServiceTaskFactory.create(bb.da,56,bb.ka,0),Ob=>{bb.downloadCopyOnOpenInClient?(sb.activityState[la.a.upe]=!0,Ob.result.xbg()):Ob.result.n$g()},bb.ka,3);return 1}}Object(b.a)(hb,"OpenInExcelClientActivity",Qa.a,[]);class Kb extends e.a{constructor(sb){super();this.$=sb;sb.da.Ga(56,new Fc(sb));this.Fb()}create(){d.TaskExtensions.za(f.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.Ya),()=>{this.ob(new hb(A.a.openInExcelClient,A.a.idle))},this.ka)}}Object(b.a)(Kb,"OpenInExcelClientActivityFactory",e.a,[]);a.d(E,"a",function(){return dc});const dc=()=>{c.a.Fa(sb=>{sb.da.Ga(57,new Kb(sb));sb.da.Ga(60,new J(sb));sb.da.Ga(63,new G(sb))})}},1151:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(85),e=a(4),f=a(108),d=a(14),h=a(89),m=a(54),l=a(30),w=a(27),n=a(12),x=a(238),r=a(1058),u=a(5),v=a(260),B=a(1059),z=a(708),A=a(1264),y=a(92);class D extends z.a{constructor(xb,
pa,Ma){super(xb,pa);this.zs=!0;this.command=Ma}Ym(xb){super.Ym(xb);this.businessBar.$.Ka.Lb(new y.a(this.command,xb,this.businessBar.$.Hc,10,null))}}Object(t.a)(D,"CommandActionBusinessBarEntry",z.a,[]);class I extends D{constructor(xb,pa,Ma){super(xb,pa,Ma)}KD(xb){super.KD(xb)}}Object(t.a)(I,"EditAttemptReadOnlyBusinessBarEntry",D,[]);var M=a(44);class T extends z.a{constructor(xb,pa,Ma,ya){super(xb,pa);this.error=Ma;this.options=ya;this.error&&this.options&2&&(this.message=this.error.Description);
this.error&&this.options&1&&(this.title=this.error.Caption);this.zs=!(ya&4)}Ym(xb){super.Ym(xb);this.error.Appearance&=-33;M.a(this.businessBar.$).Qr([this.error])}}Object(t.a)(T,"ErrorBusinessBarEntry",z.a,[]);class S extends T{constructor(xb,pa,Ma,ya,Ea){super(xb,pa,Ma,ya);this.command=Ea;this.GV=!0}oW(xb){super.oW(xb);this.businessBar.$.Ka.Lb(new y.a(this.command,xb,this.businessBar.$.Hc,10,null))}}Object(t.a)(S,"ErrorAndCommandBusinessBarEntry",T,[]);var H=a(13);class C{constructor(xb,pa,Ma,ya,
Ea,Na,kb,lb,oa){this.wJ=this.C8=this.yP=0;this.Ttg=xb;this.IRj=pa;this.xJ=Ma;this.hyg=kb;this.mkb=l.a.sw(oa);this.kwg=oa;this.l7d=lb;0!==ya&&(this.yP=ya);0!==Ea&&(this.C8=Ea);0!==Na&&(this.wJ=Na)}get title(){return C.ga(this.IRj)}get message(){return C.ga(this.xJ)}get messageId(){return this.xJ}get H0a(){return this.Ttg}get actionButton(){return C.ga(this.yP)}get Esa(){return C.ga(this.C8)}get link(){return C.ga(this.wJ)}get Ek(){return this.hyg}get businessBarType(){return this.l7d}get hash(){return this.mkb}get alt(){const {BusinessBarControl:xb}=
a(1151);switch(this.Ek){case xb.ija:return C.ga(26);case xb.qA:return C.ga(25);case xb.Di:return C.ga(24);default:return C.ga(0)}}get Rad(){return this.kwg}set businessBarType(xb){this.l7d=xb}static ga(xb){return H.a.instance.ga(xb)}}Object(t.a)(C,"EwaBusinessBarEntry",null,[]);class G extends C{constructor(xb,pa,Ma,ya,Ea,Na,kb,lb){super(xb,0,pa,Ma,ya,Ea,Na,kb,lb)}get title(){return""}}Object(t.a)(G,"EwaNoTitleBusinessBarEntry",C,[]);var J=a(71);class L extends z.a{constructor(xb,pa){super(xb,pa);
this.GV=this.zs=!0}Ym(xb){super.Ym(xb);this.set_visible(!1);this.businessBar.$.GI();this.businessBar.$.Ka.Lb(new y.a(1038998010,xb,this.businessBar.$.Hc,10,null))}oW(xb){super.oW(xb);this.businessBar.$.Ka.Lb(new y.a(-722953877,xb,this.businessBar.$.Hc,10,null))}KD(xb){this.businessBar.removeEntry(55);J.g(xb)}}Object(t.a)(L,"ExternalLinksEnableContentBusinessBarEntry",z.a,[]);class P extends z.a{constructor(xb,pa){super(xb,pa);this.zs=!0;this.GV=!1}Ym(xb){super.Ym(xb);this.businessBar.$.Ka.Lb(new y.a(-722953877,
xb,this.businessBar.$.Hc,10,null))}KD(xb){this.businessBar.removeEntry(5);J.g(xb)}}Object(t.a)(P,"ExternalLinksShowErrorBusinessBarEntry",z.a,[]);var aa=a(11);class U extends z.a{constructor(xb,pa,Ma){super(xb,pa);this.nzb=Ma;this.zs=!0}Ym(xb){super.Ym(xb);aa.HelperMethods.vW(this.businessBar.$.GG,this.nzb,this.businessBar.$.WS)}}Object(t.a)(U,"HelpButtonBusinessBarEntry",z.a,[]);class K extends z.a{constructor(xb,pa,Ma){super(xb,pa);this.nzb=Ma;this.Iwa=!0}Mma(xb){super.Mma(xb);aa.HelperMethods.vW(this.businessBar.$.GG,
this.nzb,this.businessBar.$.WS)}}Object(t.a)(K,"HelpTextBusinessBarEntry",z.a,[]);var Y=a(76);class na extends z.a{constructor(xb,pa,Ma,ya){super(xb,pa);this.nzb=Ma;this.command=ya;this.Iwa=!0;this.zs=1461300262!==ya}Ym(xb){super.Ym(xb);this.businessBar.$.Ka.Lb(new y.a(this.command,xb,this.businessBar.$.Hc,10,null))}Mma(xb){super.Mma(xb);const pa=new y.a(-859308420,xb,this.businessBar.$.Hc,12,null);this.businessBar.$.Ka.Lb(pa,{[Y.a.ng]:"HelpID="+this.nzb,["InputMethod"]:xb,[Y.a.Kc]:u.a.IV,[u.a.Roa]:!0})}}
Object(t.a)(na,"HelpTextTaskPaneAndCommandBusinessBarEntry",z.a,[]);class W extends z.a{constructor(xb,pa){super(xb,pa);this.GV=this.zs=!0}Ym(xb){super.Ym(xb);this.set_visible(!1);this.businessBar.$.GI();this.businessBar.$.Ka.Lb(new y.a(-1081442996,xb,this.businessBar.$.Hc,10,null))}oW(xb){super.oW(xb);this.businessBar.$.Ka.Lb(new y.a(1702917262,xb,this.businessBar.$.Hc,10,null))}KD(xb){this.businessBar.removeEntry(59);J.g(xb)}}Object(t.a)(W,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",z.a,
[]);var X=a(1061);class Aa extends z.a{constructor(xb,pa){super(xb,pa);(this.policyManager=xb.$.da.Aa(274))?(this.message=this.policyManager.Xsc,this.title=this.policyManager.title,this.Iwa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}Mma(xb){super.Mma(xb);(xb=this.policyManager.fVi)&&xb(null)}}Object(t.a)(Aa,"PolicyBusinessBarEntry",z.a,[]);var Q=a(1060),fa=a(1063),
Ca=a(1062);a(421);var ia=a(145),Ra=a(25);class Ya extends z.a{constructor(xb,pa){super(xb,pa);this.zs=!0;this.title=""}Ym(xb){super.Ym(xb);ia.c(Ra.a.XJi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(t.a)(Ya,"UnsupportedBrowserBusinessBarEntry",z.a,[]);var Ga=a(1057),da=a(1289);class Z extends z.a{constructor(xb,pa){super(xb,pa);this.cDa=da.a.g7b();this.zs=!0;this.GV=this.cDa.r1j;this.title=this.cDa.title;this.message=this.cDa.message}get actionButton(){return this.cDa.qAe}get Esa(){return this.cDa.sAe}Ym(xb){super.Ym(xb);
this.cDa.hBf(null)}oW(xb){super.oW(xb);this.cDa.kBf(null)}KD(xb){super.KD(xb);this.cDa.KNe(null)}}Object(t.a)(Z,"WildFireMobileAppBusinessBarEntry",z.a,[]);var ha=a(248),Wa=a(22),ca=a(215),ja=a(159),ua=a(42),Za=a(7),Pa=a(171),ka=a(1064),ra=a(72),ba=a(131),Ua=a(223),Ka=a(1);class Oa extends z.a{constructor(xb,pa,Ma,ya){super(xb,pa);Ka.EwaSettings.getBooleanFeatureGate(Ua.a.cB,!1)?(this.officeScriptsCommandManager=Ma.da.Aa(519),c.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager)):(this.automateCommandManager=
Ma.da.Aa(352),c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager));this.id=Pa.a.create();this.$=Ma;this.title=H.a.instance.ga(2276);this.message="";this.nYd=H.a.instance.ga(2272);this.Vmg=H.a.instance.ga(2273);this.Tmg=H.a.instance.ga(2274);this.XGe=H.a.instance.ga(2275);this.update(ya)}update(xb){this.scriptLink=xb.scriptLink;this.runStatus=xb.runStatus;this.buttonText=xb.buttonText||"";this.PAi(xb.clickId);this.jnj();"preparing"===this.runStatus?(this.coa(0),this.message=String.format(H.a.instance.mb(208),
this.buttonText),this.zs=!0,this.fsa=this.nYd,this.dsb=this.eha=this.Mab):"running"===this.runStatus?(this.coa(0),this.message=String.format(H.a.instance.mb(207),this.buttonText),this.zs=!0,this.fsa=this.nYd,this.dsb=this.eha=this.Mab):"succeeded"===this.runStatus?(this.coa(0),this.message=String.format(H.a.instance.mb(210),this.buttonText),"true"===xb.hasLogs?(this.zs=!0,this.fsa=this.Tmg,this.eha=this.VKf,this.GV=!0,this.nZc=this.Vmg,this.oZc=this.WKf):(this.zs=!0,this.fsa=this.Vmg,this.eha=this.WKf)):
"runFailed"===this.runStatus?(this.coa(1),this.message=String.format(H.a.instance.mb(209),this.buttonText),this.O6a=Qb.ija,"true"===xb.hasLogs?(this.zs=!0,this.fsa=this.Tmg,this.eha=this.VKf,"false"===xb.isOwner&&(this.GV=!0,this.nZc=this.XGe,this.oZc=this.mCf)):"false"===xb.isOwner&&(this.zs=!0,this.fsa=this.XGe,this.eha=this.mCf)):"fetchFailed"===this.runStatus?(this.coa(1),this.O6a=Qb.ija,this.message=String.format(H.a.instance.mb(211),this.buttonText)):"canceled"===this.runStatus?(this.coa(0),
this.O6a=Qb.qA,this.message=String.format(H.a.instance.mb(213),this.buttonText)):"alreadyRunning"===this.runStatus?(this.coa(5),this.O6a=Qb.qA,this.message=String.format(H.a.instance.mb(212),this.buttonText),this.zs=!0,this.fsa=this.nYd,this.dsb=this.eha=this.Mab):"initializing"===this.runStatus&&(this.coa(0),this.O6a=Qb.Di,this.message=H.a.instance.ga(2277))}get Ek(){return this.O6a}get actionButton(){return this.fsa}get Esa(){return this.nZc}Ym(xb){super.Ym(xb);this.eha&&this.eha()}oW(xb){super.oW(xb);
this.Esa&&this.oZc()}KD(xb){super.KD(xb);this.dsb&&this.dsb()}jnj(){this.message="";this.O6a=Qb.Di;this.zs=!1;this.fsa="";this.eha=void 0;this.GV=!1;this.nZc="";this.oZc=void 0;this.hideCloseButton=!1;this.dsb=void 0}Mab(){const xb=Pa.a.create().toString();Ka.EwaSettings.getBooleanFeatureGate(Ua.a.cB,!1)?this.officeScriptsCommandManager.Cld(xb):this.automateCommandManager.Cld(xb);this.Imc(-2186799,xb)}VKf(){const xb=Pa.a.create().toString();Ka.EwaSettings.getBooleanFeatureGate(Ua.a.cB,!1)?this.officeScriptsCommandManager.Bld(xb):
this.automateCommandManager.Bld(xb);this.Imc(1036446140,xb)}WKf(){const xb=Pa.a.create();if(this.scriptLink){const pa=new ka.b(this.scriptLink);Ka.EwaSettings.getBooleanFeatureGate(Ua.a.cB,!1)?this.officeScriptsCommandManager.Hyb(this.id.toString(),JSON.stringify(pa),xb):this.automateCommandManager.Hyb(this.id.toString(),JSON.stringify(pa),xb)}this.Imc(-585097204,xb.toString())}mCf(){const xb=Pa.a.create().toString();Ka.EwaSettings.getBooleanFeatureGate(Ua.a.cB,!1)?this.officeScriptsCommandManager.Ald(xb):
this.automateCommandManager.Ald(xb);this.Imc(-639858579,xb)}PAi(xb){const pa=[];pa.push(Object(Za.a)(new ra.a,{name:"id",string:this.id.toString()}));pa.push(Object(Za.a)(new ra.a,{name:"hasScriptLink",bool:!!this.scriptLink}));pa.push(Object(Za.a)(new ra.a,{name:"runStatus",string:this.runStatus}));pa.push(Object(Za.a)(new ra.a,{name:"clickId",string:xb}));pa.push(Object(Za.a)(new ra.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ia.a(ba.a.hMi,void 0,void 0,pa)}Imc(xb,pa){const Ma=
[];Ma.push(Object(Za.a)(new ra.a,{name:"id",string:this.id.toString()}));Ma.push(Object(Za.a)(new ra.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Ma.push(Object(Za.a)(new ra.a,{name:"runStatus",string:this.runStatus}));Ma.push(Object(Za.a)(new ra.a,{name:"clickId",string:pa}));ia.d(xb,void 0,void 0,void 0,void 0,void 0,Ma)}}Object(t.a)(Oa,"OfficeScriptsRunStatusBusinessBarEntry",z.a,[]);var ib=a(47);class La extends D{constructor(xb,pa,Ma,ya,Ea,Na){super(xb,pa,Ma);ib.a.instance.create(()=>{this.showCallout(pa,
ya)},Ea,Na,!0,!0)}showCallout(xb,pa){if(this.businessBar&&this.businessBar.qla(xb.H0a)&&this.lue()){xb=new y.a(-847286761,0,this.businessBar.$.Hc,0,null);var Ma={};Ma.CalloutName=pa;Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Ma.Target=this.rK():Ma.Target=Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.yP.domElement;this.businessBar.$.Ka.Lb(xb,Ma)}}lue(){return!0}}
Object(t.a)(La,"CalloutBusinessBarEntry",D,[]);class db extends La{constructor(xb,pa,Ma,ya,Ea,Na){super(xb,pa,Ma,ya,Ea,Na)}lue(){if(!Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const xb=this.businessBar.$.da.Aa(465);return xb&&xb.Hxc?!1:!0}}Object(t.a)(db,"OptimizeWorkbookCalloutBusinessBarEntry",La,[]);var Ab=a(19);class Mb extends z.a{constructor(xb,pa,Ma){super(xb,pa);this.update(Ma)}update(xb){this.title=
xb.title?xb.title:"";this.message=xb.message?xb.message:"";this.coa(this.bah(xb.businessBarType));this.hideCloseButton=!!xb.hideCloseButton}bah(xb){switch(xb){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(t.a)(Mb,"MsFormsDataSyncStatusBusinessBarEntry",z.a,[]);class pb extends z.a{constructor(xb,pa,Ma,ya){super(xb,pa);this.GV=this.zs=!0;this.F7i=Ma;this.gRg=ya}Ym(xb){super.Ym(xb);this.businessBar.$.Ka.Lb(new y.a(this.F7i,
xb,this.businessBar.$.Hc,10,null))}oW(xb){super.Ym(xb);this.businessBar.$.Ka.Lb(new y.a(this.gRg,xb,this.businessBar.$.Hc,10,null))}}Object(t.a)(pb,"DualCommandActionsBusinessBarEntry",z.a,[]);a.d(E,"BusinessBarControl",function(){return Qb});class Qb extends x.a{constructor(xb,pa){super(pa);this.AJh=n.DOMElementExtensions.Fr+",div";this.xQ=Array(70);this.Km=!1;this.sW=Ma=>{if(Ma.Ca.keyCode===b.a.$y){var ya=this.mc.querySelectorAll(this.AJh);const Ea=n.DOMElementExtensions.um(ya);ya=n.DOMElementExtensions.mB(ya);
return n.DOMElementExtensions.nBa(Ma.Ca,Ea,ya)}return!1};this.jb=xb;this.set_visible(!1);this.addCssClass(r.a.zuh);Ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&e.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&this.addCssClass(r.a.Buh);f.KeyInputManager.instance.sa(d.a.Pb,this.mc,this.sW);v.a(xb).di(this)}get he(){return ha.a.h1c}get mc(){return this.domElement}get Hf(){return this.get_visible()}get $(){return this.jb}kg(xb,pa){pa||n.DOMElementExtensions.setFocus(this.domElement.firstChild);
return!pa}nh(xb){return n.DOMElementExtensions.Af(this.mc,xb)}qj(){}dk(){}dispose(){this.Km||(f.KeyInputManager.instance.Ba(d.a.Pb,this.mc,this.sW),h.a.rc(this.xQ),this.xQ=Array(70),this.jb=null,super.dispose(),this.Km=!0)}qla(xb){if(!this.get_visible())return!1;xb=this.xQ[xb];return!!xb&&xb.isVisible}qgd(xb){return this.qla(xb)?this.xQ[xb].rK():null}qH(xb){return!!this.xQ[xb]}VQb(xb,pa){if(xb=this.xQ[xb])xb.update(pa),xb.hYj()}KE(xb,pa,Ma=null,ya=null){let Ea=!1;if(this.qH(xb))Ma=this.xQ[xb].get_visible();
else{this.set_visible(!0);const kb=Qb.n$e()[xb];this.xQ[xb]=this.iaa(xb,pa,Ma,ya);Ma=!1;Ea=!0;ya="";let lb=0;pa&&(ya=pa.MessageIdName,lb=pa.MessageId);const oa=kb.Rad;var Na=ua.PageLoadTrackingInfo.instance.nwa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${xb}, time from app interactive: ${Na}`);Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(Na=this.xQ.filter(Ba=>null!=Ba).length,1<Na&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${Na.toString()}`));
Ka.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===kb.businessBarType||ja.a(this.$).nOd(kb.hash,ya,lb,m.a.aEc,!0,1,pa,oa)}Ma||!A.a.Rec().includes(xb)&&!Ea||(this.xQ[xb].set_visible(!0),this.$.GI())}removeEntry(xb){return this.Jgj(xb)}rMd(){h.a.rc(this.xQ);this.xQ=Array(70);this.set_visible(!1)}Jgj(xb){if(!this.qH(xb))return!1;h.a.Ia(this.xQ[xb]);this.xQ[xb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.GI();return!0}iaa(xb,pa,Ma=null,
ya=null){const Ea=Qb.n$e()[xb],Na=!!(this.$.qd&64);switch(xb){case 2:case 4:case 23:case 25:case 26:case 36:case 35:xb=new z.a(this,Ea);break;case 12:case 29:case 30:case 31:case 32:case 57:xb=Na?new D(this,Ea,-8805455):new z.a(this,Ea);break;case 34:xb=Na?new pb(this,Ea,-8805455,-104572626):new z.a(this,Ea);break;case 22:xb=new I(this,Ea,-8805455);break;case 46:case 45:xb=Na?new S(this,Ea,pa,0,-8805455):new T(this,Ea,pa,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:xb=new T(this,Ea,
pa,0);break;case 19:xb=new z.a(this,Ea);break;case 47:xb=new T(this,Ea,pa,0);break;case 6:case 14:xb=new U(this,Ea,pa.HelpTopicId);break;case 67:case 65:xb=new K(this,Ea,pa.HelpTopicId);break;case 37:xb=new K(this,Ea,u.a.vjh);break;case 38:xb=new z.a(this,Ea);break;case 68:xb=new I(this,Ea,924877417);break;case 16:xb=new z.a(this,Ea);xb.title=l.a.rg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);xb.message=l.a.rg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:xb=
new D(this,Ea,-1762562205);xb.hideCloseButton=!0;break;case 20:xb=new Z(this,Ea);break;case 21:case 56:xb=new z.a(this,Ea);break;case 28:xb=new z.a(this,Ea);break;case 24:xb=new Ya(this,Ea);break;case 27:xb=new Aa(this,Ea);break;case 39:xb=new Ga.a(this,Ea);break;case 40:xb=new B.a(this,Ea);break;case 41:xb=new Q.a(this,Ea);break;case 42:xb=new X.a(this,Ea);break;case 48:xb=new z.a(this,Ea);break;case 49:xb=new z.a(this,Ea);break;case 50:xb=new z.a(this,Ea);break;case 51:xb=new z.a(this,Ea);break;
case 52:xb=new z.a(this,Ea);break;case 53:xb=new Ca.a(this,Ea);break;case 54:xb=new fa.a(this,Ea);break;case 55:xb=new L(this,Ea);break;case 5:xb=new P(this,Ea);break;case 58:xb=new D(this,Ea,-1753056834);pa?(pa=pa.Directive,Wa.a.Uq(pa)||"&nbsp;"===pa||(xb.message=pa)):Ma&&(xb.message=Ma);break;case 59:xb=new W(this,Ea);break;case 60:xb=new z.a(this,Ea);break;case 63:xb=new K(this,Ea,u.a.sLi);break;case 61:xb=new na(this,Ea,u.a.xVg,-8805455);break;case 66:xb=new na(this,Ea,u.a.acj,1461300262);break;
case 62:xb=new db(this,Ea,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");xb.message=Ma;break;case 64:xb=new Oa(this,Ea,this.$,ya);break;case 69:xb=new Mb(this,Ea,ya);break;default:xb=new T(this,Ea,pa,7)}xb.z6c();return xb}static n$e(){let xb;xb=ca.a.HNa()?261:260;return Qb.fAe||(Qb.fAe=[new C(0,276,277,278,0,0,Qb.ija,1,"BB_UnableToRefreshLock"),new C(1,276,277,278,0,0,Qb.ija,1,"BB_UnableToRefreshLockExpected"),new C(2,268,269,0,0,0,Qb.qA,5,"BB_WorkbookAlmostTooLarge"),
new C(3,270,271,272,0,0,Qb.ija,1,"BB_WorkbookTooLarge"),new C(4,259,xb,0,0,0,Qb.qA,5,"BB_ExternalWorkbookLinksDisabled"),new C(5,263,262,264,0,0,Qb.ija,1,"BB_ExternalWorkbookLinksShowError"),new C(6,265,266,267,0,0,Qb.Di,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new C(7,251,252,253,0,0,Qb.Di,5,"BB_UnsupportedFeatures"),new C(8,0,0,0,0,0,Qb.Di,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new C(9,0,0,0,0,0,Qb.Di,0,"BB_CollabDataStringsLocaleMismatch"),new C(10,0,0,0,0,0,Qb.Di,0,"BB_CollabDataLocaleMismatch"),
new C(11,279,280,281,0,0,Qb.ija,1,"BB_LastGenericStatusError"),new C(12,282,283,284,0,0,Qb.qA,5,"BB_ScratchPadWarning"),new C(13,285,286,287,0,0,Qb.ija,1,"BB_AuthenticationLost"),new C(14,288,289,290,0,0,Qb.qA,5,"BB_OdfCompatibilityIssues"),new C(15,0,575,0,0,0,Qb.qA,5,"BB_PivotChartInteractivityMissingWarning"),new C(16,0,0,0,0,0,Qb.Di,2,"BB_WorkbookIsIrmProtected"),new C(17,0,0,0,0,0,Qb.Di,0,"BB_BIFeatureNotAvailable"),new C(18,291,292,287,0,0,Qb.qA,5,"BB_AnonymousCreateMode"),new C(19,254,255,
0,0,0,Qb.qA,5,"BB_UnsupportedInteractiveReportEditing"),new C(20,0,0,0,0,0,Qb.Di,0,"BB_MobileAppCampaignBizBar"),new C(21,297,298,0,0,0,Qb.Di,0,"BB_TransientServerCommunicationFailures"),new C(22,1638,1649,1650,0,0,Qb.Di,5,"BB_EditAttemptInReadOnly"),new C(23,1638,1649,0,0,0,Qb.Di,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new C(24,0,aa.HelperMethods.CXj(),1627,0,0,Qb.Di,3,"BB_UnsupportedBrowser"),new C(25,300,301,0,0,0,Qb.Di,2,"BB_ReadOnlyPermissions"),new C(26,302,303,0,0,0,Qb.Di,2,"BB_DocumentIsIrmProtectedWarning"),
new C(27,0,0,0,0,0,Qb.qA,5,"BB_PolicyWarningMessage"),new C(28,1281,299,0,0,0,Qb.Di,0,"BB_WorkingOnIt"),new C(29,1638,1636,1637,0,0,Qb.Di,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new C(30,1651,1652,1653,0,0,Qb.Di,5,"BB_WorkbookIsReadOnlyRecommended"),new C(31,1638,1654,1655,0,0,Qb.Di,5,"BB_WorkbookHasPasswordToModify"),new C(32,1638,1656,1659,0,0,Qb.Di,3,"BB_LegacySharedWorkbookEditWarning"),new C(33,1646,1657,253,0,0,Qb.Di,5,"BB_LegacyConnectionsWarning"),new C(34,1638,1954,1955,1956,0,Qb.Di,
0,"BB_TooManyLoadBlockingFloatingObjects"),new C(35,1647,1648,0,0,0,Qb.Di,2,"BB_GroupedSlicers"),new C(36,313,314,0,0,0,Qb.qA,5,"BB_ThirdPartyAddinDisabled"),new C(37,1780,1781,0,0,1782,Qb.Di,5,"BB_FinanceLinkedEntityDisclaimerBar"),new C(38,1809,1810,0,0,0,Qb.qA,5,"BB_WolframDeprecationAlertBar"),new C(39,0,0,0,0,0,Qb.Di,0,"BB_WacGdprNotice"),new C(40,0,0,0,0,0,Qb.Di,0,"BB_AutomaticSensitivityLabel"),new C(41,0,0,0,0,0,Qb.Di,0,"BB_RecommendedSensitivityLabel"),new C(42,0,0,0,0,0,Qb.Di,0,"BB_MandatorySensitivityLabel"),
new C(43,315,316,317,0,0,Qb.Di,0,"BB_LocalStorageDisabled"),new C(44,632,633,0,0,0,Qb.Di,0,"BB_AutoRefreshDisabled"),new C(45,1011,1009,1013,1310,0,Qb.Di,4,"BB_CorruptedFileRepaired"),new C(46,1012,1010,1013,1310,0,Qb.Di,5,"CorruptedOdsFileRepaired"),new C(47,273,274,275,0,0,Qb.qA,5,"BB_MinorVersionLimitReached"),new C(48,304,305,0,0,0,Qb.qA,5,"BB_SensitivityApplicationGenericError"),new C(49,306,308,0,0,0,Qb.qA,5,"BB_SensitivityApplicationTooLargeFileError"),new C(50,307,308,0,0,0,Qb.qA,5,"BB_SensitivityApplicationLabelNotSupportedError"),
new C(51,309,310,0,0,0,Qb.qA,5,"BB_SensitivityApplicationLabelDisabledError"),new C(52,311,312,0,0,0,Qb.qA,5,"BB_SensitivityApplicationMandatoryConflictError"),new C(53,0,0,0,0,0,Qb.qA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new C(54,0,0,0,0,0,Qb.qA,5,"BB_SensitivityApplicationSetLabelError"),new C(55,2113,2114,2115,2118,0,Qb.Di,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new C(56,297,298,0,0,0,Qb.Di,0,"BB_NetworkDown"),new C(57,318,319,320,0,0,Qb.Di,2,"BB_DefaultToViewDueToCogs"),
new C(58,1806,1807,1808,0,0,Qb.Di,1,"BB_RefreshLinkedEntityErrorBar"),new C(59,1783,1784,1785,1786,0,Qb.Di,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new G(60,250,0,0,0,Qb.Di,5,"BB_CanvasHealth"),new C(61,1014,1015,1310,0,1016,Qb.Di,5,"BB_MismatchedFileFormatConverted"),new C(62,2232,0,2234,0,0,Qb.Di,5,"BB_OptimizeWorkbook"),new C(63,321,322,0,0,323,Qb.Di,0,"BB_NovModePostDepreciation"),new C(64,0,0,0,0,0,Qb.Di,0,"BB_OfficeScriptsRunning"),new C(65,2208,2209,0,0,2211,Qb.Di,0,"BB_PowerQueryRefreshDataSourceNotSupported"),
new C(66,324,325,0,0,326,Qb.Di,5,"BB_ReadOnlyPivotTable"),new C(67,2208,2210,0,0,2211,Qb.Di,0,"BB_PowerQueryRefreshHostNotSupported"),new C(68,1053,w.a.Mjc?1055:1054,1052,0,0,Qb.Di,4,"BB_RefreshPageAfterEnablingTheExtension"),new C(69,0,0,0,0,0,Qb.Di,0,"BB_MsFormsDataSyncStatus")])}}Qb.ija=Ab.a.oxh;Qb.qA=Ab.a.qxh;Qb.Di=Ab.a.pxh;Qb.fAe=null;Object(t.a)(Qb,"BusinessBarControl",x.a,[66])},1154:function(t,E,a){var c=a(9);t=a(0);var b=a(695),e=a(48),f=a(37),d=a(15),h=a(1073),m=a(148),l=a(24),w=a(76),n=
a(58);class x{constructor(kb){this.options=null;this.options=kb}}Object(t.a)(x,"MacroRecorderRangeCustomSortedPayload",null,[145]);var r=a(959),u=a(960),v=a(40),B=a(374),z=a(188),A=a(284),y=a(138),D=a(29),I=a(283),M=a(1),T=a(184),S=a(22),H=a(282),C=a(21),G=a(803),J=a(752),L=a(262),P=a(208),aa=a(13),U=a(133);class K{constructor(kb){this.zw=lb=>{switch(lb){case 0:this.WOa("Cancel");break;case 1:this.WOa("Expand and sort");this.uXe(!0);break;case 2:this.WOa("Just sort"),this.uXe(!1)}};this.uXe=kb}show(){const kb=
new U.StandardDialog;kb.Tb=11;kb.qc(1,aa.a.instance.ga(2120));kb.qc(2,aa.a.instance.ga(2121));kb.O$f(aa.a.instance.ga(2119),aa.a.instance.Ua(658),this.zw)}WOa(kb){d.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${kb}`)}}Object(t.a)(K,"ExpandSortSelectionDialog",null,[]);const Y=(kb,lb)=>{kb=kb.ColumnInfo;switch(lb){case 1:return kb.CellColors&&kb.CellColors.length?!0:(d.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case 2:return kb.TextColors&&kb.TextColors.length?!0:(d.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return kb.Icons&&kb.Icons.length?!0:(d.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return d.ULS.sendTraceTag(537151628,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},na=(kb,lb,oa,Ba)=>{kb=kb.HeaderColumnInfo;return Ba||kb?2===lb&&oa?kb.CellColors&&1!==kb.CellColors.length?(d.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):kb.TextColors&&1!==kb.TextColors.length?(d.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):kb.Icons&&1!==kb.Icons.length?(d.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:kb?(d.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${oa} == 0.`),!1):!0:!0};var W=a(187);class X{static isValid(kb){return X.CEh.includes(kb.Position)?
!0:(d.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${kb.Position}]`),!1)}}X.CEh=[0,.5,1];Object(t.a)(X,"FillGradientStopExtension",null,[]);class Aa{constructor(kb,lb,oa,Ba){new Sys.UI.Point(kb,lb);new Sys.UI.Point(oa,Ba)}}Object(t.a)(Aa,"GradientLine",null,[]);class Q{static isValid(kb){if(!(kb.Degree.toString()in Q.AEh))return d.ULS.shipAssertTag(537159829,0,!1,`FillGradientExtension.IsValid: unexpected degree value [${kb.Degree}]`),!1;if(!kb.GradientStops)return d.ULS.shipAssertTag(537159828,
0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(kb.GradientStops.length<Q.HHi||kb.GradientStops.length>Q.mGi)return d.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${kb.GradientStops.length}]`),!1;for(const lb of kb.GradientStops)if(!X.isValid(lb))return!1;return!0}}Q.HHi=2;Q.mGi=3;Q.AEh={["0"]:new Aa(0,0,1,0),["180"]:new Aa(1,0,0,0),["90"]:new Aa(0,0,0,1),["270"]:new Aa(0,1,0,0),["45"]:new Aa(0,0,1,1),["225"]:new Aa(1,1,0,0),
["135"]:new Aa(1,0,0,1),["315"]:new Aa(0,1,1,0)};Object(t.a)(Q,"FillGradientExtension",null,[]);const fa=kb=>kb.SortRange?4===kb.SortRangeType?(d.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${kb.SortRangeType}`),!1):2===kb.SortRangeType&&kb.SortTopToBottom&&(null==kb.HeaderRowSize||0>kb.HeaderRowSize)?(d.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),
!1):!0:(d.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),Ca=kb=>{if(!kb.SortConditions)return!0;for(const lb of kb.SortConditions){if(!Ra(kb,lb.RowColOffset))return d.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${lb.RowColOffset}] is out of bounds. sort range: ${kb.SortRange}`),!1;if(1===lb.SortConditionType&&lb.FillGradient&&!Q.isValid(lb.FillGradient))return d.ULS.sendTraceTag(537151619,0,
10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},ia=kb=>{if(!kb.SortColumnInfoItems)return d.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var lb=new W.a;for(var oa of kb.SortColumnInfoItems){if(!Ra(kb,oa.ColumnOffset))return d.ULS.sendTraceTag(537151617,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${oa.ColumnOffset}] is out of bounds. sort range: ${kb.SortRange}`),
!1;if(!oa.Name)return d.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${oa.ColumnOffset}]`),!1;if(oa.CellColors&&!oa.CellColors.length)return d.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${oa.CellColors.length}]`),!1;if(oa.TextColors&&!oa.TextColors.length)return d.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${oa.TextColors.length}]`),
!1;if(oa.Icons&&!oa.Icons.length)return d.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${oa.Icons.length}]`),!1;lb.add(oa.ColumnOffset)}if(kb.SortConditions)for(const Ba of kb.SortConditions)if(!lb.contains(Ba.RowColOffset))return d.ULS.shipAssertTag(537151584,0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${Ba.RowColOffset}]`),!1;if(kb.HeaderColumnInfoItems){if(kb.HeaderColumnInfoItems.length!==
kb.SortColumnInfoItems.length)return d.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(lb=0;lb<kb.HeaderColumnInfoItems.length;++lb){oa=kb.HeaderColumnInfoItems[lb];if(oa.ColumnOffset!==kb.SortColumnInfoItems[lb].ColumnOffset)return d.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;
if(oa.CellColors&&1<oa.CellColors.length)return d.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(oa.TextColors&&1<oa.TextColors.length)return d.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(oa.Icons&&1<oa.Icons.length)return d.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0},Ra=(kb,lb)=>{const oa=kb.SortRange;kb=kb.SortTopToBottom?oa.LastColumn-oa.FirstColumn:oa.LastRow-oa.FirstRow;return 0<=lb&&lb<=kb};var Ya=a(383),Ga=a(131),da=a(88),Z=a(132);class ha extends Ya.a{constructor(kb,lb){super(kb,lb);this.SEb=this.Kfd();this.Rr()}get pc(){return"SortMergedCellsErrorDialog"}bP(kb,lb){if(1===kb){var oa=v.v(this.SEb,this.$);C.h(this.$).gg(oa,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}oa={["DialogButton"]:kb,["Location"]:"dialog"};Z.b(this.$).vd(Ga.a.WKj,
oa,null,!0);super.bP(kb,lb)}Rr(){super.Rr();const kb=this.TKj();this.Tb=1;this.qc(1,aa.a.instance.ga(2239));this.$l(aa.a.instance.ga(2240),da.a.xf(kb),1,this.Z7)}TKj(){return String.format(aa.a.instance.mb(174),this.SEb.toString())}Kfd(){const kb=this.error.Description.split("_");return new l.Range(Number.parseInvariant(kb[1])+1,Number.parseInvariant(kb[2])+1,Number.parseInvariant(kb[3])+1,Number.parseInvariant(kb[4])+1,!0,!1)}}Object(t.a)(ha,"SortMergedCellsErrorDialog",Ya.a,[]);var Wa=a(70),ca=
a(575),ja=a(610);class ua extends G.a{constructor(kb,lb,oa,Ba){super(kb);this.xic=this.xVd=!1;this.c7=[];this.Yji=(sa,qb)=>{const Jb=this.Hdh(sa);this.$Ma(214,(Yb,jb,ab)=>A.p(this.$.pa.xa,Jb,this.e1a(Yb,this.bMh(qb)),this.sU(jb),ab,null),16,!0)};this.Xji=(sa,qb,Jb)=>{sa=A.o(this.$.pa.xa,qb,this.NMh(qb,Jb),this.mTi,null,sa);this.c7.push(sa)};this.mTi=()=>{d.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");
this.Z8b(ua.atb())};this.y9c=(sa,qb)=>{if(1===sa){sa=qb.sortRangeType;const Jb={};Jb.SortOptions=qb.sortOptions;Jb.ShouldRestoreSelection=this.xVd;Jb.SelectedRange=this.selectedRange;Jb.OriginalActiveCell=this.Urc;Jb.TopCellAddress=this.XUa;Jb.ShouldPromptNamedSheetViewTeachingDialog=0===sa||3===sa;ua.gaj(this.$,Jb)}else this.xVd&&this.ppa(this.selectedRange,this.Urc)};this.wci=(sa,qb)=>{this.xVd=!0;this.ppa(sa,qb)};this.getColorName=sa=>J.a.ALa(P.a.IH(sa));d.ULS.shipAssertTag(529105669,0,!!lb.ActiveCell);
d.ULS.shipAssertTag(529105668,0,!!lb.SelectedRange);d.ULS.shipAssertTag(529105667,0,v.D(lb.SelectedRange).contains(v.C(lb.ActiveCell)));d.ULS.shipAssertTag(529105666,0,S.a.equals(lb.SelectedRange.SheetName,lb.ActiveCell.SheetName,!0));this.Pdb=new ja.a(kb,ca.a.Xih,()=>this.xic,1);this.selectedRange=lb.SelectedRange;this.Urc=lb.ActiveCell;this.U0g=lb.ExpandSelection;this.namedSheetViewPublic=oa;this.XUa=Ba;this.initializeAndShow(aa.a.instance.ga(181),this.y9c,this.Pta(lb))}dispose(){this.xic||(this.xic=
!0,this.X3b(),this.c7=null,this.Pdb.dispose(),this.Pdb=null);super.dispose()}get pc(){return"CustomSortDialog"}get ha(){return C.h(this.$).ha}bMh(kb){return lb=>{I.b(lb,-901005882)?(Wa.a(this.$).hd.CM(-901005882),this.JJd()):I.b(lb,-569193796)?(Wa.a(this.$).hd.CM(-569193796),this.hide(),new ha(this.$,lb.Errors[0])):I.a(lb)?(d.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide()):(lb=lb.Result,this.$.pk(lb.SortRange),
lb&&fa(lb)&&Ca(lb)&&ia(lb)?kb(lb):this.Z8b(ua.atb()))}}NMh(kb,lb){return(oa,Ba)=>{if(this.xic)d.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!oa||I.a(oa))d.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${D.a.sc(oa.Errors)}`),this.$.ea.To(oa.Errors),this.hide();else{oa=oa.Result;var sa=kb.RangeType,qb=kb.HeaderRowSize,
Jb=kb.SortTopToBottom;oa&&Y(oa,kb.ConditionType)&&na(oa,sa,qb,Jb)?(oa.ColumnInfo.ColumnOffset=Ba,void 0!==oa.HeaderColumnInfo&&null!==oa.HeaderColumnInfo&&(oa.HeaderColumnInfo.ColumnOffset=Ba),lb(oa,kb.ConditionType,kb.SortTopToBottom)):(d.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.Z8b(ua.atb()))}}}Hdh(kb){const lb={};lb.SelectedRange=this.selectedRange;lb.ActiveCell=this.Urc;lb.SortInfoMode=
kb;lb.ExpandSortSelection=this.U0g;lb.ExpandSortSelectionSupported=!0;return lb}Pta(kb){const lb={};lb[L.a.yu]=this.pc;lb.fromAutoFilter=kb.FromAutoFilter;lb.gridRTL=C.h(this.$).rtl;lb.activeCell=kb.ActiveCell;lb.selectedRange=kb.SelectedRange;lb.invokeGetSortInfo=this.Yji;lb.invokeGetSortConditionColorsOrIcons=this.Xji;lb.highlightSortRange=this.wci;lb.getColorName=this.getColorName;return lb}ppa(kb,lb){kb=v.D(kb);this.ha.ra.ed.equals(kb)||this.ha.updateSelection(kb,v.C(lb),0,void 0,void 0,void 0,
!0)}JJd(){(new K(kb=>{const lb={};lb.ActiveCell=this.Urc;lb.SelectedRange=this.selectedRange;lb.ExpandSelection=kb;lb.FromAutoFilter=!1;this.$.Xc(-207540907,w.a.Db,8,{["SortCommandData"]:lb})})).show()}X3b(){if(void 0!==this.c7&&null!==this.c7)for(const kb of this.c7)this.$.pa.xa.Fgb(kb.tt)}static gaj(kb,lb){kb.Xc(1659552324,w.a.Db,8,{["CustomSortCommandData"]:lb})}static atb(){return D.a.dd(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}Object(t.a)(ua,"CustomSortDialog",G.a,[]);var Za=a(1074);
class Pa{constructor(kb){this.selection=null;this.selection=kb}getSelection(){return this.selection}}Object(t.a)(Pa,"MacroRecorderRangeAutoFilterClearedPayload",null,[145]);class ka{constructor(kb){this.filterRange=null;this.filterRange=kb}}Object(t.a)(ka,"MacroRecorderRangeFilterReappliedPayload",null,[145]);var ra=a(60);const ba=(kb,lb,oa,Ba,sa,qb,Jb=null)=>{Jb=kb.Oa(41,Jb);Jb.options=lb;return ra.g(kb,"Sort",Jb,oa,Ba,sa,qb,0)},Ua=(kb,lb,oa,Ba,sa,qb,Jb=null)=>{Jb=kb.Oa(41,Jb);Jb.selectedRange=lb;
return ra.g(kb,"ClearAutoFilter",Jb,oa,Ba,sa,qb,0)},Ka=(kb,lb,oa,Ba,sa,qb,Jb=null)=>{Jb=kb.Oa(41,Jb);Jb.filterRange=lb;return ra.g(kb,"ReapplyAutoFilter",Jb,oa,Ba,sa,qb,0)};var Oa=a(774),ib=a(775),La=a(112),db=a(55),Ab=a(1075),Mb=a(199),pb=a(33),Qb=a(346),xb=a(66);class pa{constructor(kb,lb){this.sortOptions=this.cUa=this.selectedRange=null;this.Dif=!1;this.activeCell=this.Ae=this.vb=this.kc=null;this.onContentReady=()=>{this.uUf(!1);const oa=this.ha();oa.ra.Pg&&oa.ra.ed.equals(this.cUa)&&(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?
oa.updateSelection(this.selectedRange,v.C(this.activeCell),0,void 0,void 0,void 0,!0):oa.updateSelection(this.selectedRange,oa.ra.activeCell,0,void 0,void 0,void 0,!0))};this.VSi=(oa,Ba)=>{oa&&!D.a.dg(oa.Errors)&&this.kc&&(this.kc.kp=oa.Result,this.WMb(),this.applyPivotSort(Ba))};this.USi=()=>{};this.n_i=(oa,Ba)=>{var sa;((null===Ba||void 0===Ba?0:Ba.$Rj)||(null===(sa=this.$.na)||void 0===sa?0:sa.hasAutoFilter))&&Ba.selection&&pb.a.Ekf()&&(oa=xb.d(this.$.va.na),this.aSj(new Qb.a(v.D(Ba.selection),
oa)))};this.$=kb;this.zqf="";this.namedSheetViewPublic=lb;this.gridView=C.h(this.$);this.$.Kb.Qg("LoadResource","LoadDialogControlsStopwatch")}x1(kb){if(M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var lb=this.$.da.Aa(465);lb&&lb.x1(5,kb)}}nc(kb,lb){return!this.Ktd(kb,lb)}executeCommand(kb,lb,oa){let Ba=null;kb=lb.command;switch(kb){case -864298118:Ba=this.Voh(lb,oa);break;case -1010737776:Ba=this.d$c(!0,lb,oa);break;case 2123420468:Ba=
this.d$c(!1,lb,oa);break;case -1089513346:oa=this.j3e(oa);if(!this.oCb([v.D(oa.SortOptions.SelectedRange)]))return f.TaskExtensions.Vj();Ba=this.pOe(lb,oa);break;case -1032691499:case -764711886:case -2016161444:Ba=this.i9i(lb,oa);break;case -207540907:case -1677817820:Ba=this.gridView.Ab.N5(this.ha().ra.activeCell)?this.X8i():this.U8i(lb,oa);break;case 1659552324:Ba=this.pOe(lb,this.j3e(oa));break;case 368460465:Ba=this.lph(lb,oa);break;case 529856798:Ba=this.Qoh(lb);break;case 644342024:Ba=this.gph(lb)}return Ba||
T.a(kb)}yc(kb,lb){if(kb=1===kb)switch(lb.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:kb=!1}return kb}Lc(){return!1}ha(){return this.$&&this.gridView?this.gridView.ha:null}uUf(kb){kb?this.gridView.pv(this.onContentReady):this.gridView.Ny(this.onContentReady);this.Dif=kb}get ra(){return this.ha().ra}WFj(kb){return!!this.sortOptions&&
S.a.equals(this.zqf,kb.Nia,!0)}Ktd(kb,lb){const oa=C.h(this.$).ha.ra.selectedRanges;return(new y.a(this.$.va)).xm(kb,lb,oa,this.gridView)}d$c(kb,lb,oa){const Ba=new h.a;this.Pff(Ba,oa,kb);return this.oCb([v.D(Ba.SelectedRange)])?this.gridView.Ab.N5(v.D(Ba.SelectedRange))?this.dph(kb):this.aqd(Ba,lb):f.TaskExtensions.Vj()}Voh(kb,lb){d.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");let oa=null;const Ba=this.ha();Ba&&(this.WFj(Ba)?this.oCb(Ba.ra.selectedRanges)&&
(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,oa=this.aqd(this.sortOptions,kb)):oa=this.d$c(!0,kb,lb));return oa}oCb(kb){return M.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")?this.$.isEditMode?this.$.aq(kb,!0,1):this.$.$Zc(kb,!0,1):!0}dph(kb){this.F_h(kb);return db.Task.Ra(!0)}IYg(kb){if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const lb=this.gridView.Ab.Cj(this.ra.ed,!1);if(lb)return new u.a(lb.name,this.ra.activeCell.left-
lb.usedRange.left,kb.IsAscending)}return new r.a(kb)}aqd(kb,lb){this.gridView.yf.rH(!1);const oa=()=>this.IYg(kb);return this.vad((Ba,sa,qb)=>ba(this.$.pa.xa,kb,H.b(Ba,this.OMh(lb)),sa,qb,kb),Ba=>new z.a(141,0,Ba,void 0,oa),lb,this.QEj(kb))}QEj(kb){if(!this.namedSheetViewPublic)return!1;const lb=this.ra.ed,oa=v.v(this.ra.ed,this.$),Ba=this.gridView.Ab.K_(lb,!0),sa=this.ra.hca()&&this.gridView.Ab.kmf(oa),qb=this.gridView.Ab.Rri(oa);kb=(lb.V5||lb.P_)&&!lb.isSingle&&(null==kb.ExpandSortSelection?!1:
kb.ExpandSortSelection)&&this.gridView.Ab.kmf(oa);return Ba||sa||qb||kb}X8i(){return this.$.Xc(-1556797033,w.a.Db,8,null)}U8i(kb,lb){kb=8===kb.We&&lb&&void 0!==lb[pa.xfb]&&null!==lb[pa.xfb]?lb[pa.xfb]:19===kb.We&&lb&&void 0!==lb[w.a.ng]&&null!==lb[w.a.ng]?n.a.$h(lb[w.a.ng]):this.Lch();if(!this.oCb([v.D(kb.SelectedRange)]))return f.TaskExtensions.Vj();C.h(this.$).yf.rH(!1);let oa=null;(lb=lb.TopCellAddress)&&(oa=v.o(lb,this.$));new ua(this.$,kb,this.namedSheetViewPublic,oa);return db.Task.Ra(!0)}j3e(kb){return kb[pa.Wih]}pOe(kb,
lb){const oa=qb=>{this.ecf(qb)?this.Saf(qb.Errors[0]):(lb.ShouldRestoreSelection&&this.ppa(lb.SelectedRange,lb.OriginalActiveCell),d.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${kb.We}`),this.TTj(lb),this.x1(qb))},Ba=()=>{lb.ShouldRestoreSelection&&this.ppa(lb.SelectedRange,lb.OriginalActiveCell);d.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${kb.We}`)},
sa=()=>new x(lb.SortOptions);return this.vad((qb,Jb,Yb)=>ba(this.$.pa.xa,lb.SortOptions,H.b(qb,oa),H.a(Jb,Ba),Yb,this.sortOptions),qb=>new z.a(187,0,qb,void 0,sa),null,lb.ShouldPromptNamedSheetViewTeachingDialog)}ppa(kb,lb){kb=v.D(kb);C.h(this.$).ha.ra.ed.equals(kb)||C.h(this.$).ha.updateSelection(kb,v.C(lb),0,void 0,void 0,void 0,!0)}Lch(){const kb={};kb.ActiveCell=v.o(this.ra.activeCell,this.$);kb.SelectedRange=v.v(this.ra.ed,this.$);kb.FromAutoFilter=!1;kb.ExpandSelection=null;return kb}lph(kb,
lb){const oa=this.fba();if(!oa)return db.Task.Ra(!1);const Ba=this.$.pa.xa.Wb(),sa=()=>new Za.a(oa);return B.a(this.$.userOperationManager,(qb,Jb,Yb)=>A.B(this.$.pa.xa,oa,H.b(Oa.a.T5a(La.a.tqb,ib.a.toggleAutoFilter,qb),this.n_i),Jb,Yb,{selection:oa,$Rj:lb.On},Ba),qb=>new z.a(516,0,qb,64,sa),kb)}Qoh(kb){const lb=this.fba();if(!lb)return db.Task.Ra(!1);const oa=this.gridView.Ab.Cj(this.ra.ed,!0);oa&&d.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${oa.type.toString()}`);
const Ba=this.$.pa.xa.Wb(),sa=()=>new Pa(lb);return this.vad((qb,Jb,Yb)=>Ua(this.$.pa.xa,lb,Oa.a.T5a(La.a.yHa,ib.a.clearAutoFilter,qb),Jb,Yb,null,Ba),qb=>new z.a(517,0,qb,64,sa),kb)}vad(kb,lb,oa,Ba=!0){return this.namedSheetViewPublic&&Ba?this.namedSheetViewPublic.MTa().continueWith(sa=>{sa.result&&B.a(this.$.userOperationManager,kb,lb,oa)}):B.a(this.$.userOperationManager,kb,lb,oa)}gph(kb){const lb=this.fba();if(!lb)return db.Task.Ra(!1);const oa=this.$.pa.xa.Wb(),Ba=()=>new ka(lb);return B.a(this.$.userOperationManager,
(sa,qb,Jb)=>Ka(this.$.pa.xa,lb,Oa.a.T5a(La.a.yHa,ib.a.$aj,sa),qb,Jb,null,oa),sa=>new z.a(518,0,sa,64,Ba),kb)}OMh(kb){return(lb,oa)=>{var Ba;I.b(lb,-901005882)?(Wa.a(this.$).hd.CM(-901005882),this.JJd(oa,kb.command)):this.ecf(lb)?this.Saf(lb.Errors[0]):!I.a(lb)&&lb.Result&&(this.sortOptions=oa,this.cUa=v.D(lb.Result.ActualSortRange),this.zqf=this.ha().Nia,this.Dif||(this.selectedRange=this.ra.ed,this.selectedRange.equals(this.cUa)||(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&
(this.activeCell=v.o(this.ra.activeCell,this.$)),this.$Ij())),(null===(Ba=this.sortOptions)||void 0===Ba?0:Ba.ActiveCell)&&this.z9f(this.sortOptions)&&(oa=this.sortOptions.ActiveCell,oa=new l.Range(oa.FirstRow+1,oa.FirstColumn+1,oa.FirstRow+1,oa.FirstColumn+1,!0,!1),this.PS(oa),this.w0d(oa)),this.x1(lb))}}ecf(kb){return I.b(kb,-569193796)}Saf(kb){Wa.a(this.$).hd.CM(-569193796);new ha(this.$,kb)}JJd(kb,lb){(new K(oa=>{const Ba={};Ba.ActiveCell=kb.ActiveCell;Ba.SelectedRange=kb.SelectedRange;Ba.ExpandSelection=
oa;this.$.Xc(lb,w.a.Db,8,{[pa.xfb]:Ba})})).show()}$Ij(){const kb=this.ha();if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let lb=v.C(this.activeCell);this.cUa.He(lb)||(lb=this.cUa.topLeft);kb.updateSelection(this.cUa,lb,0,void 0,void 0,void 0,!0)}else kb.updateSelection(this.cUa,kb.ra.activeCell,0,void 0,void 0,void 0,!0);this.uUf(!0)}fba(){const kb=this.ha();if(!kb)return d.ULS.shipAssertTag(537151573,0,!!kb,"SelectionManger is null"),null;
this.gridView.yf.rH(!1);return v.v(kb.ra.ed,this.$)}WMb(){this.kc&&this.kc.kp&&(this.Ae=this.kc.kp,this.vb=this.kc.Ycc())}F_h(kb){if(this.$.isEditMode&&(this.kc=this.gridView.Ab.Ap(this.ra.activeCell))){this.activeCell=v.o(this.ra.activeCell,this.$);if(this.kc&&this.kc.kp){var lb=this.kc.kp.CurrentCol;if(this.kc.kp.CurrentRow===this.activeCell.FirstRow&&lb===this.activeCell.FirstColumn){this.WMb();this.applyPivotSort(kb);return}}this.$.pa.xa.Wb();lb=new z.a(228,0,(oa,Ba,sa)=>A.l(this.$.pa.xa,this.activeCell,
H.b(oa,this.VSi),H.a(Ba,this.USi),sa,kb),16);this.$.userOperationManager.Ic(lb,null)}}applyPivotSort(kb){if(this.kc&&this.vb&&this.activeCell&&this.Ae){var lb=8===this.Ae.CellArea,oa=1===this.Ae.CellArea||2===this.Ae.CellArea;(lb||oa)&&8!==this.Ae.CellType&&4!==this.Ae.CellType&&(lb?B.a(this.$.userOperationManager,(Ba,sa,qb)=>A.b(this.$.pa.xa,this.activeCell,kb?1:2,this.vb.Caption,Ba,sa,qb,null),Ba=>new z.a(1015,0,Ba,void 0,null),null):(lb=1===this.Ae.CellArea?1:2,this.$.oa(647)?m.a.naps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.kc.isOlap?"":this.vb.Caption,lb,kb):m.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),kb)))}}TTj(kb){this.z9f(kb.SortOptions)&&(kb.TopCellAddress?kb=v.C(kb.TopCellAddress):(kb=kb.OriginalActiveCell,kb=new l.Range(kb.FirstRow+1,kb.FirstColumn+1,kb.FirstRow+1,kb.FirstColumn+1,!0,!1)),this.PS(kb))}PS(kb){pb.a.Cla(this.$)&&
f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,430,431,1),lb=>{lb.result.Zea(kb);d.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ka,3)}w0d(kb){M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,476,475,0),lb=>{lb.result.w0d(kb,0);d.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.ka,3)}i9i(kb,lb){if(!this.oCb(this.ra.selectedRanges))return f.TaskExtensions.Vj();const oa=new h.a;this.Pff(oa,lb);oa.SortConditions=[this.bgh(kb)];oa.OperationType=2;return this.aqd(oa,kb)}bgh(kb){const lb=this.gridView.Ub(this.ra.activeCell);let oa=new Ab.a;oa.IsAscending=!0;switch(kb.command){case -1032691499:lb.Nyb?(kb=Mb.a.yp(lb.backgroundColor),oa.SortColor=kb.LS(!0)):oa.SortColor=pa.NoColor;oa.SortConditionType=1;break;case -764711886:oa.SortColor=lb.s4c===pa.NoColor?pa.NoColor:Mb.a.Gye(lb.s4c);
oa.SortConditionType=2;break;case -2016161444:lb.Tyb?(oa.SortIcon=lb.cell.wlc,oa.SortIconSet=lb.xlc):(oa.SortIcon=pa.h5d,oa.SortIconSet=pa.h5d);oa.SortConditionType=3;break;default:d.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return oa}aSj(kb){f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,426,427,1),lb=>{void lb.result.IDc(kb,"Filter")},this.$.ka,3)}Pff(kb,lb,oa=!0){kb.OperationType=
0;kb.IsAscending=oa;kb.HasHeader=!0;kb.GuessHeader=!0;kb.SortTopToBottom=!0;kb.ExpandSortSelectionSupported=!0;lb&&lb[pa.xfb]?(lb=lb[pa.xfb],kb.ActiveCell=lb.ActiveCell,kb.SelectedRange=lb.SelectedRange,kb.ExpandSortSelection=lb.ExpandSelection):(kb.ActiveCell=v.o(this.ra.activeCell,this.$),kb.SelectedRange=v.v(this.ra.ed,this.$),kb.ExpandSortSelection=null)}z9f(kb){return!kb.SortConditions||kb.SortConditions.some(lb=>0===lb.SortConditionType)}}pa.Wih="CustomSortCommandData";pa.xfb="SortCommandData";
pa.h5d=-1;pa.NoColor=0;Object(t.a)(pa,"SortCommandHandler",null,[219]);class Ma extends b.a{constructor(kb){super(kb)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,309,310,this.Ya),kb=>{this.Zc([new pa(this.$,kb.result)])},this.$.ka,3)}static la(kb){b.a.Nd(160,new Ma(kb))}}Object(t.a)(Ma,"SortCommandHandlerFactory",b.a,[]);G=a(222);class ya{constructor(kb){kb.da.Ga(446,this)}khh(kb,lb){new ha(kb,lb)}}Object(t.a)(ya,"SortUtil",null,[270]);class Ea extends G.a{constructor(kb){super();
this.$=kb;this.Fb()}create(){let kb=this.$.da.Aa(446);kb||(kb=new ya(this.$),this.$.da.Ga(446,kb));this.ob(kb)}static la(kb){kb.da.Ga(447,new Ea(kb))}}Object(t.a)(Ea,"SortUtilFactory",G.a,[]);a.d(E,"a",function(){return Na});const Na=()=>{c.a.Fa(kb=>{Ma.la(kb);Ea.la(kb)})}},1158:function(t,E,a){t=a(0);var c=a(553),b=a(15),e=a(133),f=a(54);class d extends e.StandardDialog{constructor(){super();this.Tb=0;this.qc(1,CommonUIStrings.l_DialogClose)}displayError(ba,Ua){this.VNe(ba,Ua,f.a.Yqj)}VNe(ba,Ua,
Ka){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ka);this.iA(Ka,ba,Ua,null)}T9c(ba,Ua){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.iA(f.a.$qj,ba,Ua,null,!0)}}Object(t.a)(d,"ErrorDialog",e.StandardDialog,[152]);var h=a(84);e=a(1052);var m=a(146);class l{static get og(){return m.a.jq(l.nl,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}l.nl="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(t.a)(l,"FileNameDialogHtml",null,[]);var w=a(4),n=a(14),x=a(45),r=a(85),u=a(87),v=a(30);class B extends e.a{constructor(ba,Ua,Ka,Oa,ib,La,db,Ab){super(ba,Ua,Ka,Oa,ib,La,Ab);this.Mqa=this.xTc=this.iz=null;this.q_g=CommonUIStrings.l_SaveToAnotherFolder;this.og=l.og;this.Ee="FileNameDialog-SaveToSharePoint";this.Umb=db;this.qBg=Ab}BQ(ba){const Ua=v.a.mq(w.AFrameworkApplication.sm.sn),Ka=w.AFrameworkApplication.breadcrumbFolderName,Oa=w.AFrameworkApplication.breadcrumbBrandName,ib={["txtFileName"]:ba||
Ua};let La=CommonUIStrings.L_SaveAs;2===w.AFrameworkApplication.ta.Pa.Ij&&(La=CommonUIStrings.L_SaveACopy);this.initializeAndShow(La,Object(h.a)(this,this.Qac,"fileNameDialogHandler"),ib);this.DNe(ba,Ua);this.xJa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");w.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.iz=document.getElementById("anotherFolder"),ba=document.getElementById("folderLocation"),this.xTc=
u.a.zve(ba,this.iz,"anotherFolderDescribedBy"),this.iz.className="WACButton WACDialogButtonNormal",ba=!1,Ka&&Ka.length?(this.Upe(this.iz,this.xTc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Oa,Ka)),ba=this.pIg(Oa,Ka)):this.Upe(this.iz,this.xTc,CommonUIStrings.l_CurrentOnlineFolder),this.qJg(this.iz),this.sIg(this.iz),ba?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.iz,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.iz,"SaveToAnotherLocationOne"),x.a.addHandler(this.iz,n.a.click,Object(h.a)(this,this.sFd,"onSaveToAnotherLocationClick")),x.a.addHandler(this.iz,n.a.Pb,Object(h.a)(this,this.GIf,"onSaveToAnotherLocationKeyDown")))}pIg(ba,Ua){let Ka;Ka=!1;const Oa=document.getElementById("currentLocation");Oa.innerText="";const ib=this.Z5e(Oa,ba),La=this.Z5e(Oa,Ua);let db=255,Ab=255;255<ib+La&&(db=Math.max(238,408-ib),Ab=
Math.max(170,408-La),Ka=!0);this.QKg(Oa,ba,Ab,Ua,db);return Ka}Z5e(ba,Ua){const Ka=document.createElement("div");Ka.innerText=Ua;Ka.style.visibility="hidden";ba.appendChild(Ka);Ua=Ka.clientWidth;ba.removeChild(Ka);return Ua}QKg(ba,Ua,Ka,Oa,ib){Ua&&(this.Spe(ba,Ua,Ka),this.HKg(ba));Oa&&this.Spe(ba,Oa,ib)}Spe(ba,Ua,Ka){const Oa=document.createElement("div");Oa.innerText=Ua;Oa.title=Ua;Oa.className="SaveToAnotherFolderBreadcrumb";Oa.style.maxWidth=Ka.toString()+"px";ba.appendChild(Oa)}HKg(ba){const Ua=
document.createElement("span");Ua.id="FolderSeparator";const Ka=document.createElementNS("http://www.w3.org/2000/svg","svg");Ka.setAttribute("class","SeparatorCaret");const Oa=document.createElementNS("http://www.w3.org/2000/svg","polygon");Oa.setAttribute("points","1 4 1 11 5 7.5");Ka.appendChild(Oa);Ua.appendChild(Ka);ba.appendChild(Ua)}Upe(ba,Ua,Ka){Ka=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ka);Ua&&(Ua.innerText=Ka);ba.tabIndex=0;ba.setAttribute(u.a.Ad,u.a.rt)}sIg(ba){const Ua=
document.createElement("span");Ua.id="anotherFolderText";Ua.innerText=this.q_g;Ua.className="AnotherFolderTextSpan";ba.appendChild(Ua)}qJg(ba){const Ua=document.createElement("span");Ua.className="cui-img-cont-float cui-img-16by16 ";this.Mqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Mqa.setAttribute("class","FolderIconSVG");const Ka=document.createElementNS("http://www.w3.org/2000/svg","path");Ka.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Mqa.appendChild(Ka);Ua.appendChild(this.Mqa);ba.appendChild(Ua)}GIf(ba){!ba||ba.keyCode!==r.a.Kh&&ba.keyCode!==r.a.QX||this.sFd(ba)}sFd(){if(this.sJ){const ba=v.a.L4(w.AFrameworkApplication.fileName);let Ua=this.sJ.value;this.hide();Ua&&""!==Ua&&""!==ba||1===this.ta.state?(""!==ba&&(Ua+=ba),this.Rac(Ua)?this.ht.create().displayError(1,Ua,!1):this.Umb.start(Ua,this.qBg)):this.ht.create().displayError(2,Ua,!1)}}$2g(ba){this.iz&&this.Mqa&&(ba?(this.iz.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.iz,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Mqa,"DisabledFolderIconSVG")):(this.iz.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.iz,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Mqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.iz,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Mqa,"DisabledFolderIconSVG"))))}Lld(){super.Lld();this.$2g(!!this.sJ&&""!==this.sJ.value)}dispose(){this.iz&&(x.a.removeHandler(this.iz,n.a.click,Object(h.a)(this,
this.sFd,"onSaveToAnotherLocationClick")),x.a.removeHandler(this.iz,n.a.Pb,Object(h.a)(this,this.GIf,"onSaveToAnotherLocationKeyDown")),this.iz=null);super.dispose()}}Object(t.a)(B,"FileNameDialog",e.a,[187]);var z=a(685),A=a(554),y=a(187),D=a(815),I=a(909),M=a(98),T=a(135);class S{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(t.a)(S,"SaveAsDialogInput",null,[]);class H{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(t.a)(H,"SaveLocation",null,[]);var C=a(376),G=a(189);class J{constructor(ba,Ua,Ka,Oa,ib,La,db,Ab,Mb){this.CPc=null;this.GA="";this.Umb=ba;this.ht=Ua;this.Lh=Mb;this.bha=Ka;this.df=ib;this.dw=Oa;this.hGa=db;this.YYa=Ab;La&&(this.CPc=new c.a(()=>new D.a(La.value,null)))}wSh(){const ba=new z.a(A.a.ak());ba.ia("type","currentHost");return Object.assign(new H,{folderName:this.dw.breadcrumbFolderName,friendlyPath:this.dw.breadcrumbBrandName,properties:ba})}xti(ba){return!!ba&&"ClassicMru"===
ba.type&&!!ba.service_info&&!!ba.service_info.service_id&&-1!==ba.service_info.service_id.indexOf("SHAREPOINT")}W2h(){if(!this.CPc||!this.hGa)return null;var ba=this.CPc.value.m_("SaveAsToSharePointDialog",!1);if(!ba||3!==ba.state||!ba.wxf)return null;ba=ba.wxf;const Ua=new y.a;let Ka=0,Oa=0;for(var ib=0;ib<ba.length;ib++){var La=ba[ib];if(!this.xti(La))continue;Ka++;if(!La.sharepoint_info)continue;const db=La.url,Ab=La.sharepoint_info.site_url,Mb=La.title;La=I.b(La,w.AFrameworkApplication.isRtl);
if(!(db&&Ab&&Mb&&La))continue;Oa++;const pb=new z.a(A.a.ak());pb.ia("type","SharePoint");pb.ia("siteUrl",Ab);pb.ia("folderUrl",db);Oa++;Ua.add(Object.assign(new H,{folderName:Mb,friendlyPath:La,properties:pb}))}ib=new Map;ib.set("NumPlaces",ba.length.toString());ib.set("NumSharepointPlaces",Ka.toString());ib.set("placesWithMetadata",Oa.toString());M.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",ib);0<Ka&&(Oa?.5>1*Oa/Ka&&M.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):M.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ua}lTh(){const ba=new y.a;ba.add(this.wSh());const Ua=this.W2h();Ua&&ba.addRange(Ua);return Object.assign(new S,{enableMoreLocations:!w.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.GA,extension:v.a.L4(this.dw.sn),saveLocations:ba.toArray(),scenario:"SaveToSharePoint"})}adc(){const ba=Object(h.a)(this,this.lTh,
"getDialogInput"),Ua={};Ua.inputPropsCallback=ba;return Ua}BQ(ba){this.GA=ba;this.GA||(this.GA=String.format(CommonUIStrings.l_SaveACopy_Filename,v.a.mq(this.dw.sn)));ba={["id"]:"SaveAsDialog",["bodyControls"]:this.adc()};let Ua=CommonUIStrings.L_SaveAs;2===this.df.Pa.Ij&&(Ua=CommonUIStrings.L_SaveACopy);const Ka=new m.a(!1,!1,!0);Ka.Tb=1;Ka.Ee="SaveAsDialog";Ka.qc(1,CommonUIStrings.l_SaveButtonLabel);Ka.initializeAndShow(Ua,Object(h.a)(this,this.Uqj,"saveAsDialogHandler"),ba)}cIj(ba,Ua){ba&&""!==
ba&&""!==Ua||1===this.df.state?this.wti()?this.dAi(ba,Ua):(""!==Ua&&(ba+=Ua),this.Umb.start(ba,this.Lh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.ht.create().displayError(2,ba,!1))}dAi(ba,Ua){M.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Ka=this.YYa.eJe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.YYa.Chd(Ka).then(Oa=>{if(Oa&&0<Oa.length){const ib=
Oa[0][C.a.f4i];Oa=Oa[0][C.a.yNf];if(""!==ib&&""!==Oa)this.hGa.Foa(Oa,ba+Ua,ib,this.Lh),M.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.ht.create().displayError(0,ba,!1);const La=T.a.gs();La&&(La.set("SiteUrlAvailable",""===ib?"false":"true"),La.set("FolderUrlAvailable",""===Oa?"false":"true"));M.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new G.a,{extendedProperties:La}))}}else this.ht.create().displayError(0,ba,
!1),M.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Oa=>{"Canceled"===Oa?((Oa=T.a.gs())&&Oa.set("IsCanceled","true"),M.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new G.a,{extendedProperties:Oa}))):M.Health.instance.recordKpiFailure("SaveACopySFP",Oa,!1,!1,null)})}wti(){return this.YYa?this.YYa.dud():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Uqj(ba,Ua){if(Ua&&1===ba){ba=Ua.fileName;var Ka=v.a.L4(this.dw.sn);
Ua.moreLocationsSelected&&this.cIj(ba,Ka);if(Ua.locationCallback){var Oa=Ua.locationCallback();Oa?Oa.properties&&"currentHost"===Oa.properties.ma("type")?this.bha.Foa(ba+Ka,!1,this.Lh):Oa.properties&&"SharePoint"===Oa.properties.ma("type")?(Ua=Oa.properties.ma("siteUrl"),Oa=Oa.properties.ma("folderUrl"),this.hGa.Foa(Oa,ba+Ka,Ua,this.Lh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(t.a)(J,"ReactSaveAsDialog",null,[187]);class L{constructor(ba,Ua,Ka,Oa,ib,La,db,Ab=null,Mb=null,pb=null){this.La=Ua;this.nb=ba;this.cY=Oa;this.bha=La;this.ht=ib;this.df=Ka;this.xke=db;this.Xzg=Ab;this.hGa=Mb;this.YYa=pb}create(ba){return this.df&&this.df.Pa.Lv?new J(this.xke,this.ht,this.bha,w.AFrameworkApplication.sm,this.df,this.Xzg,this.hGa,this.YYa,ba):new B(this.nb,this.La,this.df,this.cY,this.ht,this.bha,this.xke,ba)}}Object(t.a)(L,"FileNameDialogFactory",
null,[154]);class P{constructor(ba,Ua,Ka,Oa){this.ap=this.Tlb=null;this.Rjb=ba;this.df=Ka;this.MBg=Oa;this.zEa=new c.a(()=>new D.a(Ua.value,Object(h.a)(this,this.Ixb,"getMoreInfoEventReceived")))}get oLf(){this.Tlb||(this.zEa.value.m_("Save As",!0),this.ap&&this.ap.XR&&this.ap.XR.length&&(this.Tlb=this.RZh(this.ap.XR)));return this.Tlb}start(ba){if(!this.oLf)if(w.AFrameworkApplication.breadcrumbFolderUrl&&w.AFrameworkApplication.breadcrumbFolderUrl.length)this.Tlb=w.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.ap),!1;const Ua=this.MBg();Ua.vIj();const Ka=Ua.z_h();if(!Ka)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Rjb.start((Oa,ib)=>{Ua.hide();ba(Oa,ib)},()=>{this.MPa(Ua)},Ka,this.Tlb);return!0}MPa(ba){ba.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}RZh(ba){ba=
ba.toLowerCase();ba.endsWith("/")||(ba+="/");const Ua=ba.indexOf("/documents/");return-1!==Ua?ba.substring(0,Ua+1)+"_layouts/15/onedrive.aspx":""}Ixb(ba){this.ap||3!==ba.state||(this.ap=ba)}}Object(t.a)(P,"OneDriveFilePickerHelper",null,[155]);class aa extends m.a{constructor(){super()}vIj(){this.iKc="FilePickerDialog";this.og="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ee="PickerDialog-MsoSp";this.showDialog("",null)}z_h(){return document.getElementById("FilePickerDiv")}VI(){}mAa(){}}
Object(t.a)(aa,"PickerDialog",m.a,[153]);var U=a(643),K=a(837),Y=a(377),na=a(27),W=a(106),X=a(25);class Aa{constructor(ba,Ua,Ka,Oa,ib,La,db){this.nb=ba;this.uLc=Ka;this.La=Ua;this.Umb=Oa;this.Rjb=ib;this.mRc=La;this.iug=db}Hg(){const ba=this.Rjb.F5a();ba?na.a.ula||this.nb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Me(X.a.saveToSharePoint,W.a.frame,Object(h.a)(this,this.z1f,"saveToSharePointActionDispatcher"),64):(ba.O9a.continueWith(Ua=>{Ua.Of&&this.Rjb.FEd(Ua)}),this.L3b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}L3b(){Y.a.RLd(Object(h.a)(this,this.z1f,"saveToSharePointActionDispatcher"));Y.a.uad([new K.a(X.a.saveToSharePoint,W.a.frame,0)],this.Rjb.F5a())}get V8a(){return this.nb.qa("SaveToAnotherFolderBrsIsEnabled")}get DBe(){return this.nb.qa("UserCanWriteRelative")}z1f(ba,Ua,Ka,Oa,ib){return Ua.contextId!==W.a.frame||ba!==X.a.saveToSharePoint?2:this.V8a&&(this.mRc.oLf||this.DBe)?1===Ka?U.SessionStatusManager.instance.t6a||w.AFrameworkApplication.G5?
8:this.iug()?32:8:2===Ka?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(ib&&ib.SaveEntryPoint&&"VersionHistory"===ib.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.DBe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.uLc.create(ib).BQ(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.Umb.start(null,ib)),32):8:8}}Object(t.a)(Aa,"SaveToSharePointActor",
null,[]);class Q{constructor(ba,Ua,Ka,Oa){this.Lh=this.Dge=null;this.hGa=ba;this.ht=Ua;this.mRc=Ka;this.df=Oa}start(ba,Ua){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Dge=ba;this.Lh=Ua;this.mRc.start((Ka,Oa)=>{this.A8i(Ka,Oa)})||this.xWd()}A8i(ba,Ua){if(ba)this.onSuccess(Ua);else this.N6(Ua)}xWd(){1!==this.df.state&&this.ht().T9c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(ba){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(ba&&ba.data&&ba.data.value&&ba.data.value.length&&ba.data.value[0].sharePoint){const Ua=ba.data.value[0].sharePoint.url;ba=ba.data.value[0].sharePoint.listUrl;let Ka=null;if(Ua&&(Ka=ba?this.p3h(ba):this.o3h(Ua))){this.hGa.Foa(Ua,this.Dge,Ka,this.Lh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Ua,!Ka)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.xWd()}o3h(ba){ba.endsWith("/")||
(ba+="/");let Ua=0;for(let Ka=0;Ka<ba.length;Ka++)if("/"===ba.charAt(Ka)&&5===++Ua)return ba.substr(0,Ka);return null}p3h(ba){ba.endsWith("/")&&(ba=ba.substring(0,ba.length-1));const Ua=ba.lastIndexOf("/");return-1!==Ua?ba.substring(0,Ua):null}N6(ba){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");ba&&ba.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",ba.error.errorCode,ba.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.xWd()}}Object(t.a)(Q,"SaveToSharePointManager",null,[713]);var fa=a(80);class Ca{constructor(ba,Ua,Ka,Oa,ib,La,db,Ab){this.oGa=ba;this.GA=Ua;this.dXa=Oa;this.oSc=La;this.d9=Ka;this.pEg=ib;this.$fa=db;this.Lh=Ab}execute(ba,Ua){if(!w.AFrameworkApplication.Og&&w.AFrameworkApplication.zd){var Ka=this.oGa+this.$fa;Ka=fa.a.Cl(Ka,"fu",v.a.lf(this.d9));Ka=fa.a.Cl(Ka,"su",v.a.lf(this.pEg));Ka=fa.a.Cl(Ka,"fn",v.a.lf(this.GA));Ka=fa.a.Cl(Ka,"n",v.a.lf((new Date).getTime().toString()));
this.Lh&&this.Lh.FileDownloadUrl&&(Ka=fa.a.Cl(Ka,"furl",v.a.lf(this.Lh.FileDownloadUrl)));Ka=Ka+"&"+this.oSc;this.dXa&&this.dXa.length?Ka=fa.a.Cl(Ka,"fnn",v.a.lf(this.dXa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");w.AFrameworkApplication.zd.Om(Ka,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,ba,Ua,null,void 0,void 0,void 0,void 0,"9")}}}Object(t.a)(Ca,"SharePointSaveAsCaller",
null,[654]);class ia{constructor(ba){this.pGa=ba.appSettings.SaveAsToHostWebServiceBase;this.GA=ba.appSettings.FileName;this.$fa=ba.Xa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(ba,Ua,Ka,Oa){return new Ca(this.pGa,this.GA,ba,Ua,Ka,w.AFrameworkApplication.Hi,this.$fa,Oa)}}Object(t.a)(ia,"SharePointUploadCallerFactory",null,[615]);var Ra=a(41),Ya=a(39),Ga=a(241),da=a(688),Z=a(164),ha=a(644),Wa=a(769);class ca{constructor(ba,Ua,Ka,Oa,ib){this.Mm=this.FDa=null;this.NHc=!1;this.tTc=
this.d9=null;this.IVc=Ua;this.smb=Ka;this.ht=Oa;this.df=ib;this.La=ba}Foa(ba,Ua,Ka,Oa){this.NHc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.xOb();this.d9=ba;Oa&&Oa.SaveEntryPoint&&(this.tTc=Oa.SaveEntryPoint);this.FDa=this.IVc.create(ba,Ua,Ka,Oa);Oa&&"true"===Oa.SkipSaveToHost?this.JQ():this.JJh()}JJh(){const ba=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.JQ()};32!==this.La.$d(X.a.ySa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.JQ()},ba])&&ba()}JQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.FDa.execute(Object(h.a)(this,this.dYi,"onSaveToSharePointUploadFinished"),Object(h.a)(this,this.cYi,"onSaveToSharePointUploadFailed"))}dYi(ba){if(ba&&ba.data&&ba.data.fe){var Ua;if(({Gt:Ua}=Ra.d(ba.data.fe)).returnValue)if(Ua.StatusCode!==Ga.a.wP&&Ua.StatusCode!==
Ga.a.ttb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",ba.data.status,Ua.StatusCode),Ua.StatusCode!==Ga.a.lZf&&this.tOe(ba.data.status)||(this.aea(Ua.StatusCode.toString()),this.hHj(Ua.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.COd();try{Ua.NewDocumentUrl?this.qRa(Ua.NewDocumentUrl):this.rRa()}catch(Ka){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
Ka.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Wa.a.Egb(ba.data.fe)}),this.p9b()||(this.aea("Failed to deserialize response"),this.vOb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.p9b()||(this.aea("Unknown"),this.vOb())}cYi(ba){ba&&ba.data?this.tOe(ba.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.aea(da.a[ba.data.status]),this.vOb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.p9b()||(this.aea("Unknown"),this.vOb()))}p9b(){if(!this.NHc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.NHc=!0,this.JQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}tOe(ba){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",ba);return this.p9b()}rRa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ya.a.kf(this.d9,Ya.a.TX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}qRa(ba){let Ua=
!1,Ka=!1;w.AFrameworkApplication.fa&&(Ua=w.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Ka=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",ba,Ua);if(Ua&&Ka){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Oa={};Oa[C.a.kRa]="1";Oa[C.a.documentUrl]=ba;Oa[C.a.reason]=ha.a.saveAs;w.AFrameworkApplication.AV().execute(ib=>
{ib.Sj(Z.a.zua,Oa)})}else Ya.a.kf(ba,Ya.a.TX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}xOb(){this.df&&1===this.df.state||(this.Mm=this.smb(),this.Mm.message=CommonUIStrings.l_CommentProgressTooltip,this.Mm.Tb=5,this.Mm.Lt=!1,this.Mm.HBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}EJa(){this.Mm&&(this.Mm.close(),this.Mm=null)}vOb(){this.uj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}gIj(){this.uj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}pHj(){const ba=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.uj(CommonUIStrings.l_SaveAsFileTooLargeTitle,ba,f.a.Vqj)}uj(ba,Ua,Ka=f.a.Zqj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",ba,Ua);this.EJa();1!==this.df.state&&this.ht().VNe(ba,Ua,Ka)}hHj(ba){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",ba);switch(ba){case Ga.a.Vhg:this.gIj();break;case Ga.a.lZf:this.pHj();break;default:this.vOb()}}COd(){"VersionHistory"===this.tTc&&
this.La.processAction(X.a.Awc,2)}aea(ba){"VersionHistory"===this.tTc&&this.La.$d(X.a.EOd,2,{["FailureReason"]:ba})}}Object(t.a)(ca,"UploadToSharePointManager",null,[612]);var ja=a(249),ua=a(786),Za=a(520),Pa=a(55);class ka{constructor(){this.Rra=this.GQc=this.BQc=this.$a=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Oh(ba){this.$a=ba;this.BQc=Za.a.xq(ba.Rb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.GQc=Za.a.xq(ba.Rb("Common.IEventEmitter<Common.IMruResult>"));
this.Rra=Za.a.xq(ba.Rb("Common.App.SharedFilePicker.ISharedFilePicker"));Pa.Task.WAA.call(null,this.BQc,this.GQc,this.Rra).continueWith(()=>{this.Ndj()})}Ndj(){this.$a.register(ia,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ac(()=>new ia(w.AFrameworkApplication.fa)).wc();this.$a.register(ca,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ac(()=>new ca(w.AFrameworkApplication.ub,
this.$a.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new ua.a).create(),()=>new d,w.AFrameworkApplication.ta)).wc();this.$a.register(Q,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ac(()=>new Q(this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new d,this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),w.AFrameworkApplication.ta)).wc();this.$a.register(P,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ac(()=>
new P(this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.BQc.result),w.AFrameworkApplication.ta,()=>new aa)).wc();this.$a.register(L,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ac(()=>new L(w.AFrameworkApplication.fa,w.AFrameworkApplication.ub,w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.Pa,this.$a.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.$a.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.GQc.result),this.$a.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Rra?this.Rra.result:null)).wc();this.$a.register(Aa,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ac(()=>new Aa(w.AFrameworkApplication.fa,w.AFrameworkApplication.ub,this.$a.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.$a.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.$a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.$a.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>w.AFrameworkApplication.ta.r1g)).wc();w.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.$a.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Hg()}static main(){ja.a.instance.vi(new ka)}}Object(t.a)(ka,"PackageManager",null,[4,5]);a.d(E,"a",function(){return ra});const ra=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");ka.main()}},1168:function(t,E,a){var c=a(9);t=a(0);var b=a(695),
e=a(48),f=a(37),d=a(1),h=a(184);class m{constructor(ka,ra){this.$=ka;this.presentModeManager=ra}nc(){return!1}yc(ka,ra){if(!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ra.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Kz;default:return!1}}executeCommand(ka,ra){ka=f.TaskExtensions.Vj();ra=ra.command;switch(ra){case 642419866:this.presentModeManager.SAc(!this.presentModeManager.Kz);this.presentModeManager.ah("TogglePresentMode");
break;case 588342182:this.presentModeManager.K8a=!this.presentModeManager.K8a;this.presentModeManager.G$f(this.presentModeManager.K8a,"TogglePresentModeOverlay");this.presentModeManager.ah("TogglePresentModeOverlay");break;default:ka=h.a(ra)}return ka}Lc(){return!1}}Object(t.a)(m,"PresentModeCommandHandler",null,[219]);class l extends b.a{constructor(ka){super(ka)}ld(){f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,423,424,this.Ya),ka=>{this.Zc([new m(this.$,ka.result)])},this.ka,3)}static la(ka){b.a.Nd(420,
new l(ka))}}Object(t.a)(l,"PresentModeCommandHandlerFactory",b.a,[]);var w=a(222),n=a(15),x=a(129),r=a(4),u=a(111),v=a(83);class B{}B.Xxh="ewa-presentMode-overlay";B.Yxh="ewa-presentMode-panel-container";B.Zxh="ewa-presentMode-rowHdrParent-container";Object(t.a)(B,"CssClassNames",null,[]);var z=a(19),A=a(5),y=a(149),D=a(294),I=a(131),M=a(374),T=a(188);a(59);var S=a(113),H=a(438),C=a(12),G=a(11),J=a(100),L=a(350),P=a(21),aa=a(132),U=a(424),K=a(108),Y=a(14),na=a(260),W=a(248),X=a(172),Aa=a(46);class Q{constructor(ka){this.vxe=
this.PQa=this.zId=this.AId=this.yda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.atc={};this.$sc={};this.KQa=null;this.UNf=0;this.onKeyDown=ra=>{ra=ra.Ca;if(9===ra.keyCode){var ba=this.yda.querySelectorAll(C.DOMElementExtensions.Fr);const Ua=C.DOMElementExtensions.um(ba);ba=C.DOMElementExtensions.mB(ba);C.DOMElementExtensions.nBa(ra,Ua,ba);return!0}return!1};this.cm=()=>{this.$.da.fb(337,ra=>{this.PQa.getPresentModeFloatieControlsMap().then(ba=>{const Ua={};for(let Ka=0;Ka<ba.length;Ka++)Ua[ba[Ka].controlId]=
ba[Ka].modelType;ba=ra.o7.Y5a(Ua);0<ba.length&&appChrome.api.dispatch(ba);this.srj()})})};this.$=ka}dispose(){this.$=this.zId=this.AId=this.yda=this.PQa=null}wgi(){window.requestAnimationFrame(()=>{this.yda=document.createElement("div");this.$.uu.insertBefore(this.yda,this.$.uu.lastChild);this.yda.id=this.$.Eb+A.a.vbc;this.yda.classList.add(B.Yxh);this.AId=document.getElementById(this.$.Eb+A.a.N8c);this.zId=[this.$.dF];this.isInitialized=!0});this.PQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.PQa.initializePresentModeFloatie()}v4h(){const ka={};ka.PollingCountPerCaller=u.a.toJSON(this.$sc);ka.PollingDurationPerCaller=u.a.toJSON(this.atc);return ka}wWd(ka){this.isInitialized?ka?(this.PQa.showPresentModeFloatie(this.yda,this.AId,this.zId),this.ah("ShowOrHideFloatiePanel"),this.Oej()):(this.PQa.hidePresentModeFloatie(),this.WWj()):n.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}ah(ka){this.UNf=G.HelperMethods.Sb();
this.KQa=ka;this.vxe=X.AsyncMethodContext.Dr(this.cm,100,Aa.a.m7i+ka,this.vxe)}get mc(){return this.yda}get Hf(){this.PQa.updatePresentModeFloatieShyState(2);return!!this.yda}get he(){return W.a.ePf}kg(ka,ra){if(ra)return!1;ka=C.DOMElementExtensions.um(this.yda.querySelectorAll(C.DOMElementExtensions.Fr));if(!ka)return n.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;ka.focus();return!0}nh(ka){return C.DOMElementExtensions.Af(this.mc,
ka)}qj(){}dk(){}Oej(){na.a(this.$).di(this);this.$.da.fb(15,ka=>{this.ewaAccessibilityManager=ka;this.ewaAccessibilityManager.mode=5});K.KeyInputManager.instance.sa(Y.a.Pb,this.mc,this.onKeyDown)}WWj(){na.a(this.$).aA(this);P.h(this.$).b1();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);K.KeyInputManager.instance.Ba(Y.a.Pb,this.mc,this.onKeyDown)}srj(){const ka=G.HelperMethods.Sb()-this.UNf,ra=this.atc[this.KQa]?this.atc[this.KQa]:0;this.atc[this.KQa]=ra>ka?ra:ka;this.$sc[this.KQa]=
this.$sc[this.KQa]?this.$sc[this.KQa]+1:1}}Object(t.a)(Q,"PresentModeFloatieManager",null,[694,66,3]);var fa=a(7),Ca=a(61);class ia{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(t.a)(ia,"OverlayCavityInfo",null,[]);class Ra{constructor(){this.height=this.width=0}}Object(t.a)(Ra,"OverlayContainerInfo",null,[]);class Ya{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(t.a)(Ya,"PresentModeOverlayProps",
null,[]);class Ga{constructor(ka){this.N0a=this.BId=null;this.$=ka;this.gridView=P.h(this.$)}ghi(){this.BId=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.N0a=Array(5);let ka,ra;for(let ba=1;4>=ba;ba++)ka=document.createElement("div"),C.DOMElementExtensions.setVisible(ka,!1),ka.id=`${"PresentModeOverlay"}-${ba}`,C.DOMElementExtensions.toggleCssClass(ka,B.Xxh,!0),ra=this.gridView.Df(ba).domElement,ra.insertBefore(ka,ra.firstChild),
this.N0a[ba]=ka})}F$f(ka){ka&&this.x_j();for(let ra=1;4>=ra;ra++)this.Slf(ra)&&C.DOMElementExtensions.setVisible(this.N0a[ra],ka);C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-overlay",ka)}x_j(){const ka=this.x0g();let ra;for(let ba=1;4>=ba;ba++)ra=ba,ka[ra]&&this.BId.showOverlayWithCavity(this.N0a[ra],ka[ra])}dispose(){this.BId=this.N0a=this.gridView=this.$=null}x0g(){let ka;const ra=P.h(this.$).rtl;let ba;const Ua=Array(5);for(let Oa=1;4>=Oa;Oa++)if(ka=Oa,this.Slf(Oa)){var Ka=
this.gridView.Df(Oa);ba=this.gridView.ha.Ta.E_?this.jVh(Oa,Ka,ra):this.cWh(Oa,Ka,ra);Ka=this.tfh(Ka);Ua[ka]=this.Ofh(this.N0a[ka].id,Ka,ba)}return Ua}Slf(ka){return this.gridView.ib.dR(ka)}tfh(ka){return Object(fa.a)(new Ra,{width:ka.$m.width,height:ka.$m.height})}Ofh(ka,ra,ba){return Object(fa.a)(new Ya,{containerId:ka,overlayContainerInfo:ra,overlayCavityInfos:ba?[ba]:null})}jVh(ka,ra,ba){var Ua=P.h(this.$).ha.Ta.$b;if(!Ua)return n.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let Ka,Oa;if(({WCa:ka,rotation:Ua,translateX:Ka,translateY:Oa}=Ua.extension.mVh(ka)).returnValue){const ib=ka.x-ra.$m.x;return Object(fa.a)(new ia,{left:(ba?ra.$m.width-(ib+ka.width):ib)-3+1,top:ka.y-ra.$m.y-3+1,width:ka.width+5,height:ka.height+5,angle:Ua,translateX:Ka,translateY:Oa})}return null}cWh(ka,ra,ba){ka=this.gridView.qb.Uwb(this.gridView.ha.ra.activeRange,ka)||Ca.a.p4;if(!ka.He(ra.$m))return null;const Ua=ka.x-ra.$m.x;return Object(fa.a)(new ia,{left:ba?ra.$m.width-(Ua+ka.width)-2:
Ua-3,top:ka.y-ra.$m.y-3,width:ka.width+5,height:ka.height+5})}}Object(t.a)(Ga,"PresentModeOverlayRenderer",null,[695,3]);var da=a(60);const Z=(ka,ra,ba,Ua,Ka,Oa,ib=null)=>{ib=ka.Oa(41,ib);ib.shouldEnablePresentMode=ra;return da.g(ka,"SetPresentMode",ib,ba,Ua,Ka,Oa,0)};var ha=a(285);class Wa extends ha.a{constructor(ka,ra){super(ka);this.n7i=()=>{this.zda.wWd(!0)};this.zda=ra;this.domElement.classList.add("ewr-presentMode-on");ka={[Wa.yu]:this.pc};this.Tb=0;this.initializeAndShow("",this.n7i,ka)}get pc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
x.a.Uu(A.a.M$f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(t.a)(Wa,"PresentModeWelcomeDialog",ha.a,[]);class ca{static get WKh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get XKh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(ka){ka.webkitRequestFullscreen?ka.webkitRequestFullscreen():ka.msRequestFullscreen?ka.msRequestFullscreen():ka.mozRequestFullScreen?ka.mozRequestFullScreen():ka.requestFullscreen?ka.requestFullscreen():n.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():n.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get Koi(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(t.a)(ca,"FullscreenUtils",null,[]);class ja{constructor(ka){this.cpa=
this.a0e=this.LIb=this.O3a=this.wtc=this.zda=this.RQa=null;this.Ytd=this.XQb=this.RPd=!1;this.aOb=!0;this.Eic=!1;this.AWd=!0;this.WQb=this.t2a=this.dHe=0;this.gyc={};this.dsc={};this.csc={};this.dPf=0;this.K8a=this.qde=!1;this.whj=()=>{C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-transition",!1);$removeHandler(this.O3a,"transitionend",this.cpa)};this.Kj=()=>{parseInt(this.$.uu.style.right,10)!==this.dHe&&window.requestAnimationFrame(()=>{this.GEc(0);this.$.jAa(D.a.h_("PresentModeManager.OnContentAreaResized"))})};
this.U6=()=>{var ra=Object(v.a)(J.a,this.$.na);if(ra&&this.Kz){this.gridView.ejc=!1;ra=ra.headersVisible;var ba=P.h(this.$).rtl;C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-on-headers-off",!ra);C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-on-rtl",ba);(12!==this.t2a&&!ra||32!==this.t2a&&ra&&!ba||0!==this.t2a&&ra&&ba)&&window.requestAnimationFrame(()=>{this.GEc(2)})}};this.$c=()=>{this.ohf();this.ah("OnWorkbookOpened");n.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Pp=()=>{this.Ytd=!0;this.ffa("OnSelectionStarted")};this.Cg=()=>{this.Ytd=!1;this.ffa("OnSelectionEnded");this.u1f()};this.Th=()=>{this.ffa("OnEditStarted")};this.jg=()=>{this.ffa("OnEditEnded")};this.Yw=()=>{if(!this.Eic){const ra=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.ffa("OnVisibleAreaChanged",!0,ra)}};this.fGb=()=>{this.Eic=!0};this.Kn=()=>{this.ffa("OnCurrentSelectionModeChanged");this.u1f();this.ah("OnCurrentSelectionModeChanged")};this.Zm=
()=>{this.ffa("OnBlockCacheItemEvicted")};this.sf=()=>{this.ffa("OnBlockCacheItemChanged")};this.ZF=()=>{this.Eic||this.ffa("OnActiveItemPanesChanged")};this.Gh=()=>{this.Eic=!1;this.zda.ah("ActiveSheetChanged");this.U6()};this.hHb=(ra,ba)=>{if(ra=Object(v.a)(J.a,ba.item))ra.Grb(16,!0),ra.e_a(this.U6)};this.CRi=()=>{ca.Koi||(this.wtc&&this.wtc.ko&&this.wtc.hide(),P.h(this.$).gb&&P.h(this.$).Xo(!0),this.SAc(!1),n.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.DRi=()=>{n.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=ka;this.gridView=P.h(this.$);this.csj=ka.ya.PresentModeRenderUpdateTimeout;this.initialize(ka)}get Kz(){return this.qde}SAc(ka){this.Kz!==ka&&(this.qde=ka,this.K8a=this.Kz,this.ohf(),this.aOb=this.s9f(),window.requestAnimationFrame(()=>{C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-transition",!0);$addHandler(this.O3a,"transitionend",this.cpa);
this.mIj(!ka);this.X1i();C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-on",ka);this.lIj(ka);y.b(this.$).D$f(this.Kz);y.c(this.$).D$f(this.Kz);this.$.NAa();this.RQa.F$f(this.aOb);if(this.Kz){this.X_a();x.a.get(A.a.M$f)?this.zda.wWd(this.Kz):this.wtc=new Wa(this.$,this.zda);var ra=U.b(this.$);ra&&(this.RPd=ra.ead(!1));this.dPf=G.HelperMethods.Sb()}else this.zda.wWd(ka),this.RPd&&(ra=U.b(this.$))&&(ra.ead(!0),this.RPd=!1),this.A8b(),this.NCi()}))}G$f(ka,ra){this.AWd=ka;this.ffa(ra)}ah(ka){this.zda.ah(ka)}dispose(){this.A8b();
this.RQa&&(this.RQa.dispose(),this.RQa=null);this.gridView=this.$=null}mIj(ka){const ra=this.$.da.Aa(25);void 0===ra||null===ra?n.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):ka?ra.NAc():ra.fgc()}X1i(){C.DOMElementExtensions.toggleCssClass(document.getElementById(r.AFrameworkApplication.Z3a),z.a.Co,this.Kz);C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-on",this.Kz);this.oIj(this.Kz);this.gridView.ejc=!this.Kz;this.N_j();this.$.da.fb(32,
ka=>{ka.i0j(this.Kz)});S.b(this.$,ka=>{ka.Sjg(this.Kz)})}oIj(ka){if(this.LIb)if(ka){if(ka=Object(v.a)(J.a,this.$.na))C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-on-headers-off",!ka.headersVisible),C.DOMElementExtensions.toggleCssClass(this.$.ur,"ewr-presentMode-on-rtl",P.h(this.$).rtl);this.GEc(0)}else this.$.ur.classList.remove("ewr-presentMode-on-headers-off"),this.$.ur.classList.remove("ewr-presentMode-on-rtl"),this.GEc(1)}GEc(ka){var ra=Object(v.a)(J.a,this.$.na);if(ra){var ba=
parseInt(this.$.uu.style.right,10);if(1===ka||2===ka){if(isNaN(ba)||ba<this.t2a)return;ba-=this.t2a}if(0===ka||2===ka)ka=ra.headersVisible,ra=P.h(this.$).rtl,ka=ka?ra?0:32:12,ba=isNaN(ba)?ka:ba+ka,this.t2a=ka;this.$.uu.style.right=G.HelperMethods.uc(ba);this.dHe=ba}}N_j(){const ka=document.getElementById(this.$.Eb+A.a.b8b).parentNode;C.DOMElementExtensions.toggleCssClass(ka,B.Zxh,this.Kz)}initialize(ka){this.RQa=new Ga(ka);this.RQa.ghi();this.zda=new Q(ka);this.zda.wgi();this.O3a=document.getElementById("MainApp");
this.a0e=this.CRi;$addHandler(this.O3a,ca.WKh,this.a0e);$addHandler(this.O3a,ca.XKh,this.DRi);this.LIb||(this.LIb=document.createElement("div"),this.LIb.className="ewa-presentMode-right-frame",this.$.dF.appendChild(this.LIb));this.cpa=this.whj}X_a(){this.gridView.ha.e3(this.Pp);this.gridView.ha.WY(this.Cg);this.gridView.jc.Zk(this.Th);this.gridView.jc.Qm(this.jg);this.gridView.FC(this.Kn);this.gridView.view.qt(this.Yw);this.gridView.WXc(this.fGb);this.gridView.Da.gH(this.Zm);this.gridView.Da.pt(this.sf);
this.$.va.Wf(this.Gh);this.$.va.usa(this.ZF);this.$.va.tha(this.hHb);this.$.DC(this.Kj);this.$.$k(this.$c);const ka=Object(v.a)(L.a,this.$.va);for(const ra of ka.items)ra.e_a(this.U6)}A8b(){this.gridView&&(this.gridView.ha.u7(this.Pp),this.gridView.ha.cX(this.Cg),this.gridView.jc.Uk(this.Th),this.gridView.jc.fm(this.jg),this.gridView.aE(this.Kn),this.gridView.view.fr(this.Yw),this.gridView.$Md(this.fGb),this.gridView.Da.EI(this.Zm),this.gridView.Da.dr(this.sf));if(this.$){this.$.va.Dg(this.Gh);this.$.va.EAa(this.ZF);
this.$.va.zna(this.hHb);this.$.jG(this.Kj);this.$.ul(this.$c);const ka=Object(v.a)(L.a,this.$.va);for(const ra of ka.items)ra.Wvc(this.U6)}}s9f(){if(!this.Kz||!this.K8a)return!1;if(1===this.gridView.ha.Ne){const ka=this.$.na.activeRange.isSingle,ra=1===this.$.na.selectedRanges.length&&!ka,ba=this.gridView.gb,Ua=this.Ytd;ra||n.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${ka}`);return this.AWd&&ra&&!ba&&
!Ua}return this.AWd}lIj(ka){ka?ca.requestFullscreen(this.O3a):ca.exitFullscreen()}ffa(ka,ra=!1,ba=!1){ra||(this.aOb=this.s9f());n.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${ka}, visibility: ${this.aOb}, immediateUpdate: ${ba}`);if(this.XQb&&ba)n.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.WQb}`),window.cancelAnimationFrame(this.WQb),this.WQb=0;else if(this.XQb){n.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${ka}`);return}ba?this.c2d(G.HelperMethods.Sb(),ka):(this.WQb=window.requestAnimationFrame(Ua=>{this.c2d(Ua,ka)}),this.XQb=!0)}c2d(ka,ra){var ba=G.HelperMethods.Sb();if(ba-ka>this.csj)this.WQb=window.requestAnimationFrame(Ka=>{this.c2d(Ka,ra)}),this.XQb=!1,n.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${ba-ka}ms.`);else{this.RQa.F$f(this.aOb);this.XQb=!1;var Ua=
G.HelperMethods.Sb();ka=G.HelperMethods.Sb()-ka;ba=Ua-ba;this.erj(ka,ra);n.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${ba}ms. rafTotalDuration = ${ka}ms`)}}ohf(){M.a(this.$.userOperationManager,(ka,ra,ba)=>Z(this.$.pa.xa,this.Kz,ka,ra,ba,null),ka=>new T.a(252,0,ka),null)}u1f(){let ka=H.a(this.gridView.Ne);1!==this.gridView.Ne||this.$.na.activeRange.isSingle||(ka="Range");this.gyc[ka]=this.gyc[ka]?this.gyc[ka]+1:1}erj(ka,ra){const ba=this.dsc[ra]?
this.dsc[ra]:0;this.dsc[ra]=ba>ka?ba:ka;this.csc[ra]=this.csc[ra]?this.csc[ra]+1:1}NCi(){const ka={};var ra=G.HelperMethods.Sb()-this.dPf;ka.PresentModeDuration=ra;ka.SelectionCountPerObject=u.a.toJSON(this.gyc);ka.OverlayCountPerCaller=u.a.toJSON(this.csc);ka.OverlayDurationPerCaller=u.a.toJSON(this.dsc);ra=this.zda.v4h();for(let ba in ra)ka[ba]=ra[ba];aa.b(this.$).vd(I.a.l7i,ka,void 0,!0)}}Object(t.a)(ja,"PresentModeManager",null,[611,3]);var ua=a(185);class Za extends w.a{constructor(ka){super();
this.$=ka;this.Fb()}create(){const ka=e.GetServiceTaskFactory.Na(this.$.da,283,284,1);f.TaskExtensions.za(ka,()=>{f.TaskExtensions.za(ua.c(ka.result.kn.loadScript("presentMode")),()=>{let ra=this.$.da.Aa(423);ra||(ra=new ja(this.$),this.$.da.Ga(423,ra));this.ob(ra)},this.$.ka,3)},this.$.ka,3)}static la(ka){ka.da.Ga(424,new Za(ka))}}Object(t.a)(Za,"PresentModeManagerFactory",w.a,[]);a.d(E,"a",function(){return Pa});const Pa=()=>{c.a.Fa(ka=>{Za.la(ka);l.la(ka)})}},1172:function(t,E,a){var c=a(9);t=
a(0);var b=a(553),e=a(695),f=a(48),d=a(37),h=a(15),m=a(1241),l=a(4),w=a(164),n=a(756),x=a(98),r=a(264),u=a(644),v=a(27),B=a(156),z=a(179),A=a(288),y=a(5),D=a(148),I=a(102),M=a(76),T=a(74),S=a(374),H=a(188),C=a(59),G=a(60),J=a(328),L=a(588),P=a(1338),aa=a(421),U=a(321),K=a(13);class Y extends P.a{constructor(ab,vb){super(ab,void 0,void 0,vb)}get pPa(){return K.a.instance.Ua(420)}get tmc(){return K.a.instance.Ua(421)}get smc(){return"DownloadOdsLink"}get GDb(){return"#"}get J9a(){return K.a.instance.Ua(422)}get Mwf(){return!0}wsf(){h.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}ysf(){h.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}mmc(){aa.Redirect.showHelp(U.a.aMi);return!0}}Object(t.a)(Y,"DownloadACopyAsOdsDialog",P.a,[]);class na{constructor(ab,vb){this.dialog=null;this.RCf=()=>{this.dialog&&this.dialog.hide()};this.qMi=ab;this.rb=vb;this.rb.Sob(this.RCf)}Bxe(ab){this.dialog=ab}Z9c(){this.qMi.xLf(-1059172980)}dispose(){this.rb.xKb(this.RCf)}}
Object(t.a)(na,"DownloadACopyAsOdsDialogDownloadBehavior",null,[177,3]);const W=(ab,vb,Da,Fa,nb,Ta,V=null)=>{V=ab.Oa(9,V);V.isReadOnlyRecommended=vb;return G.g(ab,"SetReadOnlyRecommended",V,Da,Fa,nb,Ta,0)},X=(ab,vb,Da,Fa,nb,Ta,V=null)=>{V=ab.Oa(9,V);V.calc_type=vb;return G.g(ab,"SetCalculationOptions",V,Da,Fa,nb,Ta,0)};class Aa{constructor(ab){this.calculationMode=0;this.calculationMode=ab}}Object(t.a)(Aa,"MacroRecorderWorkbookCalculationModeSetPayload",null,[145]);class Q{constructor(ab){this.calculateType=
0;this.calculateType=ab}}Object(t.a)(Q,"MacroRecorderWorkbookRecalculatedPayload",null,[145]);var fa=a(85),Ca=a(146),ia=a(178),Ra=a(14),Ya=a(108),Ga=a(1);P=a(262);class da{static get R0i(){return da.Q0i}}da.Q0i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(t.a)(da,"OpenInAppDialogCopyHtml",null,[]);var Z=a(152);class ha extends P.a{constructor(ab){super(ab);this.oI=null;this.nGb=()=>{h.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.VGc(),!0;v.a.Dp?(h.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Ux&&this.Ux.length||h.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Ux+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+
this.Em+";end","_top")):9<=v.a.aod?(h.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.Ama,"_top"),window.setTimeout(()=>{this.openUrl(this.Em,"_blank")},9E3)):(h.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.Ama,"_top"),window.setTimeout(()=>{this.openUrl(this.Em,"_blank")},500));
return!0};this.YPa=vb=>vb.Ca.keyCode===fa.a.Kh||vb.Ca.keyCode===fa.a.nfa?(h.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),vb.Gb.click(),!0):!1;1===l.AFrameworkApplication.ta.Pa.Ij&&(this.Ux=this.$.workbookContext.ClientUrl,this.Ama="ms-excel:ofe|u|"+this.Ux,this.Em=l.AFrameworkApplication.fa.Xa("AppUrl"),v.a.Wba?this.Em="itms-apps://"+l.AFrameworkApplication.fa.Xa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":v.a.Dp&&(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",
!1)&&this.$.ya.IsMeetingLiveSession?(h.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.Em=l.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):v.a.xBb?this.Em=l.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<v.a.uZc.kPa&&(this.Em=l.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get pc(){return"OpenInAppDialogCopy"}openUrl(ab,vb){let Da=document.getElementById("link");
Da||(Da=document.createElement("a"),Da.id="link",Da.style.visibility="hidden",Da.href="",document.body.appendChild(Da));Da.target=vb;Da.href=ab;Da.click()}VGc(){h.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");d.TaskExtensions.za(f.GetServiceTaskFactory.Na(this.$.da,21,137,1),ab=>{let vb={};vb.OpenInAppUrl=this.Ama;vb.StoreUrl=this.Em;ab.result.Sj("UI_OpenInMobileApp",vb)},this.$.ka)}S0i(){h.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}hg(){this.og=
Ca.a.jq(da.R0i,K.a.instance.ga(662),K.a.instance.ga(663),l.AFrameworkApplication.sB,Z.getImageClass(l.AFrameworkApplication.fa.Xa("AppIcon")),K.a.instance.ga(664));this.Ee="OpenInAppDialog";this.Tb=5;this.initializeAndShow("",this.S0i.bind(this),null);this.RI(this.oI)}Tv(ab){super.Tv(ab);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.oI=document.getElementById("LinkToInstall");ia.a.instance.sa(Ra.a.click,this.oI,this.nGb);Ya.KeyInputManager.instance.sa(Ra.a.Gd,this.oI,
this.YPa)}dispose(){this.oI&&(ia.a.instance.Ba(Ra.a.click,this.oI,this.nGb),Ya.KeyInputManager.instance.Ba(Ra.a.Gd,this.oI,this.YPa),this.oI=null);super.dispose()}}Object(t.a)(ha,"OpenInAppDialogCopy",P.a,[]);var Wa=a(133),ca=a(376);class ja{constructor(ab){this.ddi="itms-apps://";this.edi="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Bqg=vb=>{1==vb&&this.VGc()};this.$=ab;this.Ux=l.AFrameworkApplication.ta.Pa.Ux;this.Ama="ms-excel:ofe|u|"+this.Ux;this.Em=l.AFrameworkApplication.fa.Xa("AppUrl");
v.a.Wba||v.a.$g?this.Em=this.ddi+this.edi:v.a.Dp&&(l.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(h.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.Em=l.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):v.a.xBb?this.Em=l.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<v.a.uZc.kPa&&(this.Em=l.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")))}VGc(){h.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
d.TaskExtensions.za(f.GetServiceTaskFactory.Na(this.$.da,21,137,1),ab=>{let vb={};vb[ca.a.DLf]=this.Ama;vb[ca.a.Em]=this.Em;ab.result.Sj("UI_OpenInMobileApp",vb)},this.$.ka)}hg(){h.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const ab=new Wa.StandardDialog;ab.Tb=0;ab.qc(1,K.a.instance.ga(668));ab.$l(K.a.instance.ga(666),K.a.instance.ga(667),0,this.Bqg)}}Object(t.a)(ja,"OpenInAppDialogReact",null,[]);P=a(285);class ua extends P.a{constructor(ab){super(ab);
this.sessionId=ab.ya.UserSessionId;this.TYg=ab.ya.BuildVersion}get pc(){return"WACSessionIdDialog"}vN(){return{[ua.vvj]:K.a.instance.ga(669),[ua.wvj]:this.sessionId,[ua.id]:"WACSessionIdDialog",[ua.b1c]:K.a.instance.ga(670),[ua.buildVersion]:this.TYg}}hg(){const ab=this.vN();this.Tb=5;this.initializeAndShow(K.a.instance.ga(1023),this.l4j.bind(this),ab)}l4j(){h.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}ua.id="id";ua.vvj="sessionIdLabel";ua.wvj="sessionIdValue";ua.b1c=
"buildLabel";ua.buildVersion="buildVersion";Object(t.a)(ua,"WACSessionIdDialog",P.a,[]);var Za=a(28),Pa=a(29),ka=a(359),ra=a(11),ba=a(184),Ua=a(282),Ka=a(21),Oa=a(44),ib=a(251),La=a(380),db=a(290),Ab=a(51),Mb=a(6),pb=a(143),Qb=a(971),xb=a(81),pa=a(36),Ma=a(304),ya=a(254);class Ea{VQ(ab,vb){ab=Pa.a.dd(12,1,671,0,0,0,"Blank");ab.Description=String.format(K.a.instance.ga(672),vb);return ab}kcc(ab){switch(ab){case 1:case 2:return 0;default:return 2}}}Object(t.a)(Ea,"ReloadCloseConfirmation",null,[133]);
var Na=a(150),kb=a(589),lb=a(70),oa=a(55),Ba=a(174),sa=a(33);class qb extends z.a{constructor(ab,vb,Da,Fa){super();this.$=ab;this.businessBar=Fa;this.openInExcelOperation=vb;this.wK=Da}get Zb(){return this.$.ea.Zb}get workbookContext(){return this.$.workbookContext}get r9b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return lb.a(this.$)}get dc(){return this.$.dc}Zai(){var ab,vb;return null!==(vb=null===(ab=this.$.workbookContext.LoadBlockingFloatingObjectsInfo)||void 0===
ab?void 0:ab.LoadBlockType)&&void 0!==vb?vb:!1}nc(){return!1}executeCommand(ab,vb,Da,Fa){const nb=this.r9b,Ta=this.$,V=vb.command,va=this.openInExcelOperation,wb=this.$.Eb,fc=Da.SourceControlId;Ta.gl.Wqe(V);va.zzc(vb.startTime.getTime().toString());ab=null;switch(V){case 1455037301:this.$.P5?va.nHe():va.I5c();break;case -2044628748:case 2004484710:this.$.P5?va.nHe():va.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===fc?(this.iEb("CellLongPress"),h.ULS.sendTraceTag(576495705,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.iEb("PencilIcon"),h.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:h.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const Fc=lb.a(this.$).hd.activityState;Oa.a(Ta).Ns(new ib.a(Mb.a.ky,5,()=>{Fc[ya.a.Jq]=Mb.a.gj}));break;case 480922297:Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",
!1)&&(new ua(this.$)).hg();break;case -2028960985:va.xbg();break;case -1059172980:new Y(va.aAe(V),new na(va,Ta.rb));break;case -1285148982:this.clientWorkflow.hd.activityState[pa.a.WWc]=!0;this.JDc(!1);break;case -75280711:this.JDc(!1);break;case -455164169:this.JDc(!0);break;case -1388494670:this.$.da.fb(400,sb=>{sb.NFi();this.JDc(!1)});break;case 810888577:l.AFrameworkApplication.yk=(new Date).getTime();h.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${l.AFrameworkApplication.yk}`);
break;case -1804063550:case -974518828:vb=0;y.a.aGd in Da&&(vb=Da[y.a.aGd]);va.xLf(V,vb);break;case -1339961039:vb=!1;Da&&y.a.ALb in Da&&(vb=Da[y.a.ALb]);this.reloadWorkbook(!1,vb);break;case -8805455:const Qa=this.workbookContext;if(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&this.Zai()&&sa.a.gd(this.$)){const sb=f.GetServiceTaskFactory.Na(this.$.da,522,523,0);d.TaskExtensions.za(sb,()=>{sb.result.gE()},this.$.ka,3)}else Ta.isEditMode||(qb.MEe(Ta),
ab=d.TaskExtensions.za(this.wK.value,sb=>{sb=sb.result;var bb=sb.isEnabled();bb&&L.a(sb,w.a.copyAndEdit,C.a.Ag.V2e(),this.$.ea.Mg.get(2))?h.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):bb&&l.AFrameworkApplication.vlg?(bb={},bb[m.a.aJd]=l.AFrameworkApplication.userSessionId,bb[l.AFrameworkApplication.cIi]=Za.a.Sa.zb.getTime().toString(),h.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),
sb.Sj(w.a.editMode,bb)):nb.CopyAndEditUrl?this.sah():(this.dc.supportsEditing||Qa.EditUrl)&&this.reloadWorkbookInEditMode()},this.ka,3));break;case -723527778:Ta.isEditMode&&(qb.MEe(Ta),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const la=Ta.pa.xa.Wb(),hb=-1355155015===V?1:0,Kb=()=>new Q(hb);ab=S.a(this.$.userOperationManager,(sb,bb,Ob)=>G.y(Ta.pa.xa,hb,null,sb,bb,Ob,null,la),sb=>new H.a(128,0,sb,void 0,Kb),vb);Ka.h(Ta).yf.rH(!1);break;case -1158102843:ab=Ka.h(Ta).yf.recalcSheet(vb);
Ka.h(Ta).yf.rH(!1);break;case -988468372:if(Ga.EwaSettings.oa(284))if(Fa=parseInt(Da[M.a.Kc],10),0<=Fa&&3>Fa)this.setCalculationMode(vb,Fa);else return h.ULS.sendTraceTag(537162652,0,10,`SetCalculationMode , unexpected menuItemId: ${Da[M.a.Kc]}`),ba.a(V);break;case 257398710:D.a.ntw(nb.ReportAbuseUrl,Ta);break;case 1800405051:this.arj();break;case -48469327:this.saveACopy();break;case 214430355:vb=!1;Da&&y.a.G$c in Da&&(vb=Da[y.a.G$c]);if(!this.PEj(vb,Da))break;l.AFrameworkApplication.G5?this.businessBar.mh(42,
null):this.businessBar.mh(vb?22:23,null);break;case 1389557314:ab=d.TaskExtensions.za(this.wK.value,sb=>{L.a(sb.result,w.a.lGh,null,this.$.ea.Mg.get(6))||D.a.ntw(nb.FileVersionUrl,Ta)},this.ka,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:fc===wb+y.a.npf?va.syi():va.ryi();break;case 512141517:fc===wb+y.a.mpf?va.Ayi():va.zyi();break;case -1224038235:const dc=n.a.On in Da?!Da[n.a.On]:I.j(Ta.ea.workbookContext.Options);Da[n.a.Description]=dc?K.a.instance.ga(571):K.a.instance.ga(572);
ab=S.a(this.$.userOperationManager,(sb,bb,Ob)=>W(this.$.pa.xa,!dc,sb,bb,Ob,null),sb=>new H.a(129,0,sb),vb);break;case 1118926154:if(this.$.isEditMode){const sb=new B.a;this.$.da.fb(53,bb=>{bb?(bb.Qn.kyi(this.$.Eb+y.a.zvd),sb.setResult(!0)):h.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});ab=sb.task}break;case -1698025133:va.openInBrowser();break;case 520859864:ab=d.TaskExtensions.za(f.GetServiceTaskFactory.Na(this.$.da,393,394,Fa.S4()),
sb=>{sb.result||h.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.ka,3);break;default:ab=ba.a(V)}return ab||oa.Task.Ra(!0)}iEb(ab){if(ra.HelperMethods.I_){const vb=new Map;vb.set("EntryPoint",ab);x.Health.instance.recordKpiUsage(db.a.P0i,0,La.a.QHi,vb)}else h.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){l.AFrameworkApplication.isMobileMode&&
(this.$.ya.IsMeetingLiveSession&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(h.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new ja(this.$)).hg()):Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(h.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new ha(this.$)).hg()):
(h.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),l.AFrameworkApplication.showOpenInAppDialog()))}PEj(ab,vb){return l.AFrameworkApplication.isMobileMode&&!T.a(this.$.ya,29)?(this.showOpenInAppDialog(),h.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.iEb("CellDoubleTap"),h.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):l.AFrameworkApplication.Fjc&&(ab&&ka.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(h.ULS.sendTraceTag(537162645,0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${ka.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):r.a.any([25,26,30,31,57,32,34],Da=>this.businessBar.qla(Da))?
(h.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):vb&&y.a.V8i in vb&&!ab?!1:!0}yc(ab,vb){ab=!1;switch(vb.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:ab=
!0;break;case 480922297:case 520859864:ab=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case 924877417:ab=Ba.a.nsd?!0:!1;break;case -1285148982:case -75280711:case -455164169:ab=Ga.EwaSettings.oa(106);break;case -1388494670:ab=Ga.EwaSettings.oa(106);break;case 810888577:ab=Ga.EwaSettings.oa(257);break;case -1224038235:ab=this.$.ea.amIAlone;break;case -988468372:ab=Ga.EwaSettings.oa(284);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:ab=
!0,h.ULS.shipAssertTag(537162642,0,this.$.nla,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return ab}Lc(){return!1}arj(){if(this.Zb){var ab=this.$;Oa.a(ab).Ns(new ib.a(Mb.a.ky,5,()=>{ab.DI(!1,!0);const vb=this.clientWorkflow.hd.activityState;vb[ya.a.Jq]=Mb.a.jea;vb[pb.a.VT]=2;vb[pa.a.$r]=ab.isEditMode;vb[pb.a.iha]=!1}))}}saveACopy(){if(this.Zb){var ab=this.$;Oa.a(ab).Ns(new ib.a(Mb.a.ky,5,()=>{ab.DI(!1,!1);const vb=this.clientWorkflow.hd,Da=vb.activityState;
Da[ya.a.Jq]=Mb.a.Y0f;Da[kb.a.d0b]=this.dc.hasUnsupportedFeaturesForEdit;Da[pb.a.iha]=!1;vb.qr(Pa.a.x4(this.businessBar.X$c,[-502303485]))}))}}JDc(ab){Oa.a(this.$).Ns(new ib.a(Mb.a.boa,2,()=>{this.$.DI(!0,!0);var vb=lb.a(this.$).hd,Da=this.$.isEditMode;Da=Pa.a.dd(1,1,0,0,0,Da?-315732528:-2087635043,Da?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Da.ForceVersionUpgrade=ab;vb.qr([Da]);vb=lb.a(this.$).hd.activityState;vb[ya.a.Jq]=Mb.a.boa;vb[pa.a.$r]=this.$.isEditMode;vb[pb.a.iha]=!1}))}closeWorkbook(){if(this.Zb){var ab=
this.$;C.a.Ag.dAc("2145659238")?d.TaskExtensions.za(this.wK.value,vb=>{vb.result.Sj(w.a.rYe,{})},this.ka,3):Oa.a(ab).Ns(new ib.a(Mb.a.ky,5,()=>{ab.DI(!0,!1);const vb=this.clientWorkflow.hd.activityState;vb[pb.a.PY]=!1;vb[pb.a.iha]=!1;this.dc.inViewerFromWebPart?(J.a.RJd(ab,this.clientWorkflow.hd),ab.gl.kz("InViewerFromWebPart"),vb[ya.a.Jq]=Mb.a.k0):(vb[ya.a.Jq]=Mb.a.Yj,ab.qd&32?vb[pb.a.VT]=0:(vb[pb.a.VT]=1,vb[pb.a.T_b]=new Qb.a),vb[Na.a.spe]=!0)}))}}sah(){const ab=this.dc.vbaRemovedDuringConversion;
h.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${ab}`);const vb=this.$;ab?Oa.a(vb).Ns(new ib.a(Mb.a.ky,5,()=>{const Da=Pa.a.dd(3,0,0,1261,0,1069271157,"XLSMacroFailure");this.clientWorkflow.hd.qr([Da]);this.clientWorkflow.hd.activityState[ya.a.Jq]=Mb.a.wgb})):l.AFrameworkApplication.hideHeader?ra.HelperMethods.kf(this.r9b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):D.a.ntw(this.r9b.CopyAndEditUrl,vb)}reloadWorkbookInEditMode(){if(this.Zb)if(C.a.Ag.ZV&&
C.a.Ag.ELd(),l.AFrameworkApplication.Fjc&&!l.AFrameworkApplication.jca)ra.HelperMethods.kf(this.$.Uqb(!0),A.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var ab=this.$,vb=!1,Da=this.dc.hasUnsupportedFeaturesForEdit,Fa=this.workbookContext.FileWasRepaired;ka.d(this.workbookContext.WorkbookFileName)?(vb=!0,h.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Da}`)):ka.a(this.workbookContext.WorkbookFileName)&&
(vb=!0,h.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var nb=ab.me.get(59);nb=!(ab.ea.dc.supportsEditing&&nb);if(vb&&!Da||nb&&(vb||Da)){let Ta;Ta=nb?Da?-2066104278:816071846:Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&T.a(this.$.ya,25)&&!this.$.gCb?765011943:-213064907;vb=()=>{const V=Pa.a.D0a([Ta]);this.clientWorkflow.hd.qr(V);this.clientWorkflow.hd.activityState[ya.a.Jq]=Mb.a.wgb}}else vb=()=>
{ab.DI(!0,!1);var Ta=this.clientWorkflow.hd;const V=Ta.activityState;V[pb.a.VT]=1;V[Ma.a.Y_b]=u.a.aoc;V[pa.a.$r]=!0;V[kb.a.d0b]=this.dc.hasUnsupportedFeaturesForEdit;V[pb.a.iha]=!!this.workbookContext.EditUrl;V[xb.a.U2]=this.workbookContext.EditUrl;if(!this.r9b.CopyAndEditUrl){const va=[Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&T.a(this.$.ya,25)&&!this.$.gCb?-943219229:1821390342];Ta.qr(Pa.a.x4(this.businessBar.X$c,va))}Fa&&!Da?(ka.b(this.workbookContext.WorkbookFileName)&&
Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Ta=Pa.a.D0a([-425642652]),h.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Ta=Pa.a.D0a([108482388]),this.clientWorkflow.hd.qr(Ta),V[ya.a.Jq]=Mb.a.l1f):this.$.ea.hcf?(h.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Ab.b().aYd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session",
"PasswordToModifyDialogShown"),V[ya.a.Jq]=Mb.a.eIb):V[ya.a.Jq]=this.$.ea.pjc?Mb.a.KDb:Mb.a.wgb};Oa.a(ab).Ns(new ib.a(Mb.a.ky,5,vb))}}reloadWorkbookInViewMode(){if(this.Zb){C.a.Ag.ZV&&C.a.Ag.ELd();var ab=this.$;v.a.$g&&Ka.h(ab).Vb.textBox.blur();Oa.a(ab).Ns(new ib.a(Mb.a.ky,5,()=>{ab.DI(!ab.ea.isNamedObjectViewMode,!1);const vb=this.clientWorkflow.hd.activityState;vb[ya.a.Jq]=Mb.a.qia;vb[pb.a.VT]=1;vb[pb.a.PY]=!0;vb[pa.a.$r]=!1;vb[pa.a.oob]=!0;vb[Ma.a.Y_b]=u.a.aoc}))}}reloadWorkbook(ab,vb){if(this.Zb){var Da=
this.$;Da.mV&65536&&Oa.a(Da).Ns(new ib.a(Mb.a.ky,5,()=>{Da.DI(ab,!0);const Fa=this.clientWorkflow.hd.activityState;Fa[ya.a.Jq]=Mb.a.rz;Fa[pa.a.ZWc]=this.workbookContext.NovMode;vb||(Fa[pb.a.VT]=1,Fa[pb.a.T_b]=new Ea)}))}}setCalculationMode(ab,vb){h.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${vb} `);const Da=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=vb;const Fa=()=>new Aa(vb);return S.a(this.$.userOperationManager,(nb,Ta,V)=>X(this.$.pa.xa,
vb,Ua.b(nb,qb.EYi(this.$,Da)),Ua.a(Ta,qb.DYi(this.$,Da)),V,null),nb=>new H.a(197,0,nb,void 0,Fa),ab)}static MEe(ab){ab.rb&&0<ab.rb.WR&&ab.rb.Dcd(vb=>{vb.wv()})}static EYi(ab,vb){return Da=>{Pa.a.dg(Da.Errors)&&(ab.ea.workbookContext.CalcMode=vb,h.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${vb}.  Error id names: ${Pa.a.sc(Da.Errors)}`))}}static DYi(ab,vb){return()=>{ab.ea.workbookContext.CalcMode=vb;h.ULS.sendTraceTag(537162627,
0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${vb})`)}}}Object(t.a)(qb,"FileOperationsCommandHandler",z.a,[219]);var Jb=a(153);class Yb extends e.a{constructor(ab){super(ab)}ld(){const ab=this.$,vb=[],Da=f.GetServiceTaskFactory.create(ab.da,56,this.ka,this.Ya);vb.push(Da);const Fa=f.GetServiceTaskFactory.Na(ab.da,5,4,this.Ya);vb.push(Fa);d.TaskExtensions.za(oa.Task.jJ(...vb),()=>{Jb.b(Da)&&this.Zc([new qb(ab,Da.result,new b.a(()=>f.GetServiceTaskFactory.create(ab.da,
137,this.ka,this.Ya)),Fa.result)])},this.ka,0)}static la(ab){e.a.Nd(94,new Yb(ab))}}Object(t.a)(Yb,"FileOperationsCommandHandlerFactory",e.a,[]);a.d(E,"a",function(){return jb});const jb=()=>{c.a.Fa(Yb.la)}},1173:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(8),f=a(19),d=a(67),h=a(61),m=a(5),l=a(31);class w{}w.vyh="ewa-resizehdr-row-hidden";w.uyh="ewa-resizehdr-col-hidden";Object(t.a)(w,"CssClassNames",null,[]);var n=a(240),x=a(14),r=a(155),u=a(633),v=a(27),B=a(224),z=a(4),A=a(264),y=a(15),D=
a(76),I=a(131),M=a(40),T=a(138),S=a(24),H=a(52),C=a(12),G=a(71),J=a(1),L=a(95),P=a(11),aa=a(13),U=a(252),K=a(132),Y=a(375),na=a(44),W=a(34);class X{constructor(Ma,ya,Ea,Na,kb,lb,oa){this.Kwa=Ma;this.aFb=ya;this.HPa=Ea;this.Smd=Na;this.Adb=kb;this.fof=lb;this.nai=oa}}Object(t.a)(X,"HeaderEventCachedInfo",null,[]);class Aa{constructor(Ma){this.y$c=Ma}EHe(Ma){Ma=P.HelperMethods.CHd(Ma);return Math.max(0,Math.min(Aa.kwf,Ma))}uHe(Ma){return this.E4i(Ma)}N6g(Ma){return Math.round(this.y$c*Ma+2*this.D3e()+
1)}E4i(Ma){return Math.max(0,Math.min(Aa.Qvf,(Math.max(0,Math.min(e.a.Dnc,Ma))-2*this.D3e()-1)/this.y$c))}D3e(){return Math.floor(Math.max((this.y$c+3)/4,2))}Odc(Ma,ya){return ya?Ma?Aa.kwf:e.a.Qzd:Ma?Aa.Qvf:e.a.Dnc}}Aa.kwf=409;Aa.Qvf=255;Object(t.a)(Aa,"ResizeHeadersConverter",null,[]);var Q=a(191);class fa extends L.a{constructor(Ma,ya){super(ya.domElement);this.uY=this.a_f=!1;this.oi=this.q9a=this.NBa=null;this.SOd=!0;this.vkc=!1;this.bMb=this.pl=this.offset=0;this.CN=this.mS=this.p1=null;this.sbi=
"headerResizeTooltip";this.FG=this.cyd=null;this.S_c=this.vY=this.PAa=!1;this.XLf=this.bbb=e.a.gxa;this.Rhf=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");this.WRb=!1;this.mO=Ea=>{if(this.grid.Ej)return!1;Ea=W.a(this.grid.$).Vd(Ea);if(3===Ea.tb&&!this.gof(Ea.Ca)||!this.QOf(Ea,!1))return!1;y.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const Na=this.WAc();this.Mfd(Ea.clientPoint,Na,!0);this.PAa||(n.a.instance.sa(x.a.Mj,this.domElement.ownerDocument.body,
this.lab),r.a.instance.sa(x.a.$f,this.domElement.ownerDocument.body,this.lab),this.PAa=!0);this.fkf()&&this.uY&&this.Jef(Ea);return!1};this.uGb=Ea=>{Ea=W.a(this.grid.$).Vd(Ea);this.fkf()&&this.S_c&&this.Jef(Ea);if(!Ea.Ca.type.includes("touch")&&Ea.Ca.button!==Sys.UI.MouseButton.leftButton||!this.aCb)return!1;G.g(Ea.Ca);this.NQe();Ea=this.grid.Ej?this.bbb:e.a.gxa;var Na=!1;if(this.grid.Ej&&this.oi){var kb=Ea!==this.pl||!this.Rhf&&this.vY;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&
!kb&&this.WRb&&(this.je.removeRowColFromModel(this.oi.Unb,this.oi.cVf),Na=!0,J.EwaSettings.wm()&&(this.je.r8(this.grid.ha.ra.selectedRanges),this.je.cn("HeaderResizeBehavior::onDocumentMouseUp")))}else this.oi&&(Ea=this.vY?this.nhd():this.oi.O4()),kb=Ea!==this.pl;this.NBa&&kb&&Ea!==e.a.gxa?(Ea=this.grid,Na=this.Ijd(Ea),kb={},kb.SheetMultiRange=M.r(Na,Ea.$),fa.uTd(kb,this.isRow,this.pl),J.EwaSettings.fqd()&&this.grid.Ej&&(Na=kb.SheetMultiRange.Ranges[0],y.ULS.sendTraceTag(509694147,2,50,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${this.oi?
this.oi.Unb:-1}, isResizingHiddenHeader=${this.vY}, headerViewBlockHashCode=${this.je.hashCode},
          rangeFirstRow=${Na.FirstRow}, rangeFirstColumn=${Na.FirstColumn}, rangeLastRow=${Na.LastRow}, rangeLastColumn=${Na.LastColumn},`)),this.Msh(kb),Ea.ROj=!0):(!J.EwaSettings.wm()&&Na&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.je.r8(this.grid.ha.ra.selectedRanges),this.je.cn("HeaderResizeBehavior::onDocumentMouseUp")),this.Cg(null,null),this.lKb());return this.WRb=this.vY=!1};this.Zca=Ea=>{if(this.grid.Ej)return!1;Ea=u.a.create(Ea.eventName,
Ea.Gb,Ea.Ca,Ea.tb);Ea=W.a(this.grid.$).Vd(Ea);if(!this.QOf(Ea,!0))return!1;Ea=this.grid;var Na=this.Ijd(Ea);Na=M.r(Na,Ea.$);Ea.qb.Zg([this.isRow?13:14]);Ea.qb.PTa();this.lKb();Ea.$.Xc(this.isRow?146338636:1391094586,D.a.Db,30,{["autoFitRanges"]:Na});return!1};this.UEf=Ea=>{this.uY?(this.vY&&!this.WRb&&(this.mJg(),J.EwaSettings.wm()&&this.je.cn("HeaderResizeBehavior::onHeaderResizeChanged")),this.vkc||this.$ff(),Ea=new Sys.UI.DomEvent(Ea),Ea=u.a.create(x.a.Rha,this.domElement,Ea,2),Ea=W.a(this.grid.$).Vd(Ea),
this.pEd(Ea.clientPoint)):y.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.oi?this.oi.Unb:-1}, isRow = ${this.isRow}`)};this.VEf=Ea=>{Ea=new Sys.UI.DomEvent(Ea);Ea=u.a.create(x.a.Rha,this.domElement,Ea,2);this.uGb(Ea)};this.KTi=Ea=>{this.pza(Ea,this.oi,!1)};this.lab=Ea=>{Ea=W.a(this.grid.$).Vd(Ea);G.g(Ea.Ca);return this.pEd(Ea.clientPoint)};this.zI=Ea=>{if(this.grid.Ej)return!1;Ea=W.a(this.grid.$).Vd(Ea);let Na;
if((J.EwaSettings.isChangeGateEnabled("OfficeVSO:7409830_AllowResize")?!this.grid.isResizeAllowed(this.isRow):!this.isResizeAllowed)||-1!==this.grid.ha.selectionType)return na.a(this.grid.$).Gp()&&(Na=this.$hd(Ea))&&(Na.Kwa.style.cursor=""),!1;if(this.uY)return this.$ff(),!1;Na=this.$hd(Ea);if(!Na)return!1;Na.Kwa.style.cursor=!this.grid.gb&&this.lvd(Na)?this.isRow?"row-resize":"col-resize":"";G.g(Ea.Ca);return!0};this.Pp=()=>{this.lKb()};this.Cg=()=>{if((3===D.a.Db||v.a.Hp)&&this.grid.ha.ra.Pg){var Ea=
this.grid.ha.ra.ed;if(!(!Ea.isRow&&!Ea.gf||!this.domElement||Ea.isRow&&this.isRow&&!this.je.Mt.includes(Ea.top)||Ea.gf&&!this.isRow&&!this.je.Mt.includes(Ea.left))){var Na=this.grid.fg(Ea,this.je.Zi.paneType);if(Na){if(this.grid.Ej){const kb=this.isRow?Ea.bottom:Ea.right;this.oi=this.je.us(S.Range.Qc(Ea.bottom,Ea.right));if(!this.oi){y.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${kb}, is row ${this.isRow}`);
return}}this.FG||this.Qhh();Ea.isRow&&this.isRow?(C.DOMElementExtensions.setVisible(this.FG,!0),this.FG.style.top=Na.bottomRight.y-this.FG.offsetHeight/2+"px"):Ea.isRow||this.isRow||(C.DOMElementExtensions.setVisible(this.FG,!0),U.c(this.FG.style,this.grid.rtl,Na.bottomRight.x-this.FG.offsetWidth/2+"px"))}}}};this.aG=(Ea,Na)=>{J.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&y.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${Na.zM}`);
Na.zM&&this.wrb()};this.je=ya;this.isRow=ya.isRow;this.rtl=ya.Zi.rtl;this.grid=Ma;this.Tvf=this.isRow?e.a.Qzd:e.a.Dnc;this.nbi=aa.a.instance.ga(436);this.wbi=aa.a.instance.ga(435);this.qbi=aa.a.instance.ga(437);K.a(this.grid.$,Ea=>{this.cyd=Ea.vQ(I.a.goj,!1)});this.oej();this.grid.ha.bU(this.Cg);this.grid.ha.e3(this.Pp);this.grid.pv(this.Cg);na.a(this.grid.$).Zf.h$(this.aG)}get aCb(){return this.uY}get isResizeAllowed(){const Ma=(new T.a(this.grid.$.va)).Qd(this.isRow?16:8),ya=this.grid.$.rb.Mv,Ea=
this.grid.ji,Na=na.a(this.grid.$).Gp();return Ma&&!ya&&!Ea&&!Na}get ioj(){this.wth();return fa.Bdb}pza(Ma,ya,Ea){var Na=new Sys.UI.DomEvent(Ma);Na=u.a.create(x.a.Rha,this.domElement,Na,2);Na=W.a(this.grid.$).Vd(Na);this.POf(ya,Na.clientPoint.x,Na.clientPoint.y,!1,Ea,Ma);Ma=this.WAc();this.Mfd(this.NBa,Ma,!0);this.PAa||(Ma=this.domElement.ownerDocument.body,Ma.addEventListener(x.a.Rha,this.UEf),Ma.addEventListener(x.a.JHa,this.VEf),this.PAa=!0)}ITi(Ma,ya,Ea){this.POf(ya,Ma.clientX,Ma.clientY,!0,this.Rhf?
Ea:!1,Ma);Ma=this.grid;ya=this.Ijd(Ma);ya=M.r(ya,Ma.$);Ma.qb.Zg([this.isRow?13:14]);Ma.qb.PTa();this.lKb();Ma.$.Xc(this.isRow?146338636:1391094586,D.a.Db,30,{["autoFitRanges"]:ya})}dispose(){this.F3c();this.grid.ha&&(this.grid.ha.iS(this.Cg),this.grid.ha.u7(this.Pp));this.grid.Ny(this.Cg);na.a(this.grid.$)&&na.a(this.grid.$).Zf.Xda(this.aG);B.a.instance.Ba(x.a.Dk,this.domElement,this.Zca);n.a.instance.Ba(x.a.Rf,this.domElement.ownerDocument.body,this.uGb);r.a.instance.Ba(x.a.we,this.domElement.ownerDocument.body,
this.uGb);v.a.Hp||(n.a.instance.Ba(x.a.pointerDown,this.domElement,this.mO),n.a.instance.Ba(x.a.Mj,this.domElement,this.zI));this.PAa&&(n.a.instance.Ba(x.a.Mj,this.domElement.ownerDocument.body,this.lab),r.a.instance.Ba(x.a.$f,this.domElement.ownerDocument.body,this.lab),this.PAa=!1);this.FG&&(n.a.instance.Ba(x.a.pointerDown,this.FG,this.mO),B.a.instance.Ba(x.a.Dk,this.FG,this.Zca),this.F3c(),this.FG=null);this.a_f&&(C.DOMElementExtensions.tf(fa.Bdb),fa.Bdb=null);this.je=null;super.dispose()}oej(){B.a.instance.sa(x.a.Dk,
this.domElement,this.Zca);n.a.instance.sa(x.a.Rf,this.domElement.ownerDocument.body,this.uGb);r.a.instance.sa(x.a.we,this.domElement.ownerDocument.body,this.uGb);v.a.Hp||(n.a.instance.sa(x.a.pointerDown,this.domElement,this.mO),n.a.instance.sa(x.a.Mj,this.domElement,this.zI))}wth(){if(!fa.Bdb){document.getElementById(fa.$Zf);this.a_f=!0;var Ma=fa.Bdb=document.createElement("div");this.grid.$.frame.gba().appendChild(Ma);Ma.id=fa.$Zf;Ma.className=l.a.wyh;C.DOMElementExtensions.setVisible(Ma,!1)}}NQe(){if(this.PAa){const Ma=
this.domElement.ownerDocument.body;this.grid.Ej?(Ma.removeEventListener(x.a.Rha,this.UEf),Ma.removeEventListener(x.a.JHa,this.VEf)):(n.a.instance.Ba(x.a.Mj,Ma,this.lab),r.a.instance.Ba(x.a.$f,Ma,this.lab));this.PAa=!1}this.uY=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.bWf():(this.C_f(),this.TMd());Y.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}C_f(){this.grid.qb.Zg([this.isRow?13:14]);this.grid.qb.PTa()}mJg(){this.je.addRowColToModel(this.oi.Unb-
1,this.oi.cVf);this.WRb=!0}pEd(Ma){if(!this.uY)return!1;const ya=this.isRow;if(!this.grid.Ej&&!this.p1){this.p1=document.createElement("div");this.p1.style.cssText="position: relative; width: inherit; height: inherit;"+(ya?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Ea=this.oi.vK();Ea.nextSibling;)this.p1.appendChild(Ea.nextSibling);Ea.parentNode.appendChild(this.p1)}Ea=ya?Ma.y-this.q9a.y:(this.rtl?-1:1)*(Ma.x-this.q9a.x);const Na=ya?Ma.y-this.NBa.y:(this.rtl?-1:1)*(Ma.x-this.NBa.x),
kb=this.grid.Ej?this.bbb:this.oi.O4();if(kb===e.a.gxa)return!1;Ea&&(0<this.pl||0<kb+Na)&&kb+Na<=this.Tvf&&(this.pl=this.WAc(Na),this.Mfd(Ma,this.pl,!1),this.grid.Ej?this.pl>=fa.Ccf?(this.SOd=!0,this.oi.setCellExtent(this.pl)):this.SOd&&(this.SOd=!1,this.oi.setCellExtent(fa.Ccf)):(C.DOMElementExtensions.npa(this.oi.vK(),!ya,Math.max(this.bMb+Na,0)),this.p1.style[ya?"top":this.rtl?"right":"left"]=Math.max(Na,-this.bMb)+"px"),Ea=(this.grid.Ej?this.XLf:ya?this.oi.je.JC:this.oi.je.LC)+Math.max(Na,this.grid.Ej?
-this.bbb+fa.ffc:-this.bMb),C.DOMElementExtensions.npa(this.oi.je.domElement,!ya,Ea),this.grid.Ej&&this.oi.je.cwj(Ea),this.q9a=new Sys.UI.Point(Ma.x,Ma.y),C.DOMElementExtensions.setVisible(this.FG,!1));return!0}O4(){return this.oi?this.vY?fa.Dbi:this.oi.O4():e.a.gxa}Mfd(Ma,ya,Ea){this.CN&&Ea&&(y.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.TMd());this.CN||Ea||y.ULS.sendTraceTag(537154050,
2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.cyd&&this.cyd(()=>({["Location"]:"canvas"}));this.CN?this.T0e(ya):(this.CN=document.createElement("div"),this.CN.id=this.sbi,this.T0e(ya),this.CN.className=l.a.bxh,ya=document.getElementById(this.grid.$.Eb+m.a.Fxf),ya.insertBefore(this.CN,ya.firstChild),Ma=W.a(this.grid.$).qka(Ma),this.CN.style.left=(this.rtl?Math.max(Ma.x-this.CN.offsetWidth,0):Ma.x-Math.max(Ma.x+this.CN.offsetWidth-
ya.offsetWidth,0)).toString()+"px",ya=document.getElementById(m.a.Isa),this.CN.style.top=(Ma.y-(z.AFrameworkApplication.ta&&z.AFrameworkApplication.ta.Pa.Pe?0:ya.offsetHeight)-this.CN.offsetHeight).toString()+"px")}TMd(){C.DOMElementExtensions.tf(this.CN);this.CN=null}T0e(Ma){var ya=new Aa(this.grid.$.workbookContext.DxDigitNormal);ya=this.isRow?ya.EHe(Ma).toFixed(2):ya.uHe(Ma).toFixed(2);this.CN.innerText=`${this.isRow?this.nbi:this.wbi} ${ya} (${Ma.toString()} ${this.qbi})`}QOf(Ma,ya){let Ea;const Na=
J.EwaSettings.isChangeGateEnabled("OfficeVSO:7409830_AllowResize")?this.grid.isResizeAllowed(this.isRow):this.isResizeAllowed;if(-1!==this.grid.ha.selectionType||2===Ma.tb&&Ma.Ca.button!==Sys.UI.MouseButton.leftButton||!this.lvd(Ea=this.$hd(Ma))||!Na)return!1;G.g(Ma.Ca);this.NBa=this.q9a=new Sys.UI.Point(Ma.clientPoint.x,Ma.clientPoint.y);this.T_g(Ea,ya);if(!this.oi)return!1;this.uY=!0;this.wsi(this.oi,Ea)&&this.qfi();this.bMb=this.nhd();return this.ROf(Ma.Ca.rawEvent,ya)}POf(Ma,ya,Ea,Na,kb,lb){this.uY=
!0;this.vY=kb;this.oi=Ma;this.vkc=!1;this.NBa=this.q9a=new Sys.UI.Point(ya,Ea);Ma=this.oi.getRange();this.mS=kb?this.Tte(Ma):Ma;this.bbb=this.O4();this.XLf=this.isRow?this.oi.je.JC:this.oi.je.LC;this.ROf(lb,Na)}ROf(Ma,ya){const Ea=J.EwaSettings.fqd()&&this.grid.Ej?{["IsResizingHiddenHeader"]:this.vY,["IsAutoFitting"]:ya,["NumberOfSelectedRanges"]:this.grid.ha.ra.YF,["Location"]:"canvas",["ResizeRange"]:this.mS,["ResizedCellAbsoluteIndex"]:this.oi.Unb,["HeaderViewBlockHashCode"]:this.je.hashCode}:
{["IsResizingHiddenHeader"]:this.vY,["IsAutoFitting"]:ya,["NumberOfSelectedRanges"]:this.grid.ha.ra.YF,["Location"]:"canvas"};K.b(this.grid.$).vd(I.a.Ynj,Ea);this.grid.YFj&&(ya=ya?"header_resize_autofit":"header_resize_start",Q.b(this.grid.$).rCa(Ma,ya,void 0));this.offset=this.oi.rba();this.pl=this.grid.Ej?this.bbb:this.oi.O4();if(this.pl===e.a.gxa)return!1;Y.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}wsi(Ma,ya){var Ea=this.oi.vK();if(!Ea)return y.ULS.shipAssertTag(537154049,
2,!1,"cell being resized element received is null"),!1;Ea=Ea.nextSibling;if(!Ea)return!1;Ma=Ma.getRange();Ea=this.je.Ova(Ea).getRange();if(!Ma||!Ea)return y.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ma=this.isRow?Ma.bottom:Ma.right;Ea=this.isRow?Ea.bottom:Ea.right;return Ma+1!==Ea&&Ma!==Ea&&this.lvd(ya,!0)}qfi(){var Ma=this.oi.vK();const ya=this.je.Ova(Ma.nextSibling);fa.xsi(ya,this.isRow)?(this.oi=ya,this.mS=this.oi.getRange()):(this.nJg(Ma),this.oi=ya,Ma=this.oi.getRange(),
this.mS=this.Tte(Ma),this.vY=!0)}Tte(Ma){return this.isRow?new S.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.right,!1,!0):new S.Range(Ma.top,Ma.left-1,Ma.bottom,Ma.left-1,!1,!0)}nJg(Ma){const ya=this.je.Ova(Ma.nextSibling),Ea=fa.Rdh(ya,this.isRow,this.rtl);Ea&&Ma.parentNode.insertBefore(Ea,ya.vK())}Ijd(Ma){const ya=this.mS,Ea=Ma.ha.ra.selectedRanges;if(Ma.ha.ra.zub(ya))if(this.isRow){if(A.a.all(Ea,Na=>Na.isRow))return Ea}else if(A.a.all(Ea,Na=>Na.gf))return Ea;return[ya]}getCellExtent(){return this.oi.getCellExtent()}nhd(){const Ma=
this.oi.vK().style;return Math.max(0,Math.min(this.Tvf,0|parseInt(this.isRow?Ma.height:Ma.width,10)))}WAc(Ma=0){const ya=this.grid;var Ea=this.je.Zi.paneType;let Na;Na=this.isRow?3===Ea?[3,2]:[1,4]:4===Ea?[2,4]:[1,3];var kb=Math.max(this.grid.Ej?this.bbb:this.oi.O4(),0);Ma=this.vY&&!this.grid.Ej?Math.max(this.nhd(),0):Math.max(kb+Ma,0);Ea=ya.uYh(Ea,this.isRow);Ea=this.isRow?new h.a(0,this.offset,Ea,Ma):new h.a(this.offset,0,Ma,Ea);kb=[this.isRow?13:14];ya.qb.Ri(new S.Range(1,1,e.a.gh,e.a.uh,!1,!0),
kb,!1);ya.qb.Tn(kb,Ea,Na);return Ma}F3c(){this.mS=this.NBa=this.q9a=null;if(this.p1){const Ma=this.p1.parentNode;if(Ma)for(Ma.removeChild(this.p1);this.p1.firstChild;)Ma.appendChild(this.p1.firstChild);this.p1=null}this.oi=null;this.uY=!1;J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.bWf()}bWf(){this.vkc=!1;this.TMd();C.DOMElementExtensions.setVisible(fa.Bdb,!1);C.DOMElementExtensions.setVisible(this.FG,!1);J.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&
this.C_f()}$hd(Ma){if(C.DOMElementExtensions.Iz(Ma.Gb,"a"))return null;const ya=this.gof(Ma.Ca);if(ya&&this.grid.ha.ra.Pg){var Ea=this.grid.ha.ra.ed;Ea=this.je.us(S.Range.Qc(Ea.bottom,Ea.right))}else Ea=this.je.Ova(Ma.Gb);if(!Ea)return null;const Na=Ea.vK(),kb=new Sys.UI.Bounds(Na.offsetLeft,Na.offsetTop,Na.offsetWidth,Na.offsetHeight);var lb=C.DOMElementExtensions.getBoundingClientRect(Ma.Gb);lb=new Sys.UI.Point(Ma.clientPoint.x-lb.x,Ma.clientPoint.y-lb.y);this.isRow&&!ya&&(lb.y+=P.HelperMethods.sD(Ma.Gb,
Na,this.rtl).y);return new X(Na,lb,kb,Ea.getRange(),Math.max(fa.MHi,Math.min(fa.GGi,(this.isRow?kb.height:kb.width)*fa.hoj)),ya,!this.isRow&&0<Na.getElementsByTagName("input").length)}lvd(Ma,ya=!1){if(!Ma||this.grid.gb)return!1;if(Ma.fof)return!0;var Ea=Ma.HPa;const Na=Ma.Adb;var kb=this.je.Zi.paneType,lb=this.grid.Df(kb).ui,oa=!!lb&&lb.top===Ma.Smd.top,Ba=!!lb&&lb.left===Ma.Smd.left;kb=!!lb&&lb.bottom===Ma.Smd.bottom&&(3===kb||2===kb);this.isRow?(Ba=Ma.aFb.y,Ma=Ba<=Na&&!oa,Ea=Ba>=Ea.height-Na-(kb?
fa.NKh:0),ya=ya?Ma:Ea||Ma):(kb=Ma.nai,oa=this.rtl,lb=Ma.aFb.x,Ma=lb<=Na&&(!Ba||oa)&&(!kb||!oa),Ea=lb>=Ea.width-Na&&(!oa||!Ba)&&(!kb||oa),ya=ya?oa?Ea:Ma:Ma||Ea);return ya}T_g(Ma,ya){const Ea=this.isRow;if(Ma.fof)this.oi=this.je.Ova(Ma.Kwa);else if(Ea&&Ma.aFb.y<=Ma.Adb&&Ma.HPa.height>Ma.Adb||!Ea&&Ma.HPa.width>Ma.Adb&&(!this.rtl&&Ma.aFb.x<=Ma.Adb||this.rtl&&Ma.aFb.x>=Ma.HPa.width-Ma.Adb)){if(this.oi=Ma.Kwa.previousSibling?this.je.Ova(Ma.Kwa.previousSibling):this.IXh(),ya&&Ma.Kwa.classList.contains(Ea?
l.a.PWe:l.a.OWe)&&(Ma=this.je.Ova(Ma.Kwa)))Ma=Ma.getRange(),this.mS=Ea?new S.Range(Ma.top-1,Ma.left,Ma.top-1,Ma.right,!1,!0):new S.Range(Ma.top,Ma.left-1,Ma.bottom,Ma.left-1,!1,!0)}else this.oi=this.je.Ova(Ma.Kwa);!this.mS&&this.oi&&(this.mS=this.oi.getRange())}IXh(){var Ma=this.isRow?1:0;return(Ma=this.je.Zi.fC(this.je.Zi.Da.Ng(this.grid.$.na,d.a.aN(this.je.position.X+Ma-1,this.je.position.Y-Ma,this.je.position.PaneType))))?Ma.HXh():null}$ff(){this.vkc=!0;const Ma=this.ioj;C.DOMElementExtensions.setVisible(Ma,
!0);Ma.style.cursor=this.isRow?l.a.YTe:l.a.zSe;this.WAc()}Msh(Ma){this.grid.$.Xc(this.isRow?745189930:-445963340,D.a.Db,30,{["resizeRowColumnParameters"]:Ma})}Qhh(){const Ma=document.createElement("div");Ma.className=l.a.vzh;const ya=document.createElement("div");ya.className=f.a.fs;Ma.appendChild(ya);const Ea=document.createElement("img");Ea.src=H.a.de(0);Ea.className=this.isRow?f.a.tyh:f.a.oyh;ya.appendChild(Ea);this.je.SA.domElement.parentNode.insertBefore(Ma,this.je.SA.domElement);this.grid.Ej?
Ma.addEventListener(x.a.F$,this.KTi):(n.a.instance.sa(x.a.pointerDown,Ma,this.mO),B.a.instance.sa(x.a.Dk,Ma,this.Zca));C.DOMElementExtensions.setVisible(Ma,!1);this.FG=Ma}lKb(){this.F3c();this.FG&&(this.je.SA.domElement.parentNode.removeChild(this.FG),this.FG=null)}gof(Ma){return C.DOMElementExtensions.Af(this.FG,Ma.target)}wrb(){this.uY&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Ej&&this.pEd(this.NBa),this.NQe(),this.grid.Ej||C.DOMElementExtensions.npa(this.oi.vK(),
!this.isRow,this.bMb),this.lKb(),this.WRb=this.vY=!1)}fkf(){return J.EwaSettings.oa(631)}Jef(Ma){(Ma=Ma.Ca.rawEvent)&&Ma.detail===fa.Nsj&&(Ma.type===x.a.Mp?(this.uY=!1,this.S_c=!0):Ma.type===x.a.vI&&(this.uY=!0,this.S_c=!1))}static Ndh(Ma,ya){return new fa(Ma,ya)}static uTd(Ma,ya,Ea){if(ya){Ma.ColumnWidth=-1;Ma.RowHeight=Ea;for(const Na of Ma.SheetMultiRange.Ranges)Na.FirstColumn=0,Na.LastColumn=0}else{Ma.RowHeight=-1;Ma.ColumnWidth=Ea;for(const Na of Ma.SheetMultiRange.Ranges)Na.FirstRow=0,Na.LastRow=
0}}static xsi(Ma,ya){if(!Ma||!Ma.vK())return y.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Ea=Ma.getRange();Ma=Ma.vK().style;if(!Ea||!Ma)return y.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ma=ya?Ma.height:Ma.width;return(ya?Ea.top:Ea.left)===(ya?e.a.gh:e.a.uh)&&Ma===fa.hog}static Rdh(Ma,ya,Ea){if(!Ma)return y.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Na=Ma.vK();if(!Na||!Na.style)return y.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;Ma=document.createElement("div");const kb=Na.style;Ma.style.top=ya?kb.top:fa.hog;ya||(Ea?Ma.style.right=kb.right:Ma.style.left=kb.left);Ma.classList.add(ya?w.vyh:w.uyh);Ma.classList.add(ya?l.a.yvb:l.a.xvb);Ea=document.createElement("div");Ea.classList.add(ya?l.a.DWe:l.a.ocd);Na=ya?Number.parseInvariant(Na.innerText):S.Range.B1a(Na.innerText);Ea.innerText=ya?(Na-1).toString():S.Range.nQ(Na-1);Ma.appendChild(Ea);return Ma}}fa.MHi=0;fa.GGi=5;
fa.ffc=1;fa.Ccf=1;fa.Dbi=0;fa.NKh=3;fa.hoj=.1;fa.$Zf="ewa-rszrbg";fa.hog="0px";fa.Nsj=2;fa.Bdb=null;Object(t.a)(fa,"HeaderResizeBehavior",L.a,[613]);class Ca extends b.a{constructor(){super();this.Fb()}create(){this.ob(fa.Ndh)}static la(Ma){Ma.da.Ga(136,new Ca)}}Object(t.a)(Ca,"HeaderResizeBehaviorFactory",b.a,[]);var ia=a(55),Ra=a(695),Ya=a(48),Ga=a(37),da=a(171),Z=a(425),ha=a(374),Wa=a(188),ca=a(283),ja=a(282),ua=a(64),Za=a(21);class Pa{constructor(Ma,ya){this.isRow=!1;this.autoFitRange=null;this.isRow=
Ma;this.autoFitRange=ya}}Object(t.a)(Pa,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[145]);class ka{constructor(Ma){this.resizeParameters=null;this.resizeParameters=Ma}}Object(t.a)(ka,"MacroRecorderSheetRowsColumnsResizedPayload",null,[145]);var ra=a(83);b=a(285);var ba=a(22);class Ua extends b.a{constructor(Ma,ya){super(Ma);this.Dxb=Ea=>{Ea=this.qid(Ea);return this.Efd(Ea)};this.Znj=(Ea,Na)=>{var kb=this.N8a=Na[Ua.eni];1===Ea?(Ea=Na[Ua.DJj],kb=this.Q9e(Ea,kb),y.ULS.shipAssertTag(537153996,
0,kb!==Ua.Qba,`ResizeHeadersDialogHandler - invalid size input, size = ${Ea}`),Ea=kb!==this.Zod,y.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.N8a,kb,Ea),Ea&&this.rbh(kb)):y.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===ya.command;this.gridView=Za.h(this.$);this.Lwc=new Aa(this.$.workbookContext.DxDigitNormal);
this.Zod=this.s0g();Ma=this.Y$g(this.Zod);ya=this.$$g(this.Zod);this.Ql=aa.a.instance.ga(this.isRow?477:478);Ma=this.vN(Ma,ya);this.initializeAndShow(this.Ql,this.Znj,Ma);y.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get pc(){return"ResizeHeadersDialog"}get N8a(){return Ua.Fde}set N8a(Ma){Ua.Fde=Ma}vN(Ma,ya){return{[Ua.KV]:this.pc,[Ua.Lsi]:this.isRow,[Ua.Pfi]:Ma,[Ua.Ofi]:ya,[Ua.zpi]:this.N8a,[Ua.pid]:this.Dxb}}s0g(){const Ma=this.VNh();try{return this.ySh(Ma)}finally{Ma&&
Ma.dispose()}}rbh(Ma){const ya={};ya.SheetMultiRange=M.r(this.gridView.ha.ra.selectedRanges,this.$);Ua.uTd(ya,this.isRow,Ma);this.$.Xc(this.isRow?745189930:-445963340,D.a.Db,8,{["resizeRowColumnParameters"]:ya})}Q9e(Ma,ya){return ba.a.J5(Ma)?ya?this.X$g(Ma):this.Z$g(Ma):Ua.Qba}Z$g(Ma){return Math.floor(parseFloat(Ma))}X$g(Ma){Ma=parseFloat(Ma);return 0>Ma?Ua.Qba:Ma?this.isRow?P.HelperMethods.M4i(Ma):this.Lwc.N6g(Ma):0}$$g(Ma){return Ma===Ua.Qba?"":this.isRow?this.Lwc.EHe(Ma).toString():this.Lwc.uHe(Ma).toFixed(2)}Y$g(Ma){return Ma===
Ua.Qba?"":Ma.toString()}ySh(Ma){if(!Ma||!Ma.$$mn()||!Ma.ao)return Ua.Qba;var ya=Object(ra.a)(513,Ma.ao);if(!ya)return Ua.Qba;for(ya=this.isRow?ya.bAb:ya.Xod;Ma.$$mn();){const Ea=Object(ra.a)(513,Ma.ao);if(Ea&&(this.isRow?Ea.bAb:Ea.Xod)!==ya)return Ua.Qba}return ya}VNh(){const Ma=[];for(const Ea of this.gridView.ha.ra.selectedRanges){const Na=Ea.clone();var ya=this.gridView.Df(this.gridView.ib.Mi(Na));ya=Na.He(ya.ui);if(!ya)return null;this.isRow?Na.right=Na.left=ya.left:Na.top=Na.bottom=ya.top;Ma.push(Na)}return Ma.length?
this.gridView.kaa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ma):null}qid(Ma){if(!ba.a.J5(Ma))return 1;Ma=this.Q9e(Ma,this.N8a);if(0===Ma)if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){const ya=this.gridView.ha.ra.selectedRanges,Ea=this.gridView.$j("ResizeHeaderDialog");if(Ea){if(!Ea.pBe(ya,this.isRow))return 3}else if(this.Dmf())return 3}else if(this.Dmf())return 3;return this.Dvi(Ma)?0:2}Dmf(){const Ma=this.gridView.ha.ra.selectedRanges;return this.isRow&&
M.P(Ma)||!this.isRow&&M.O(Ma)}Efd(Ma){let ya="";switch(Ma){case 0:ya="";break;case 1:ya=aa.a.instance.ga(767);break;case 2:ya=String.format(aa.a.instance.mb(99),0,this.Odc(this.N8a));break;case 3:ya=aa.a.instance.ga(768)}return ya}Dvi(Ma){return 0<=Ma&&Ma<=this.Odc(!1)}Odc(Ma){return this.Lwc.Odc(Ma,this.isRow)}static uTd(Ma,ya,Ea){if(ya){Ma.ColumnWidth=Ua.Qba;Ma.RowHeight=Ea;for(const Na of Ma.SheetMultiRange.Ranges)Na.FirstColumn=0,Na.LastColumn=0}else{Ma.RowHeight=Ua.Qba;Ma.ColumnWidth=Ea;for(const Na of Ma.SheetMultiRange.Ranges)Na.FirstRow=
0,Na.LastRow=0}}}Ua.KV="id";Ua.Lsi="isRow";Ua.Pfi="initialSizeInPx";Ua.Ofi="initialSizeInDefaultUnits";Ua.zpi="isInitialUnitsDefaultUnits";Ua.pid="getInputErrorIfInvalid";Ua.DJj="size";Ua.eni="isDefaultUnits";Ua.Qba=-1;Ua.Fde=!0;Object(t.a)(Ua,"ResizeHeadersDialog",b.a,[]);var Ka=a(60);const Oa=(Ma,ya,Ea,Na,kb,lb,oa=null)=>{oa=Ma.Oa(41,oa);oa.resizeRowColumnParameters=ya;return Ka.g(Ma,"ResizeRowsColumns",oa,Ea,Na,kb,lb,0)};var ib=a(346),La=a(291),db=a(66),Ab=a(190),Mb=a(29),pb=a(348);class Qb{constructor(Ma,
ya,Ea){this.zXi=(Na,kb)=>{if(!ca.a(Na)&&kb){const lb=!!Na&&!!Na.RequestTelemetryData;Za.h(this.$).Eh.gma(kb,Na.StateId,lb?Na.RequestTelemetryData.EcsOperationDuration:0,lb?Na.RequestTelemetryData.EcsRequestDuration:0,lb?Na.RequestTelemetryData.WfeRequestDuration:0)}};this.ROi=(Na,kb)=>{kb&&kb.G2b&&kb.G2b.SheetName&&kb.G2b.Ranges.length&&kb.smi&&J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(this.VYd=kb.G2b.Ranges[0],this.Axa()?this.HFe(this.VYd):
this.grid.L0b(this.GGb))};this.GGb=()=>{this.Axa()&&(this.grid.Gvc(this.GGb),this.HFe(this.VYd))};this.$=Ma;this.qg=ya;this.gridInstantaneousAction=Ea;this.grid=Za.h(this.$);this.VYd=null}nc(Ma,ya){Ma=!0;switch(ya){case -445963340:case 1391094586:Ma=this.Qd(8);break;case 745189930:case 146338636:Ma=this.Qd(16)}return!Ma}executeCommand(Ma,ya,Ea){var Na=Za.h(this.$);const kb=ya.command;var lb=da.a.create().toString();let oa=Ga.TaskExtensions.Vj();switch(kb){case 1391094586:case 146338636:Ma=1391094586===
kb;(lb=Ea.autoFitRanges)&&lb.Ranges&&lb.Ranges.length||(lb=M.r(Na.ha.ra.selectedRanges,this.$));oa=this.Poh(Ma?1:0,lb,ya);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ma=-445963340===kb||-706918724===kb||369708605===kb;J.EwaSettings.U7a()&&-706918724===kb&&Na.Eh.l1(18,lb);if(-445963340===kb||745189930===kb){var Ba=Z.a(ya.command);Na.Eh.l1(16,lb,Ba);Na=Ea.resizeRowColumnParameters}else{Ea=Na.ha.ra.selectedRanges;let qb=0;for(var sa of Ea)if(-706918724===
kb||369708605===kb){const Jb=sa.right-sa.left+1;qb+=0<Jb?Jb:-1*Jb}else if(1542466017===kb||1051390410===kb)qb+=sa.bottom-sa.top+1;369708605===kb||1542466017===kb?y.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${qb}`):(-706918724===kb||1051390410===kb)&&y.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${qb}`);if(!J.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")||!Na.$j("ResizeCmdHandler")){if(-706918724===
kb&&6===ya.We&&M.O(Ea)){y.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===kb&&6===ya.We&&M.P(Ea)){y.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}sa=369708605===kb||1542466017===kb?-2:0;Na={};Na.SheetMultiRange=M.r(Ea,this.$);if(Ma)for(Ba of Na.SheetMultiRange.Ranges)Ba.FirstRow=0,Ba.LastRow=
0;else for(const Jb of Na.SheetMultiRange.Ranges)Jb.FirstColumn=0,Jb.LastColumn=0;Na.RowHeight=Ma?-1:sa;Na.ColumnWidth=Ma?sa:-1}oa=this.jph(Na,ya,lb,Ma);break;case 957527587:case 2040891415:new Ua(this.$,ya)}return oa}HFe(Ma){if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)){const ya=db.d(this.$.va.na),Ea=new ib.a(M.B(Ma),ya);Ga.TaskExtensions.za(Ya.GetServiceTaskFactory.Na(this.$.da,426,427,1),Na=>{void Na.result.IDc(Ea,"ColumnAutoFit")},
this.$.ka,3)}}yc(Ma,ya,Ea,Na){if(Ma=!!Ea&&!!Na&&1===Na.oz)switch(ya.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ma=!1}return Ma}Lc(){return!1}ZBi(Ma){y.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(La.c)(Ma)}. Reason: ${Object(La.c)(Ma)?void 0:Ma.reason}.`)}Qd(Ma){return(new T.a(this.$.va)).Qd(Ma)}Axa(){return this.grid.Da.qR(4,
this.$.na)}Poh(Ma,ya,Ea){const Na=this.$.pa.xa.Wb(),kb=0===Ma,lb=()=>new Pa(kb,ya);return ha.a(this.$.userOperationManager,(oa,Ba,sa)=>{var qb=this.$.pa.xa;oa=ja.b(oa,this.ROi);var Jb={smi:!kb,G2b:ya};const Yb=qb.Oa(41,Na);Yb.isRow=kb;Yb.autoFitRanges=ya;return Ka.g(qb,"AutoFit",Yb,oa,Ba,sa,Jb,0)},oa=>new Wa.a(135,0,oa,void 0,lb),Ea,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}jph(Ma,ya,Ea,Na){const kb=ya.command,lb=Za.h(this.$),oa=
M.g(Ma.SheetMultiRange.Ranges);if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Ba=1051390410===kb||745189930===kb&&0===Ma.RowHeight;const Yb=-706918724===kb||-445963340===kb&&0===Ma.ColumnWidth,jb=lb.$j("ResizeCmdHandler");if((Ba||Yb)&&null!=jb&&!jb.pBe(oa,!Na))return this.Znh(Na),Ga.TaskExtensions.Vj()}let sa;Ba=J.EwaSettings.U7a()&&-706918724===kb;if(745189930===kb||-445963340===kb||Ba)y.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ma.SheetMultiRange.SheetName,
"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Ba?Object(Ab.c)(()=>{lb.Eh.OFi()},this.$.ka,0):(sa=this.qg.UHj(lb,oa,Na?Ma.ColumnWidth:Ma.RowHeight,!Na),this.ZBi(sa),Object(La.c)(sa)&&lb.Eh.HS(Ea,ua.BasicTelemetryCalculator.jR));const qb=this.$.pa.xa.Wb({Fca:!0,Mba:3});Na=(Yb,jb,ab)=>{this.$.Py();M.i(oa,",",this.$,!1);return Oa(this.$.pa.xa,Ma,ja.b(Yb,this.zXi),jb,ab,Ea,qb)};const Jb=()=>new ka(Ma);return sa&&Object(La.c)(sa)?ha.a(this.$.userOperationManager,Na,Yb=>new Wa.a(136,
0,Yb,64,Jb),ya):ha.a(this.$.userOperationManager,Na,Yb=>new Wa.a(136,0,Yb,void 0,Jb),ya)}Znh(Ma){Ma=Mb.a.dd(1,0,Ma?769:771,Ma?770:772,0,Ma?-2037763134:503471870,Ma?"HideAllColumnsError":"HideAllRowsError");new pb.a(this.$,Ma)}}Object(t.a)(Qb,"ResizeCommandHandler",null,[219]);class xb extends Ra.a{constructor(Ma){super(Ma)}ld(){const Ma=Ya.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya);let ya;ya=J.EwaSettings.U7a?Ya.GetServiceTaskFactory.Na(this.$.da,528,529,this.Ya):ia.Task.Ra(null);
Ga.TaskExtensions.za(Ma,()=>{this.Zc([new Qb(this.$,Ma.result,ya.result)])},this.ka,3)}static la(Ma){Ra.a.Nd(113,new xb(Ma))}}Object(t.a)(xb,"ResizeCommandHandlerFactory",Ra.a,[]);a.d(E,"a",function(){return pa});const pa=()=>{c.a.Fa(Ma=>{Ca.la(Ma);xb.la(Ma)})}},1179:function(t,E,a){t=a(0);var c=a(133);class b extends c.StandardDialog{constructor(){super();this.Tb=0;this.qc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.iA(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,
null)}T9c(S){this.iA(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[414]);var e=a(15),f=a(156);class d{v1e(){e.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const S=new f.a;S.setResult("api.onedrive.com");return S.task}}Object(t.a)(d,"OneDriveConsumerEndpointHelper",null,[252]);var h=a(84),m=a(54),l=a(377),w=a(228);class n{constructor(S,H,C,G){this.qFa=this.O6=null;this.QTc=this.STc=!1;this.lYa=
null;this.nb=S;this.SSb=H;this.XEa=C;this.ht=G}get fve(){return this.SSb}get fa(){return this.nb}F5a(){this.lYa||(this.lYa=this.Vab?w.a.create(this.Vab,null,null,null,!1):null);return this.lYa}setup(S){this.qFa=S;this.STc||this.QTc?this.STc&&this.qFa&&this.qFa(!0):(S=this.F5a())?(this.QTc=!0,S.O9a.continueWith(H=>{this.qWi(H)}),l.a.gja(S)):(e.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.qFa(!1))}FEd(S){e.ULS.sendTraceTag(20509838,
352,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.")}qWi(S){this.QTc=!1;if(S.Of)this.FEd(S),this.qFa(!1);else try{this.STc=!0,e.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.dpd(),e.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.qFa(!0)}catch(H){e.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",H.toString()),this.qFa(!1)}}startPicker(S){this.O6=S;this.XEa?e.ULS.sendTraceTag(23881878,
216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.eDd,"onApiReady")))}eDd(S){S?this.hmc():this.uj()}uj(){this.ht().displayError(m.a.D0i)}onSuccess(S){e.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.O6&&this.O6(!0,S)}dispose(){this.lYa&&this.lYa.dispose()}}Object(t.a)(n,"AOneDriveFilePickerApiManager",null,[185,3]);class x extends n{constructor(S,
H,C,G,J,L){super(H,C,G,L);this.Lh=null;this.E2=S;this.cEg=J}get Vab(){return this.fa.Xa("OneDriveApiUrl")}start(S,H){this.Lh=S;this.startPicker(H)}dpd(){WL.init(1===this.fve||2===this.fve?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(S){this.O6=S;!this.XEa&&this.E2.lNa?(e.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(h.a)(this,this.eDd,"onApiReady"))):
(e.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.cEg())}hmc(){try{e.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Lh).then(Object(h.a)(this,this.onSuccess,"onSuccess"),Object(h.a)(this,this.N6,"onFailure"))}catch(S){e.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",S,S.stack),this.uj()}}N6(S){if(S&&S.error){if("user_canceled"===S.error.code){e.ULS.sendTraceTag(17909058,352,50,"User canceled.");
return}e.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",S.error.code,S.error.message)}else e.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.O6&&this.O6(!1,S);this.uj()}}Object(t.a)(x,"OneDriveFilePickerApiManagerV5",n,[]);class r extends n{constructor(S,H,C,G,J){super(S,H,C,G);this.kVb=this.vhe=null;this.hwg=J;this.options={};this.options.clientId=this.fa.Xa("OneDriveApiV7ClientId");this.options.cancel=Object(h.a)(this,
this.oDc,"toggleHostDivVisibility")}get Vab(){return this.fa.Xa("OneDriveApiV72Url")}start(S,H){this.kVb=H;const C=this.hwg.v1e();C.continueWith(()=>{e.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.vhe=C.result;this.startPicker((G,J)=>{this.oDc();S(G,J)})},3);C.continueWith(()=>{e.ULS.sendTraceTag(24134242,352,15,C.exception.message);this.oDc()},5)}dpd(){this.options.success=S=>{const H={};H.data=S;this.onSuccess(H)};this.options.error=
S=>{const H={};H.error=S;this.N6(H)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.vhe;this.options.advanced.iframeParentDiv=this.kVb}hmc(){try{e.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.oDc(),OneDrive.open(this.options)}catch(S){e.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",S.message),this.uj()}}N6(S){this.O6&&this.O6(!1,S);this.uj()}oDc(){this.kVb.style.visibility=
"hidden"===this.kVb.style.visibility?"":"hidden"}}Object(t.a)(r,"OneDriveFilePickerApiManagerV7",n,[]);class u extends n{constructor(S,H,C,G){super(S,H,C,G);this.Zsg=S;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Xa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get Vab(){return this.fa.Xa("OneDriveApiV72Url")}start(S,H,C,G){this.options.advanced.iframeParentDiv=C;this.options.advanced.endpointHint=G;this.options.cancel=H;this.Zsg.qa("OneDriveApiV72RecentsViewEnabled")&&
(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(S)}startPicker(S){this.O6=S;this.XEa?e.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(e.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(h.a)(this,this.eDd,"onApiReady")))}dpd(){this.options.success=
S=>{const H={};H.data=S;this.onSuccess(H)};this.options.error=S=>{const H={};H.error=S;this.N6(H)}}hmc(){try{e.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(S){e.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.uj()}}FEd(S){e.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",S.exception?S.exception.toString():"No error detail.");l.a.phj(this.Vab);
this.lYa=null}uj(){this.ht().T9c(m.a.Xqj)}N6(S){this.O6&&this.O6(!1,S)}}Object(t.a)(u,"OneDriveFilePickerApiManagerV72",n,[]);class v{constructor(S){this.olsSessionId=this.value=this.key=null;this.olsSessionId=S}}Object(t.a)(v,"IExtraData",null,[]);var B=a(4);class z extends u{constructor(S,H,C,G){super(S,H,C,G);this.options.advanced.filter=S.Xa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=B.AFrameworkApplication.nve;S.qa("OneDriveApiV72CommandModeEnabled")&&
(this.options.commandMode=S.Xa("OneDriveApiV72CommandMode")||"none");S.qa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new v(B.AFrameworkApplication.userSessionId))}get Vab(){return this.fa.Xa("OneDriveApiV72Url")}hmc(){try{e.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:
"",B.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(S){e.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",S.message,S.stack),this.uj()}}}Object(t.a)(z,"OneDriveFilePickerApiOpenManagerV72",u,[]);var A=a(241);class y{constructor(S){this.xk=null;this.Ah=S;this.TSc=3}v1e(){this.xk=new f.a;e.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.JRd();return this.xk.task}JRd(S=null){const H=
String.format("GetMoreInfoHandler.ashx?{0}",B.AFrameworkApplication.YIa);this.Ah.pha(H,1,null,S,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(h.a)(this,this.RYh,"getMoreInfoSucceeded"),Object(h.a)(this,this.PYh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}PYh(S){if(S.data.httpStatus===A.a.HIb&&"X-NewKey"in S.data.responseHeaders){e.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const H={};H["X-Key"]=S.data.responseHeaders["X-NewKey"];
this.JRd(H)}else 0<this.TSc?(e.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.TSc),this.TSc--,this.JRd()):(e.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.xk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}RYh(S){"PersonalFileStorageUrl"in S.data.responseHeaders&&""!==S.data.responseHeaders.PersonalFileStorageUrl?(e.ULS.sendTraceTag(24134239,
352,50,"Successfully received an ODB endpoint"),this.xk.setResult(S.data.responseHeaders.PersonalFileStorageUrl)):(e.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.xk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(t.a)(y,"OneDriveForBusinessEndpointHelper",null,[252]);var D=a(249),I=a(560);class M{constructor(){this.$a=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Oh(S){this.$a=
S;this.$a.register(x,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").wc().Ac(()=>new x(I.a.instance,B.AFrameworkApplication.fa,B.AFrameworkApplication.E3a,B.AFrameworkApplication.limitedEdit,B.AFrameworkApplication.S$f,()=>new b));B.AFrameworkApplication.tnf?this.$a.register(252,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").wc().Ac(()=>new d):this.$a.register(252,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").wc().Ac(()=>
new y(B.AFrameworkApplication.zd));this.$a.register(r,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").wc().Ac(()=>new r(B.AFrameworkApplication.fa,B.AFrameworkApplication.E3a,B.AFrameworkApplication.limitedEdit,()=>new b,this.$a.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.$a.register(u,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").wc().Ac(()=>new u(B.AFrameworkApplication.fa,B.AFrameworkApplication.E3a,B.AFrameworkApplication.limitedEdit,
()=>new b));this.$a.register(z,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").wc().Ac(()=>new z(B.AFrameworkApplication.fa,B.AFrameworkApplication.E3a,B.AFrameworkApplication.limitedEdit,()=>new b))}static main(){D.a.instance.vi(new M)}}Object(t.a)(M,"PackageManager",null,[4,5]);a.d(E,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");M.main()}},1186:function(t,E,a){t=a(0);var c=a(84),b=a(15),e=a(133),f=a(54),d=a(25);class h extends e.StandardDialog{constructor(aa,
U){super();this.mYa=!1;this.GA=null;this.La=aa;this.Kjb=U;this.QTa=!1}displayError(aa,U,K){this.GA=U;this.mYa=K;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",aa,K);aa=this.d3c(aa);0===aa?(this.Tb=6,this.qc(0,CommonUIStrings.l_DialogClose)):(this.Tb=0,this.qc(1,CommonUIStrings.l_DialogClose));0===aa&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.iA(f.a.Wqj,this.dhd(aa),this.mTh(aa,U),Object(c.a)(this,this.PPd,"retryDialogHandler"),!0)}PPd(aa){1===
aa?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.GA?this.La.$d(d.a.XLb,2,[this.GA,this.mYa]):this.La.processAction(d.a.XLb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}d3c(aa){return 0>aa||6<aa?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",aa),0):aa}mTh(aa,U){aa=this.d3c(aa);return this.Kjb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,U),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][aa]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,U),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][aa]}dhd(aa){aa=this.d3c(aa);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][aa]}}Object(t.a)(h,"ErrorRetryDialog",e.StandardDialog,[724]);class m{constructor(aa,U){this.nb=aa;this.La=U;this.Kjb=this.nb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new h(this.La,this.Kjb)}}Object(t.a)(m,"ErrorRetryDialogFactory",null,[707]);e=a(1052);var l=a(146);class w{static get og(){return l.a.jq(w.nl,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}w.nl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(t.a)(w,"FileNameDialogHtml",null,[]);var n=a(4),x=a(30);class r extends e.a{constructor(aa,U,K,Y,na,W){super(aa,U,K,Y,na,W);this.og=w.og;this.Ee="FileNameDialog-SaveAsToHost"}BQ(aa,U){const K=x.a.mq(n.AFrameworkApplication.sm.sn);U={["txtFileName"]:aa||K,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:U};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.Qac,"fileNameDialogHandler"),U);this.DNe(aa,K)}}Object(t.a)(r,"FileNameDialog",e.a,[723]);class u{constructor(aa,
U,K,Y,na,W){this.La=U;this.nb=aa;this.cY=Y;this.bha=W;this.ht=na;this.df=K}create(){return new r(this.nb,this.La,this.df,this.cY,this.ht,this.bha)}}Object(t.a)(u,"FileNameDialogFactory",null,[706]);var v=a(643),B=a(106);class z{constructor(aa,U,K){this.bha=K;this.uLc=U;this.nb=aa}Hg(){2===n.AFrameworkApplication.ta.Pa.Ij?n.AFrameworkApplication.ub.Me(d.a.XLb,B.a.frame,Object(c.a)(this,this.g1f,"saveAsToHostActionDispatcher"),4):n.AFrameworkApplication.ub.Nb(d.a.XLb,B.a.frame,Object(c.a)(this,this.g1f,
"saveAsToHostActionDispatcher"))}g1f(aa,U,K,Y,na){return U.contextId!==B.a.frame||aa!==d.a.XLb?2:this.nb.qa("SaveAsToHostBrsIsEnabled")?1===K?v.SessionStatusManager.instance.t6a||n.AFrameworkApplication.G5?8:32:2===K?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),aa=this.uLc.create(),na&&Object.getType(na)===Array&&2===na.length?aa.BQ(na[0],!!na[1]):aa.BQ(null,!1),32):8:8}}Object(t.a)(z,"SaveAsToHostActor",null,[]);var A=a(41),y=a(80),D=a(39),I=a(241),
M=a(376),T=a(164),S=a(644),H=a(769);class C{constructor(aa,U,K,Y,na,W,X,Aa){this.Mm=null;this.mYa=this.qEa=!1;this.aha=this.Lh=this.GA=null;this.nb=U;this.oGa=this.nb.appSettings.SaveAsToHostWebServiceBase;this.rce=Y;this.smb=na;this.Ah=K;this.ht=W;this.Ch=Aa;this.df=X;this.La=aa;this.$fa=U.Xa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}xOb(){1!==this.df.state&&(this.Mm=this.smb(),this.Mm.message=CommonUIStrings.l_CommentProgressTooltip,this.Mm.Tb=5,this.Mm.Lt=!1,this.Mm.HBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}ES(aa=0){1!==this.df.state&&this.ht.create().displayError(aa,x.a.mq(this.GA),this.mYa)}rRa(){const aa=this.nb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");D.a.kf(aa,D.a.TX(3),void 0,"UploadToHostManager.RedirectToFolder")}qRa(aa){let U=!1,K=!1;this.nb&&(U=this.nb.qa("SaveACopyIsEnabledForUiHost"),K=this.nb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
aa,U,K);if(U&&K){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Y={};Y[M.a.kRa]="1";Y[M.a.documentUrl]=aa;Y[M.a.reason]=S.a.saveAs;n.AFrameworkApplication.AV().execute(na=>{na.Sj(T.a.zua,Y)})}else U&&!K&&n.AFrameworkApplication.WV?D.a.kf(aa,D.a.TX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):D.a.kf(aa,D.a.TX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Foa(aa,U,K=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.rce&&!this.rce()&&this.Ah&&(this.Ch&&(this.aha=this.Ch.Cc("DialogShown","SaveAsToHostUploadTime")),this.xOb(),this.mYa=U,this.GA=aa,(this.Lh=K)&&"true"===this.Lh.SkipSaveToHost?this.nac():this.JQ())}JQ(){32!==this.La.processAction(d.a.ySa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.nac()):this.La.$d(d.a.ySa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.nac()},(aa,
U)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.ES(U)}])}P_i(aa){this.EJa();this.qEa=!1;if(aa&&aa.data&&aa.data.fe)if(({Gt:U}=A.d(aa.data.fe)).returnValue)if(aa=U,aa.StatusCode!==I.a.wP&&aa.StatusCode!==I.a.ttb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var U={};U.FailureReason=aa.StatusCode.toString();U.ExtraInfo=aa.ExtraInfo;this.aea(U);this.ES(parseInt(aa.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.COd();try{aa.NewDocumentUrl&&""!==aa.NewDocumentUrl?this.qRa(aa.NewDocumentUrl):this.rRa()}catch(K){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",K.toString())}this.nIb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:H.a.Egb(aa.data.fe)}),this.aea({["FailureReason"]:"Failed to deserialize response"}),this.ES();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.aea({["FailureReason"]:"null response"}),this.ES()}O_i(aa){5!==aa.data.status&&12!==aa.data.status||this.qEa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:aa.data.status,["HttpStatus"]:aa.data.httpStatus}),this.aea({["FailureReason"]:aa.data.httpStatus.toString()}),this.EJa(),this.ES(),this.nIb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.qEa=!0,this.Lh&&"true"===this.Lh.SkipSaveToHost?this.nac():
this.JQ())}EJa(){this.Mm&&(this.Mm.close(),this.Mm=null)}nIb(){this.aha&&(this.aha.stop(),this.aha=null)}COd(){this.Lh&&"VersionHistory"===this.Lh.SaveEntryPoint&&this.La.processAction(d.a.Awc,2)}aea(aa){this.Lh&&"VersionHistory"===this.Lh.SaveEntryPoint&&this.La.$d(d.a.EOd,2,aa)}nac(){let aa=this.oGa+this.$fa;aa=y.a.Cl(aa,"qs",x.a.lf(n.AFrameworkApplication.Hi));aa=y.a.Cl(aa,"n",x.a.lf((new Date).getTime().toString()));aa=y.a.Cl(aa,"ov",x.a.lf(this.mYa.toString()));aa=y.a.Cl(aa,"fn",x.a.lf(this.GA));
this.Lh&&this.Lh.FileDownloadUrl&&(aa=y.a.Cl(aa,"furl",x.a.lf(this.Lh.FileDownloadUrl)));this.Ah.Om(aa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.P_i,"onUploadFinished"),Object(c.a)(this,this.O_i,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(t.a)(C,"UploadToHostManager",null,[619]);var G=a(249),J=a(786);class L{constructor(){this.$a=null}get name(){return"Common.App.SaveAsToHost"}init(){n.AFrameworkApplication.fa.Iu(Object(c.a)(this,this.IB,
"onFullAppSettingsReady"))}IB(){n.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&this.$a.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Hg()}Oh(aa){this.$a=aa;this.$a.register(m,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ac(()=>new m(n.AFrameworkApplication.fa,n.AFrameworkApplication.ub)).wc();this.$a.register(C,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ac(()=>new C(n.AFrameworkApplication.ub,
n.AFrameworkApplication.fa,n.AFrameworkApplication.zd,()=>n.AFrameworkApplication.Og,()=>(new J.a).create(),aa.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.kE)).wc();this.$a.register(u,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ac(()=>new u(n.AFrameworkApplication.fa,n.AFrameworkApplication.ub,n.AFrameworkApplication.ta,n.AFrameworkApplication.ta.Pa,aa.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),
aa.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).wc();this.$a.register(z,"Common.App.SaveAsToHost.SaveAsToHostActor").Ac(()=>new z(n.AFrameworkApplication.fa,aa.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),aa.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).wc()}dispose(){}static main(){G.a.instance.vi(new L)}}Object(t.a)(L,"SaveAsToHostPackage",null,[4,5]);a.d(E,"a",function(){return P});const P=()=>{Type.registerNamespace("Common.App.SaveAsToHost");L.main()}},1187:function(t,
E,a){t=a(0);var c=a(84),b=a(15),e=a(146);class f{static get og(){return e.a.jq(f.nl,CommonUIStrings.l_SaveACopyFileName)}}f.nl="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(t.a)(f,"FileNameDialogHtml",
null,[]);var d=a(4),h=a(30);class m extends e.a{constructor(H,C,G,J){super();this.YUb=this.d9=null;this.La=H;this.cY=C;this.Nnb=G;this.qc(1,CommonUIStrings.l_SaveButtonLabel);this.og=f.og;this.Ee="FileNameDialog-SaveACopy";this.Lh=J}BQ(H,C,G){this.YUb=H;this.d9=G;H={["txtFileName"]:h.a.mq(d.AFrameworkApplication.sm.sn),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,C)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.Qac,"fileNameDialogHandler"),H);
b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}Qac(H,C){1!==H?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(H=C.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),C=h.a.L4(d.AFrameworkApplication.fileName),H&&""!==H&&""!==C&&(H+=C),this.Nnb.Foa(this.YUb,this.d9,H,this.Lh))}}Object(t.a)(m,"FileNameDialog",e.a,[727]);
class l{constructor(H,C,G){this.La=H;this.cY=C;this.Nnb=G}create(H){return new m(this.La,this.cY,this.Nnb,H)}}Object(t.a)(l,"FileNameDialogFactory",null,[710]);var w=a(133),n=a(25);class x extends w.StandardDialog{constructor(H){super();this.Tb=1;this.qc(1,CommonUIStrings.l_RetryButtonLabel);this.qc(0,CommonUIStrings.l_DialogClose);this.La=H}displayError(H){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",H);this.iA(H,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(c.a)(this,this.PPd,"retryDialogHandler"))}PPd(H){1===H?(b.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(n.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(t.a)(x,"RetryDialog",w.StandardDialog,[708]);w=a(1053);var r=a(837),u=a(377),v=a(106);class B extends w.a{constructor(H,C,G,J){super(H,C,G,J);this.jBg=C}V8a(){return this.nb.qa("SaveACopyBrsIsEnabled")}$0e(){return n.a.saveACopy}L3b(){u.a.RLd(Object(c.a)(this,
this.y1f,"saveToCloudActionDispatcher"));u.a.uad([new r.a(n.a.saveACopy,v.a.frame,0)],this.jBg.F5a())}FTf(){d.AFrameworkApplication.uya("CreateCopy_cf;CreateCopy_tf");b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(t.a)(B,"SaveACopyActor",w.a,[]);w=a(1056);class z extends w.a{constructor(H,C,G,J,L,P,aa){super(C,G,J,L,P,aa);this.Iwg=H}onSuccess(H){H&&H.data&&H.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),
this.Iwg.create(this.Lh).BQ(H.data.folders[0].id,H.data.folders[0].name,H.data.folders[0].urls.viewInBrowser)):(b.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.uj())}N6(H){H&&H.error&&"user_canceled"===H.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.N6(H)}uj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.uj()}}Object(t.a)(z,"SaveACopyManager",w.a,[]);var A=a(1054);class y extends A.a{constructor(H,
C,G,J,L,P){super(C,G,J,L,P);this.La=H}Ptd(){return!!this.Lh&&!!this.Lh.SaveEntryPoint&&"VersionHistory"===this.Lh.SaveEntryPoint.toString()}ES(){b.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Ptd()&&this.La.$d(n.a.EOd,2,{["FailureReason"]:"Unknown"});super.ES()}rRa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Ptd()&&this.La.processAction(n.a.Awc,2);super.rRa()}qRa(H){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",
H);this.Ptd()&&this.La.processAction(n.a.Awc,2);super.qRa(H)}JQ(){this.Lh&&"true"===this.Lh.SkipSaveToHost?super.JQ():32!==this.La.processAction(n.a.ySa,1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.JQ()):this.La.$d(n.a.ySa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");A.a.prototype.JQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.ES()}])}}Object(t.a)(y,"SaveACopyUploadToCloudManager",A.a,[]);var D=a(249),I=a(560),M=a(786);class T{constructor(){this.$a=null}get name(){return"Common.App.SaveACopy"}init(){d.AFrameworkApplication.fa.Iu(Object(c.a)(this,this.IB,"onFullAppSettingsReady"))}IB(){d.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.$a.resolve("Common.App.SaveACopy.SaveACopyActor").Hg()}dispose(){}Oh(H){this.$a=H;this.$a.register(y,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ac(()=>new y(d.AFrameworkApplication.ub,
H.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new M.a).create(),()=>new x(d.AFrameworkApplication.ub),d.AFrameworkApplication.ta,d.AFrameworkApplication.ta.kE)).wc();this.$a.register(l,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ac(()=>new l(d.AFrameworkApplication.ub,d.AFrameworkApplication.ta.Pa,H.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).wc();this.$a.register(B,"Common.App.SaveACopy.SaveACopyActor").Ac(()=>
new B(H.resolve("Common.App.SaveACopy.SaveACopyManager"),H.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.ta.kE)).wc();this.$a.register(z,"Common.App.SaveACopy.SaveACopyManager").Ac(()=>new z(H.resolve("Common.App.SaveACopy.FileNameDialogFactory"),H.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),I.a.instance,H.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),d.AFrameworkApplication.fa,d.AFrameworkApplication.E3a,
()=>new x(d.AFrameworkApplication.ub))).wc()}static main(){D.a.instance.vi(new T)}}Object(t.a)(T,"PackageManager",null,[4,5]);a.d(E,"a",function(){return S});const S=()=>{Type.registerNamespace("Common.App.SaveACopy");T.main()}},1188:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(15),f=a(30),d=a(83),h=a(243),m=a(36);class l extends h.a{constructor(G,J,L){super(G,J);this.$Gd=this.executionContext=null;this.m3i=(P,aa)=>{this.fIb(P,aa)};this.kK=L}initialize(G){super.initialize(G)}execute(G){this.executionContext=
G;G=Object(d.a)(7,this.executionContext.Fe);this.ktb(G);return 1}fJ(G){super.fJ(G)}ktb(){this.subscribe(this.executionContext,this.m3i,G=>{this.$Gd.add_disposing(G)})}fIb(G){this.unsubscribe(J=>{G.remove_disposing(J)});this.executionContext.activityState[m.a.V2]=0}}Object(t.a)(l,"PasswordProtectedFileActivity",h.a,[]);var w=a(285),n=a(262),x=a(13);class r extends w.a{constructor(G){super(G);this.qqa=0;this.Ibj=(J,L)=>{this.vcb(J,L)};this.q3d=(J,L)=>{this.CVa(J,L)}}get pc(){return"PasswordDialog"}get fub(){return this.qqa}get Ql(){return x.a.instance.ga(1976)}vcb(G){this.qqa=
G}U3(){const G={};G[w.a.description]=x.a.instance.ga(1977);G[w.a.e7]=x.a.instance.ga(1973);G[w.a.UMf]=x.a.instance.ga(1995);G[w.a.SMf]=x.a.instance.ga(1996);G[w.a.TMf]=x.a.instance.ga(1974);G[w.a.Eod]=x.a.instance.ga(1980);G[w.a.Rxe]=x.a.instance.ga(1661);G[w.a.q3j]=x.a.instance.Ua(25);G[w.a.Fmg]=this.q3d;return G}Pta(){const G={};G[n.a.yu]=this.pc;G[w.a.s0a]=this.U3();return G}hg(){this.Tb=1;this.initializeAndShow(this.Ql,this.Ibj,this.Pta())}}Object(t.a)(r,"PasswordProtectedFilePasswordInputDialog",
w.a,[]);var u=a(60),v=a(29),B=a(283),z=a(51);class A extends r{constructor(G){super(G);this.KPd=5;this.nde=!1;this.passwordToModify=null;this.VMf=()=>{this.$.isEditMode&&this.Rjc&&(z.b().sad("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.ul(this.VMf))};this.hg();this.$.$k(this.VMf)}get Rjc(){return this.nde}get Ql(){return x.a.instance.ga(1978)}vcb(G,J){super.vcb(G,J);e.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${G}`)}CVa(G,
J){this.passwordToModify=G;const L={};L.FileModifyPassword=f.a.lf(G);u.M(this.$.pa.xa,L,this.U_i(J),this.T_i(J),null,null)}U3(){const G=super.U3();G[w.a.Eod]=x.a.instance.ga(1981);G[w.a.description]=x.a.instance.Ua(24);return G}hg(){z.b().sad("PasswordToModifyDialogShown");e.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.hg()}U_i(G){return J=>{v.a.fh(J.Errors,[-2019873242])&&this.Z8b(this.atb());if(!J||B.a(J))if(0<
this.KPd)this.gSf(G);else{e.ULS.sendTraceTag(537154754,0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${v.a.sc(J.Errors)}`);this.$.ea.To(J.Errors);this.hide();return}this.nde=J.Result;this.Rjc&&(z.b().aYd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),e.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
G(this.Rjc?0:1)}}T_i(G){return()=>{0<this.KPd?this.gSf(G):(e.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),G(3))}}gSf(G){--this.KPd;this.CVa(this.passwordToModify,G)}atb(){return v.a.dd(1,0,1660,1661,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(t.a)(A,"PasswordProtectedFileModifyPasswordInputDialog",r,[]);var y=a(6);class D extends l{constructor(G,J,L){super(G,J,L)}ktb(G){this.$Gd=
new A(G);super.ktb(G)}fIb(G,J){const L=G.fub,P=G.Rjc,aa=G.passwordToModify;super.fIb(G,J);this.executionContext.Lya([2001366804]);switch(L){case 1:P?(J=Object(d.a)(7,this.executionContext.Fe),this.executionContext.activityState[m.a.Kpe]=f.a.lf(aa),this.executionContext.activityState[m.a.JZa]=!0,G.passwordToModify="",this.jh(J.isEditMode?y.a.Lj:this.cK)):e.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Kp();break;case 0:this.executionContext.activityState[m.a.$r]=!1;this.jh(this.kK);this.Kp();break;default:e.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${L}'`)}}}Object(t.a)(D,"PasswordProtectedFileModifyActivity",l,[]);class I extends b.a{constructor(G,J,L,P){super();this.activityName=G;this.cK=J;this.kK=L;this.$=P;this.Fb()}create(){this.ob(new D(this.activityName,this.cK,this.kK))}static la(G){G.da.Ga(434,new I(y.a.eIb,
y.a.wgb,y.a.csb,G))}}Object(t.a)(I,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var M=a(44);class T extends r{constructor(G,J){super(G);this.password=null;this.Hof=J;this.hg()}CVa(G,J){this.password=G;J(0)}U3(){const G=super.U3();this.Hof&&(G[w.a.Pth]=1);return G}hg(){e.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.Hof}`);super.hg();M.a(this.$).Wte()}}Object(t.a)(T,"PasswordProtectedFileOpenPasswordInputDialog",
r,[]);class S extends l{constructor(G,J,L){super(G,J,L)}ktb(G){const J=v.a.fh(this.executionContext.errors,[1217361942]);this.$Gd=new T(G,J);G.Qhc||G.jNe();super.ktb(G)}fIb(G,J){let L,P;L=G.password;G.password="";P=G.fub;super.fIb(G,J);this.executionContext.activityState[m.a.dXc]=f.a.lf(L);this.executionContext.activityState[m.a.JZa]=!0;this.executionContext.Lya([110414285,1217361942]);e.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${P}`);
switch(P){case 1:this.jh(this.cK);this.Kp();break;case 0:this.jh(this.kK),this.Kp()}}}Object(t.a)(S,"PasswordProtectedFileOpenActivity",l,[]);class H extends b.a{constructor(G,J,L,P){super();this.activityName=G;this.cK=J;this.kK=L;this.$=P;this.Fb()}create(){this.ob(new S(this.activityName,this.cK,this.kK))}static la(G){G.da.Ga(386,new H(y.a.usc,y.a.Lj,y.a.Yj,G))}}Object(t.a)(H,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(E,"a",function(){return C});const C=()=>{c.a.Fa(H.la);c.a.Fa(I.la)}},
1195:function(t,E,a){t=a(0);var c=a(133);class b extends c.StandardDialog{constructor(){super();this.Tb=0;this.qc(1,CommonUIStrings.l_DialogClose)}displayError(S){this.iA(S,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(t.a)(b,"ErrorDialog",c.StandardDialog,[708]);var e=a(1056),f=a(1053),d=a(15),h=a(84),m=a(4),l=a(253),w=a(39),n=a(25);class x extends c.StandardDialog{constructor(S,H,C){super();this.La=S;this.E2=H;this.cY=C;this.ew=!1;this.Tb=1;this.a1(1);
this.qc(1,CommonUIStrings.l_SignIn);this.qc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}BQ(){this.E2.VZa(Object(h.a)(this,this.LJf,"onSignIn"));this.$l(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(h.a)(this,this.hii,"inputHandler"))}hii(S){0===S?(d.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.d7()}v3g(){let S="2";if(this.cY)switch(this.cY.Ij){case 3:S="0";break;case 2:S="3";break;case 1:S="1"}return S}hide(){this.E2.uKb(Object(h.a)(this,
this.LJf,"onSignIn"));super.hide()}d7(){var S=m.AFrameworkApplication.fa.qa("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";S=new l.QueryStringBuilder(S);S.oj("prompt","1");S.oj("cbcxt",this.v3g());m.AFrameworkApplication.MZa(S);w.a.kf(S.toString(),"LoginWindow",void 0,"SignInDialog")}LJf(){this.ko&&this.hide();d.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(n.a.saveToCloudStorage,2)}}Object(t.a)(x,
"SignInDialog",c.StandardDialog,[726]);class r{constructor(S,H,C){this.La=S;this.E2=H;this.cY=C}create(){return new x(this.La,this.E2,this.cY)}}Object(t.a)(r,"SignInDialogFactory",null,[711]);var u=a(80),v=a(30);class B{constructor(S,H,C,G,J,L,P){this.oGa=S;this.GA=H;this.dXa=C;this.YUb=G;this.oSc=J;this.$fa=L;this.Lh=P}execute(S,H){if(!m.AFrameworkApplication.Og&&m.AFrameworkApplication.zd){var C=this.oGa+this.$fa;C=u.a.Cl(C,"fo",v.a.lf(this.YUb));C=u.a.Cl(C,"fn",v.a.lf(this.GA));C=u.a.Cl(C,"qs",
v.a.lf(this.oSc));C=u.a.Cl(C,"n",v.a.lf((new Date).getTime().toString()));this.Lh&&this.Lh.FileDownloadUrl&&(C=u.a.Cl(C,"furl",v.a.lf(this.Lh.FileDownloadUrl)));this.dXa&&(C=u.a.Cl(C,"fnn",v.a.lf(this.dXa)));m.AFrameworkApplication.zd.Om(C,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,S,H,null)}}}Object(t.a)(B,"SkyDriveUploadCaller",null,[725]);class z{constructor(S){this.nb=S;this.pGa=S.appSettings.SkyDriveUploadWebServiceBase;this.GA=S.appSettings.FileName;this.$fa=S.Xa("SkyDriveUploadHandler")||
"skydriveuploadhandler.ashx"}create(S,H,C){return new B(this.pGa,this.GA,H,S,m.AFrameworkApplication.Hi,this.$fa,C)}}Object(t.a)(z,"SkydriveUploadCallerFactory",null,[709]);var A=a(1054),y=a(249),D=a(560),I=a(786);class M{constructor(){this.$a=null}get name(){return"Common.App.SaveToCloudStorage"}init(){m.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.$a.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Hg()}dispose(){}Oh(S){this.$a=S;this.$a.register(r,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ac(()=>
new r(m.AFrameworkApplication.ub,D.a.instance,m.AFrameworkApplication.ta.Pa)).wc();this.$a.register(z,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ac(()=>new z(m.AFrameworkApplication.fa)).wc();this.$a.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ac(()=>new f.a(S.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),S.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.ta.kE)).wc();this.$a.register(A.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ac(()=>new A.a(S.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new I.a).create(),()=>new b,m.AFrameworkApplication.ta,m.AFrameworkApplication.ta.kE)).wc();this.$a.register(e.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ac(()=>new e.a(S.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),D.a.instance,S.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
m.AFrameworkApplication.fa,m.AFrameworkApplication.E3a,()=>new b)).wc()}static main(){y.a.instance.vi(new M)}}Object(t.a)(M,"PackageManager",null,[4,5]);a.d(E,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");M.main()}},1196:function(t,E,a){t=a(0);var c=a(84),b=a(15),e=a(4),f=a(54),d=a(421),h=a(82);class m{constructor(A,y,D,I){this.bQc=null;this.iUb=I;this.yY=A;this.zY=y;this.rE=D;this.Ble=this.svf.IEj;A=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.sAg=A[0];this.rAg=A[1]}get svf(){return this.bQc||(this.bQc=h.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Nwa(){return CommonUIStrings.l_OICErrorHelpLink}get nAc(){return this.Ble}get uvf(){return this.sAg}get tvf(){return this.rAg}get rvf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Ble?3:2}get fvb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get V5b(){return!!this.zY}get gvb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Ql(){return CommonUIStrings.l_DefaultDialogTitle}GKd(A){this.ZFb(A)}Qwd(A){this.ZFb(A)}ZFb(A){let y=
10;this.zY&&1===A&&(this.zY(this.rE),y=1);this.yY&&this.yY(this.rE);this.mG(y)}IPa(){d.Redirect.showHelp("OICFailure");this.mG(2)}UCd(){this.svf.Qqf();this.mG(4)}mG(A){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.iUb,A);e.AFrameworkApplication.rwc(f.a.FLf,this.iUb,A)}dispose(){this.rE=this.yY=this.zY=null}}Object(t.a)(m,"AOICErrorDialog",null,[3]);var l=a(45),w=a(133);class n extends m{constructor(A,y,D,I){super(A,y,D,I);this.jra=this.nm=null;A=
document.createElement("span");A.id="errorMessageText";A.innerText=this.errorMessage;A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));this.nm=document.createElement("a");this.nm.href="#";this.nm.innerText=this.Nwa;A.appendChild(this.nm);l.a.addHandler(this.nm,"click",Object(c.a)(this,this.IPa,"oicErrorHelpLinkHandler"));y=new w.StandardDialog;y.Ee=this.id;this.nAc?(D=document.createElement("span"),I=document.createElement("span"),D.innerText=this.uvf,I.innerText=
this.tvf,this.jra=document.createElement("a"),this.jra.href="#",this.jra.innerText=this.rvf,A.appendChild(document.createElement("br")),A.appendChild(D),A.appendChild(this.jra),A.appendChild(I),l.a.addHandler(this.jra,"click",Object(c.a)(this,this.UCd,"oicErrorMacOfferLinkHandler"))):this.V5b&&(A.appendChild(document.createElement("br")),A.appendChild(document.createElement("br")),D=document.createElement("span"),D.innerText=this.fvb,A.appendChild(D));this.V5b?(y.Tb=1,y.qc(1,this.gvb)):y.Tb=0;y.$l(this.Ql,
null,this.icon,Object(c.a)(this,this.Qwd,"legacyOICErrorDialogHandler"),A);y.wX("errorMessageText")}dispose(){this.nm&&(l.a.removeHandler(this.nm,"click",Object(c.a)(this,this.IPa,"oicErrorHelpLinkHandler")),this.nm=null);this.jra&&(l.a.removeHandler(this.jra,"click",Object(c.a)(this,this.UCd,"oicErrorMacOfferLinkHandler")),this.jra=null);super.dispose()}}Object(t.a)(n,"OICErrorDialog",m,[]);class x{constructor(A,y,D){this.yY=y;this.zY=A;this.rE=D}get id(){return"OICErrorDialogWithDownload"}get HRe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Nwa(){return CommonUIStrings.l_OICErrorHelpLink}get fvb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get gvb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Ql(){return CommonUIStrings.l_DefaultDialogTitle}GKd(A){this.ZFb(A)}Qwd(A){this.ZFb(A)}ZFb(A){let y=
10;1===A&&(this.zY(this.rE),y=1);this.yY&&this.yY(this.rE);this.mG(y)}IPa(){d.Redirect.showHelp("OICFailure");this.mG(2)}mG(A){e.AFrameworkApplication.rwc(f.a.GLf,3,A)}dispose(){this.rE=this.zY=this.yY=null}}Object(t.a)(x,"AOICErrorDialogWithDownload",null,[3]);class r extends x{constructor(A,y,D){super(A,y,D);this.nm=null;A=document.createElement("span");A.id="errorMessageText";A.innerText=this.HRe;A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));this.nm=document.createElement("a");
this.nm.href="#";this.nm.innerText=this.Nwa;A.appendChild(this.nm);l.a.addHandler(this.nm,"click",Object(c.a)(this,this.IPa,"oicErrorHelpLinkHandler"));A.appendChild(document.createElement("br"));A.appendChild(document.createElement("br"));y=document.createElement("span");y.innerText=this.fvb;A.appendChild(y);y=new w.StandardDialog;y.Ee=this.id;y.Tb=1;y.qc(1,this.gvb);y.$l(this.Ql,null,this.icon,Object(c.a)(this,this.Qwd,"legacyOICErrorDialogHandler"),A);y.wX("errorMessageText")}dispose(){this.nm&&
(l.a.removeHandler(this.nm,"click",Object(c.a)(this,this.IPa,"oicErrorHelpLinkHandler")),this.nm=null);super.dispose()}}Object(t.a)(r,"OICErrorDialogWithDownload",x,[]);var u=a(146);class v extends m{constructor(A,y,D,I){super(A,y,D,I);y={["errorMessage"]:this.errorMessage};y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Nwa,["onExecute"]:M=>{this.IPa(M)}};this.nAc?(y.macOfficePreLinkText=this.uvf,y.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.rvf,
["onExecute"]:M=>{this.UCd(M)}},y.macOfficePostText=this.tvf):this.V5b&&(y.errorFileDownloadOffer=this.fvb);A=new u.a(!1,!1,!0);this.V5b?(A.Tb=1,A.qc(1,this.gvb)):A.Tb=0;A.Ee=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};A.initializeAndShow(this.Ql,Object(c.a)(this,this.GKd,"reactOICErrorDialogHandler"),y)}}Object(t.a)(v,"ReactOICErrorDialog",m,[]);class B extends x{constructor(A,y,D){super(A,y,D);y={["errorMessage"]:this.HRe,["errorFileDownloadOffer"]:this.fvb};y.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Nwa,["onExecute"]:I=>{this.IPa(I)}};A=new u.a(!1,!1,!0);A.Tb=1;A.qc(1,this.gvb);A.Ee=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};A.initializeAndShow(this.Ql,Object(c.a)(this,this.GKd,"reactOICErrorDialogHandler"),y)}}Object(t.a)(B,"ReactOICErrorDialogWithDownload",x,[]);a.d(E,"a",function(){return z});class z{constructor(){this.Lkb=!!e.AFrameworkApplication.ta&&e.AFrameworkApplication.ta.Pa.Lv}gfh(A,y,D){this.Lkb?
new v(A,y,null,D):new n(A,y,null,D)}hfh(A,y,D){this.Lkb?new B(A,y,D):new r(A,y,D)}ifh(A,y,D,I,M){const {ReactOICErrorDialogWithTrial:T}=a(1339),{OICErrorDialogWithTrial:S}=a(1340);this.Lkb?new T(A,y,D,null,I,M):new S(A,y,D,null,I,M)}static get instance(){return z.Ma||(z.Ma=new z)}}z.Ma=null;Object(t.a)(z,"OICErrorDialogFactory",null,[671])},1214:function(t,E,a){var c=a(9);t=a(0);var b=a(695),e=a(21),f=a(40),d=a(1),h=a(15),m=a(30),l;(function(I){I[I.url=0]="url";I[I.ref=1]="ref";I[I.mailto=2]="mailto"})(l||
(l={}));Object(t.b)("HyperlinkSelectionState",l);var w=a(773),n=a(8),x=a(585),r=a(60),u=a(88),v=a(13);class B extends w.a{constructor(I,M,T){super(I);this.kob=0;this.ZAb=!1;this.X2a=null;this.wNe=!1;this.Osb=!0;this.Ql=this.NWc=null;this.HBd=0;this.FBd=this.IBd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.$ci=(S,H)=>{1===S||2===S?(h.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===S?"OK":"Remove"} pressed`),this.IBd=H[B.ozi],this.HBd=H[B.qtj],this.FBd=H[B.koh],2===S&&(this.removeHyperLink=
!0),this.commit()):h.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.Z2j=(S,H)=>0!==H&&S.length?1===H?this.O3e(f.y(S,this.ea.va)||this.gJi(S),760):this.O3e(m.a.zrd(S),762):null;this.selectedRange=M;this.AM=T;this.ea=I.ea;this.sheetName=M.SheetName;this.UMa();this.wq();this.Tb=this.ZAb?9:1;this.qc(1,v.a.instance.ga(4));this.ZAb&&(h.ULS.sendTraceTag(509690183,0,50,"Edit HyperLink was called."),this.qc(2,v.a.instance.ga(763)));this.initializeAndShow(this.Ql,this.$ci,{[B.yu]:this.pc,
[B.$2j]:this.Z2j,[B.DWg]:{[B.unh]:this.wNe,[B.loh]:this.X2a,[B.DHg]:this.kob,[B.EHg]:this.NWc,[B.zah]:this.Osb}})}get pc(){return"HyperLinkDialog"}C5e(I,M){switch(M){case 2:return I.startsWith("mailto:")?I:"mailto:"+I;case 1:return`${n.a.AOf}${this.ZXh(I)}`;default:return I}}get dC(){return 526}nH(){const I=this.$;this.location=this.C5e(this.IBd,this.HBd);try{this.location=u.a.xf(this.location)}catch(S){h.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}h.ULS.sendTraceTag(555755667,0,
50,`Committing ${l[this.HBd]} link`);this.cellValue=this.FBd.length?this.FBd:this.IBd;I.Py();const M=I.pa.xa.Wb(),T=f.s(this.selectedRange);return(S,H,C)=>r.b(I.pa.xa,T,this.cellValue,this.location,this.removeHyperLink,!1,123,S,H,C,this.AM.range,M)}ik(){const I=f.s(this.selectedRange);return()=>new x.a(I,this.cellValue,this.location)}WEh(){let I=this.AM.cell.M6a;this.AM.cell.Gwa?I&&I.startsWith("mailto:")?(this.kob=2,I=I.substr(7)):this.kob=0:this.kob=1;return I}UMa(){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?
this.ZAb=this.AM.wba:this.ZAb=!!this.AM.xLa(64)||!!this.AM.xLa(128)}wq(){if(this.ZAb){this.X2a=this.AM.text;const I=this.WEh();I&&(this.NWc=I);this.Ql=v.a.instance.ga(827);this.Osb=this.NWc===this.X2a}else this.AM.text?(this.X2a=this.AM.text,this.Osb=!1):(this.X2a="",this.Osb=!0),this.kob=0,this.Ql=v.a.instance.ga(826);this.AM.pB&&(this.Osb=!1,this.wNe=!0,d.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.X2a=this.AM.formulaBarText))}gJi(I){return this.ea.Cb.Rk(I)}O3e(I,
M){return I?null:v.a.instance.ga(M)}ZXh(I){let M,T;({sheetName:M,range:T}=f.Z(I,this.ea.va)).returnValue&&T&&(I=f.x(T,M||this.sheetName,!1));return I}}B.$2j="validateLinkValues";B.DWg="bodyProps";B.unh="disableDisplayText";B.loh="displayTextValue";B.DHg="activeLinkOption";B.EHg="activeLinkValue";B.zah="copyLinkValueToDisplay";B.ozi="linkValue";B.qtj="selectedLink";B.koh="displayText";Object(t.a)(B,"HyperlinkDialog",w.a,[]);var z=a(55);class A{constructor(I,M){this.$=I;this.gridView=M}nc(){return!1}yc(I,
M){return 1===I&&-1583422759===M.command}Lc(){return!1}executeCommand(){this.NHj();return z.Task.Ra(!0)}NHj(){const I=f.v(this.gridView.ha.ra.ed,this.$),M=e.f(this.gridView);(!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.aq([this.gridView.ha.ra.ed],!0))&&M&&new B(this.$,I,M)}}Object(t.a)(A,"ShowHyperlinkCommandHandler",null,[219]);class y extends b.a{constructor(I){super(I)}ld(){this.Zc([new A(this.$,e.h(this.$))])}static la(I){b.a.Nd(105,
new y(I))}}Object(t.a)(y,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return D});const D=()=>{c.a.Fa(y.la)}},1215:function(t,E,a){var c=a(9);t=a(0);var b=a(4),e=a(106),f=a(695),d=a(60),h=a(48),m=a(37),l=a(15),w=a(184),n=a(25),x=a(55);class r{constructor(y,D){this.$=y;this.Wh=D}nc(){return!1}executeCommand(y,D,I){y=2;switch(D.command){case -309686558:y=this.Wh.$d(n.a.saveACopy,2,I);break;case 617689800:y=this.Wh.$d(n.a.saveToCloudStorage,2,I);break;case -1244760097:y=this.Wh.$d(n.a.saveToSharePoint,
2,I)}return 2===y&&D?w.a(D.command):x.Task.Ra(!0)}yc(y,D){y=!1;switch(D.command){case -1244760097:case -309686558:case 617689800:y=!0,l.ULS.shipAssertTag(537153984,0,this.$.nla,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return y}Lc(){return!1}}Object(t.a)(r,"SaveToHostCommandHandler",null,[219]);class u extends f.a{constructor(y){super(y);this.IJh=(D,I,M,T,S)=>1===M?32:D===n.a.ySa&&2===M?(D=this.$.pa.xa.Wb(),d.C(this.$.pa.xa,S[0],S[1],null,null,D),32):8}ld(){m.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,
155,this.ka,this.Ya),()=>{this.Zc([new r(this.$,b.AFrameworkApplication.ub)])},this.ka,3);b.AFrameworkApplication.ub.Nb(n.a.ySa,e.a.frame,this.IJh)}static la(y){f.a.Nd(267,new u(y))}}Object(t.a)(u,"SaveToHostCommandHandlerFactory",f.a,[]);var v=a(222);class B{constructor(y,D){this.$=y;this.Wh=D;this.$.da.Ga(393,this)}nc(y){switch(y){case -309686558:return 8===this.Wh.processAction(n.a.saveACopy,1,null);case 617689800:return 8===this.Wh.$d(n.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.Wh.$d(n.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(t.a)(B,"SaveToHostManager",null,[609,3]);class z extends v.a{constructor(y){super();this.$=y;this.Fb()}create(){this.ob(this.$.da.Aa(393)||new B(this.$,b.AFrameworkApplication.ub))}static la(y){y.da.Ga(394,new z(y))}}Object(t.a)(z,"SaveToHostManagerFactory",v.a,[]);a.d(E,"a",function(){return A});const A=()=>{c.a.Fa(u.la);c.a.Fa(z.la)}},1216:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(15),f=a(83),d=a(114),h=a(29),
m=a(36);class l extends d.a{constructor(H,C){super(H,C)}execute(H){const C=Object(f.a)(7,H.Fe);e.ULS.shipAssertTag(537153921,0,h.a.Npb(H.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");C.DI(!0,!0);H.activityState[m.a.X_b]=C.ea.sessionId;H.activityState[m.a.nob]=!0;H.activityState[m.a.c0b]=!0;e.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(t.a)(l,"SessionReloadActivity",d.a,
[]);var w=a(6);class n extends b.a{constructor(){super();this.Fb()}create(){this.ob(new l(w.a.geb,w.a.rz))}static la(H){H.da.Ga(142,new n)}}Object(t.a)(n,"SessionReloadActivityFactory",b.a,[]);var x=a(58),r=a(267),u=a(109),v=a(47),B=a(46),z=a(35),A=a(1),y=a(42),D=a(247),I=a(115);class M extends d.a{constructor(H,C,G,J,L){super(H,C);M.jzd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];M.izd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
M.mvf=[-1468309555,611268539,-1750576502,61029505];M.lvf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.bBc=G;this.xJj=J;this.FSj=L}execute(H){var C=Object(f.a)(7,H.Fe);H.activityState[m.a.lsa]=!0;var G=M.m3h(H);if(M.xDj(H,G))return M.QFi(H),G=50,0<H.errors.length&&(G=15),e.ULS.sendTraceTag(537153891,0,G,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${h.a.sc(H.errors)}`),H.activityState[m.a.lsa]=!1,this.jh(w.a.idle),
3;switch(G){case 1:case 3:this.bii(H,G);break;case 2:this.aii(H);break;case 0:H.activityState[m.a.KZa]=null}e.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${G}. activityName:${this.activityName}. NextActivityName:${this.n0}. TimeFromLastStatefulResponse:${C.ea.u1}.`);var J=z.a.xg(H.activityState,I.a.Agb);e.ULS.shipAssertTag(40502925,0,!J||J&&(1===G||3===G),`triggerSilentReloadAfterTokenRefresh: ${J}, silentReloadType: ${G}`);C=C.gl.reloadCount;return 0!==G&&
0<C?(J=r.a.KLa(C,200),e.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${G}] retryNum [${C}] delayInMs [${J}] activityName [${this.activityName}]`),v.a.instance.create(()=>{M.XM(H)},J,B.a.yvj),1):3}bii(H,C){e.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const G=Object(f.a)(7,H.Fe);H.activityState[m.a.nob]=!0;G.Qhc||y.PageLoadTrackingInfo.instance.wj("ReopenOnLoad");!M.isEditMode(H)&&h.a.Npb(H.errors)&&
(e.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),H.activityState[m.a.X_b]=G.ea.sessionId,H.activityState[m.a.c0b]=!0);H.Czd();3===C?(G.ea.If()||G.ea.nLi(),G.DI(!0,!0),this.jh(this.FSj),H.activityState[m.a.Ape]=G.workbookContext.CalcMode):(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===C&&G.DI(!0,!0),H.activityState[m.a.WWc]=!1,this.jh(this.bBc))}aii(H){e.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");H.activityState[m.a.KZa]=null;H.Czd();this.jh(this.xJj);H=Object(f.a)(7,H.Fe);H.Qhc||(y.PageLoadTrackingInfo.instance.wj("RefreshOnLoad"),H.YKb())}static XM(H){H.XM()}static m3h(H){const C=Object(f.a)(7,H.Fe),G=C.ea,J=M.isEditMode(H);var L=h.a.fh(H.errors,J?M.izd:M.jzd);const P=h.a.fh(H.errors,J?M.lvf:M.mvf),aa=C.JN,U=C.gl.reloadCount,K=C.ya.MaxConsecutiveSilentReloadAllowed,Y=C.gl.dcf(),na=h.a.sc(H.errors),W=h.a.sc(H.dAa),
X=0<h.a.kN(Ca=>!Ca.triggerSilentReopenOnly,H.errors).length;let Aa=L;const Q=z.a.xg(H.activityState,I.a.Agb);Q&&(Aa=!0);const fa={name:"SessionReloadSilentActivity.GetSilentReloadType"};fa.editMode=J;fa.isSilentReopenError=L;fa.isSilentRefreshError=P;fa.reloadSequenceCount=C.gl.zRa;fa.reloadCount=U;fa.maxReloads=K;fa.stopSilentReloads=Y;fa.errorNames=na;fa.processedErrorNames=W;fa.isClientDirty=aa;fa.errorsForSilentReopenOnly=X;fa.triggerSilentReloadAfterTokenRefresh=Q;fa.IsReopenDisabled=C.TNa;L=
x.a.fc(fa);e.ULS.sendTraceTag(21837004,0,50,L);if(!Y){if(Aa&&(J?M.oDj(H):M.qDj(H)))return D.a.r8f(H,C)?3:C.TNa?2:1;if(P&&(J||!G.ycb))return 2}return 0}static xDj(H,C){for(const G of H.errors)if(-1337545025===G.MessageId||-238814601===G.MessageId)return!1;return h.a.kN(G=>!G.triggerSilentReopenOnly,H.errors).length?3!==C:!1}static QFi(H){const C=h.a.kN(G=>!G.triggerSilentReopenOnly,H.errors);for(const G of C)H.Hca(G)}static isEditMode(H){const C=Object(f.a)(7,H.Fe);return C.ea.Zb?C.Qt&&!!(C.qd&64):
z.a.xg(H.activityState,m.a.$r)}static qDj(H){const C=Object(f.a)(7,H.Fe),G=h.a.x4(H.errors,M.jzd);if(u.b(G,J=>J.ForceVersionUpgrade))return!1;H=h.a.Npb(H.errors);return!C.ea.ycb||H?!0:!1}static oDj(H){H=h.a.x4(H.errors,M.izd);return!u.b(H,C=>C.ForceVersionUpgrade)}}M.jzd=null;M.izd=null;M.mvf=null;M.lvf=null;Object(t.a)(M,"SessionReloadSilentActivity",d.a,[]);class T extends b.a{constructor(H,C){super();this.activityName=H;this.cK=C;this.Fb()}create(){this.ob(new M(this.activityName,this.cK,w.a.rz,
w.a.gj,w.a.nQb))}static la(H){H.da.Ga(143,new T(w.a.boa,w.a.K2b));H.da.Ga(144,new T(w.a.Iyc,w.a.qQa));H.da.Ga(145,new T(w.a.Jyc,w.a.cGd));H.da.Ga(154,new T(w.a.heb,w.a.rP))}}Object(t.a)(T,"SessionReloadSilentActivityFactory",b.a,[]);a.d(E,"a",function(){return S});const S=()=>{c.a.Fa(H=>{n.la(H);T.la(H)})}},1227:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(15),f=a(83),d=a(243),h=a(321),m=a(29),l=a(13),w=a(383),n=a(88);class x extends w.a{constructor(A,y){super(A,y);this.qqa=0;this.Rr()}get pc(){return"SharedWorkbookDialog"}get fub(){return this.qqa}bP(A,
y){this.qqa=A;super.bP(A,y)}Rr(){super.Rr();this.Tb=9;const A=this.RXh();this.qc(1,l.a.instance.ga(1659));this.qc(2,l.a.instance.ga(991));this.$l(l.a.instance.ga(702),n.a.xf(A),this.icon,this.Z7)}RXh(){return String.format(l.a.instance.ga(703))}}Object(t.a)(x,"LegacySharedWorkbookDialog",w.a,[]);var r=a(6),u=a(36);class v extends d.a{constructor(A,y,D){super(A,y);this.executionContext=null;this.Xyi=I=>{const M=this.ft.hd,T=Object(f.a)(7,M.Fe);let S;S=I.fub;this.unsubscribe(H=>{I.remove_disposing(H)});
for(let H=0,C=M.errors.length;H<C;H++)-573864504===M.errors[H].MessageId&&M.Hca(M.errors[H]);switch(S){case 1:T.ea.VDc=!0;e.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.jh(T.isEditMode?r.a.nQb:this.Bkh);this.Kp();break;case 2:this.jh(r.a.openInExcelClient);this.Kp();break;case 0:M.activityState[u.a.$r]=!1,this.jh(this.kK),this.Kp()}};this.Bkh=y;this.kK=D}initialize(A){super.initialize(A)}execute(A){this.executionContext=
A;this.I6c();return 1}fJ(A){super.fJ(A)}I6c(){const A=Object(f.a)(7,this.executionContext.Fe),y=m.a.D0a([-573864504]);y[0].HelpDescription=l.a.instance.ga(705);y[0].HelpTopicId=h.a.Yyi;const D=new x(A,y[0]);this.subscribe(this.executionContext,this.Xyi,I=>{D.add_disposing(I)})}}Object(t.a)(v,"LegacySharedWorkbookActivity",d.a,[]);class B extends b.a{constructor(A,y,D,I){super();this.activityName=A;this.cK=y;this.kK=D;this.$=I;this.Fb()}create(){this.ob(new v(this.activityName,this.cK,this.kK))}static la(A){A.da.Ga(460,
new B(r.a.KDb,r.a.wgb,A.FCb?r.a.Yj:r.a.csb,A))}}Object(t.a)(B,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(E,"a",function(){return z});const z=()=>{c.a.Fa(B.la)}},1250:function(t,E,a){var c=a(9);t=a(0);var b=a(222);class e{constructor(){}dispose(){}}Object(t.a)(e,"GridInstantaneousAction",null,[607]);var f=a(698);class d extends b.a{constructor(m){super();this.$=m;this.Fb()}create(){this.ob(Object(f.a)(this.$.da,528,()=>new e))}static la(m){m.da.Ga(529,new d(m))}}Object(t.a)(d,"GridInstantaneousActionFactory",
b.a,[]);a.d(E,"a",function(){return h});const h=()=>{c.a.Fa(m=>{d.la(m)})}},1251:function(t,E,a){t=a(0);var c=a(1290),b=a(1291),e=a(4);class f{constructor(){this.M9d=this.$a=null}get name(){return"Common.App.DirectPrint"}Oh(m){this.$a=m;m.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").wc().Ac(()=>new c.a(e.AFrameworkApplication.ta.IX));m.register(263,"Common.App.DirectPrint.IDirectPrintManager").wc().Ac(()=>b.a.create(this.$a))}init(){this.M9d=this.$a.resolve("Common.App.DirectPrint.IDirectPrintManager");
this.M9d.start()}dispose(){}}Object(t.a)(f,"PackageManager",null,[4,5]);var d=a(249);a.d(E,"a",function(){return h});const h=()=>{Type.registerNamespace("Common.App.DirectPrint");d.a.instance.vi(new f)}},1264:function(t,E,a){t=a(0);var c=a(15),b=a(4),e=a(89),f=a(129),d=a(261),h=a(27),m=a(38),l=a(78),w;(function(K){K[K.unableToRefreshLock=0]="unableToRefreshLock";K[K.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";K[K.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";K[K.workbookTooLarge=
3]="workbookTooLarge";K[K.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";K[K.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";K[K.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";K[K.unsupportedFeatures=7]="unsupportedFeatures";K[K.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";K[K.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";K[K.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";
K[K.lastGenericStatusError=11]="lastGenericStatusError";K[K.scratchPadWarning=12]="scratchPadWarning";K[K.authenticationLost=13]="authenticationLost";K[K.odfCompatibilityIssues=14]="odfCompatibilityIssues";K[K.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";K[K.workbookIsIrmProtected=16]="workbookIsIrmProtected";K[K.biFeatureNotAvailable=17]="biFeatureNotAvailable";K[K.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";K[K.unsupportedInteractiveReportEditing=
19]="unsupportedInteractiveReportEditing";K[K.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";K[K.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";K[K.editAttemptInReadOnly=22]="editAttemptInReadOnly";K[K.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";K[K.unsupportedBrowser=24]="unsupportedBrowser";K[K.readOnlyPermissions=25]="readOnlyPermissions";K[K.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";K[K.policyWarningMessage=
27]="policyWarningMessage";K[K.workingOnIt=28]="workingOnIt";K[K.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";K[K.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";K[K.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";K[K.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";K[K.legacyConnectionsBB=33]="legacyConnectionsBB";K[K.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";K[K.groupedSlicersBB=
35]="groupedSlicersBB";K[K.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";K[K.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";K[K.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";K[K.wacGdprNotice=39]="wacGdprNotice";K[K.automaticSensitivityLabel=40]="automaticSensitivityLabel";K[K.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";K[K.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";K[K.localStorageDisabled=43]="localStorageDisabled";
K[K.autoRefreshDisabled=44]="autoRefreshDisabled";K[K.corruptedFileRepaired=45]="corruptedFileRepaired";K[K.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";K[K.minorVersionLimitReached=47]="minorVersionLimitReached";K[K.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";K[K.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";K[K.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";K[K.sensitivityApplicationLabelDisabledError=
51]="sensitivityApplicationLabelDisabledError";K[K.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";K[K.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";K[K.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";K[K.promptEnableExternalLinks=55]="promptEnableExternalLinks";K[K.networkDown=56]="networkDown";K[K.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";K[K.refreshLinkedEntityErrorBar=
58]="refreshLinkedEntityErrorBar";K[K.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";K[K.canvasHealth=60]="canvasHealth";K[K.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";K[K.optimizeWorkbook=62]="optimizeWorkbook";K[K.novModePostDepreciation=63]="novModePostDepreciation";K[K.officeScriptsRunning=64]="officeScriptsRunning";K[K.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";K[K.readOnlyPivotTable=
66]="readOnlyPivotTable";K[K.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";K[K.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";K[K.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";K[K.count=70]="count"})(w||(w={}));Object(t.b)("EwaBusinessBarEntryType",w);var n=a(5),x=a(1059);class r extends Sys.EventArgs{constructor(K,Y,na=null){super();this.H0a=K;this.U9c=Y;this.data=na}}Object(t.a)(r,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,
[]);var u=a(1061),v=a(1060),B=a(1063);a(1062);var z=a(1057),A=a(477),y=a(48),D=a(37),I=a(646),M=a(29),T=a(1),S=a(22),H=a(21),C=a(57),G=a(70),J=a(838),L=a(33),P=a(41);a.d(E,"a",function(){return U});const aa=[55,39,5,30,16,14,7,41,4];class U extends l.a{constructor(K,Y){super();this.Qa=new m.a;this.gQ=null;this.UKc=[];this.vpc=()=>{this.$.pa.lNa?this.removeEntry(13):this.mh(13,null)};this.hh=(na,W)=>{for(let X=0,Aa=U.Rec().length;X<Aa;X++)na=U.Rec()[X],this.removeEntry(na);W.context&&0<W.context.communicationErrorRetryCount&&
(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.Glj()};this.zm=(na,W)=>{var X;na=this.FGh(W.errors);let Aa=[];for(let fa=0,Ca=na.length;fa<Ca;++fa){const ia=na[fa];if(1===ia.Type&&ia.Appearance&32)Aa=this.w$h(ia,Aa);else if(W.ivj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var Q=(null===(X=W.context)||void 0===X?0:X.stopwatch)?W.context.stopwatch.Bc:-1;5E3>Q?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${Q}ms).`):b.AFrameworkApplication.Uti()||this.wLg(ia,W.context.methodName)}Q=[...U.Rec()];for(let Ra=0,Ya=Aa.length;Ra<Ya;++Ra){const Ga=Aa[Ra];this.mh(Ga,ia);Array.remove(Q,Ga)}for(let Ra=0,Ya=Q.length;Ra<Ya;++Ra)this.removeEntry(Q[Ra])}};this.Tc=
(na,W)=>{this.xc(na,W)};this.xc=()=>{const na=this.$.ea;na.Zb||na.If()||(this.rMd(),this.UKc.length=0)};this.$c=(na,W)=>{this.$.ea.If()&&!W.aW||this.pff(W.aW)};this.yHb=()=>{const na=this.$.userOperationManager.Dec();na&&na.operation.flags&1&&this.l$f()};this.MEf=()=>{this.l$f()};this.Bf=()=>{this.cDe();this.u$f()};this.lO=()=>{if(this.$.P5&&this.$.ea.If()&&this.$.ea.Zb)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),
this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const na=this.$.da.Aa(331);na&&na.tKa||this.removeEntry(55);this.removeEntry(5)}};this.$=K;this.x_a=Y;this.OTg();b.AFrameworkApplication.zd&&b.AFrameworkApplication.zd.BXc(this);this.vGa=Array(70);for(let na=0;70>na;na++)this.vGa[na]=null;this.Nh=I.EcmaDateClock.instance;this.Hpf=this.Nh.zb.getTime();Y&&(Y=K.pa,Y.mw(this.zm),Y.Mq(this.hh),Y.Nob(this.vpc),Y.VZa(this.vpc),K.ea.Xj(this.Tc),K.ea.pu(this.Bf),K.$k(this.$c),
K.xj(this.xc),K.ea.UY(this.lO),K.userOperationManager.tr(this.yHb),T.EwaSettings.oa(165)&&K.ea.Mg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.Waf(),this.pff(C.c(K)));K.da.Ga(5,this);L.a.Nkc()&&(this.$.EOb=this.eli())}Waf(){M.a.Nq(this.$.ea.cG)&&this.zm(this,new A.a(this.$.ea.cG,null,!1,-1,-1,-1,-1,"",-1,"",-1))}aMg(K){this.Qa.addHandler("bBarAttachedOrDetached",K)}get X$c(){return this.UKc}get domElement(){return this.gQ?this.gQ.domElement:null}dispose(){if(this.$){const K=this.$,
Y=K.pa;Y.kx(this.zm);Y.Lr(this.hh);Y.vvc(this.vpc);Y.uKb(this.vpc);K.ea.tk(this.Tc);K.ea.Rv(this.Bf);K.ul(this.$c);K.tl(this.xc);K.ea.J0(this.lO);K.userOperationManager.oo(this.yHb);H.h(K).Vb.Uk(this.MEf)}e.a.Ia(this.gQ);this.$=this.gQ=null;super.dispose()}eli(){for(let K=0;K<aa.length;K++)if(this.vGa[aa[K]])return!0;return!1}Gli(K){switch(K){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;case 59:return T.EwaSettings.oa(611);default:return!1}}mh(K,Y,na=null,W=null,X=null){if(!this.$.isMobileMode||
this.Gli(K))this.x_a&&!this.qH(K)&&(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,0,50,`Adding entry to BB: ${Enum.toString(w,K)}`),this.vGa[K]=this.Nh.lfa,this.gQ.KE(K,Y,W,X),L.a.Nkc()&&this.iYj(K),this.Qa.raiseEvent("bBarAttachedOrDetached",new r(K,!0,na))),Y&&32===Y.Appearance&&G.a(this.$).hd.Hca(Y)}CHj(K,Y,na,W){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");z.a.initialize(K,Y,na,W);this.mh(39,null)}CGj(K,
Y,na,W){x.a.initialize(K,Y,na,W);this.mh(40,null)}KIj(K,Y,na,W){v.a.initialize(K,Y,na,W);this.mh(41,null)}aIj(K,Y,na,W){u.a.initialize(K,Y,na,W);this.mh(42,null)}SIj(K,Y,na,W){B.a.initialize(K,Y,na,W);this.mh(54,null)}removeEntry(K){this.x_a&&(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(w,K)}`),this.vGa[K]=null,this.gQ.removeEntry(K)&&this.Qa.raiseEvent("bBarAttachedOrDetached",new r(K,!1)))}qla(K){return this.x_a?
this.gQ.qla(K):!1}qH(K){return this.x_a?this.gQ.qH(K):!1}vFb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}yoc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}OTg(){const {BusinessBarControl:K}=a(1151);if(this.x_a&&!this.gQ){H.h(this.$).Vb.Zk(this.MEf);var Y=document.getElementById(this.$.Eb+n.a.hAe);this.gQ=new K(this.$,Y)}}rMd(){this.x_a&&
this.gQ.rMd()}iYj(K){0<=aa.indexOf(K)&&!this.$.EOb&&(this.$.EOb=!0,this.$.yue&&this.q$i())}q$i(){try{const Y=f.a.get(n.a.KGd);if(S.a.sh(Y))c.ULS.sendTraceTag(509682970,0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Can't find skeleton cookie eventough alreadyDefinedSkeletonCookie = true. Set page load skeleton cookie."),this.$.oTd();else{var K=P.a(decodeURIComponent(Y));K.Options|=4096;try{const na=P.c(K);f.a.Uu(n.a.KGd,na,d.AFrame.z1);c.ULS.sendTraceTag(509686989,0,50,"BusinessBarManager.raiseBusinessBarFlagInCookie: Business bar flag in PageLoadSkeletonState cookie has been raised")}catch(na){c.ULS.sendTraceTag(509686988,
0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: Failed setting PageLoadSkeletonState cookie with error message: ${na.message}`)}}}catch(Y){c.ULS.sendTraceTag(509686987,0,50,`BusinessBarManager.raiseBusinessBarFlagInCookie: exception while parsing PageLoadSkeletonCookie. Message: ${Y.message}`)}}Glj(){if(T.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const Y=this.Nh.lfa;if(3E5<=Y-this.Hpf){this.Hpf=Y;for(let na=0;70>na;na++){var K=this.vGa[na];if(K&&(K=Y-K,3E5<=
K)){const W=Enum.toString(w,na);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${W}] was activated but not turned off for ${K} Millis`)}}}}}FGh(K){const Y=[];for(const na of K)switch(na.MessageId){case -113742550:const W=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||M.a.fh(K,W))&&Y.push(-113742550)}return M.a.QB(K,Y)}w$h(K,Y){switch(K.MessageId){case 2113407564:const na=M.a.D0a([1821390342,-943219229,-502303485,
1437034227]);for(let W=0;W<na.length;W++)na[W].HelpTopicId=K.HelpTopicId,na[W].HelpDescription=K.HelpDescription,this.UKc.push(na[W])}switch(K.MessageId){case -395951567:this.mh(6,K);break;case 1643490758:this.mh(4,K);break;case -907264831:this.mh(5,K);break;case 757111532:case 2113407564:this.mh(7,K);break;case 2010656511:this.mh(15,K);break;case 1321660996:this.$.C8c=!0;this.mh(8,K);break;case 526339737:this.$.C8c=!0;this.mh(9,K);break;case -407088521:this.mh(10,K);break;case 1756116017:this.mh(14,
K);break;case -1703455218:this.mh(17,K);break;case 1393475740:this.mh(25,K);break;case -949523941:this.mh(26,K);break;case 1779381952:this.mh(44,K);break;case 1421575100:this.mh(45,K);break;case 613676060:this.mh(46,K);break;case 1233668252:this.mh(61,K);break;case 1911608588:K=!!(this.$.qd&64);!this.$.ea.If()&&K&&Y.push(29);break;case 1544494907:break;case -655555355:Y.push(this.Iud()?1:0);break;case -1221382671:Y.push(2);break;case 1662282929:Y.push(3);break;case 104919273:this.$.ea.If()||Y.push(30);
break;case -689453604:K=!!(this.$.qd&64);this.$.ea.hcf=!0;!this.$.ea.If()&&K&&Y.push(31);break;case 157762400:this.$.ea.pjc=!0;!this.$.ea.If()&&this.$.qd&64&&!this.$.isEditMode&&Y.push(32);break;case -1125398042:T.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.If()&&this.$.qd&64&&!this.$.isEditMode&&Y.push(34);break;case -73730134:!this.$.ea.If()&&this.$.qd&64&&Y.push(33);break;case -293349236:Y.push(65);break;case 1580811823:Y.push(67);
break;case -37299333:break;case 136737622:Y.push(47);break;case -1780327030:this.mh(55,K);break;case -113742550:this.mh(57,K);break;case -260312420:this.$.ea.If()||Y.push(66);break;default:this.mh(11,K)}return Y}Kfi(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!J.a.Asd(J.a.mgd(1))&&(h.a.Dp||h.a.$g)){const K=y.GetServiceTaskFactory.create(this.$.da,155,this.$.ka,1);D.TaskExtensions.za(K,()=>{this.mh(20,null)},this.ka,3)}}cfi(K){K||3!==this.$.workbookContext.WorkbookNovType||this.mh(63,
null)}pff(K){(!K&&!this.$.printingEnabled||this.$.me.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.mh(16,null));this.Kfi();this.cDe();this.u$f();this.cfi(K)}cDe(){this.$.workbookContext.Options&32768&&this.rHj()}rHj(){this.vGa[37]||this.mh(37,null)}rJj(){this.vGa[38]||this.mh(38,null)}u$f(){T.EwaSettings.oa(611)&&this.$.workbookContext.Options&524288&&this.mh(59,
null)}Q$f(K,Y){this.mh(58,K,null,Y)}HXc(K,Y=null){this.gQ.qH(K)?this.gQ.VQb(K,Y):this.mh(K,null,null,null,Y)}l$f(){this.$.qd&8&&this.mh(12,null)}Iud(){const K=this.$.da.Aa(38);return K?K.tokenExpired:!1}wLg(K,Y){if(!this.qH(21)&&-1387426400!==K.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const na={};na.FailedMethod=Y;this.mh(21,K,na)}}static Rec(){return U.jue||(U.jue=[0,1,2,3])}qgd(K){return this.gQ.qgd(K)}}U.jue=null;Object(t.a)(U,
"BusinessBarManager",l.a,[616,3,81])},1277:function(t,E,a){t=a(0);var c=a(222),b=a(1264);class e extends c.a{constructor(h){super();this.$=h;this.Fb()}create(){this.ob(this.$.da.Aa(5)||new b.a(this.$,!this.$.Eba))}static la(h){h.da.Ga(4,new e(h))}}Object(t.a)(e,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(E,"a",function(){return d});const d=()=>{f.a.Fa(e.la)}},1289:function(t,E,a){t=a(0);var c=a(15),b=a(84),e=a(851),f=a(838),d=a(1208);class h{constructor(){this.VHc=new d.a;this.THc=new d.a;
this.SHc=new d.a;this.FXg(this.VHc);this.EXg(this.THc);this.DXg(this.SHc);this.ZMc=new d.a;this.YMc=new d.a;this.XMc=new d.a;this.b_g(this.ZMc);this.a_g(this.YMc);this.$Zg(this.XMc);this.lJc=new d.a;this.YXg(this.lJc);this.EGa(this.lJc);this.EGa(this.SHc);this.EGa(this.THc);this.EGa(this.VHc);this.EGa(this.YMc);this.EGa(this.ZMc);this.EGa(this.XMc)}Q3h(x,r){switch(x){case 1:return this.g7h(r);case 2:return this.GOh(r)}return f.a.AAc?this.lJc:null}FXg(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);
x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}EXg(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}DXg(x){x.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}b_g(x){x.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);x.add("OverlayBig","Get the Word app");x.add("OverlaySmall",
"Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover Word");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")}YXg(x){x.add("Headline","Get the Office Online extension for Chrome");x.add("UseAppButton","Get the extension");x.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}a_g(x){x.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);x.add("OverlayBig","Get the PowerPoint app");x.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");x.add("OverlaySmallSplit1","Discover PowerPoint");x.add("OverlaySmallSplit2","designed for the iPad.");x.add("SkipButton","Skip for now")}$Zg(x){x.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);x.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);x.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);x.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);x.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}EGa(x){x.add("Corporation","Microsoft Corporation")}g7h(x){switch(x){case 3:return this.ZMc;case 2:return this.YMc;case 1:return this.XMc}return null}GOh(x){switch(x){case 3:return this.VHc;
case 2:return this.THc;case 1:return this.SHc}return null}static get instance(){h.Ma||(h.Ma=new h);return h.Ma}}h.Ma=null;Object(t.a)(h,"WildFireStringFactory",null,[]);var m=a(4),l=a(39),w=a(27);a.d(E,"a",function(){return n});class n{constructor(x,r,u,v,B=null,z=null){this.oRc=null;this._id=x;this.YRc=r;this.zxg=B;this.Fkb=v;this.Rmb=z;this.Rpa=null;this.rZa=u;this.onb=h.instance.Q3h(r,x)}z6c(){this.Rpa=new e.a(this.title,this.message,null);this.Rpa.addButton(this.qAe,Object(b.a)(this,this.hBf,
"onButtonOneClick"),"");this.rZa&&this.Rpa.FKg(this.sAe,Object(b.a)(this,this.kBf,"onButtonTwoClick"));this.Rpa.U$=Object(b.a)(this,this.KNe,"dismissBar");this.Rpa.image=3;this.Rpa.id=16;this.Rpa.closeable=!0}get title(){return this.onb.ma("Headline")}get message(){return this.onb.ma("CallToAction")}get r1j(){return this.rZa}get qAe(){return this.rZa?this.onb.ma("InstallButton"):this.onb.ma("UseAppButton")}get sAe(){return this.rZa?this.onb.ma("OpenAppButton"):""}hBf(){this.rZa?this.Iii():this.h1j()}kBf(){this.rZa&&
this.I0i()}get e_g(){return this.Rpa}get openUrl(){this.oRc||(this.oRc=this.zxg());return this.oRc}Iii(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Fkb&&this.Rmb&&this.Rmb();f.a.RTf(this._id,this.YRc)}I0i(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Fkb&&this.Rmb&&this.Rmb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.pve(this._id),this.openUrl,0,!1))}h1j(){f.a.AAc?this.h_g():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),f.a.MTd("BizBarClicked"),1!==this.YRc&&2!==this.YRc||f.a.F5g(this.openUrl,this.Fkb,this._id,this.Rmb))}h_g(){this.Fkb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");l.a.oV(m.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Knh(){this.Fkb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.MTd(f.a.ADe)}KNe(){f.a.AAc?
this.Knh():(f.a.MTd(f.a.mgd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static g7b(){const x=m.AFrameworkApplication.ta.Pa,r=new n(x.Ij,f.a.Pec(),8<w.a.N6a,1===x.E6,()=>x.Ux,x.$0f());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return r}}Object(t.a)(n,"WildFireBusinessBar",null,[])},1290:function(t,E,a){t=a(0);var c=a(15),b=a(84),e=a(133),f=a(4),d=a(14),h=a(96),m=a(45),l=a(181),w=a(1077),n=a(87),x=a(56),r=a(80),u=a(941);class v extends e.StandardDialog{constructor(z,
A,y,D=null){super();this.QP=this.om=this.Dqa=null;this.qn=[];this.rXb=A;this.MP=z;this.Uxg=y;this.FYb=D;this.nnb=new u.a("LoadResource","LoadPrintablePdf")}BQ(){this.Tb=5;this.width=40;const z=document.createElement("span");z.id=this.mi("DirectPrintHeaderContent");const A=document.createElement("span");A.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(A,"DirectPrintHeader");this.QP=document.createElement("iframe");this.QP.name="pdfObjectFrame";this.QP.title=CommonUIStrings.l_DirectPrintDialogIFrame;
this.QP.onload=Object(b.a)(this,this.M7i,"printablePdfLoaded");if(this.FYb&&0<this.FYb.count){var y=r.a.kjd(this.rXb,this.FYb);const D=r.a.OMd(this.rXb,this.FYb);this.om=document.createElement("form");this.om.id="printPreviewPostForm";this.om.method="POST";this.om.target=this.QP.name;this.om.action=D;for(let I of y)y=document.createElement("input"),y.type="hidden",y.name=I.key,y.value=I.value,this.om.appendChild(y)}else this.QP.setAttribute("src",this.rXb);Sys.UI.DomElement.addCssClass(this.QP,l.a.ahe);
this.Uxg?(Sys.UI.DomElement.addCssClass(this.QP,"DirectPrintPdfObjectHidden"),A.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,n.a.yh(this.QP,n.a.HC,n.a.Ak)):(Sys.UI.DomElement.addCssClass(this.QP,"DirectPrintPdfObject"),this.qn.push(this.QP));z.appendChild(A);z.appendChild(document.createElement("br"));z.appendChild(this.QP);this.om&&z.appendChild(this.om);z.appendChild(document.createElement("br"));z.appendChild(this.r9g(this.om?"#":this.rXb));this.nnb.start();this.TEb(CommonUIStrings.l_AppTitle,
null,null,null,null,z);this.wX(this.mi("DirectPrintHeaderContent"));this.om&&this.om.submit();this.vdh();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}r9g(z){const A=document.createElement("span");var y=document.createElement("span");y.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;A.appendChild(y);f.AFrameworkApplication.fa&&(2===f.AFrameworkApplication.ta.Pa.Ij&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.ta.Pa.Ij&&
f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(z=document.createElement("span"),2===f.AFrameworkApplication.ta.Pa.Ij?z.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.ta.Pa.Ij&&(z.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Dqa=z,A.appendChild(document.createElement("br")),A.appendChild(z)):(y=document.createElement("a"),y.innerText=
CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,y.href=z,y.target="_blank",y.id="PrintPDFLink",y.className="AllowBrowserClick",this.Dqa=y,A.appendChild(document.createElement("br")),A.appendChild(y),this.om&&m.a.addHandler(y,"click",Object(b.a)(this,this.xrc,"onSubmit")),this.MP.sa(d.a.click,this.Dqa,Object(b.a)(this,this.TOe,"downloadPDFLinkClicked"),null));this.qn.push(this.Dqa);return A}xrc(z){this.om&&(this.om.target="_blank",this.om.submit());z.preventDefault()}vdh(){if(0<this.qn.length){const z=
new w.a(this.qn),A=h.FocusManager.instance().TQ();A&&(this.Dqa.focus(),A.hf=z,A.c0=!0)}}TOe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}Dxd(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}M7i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.nnb&&this.nnb.stop()}dispose(){this.Dqa&&(this.MP.Ba(d.a.click,this.Dqa,Object(b.a)(this,this.TOe,"downloadPDFLinkClicked")),this.Dqa=null);
x.a.I0(this.QP);this.QP=null;super.dispose()}}Object(t.a)(v,"DirectPrintDialog",e.StandardDialog,[322]);a.d(E,"a",function(){return B});class B{constructor(z){this.MP=z}sTh(z,A){return new v(this.MP,z,A,null)}}Object(t.a)(B,"DirectPrintDialogFactory",null,[309])},1291:function(t,E,a){t=a(0);var c=a(15),b=a(553),e=a(84),f=a(1343),d=a(1078);class h{constructor(r,u){this.tdg=r;this.zUa=u}}Object(t.a)(h,"DirectPrintProbeResults",null,[]);var m=a(4),l=a(264),w=a(27),n=a(111);a.d(E,"a",function(){return x});
class x{constructor(r,u,v,B,z,A,y,D,I,M){this.$Zb=null;this.Qvg=r;this.Klb=u;this.QQc=v;this.Xyg=B;this.Czg=z;this.hSc=new b.a(Object(e.a)(this,this.t0h,"getProbeResults"));this.OWa=A;this.Tee=I;this.EEg=y;this.Dzg=D;this.Kzg=M}get jD(){return this.Qvg}start(){}W9i(){const r=Array(this.jD.yUa.length);if(void 0!==this.Klb&&null!==this.Klb)for(let u=0;u<this.jD.yUa.length;u++)r[u]=this.jD.yUa[u]in this.Klb&&this.Xyg(this.Klb[this.jD.yUa[u]]);return r}X9i(){const r=Array(this.jD.zUa.length),u=!(void 0===
this.QQc||null===this.QQc);for(let v=0;v<this.jD.zUa.length;v++){const B=this.jD.zUa[v];r[v]=u&&B in this.QQc?!0:this.Czg(B)}return r}e4h(){const r=this.W9i(),u=Array(r.length);for(let v=0;v<r.length;v++)u[v]=r[v]?this.ZEh(this.Klb[this.jD.yUa[v]]):null;return u}ZEh(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name}t0h(){var r=this.e4h();const u=this.X9i(),v={},B={};for(let z=0;z<this.jD.yUa.length;z++)v[this.jD.yUa[z]]=r[z];for(r=0;r<this.jD.zUa.length;r++)B[this.jD.zUa[r]]=
u[r];return new h(v,B)}iGj(){return this.Kzg||!this.jD.isEnabled||m.AFrameworkApplication.isUnifiedHostMode?!1:this.mOj()}C9f(){if(null!=this.$Zb)return this.$Zb;const r=x.gjf(this.jD);return this.$Zb=this.jD.hjf&&r||this.emi()}emi(){return w.a.Ep&&this.jD.gmi&&w.a.CDe>=this.jD.p4g?!0:!1}mOj(){if(!this.Dzg(this.jD))return!1;var r=n.a.Wkd(this.hSc.value.tdg);for(const u of r)if(void 0!==u&&null!==u)return!0;r=n.a.Wkd(this.hSc.value.zUa);for(const u of r)if(u)return!0;return!1}Bai(){const r=n.a.Wkd(this.hSc.value.tdg);
for(const u of r)if(l.a.contains(this.jD.Qdi,u))return!0;return!1}yIj(r){m.AFrameworkApplication.ta&&m.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.Tee(r,null):this.iGj()?this.boh(r,this.Bai()&&!0):this.Tee(r,null)}boh(r,u){const v=this.EEg.Cc("UserAction","OpenDirectPrintDialog");this.OWa.sTh(r,u).BQ();v.stop()}static Dnf(r){try{return new ActiveXObject(r),!0}catch(u){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1}static jjf(r){return void 0===
r||null===r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)}static create(r){const u=new d.a(m.AFrameworkApplication.fa.appSettings);let v=null;try{v=window.navigator.mimeTypes}catch(M){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(M){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const z=x.jjf,A=x.Dnf;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const y=m.AFrameworkApplication.ta.kE,
D=x.Enf,I=!!m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Pa.Lv&&!m.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new x(u,v,B,z,A,r,y,D,(M,T)=>new f.a(M,!1,T,!0,I),m.AFrameworkApplication.Sba)}static Enf(r){return w.a.Ep||w.a.Jv&&r.Hpi||r.hjf&&x.gjf(r)?!0:!1}static gjf(r){var u=w.a.Lub;if(u){var v=u.split(".");if(2===v.length)return u=parseInt(v[0]),v=parseInt(v[1]),u>r.vAd||u===r.vAd&&v>=r.Wwf}return!1}}Object(t.a)(x,"DirectPrintManager",null,[263])},1338:function(t,
E,a){a.d(E,"a",function(){return l});t=a(0);var c=a(84);E=a(133);var b=a(1066),e=a(261),f=a(4),d=a(14),h=a(80),m=a(27);class l extends E.StandardDialog{constructor(w,n=!0,x=!1,r=null,u=null,v=!1){super();this.jXa=this.iXa=this.om=this.wY=null;var B=this.q_d?this.q_d:CommonUIStrings.l_DefaultDialogTitle;l.C6a=v;this.pUb=r||new b.a(w,!0);this.pUb.Bxe(this);const z=[],A=[];l.$u&&(this.VYc&&this.VYc.forEach(I=>{Array.add(z,I)}),this.Ete&&this.Ete.forEach(I=>{Array.add(A,I)}));n?x?(this.Tb=4,this.qc(1,
this.buttonText),this.qc(2,CommonUIStrings.l_DialogClose)):(this.Tb=6,this.qc(0,CommonUIStrings.l_DialogClose)):this.Tb=5;v=document.createElement("span");this.T7c&&(v.className=this.T7c);r=document.createElement("a");r.innerText=this.tmc;r.href=w;r.target="_blank";r.id=this.smc;r.className=e.AFrame.mue;var y=!m.a.Hz&&!!u&&0<u.count;if(y){const I=h.a.kjd(w,u);u=h.a.OMd(w,u);r.href="#";r.target="_self";this.om=document.createElement("form");this.om.id="printPreviewPostForm1";this.om.method="post";
this.om.target="_blank";this.om.action=u;for(var D of I)u=document.createElement("input"),u.type="hidden",u.name=D.key,u.value=D.value,this.om.appendChild(u)}else this.om=null;this.om||l.C6a?l.C6a||Array.add(A,{["type"]:"AppLinkProps",["id"]:this.smc,["text"]:this.tmc,["onExecute"]:()=>{this.nSf()}}):Array.add(A,{["type"]:"AppLinkProps",["id"]:this.smc,["text"]:this.tmc,["handler"]:{["href"]:y?"#":w,["target"]:y?"_self":"_blank"}});this.pPa&&Array.add(z,this.pPa);x?(w=document.createElement("span"),
w.innerText=this.pPa.replace("{0}",""),v.appendChild(w)):this.Mwf?(w=document.createElement("span"),w.id=this.mi("message"),D=document.createElement("span"),u=document.createElement("span"),y=this.pPa.split("{0}"),D.innerText=y[0],u.innerText=y[1],w.appendChild(D),w.appendChild(r),w.appendChild(u),v.appendChild(w)):(w=document.createElement("span"),w.innerText=this.pPa,v.appendChild(w),v.appendChild(document.createElement("br")),v.appendChild(document.createElement("br")),v.appendChild(r),l.C6a||
Array.add(z,"{0}"));this.om&&v.appendChild(this.om);l.$u&&(this.J9a&&(this.GDb?this.nqe(this.J9a,this.GDb):(Array.add(z,"{0}"),Array.add(A,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.J9a,["onExecute"]:()=>{this.mmc()}}))),this.nsa(z,A));this.TEb(B,null,this.vef,null,Object(c.a)(this,this.zw,"dialogHandler"),l.$u?null:v);this.wX(this.mi("message"));!l.$u&&this.GDb&&this.J9a&&(B=document.createElement("div"),B.className="WACDialogLearnMoreLinkContainer",this.wY=document.createElement("a"),
this.wY.innerText=this.J9a,this.wY.href=this.GDb,this.wY.target="_blank",this.wY.id=this.mi("LearnMoreLinkId"),this.wY.className=e.AFrame.mue,B.appendChild(this.wY),n?this.wb.insertBefore(B,this.wb.lastChild):this.wb.appendChild(B),this.wX(String.format("{0} {1}",this.mi("message"),this.mi("LearnMoreLinkId"))));this.tjb=r;x?this.RI(this.jC):this.RI(this.tjb);this.wsf();f.AFrameworkApplication.ta.IX.sa(d.a.click,this.tjb,Object(c.a)(this,this.ROe,"downloadLinkClicked"),null);this.wY&&f.AFrameworkApplication.ta.IX.sa(d.a.click,
this.wY,Object(c.a)(this,this.mmc,"learnMoreLinkClicked"),null);this.oUb=!1}get vef(){return null}get q_d(){return null}get pPa(){return null}get GDb(){return null}get J9a(){return null}get Mwf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get T7c(){return null}get VYc(){return null}get Ete(){return null}x_c(){this.om&&(this.iXa||(this.iXa=Object(c.a)(this,this.zMi,"onActionButtonClicked"),this.cz.sa(d.a.click,this.jC,this.iXa)),this.jXa||(this.jXa=Object(c.a)(this,this.AMi,"onActionButtonKeyUp"),
this.Yd.sa(d.a.Gd,this.jC,this.jXa)));super.x_c()}zMi(w){this.iXe(w);return!0}AMi(w){return this.zpf(w,Object(c.a)(this,this.iXe,"executeDismissActionButtonFromArgs"))}iXe(w){this.om&&this.om.submit();this.fva(w.Gb)}Dxd(){}ROe(){this.ysf();this.om?this.om.submit():this.pUb.Z9c();return!0}mmc(){return!1}dispose(){this.pUb.dispose();this.tjb&&(f.AFrameworkApplication.ta.IX.Ba(d.a.click,this.tjb,Object(c.a)(this,this.ROe,"downloadLinkClicked")),this.tjb=null);this.wY&&(f.AFrameworkApplication.ta.IX.Ba(d.a.click,
this.wY,Object(c.a)(this,this.mmc,"learnMoreLinkClicked")),this.wY=null);this.cz&&this.iXa&&(this.cz.Ba(d.a.click,this.jC,this.iXa),this.iXa=null);this.Yd&&this.jXa&&(this.Yd.Ba(d.a.Gd,this.jC,this.jXa),this.jXa=null);super.dispose()}nSf(){this.om&&(document.body.appendChild(this.om),this.om.submit(),document.body.removeChild(this.om))}zw(w){1===w&&(this.Dxd(),this.om?l.$u&&this.nSf():this.pUb.Z9c());this.dispose()}static get $u(){return f.AFrameworkApplication.ta.Pa.Lv&&f.AFrameworkApplication.ta.Pa.nmf}static get C6a(){return l.obe}static set C6a(w){l.obe=
w}}l.obe=!1;Object(t.a)(l,"ADialogWithLinkToResource",E.StandardDialog,[])},1339:function(t,E,a){a.r(E);a.d(E,"ReactOICErrorDialogWithTrial",function(){return f});t=a(0);var c=a(84);E=a(1068);var b=a(421),e=a(146);class f extends E.a{constructor(d,h,m,l,w,n){super(d,h,m,l,w,n);h={["errorMessage"]:this.GRe,["offerString"]:this.Czf};d=new e.a(!1,!1,!0);this.m$f?(d.Tb=1,h.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Nwa,["onExecute"]:()=>{b.Redirect.showHelp(this.Pcf)}}):(d.Tb=4,
d.qc(2,this.oef));d.qc(1,this.t_b);d.Ee=this.id;h={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:h};d.initializeAndShow(this.Ql,Object(c.a)(this,this.xbj,"reactOICErrorDialogWithTrialHandler"),h)}}Object(t.a)(f,"ReactOICErrorDialogWithTrial",E.a,[])},1340:function(t,E,a){a.r(E);a.d(E,"OICErrorDialogWithTrial",function(){return e});t=a(0);var c=a(84);E=a(1068);var b=a(133);class e extends E.a{constructor(f,d,h,m,l,w){super(f,d,h,m,l,w);f=document.createElement("span");f.innerText=this.GRe;
f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.Czf;f.appendChild(d);d=new b.StandardDialog;this.m$f?(d.Tb=1,d.wqe(this.Nwa,this.Pcf)):(d.Tb=4,d.qc(2,this.oef));d.qc(1,this.t_b);d.Ee=this.id;d.$l(this.Ql,null,this.icon,Object(c.a)(this,this.Tyi,"legacyOICErrorDialogWithTrialHandler"),f)}}Object(t.a)(e,"OICErrorDialogWithTrial",E.a,[])},1341:function(t,E,a){a.r(E);a.d(E,"CheckRoamingRightsRequest",function(){return c});
t=a(0);a=a(1069);class c extends a.a{constructor(){super()}Yxb(){return 2}dba(){return 1}}Object(t.a)(c,"CheckRoamingRightsRequest",a.a,[])},1342:function(t,E,a){a.r(E);a.d(E,"GetRoamingLauncherRequest",function(){return c});t=a(0);a=a(1069);class c extends a.a{constructor(){super()}Yxb(){return 0}dba(){return 2}}Object(t.a)(c,"GetRoamingLauncherRequest",a.a,[])},1343:function(t,E,a){a.d(E,"a",function(){return l});t=a(0);var c=a(15),b=a(1338),e=a(1066),f=a(4),d=a(87),h=a(80),m=a(27);class l extends b.a{constructor(w,
n,x=null,r=!0,u=!1){super(w,!0,!(l.ICa&&r),new e.a(w,n),x,u);l.ICa=l.ICa&&r;if(l.ICa){n=document.createElement("iframe");r=null;u=this.Ymh;n.name="pdfObjectFrame";n.id="pdfObjectIFrame";if(x&&0<x.count){const v=h.a.kjd(w,x);w=h.a.OMd(w,x);r=document.createElement("form");r.id="printPreviewPostForm";r.method="POST";r.target=n.name;r.action=w;for(let B of v)w=document.createElement("input"),w.type="hidden",w.name=B.key,w.value=B.value,r.appendChild(w)}else n.src=w;u.appendChild(n);r&&(u.appendChild(r),
r.submit());Sys.UI.DomElement.addCssClass(n,"DirectPrintPdfObjectHidden");d.a.yh(n,d.a.HC,d.a.Ak)}}get vef(){return"Print_32x32x32"}get q_d(){return l.ICa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get pPa(){return l.ICa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get VYc(){const w=[];Array.add(w,CommonUIStrings.l_PrintDialogCanCloseDocument);if(b.a.C6a){let n=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.ta.Pa.hLe&&(n=f.AFrameworkApplication.ta.Pa.hLe);
Array.add(w,n)}return l.ICa?w:null}get tmc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get smc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get T7c(){return f.AFrameworkApplication.$Me?"UIFontDialogTextLarge":null}wsf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}ysf(){f.AFrameworkApplication.Un.Uzb(9540);c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Dxd(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get ICa(){return!!f.AFrameworkApplication.ta&&
f.AFrameworkApplication.ta.Pa.Lv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(m.a.Hz||m.a.Jv||m.a.Jf||m.a.WNa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set ICa(w){}}Object(t.a)(l,"PrintDialogWithLinkToPdf",b.a,[])},1360:function(t,E,a){t=a(0);var c=a(84),b=a(41);class e{constructor(){this.classId=0}static tJa(l){try{return b.a(l)}catch(w){}return null}}Object(t.a)(e,"ARoamingAppsResponse",
null,[]);class f{constructor(){this.state=this.callback=null;this.Prd=!1}}Object(t.a)(f,"GetRoamingAppsLauncherContext",null,[]);var d=a(4),h=a(107);a.d(E,"a",function(){return m});class m{constructor(l){this.jJc=!1;this.GYa=m.dhc;this.aTc=this.bRc=0;this.platform=null;this.eDg=l;this.Pne=this.bTc=!1}get roamingAppsAreEnabled(){return this.eDg}get D1j(){return this.roamingAppsAreEnabled&&this.bTc?this.Pne:!1}c4g(){d.AFrameworkApplication.Ljc&&this.roamingAppsAreEnabled&&!this.bTc&&!this.jJc&&(this.aTc=
1,this.jJc=!0,this.Gnj(),this.fXe())}Gnj(){this.GYa=m.dhc;this.bRc=0}getRoamingAppsLauncher(l,w,n){this.D1j?(l=new f,l.callback=w,l.state=n,l.Prd=!0,this.lXe(l)):w(!1,"",n)}fXe(){const l=new (a(1341).CheckRoamingRightsRequest);l.RoamingApp=this.aTc;l.BaseDocQuerySignature=d.AFrameworkApplication.Hi;l.execute(Object(c.a)(this,this.e4g,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.d4g,"checkUserRoamingRightsFailed"),null)}e4g(l){d.AFrameworkApplication.Og||((l=e.tJa(l.data.fe))?this.OTd(l.HasRights):
this.OTd(!1))}d4g(){if(!d.AFrameworkApplication.Og)if(this.bRc>=m.xGi)this.OTd(!1);else{var l=new h.a(2,1,this.GYa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);d.AFrameworkApplication.Fi.Eg(l);this.bRc++;this.GYa*=m.bpj;this.GYa>m.hwf&&(this.GYa=m.hwf)}}OTd(l){this.Pne=l;this.bTc=!0;this.jJc=!1}retryCheckUserRoamingRights(){this.fXe()}lXe(l){const w=new (a(1342).GetRoamingLauncherRequest);w.RoamingApp=this.aTc;w.BaseDocQuerySignature=d.AFrameworkApplication.Hi;
w.execute(Object(c.a)(this,this.W1h,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.V1h,"getRoamingAppsLauncherFailed"),l)}W1h(l){if(!d.AFrameworkApplication.Og){var w=e.tJa(l.data.fe);l=l.data.state;w?(this.platform=w.Platform,l.callback(!0,w.Launcher,l.state)):l.callback(!1,"",l.state)}}V1h(l){if(!d.AFrameworkApplication.Og){var w=l.data.state;5===l.data.status&&w.Prd?(w.Prd=!1,this.lXe(w)):w.callback(!1,"",w.state)}}static get instance(){return m.vC||(m.vC=new m(d.AFrameworkApplication.kTg))}}
m.dhc=1E3;m.bpj=5;m.hwf=12E5;m.xGi=5;m.vC=null;Object(t.a)(m,"RoamingAppsManager",null,[])},1435:function(t,E,a){a.r(E);var c=a(1051),b=a(0),e=a(249);class f{get name(){return"Common.App.DialogWithLinkToResource"}Oh(){}init(){}dispose(){}static main(){e.a.instance.vi(new f)}}Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var d=a(553),h=a(15),m=a(84),l=a(815),w=a(30),n=a(130);class x{static qsh(nc){return x.bAe("New",nc)}static rsh(nc){return x.bAe("Open",nc)}static Mze(nc,Sc){return x.Tha("LoadingMenuSection",
x.nAi,nc,x.Vqb("lblLoading",Sc))}static Wqb(nc,Sc,zb=null,Wb=null){return x.Tha("MessageMenuSection",x.vxf,Sc,x.Vqb("lblMessage",nc,zb,Wb))}static RYg(nc){return x.Mze(nc,CommonUIStrings.l_VoicedLoadingText)}static SYg(nc,Sc){return x.Wqb(CommonUIStrings.l_NewCreationLocationMessage,nc.ti,Sc.XR,Sc.Joa)}static QYg(nc,Sc){return x.Wqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Sc.Joa,"\n\n"),nc.ti)}static Oze(nc){return x.Wqb(CommonUIStrings.l_NewGenericErrorMessage,nc.ti)}static OYg(nc,
Sc,zb){return x.Tha("menuNewBlank",x.kbi,zb?nc.ti:null,x.Qqb(nc.zcf,nc.Acf,nc.Bcf,null,nc.Pka,nc.Izb,Sc,"blank"))}static NZg(){return x.Vqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Zze(){return x.Vqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static OZg(nc,Sc){return x.Tha("menuNewTemplates",nc,null,Sc)}static MYg(nc,Sc){return x.Tha("menuNewMoreTemplates",x.w_e,null,x.Qqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,nc,Sc))}static QXg(nc,Sc,zb){let Wb="";zb&&Sc&&(Wb=x.Tha("BrowseMoreMenuSection",x.w_e,null,x.Qqb("btnBrowseMore",Sc,Sc,null,null,null,nc||"1959943459",zb)));return Wb}static Vqb(nc,Sc,zb=null,Wb=null){let yc=Wb;Sc&&0<Sc.length&&(yc=x.ryf.Lsc(Sc).trimEnd(),yc=0<=yc.indexOf("{0}")?String.format(yc,Wb):String.format("{0} {1}",yc,Wb));zb=zb&&Wb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',w.a.Xe(zb),w.a.Xe(Wb),w.a.Xe(yc)):
"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',w.a.Xe(nc||""),x.ryf.Lsc(w.a.Xe(Sc||"")),zb)}static Qqb(nc,Sc,zb,Wb,yc,Uc,fd,rb){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',w.a.Xe(nc||""),w.a.Xe(Sc||""),w.a.Xe(zb||""),Wb||"32by32",w.a.Xe(yc||
""),w.a.Xe(Uc||""),fd,w.a.Xe(rb||""))}static bAe(nc,Sc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',nc,Sc)}static Tha(nc,Sc,zb,Wb){zb=zb?String.format('Title="{0}"',w.a.Xe(zb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',w.a.Xe(nc||""),w.a.Xe(Sc||""),zb,Wb)}}x.vxf=
"MenuMru";x.nAi="MenuLoading";x.kbi="MenuHeader";x.w_e="MenuFooter";x.ryf=n.a.Yx("\n","&#10;");Object(b.a)(x,"NewAndOpenXmlUtilities",null,[]);var r=a(4),u=a(98),v=a(145),B=a(137);class z{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(z,"HostInformation",null,[]);var A=a(107),y=a(39),D=a(376),I=a(164),M=a(644),T=a(576),S=a(106),H=a(25);class C{constructor(nc,Sc,zb,Wb,yc,Uc){this.bVc=this.ap=this.hTb=null;this.cZb=this.nUc=!1;this.Rfe=0;this.bUc=this.uOc=
!1;this.y2=nc;this.Qjb=Sc;this.zEa=new d.a(()=>new l.a(zb.value,Object(m.a)(this,this.Ixb,"getMoreInfoEventReceived")));this.IAg=Wb;this.pra=yc;this.VDg=Uc;this.enb=this.yAc;2===this.eL.Oca&&(this.bUc=!0)}get YP(){switch(this.eL.Oca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Hg(){const nc=this.eL.J$a;nc.Nb(H.a.newDocument,S.a.frame,Object(m.a)(this,this.newDocument,"newDocument"));nc.Me(H.a.dtc,S.a.frame,Object(m.a)(this,this.dtc,
"populateNewMenu"),96)}newDocument(nc,Sc,zb,Wb,yc){if(1===zb)return 32;if(2===zb&&yc){if(r.AFrameworkApplication.fa.qa("BackstagePremiumTemplateExperienceEnabled")&&yc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),r.AFrameworkApplication.ub.processAction(H.a.B6i,2);if(yc.MenuItemId&&yc.SourceControlId)return"NewDocumentHome"===yc.SourceControlId&&v.a("NewDocumentFromHomeTab"),this.g2a(yc.MenuItemId,yc.SourceControlId)}return 8}g2a(nc,Sc){var zb=this.Boc.l7c;
if(null===zb)return 8;var Wb=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(r.AFrameworkApplication.jca&&Wb){h.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const yc={};yc[D.a.Ceg]=nc;yc[D.a.YP]=this.YP;yc[D.a.lcid]=r.AFrameworkApplication.lcid.toString();yc[D.a.reason]=M.a.createNew;r.AFrameworkApplication.AV().execute(Uc=>{Uc.Sj(I.a.g2a,yc)})}else Wb=(new Date).getTime(),Sc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
zb,w.a.lf(this.pma),w.a.lf(nc),w.a.lf(this.YP),w.a.lf(r.AFrameworkApplication.lcid.toString()),w.a.lf(Wb.toString()),w.a.lf(Sc),w.a.lf(r.AFrameworkApplication.canary),r.AFrameworkApplication.Hi),(zb=r.AFrameworkApplication.fa.Xa("ScenarioId"))&&""!==zb&&(Sc+="&wdscenarioid="+w.a.lf(zb)),Sc+="&"+r.AFrameworkApplication.sec(),r.AFrameworkApplication.Gxa&&(Sc+="&"+r.AFrameworkApplication.Jdc()),(zb=this.ap?this.ap.XR:null)&&(Sc+="&DestinationUrl="+w.a.lf(zb)),y.a.kf(Sc,"_blank",void 0,"CreateNewDocument");
2===this.eL.Oca&&h.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:T.a[this.eL.Oca],["Template"]:nc});return 32}DDi(nc){let Sc=Number.MAX_VALUE,zb=Number.MIN_VALUE;const Wb=window.performance;if(Wb&&"undefined"!==typeof Wb.getEntriesByName){for(let Uc=0;Uc<nc.length;Uc++){var yc=Wb.getEntriesByName(nc[Uc]);yc&&0<yc.length&&(yc=yc[0],Sc=Math.min(parseInt(String(yc.fetchStart)),Sc),zb=Math.max(parseInt(String(yc.responseEnd)),zb))}zb>Sc&&h.ULS.sendTraceTag(5849601,
202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:zb-Sc,["MinFetchStart"]:Sc,["MaxResponseEnd"]:zb})}}dtc(nc,Sc,zb,Wb,yc){if(1===zb)return this.bUc&&(r.AFrameworkApplication.ZN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.bUc=!1),32;2!==zb||this.uOc||(this.Rfe=(new Date).getTime(),h.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.yAc,["CachedNewMenuXmlExists"]:!!this.hTb,["ShouldCallGetMoreInfo"]:this.eL.supportsGetMoreInfoForPersonalStorage}));
return this.t5i(yc)}t5i(nc){nc&&(this.hTb?nc.PopulationXML=this.hTb:(this.eL.supportsGetMoreInfoForPersonalStorage&&!this.ap&&this.gKi.m_("Opened New menu",!0),nc.PopulationXML=this.BNh(this.getTemplateListJson())));return 32}smf(){return!this.eL.supportsGetMoreInfoForPersonalStorage||!!this.ap&&3===this.ap.state&&!!this.ap.Joa&&!!this.ap.XR}hsi(){return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.N_?!0:this.smf()}getTemplateListJson(){if(!this.yAc||!this.hsi())return null;if(this.enb&&
!this.cZb){var nc="9";const Sc=r.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Sc&&(nc=Sc.NumberOfTemplatesInBackstage);let zb=this.YP;"TemplateCollectionId"in Sc&&(zb=Sc.TemplateCollectionId);nc=String.format(this.eL.m0+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",w.a.lf(r.AFrameworkApplication.lcid.toString()),w.a.lf(zb),nc);Boolean.parse(Sc.AppendOriginQueryParam||"false")&&(nc+="&org=backstage");Boolean.parse(Sc.BackstagePremiumTemplateExperienceEnabled||"false")&&
"TemplateTier"in Sc&&(nc+="&templateTier="+Sc.TemplateTier);nc+="&"+r.AFrameworkApplication.sec();r.AFrameworkApplication.Gxa&&(nc+="&"+r.AFrameworkApplication.Jdc());this.eL.wFb.Om(nc,1,null,null,!1,2,Wb=>{this.eL.UOa("CreateNewActor.GetTemplateListJson",Wb.data);this.TPj(Wb.data.fe)},Wb=>{this.eL.UOa("CreateNewActor.GetTemplateListJson",Wb.data);this.SPj()},null,void 0,void 0,void 0,void 0,"5");this.enb=!1}return this.bVc}TPj(nc){this.bVc=nc;this.enb=!1;this.IJb();if(r.AFrameworkApplication.ta&&
r.AFrameworkApplication.ta.Pa.N_&&B.c()){nc=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Sc=r.AFrameworkApplication.jca;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.bVc,!0,nc&&Sc))}}SPj(){this.cZb=this.enb=!0;this.IJb();r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.N_&&B.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));u.Health.instance.recordQosError("TemplateServiceReturnedFailure",
["TemplateServiceFailed"],!1,!0,!0,!1,null)}M4h(nc){var Sc=0;for(var zb=0;zb<nc.length;zb++)if("ST"===nc[zb].ImageType){Sc=zb;break}const Wb=nc.length?nc[Sc]:null;nc=Wb?Wb.Url||"":"";var yc;let Uc=zb=Sc=!1;if(Wb&&(yc=Wb.AspectRatio))yc=parseFloat(yc),1>yc?Sc=!0:1.5<yc?zb=!0:1===yc&&(Uc=!0);else switch(h.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:nc}),this.eL.Oca){case 3:Sc=!0;break;case 2:zb=!0;break;case 5:Uc=!0}return{returnValue:nc,Kdi:Sc?"95by123":zb?"123by69":
Uc?"100by100":"123by95"}}BNh(nc){nc=({bAc:Sc}=this.PYg(nc,this.Boc,this.Boc.LHa||"1056925771")).returnValue;if(Sc){this.hTb=nc;var Sc=(new Date).getTime()-this.Rfe;h.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:Sc})}return nc}Ixb(nc,Sc){h.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.ap||3!==nc.state?2===nc.state&&(h.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.nUc=
!0,this.IJb()):(this.ap=nc,Sc||this.IJb(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.N_&&B.c()&&B.d("setFileMenuHostInformation")&&(nc=Object.assign(new z,{hostUrl:this.ap.XR,hostName:this.ap.Joa,folderUrl:r.AFrameworkApplication.breadcrumbFolderUrl,folderName:r.AFrameworkApplication.breadcrumbFolderName}),h.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(nc))))}PYg(nc,Sc,zb){let Wb;Wb=!1;const yc=
this.smf();let Uc="";this.eL.supportsGetMoreInfoForPersonalStorage&&(this.nUc?(Uc=x.Oze(Sc),this.nUc=!1,h.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.ap?yc?Uc=x.SYg(Sc,this.ap):this.ap.Sii?(Wb=!0,this.enb=!1,Uc=x.QYg(Sc,this.ap),h.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Wb=!0,Uc=x.Oze(Sc),h.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.ap.XR,["StorageServiceDisplayNameIsSet"]:!!this.ap.Joa})):(Uc=x.RYg(Sc.ti),h.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));yc&&(Uc+=x.OYg(Sc,zb,!Uc)+({bAc:Wb}=this.MZg(nc,zb)).returnValue);return{returnValue:x.qsh(Uc),bAc:Wb}}MZg(nc,Sc){let zb;zb=!1;if(!this.yAc)return zb=!0,h.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",bAc:zb};let Wb="",yc="",Uc="MenuTemplate";if(this.cZb)Wb=
x.Zze(),this.cZb=!1,h.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(nc){try{const fd=Sys.Serialization.JavaScriptSerializer.deserialize(nc,!0);Wb=this.LZg(fd,Sc);h.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");r.AFrameworkApplication.syf&&"OneDrive"===this.pma&&(yc=x.MYg(this.hKi,r.AFrameworkApplication.syf))}catch(fd){h.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:nc}),
Wb=x.Zze()}zb=!0}else Uc="MenuLoading",Wb=x.NZg(),h.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:x.OZg(Uc,Wb)+yc,bAc:zb}}LZg(nc,Sc){let zb="";const Wb=[];for(let Uc=0;Uc<nc.length;Uc++){var yc=nc[Uc];let fd="";if(yc){const rb=yc.Title,Ub=yc.AssetId;yc=yc.Thumbnails;Ub&&rb&&yc&&({Kdi:yc,returnValue:fd}=this.M4h(yc),zb+=x.Qqb("jbtnNewTemplate"+Uc,rb,null,yc,null,fd,Sc,Ub))}Wb[Uc]=fd}nc=new A.a(4,1,5E3,()=>{this.DDi(Wb)},106);this.eL.zoc.Eg(nc);
return zb}IJb(){this.uOc=!0;this.eL.kyf.ux(this.Boc.jwb);this.uOc=!1}get eL(){return this.y2.value}get Boc(){return this.Qjb.value}get gKi(){return this.zEa.value}get hKi(){return this.IAg.value}get pma(){return this.pra.value}get yAc(){return this.VDg.value}}Object(b.a)(C,"CreateNewActor",null,[]);var G=a(1337);class J extends G.a{constructor(){super()}lre(){this.ZT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.ZT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.ZT(2,CommonUIStrings.l_Open);
this.ZT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.ZT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.ZT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return J.Ma||(J.Ma=new J)}static e1i(nc){return J.instance.ga(nc)}}J.Ma=null;Object(b.a)(J,"MruActorIntlHelper",G.a,[]);var L;(function(nc){nc[nc.success=0]="success";nc[nc.failure=1]="failure";nc[nc.spinner=2]="spinner";nc[nc.none=3]="none"})(L||(L={}));Object(b.b)("DisplayState",L);var P=a(41);class aa{constructor(nc,Sc,zb,Wb,yc,
Uc,fd,rb){this.TIc=null;this.$Vc=!0;this.gTb="";this.FFg=0;this.TXa=null;this.nPc=3;this.nb=rb;this.y2=nc;this.nj=Sc;this.Jwg=zb;this.Mtg=Wb;this.Ltg=yc;this.zEa=new d.a(()=>new l.a(Uc.value,null));this.txg=new d.a(()=>new l.a(fd.value,Object(m.a)(this,this.RIi,"mruEventResultReceived")));this.nb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.nb.qa("UiHostSupportsDocRebootFeatures")}RIi(nc,Sc){this.TXa=nc;Sc||this.hUf()}ofj(){this.OD.J$a.Me(H.a.ctc,S.a.frame,Object(m.a)(this,this.ctc,"populateMruMenu"),
96)}ctc(nc,Sc,zb,Wb,yc){return 1!==zb&&yc?this.q5i(yc):32}q5i(nc){this.Vsh();this.Ush();nc.PopulationXML=x.rsh(this.gTb+this.TIc);return 32}Vsh(){var nc=3;let Sc=!1;if(this.gTb&&this.FFg===this.TXa.ERj)h.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),nc=this.nPc;else{h.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var zb=this.OD.Ew();this.TXa=this.QIi.m_("File Open opened",
!0);this.gTb&&2!==this.nPc&&3!==this.TXa.state?Sc=!0:(nc=this.G2h(this.TXa),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Pa.N_&&B.c()&&nc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(nc,!0)),this.gTb=({ZJi:nc}=this.CNh(this.TXa)).returnValue);zb=this.OD.Ew()-zb;h.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:zb})}2!==nc&&(zb={["DisplayState"]:L[nc]},1!==nc&&(zb.IsStale=Sc),h.ULS.sendTraceTag(5849630,
202,50,"MRU section display state {0}",zb));this.nPc=nc}G2h(nc){let Sc;try{Sc=P.c(nc.TAd)}catch(zb){Sc=null,h.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",zb)}return Sc}Ush(){this.$Vc?(h.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.TIc=({u4j:this.$Vc}=this.XEi()).returnValue):h.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");h.ULS.sendTraceTag(5849633,202,
50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.$Vc,["NotDisplayingLink"]:!this.TIc})}CNh(nc){let Sc;1===nc.state||0===nc.state?(h.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),nc=2,Sc=x.Mze(this.vka(2),this.vka(5))):3===nc.state&&nc.TAd?(Sc=this.NYg(nc.TAd),nc=0):(h.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Sc=x.Wqb(this.vka(1),this.vka(2)),nc=1);return{returnValue:Sc,ZJi:nc}}NYg(nc){let Sc;const zb=
this.PEb.LHa||"2155708348";if(nc.length){Sc=x.Vqb("lblRecentDocuments",this.vka(3));let Wb=0;for(let yc=0;yc<nc.length;yc++){const Uc=nc[yc];"FileName"in Uc&&"DocumentUrl"in Uc&&"Path"in Uc&&(Sc+=x.Qqb("MruButton"+yc,Uc.FileName.toString(),Uc.Path.toString(),null,this.PEb.Pka,this.PEb.Izb,zb,Uc.DocumentUrl.toString()),Uc.IsPinned&&Wb++)}Sc=x.Tha("RecentDocumentsMenuSection",x.vxf,this.vka(2),Sc);h.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:nc.length,
["NumPinnedDocuments"]:Wb})}else Sc=x.Wqb(this.vka(0),this.vka(2)),h.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Sc}XEi(){let nc;nc=!0;let Sc=this.iXg;var zb=this.hXg;if(Sc&&zb||!this.OD.supportsGetMoreInfoForPersonalStorage)nc=!1;else{const Wb=this.Qdc.m_("File Open",!1);3===Wb.state&&(Sc=Wb.XR,zb=Wb.Joa,nc=!1)}zb=zb?String.format(this.vka(4),zb):null;return{returnValue:x.QXg(this.PEb.LHa,zb,Sc),u4j:nc}}hUf(){this.OD.kyf.ux(this.PEb.jwb)}get OD(){return this.y2.value}get vka(){return this.nj.value}get PEb(){return this.Jwg.value}get iXg(){return this.Mtg.value}get hXg(){return this.Ltg.value}get Qdc(){return this.zEa.value}get QIi(){return this.txg.value}}
Object(b.a)(aa,"MruRenderer",null,[]);var U=a(241),K=a(769);class Y{constructor(nc,Sc,zb,Wb,yc,Uc,fd){this.ap=null;this.Ike=!1;this.Fqa=this.u7d=0;this.PAg=nc;this.iYa=Sc;this.SWb=zb;this.Qjb=Wb;this.pra=yc;this.y2=Uc;this.zEa=new d.a(()=>new l.a(fd.value,Object(m.a)(this,this.Ixb,"getMoreInfoEventReceived")))}g2a(){!this.ap&&this.DBd.supportsGetMoreInfoForPersonalStorage?this.Qdc.m_("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}Ixb(nc){if(!this.ap&&3===nc.state)this.ap=nc;else if(2===
nc.state){this.Ike?h.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Qdc.m_("NewDocumentFromStream",!0),this.Ike=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.u7d=(new Date).getTime();var nc=this.$Fh.l7c;if(null===nc)this.iYa(null);else{var Sc=this.SWb.menuItemId,zb=this.SWb.vG,Wb=this.SWb.CNj,yc=this.SWb.eGh;this.Fqa="streamBase64"===Wb?yc.length/1024:0;h.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.YP,
this.Fqa);var Uc=(new Date).getTime();nc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",nc,w.a.lf(this.pma),w.a.lf(Sc),w.a.lf(this.YP),w.a.lf(r.AFrameworkApplication.lcid.toString()),w.a.lf(Uc.toString()),w.a.lf(zb),w.a.lf(r.AFrameworkApplication.canary),r.AFrameworkApplication.Hi,w.a.lf(Wb));nc+="&"+r.AFrameworkApplication.sec();r.AFrameworkApplication.Gxa&&(nc+="&"+r.AFrameworkApplication.Jdc());(Sc=this.ap?this.ap.XR:null)&&
(nc+="&DestinationUrl="+w.a.lf(Sc));this.DBd.wFb.Om(nc,2,yc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(m.a)(this,this.bKi,"newDocumentFromStreamSuccessHandler"),Object(m.a)(this,this.aKi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}bKi(nc){if(nc&&nc.data&&nc.data.fe)if(({Gt:Sc}=P.d(nc.data.fe)).returnValue)if(nc=Sc,nc.StatusCode!==U.a.wP&&nc.StatusCode!==U.a.ttb)h.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.YP,this.Fqa,nc.StatusCode),this.iYa(null);else if(nc.NewDocumentUrl&&""!==nc.NewDocumentUrl){var Sc=(new Date).getTime()-this.u7d;h.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.YP,this.Fqa,Sc);this.PAg(nc.NewDocumentUrl)}else h.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.YP,this.Fqa),this.iYa(null);else h.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.YP,this.Fqa,{["ResponseData"]:K.a.Egb(nc.data.fe)}),this.iYa(null);else h.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.YP,this.Fqa),this.iYa(null)}aKi(nc){nc&&nc.data&&h.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.YP,this.Fqa,nc.data.status);this.iYa(null)}get YP(){switch(this.DBd.Oca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get $Fh(){return this.Qjb.value}get pma(){return this.pra.value}get DBd(){return this.y2.value}get Qdc(){return this.zEa.value}}Object(b.a)(Y,"NewDocumentFromStreamOperation",null,[]);class na{constructor(nc,Sc,zb,Wb){this.Qjb=nc;this.pra=Sc;this.y2=zb;this.sxg=Wb}create(nc,Sc,zb){return new Y(nc,Sc,zb,this.Qjb,this.pra,this.y2,this.sxg)}}Object(b.a)(na,"NewDocumentFromStreamOperationFactory",null,[653]);var W=a(82),X=a(520),Aa=a(55);
class Q{get name(){return"Common.App.NewAndOpen.UX"}Oh(nc){nc.register(na,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").wc().Ac(()=>new na(new d.a(()=>r.AFrameworkApplication.ta.Pa.Ahd()),new d.a(()=>r.AFrameworkApplication.pma),new d.a(()=>nc.yg("Common.INewAndOpenCommonHelpers")),new d.a(()=>nc.yg("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){r.AFrameworkApplication.fa.Iu(()=>{this.Zzb()})}Zzb(){const nc=
X.a.xq(W.a.instance.Rb("Common.INewAndOpenCommonHelpers")),Sc=X.a.xq(W.a.instance.Rb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));r.AFrameworkApplication.pma&&Aa.Task.WAA.call(null,nc,Sc).continueWith(()=>{const zb=new C(new d.a(()=>nc.result),new d.a(()=>r.AFrameworkApplication.ta.Pa.Ahd()),new d.a(()=>Sc.result),new d.a(()=>r.AFrameworkApplication.ta.Pa.Bhd().LHa||"1959943459"),new d.a(()=>r.AFrameworkApplication.pma),new d.a(()=>r.AFrameworkApplication.Lqi));zb.Hg();zb.IJb()});if(r.AFrameworkApplication.ISf){const zb=
X.a.xq(W.a.instance.Rb("Common.IEventEmitter<Common.IMruResult>"));Aa.Task.WAA.call(null,nc,Sc,zb).continueWith(()=>{const Wb=new aa(new d.a(()=>nc.result),new d.a(()=>J.e1i),new d.a(()=>r.AFrameworkApplication.ta.Pa.Bhd()),new d.a(()=>r.AFrameworkApplication.d1i),new d.a(()=>r.AFrameworkApplication.c1i),new d.a(()=>Sc.result),new d.a(()=>zb.result),r.AFrameworkApplication.fa);Wb.ofj();Wb.hUf()})}}dispose(){}}Object(b.a)(Q,"UXPackageManager",null,[4,5,3]);var fa=a(1179),Ca=a(1186),ia=a(1158),Ra=a(1195),
Ya=a(1187),Ga;(function(nc){nc[nc.myFiles=0]="myFiles";nc[nc.recent=1]="recent";nc[nc.currentFolder=2]="currentFolder";nc[nc.yourPhone=3]="yourPhone"})(Ga||(Ga={}));Object(b.b)("SharedFilePickerLandingLocation",Ga);class da{constructor(nc){this.HMa=this.dcb=null;this._initialized=!1;this.Lnd=nc}y3a(nc){this._initialized||(nc.vo(I.a.nTf),nc.em(I.a.nTf,Object(m.a)(this,this.nXi,"onReceivedPickerResponse")),this._initialized=!0)}Chd(nc){return this.HMa=new Promise((Sc,zb)=>{const Wb={};Wb[D.a.e4i]=nc;
this.dcb=(yc,Uc)=>{""===Uc?(h.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Sc(yc)):("Canceled"===Uc?h.ULS.sendTraceTag(572548164,306,50,Uc):h.ULS.sendTraceTag(556901065,306,10,Uc),zb(Uc))};this.Lnd.execute(yc=>{this.y3a(yc);yc.Sj(I.a.i1i,Wb)})})}nXi(nc){this.dcb(nc.Values[D.a.stj],void 0===nc.Values[D.a.wHd]||null===nc.Values[D.a.wHd]?"":nc.Values[D.a.wHd])}dud(){return r.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}eJe(nc,Sc,zb,Wb,yc,Uc,fd){const rb={};rb[D.a.etj]=
nc;rb[D.a.titleText]=Sc;rb[D.a.$Qg]=zb;rb[D.a.aRg]=Wb;rb[D.a.bRg]=!1;rb[D.a.aoh]=!0;rb[D.a.kGh]=yc;rb[D.a.i4i]=Uc;rb[D.a.h4i]=Ga[fd];B.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(rb[D.a.j4i]="Dark");return rb}}Object(b.a)(da,"SharedFilePickerManager",null,[617]);class Z{constructor(){this.$a=null}get name(){return"Common.App.SharedFilePicker"}Oh(nc){this.$a=nc;nc.register(da,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").wc().Ac(()=>
new da(nc.Rb("Postmessage.IHostPostmessenger")))}init(){r.AFrameworkApplication.fa.Iu(()=>{this.Zzb()})}Zzb(){this.$a.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.vi(new Z)}}Object(b.a)(Z,"SharedFilePickerPackage",null,[4,5]);var ha=a(1289),Wa=a(838),ca=a(27);class ja{get name(){return"Common.App.WildFire"}Tpe(nc){let Sc=!1;nc&&(nc.z6c(),nc.e_g&&(Sc=!1));return Sc}$bh(){var nc=r.AFrameworkApplication.ta.Pa;nc=new ha.a(nc.Ij,Wa.a.Pec(),!1,1===nc.E6);
this.Tpe(nc)&&h.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}g7b(nc,Sc,zb,Wb,yc,Uc){nc=new ha.a(nc,zb,Wb,Sc,yc,Uc);this.Tpe(nc)&&h.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}jih(){const nc=r.AFrameworkApplication.ta.Pa;var Sc=r.AFrameworkApplication.fa;const zb=nc.Ij,Wb=1===nc.E6;if(Sc.qa(Wa.a.v6h(zb))){var yc=Wa.a.Pec(),Uc=8<ca.a.N6a;if(2!==zb||2!==yc||!Wb){Sc=Sc.qa(Wa.a.w6h(zb));var fd=nc.$0f(),rb=()=>nc.Ux;Sc&&!Wa.a.Asd(Wa.a.mgd(zb))&&this.g7b(zb,Wb,yc,Uc,rb,fd)}}}init(){var nc=
r.AFrameworkApplication.fa;const Sc=nc.qa("WildFireChromeExtensionEnabled");nc=nc.qa("WildFireChromeExtensionBar")&&Sc;Wa.a.AAc&&nc&&!Wa.a.Asd(Wa.a.ADe)?this.$bh():(document.body&&Wa.a.HFj&&this.jih(),r.AFrameworkApplication.ub.Nb(H.a.Gwd,S.a.frame,Object(m.a)(this,this.Gwd,"launchWildFireBusinessBar")))}Gwd(nc,Sc,zb,Wb,yc){if(1===zb)return 32;if(!yc)return 8;this.g7b(yc.app,yc.mode,yc.platform,yc.useTwoButton,null,null);return 32}dispose(){}Oh(){}static main(){e.a.instance.vi(new ja)}}Object(b.a)(ja,
"PackageManager",null,[4,5]);var ua=a(1277);a(1065);var Za=a(9),Pa=a(695),ka=a(48),ra=a(37),ba=a(184),Ua=a(1);class Ka{constructor(nc){this.Wh=nc}nc(){return!1}executeCommand(nc,Sc,zb){return 2!==this.Wh.$d(H.a.newDocument,2,zb)?Aa.Task.Ra(!0):ba.a(Sc.command)}yc(nc,Sc){return 1056925771===Sc.command}Lc(nc,Sc,zb){nc=!0;switch(Sc){case "PopulateNewMenu":this.Wh&&(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&r.AFrameworkApplication.Hs("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),
Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConsumerTemplates",!1)&&(r.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",r.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Wh.$d(H.a.dtc,2,zb));break;default:nc=!1}return nc}}Object(b.a)(Ka,"CreateNewCommandHandler",null,[219]);class Oa extends Pa.a{constructor(nc){super(nc)}ld(){const nc=ka.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),Sc=ka.GetServiceTaskFactory.create(this.$.da,
165,this.ka,this.Ya);ra.TaskExtensions.za(ra.TaskExtensions.Ed([nc,Sc],this.ka),()=>{this.Zc([new Ka(r.AFrameworkApplication.ub)])},this.ka,3)}static la(nc){Pa.a.Nd(87,new Oa(nc))}}Object(b.a)(Oa,"CreateNewCommandHandlerFactory",Pa.a,[]);var ib=a(1172),La=a(1067),db=a(1214),Ab=a(513),Mb=a(102),pb=a(188),Qb=a(11),xb=a(22),pa=a(282),Ma=a(994);class ya{}ya.create="Create";ya.activate="Activate";ya.close="Close";ya.remove="Delete";ya.duplicate="Duplicate";Object(b.a)(ya,"Actions",null,[]);var Ea=a(29),
Na=a(44);class kb extends Aa.Task{constructor(nc){super();this.E4d=null;this.G4d=0;this.XSb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.jYa=this.jYa()}catch(Sc){this.dispose(),this.sBa(Sc),this._state=3}};this.fu=nc;this.jYa=this.IGc;this.moveNext()}IGc(){this.E4d=Ea.a.dd(3,2,0,1662,0,-1244327602,"MsFormDeleteConfirmation");this.XSb=Na.a(this.fu.$).uj(this.E4d).G();this.XSb.isCompleted||(this._state=2,this.XSb.hab(this.moveNext));return this.yog}yog(){this.G4d=
this.XSb.m_();0===this.G4d&&(this.fu.$.workbookContext.Options=Qb.HelperMethods.XO(!1,this.fu.$.workbookContext.Options,2048),this.fu.deleteMsFormMetaDataSheet());this._state=3;this.XSa(!0)}dispose(){}}Object(b.a)(kb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",Aa.Task,[3]);class lb{}lb.action="Action";lb.zIh="FlexPane";lb.Lbc="formId";lb.id="id";lb.title="Title";lb.jSb="XlWorkbookId";lb.uKh="Fragment";lb.host="Host";lb.DSj="TopView";lb.accountType="auth_pvr";
Object(b.a)(lb,"Parameters",null,[]);var oa=a(60);const Ba=(nc,Sc,zb,Wb,yc,Uc,fd=null)=>{fd=nc.Oa(9,fd);fd.sheetName=Sc;fd.confirmationChoice=!0;return oa.g(nc,"DeleteSheet",fd,zb,Wb,yc,Uc,0)};class sa{constructor(nc){this.Eo="Excel";this.$=nc;this.pV=Ma.a.current}get hasMsForm(){return Mb.c(this.$.lg)}get noc(){return this.$.workbookContext.MsFormId}get fSb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return xb.a.contains(this.$.sv.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":
"OrgId"}nc(nc,Sc){switch(Sc){case -105284469:return!Mb.i(this.$.lg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(nc,Sc){nc=ra.TaskExtensions.Vj();Sc=Sc.command;switch(Sc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:nc=this.deleteMsForm();break;default:nc=ba.a(Sc)}return nc}yc(nc,
Sc){if(!this.$.ea.Mg.get(61))return!1;nc=!1;switch(Sc.command){case -105284469:nc=Mb.i(this.$.lg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:nc=this.hasMsForm}return nc}Lc(){return!1}insertMsForm(){const nc=w.a.mq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Sc={},zb={};Sc[lb.action]=ya.create;Sc[lb.accountType]=this.accountType;zb[lb.action]=ya.create;zb[lb.jSb]=encodeURIComponent(this.fSb);zb[lb.host]=this.Eo;zb[lb.title]=encodeURIComponent(nc);
this.GEb(Sc,zb);this.$.workbookContext.Options=Qb.HelperMethods.XO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const nc={},Sc={};nc[lb.accountType]=this.accountType;Sc[lb.Lbc]=this.noc;Sc[lb.jSb]=encodeURIComponent(this.fSb);Sc[lb.host]=this.Eo;this.GEb(nc,Sc)}previewMsForm(){const nc={},Sc={};nc[lb.accountType]=this.accountType;Sc[lb.Lbc]=this.noc;Sc[lb.jSb]=encodeURIComponent(this.fSb);Sc[lb.host]=this.Eo;Sc[lb.DSj]="Preview";this.GEb(nc,Sc)}sendMsForm(){const nc={},Sc={};nc[lb.accountType]=
this.accountType;Sc[lb.Lbc]=this.noc;Sc[lb.zIh]="SendForm";Sc[lb.jSb]=encodeURIComponent(this.fSb);Sc[lb.host]=this.Eo;this.GEb(nc,Sc)}deleteMsForm(){return new kb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.oD(new pb.a(158,0,(nc,Sc,zb)=>Ba(this.$.pa.Ww,this.pV.qwb,pa.b(nc,()=>{this.ulh()}),Sc,zb,null)))}ulh(){const nc={},Sc={};nc[lb.action]=ya.remove;nc[lb.accountType]=this.accountType;Sc[lb.action]=ya.remove;Sc[lb.host]=this.Eo;Sc[lb.Lbc]=encodeURIComponent(this.noc);Sc[lb.jSb]=
encodeURIComponent(this.fSb);this.GEb(nc,Sc)}GEb(nc,Sc){const zb=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx";let Wb="";var yc="";if(Sc){for(let rb in Sc){var Uc=rb,fd=Sc[rb];yc+=yc.length?"&":"";yc+=Uc+"="+fd}nc||(nc={});nc[lb.uKh]=encodeURIComponent(yc)}if(nc)for(let rb in nc)Sc=rb,yc=nc[rb],Wb+=Wb.length?"&":"?",Wb+=Sc+"="+yc;window.open(zb+Wb,"_blank")}}Object(b.a)(sa,"MsFormCommandHandler",null,[219]);class qb extends Pa.a{constructor(nc){super(nc)}ld(){const nc=ka.GetServiceTaskFactory.create(this.$.da,
203,this.ka,this.Ya);ra.TaskExtensions.za(ra.TaskExtensions.Ed([nc],this.ka),()=>{this.Zc([new sa(this.$)])},this.ka,3)}static la(nc){nc.ea.Mg.get(61)&&Pa.a.Nd(215,new qb(nc))}}Object(b.a)(qb,"MsFormCommandHandlerFactory",Pa.a,[]);var Jb=a(222);class Yb extends Jb.a{constructor(nc){super();this.$=nc;this.Fb()}create(){ra.TaskExtensions.za(ka.GetServiceTaskFactory.create(this.$.da,164,this.ka,this.Ya),()=>{this.ob(new Q)},this.ka,3)}}Object(b.a)(Yb,"NewAndOpenUXFactory",Jb.a,[]);class jb{constructor(nc,
Sc){this.Wh=Sc;this.$=nc}executeCommand(nc,Sc,zb){nc=2;switch(Sc.command){case H.a.openUrlInNewTab:nc=this.Wh.$d(H.a.openUrlInNewTab,2,zb);break;case H.a.pQa:nc=this.Wh.$d(H.a.pQa,2,zb)}return 2!==nc?Aa.Task.Ra(!0):ba.a(Sc.command)}yc(nc,Sc){return Sc.command===H.a.openUrlInNewTab||Sc.command===H.a.pQa}Lc(nc,Sc,zb){return"PopulateMruMenu"===Sc?(this.Wh.$d(H.a.ctc,2,zb),!0):!1}nc(){return!1}}Object(b.a)(jb,"OpenFromMruCommandHandler",null,[219]);class ab extends Pa.a{constructor(nc){super(nc)}ld(){const nc=
ka.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),Sc=ka.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Ya);ra.TaskExtensions.za(ra.TaskExtensions.Ed([nc,Sc],this.ka),()=>{this.Zc([new jb(this.$,r.AFrameworkApplication.ub)])},this.ka,3)}static la(nc){Pa.a.Nd(88,new ab(nc))}}Object(b.a)(ab,"OpenFromMruCommandHandlerFactory",Pa.a,[]);var vb=a(1148),Da=a(1188),Fa=a(1227),nb=a(1070),Ta=a(1168),V=a(1071),va=a(1072),wb=a(1173),fc=a(1215),Fc=a(1216),Qa=a(83),la=a(374),hb=a(100),Kb=a(21),
dc=a(375);class sb{constructor(nc,Sc){this.sheetName=null;this.value=!1;this.sheetName=nc;this.value=Sc}getSheetName(){return this.sheetName}twa(){return this.value}}Object(b.a)(sb,"MacroRecorderSheetOptionToggledPayload",null,[145]);const bb=(nc,Sc,zb,Wb,yc,Uc,fd,rb=null)=>{rb=nc.Oa(9,rb);rb.sheetName=Sc;rb.show=zb;return oa.g(nc,"ShowGridlines",rb,Wb,yc,Uc,fd,0)},Ob=(nc,Sc,zb,Wb,yc,Uc,fd,rb=null)=>{rb=nc.Oa(9,rb);rb.sheetName=Sc;rb.show=zb;return oa.g(nc,"ShowHeadings",rb,Wb,yc,Uc,fd,0)},gc=(nc,
Sc,zb,Wb,yc,Uc,fd,rb=null)=>{rb=nc.Oa(9,rb);rb.sheetName=Sc;rb.directionRtl=zb;return oa.g(nc,"ChangeSheetDirection",rb,Wb,yc,Uc,fd,0)};class mb{constructor(nc){this.$=nc}nc(){return!1}executeCommand(nc,Sc){const zb={};this.$.pk(zb);nc=Sc.command;const Wb=Object(Qa.a)(hb.a,this.$.va.getItemByName(zb.SheetName));if(!Wb)return ba.a(nc);let yc,Uc,fd,rb,Ub;switch(nc){case 705559150:case -1411193626:yc=16;Uc=!Wb.hideGridLines;fd=bb;Ub=183;rb=Wb.hideGridLines;break;case -2052321504:case 515737500:yc=4;
Uc=!Wb.headersVisible;fd=Ob;Ub=184;rb=!Wb.headersVisible;break;case -1478455630:yc=2;Uc=!Wb.displayRtl;fd=gc;Ub=185;rb=!Wb.displayRtl;Kb.h(this.$).Da.cYj(Uc);break;default:return ba.a(nc)}Wb.Grb(yc,Uc);const oc=()=>new sb(zb.SheetName,rb),Nc=this.$.pa.xa;return la.a(this.$.userOperationManager,(ud,Lb,pc)=>fd(Nc,zb.SheetName,rb,pa.b(ud,Ha=>{mb.nHb(Ha,Wb,yc,Uc)}),pa.a(Lb,()=>{mb.zGb(Wb,yc,Uc)}),pc,null),ud=>new pb.a(Ub,0,ud,void 0,oc),Sc)}yc(nc,Sc){nc=!1;switch(Sc.command){case -1411193626:case 515737500:case -1478455630:nc=
!0;break;case 705559150:case -2052321504:nc=dc.a(this.$)}return nc}Lc(){return!1}static nHb(nc,Sc,zb,Wb){Ea.a.Nq(nc.Errors)&&Sc.Grb(zb,!Wb)}static zGb(nc,Sc,zb){nc.Grb(Sc,!zb)}}Object(b.a)(mb,"SheetOptionsToggleCommandHandler",null,[219]);class Nb extends Pa.a{constructor(nc){super(nc)}ld(){this.Zc([new mb(this.$)])}static la(nc){Pa.a.Nd(100,new Nb(nc))}}Object(b.a)(Nb,"SheetOptionsToggleCommandHandlerFactory",Pa.a,[]);var ic=a(171),gb=a(179),Eb=a(148),Lc=a(66),Ec=a(59),Cb=a(207),eb=a(588),Sb=a(92),
ld=a(251),bd=a(210),ec=a(12);class sc extends bd.a{constructor(nc,Sc,zb,Wb=null){super(nc,zb,2,Wb);this.UMc=null;this.onResize=()=>{const yc=this.HWh();this.JMa.setAttribute("width",yc.x.toString());this.JMa.setAttribute("height",yc.y.toString());this.QYj(yc);this.uEd()};this.fMe=Sc;this.$.DC(this.onResize);this.cgc()}get JMa(){return this.UMc}initialize(){const nc=this.$.Eb+"iframeDialog_frame",Sc=this.$.Eb+"iframeDialog";this.Ib.style.margin=Qb.HelperMethods.uc(0);this.Ib.style.marginBottom=Qb.HelperMethods.uc(-2);
if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7111358_IFrameDialogReduceInnerHtml")){var zb=document.createElement("iframe");zb.id=nc;zb.frameBorder="0";zb.scrolling="auto";zb.src=this.Rhd(Sc);this.Ib.appendChild(zb)}else zb=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',nc,this.Rhd(Sc)),this.Ib.innerHTML=zb;this.UMc=document.getElementById(nc);this.domElement.id=Sc;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.jG(this.onResize);
super.dispose()}setFocus(){ec.DOMElementExtensions.setFocus(this.JMa)}onHide(){this.JMa.contentWindow.close();ec.DOMElementExtensions.tf(this.JMa);this.UMc=null;super.onHide()}QYj(nc){const Sc=this.domElement.style;Sc.width=Qb.HelperMethods.uc(nc.x);Sc.marginLeft=Qb.HelperMethods.uc(-nc.x/2)}HWh(){const nc=ec.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*nc.width),this.fMe.x),Math.min(Math.floor(.9*nc.height),this.fMe.y))}}Object(b.a)(sc,"IFrameDialog",
bd.a,[]);var Dc=a(5),Ud=a(74),Ed=a(13);class $d extends sc{constructor(nc){super(nc,new Sys.UI.Point(960,680),Ed.a.instance.ga(1260));this.name=Dc.a.nQe}get pc(){return"EmbeddingDialog"}Rhd(nc){const Sc=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);Cb.a.zk(Sc,Dc.a.Yuh,nc);Ud.a(this.$.ya,32)&&Cb.a.zk(Sc,Dc.a.BSe,"1");Ud.a(this.$.ya,33)&&Cb.a.zk(Sc,Dc.a.DSe,"1");Ud.a(this.$.ya,34)&&Cb.a.zk(Sc,Dc.a.CSe,"1");Ud.a(this.$.ya,35)&&Cb.a.zk(Sc,Dc.a.ASe,"1");return Sc.toString()}onShow(){h.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)($d,"EmbeddingDialog",sc,[]);var ve=a(1241),ze=a(89),We=a(80),md=a(824);class $b{}$b.O7f="FrameDialog_ShareFromEdit";$b.view="FrameDialog_View";$b.IEe="FrameDialog_CloseAndRefresh";$b.uCj="FrameDialog_ShareFromView";$b.edit="FrameDialog_Edit";$b.Ddj="FrameDialog_RefreshGrid";$b.f6g="FrameDialog_CloseMe";$b.SEe="FrameDialog_CloseMeError";$b.ready="FrameDialog_Ready";$b.L4i="FrameDialog_PleaseClose";$b.BK="GotoRange";
Object(b.a)($b,"PostMessageConstants",null,[]);var $c=a(284),nd=a(116),Oc=a(283);class Gd{constructor(){this.BK=null;this.aId=1461300262}}Object(b.a)(Gd,"SessionUpdateContext",null,[]);class Qd extends sc{constructor(nc,Sc,zb){super(nc,new Sys.UI.Point(Qd.Tkh,Qd.skh),Ed.a.instance.ga(Sc?1265:1264));this.n2a=null;this.kOc=!1;this.Frc=Wb=>{const yc=this.$,Uc=new Gd;Uc.BK=Wb.Values[$b.BK];let fd=!1;switch(Wb.MessageId){case $b.O7f:this.wv();fd=!0;Uc.aId=1334518759;break;case $b.view:this.Voa=Ed.a.instance.ga(1265);
this.Vkg(!0);break;case $b.IEe:this.wv(),fd=!0}Wb=new pb.a(140,0,(rb,Ub,oc)=>$c.n(yc.pa.xa,pa.b(rb,this.CYi),Ub,oc,Uc));Wb.flags=fd?16:80;yc.userOperationManager.Ic(Wb,this.Wd)};this.vQi=()=>{const Wb=this.$;Wb.ya.SurveyRedirectUrl?(this.wv(),Wb.Xc(1305810481,0,8,null)):(this.Voa=Ed.a.instance.ga(1264),this.Vkg(!1))};this.QYi=()=>{const Wb=this.$;this.wv();Wb.Xc(1334518759,0,8,null)};this.Hpc=Wb=>{const yc=this.$;this.wv();Wb.MessageId===$b.SEe&&yc.ea.Oed()};this.jXi=()=>{this.kOc=!0;this.raiseEvent(Qd.Rwd)};
this.CYi=(Wb,yc)=>{if(!Oc.a(Wb)){Wb=this.$;if(yc.BK){const Uc=Wb.ea.va;if(Uc.contains(yc.BK.SheetName))this.tqc(yc);else{let fd=null;fd=()=>{Uc.zna(fd);this.tqc(yc)};Uc.tha(fd)}}1461300262!==yc.aId&&Wb.Xc(yc.aId,0,8,null)}};this.rde=Sc;this.Wd=zb}HNg(nc){this.addHandler(Qd.Rwd,nc)}hjj(nc){this.removeHandler(Qd.Rwd,nc)}get pc(){return"FormDialog"}get Vkf(){return this.kOc}get v8a(){return this.rde}dispose(){ze.a.Ia(this.n2a);this.n2a=null;super.dispose()}initialize(){super.initialize();const nc=We.a.nba(this.$.ya.FormLightBoxUrl),
Sc=this.n2a=new ve.a(this.JMa.contentWindow,nc);Sc.isEnabled()&&Sc.CGa(nc)&&(this.rna($b.O7f,this.Frc),this.rna($b.view,this.Frc),this.rna($b.IEe,this.Frc),this.rna($b.uCj,this.QYi),this.rna($b.edit,this.vQi),this.rna($b.Ddj,this.Frc),this.rna($b.ready,this.jXi),this.rna($b.f6g,this.Hpc),this.rna($b.SEe,this.Hpc))}close(nc){nc===this.WM&&this.Vkf&&this.n2a.send(new md.a($b.L4i))||super.close(nc)}Rhd(){return this.cJe(this.v8a)}cJe(nc){const Sc=this.$.ya,zb=new Sys.StringBuilder(Sc.FormLightBoxUrl);
Cb.a.zk(zb,Dc.a.cKh,this.$.ea.sessionId);Cb.a.zk(zb,Dc.a.aKh,nc?Dc.a.bKh:Dc.a.$Jh);nd.a.Cpb(zb,Sc);return zb.toString()}Vkg(nc){this.kOc=!1;this.JMa.src=this.cJe(nc);this.rde=nc}rna(nc,Sc){this.n2a.vo(nc);this.n2a.em(nc,Sc)}tqc(nc){const Sc=this.$.ea.va.getItemByName(nc.BK.SheetName);Sc&&0===Sc.UB&&Kb.h(this.$).gg(nc.BK,null,null,null,20,"FormDialog.OnItemInserted")}}Qd.Tkh=900;Qd.skh=1200;Qd.Rwd="lightBoxReady";Object(b.a)(Qd,"FormDialog",sc,[249]);var Ad;(function(nc){nc[nc.comment=10]="comment";
nc[nc.range=12]="range";nc[nc.table=13]="table";nc[nc.chart=14]="chart";nc[nc.sheet=15]="sheet"})(Ad||(Ad={}));Object(b.b)("NavigationType",Ad);var Sd=a(978),Ce=a(86),we=a(19),Td=a(558),he=a(945),ee=a(286),ge=a(755),re=a(52);class Be extends ge.a{constructor(nc,Sc,zb,Wb,yc,Uc=0,fd){super(nc,Ed.a.instance.ga(Sc),!1);this.htmlSanitizationHelper=null;this.message=zb;this.rMi=Wb;this.V3d=yc;this.operationFlags=Uc;this.htmlSanitizationHelper=fd}get pc(){return"WebMethodConfirmationDialog"}get dC(){return 1005}get wIa(){return this.operationFlags}initialize(){let nc=
"<div class='"+Ce.a.Tm+"'>\r\n\t<div class='"+Ce.a.sbd+"'>\r\n\t\t<div class='"+we.a.X3c+"'>\r\n\t\t\t<img src='{0}' class='"+we.a.XVe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Ce.a.vbd+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";nc=String.format(nc,re.a.de(13),Ed.a.instance.ga(25),Ed.a.instance.ga(this.message));this.htmlSanitizationHelper&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
this.htmlSanitizationHelper.ni(this.Ib,nc):this.Ib.innerHTML=nc;this.addButton(0,this.rMi);this.addButton(1);super.initialize()}nH(){return this.V3d}}Object(b.a)(Be,"WebMethodConfirmationDialog",ge.a,[]);class Oe extends Sd.a{constructor(nc,Sc){super(nc,Ed.a.instance.ga(1267));this.htmlSanitizationHelper=this.hVa=this.GSa=this.textBox=null;this.MKf=()=>{const zb=this.$;this.wv();const Wb=new Be(zb,1270,1271,1272,(yc,Uc,fd)=>{var rb=zb.pa.xa.Wb(),Ub=zb.pa.xa;rb=Ub.Oa(1,rb);return oa.g(Ub,"UnshareForm",
rb,yc,Uc,fd,null,0)},16,this.htmlSanitizationHelper);Wb.initialize();Wb.vg()};this.htmlSanitizationHelper=Sc}get pc(){return"ShareFormDialog"}dispose(){this.hVa&&this.hVa.Uda(this.MKf);ze.a.rc([this.textBox,this.GSa,this.hVa]);this.hVa=this.GSa=this.textBox=null;super.dispose()}initialize(){let nc="<div class='"+Ce.a.Tm+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Ce.a.dKa+"'>\r\n\t<input type='text' id='{1}' class='"+Ce.a.Bz+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
nc=String.format(nc,Ed.a.instance.ga(1268),"sfd_input","sfd_unshare",we.a.Co,Ed.a.instance.ga(1269));this.htmlSanitizationHelper&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?this.htmlSanitizationHelper.ni(this.Ib,nc):this.Ib.innerHTML=nc;this.textBox=new ee.a(this.getElementById("sfd_input"));this.GSa=new he.a(this.textBox.domElement);this.hVa=Td.a.create(this.getElementById("sfd_unshare"));
this.hVa.b3(this.MKf);this.textBox.text=Ed.a.instance.ga(736);this.textBox.enabled=!1;this.textBox.readOnly=!ca.a.$g;this.addButton(1,10);super.initialize()}E0a(){return(nc,Sc,zb)=>{var Wb=this.$.pa.xa.Wb(),yc=this.$.pa.xa;nc=this.d5a(nc);Sc=this.fLa(Sc);Wb=yc.Oa(1,Wb);return oa.g(yc,"ShareForm",Wb,nc,Sc,zb,null,0)}}r0(nc,Sc,zb){this.textBox.text=nc.Result;this.textBox.enabled=!0;ec.DOMElementExtensions.setVisible(this.hVa.domElement,!0);super.r0(nc,Sc,zb)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();
return}catch(nc){}super.setFocus()}}Object(b.a)(Oe,"ShareFormDialog",Sd.a,[]);var gf=a(247),af=a(6),Ze=a(81),Xa=a(254),qa=a(70),xa=a(623),ob=a(141),Ib=a(427),Zb=a(256),zc=a(17),Mc=a(253);class hd extends gb.a{constructor(nc,Sc,zb){super();this.mBe=this.nBe=!1;this.b4a=0;this.qja=!1;this.NNi=()=>{this.nBe=!0;this.R9f()};this.$=nc;this.Va=Sc;this.wK=zb;qa.a(this.$).MLd(new ob.a(af.a.Sig,af.a.idle,hd.R2g),new gf.a(af.a.QEe,af.a.k0,null,af.a.rP,af.a.idle))}get wGc(){return Mb.b(this.$.lg)}get DQd(){return this.$.isEditMode&&
(this.$.ea.Fqh||this.$.JN)}nc(nc,Sc){switch(Sc){case 353606613:case -1099009678:case 192430811:return!Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.x8f();case 783415632:return!Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.x8f();case 869186573:return this.y8f();case -1570751769:case 1986648902:return 131072!==(this.$.mV&131072);case 330035228:return!(this.z4a(!0)&&this.wGc);case -509039657:return!(this.z4a()&&this.wGc);
case 1334518759:return!(this.z4a()&&this.wGc&&this.yBe())}return!1}x8f(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.y8f()}y8f(){const nc=this.$.workbookContext.FullDocumentInfo,Sc=Zb.a()&&this.$.ea.Mg.get(5);return!nc.FileSharingUrl&&!Sc}executeCommand(nc,Sc,zb){nc=this.$.workbookContext.FullDocumentInfo;var Wb=H.a.workflow,yc=ra.TaskExtensions.Vj();const Uc=Sc.command;if(Uc===Wb||-266099===Uc)return this.Y$h(Sc,Wb,nc);switch(Uc){case 1986648902:this.b7f();break;case -1570751769:this.F8h(Sc);
break;case 869186573:Sc=H.a.tCj;yc=r.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");Wb=null;(Ua.EwaSettings.oa(515)||yc)&&zb&&"CopyLink"===zb.SourceControlId?(Wb={},Wb[D.a.CNb]="copy",Sc=H.a.N7f):yc&&zb&&"ManageAccess"===zb.SourceControlId?(Wb={},Wb[D.a.CNb]="manageAccess",Sc=H.a.vCj):zb&&"LinkToComment"===zb.SourceControlId&&(Wb={},Wb[D.a.CNb]="copy",Wb[D.a.hUd]=zb.navId,Sc=H.a.N7f);yc=this.X$f(nc,Wb);v.c(Sc);break;case -1099009678:yc=this.Kzc(12,nc);break;case 192430811:yc=this.Kzc(13,nc);break;
case 353606613:yc=this.Kzc(14,nc);break;case 783415632:zb&&"LinkToThisSheet"===zb.SourceControlId&&h.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");yc=this.Kzc(15,nc);break;case -59906385:case 1197060601:this.k$h(Sc,nc);break;case 1305810481:this.Eaf(!1,Sc);break;case 330035228:this.Eaf(!0,Sc);break;case -509039657:Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?
ra.TaskExtensions.za(ka.GetServiceTaskFactory.Na(this.$.da,498,499,0),fd=>{this.deleteForm(fd.result)},this.$.ka,3):this.deleteForm(null);break;case 1334518759:Sc.YAb=!0;Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7094158_SocialSharingSanitizeInnerHtml")?ra.TaskExtensions.za(ka.GetServiceTaskFactory.Na(this.$.da,498,499,0),fd=>{this.shareForm(fd.result)},this.$.ka,3):this.shareForm(null);break;case 710925581:Ec.a.Ag.dAc("710925581")&&
(yc=ra.TaskExtensions.za(this.wK.value,fd=>{fd.result.Sj(I.a.conversation,{})},this.ka,3));break;case 327119921:this.s8h();break;default:yc=ba.a(Uc)}return yc}yc(nc,Sc){nc=!1;Sc=Sc.command;if(Sc===H.a.workflow)return!0;switch(Sc){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:nc=!0;break;case 353606613:case -1099009678:case 192430811:nc=Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:nc=Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return nc}Lc(nc,Sc,zb){if("PopulateFormMenu"===Sc){Sc=this.wGc?this.yBe()?hd.rEh:hd.sEh:hd.fKi;nc=this.Va.Fc();for(let Wb=0;Wb<Sc.length;Wb++)nc.buttons.push(this.Va.pb(Sc[Wb]));Sc=this.Va.gq("Forms.Flyout");Sc.tc.push(nc);zb.MenuItems=Sc.NC();return!0}return!1}Y$h(nc,Sc,zb){return this.DQd&&nc.command===Sc?(this.BQd(nc,-266099),
ra.TaskExtensions.sba()):ra.TaskExtensions.za(this.wK.value,Wb=>{eb.a(Wb.result,I.a.workflow,null,zb.WorkflowPostMessage)||Qb.HelperMethods.kf(zb.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ka,3)}yBe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Mg.get(26)}s8h(){var nc=ic.a.create().toString();h.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${nc}`);var Sc=this.$.frame,zb=Sc.F$a,Wb=this.$;const yc=new Mc.QueryStringBuilder(r.AFrameworkApplication.fa.Xa("TeamsMeetingShareEndpoint"));
yc.oj("deeplinkId",nc);yc.oj("lm","deeplink");nc=yc.oj;var Uc={};const fd=new Mc.QueryStringBuilder(r.AFrameworkApplication.fa.Xa("TeamsAppSharingUrl"));fd.oj("auth","2");fd.oj("flight","officeunihost");fd.oj("source","TEAMS-ELECTRON.meetingStage.deeplink");var rb={};rb.fileType=w.a.L4(Wb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);rb.objectUrl=Wb.workbookContext.FullDocumentInfo.WorkbookPath;rb.baseUrl=Wb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Wb=Wb.workbookContext.WorkbookFileVersionId;
let Ub=decodeURIComponent(Wb);for(;Wb!=Ub;)Wb=Ub,Ub=decodeURIComponent(Wb);0>Wb.indexOf("{")||0>Wb.indexOf("}")?(h.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Wb}`),Wb=""):Wb=Wb.substring(Wb.indexOf("{")+1,Wb.indexOf("}")).toLowerCase()}rb.fileId=Wb;rb=P.c(P.c(rb));fd.oj("subEntityId",rb.substring(1,rb.length-1));Uc.appSharingUrl=fd.toString();Uc.appId=r.AFrameworkApplication.fa.Xa("TeamsAppId");Uc=JSON.stringify(Uc);nc.call(yc,"appContext",Uc);
zb.call(Sc,yc.toString(),!0)}F8h(nc){this.DQd?this.BQd(nc,1986648902):this.b7f()}Eaf(nc,Sc){!nc&&this.$.ya.SurveyRedirectUrl?this.W8i():(nc=new Qd(this.$,nc,Sc),nc.initialize(),nc.vg())}k$h(nc,Sc){this.DQd&&1197060601===nc.command?this.BQd(nc,-59906385):ra.TaskExtensions.za(this.wK.value,zb=>{zb=zb.result;zb&&eb.a(zb,I.a.replyWithChanges,null,this.$.ea.Mg.get(8))||(zb=new Sys.StringBuilder(Sc.ReplyWithChangesUrl),Cb.a.zk(zb,Ib.e,Ib.d),Eb.a.ntw(zb.toString(),this.$))},this.ka,3)}BQd(nc,Sc){const zb=
qa.a(this.$).hd.activityState,Wb=new Sb.a(Sc,nc.method,nc.mode,nc.We,nc.tabName);Na.a(this.$).Ns(new ld.a(af.a.ky,5,()=>{zb[Xa.a.Jq]=af.a.a1f;zb[xa.a.SWc]=Wb;this.$.gl.kz("SocialSharingSaveBeforeCommand");this.$.gl.Wqe(Wb.command)}))}b7f(){const nc=this.$.ya.DocumentHostInfo;nc.HostEmbeddedViewUrl||this.nBe?this.R9f():this.$.me.get(53)&&ra.TaskExtensions.za(this.wK.value,Sc=>{this.BVj(Sc.result)||Eb.a.ntw(nc.FileEmbedCommandUrl,this.$)},this.ka,3)}BVj(nc){return nc.isEnabled()&&(this.mBe||(this.mBe=
nc.em(I.a.lBe,this.NNi)))?nc.Sj(I.a.OFh,null):!1}R9f(){if(ca.a.Hp)Eb.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const nc=new $d(this.$);nc.initialize();nc.vg()}}deleteForm(nc){const Sc=this.$;nc=new Be(Sc,1273,1274,1266,(zb,Wb,yc)=>{var Uc=Sc.pa.xa.Wb(),fd=Sc.pa.xa;Uc=fd.Oa(9,Uc);Uc.surveyId=null;return oa.g(fd,"DeleteSurvey",Uc,zb,Wb,yc,null,0)},0,nc);nc.initialize();nc.vg()}shareForm(nc){const Sc=this.$.workbookContext.FullDocumentInfo;this.$.ea.Mg.get(26)?(nc=new Oe(this.$,nc),nc.initialize(),
nc.vg()):ra.TaskExtensions.za(this.wK.value,zb=>{eb.a(zb.result,I.a.shareForm,{[D.a.COj]:this.$.workbookContext.SurveyTitle},this.$.ea.Mg.get(10))||Eb.a.ntw(Sc.ShareFormCommandUrl,this.$)},this.ka,3)}W8i(){const nc=this.$;nc.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const Sc=new Sys.StringBuilder(nc.ya.SurveyRedirectUrl);Cb.a.zk(Sc,"startupDialog","FormEdit");const zb=qa.a(this.$),Wb=zb.hd.activityState;Wb[Ze.a.U2]=Sc.toString();Wb[Ze.a.BM]=Ze.a.nBd;this.$.gl.kz("SocialSharingEnvironmentChange");
Na.a(nc).Ns(new ld.a(af.a.ky,5,()=>{const yc=Ea.a.dd(3,2,1318,1319,1320,554412057,"FossEnvironmentUnsupported");zb.hd.qr([yc]);Wb[Xa.a.Jq]=af.a.Sig}))}z4a(nc=!1){return(this.$.ea.isEditMode||nc)&&this.$.ea.Mg.get(25)&&Zb.a()}X2h(nc){var Sc=Kb.h(this.$).ha;const zb=this.$.va.na?Lc.d(this.$.va.na):null;if(!zb)return h.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Ad[nc]}.`),null;var Wb=null;14===nc?Wb=this.w2h(Sc):12===
nc?(Wb=Sc.Nia,Wb=xb.a.contains(Wb,"!",!0)?Wb.split("!")[1]:Wb):13===nc&&(Sc=Sc.ra.selectedRanges,Sc[0]&&(Sc=Kb.h(this.$).Ab.Cj(Sc[0])))&&(Wb=Sc.Ui);if(!Wb&&15!==nc)return h.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Ad[nc]}`),null;Sc={};Sc[D.a.CNb]="copy";Sc[D.a.hUd]=this.eUh(nc,Wb,zb);Sc[D.a.wCj]="deepLinkShare";h.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Ad[nc]} and sectionNameOrId: ${Wb} and SheetId: ${zb}`);
return Sc}w2h(nc){if(nc.Ta.E_&&(nc=nc.Ta.$b.floatingObject)&&0===nc.type){const Sc=nc.id.split(".");if(1<Sc.length)return Sc[1];h.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${nc.id}`)}return null}eUh(nc,Sc,zb){let Wb=nc+"_";Wb=btoa(15===nc?Wb+zb:Wb+(Sc+"_"+zb));Wb=Wb.replace(RegExp("\\+","g"),"-");Wb=Wb.replace(RegExp("\\/","g"),"_");return Wb=Wb.replace(RegExp("\\=+$","g"),"")}X$f(nc,Sc,zb=!1){return ra.TaskExtensions.za(this.wK.value,
Wb=>{eb.a(Wb.result,I.a.sharing,Sc,this.$.ea.Mg.get(5))?(h.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${Sc?Sc[D.a.CNb]:""}`),zb&&Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&!this.qja&&(this.b4a=window.setInterval(()=>{this.DTj()},6E4),this.qja=!0)):Qb.HelperMethods.kf(nc.FileSharingUrl,"_blank",
void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ka,3)}Kzc(nc,Sc){if(15===nc&&!Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==nc&&!Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const zb=this.X2h(nc);if(zb)return h.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${zb[D.a.hUd]}`),this.X$f(Sc,zb,!0);h.ULS.sendTraceTag(537151643,
0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Ad[nc]}`);return null}DTj(){this.qja&&window.clearInterval(this.b4a);Ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.Xc(638984051,0,0,null),h.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}hd.fKi=[103];hd.rEh=[107,104,105,106];hd.sEh=[104,105];hd.R2g=[new zc.a(af.a.QEe,554412057,
0,0,1321),new zc.a(af.a.idle,554412057,0,1)];Object(b.a)(hd,"SocialSharingCommandHandler",gb.a,[219]);class id extends Pa.a{constructor(nc){super(nc)}ld(){const nc=new d.a(()=>ka.GetServiceTaskFactory.create(this.$.da,137,this.ka,this.Ya));ra.TaskExtensions.za(ka.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya),Sc=>{this.Zc([new hd(this.$,Sc.result,nc)])},this.ka,3)}static la(nc){Pa.a.Nd(114,new id(nc))}}Object(b.a)(id,"SocialSharingCommandHandlerFactory",Pa.a,[]);var yd=a(1154);class Yd{constructor(nc){this.Wh=
nc}executeCommand(nc,Sc,zb){return 2!==this.Wh.$d(H.a.tryOfficeThroughTellMe,2,zb)?Aa.Task.Ra(!0):ba.a(Sc.command)}yc(nc,Sc){return 215809929===Sc.command}Lc(){return!1}nc(){return!1}}Object(b.a)(Yd,"TryOfficeThroughTellMeCommandHandler",null,[219]);class cc extends Pa.a{constructor(nc){super(nc)}ld(){this.Zc([new Yd(r.AFrameworkApplication.ub)])}static la(nc){Pa.a.Nd(207,new cc(nc))}}Object(b.a)(cc,"TryOfficeThroughTellMeCommandHandlerFactory",Pa.a,[]);var Rc=a(156),vd=a(76),Zd=a(153),pe=a(262),
Qe=a(146),bf=a(186);class $e{static qN(){return Qe.a.jq($e.nl,bf.a.Ua(443))}}$e.nl="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(b.a)($e,"NamedSheetViewTeachingDialogHtml",null,[]);var tf=a(51);class oe extends pe.a{constructor(nc){super(nc);
this.stopwatch=this.vp=null;this.oJi=Sc=>{if(1===Sc)this.$.Ka.Lb(new Sb.a(-2050946363,vd.a.Db,2,8,null)).continueWith(zb=>{this.vp.setResult(!Zd.a(zb)&&zb.result)}),Sc="Yes";else{const zb=2===Sc;this.vp.setResult(zb);Sc=2===Sc?"No":"Close";zb&&this.u7i()}this.rCi(Sc);this.hide()}}get pc(){return"ShowNamedSheetViewTeachingDialog"}hg(){this.Tb=4;this.stopwatch=this.$.Kb.Cc("UserAction",this.pc);const nc=Ed.a.instance.ga(1904);this.og=$e.qN();this.vp=new Rc.a;this.initializeAndShow(nc,this.oJi,{});return this.vp.task}Tv(nc){super.Tv(nc);
this.qc(1,Ed.a.instance.ga(1906));this.qc(2,Ed.a.instance.Ua(456))}u7i(){this.$.ea.voc=!1}rCi(nc){const Sc={};Sc.a=this.$.ya.UserSessionId;Sc.b="NamedSheetViewTeachingDialogClose";Sc.c=nc;Sc.e=!0;this.stopwatch&&(this.stopwatch.stop(),Sc.d=this.stopwatch.Bc);tf.b().Qe(53,Sc,!0)}}Object(b.a)(oe,"NamedSheetViewTeachingDialog",pe.a,[]);var jf=a(157);class Hf{constructor(nc){this.$=nc;nc.da.Ga(309,this)}MTa(){if(this.qFj()){if(Ua.EwaSettings.oa(539)){this.$.va.na.Hd.AVd=!0;const nc=new Rc.a;this.$.Ka.Lb(new Sb.a(-2050946363,
vd.a.Db,2,0,null)).continueWith(Sc=>{nc.setResult(!Zd.a(Sc)&&Sc.result)});return nc.task}return(new oe(this.$)).hg()}return Aa.Task.Ra(!0)}qFj(){const nc=this.$.va.na;return this.$.ea.S$a&&this.$.ea.voc&&!nc.Hd.Kv&&this.$.ea.gN&&!jf.g(this.$)}}Object(b.a)(Hf,"NamedSheetViewPublic",null,[614]);class Ne extends Jb.a{constructor(nc){super();this.$=nc;this.Fb()}create(){this.ob(this.$.da.Aa(309)||new Hf(this.$))}static la(nc){nc.da.Ga(310,new Ne(nc))}}Object(b.a)(Ne,"NamedSheetViewPublicFactory",Jb.a,
[]);var Xe=a(7),Mf=a(187),Te=a(1336),cb=a(862),Rb=a(463);class uc{constructor(nc,Sc,zb,Wb,yc,Uc,fd){this.title=nc;this.body=Sc;this.E7i=zb;this.primaryButtonAction=Wb;this.secondaryButtonAction=Uc;this.B2f=yc;this.targetObject=fd}}Object(b.a)(uc,"NamedSheetViewTeachingCalloutContent",null,[]);class Kc{constructor(nc){this.Sme=0;this.qeg=nc}get oeg(){return this.Sme}get g9i(){return this.oeg<this.qeg.count?this.qeg.ma(this.Sme++):null}}Object(b.a)(Kc,"NamedSheetViewTeachingCalloutList",null,[]);var pd=
a(1076);class xd{constructor(nc){this.stopwatch=this.P1b=this.LCc=this.IZd=null;this.peg=0;this.$=nc}Cfi(nc){this.peg=nc;const Sc=Object(Xe.a)(new Mf.a,{});xd.goi(nc)?(Sc.add(new uc(Ed.a.instance.Ua(445),Ed.a.instance.Ua(446),Ed.a.instance.ga(1934),()=>{this.pI(2,"Continue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.pI(1,"ExitGuide")},pd.a())),1===nc&&Sc.add(new uc(Ed.a.instance.ga(1936),Ed.a.instance.Ua(448),Ed.a.instance.ga(1934),()=>{this.pI(2,"FirstEnterTempViewContinueSecond");
this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.pI(1,"FirstEnterTempViewExitGuideSecond")},pd.a())),Sc.add(new uc(Ed.a.instance.Ua(449),Ed.a.instance.Ua(450),Ed.a.instance.ga(1934),()=>{this.pI(2,"FirstEnterExitCalloutContinue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.pI(1,"FirstEnterExitCalloutGuide")},xd.d6e())),Sc.add(new uc(Ed.a.instance.ga(1937),Ed.a.instance.Ua(447),Ed.a.instance.ga(1938),()=>{this.z$f();this.eK();this.pI(1,"LearnMore")},Ed.a.instance.ga(1939),()=>{this.eK();
this.pI(1,"Done")},xd.c6e()))):2===nc?Sc.add(new uc(Ed.a.instance.ga(1936),Ed.a.instance.Ua(448),Ed.a.instance.ga(1933),()=>{this.eK();this.pI(1,"EnterTempViewAfterPersistedView")},null,null,pd.a())):3===nc&&(Sc.add(new uc(Ed.a.instance.Ua(445),Ed.a.instance.ga(1945),Ed.a.instance.ga(1934),()=>{this.pI(2,"AutoOptInExitCalloutContinue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.pI(1,"AutoOptInExitGuide")},xd.d6e())),Sc.add(new uc(Ed.a.instance.ga(1936),Ed.a.instance.Ua(448),Ed.a.instance.ga(1934),
()=>{this.pI(2,"Continue");this.eK(!0)},Ed.a.instance.ga(1935),()=>{this.eK();this.pI(1,"ExitGuide")},pd.a())),Sc.add(new uc(Ed.a.instance.ga(1937),Ed.a.instance.Ua(447),Ed.a.instance.ga(1938),()=>{this.z$f();this.eK();this.pI(1,"LearnMore")},Ed.a.instance.ga(1939),()=>{this.eK();this.pI(1,"Done")},xd.c6e())));this.IZd=new Kc(Sc)}z$f(){const nc=new Sb.a(-859308420,vd.a.Db,this.$.Hc,9,null);this.$.Ka.Lb(nc,{[vd.a.ng]:"HelpID=SheetViews",["InputMethod"]:vd.a.Db,[vd.a.Kc]:Dc.a.IV,["ShouldCanvasTakeFocus"]:!0})}show(nc){this.Cfi(nc);
this.ffb()}Wyj(nc){this.P1b=nc}ffb(){var nc=this.IZd.g9i;if(nc){var Sc=Object(Xe.a)(new Te.a,{label:nc.E7i,onExecute:nc.primaryButtonAction}),zb=null;nc.B2f&&(zb=Object(Xe.a)(new Te.a,{label:nc.B2f,onExecute:nc.secondaryButtonAction}));nc=Object(Xe.a)(new cb.a,{target:nc.targetObject,content:nc.body,title:nc.title,showCloseIcon:!0,primaryButtonProps:Sc,secondaryButtonProps:zb,useTeachingStyles:!0});nc=this.P1b.callout(nc);Sc=Object(Xe.a)(new Rb.a,{onShow:()=>{this.pI(0)}});this.LCc=this.P1b.addNotification(nc,
Sc)}}dismiss(){this.eK();this.pI(1,"DismissedByOthers")}eK(nc=!1){this.LCc&&(this.P1b.removeNotification(this.LCc),this.LCc=null);nc&&this.ffb()}pI(nc,Sc=null){const zb={};zb.a=this.$.ya.UserSessionId;zb.b=this.peg;zb.c=this.IZd.oeg;zb.d=nc;zb.e=Sc;0===nc?this.stopwatch=this.$.Kb.Cc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),zb.f=this.stopwatch.Bc,this.stopwatch=null),2===nc&&(this.stopwatch=this.$.Kb.Cc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));
tf.b().Qe(52,zb,!0)}static c6e(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static d6e(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static goi(nc){return 0===nc||1===nc}}Object(b.a)(xd,"NamedSheetViewTeachingCallout",null,[610]);class Rd extends Jb.a{constructor(nc){super();this.$=nc;this.Fb()}create(){let nc=this.$.da.Aa(322);nc||(nc=new xd(this.$),this.$.da.Ga(322,nc));this.ob(nc)}static la(nc){nc.da.Ga(323,new Rd(nc))}}Object(b.a)(Rd,
"NamedSheetViewTeachingCalloutFactory",Jb.a,[]);var ke=a(1251),fe=a(1143),Ee=a(1250);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");
Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.vi(new Q);Object(fa.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(Ca.a)();Object(ia.a)();Object(Ra.a)();Object(Ya.a)();Type.registerNamespace("Common.App.SharedFilePicker");Z.main();Type.registerNamespace("Common.App.WildFire");ja.main();Object(ua.a)();Za.a.Fa(Oa.la);Object(ib.a)();Object(La.a)();Object(db.a)();
Ab.a.Ni(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{Za.a.Fa(nc=>{qb.la(nc)})})();(()=>{Za.a.Fa(nc=>{nc.da.Ga(165,new Yb(nc))})})();Za.a.Fa(ab.la);Object(vb.a)();Object(Da.a)();Object(Fa.a)();Object(nb.a)();Object(Ta.a)();Object(V.a)();Object(va.a)();Object(wb.a)();Object(fc.a)();Object(Fc.a)();Object(Ee.a)();Za.a.Fa(Nb.la);Za.a.Fa(id.la);
Object(yd.a)();Za.a.Fa(cc.la);(()=>{Za.a.Fa(nc=>{Ne.la(nc);Rd.la(nc)})})();Object(ke.a)();Object(fe.a)()},708:function(t,E,a){a.d(E,"a",function(){return T});t=a(0);var c=a(7),b=a(15),e=a(89),f=a(224),d=a(14),h=a(108),m=a(173),l=a(4),w=a(85);E=a(238);var n=a(1058),x=a(19),r=a(5),u=a(326),v=a(52),B=a(12),z=a(71),A=a(13),y=a(21),D=a(88),I=a(902),M=a(1);class T extends E.a{constructor(S,H){super(document.createElement("div"));this.krf=this.Bue=this.Moe=this.d5b=this.wca=this.C8=this.yP=this.qz=null;
this.Iwa=this.GV=this.zs=this.hideCloseButton=!1;this.HOi=C=>{this.KD(C)};this.NOi=C=>{13===C.keyCode&&this.KD(C)};this.YCd=C=>{this.Ym(C.tb);return!0};this.cDd=C=>{this.oW(C.tb);return!0};this.xqc=C=>{this.Mma(C.tb?C.tb:0);return!0};this.IOi=C=>{this.KD(C.Ca);return!0};this.Fqg=(C=null)=>{this.Ym(C.inputMethod?C.inputMethod:0);return!0};this.Gqg=(C=null)=>{this.oW(C.inputMethod?C.inputMethod:0);return!0};this.W1=S;this.pD=H;this.V_c=H.H0a.toString();this.title=H.title;this.message=H.message;this.set_visibilityMode(1)}get g_g(){return this.pD.H0a}get businessBar(){return this.W1}get actionButton(){return this.pD?
this.pD.actionButton:""}get Esa(){return this.pD?this.pD.Esa:""}get linkText(){return this.pD?this.pD.link:""}get Ek(){return this.pD?this.pD.Ek:""}get alt(){return this.pD?this.pD.alt:""}coa(S){this.pD.businessBarType=S}dispose(){e.a.rc([this.d5b,this.yP,this.C8]);this.zs&&this.yP&&(f.a.instance.Ba(d.a.click,this.yP.domElement,this.YCd),h.KeyInputManager.instance.Xv(this.domElement,this.Moe));this.GV&&this.C8&&(f.a.instance.Ba(d.a.click,this.C8.domElement,this.cDd),h.KeyInputManager.instance.Xv(this.domElement,
this.Bue));this.Iwa&&this.wca&&(f.a.instance.Ba(d.a.click,this.wca,this.xqc),h.KeyInputManager.instance.Xv(this.domElement,this.krf));this.wca=this.qz=this.W1=this.C8=this.yP=null;super.dispose()}update(){}hYj(){this.PJe(!0)}z6c(){this.PJe(!1)}hgh(){this.message=D.a.xf(this.message);this.title=D.a.xf(this.title);m.UISurfaces.Mid().then(S=>{S.initializeMessageBarInStore();let H=Object(c.a)(new I.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.pD.businessBarType,dismissButtonAriaLabel:A.a.instance.ga(10)});
this.hideCloseButton||(H.onDismiss=this.IOi);this.Iwa&&(H.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.xqc});this.zs&&(H.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.Fqg});this.GV&&(H.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.Esa,["onExecute"]:this.Gqg});S.createNewMessageBar(this.domElement,H);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});
l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}rfh(S){S||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var H=this.businessBar.$.Eb;S=H+"ewaBusinessBarEntryBody"+this.V_c;const C=H+"ewaBusinessBarEntryTitle"+
this.V_c;var G=H+"ewaBusinessBarEntryIcon"+this.V_c;this.domElement.className=n.a.Auh;if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:7409767_BizBarUpdateReduceInnerHtml")){B.DOMElementExtensions.RJ(this.domElement);H=document.createElement("div");H.className=n.a.fSe;H.id=S;var J=document.createElement("div");J.className=n.a.eSe;var L=document.createElement("a");L.className=n.a.lSe;L.title=this.alt;const P=document.createElement("span");P.classList.add(x.a.Zrb);P.classList.add(n.a.hSe);P.id=G;this.Ek.length&&
(G=document.createElement("img"),G.classList.add(this.Ek),G.src=v.a.de(0),P.appendChild(G));L.appendChild(P);J.appendChild(L);G=document.createElement("span");G.classList.add(n.a.kSe);G.id=C;G.innerText=D.a.xf(this.title);J.appendChild(G);G=document.createElement("span");G.classList.add(n.a.jSe);G.id="message";G.innerText=D.a.xf(this.message);J.appendChild(G);G=document.createElement("a");G.id="link";G.href="#";G.className=n.a.iSe;G.innerText=D.a.xf(this.linkText);J.appendChild(G);G=document.createElement("span");
G.classList.add(n.a.F$b);L=document.createElement("button");L.type="button";L.id="action";L.className=n.a.E$b;L.innerText=D.a.xf(this.actionButton);G.appendChild(L);J.appendChild(G);G=document.createElement("span");G.classList.add(n.a.F$b);L=document.createElement("button");L.type="button";L.id="altAction";L.className=n.a.E$b;L.innerText=D.a.xf(this.Esa);G.appendChild(L);J.appendChild(G);H.appendChild(J);J=document.createElement("a");J.className=n.a.gSe;J.tabIndex=0;J.setAttribute("role","button");
G=document.createElement("span");G.id="close";G.classList.add(x.a.fs);L=document.createElement("img");L.classList.add(x.a.rvb);L.src=v.a.de(13);L.alt=A.a.instance.ga(793);L.title=A.a.instance.ga(793);L.setAttribute("role","button");G.appendChild(L);J.appendChild(G);H.appendChild(J);this.domElement.appendChild(H)}else H="<div class='"+n.a.fSe+"' id='{0}'><div class='"+n.a.eSe+"'><a class='"+n.a.lSe+"' title='{1}'><span class='"+x.a.Zrb+" "+n.a.hSe+"' id='{2}'>",this.Ek.length&&(H+="<img class='{3}' src='{4}'/>"),
H+="</span></a><span class='"+n.a.kSe+"' id='{5}'>{6}</span><span class='"+n.a.jSe+"' id='message'>{7}</span><a id='link' href='#' class='"+n.a.iSe+"'>{8}</a><span class='"+n.a.F$b+"'><button type='button' id='action' class='"+n.a.E$b+"'>{9}</button></span><span class='"+n.a.F$b+"'><button type='button' id='altAction' class='"+n.a.E$b+"'>{10}</button></span></div><a class='"+n.a.gSe+"' tabindex='0' role='button'><span id='close' class='"+x.a.fs+"'><img class='"+x.a.rvb+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>",
this.domElement.innerHTML=String.format(H,S,this.alt,G,this.Ek,v.a.de(0),C,this.title,this.message,this.linkText,this.actionButton,this.Esa,v.a.de(13),A.a.instance.ga(793));B.DOMElementExtensions.Yt(this.domElement,r.a.Nsa,C,S);this.wca=$get("link",this.domElement);B.DOMElementExtensions.setVisible(this.wca,this.Iwa);this.Iwa&&(f.a.instance.sa(d.a.click,this.wca,this.xqc),this.krf=h.KeyInputManager.instance.Qs(this.wca,this.xqc,w.a.Kh,w.a.QX));this.yP=new u.a(B.DOMElementExtensions.getElementById(this.domElement,
"action"));this.yP.isVisible=this.zs;this.C8=new u.a(B.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.C8.isVisible=this.GV;this.zs&&(f.a.instance.sa(d.a.click,this.yP.domElement,this.YCd),this.Moe=h.KeyInputManager.instance.Qs(this.yP.domElement,this.YCd,w.a.Kh,w.a.QX),this.GV&&(f.a.instance.sa(d.a.click,this.C8.domElement,this.cDd),this.Bue=h.KeyInputManager.instance.Qs(this.yP.domElement,this.cDd,w.a.Kh,w.a.QX)));this.qz=$get("close",this.domElement);this.d5b=this.Be.oe(this.qz);
this.d5b.la("click",this.HOi);this.d5b.la("keydown",this.NOi);B.DOMElementExtensions.setVisible(this.qz,!this.hideCloseButton)}PJe(S){M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?this.hgh():this.rfh(S)}Ym(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.pD.Rad}`);y.h(this.businessBar.$).Xo(!0)}oW(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnAltActionClick()`);
y.h(this.businessBar.$).Xo(!0)}Mma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnLinkClick()`);y.h(this.businessBar.$).Xo(!0)}KD(S){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.pD.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.pD.Rad}`);this.set_visible(!1);this.businessBar.removeEntry(this.g_g);z.g(S)}rK(){return M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&l.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")?
this.domElement.getElementsByTagName("button")[0]:this.yP.domElement}}Object(t.a)(T,"BusinessBarEntry",E.a,[])},785:function(t,E,a){a.r(E);t=a(0);var c=a(7),b=a(15),e=a(4);a(27);var f=a(386),d=a(38),h=a(48),m=a(12),l=a(128),w=a(1),n=a(13),x=a(21);class r extends Sys.EventArgs{constructor(G){super();this.J7i=G}}Object(t.a)(r,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var u=a(260),v=a(248);class B{constructor(G){this.tg=G}di(){u.a(this.tg.$).oB(this.he)||u.a(this.tg.$).di(this)}q8(){u.a(this.tg.$).oB(this.he)&&
u.a(this.tg.$).aA(this)}get he(){return v.a.EPf}get mc(){const {PrintPreviewPane:G}=a(785);return document.getElementById(G.H7i)}get Hf(){return!0}nh(G){return m.DOMElementExtensions.Af(this.mc,G)}qj(){this.tg.$.frame.Le.vk(this.tg.$.frame.Le.pF)}dk(){}kg(G,J){return J?!1:(this.tg.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(t.a)(B,"PrintPreviewHeaderKeyboardAccessibleSection",null,[66]);class z{constructor(G){this.tg=G}di(){u.a(this.tg.$).oB(this.he)||u.a(this.tg.$).di(this)}q8(){u.a(this.tg.$).oB(this.he)&&
u.a(this.tg.$).aA(this)}get he(){return v.a.FPf}get mc(){const {PrintPreviewPane:G}=a(785);return this.tg.useMSPdfViewer?document.getElementById(a(785).PrintPreviewPane.bHd):document.getElementById(G.eNf)}get Hf(){return!0}nh(G){return m.DOMElementExtensions.Af(this.mc,G)}qj(){this.tg.$.frame.Le.vk(this.tg.$.frame.Le.pF)}dk(){}kg(G,J){return J?!1:(this.tg.useMSPdfViewer?(G=document.getElementById(a(785).PrintPreviewPane.bHd))&&m.DOMElementExtensions.setFocus(G,!0):m.DOMElementExtensions.setFocus(this.tg.mL),
!0)}}Object(t.a)(z,"PrintPreviewKeyboardAccessibleSection",null,[66]);class A{constructor(G){this.tg=G}di(){u.a(this.tg.$).oB(this.he)||u.a(this.tg.$).di(this)}q8(){u.a(this.tg.$).oB(this.he)&&u.a(this.tg.$).aA(this)}get he(){return v.a.HPf}get mc(){const {PrintPreviewPane:G}=a(785);return document.getElementById(G.iJd)}get Hf(){return!0}nh(G){return m.DOMElementExtensions.Af(this.mc,G)}qj(){this.tg.$.frame.Le.vk(this.tg.$.frame.Le.pF)}dk(){}kg(G,J){return J?!1:(this.tg.enterPrintSettingsTaskPaneFocusTrapZone(),
!0)}}Object(t.a)(A,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[66]);class y{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(t.a)(y,"MSPdfViewerFileUrl",null,[]);class D{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=
!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(t.a)(D,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(t.a)(I,"ViewerPaneProps",null,[]);var M=a(1079),T=a(381),S=a(5);class H{}H.printDialogTitle="PrintDialogTitle";H.H$b="ewa-dlg-elements-container-rtl";H.cx="PrintPreviewerContainer";Object(t.a)(H,"CssClassNames",null,[]);a.d(E,"PrintPreviewPane",function(){return C});
class C extends d.a{constructor(G,J,L,P){super();this.XDb=this.Amc=this.mL=this.WIb=this.cx=this.BW=this.YD=this.fG=null;this.WDb=!1;this.xxa=!0;this.jJd=this.fJd=this.gJd=this.ewaAccessibilityManager=this.Asc=null;this.jrd=!1;this.pFf=()=>{b.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.WDb}`);this.WDb&&(this.jci(),this.mL.style.visibility="visible",this.Amc?this.Amc.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),
this.raiseEvent(C.JFb,new r(1)),this.QSd(),this.WDb=!1)};this.$=G;this.XD=J;this.Ufh();this.useMSPdfViewer=L;this.isUniversalPrintEnabled=P;this.cI=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);this.isExportPdfMode=!1}WNg(G){this.addHandler(C.JFb,G)}vjj(G){this.removeHandler(C.JFb,G)}BIj(G){this.isExportPdfMode=G;this.Pfh()}CIj(){var G=this.$.Kb.Cc("UserAction","createSettingsPaneStopwatch");const J=document.getElementById(C.iJd);this.Wfh();const L=this.Xfh();this.YD.createPrintSettingsTaskPane(J,
L);G.stop();this.WDb=!1;if(this.isUniversalPrintEnabled&&this.cx){G="A4";switch(L.selectedPrintSettingsValues.selectedPaperSize){case 8:G="A3";break;case 9:G="A4";break;case 11:G="A5";break;case 12:G="JIS B4";break;case 13:G="JIS B5";break;case 5:G="North America Legal";break;case 1:G="North America Letter";break;case 6:G="North America Invoice";break;case 7:G="North America Executive";break;case 3:G="North America Ledger"}this.fG.setDocumentSettings({mediaSize:G,orientation:2===L.selectedPrintSettingsValues.selectedOrientation?
"landscape":"portrait",colorMode:1===L.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.ZLd()}setPageRangeSettings(G,J,L,P,aa){this.YD&&(this.YD.setPageRangeSettings(G,J,L,P,aa),this.l6f(String.format(n.a.instance.mb(205),P,aa,G)))}Zbi(){this.cx&&(this.cx.style.display="none")}Doh(){this.dispose();this.s1d();this.$Vj();this.fG&&this.fG.closePrintPreviewPane();this.BW=this.YD=this.fG=this.cx=null}Vzi(G){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");
this.hidePreviewError();this.useMSPdfViewer?((this.XDb=this.$.Kb.Cc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.BW.renderPdf(G)):this.mL&&((this.Amc=this.$.Kb.Cc("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.WDb=!0,this.mL.src&&this.mL.src===G?this.pFf(null):this.mL.src=G);if(this.cI&&this.cx){const J=
T.b(this.$.workbookContext);this.fG.setFileUrl(G,J)}}onPdfLoad(){this.XDb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.XDb.Bc} ms, isFirstTimeLoad: ${this.xxa}`),this.XDb.stop()):b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(C.JFb,new r(1));this.hideWaitCursor();this.QSd()}printPdf(){m.DOMElementExtensions.setFocus(this.mL);this.mL.contentWindow.print()}pJj(){this.showSpinner();
this.showWaitCursor();this.l6f("")}jci(){this.hideSpinner();this.hideWaitCursor()}iA(G,J,L=null){this.cx&&this.BW&&(this.jrd=!1,this.BW.showErrorDetails(J,G,L),this.XD.F7a=!0,this.mL&&(this.mL.src=""),this.disablePrintButton(),this.hideWaitCursor(),C.lri(J)&&(this.jrd=!0,this.AWi()))}hidePreviewError(){this.XD.F7a=!1;this.BW.hidePreviewError();this.enablePrintButton()}uoh(){(this.WIb=document.getElementById(C.GPf))&&this.WIb.parentNode&&this.WIb.parentNode.removeChild(this.WIb)}hideErrorMessageForPrintOptions(){this.YD&&
this.YD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(G){this.YD&&this.YD.showErrorMessageForPrintOptions(G)}showSpinner(){this.XD.F7a||this.jrd?this.hidePreviewError():this.mL&&(this.mL.style.visibility="hidden");this.BW&&this.BW.showSpinner()}hideSpinner(){this.BW&&this.BW.hideSpinner()}enablePrintButton(){this.YD&&this.YD.enablePrintButton();this.cI&&this.cx&&this.fG.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.YD&&this.YD.disablePrintButton();this.cI&&
this.cx&&this.fG.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.YD&&this.YD.showWaitCursor();this.cI&&this.cx&&this.fG.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.YD&&this.YD.hideWaitCursor();this.cI&&this.cx&&this.fG.updatePrintButtonEnableDisableState(!0)}Sfh(){if(this.cx)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.cx=document.createElement("div"),this.cx.id=C.GPf,this.cx.classList.add(C.K7i),
this.$.ur.insertBefore(this.cx,this.$.ur.firstChild),e.AFrameworkApplication.ta&&e.AFrameworkApplication.ta.Pa.Pe){const G=document.getElementById(S.a.Isa);G&&(this.cx.style.top=`${G.clientHeight}px`,this.cx.style.height=`calc(100vh - ${G.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.fG.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.fG.enterPrintSettingsTaskPaneFocusTrapZone()}x5i(){this.$.da.fb(15,G=>{this.ewaAccessibilityManager=G;this.ewaAccessibilityManager.mode=
3})}Ufh(){this.jJd=new A(this);this.gJd=new z(this);this.fJd=new B(this)}ZLd(){this.jJd.di();this.gJd.di();this.fJd.di();this.x5i()}s1d(){this.jJd.q8();this.gJd.q8();this.fJd.q8();x.h(this.$).b1();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}HO(){this.Asc=l.a.instance.oe(this.mL);this.Asc.la("load",this.pFf)}$Vj(){this.Asc&&this.mL&&this.Asc.detach("load")}QSd(){this.cI?this.p5f(C.I7i,C.jKi):this.p5f(C.iJd,C.APf)}p5f(G,J){this.xxa&&(G=document.getElementById(G))&&(J=m.DOMElementExtensions.getElementById(G,
J))&&(this.xxa=!1,J.focus())}AWi(){this.XD.F7a=!1;this.enablePrintButton();this.QSd()}Pfh(){const G=h.GetServiceTaskFactory.Na(this.$.da,283,284,0).result.kn;G.loadScript("excel-print-preview-sprite").then(()=>{G.loadScript("printPreviewer").then(()=>{G.loadScript("excelPrintPreviewer").then(()=>{this.Vfh()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{b.ULS.sendTraceTag(525358668,
0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}Vfh(){const G=this.$.Kb.Cc("UserAction","createEmptyPreviewerStopwatch");this.Sfh();this.Tfh();this.cI?this.fG.createEmptyPrintPreviewPaneAsync(this.cx,this.VJe()).then(()=>{G.stop();this.LGe();this.fG.updatePrintButtonEnableDisableState(!1)}):(this.fG.createEmptyPrintPreviewPane(this.cx,this.VJe()),G.stop(),this.LGe())}LGe(){const G=this.$.Kb.Cc("UserAction","createPdfPreviewPaneStopwatch"),
J=document.getElementById(C.bHd);this.useMSPdfViewer&&(J.tabIndex=0);this.Bfh();this.Afh(J);G.stop();this.raiseEvent(C.JFb,new r(0))}Tfh(){this.fG||(this.fG=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.fG||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}Wfh(){this.YD||(this.YD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.YD||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}Bfh(){this.BW||(this.BW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.BW||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}Afh(G){this.BW.createPrintPreviewPane(G,this.gih());this.useMSPdfViewer||(this.mL=m.DOMElementExtensions.getElementById(this.cx,
C.eNf),this.mL.title=n.a.instance.ga(1208),this.HO())}Xfh(){let G,J="en-US";G=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?J=this.$.ya.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new D,{whatToPrintOptions:this.XD.Pv.whatToPrintOptions,orientationOptions:this.XD.Pv.orientationOptions,paperSizeOptions:this.XD.Pv.paperSizeOptions,scalingOptions:this.XD.Pv.scalingOptions,
marginDetailedOptions:this.XD.tYh(),selectedPrintSettingsValues:this.XD.q0h(),printSettingsTaskPaneCallbacks:this.XD.o0h(),logger:new f.a,shouldDisableCurrentSelection:this.XD.w8f(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:G,dataCultureTag:J,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}VJe(){return this.cI?this.XD.m0h():Object(c.a)(new M.a,{backActionButtonText:n.a.instance.ga(1206),printPreviewPaneCallbacks:this.XD.p7e(),logger:new f.a,disableTellMeControl:!0,isExportPdfMode:!1})}gih(){return this.useMSPdfViewer?
Object(c.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.Oeh(),onPdfLoad:()=>{this.onPdfLoad()}}):Object(c.a)(new I,{useMSPdfViewer:!1})}Oeh(){return Object(c.a)(new y,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}l6f(G){this.cx&&this.fG.setAdditionalHeaderText(G)}static lri(G){return 3===G||2===G}}C.GPf="PrintPreviewerContainer";C.iJd="printSettingsTaskPaneId";C.bHd=
"previewId";C.eNf="printpreviewiframe";C.H7i="printPreviewHeaderId";C.APf="printButton";C.I7i="printPreviewPaneId";C.jKi="printButtonId";C.K7i=H.cx;C.JFb="pppnosu";Object(t.a)(C,"PrintPreviewPane",d.a,[435])},838:function(t,E,a){a.d(E,"a",function(){return d});t=a(0);var c=a(15),b=a(4),e=a(39),f=a(27);class d{static z1e(h,m){switch(h){case 3:return d.z6h(m);case 2:return d.l_h(m);case 1:return d.sUh(m)}return""}static z6h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static l_h(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static sUh(h){switch(h){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(h,
m,l){if(f.a.$g||f.a.Dp)window.setTimeout(()=>{d.RTf(l,d.Pec())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.pve(l),h,0,!1)}static F5g(h,m,l,w){m&&w&&w();d.openInClient(h,m,l)}static Pec(){return f.a.$g?1:f.a.Dp?2:f.a.g9a?3:f.a.isMac?4:0}static v6h(h){switch(h){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static w6h(h){switch(h){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";
case 1:return"WildFireExcelBizBarFlight";default:return""}}static get xBb(){return"zh-CN"===window.navigator.language}static RTf(h,m){1===m?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),h=d.z1e(h,m),8<f.a.N6a?e.a.kf(h,void 0,void 0,"RedirectToAppStore"):e.a.oV(h)):document.hidden||(d.xBb?(h=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.oV(h)):c.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.z1e(h,m),null,null)))}static pve(h){switch(h){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get AAc(){return(f.a.g9a||f.a.isMac)&&f.a.Ep}static get HFj(){return f.a.$g||f.a.Dp}static mgd(h){switch(h){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Asd(h){return(h=
d.qXh(h))&&""!==h?Boolean.parse(h):!1}static MTd(h){d.tyj(h)}static qXh(h){try{return localStorage.getItem(h)}catch(m){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),null}}static tyj(h){try{localStorage.setItem(h,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}}}d.ADe="ChromeExtensionBarDismiss";Object(t.a)(d,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/ea5f01646e09ea85f1ad2ef816f976b8/EwaDSEsNext.kmhv.js.map