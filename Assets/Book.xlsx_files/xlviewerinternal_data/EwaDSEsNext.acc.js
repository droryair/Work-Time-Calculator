'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1124:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1125:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1126:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-svg-icon{height:100%;width:100%}")}},1127:function(t,E,a){function c(l,w){this.ID=l;this.type=w}function b(l,w){this.value=l;this.contextId=w}function e(l,w,n,x,r,u,v,B){this.type=l;this.startTime=null==n||void 0==n.value?new b(n,null):n;this.endTime=null==x||void 0==x.value?new b(x,null):x;null!=r&&void 0!=r.value||new b(r,null);null!=u&&void 0!=u.value||new b(u,null);this.operationType=B}function f(l){this.ID=
l}function d(){this.Qe=[];this.xpb=[];this.xZc=0;this.duration=this.startTime=null;this.U9b={};this.Szd=this.xAd=this.W_c=-1}function h(l){var w;return(null!=document.body.style.msTransform?w=l.style.msTransform:null!=document.body.style.webkitTransform?w=l.style.webkitTransform:null!=document.body.style.mozTransform?w=l.style.u7j:null!=document.body.style.oTransform?w=l.style.w7j:null!=document.body.style.transform&&(w=l.style.transform),w)?(w=w.replace("rotate(",""),w=w.replace("deg)",""),parseFloat(w)):
0}a.d(E,"a",function(){return h});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);e.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),J7j:new b(0,null),a7j:new b(0,null),operationType:0};t=Array(1);t[0]=new b(0,0);new f(0,[new e(5,0,0,0,null,1,1,0)]);new f(1,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0)]);new f(2,[new e(1,3,0,167,null,0,1,1),new e(2,3,0,167,null,0,1,1)]);new f(3,[new e(3,3,0,167,null,0,1,1),new e(4,3,0,167,null,0,1,1)]);new f(4,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,167,null,1,1,0)]);new f(5,[new e(5,2,0,167,null,
0,1,0)]);new f(6,[new e(1,3,0,100,null,0,1,1),new e(2,3,0,100,null,0,1,1)]);new f(7,[new e(3,3,0,100,null,0,1,1),new e(4,3,0,100,null,0,1,1)]);new f(8,[new e(5,2,0,100,null,1,1,0)]);new f(9,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,1,1,0)]);new f(10,[new e(5,2,0,100,null,0,1,0)]);new f(11,[new e(1,3,0,267,null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(12,[new e(3,3,0,267,null,0,1,1),new e(4,3,0,267,null,0,1,1)]);new f(13,[new e(5,2,0,267,null,1,1,0)]);new f(14,[new e(5,2,0,0,null,0,2,0),new e(5,
2,0,267,null,1,1,0)]);new f(15,[new e(5,2,0,267,null,0,1,0)]);new f(16,[new e(6,3,0,267,null,0,1,1),new e(7,3,0,267,null,0,1,1)]);new f(17,[new e(1,3,0,750,null,0,1,1),new e(2,3,0,750,null,0,1,1)]);new f(18,[new e(3,3,0,750,null,0,1,1),new e(4,3,0,750,null,0,1,1)]);new f(19,[new e(5,2,0,750,null,1,1,0)]);new f(20,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,750,null,1,1,0)]);new f(21,[new e(6,3,0,1E3,null,0,1,1),new e(7,3,0,1E3,null,0,1,1)]);new f(22,[new e(1,3,0,367,null,0,1,1),new e(2,3,0,367,null,0,
1,1)]);new f(23,[new e(3,3,0,367,null,0,1,1),new e(4,3,0,367,null,0,1,1)]);new f(24,[new e(5,2,0,367,null,1,1,0)]);new f(25,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,367,null,1,1,0)]);new f(26,[new e(5,2,0,367,null,0,1,0)]);new f(27,[new e(6,2,0,t[0],null,0,1,1),new e(7,2,0,t[0],null,0,1,1)]);new f(28,[new e(5,2,0,0,null,1,1,0),new e(5,2,0,50,null,0,1,0)]);new f(29,[new e(1,3,0,433,null,0,1,1),new e(2,3,0,433,null,0,1,1)]);new f(30,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,50,null,1,1,0),new e(2,3,0,0,
null,40,1,1),new e(2,3,0,100,null,0,1,1)]);new f(31,[new e(2,0,0,0,null,32,1,1),new e(2,0,0,100,null,32,1,1),new e(2,3,101,350,null,0,1,1),new e(3,0,0,0,null,0,2,1),new e(3,0,0,100,null,0,2,1),new e(3,3,101,350,null,0,1,1),new e(5,0,0,0,null,0,2,0),new e(5,0,0,100,null,1,1,0)]);new f(32,[new e(2,3,0,267,null,32,1,1),new e(3,3,0,267,null,0,2,1),new e(5,2,0,0,null,1,0,0),new e(5,2,0,267,null,0,2,0)]);new f(33,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,100,null,0,2,0),new e(5,2,101,267,null,1,1,0)]);new f(34,
[new e(1,10,0,300,null,0,1,1),new e(2,10,0,300,null,0,1,1)]);new f(35,[new e(3,10,0,300,null,0,1,1),new e(4,10,0,300,null,0,1,1)]);new f(36,[new e(1,8,0,750,null,0,1,1),new e(2,8,0,750,null,0,1,1)]);new f(37,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,200,null,0,2,0),new e(5,3,201,500,null,1,1,0)]);new f(38,[new e(1,2,0,0,null,0,2,1),new e(2,2,0,0,null,0,2,1),new e(1,2,0,200,null,0,2,1),new e(2,2,0,200,null,0,2,1),new e(1,3,201,267,null,0,1,1),new e(2,3,201,267,null,0,1,1)]);new f(39,[new e(1,3,0,267,
null,0,1,1),new e(2,3,0,267,null,0,1,1)]);new f(40,[new e(5,2,0,0,null,0,2,0),new e(5,2,0,267,null,1,1,0)]);new f(41,[new e(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(l,16)}}();d.prototype={Qe:null,zRg:5,xpb:null,xZc:0,startTime:null,
duration:null,U9b:null,W_c:-1,xAd:-1,Szd:-1};d.prototype.Start=function(){this.startTime=new Date;this.U9b={}};d.prototype.GetRecentAnimationStats=function(){var l,w=[],n=0;for(l=m.xZc;l<m.zRg;l++)null!=m.xpb[l]&&(w[n]=m.xpb[l],n++);for(l=0;l<m.xZc;l++)null!=m.xpb[l]&&(w[n]=m.xpb[l],n++);return w};d.prototype.GetAnimationSqmStats=function(){var l=[];return l[0]=0>m.W_c?0:m.W_c,l[1]=0>m.xAd?0:m.xAd,l[2]=0>m.Szd?0:m.Szd,l};var m=new d},1128:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);
const b=()=>{c.a.Ni(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1142:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(38);class f extends e.a{constructor(la){super();la.da.Ga(376,this)}lPg(la){this.addHandler("TAF",la)}ykj(la){this.removeHandler("TAF",la)}G$i(){this.raiseEvent("TAF")}}Object(t.a)(f,"GridHighlightBehaviorEventManager",e.a,[886,3]);class d extends b.a{constructor(la){super();this.$=la;this.Fb()}create(){this.ob(this.$.da.Aa(376)||new f(this.$))}static la(la){la.da.Ga(377,new d(la))}}Object(t.a)(d,"GridHighlightBehaviorEventManagerFactory",b.a,
[]);var h=a(48),m=a(37),l=a(27),w=a(78),n=a(15),x=a(240),r=a(14),u=a(155),v=a(5),B=a(113),z=a(12);class A extends Sys.EventArgs{constructor(la,hb){super();this.start=la;this.$6a=hb}}Object(t.a)(A,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var y=a(33);class D extends e.a{constructor(la){super();this.Bnc=[3];this.Iqa=void 0;this.gridView=la;this.UDc=y.a.oR(this.gridView.$);this.vB=y.a.vB(this.gridView.$)}get coloredReferencesManager(){const la=this.gridView.$.da.Aa(281);la||n.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return la}get jB(){if(this.Iqa)return this.Iqa;const la=this.gridView.$.da.Aa(464);la||n.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
la.jB||n.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.Iqa=la.jB}ONg(la){this.addHandler("mrek",la)}ix(la,hb,Kb){for(const dc of this.gridView.Ln)x.a.instance.sa(r.a.Mj,dc.domElement,la);x.a.instance.sa(r.a.Rf,document.documentElement,hb);this.gridView.jc.a$b(!0);Kb&&x.a.instance.sa(r.a.NB,this.gridView.zj,hb)}r1d(la,hb,Kb){for(const dc of this.gridView.Ln)x.a.instance.Ba(r.a.Mj,dc.domElement,la);x.a.instance.Ba(r.a.Rf,
document.documentElement,hb);this.gridView.jc.a$b(!1);Kb&&x.a.instance.Ba(r.a.NB,this.gridView.zj,hb)}Eej(la,hb){for(const Kb of this.gridView.Ln)u.a.instance.sa(r.a.$f,Kb.domElement,la);u.a.instance.sa(r.a.we,document.documentElement,hb)}UWj(la,hb){for(const Kb of this.gridView.Ln)u.a.instance.Ba(r.a.$f,Kb.domElement,la);u.a.instance.Ba(r.a.we,document.documentElement,hb)}PIe(la,hb,Kb,dc){const sb=document.createElement("div");sb.className=hb;for(const bb of Kb)sb.classList.add(bb);la.appendChild(sb);
x.a.instance.sa(r.a.pointerDown,sb,dc);return sb}m8e(la){la=la.Gb.parentNode;if(!la)return n.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;la=parseInt(la.getAttribute(v.a.$6a),10);return isNaN(la)?(n.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.Gv(3,1,la)}nNb(la,hb,Kb=!0){la=Kb&&(this.vB?!!this.jB&&
this.jB.hqi(la):!!this.coloredReferencesManager&&this.coloredReferencesManager.gqi(la));for(const dc of hb)z.DOMElementExtensions.setVisible(dc,la)}lcc(){return this.gridView.Vl?B.a(this.gridView.$):this.gridView.Vb}lTf(){if(this.vB){var la=this.lcc();la&&this.jB?this.UDc?la.aC(null):this.jB.Igb(la,null):(n.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Zg(this.Bnc),this.gridView.qb.Ri(null,
this.Bnc))}else this.kcj()}kcj(){const la=this.lcc();la&&this.coloredReferencesManager?this.UDc?la.aC(null):this.coloredReferencesManager.aC(la,null):(n.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.Zg(this.Bnc),this.gridView.qb.Ri(null,this.Bnc))}uRf(la,hb){this.raiseEvent("mrek",new A(la,hb))}}Object(t.a)(D,"BehaviorHelperMethods",e.a,[]);var I=a(89),M=a(39);e=a(95);
class T extends e.a{constructor(la,hb=null){super(la,hb)}n_a(){}}Object(t.a)(T,"HighlightFlyweightBehavior",e.a,[]);var S=a(19),H=a(464),C=a(76),G=a(11),J=a(117),L=a(224),P=a(45);e=a(238);var aa=a(8),U=a(69),K=a(1),Y=a(34);class na extends e.a{constructor(la,hb,Kb){super(document.createElement("div"));this.E7b=null;this.URb=!1;this.onPointerDown=dc=>{dc=Y.a(this.$)?Y.a(this.$).Vd(dc):dc;this.URb=!1;if(3===(C.a.Db=dc.tb)){const sb=dc.Ca.rawEvent,bb=sb.srcElement||sb.target;z.DOMElementExtensions.Af(this.domElement,
bb)&&z.DOMElementExtensions.Af(sb.currentTarget,bb)&&(this.URb=!0,this.E7b=dc.clientPoint)}return!1};this.Qf=dc=>{dc=Y.a(this.$)?Y.a(this.$).Vd(dc):dc;this.raiseEvent("GrPointerUp",dc);return this.URb=!1};this.Hh=dc=>{dc=Y.a(this.$)?Y.a(this.$).Vd(dc):dc;3===dc.tb&&this.URb&&this.Kai(dc.clientPoint)&&(this.raiseEvent("GrDrag"),this.URb=!1);return!1};this.fd=dc=>{Y.a(this.$)&&Y.a(this.$).Vd(dc);return!0};this.$=Kb;Kb=!K.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(Kb?
U.a.xWe:U.a.wWe);this.domElement.classList.add(U.a.fac);la.appendChild(this.domElement);z.DOMElementExtensions.setVisible(this.domElement,!1);this.cMa=document.createElement("div");this.cMa.classList.add(U.a.eac);this.cMa.style.borderColor=hb;this.domElement.appendChild(this.cMa);x.a.instance.sa(r.a.pointerDown,this.domElement,this.onPointerDown);x.a.instance.sa(r.a.Rf,this.domElement,this.Qf);u.a.instance.sa(r.a.we,this.domElement,this.Qf);x.a.instance.sa(r.a.Mj,this.domElement,this.Hh);u.a.instance.sa(r.a.$f,
this.domElement,this.Hh);L.a.instance.sa(r.a.click,this.domElement,this.fd)}nse(la){this.addHandler("GrDrag",la)}XWf(la){this.removeHandler("GrDrag",la)}mse(la){this.addHandler("GrContxt",la)}WWf(la){this.removeHandler("GrContxt",la)}ose(la){this.addHandler("GrPointerUp",la)}YWf(la){this.removeHandler("GrPointerUp",la)}dispose(){P.a.tna(this.domElement);super.dispose()}tkg(la){this.domElement.parentNode.removeChild(this.domElement);la.appendChild(this.domElement)}g4f(){this.domElement.classList.remove(U.a.fac);
this.cMa.classList.remove(U.a.eac);this.cMa.classList.add(U.a.yWe)}Iig(){this.cMa.classList.remove(U.a.yWe);this.cMa.classList.add(U.a.eac);this.domElement.classList.add(U.a.fac)}Kai(la){return!!this.E7b&&(3<Math.abs(la.x-this.E7b.x)||3<Math.abs(la.y-this.E7b.y))}static $wb(la){return K.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(la=Y.a(la.$)?Y.a(la.$).zoom:aa.a.o0,Math.round(9/Math.max(la,1))):9}}na.Bzd=0;Object(t.a)(na,"TouchGrippie",e.a,[]);class W extends T{constructor(la,
hb,Kb,dc){super(hb);this.Oud=this.YZc=this.Mpb=!1;this.krb=null;this.Xba=this.Jud=!1;this.Yw=()=>{this.Mpb&&this.Jud?this.xoa():this.g5()};this.QEf=bb=>{3===bb.tb&&(this.Jud=!0,this.xoa());return!1};this.REf=bb=>{if(3===bb.tb){if(!bb.Gb||this.Sni(bb))return!1;this.Jud=!1;this.g5()}return!1};this.Cg=()=>{this.Xba&&this.v1d();this.xoa();this.Oud=!1};this.Pp=()=>{this.g5();this.Oud=!0};this.xza=(bb,Ob)=>{Ob.j5===this.j5&&(Ob.visible?this.Oud||this.xoa():this.g5())};this.CKf=()=>{this.SEf(this.pP.domElement,
!1)};this.eBf=()=>{this.SEf(this.QM.domElement,!0)};this.kqc=(bb,Ob)=>{this.ha.kAa(Ob)};this.lqc=(bb,Ob)=>{this.ha.kAa(H.b(Ob))};this.KGb=()=>{3===C.a.Db?this.xoa():this.g5();this.Xba&&1===C.a.Db&&this.v1d()};this.DKf=()=>{this.Xvj()};this.yPe=()=>{this.g5()};this.Kn=()=>{this.ha.Ta.$b&&this.g5()};this.TAf=()=>{this.g5()};this.JEf=(bb,Ob)=>{this.v1d();3===Ob.tb?this.xoa():this.g5()};this.luc=()=>{this.Mpb&&(this.g5(),this.xoa())};const sb=Kb.$;this.Bq=Kb;this.ha=Kb.ha;this.Bba=la;this.ytj=hb;this.paneType=
dc;la=this.domElement.currentStyle;hb="#000000";la&&(hb=la.borderTopColor);this.pP=new na(this.Odd(),hb,sb);this.QM=new na(this.Odd(),hb,sb);this.Clf=sb.ea.isNamedObjectViewMode&&1===sb.workbookContext.NovMode;this.pP.nse(this.CKf);this.pP.mse(this.kqc);this.pP.ose(this.lqc);this.QM.nse(this.eBf);this.QM.mse(this.kqc);this.QM.ose(this.lqc);for(const bb of this.gridView.Ln)u.a.instance.sa(r.a.uf,bb.domElement,this.REf),u.a.instance.sa(r.a.we,bb.domElement,this.QEf);Kb.view.qt(this.Yw);Kb.Vb.Zk(this.yPe);
Kb.qb.cpb(this.xza);Kb.WXc(this.TAf);sb.DC(this.luc);Kb.pv(this.luc);this.ha.WY(this.Cg);this.ha.e3(this.Pp);Kb.FC(this.Kn);this.ha.E0b(this.JEf);C.a.yse(this.KGb);m.TaskExtensions.za(h.GetServiceTaskFactory.Na(sb.da,376,377,0),bb=>{bb.result.lPg(this.DKf)},sb.ka,3)}get gridView(){return this.Bq}dispose(){I.a.rc([this.pP,this.QM]);this.pP.XWf(this.CKf);this.pP.WWf(this.kqc);this.pP.YWf(this.lqc);this.QM.XWf(this.eBf);this.QM.WWf(this.kqc);this.QM.YWf(this.lqc);for(var la of this.gridView.Ln)u.a.instance.Ba(r.a.uf,
la.domElement,this.REf),u.a.instance.Ba(r.a.we,la.domElement,this.QEf);this.gridView.view.fr(this.Yw);this.gridView.Vb.Uk(this.yPe);this.gridView.qb.JKb(this.xza);this.gridView.$Md(this.TAf);this.gridView.$.jG(this.luc);this.gridView.Ny(this.luc);this.ha.cX(this.Cg);this.ha.u7(this.Pp);this.gridView.aE(this.Kn);this.ha.yvc(this.JEf);C.a.fXf(this.KGb);this.Xba&&n.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(la=this.gridView.$.da.Aa(376))&&la.ykj(this.DKf);
super.dispose()}BTa(){if(!this.Bba.range||!this.Bba.range.equals(this.Ydb))return!1;const la=!this.gridView.ONa();return this.gridView.gb&&la&&(this.Ydb.isRow||this.Ydb.gf)?!1:this.Xba?!0:3===C.a.Db}g5(){this.Mpb&&(this.pP.set_visible(!1),this.QM.set_visible(!1),this.Mpb=!1)}xoa(){if(this.BTa()){this.B_j();var la=z.DOMElementExtensions.getBoundingClientRect(this.krb);la||n.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.Clf,this.YZc,this.gridView.zj,this.gridView.ib.rj);var hb=z.DOMElementExtensions.getBoundingClientRect(this.ytj),Kb=new Sys.UI.Bounds(hb.x-la.x,hb.y-la.y,hb.width,hb.height),dc=this.Ydb,sb=dc.topLeft,bb=dc.bottomRight,Ob=dc.isRow||dc.gf;if(dc.gf){var gc=this.qHh();dc=Kb.x-2*na.$wb(this.gridView);var mb=gc;var Nb=Kb.x+hb.width}else dc.isRow?(dc=Nb=this.pHh(),mb=Kb.y-2*na.$wb(this.gridView),gc=Kb.y+hb.height):(mb=Kb.y,gc=Kb.y+hb.height,this.gridView.rtl?
(dc=Kb.x+hb.width,Nb=Kb.x):(dc=Kb.x,Nb=Kb.x+hb.width));hb=na.Bzd+(Ob?0:na.$wb(this.gridView));this.pP.style.left=G.HelperMethods.uc(dc-hb);this.pP.style.top=G.HelperMethods.uc(mb-hb);this.QM.style.left=G.HelperMethods.uc(Nb-hb);this.QM.style.top=G.HelperMethods.uc(gc-hb);this.pP.set_visible(this.bkf(mb,dc,sb,Ob,la));this.QM.set_visible(this.bkf(gc,Nb,bb,Ob,la));this.Mpb=!0}}bkf(la,hb,Kb,dc,sb){const bb=z.DOMElementExtensions.getBoundingClientRect(this.gridView.Df(this.paneType).domElement);sb=new Sys.UI.Bounds(bb.x-
sb.x-3,bb.y-sb.y-3,bb.width+6,bb.height+6);return(this.gridView.ib.Mi(Kb)===this.paneType||dc)&&M.a.PN(sb,new Sys.UI.Point(hb,la))}B_j(){if(this.Clf!==this.YZc){this.krb=null;const la=this.Odd();this.pP.tkg(la);this.QM.tkg(la)}}qHh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+na.Bzd-na.$wb(this.gridView))/2}pHh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+na.Bzd-na.$wb(this.gridView))/2}QIf(){this.xoa()}Sni(la){return z.DOMElementExtensions.rSa(la.Gb,
S.a.Do)&&(this.Uoi(la)||this.Voi(la))}Voi(la){if(this.gridView.rtl)la=la.clientPoint.x;else{const hb=z.DOMElementExtensions.getBoundingClientRect(la.Gb);la=la.clientPoint.x-(hb.x+hb.width-J.a.Tu)}return 0<la&&la<=J.a.Tu}Uoi(la){const hb=z.DOMElementExtensions.getBoundingClientRect(la.Gb);la=la.clientPoint.y-(hb.y+hb.height-J.a.Tu);return 0<la&&la<=J.a.Tu}SEf(la,hb){this.Xba&&n.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.o2c(la,hb,this.Xba);
this.g5()}Xvj(){this.Xba||(n.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Xba=!0,this.pP.g4f(),this.QM.g4f(),this.gridView.ha.sourceRange=this.gridView.ha.ra.ed,this.xoa())}v1d(){this.Xba&&(n.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Xba=!1,this.pP.Iig(),this.QM.Iig())}Odd(){this.krb||(this.YZc=!1,this.krb=this.gridView.zj);return this.krb}}Object(t.a)(W,"SelectionTouchGrippiesBehaviorBase",T,[]);class X extends W{constructor(la,
hb,Kb,dc){super(la,hb,Kb,dc)}get j5(){return 19}get Ydb(){return this.gridView.ha.ra.activeRange}BTa(){const la=this.gridView.ji||this.gridView.gb;return!this.gridView.ha.ra.Pg&&!la&&super.BTa()}}Object(t.a)(X,"DiscontinuousSelectionTouchGrippiesBehavior",W,[]);var Aa=a(174);class Q extends T{constructor(la){super(la);const hb=document.createElement("div");hb.className=U.a.LCh;la.appendChild(hb)}}Object(t.a)(Q,"SelectionBorderBehavior",T,[]);class fa{}fa.qCh="ewr-selection-draghandle";fa.vCh="ewr-selection-draghandle-grab";
fa.GCh="ewr-selection-draghandle-top-ie";fa.HCh="ewr-selection-draghandle-top-ie-enhanced";fa.ECh="ewr-selection-draghandle-top";fa.FCh="ewr-selection-draghandle-top-enhanced";fa.tCh="ewr-selection-draghandle-bottom-ie";fa.uCh="ewr-selection-draghandle-bottom-ie-enhanced";fa.rCh="ewr-selection-draghandle-bottom";fa.sCh="ewr-selection-draghandle-bottom-enhanced";fa.yCh="ewr-selection-draghandle-left-ie";fa.zCh="ewr-selection-draghandle-left-ie-enhanced";fa.wCh="ewr-selection-draghandle-left";fa.xCh=
"ewr-selection-draghandle-left-enhanced";fa.CCh="ewr-selection-draghandle-right-ie";fa.DCh="ewr-selection-draghandle-right-ie-enhanced";fa.ACh="ewr-selection-draghandle-right";fa.BCh="ewr-selection-draghandle-right-enhanced";fa.FWe="ewr-selection-dragtooltip";fa.GWe="ewr-selection-dragtooltip-updated";fa.SCh="ewr_selection_rearrangeleft";fa.TCh="ewr_selection_rearrangeright";fa.UCh="ewr_selection_rearrangetop";fa.RCh="ewr_selection_rearrangebottom";fa.selecting="selecting";fa.VCh="ewr-selection-resizemarqueehandle";
fa.YCh="ewr-selection-resizemarqueehandle-topleft";fa.ZCh="ewr-selection-resizemarqueehandle-topright";fa.WCh="ewr-selection-resizemarqueehandle-bottomleft";fa.XCh="ewr-selection-resizemarqueehandle-bottomright";fa.gCh="ewr-marquee-thick";fa.kCh="ewr-resizemarqueehandle-thick";Object(t.a)(fa,"CssClassNames",null,[]);var Ca=a(250),ia=a(21);class Ra extends Q{constructor(la,hb,Kb,dc){super(la);this.nUa=!1;this.gpe=this.hpe=null;this.isa=0;this.Zh=K.EwaSettings.getBooleanFeatureGate(Aa.a.A9b,!1);this.pni=
K.EwaSettings.getBooleanFeatureGate(Aa.a.Pph,!1);this.SFc=this.vgc=this.gF=0;this.$w=this.hb=this.sourceRange=this.jna=null;this.Qf=sb=>{sb=Y.a(this.$).Vd(sb);return this.fFd(sb)};this.onPointerDown=sb=>{sb=Y.a(this.$).Vd(sb);if(2===sb.tb&&sb.lo===Sys.UI.MouseButton.leftButton&&!this.nUa){var bb=this.qec(sb);if(!bb)return n.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.hb=bb.clone();this.sourceRange=this.hb.clone();this.jna=this.hb;
if(bb=this.SYh(sb))this.oh=5,this.SFc=bb.top-this.sourceRange.top,this.vgc=bb.left-this.sourceRange.left,ia.h(this.$).yf.hm(this.Zh?Ra.MJa:Ra.l$c),this.Vqc(sb),this.nUa=!0,Ca.b(this.$,!0)}return!1};this.Hh=sb=>{sb=Y.a(this.$).Vd(sb);if(this.Zh&&this.Yqc(sb))return!0;if(sb=this.ha.mo(sb.clientPoint,sb.Gb,5,void 0,void 0,!0)){sb=this.aia(sb);if(this.hb.equals(sb))return!0;this.hb=sb;if(!this.Zy())return n.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.Hvb(!0),!1}return!0};this.$c=(sb,bb)=>{bb.SN||(K.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.lBa(this.$.isEditMode&&this.uoa()):this.lBa(this.$.isEditMode))};this.ms=[];this.$=hb;this.ha=ia.h(this.$).ha;this.paneType=Kb;this.yo=dc;hb=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");hb=this.pni?hb?[fa.FCh,fa.sCh,fa.xCh,fa.BCh]:[fa.HCh,fa.uCh,fa.zCh,fa.DCh]:hb?[fa.ECh,fa.rCh,fa.wCh,fa.ACh]:[fa.GCh,fa.tCh,fa.yCh,fa.CCh];for(const sb of hb)hb=
this.yo.PIe(la,sb,this.Zh?[fa.vCh]:[fa.qCh],this.onPointerDown),this.ms.push(hb);this.$.$k(this.$c);K.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.lBa(this.$.isEditMode)}get qb(){return ia.h(this.$).qb}get oh(){return this.ha.selectionType}set oh(la){this.ha.selectionType=la}dispose(){this.ms.forEach(la=>{x.a.instance.Ba(r.a.pointerDown,la,this.onPointerDown)});this.ms.length=0;this.jna=this.sourceRange=this.hb=null;n.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.isa}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.ul(this.$c),1===this.isa&&(n.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.At(this.gpe,this.hpe,!1)));super.dispose()}fFd(la){if(5!==this.oh)return!1;(la=this.vza(la))||this.Hvb(!1);Ca.b(this.$,!1);return la}ix(la,hb){n.ULS.shipAssertTag(537159377,0,!this.isa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.isa+=1;this.gpe=la;this.hpe=hb;this.yo.ix(la,
hb,this.FDc())}aia(la){if(!la||!this.hb)return n.ULS.shipAssertTag(537159376,0,!!la,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),n.ULS.shipAssertTag(537159375,0,!!this.hb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const hb=this.hb.clone();1!==this.gF&&(hb.left=Math.max(la.left-this.vgc,1),hb.right=hb.left+this.sourceRange.width-1);2!==this.gF&&(hb.top=Math.max(la.top-this.SFc,1),hb.bottom=hb.top+this.sourceRange.height-1);return this.o_a(hb)}At(la,
hb,Kb=!0,dc=!0){n.ULS.shipAssertTag(537159374,0,1===this.isa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.isa;this.Zh||ia.h(this.$).yf.hm(v.a.ZQ);this.yo.r1d(la,hb,this.FDc());Kb&&this.q3c(dc);this.gF=0;this.nUa=!1}o_a(la){var hb=ia.h(this.$);let Kb=la;if(hb.ib.c5){if(!hb.Ub(la.topLeft)){hb=hb.jk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",hb.KH,this.jna.top!==la.top?1:2);try{hb.Sk=this.jna.top<la.top||this.jna.left<la.left,hb.Ks(la.topLeft),
Kb=hb.$$cu().range}finally{hb&&hb.dispose()}}Kb.right=Kb.left+la.width-1;Kb.bottom=Kb.top+la.height-1}return this.jna=Kb}lBa(la){this.ms.forEach(hb=>{z.DOMElementExtensions.setVisible(hb,la)})}SYh(la){const hb=la.Gb;la=la.clientPoint;if(!hb||!la)return n.ULS.shipAssertTag(537159373,0,!!hb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159372,0,!!la,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;la.y+=hb===this.ms[Ra.LJa]?
2:hb===this.ms[Ra.o$c]?-2:0;la.x+=hb===this.ms[Ra.p$c]?2:hb===this.ms[Ra.KJa]?-2:0;return this.ha.mo(la,hb,5,void 0,void 0,!0)}}Ra.l$c="move";Ra.Z1a="copy";Ra.MJa="grabbing";Ra.LJa=0;Ra.o$c=1;Ra.p$c=2;Ra.KJa=3;Object(t.a)(Ra,"DragSelectionClickBehaviorBase",Q,[]);class Ya extends Ra{constructor(la,hb,Kb,dc,sb,bb){super(la,hb,Kb,sb);this.eb=this.pG=null;this.Oaf=()=>{this.Hvb(!0)};K.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.lBa(this.uoa()&&this.$.isEditMode);
this.gridView=ia.h(this.$);this.VF=dc;this.coloredReferencesManager=this.$.da.Aa(281);n.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.vB=y.a.vB(this.$))la=this.$.da.Aa(464),n.ULS.shipAssertTag(512312961,0,!!la,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.jB=la.jB;
for(const Ob of this.ms)x.a.instance.sa(r.a.IW,Ob,this.VF.eef),x.a.instance.sa(r.a.NB,Ob,this.VF.fef);this.n_a(bb)}n_a(la){this.yo.nNb(la,this.ms);this.VF.OAa()}Vqc(la){n.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.RMa=!0;this.eb.XE(!1);this.oh=5;this.VF.aPe(la.Gb);this.eb.textBox.removeSelection();this.eb.P0b(this.Oaf);this.ix(this.Hh,this.Qf);this.gF=this.sourceRange.isRow?1:this.sourceRange.gf?2:0}vza(){const la=
this.sG();this.oh=-1;this.At(this.Hh,this.Qf);return la}q3c(){this.gridView.RMa=!1;this.VF.bPe(this.ms[0]);this.eb.textBox.setCaretPositionToEnd();this.eb.Jvc(this.Oaf);this.yo.lTf()}Hvb(la){n.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");la&&this.At(this.Hh,this.Qf)}qec(la){this.eb=this.yo.lcc();this.pG=this.yo.m8e(la);return this.eb&&this.pG&&this.pG.range?this.pG.range:(n.ULS.shipAssertTag(537159388,
0,!!this.eb,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),n.ULS.shipAssertTag(537159387,0,!!this.pG,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),n.ULS.shipAssertTag(537159386,0,!!this.pG.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}sG(){return this.pG?this.vB?this.jB.eFb(this.eb,this.pG,this.hb):this.coloredReferencesManager.eFb(this.eb,this.pG,this.hb):(n.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}Zy(){return this.sG()}FDc(){return!0}Yqc(){return!1}uoa(){return!0}}Object(t.a)(Ya,"DragMarqueeClickBehavior",Ra,[]);var Ga=a(85),da=a(108),Z=a(171),ha=a(419),Wa=a(13),ca=a(225),ja=a(24),ua=a(764),Za=a(40),Pa=a(188),ka=a(709),ra=a(116),ba=a(29),Ua=a(282),Ka=a(60);const Oa=(la,hb,Kb,dc,sb,bb,Ob,gc=null)=>{gc=la.Oa(41,gc);gc.sourceRange=hb;gc.destinationRange=Kb;return Ka.g(la,"RearrangeRowColumn",gc,dc,sb,bb,Ob,0)},ib=(la,hb,Kb,dc,sb,bb,Ob=null)=>{Ob=la.Oa(1,Ob);Ob.moveRange=hb;return Ka.g(la,
"MoveLineItems",Ob,Kb,dc,sb,bb,0)};class La{constructor(la,hb){this.destinationRange=this.sourceRange=null;this.sourceRange=la;this.destinationRange=hb}}Object(t.a)(La,"MacroRecorderTableRowColumnRearrangedPayload",null,[145]);var db=a(44);class Ab extends Ra{constructor(la,hb,Kb,dc,sb){super(la,hb,Kb,sb);this.$ia=Wa.a.instance.ga(2263);this.Fub=Wa.a.instance.ga(2264);this.roa=Wa.a.instance.ga(2265);this.JNb=Wa.a.instance.ga(2266);this.jA=this.Qh=null;this.Wq=this.gf=this.isRow=this.Xq=!1;this.TI=
this.zH=null;this.co=this.WCb=0;this.onKeyDown=bb=>{if(this.Zh){if(this.u5(bb)||bb.Ca.keyCode===Ga.a.x8)return this.E5||(da.KeyInputManager.instance.sa(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.E5=!0),!this.Ju&&this.u5(bb)&&(ia.h(this.$).yf.hm(Ab.Z1a),this.Ju=!0),this.Ku||bb.Ca.keyCode!==Ga.a.x8||(ia.h(this.$).yf.hm(Ra.MJa),this.Ku=!0,2===this.co?(this.Sx(!1),this.gF=0,this.Qh=this.Wq?[11]:[12],this.Xq=this.Wq,this.uRa(),this.hJ()):3===this.co?(this.C3(!1),this.gF=this.isRow?1:
2,this.GO(),this.Zy()):1===this.co&&(this.kia(!1),this.GO(),this.Zy())),!0}else if(!this.Ju&&(bb.Ca.keyCode===Ga.a.L1||l.a.isMac&&bb.Ca.keyCode===Ga.a.mfa))return da.KeyInputManager.instance.sa(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),ia.h(this.$).yf.hm(Ab.Z1a),this.Ju=!0;return!1};this.onKeyUp=bb=>{if(this.Zh){if(this.u5(bb)||bb.Ca.keyCode===Ga.a.x8)return this.WCb=this.u5(bb)?0:1,this.Fp&&ia.h(this.$).yf.hm(Ra.MJa),bb.Ca.keyCode===Ga.a.x8&&(2===this.co?(this.C3(!1),this.gF=0,this.GO(!0),
this.Zy(!0)):3===this.co?(this.Sx(!1),this.gF=this.isRow?1:2,this.Qh=this.isRow?[11]:[12],this.uRa(!0),this.hJ(!0)):1===this.co&&(this.Sx(!1),this.Qh=this.Wq?[11]:[12],this.AAa(!0),this.hJ(!0))),this.kpa(this.WCb),!0}else if(bb.Ca.keyCode===Ga.a.L1||l.a.isMac&&bb.Ca.keyCode===Ga.a.mfa)return this.kpa(),this.Fp&&ia.h(this.$).yf.hm(Ra.l$c),!0;return!1};this.jL=bb=>{bb=Y.a(this.$).Vd(bb);5===this.oh?this.fFd(bb):(this.Fp=!1,this.qb.Zg(this.Qh),!this.$.aq([this.hb],!1)||this.cLd()||this.FBb()||(this.ha.sourceRange=
this.sourceRange.clone(),this.Zh?this.zJd():this.Avb(),this.zy()?this.hb.top>this.sourceRange.top&&(bb=this.hb.height,this.hb.top-=bb,this.hb.bottom-=bb):this.hb.left>this.sourceRange.left&&(bb=this.hb.width,this.hb.left-=bb,this.hb.right-=bb),this.sG()));this.At(this.iL,this.jL);this.tableRange=null;this.oh=-1;this.Zh&&(this.jA=null,this.co=0);return!0};this.S6=()=>{this.Fp=!1;this.co=0;this.qb.Zg(this.Qh);if(!this.$.aq([this.hb],!1))return this.At(this.R6,this.S6),this.oh=-1,!0;if(!(this.ha.ra.ed.equals(this.hb)||
this.Pba(this.hb)||this.Pba(this.sourceRange)||this.FBb()||(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.xaa]:this.Ju,[v.a.B9b]:!0,[v.a.D9b]:this.Xq,[v.a.XU]:this.ha.sourceRange,[v.a.WU]:this.ha.ra.ed,[v.a.JJa]:this.Ku}),this.Ju))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Xq)){var bb=this.hb.height;this.hb.top-=bb;this.hb.bottom-=bb}else this.hb.left>this.sourceRange.left&&(this.gf||this.hb.top===this.sourceRange.top&&
!this.Xq)&&(bb=this.hb.width,this.hb.left-=bb,this.hb.right-=bb);this.sG()}this.At(this.R6,this.S6);this.jA=this.tableRange=null;this.oh=-1;this.Xq=!1;return!0};this.iL=bb=>{var Ob=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ob&&(bb=Y.a(this.$).Vd(bb));var gc=bb.clientPoint;Ob||(bb=Y.a(this.$).Vd(bb));this.Zh&&(this.$w=bb);if(bb=this.ha.mo(gc,bb.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(bb.topLeft)){Ob=ia.h(this.$);const Nb=Ob.fg(bb);var mb=Ob.Df(this.paneType);
gc=ka.a.Xs(mb.view.fi,this.domElement.parentNode,gc,Ob.rtl);mb=!1;let ic=2;this.zy()&&gc.y-Nb.topLeft.y>Nb.height/2?(mb=!0,ic=1):!this.zy()&&gc.x-Nb.topLeft.x>Nb.width/2&&(mb=!0);if(mb){Ob=Ob.jk("DragSelectionClickBehavior.OnPointerMoveRearrange",Ob.KH,ic);try{Ob.Ks(bb),Ob.$$mn(),bb=Ob.$$cu().range}finally{Ob&&Ob.dispose()}}this.hb=this.t3(bb);this.ha.sourceRange=this.hb;this.qb.Ri(this.hb,this.Qh);this.qb.Tn(this.Qh);this.qb.Zg(this.lB());if(6!==this.oh){for(bb=1;4>=bb;bb++)Ob=this.Tg[bb.toString()],
Ob.parentNode.removeChild(Ob),this.qb.Gv(this.zy()?11:12,bb).zf.appendChild(Ob);this.oh=6}}else if(this.hb=this.aia(bb),this.Zh)this.Byb(!1);else if(this.qb.Ri(this.hb,this.lB()),this.qb.Tn(this.lB()),this.qb.Zg(this.Qh),5!==this.oh){for(bb=1;4>=bb;bb++)Ob=this.Tg[bb.toString()],Ob.parentNode.removeChild(Ob),this.qb.Gv(this.hba(),bb).zf.appendChild(Ob);this.oh=5}this.Uy()}return!0};this.R6=bb=>{var Ob=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ob&&(bb=Y.a(this.$).Vd(bb));
var gc=bb.clientPoint;Ob||(bb=Y.a(this.$).Vd(bb));this.$w=bb;if(Ob=this.ha.mo(gc,bb.Gb,5,void 0,void 0,!0)){if(this.Ryb(Ob))return this.hb=this.aia(Ob),this.Ayb(!1),!0;var mb=ia.h(this.$),Nb=mb.fg(Ob),ic=mb.Df(this.paneType);gc=ka.a.Xs(ic.view.fi,this.domElement.parentNode,gc,mb.rtl);ic=!1;let gb=2;this.Xq=!1;if(this.isRow||this.gf){this.isRow&&gc.y-Nb.topLeft.y>Nb.height/2?(ic=!0,gb=1):this.gf&&gc.x-Nb.topLeft.x>Nb.width/2&&(ic=!0);if(ic){bb=mb.jk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
mb.KH,gb);try{bb.Ks(Ob),bb.$$mn(),Ob=bb.$$cu().range}finally{bb&&bb.dispose()}}this.hb=this.aia(Ob)}else{gc.x-Nb.topLeft.x===Nb.width?(this.Xq=!1,ic=!0):gc.y-Nb.topLeft.y>Nb.height/2&&(this.Xq=ic=!0,gb=1);this.jA&&(this.Xq=this.Wq);if(ic){mb=mb.jk("DragSelectionClickBehavior.OnPointerMoveDragInsert",mb.KH,gb);try{mb.Ks(Ob),mb.$$mn(),Ob=mb.$$cu().range}finally{mb&&mb.dispose()}}this.qb.Zg(this.Qh);this.Qh=this.Xq?[11]:[12];for(mb=1;4>=mb;mb++)(Nb=this.Tg[mb.toString()])&&Nb.parentNode.removeChild(Nb),
this.Tg[mb.toString()]=null;this.gA(bb.clientPoint,bb.Gb,this.Xq?11:12,!0);this.hb=this.t3(Ob)}this.ha.sourceRange=this.hb;this.qb.Ri(this.hb,this.Qh);this.qb.Tn(this.Qh);this.qb.Zg(this.lB());if(6!==this.oh){for(bb=1;4>=bb;bb++)Ob=this.Tg[bb.toString()],Ob.parentNode.removeChild(Ob),this.qb.Gv(this.isRow||this.Xq?11:12,bb).zf.appendChild(Ob);this.oh=6}this.Uy()}return!0};this.Cg=()=>{this.domElement.classList.remove(fa.selecting)};this.Pp=()=>{this.domElement.classList.add(fa.selecting)};this.Pc=
()=>{if(this.$.isEditMode){const bb=this.uoa();this.lBa(bb)}};this.Oma=()=>{this.Zh?this.Fp&&5<=this.oh&&(this.tableRange?this.Ku?this.Sx(!0):this.kia(!0):this.Ku?this.isRow||this.gf?this.Sx(!0):this.C3(!0):this.isRow||this.gf?this.C3(!0):this.Sx(!0)):this.Fp&&5<=this.oh&&(this.tableRange?(this.qb.Zg(this.Qh),this.At(this.iL,this.jL)):(this.qb.Zg(this.lB()),this.At(this.Hh,this.Qf)))};this.tableManager=dc;K.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.lBa(this.uoa()&&
this.$.isEditMode);this.tableRange=null;this.Tg={};this.E5=this.Ku=this.Ju=this.Fp=!1;this.ha.e3(this.Pp);this.ha.WY(this.Cg);this.ha.d1b(this.Oma);this.ha.QE(this.Pc);this.thb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.u7(this.Pp),this.ha.cX(this.Cg),this.ha.IKb(this.Oma),this.ha.FI(this.Pc));if(this.Tg)for(let la=1;4>=la;la++)z.DOMElementExtensions.tf(this.Tg[la.toString()]);this.Tg=this.Qh=null;this.Ju&&this.kpa();this.Zh&&this.Ku&&this.kpa(1);
super.dispose()}Vqc(la){this.Zh&&(this.$w=la,this.jA=null,this.Wq=this.isRow=this.gf=this.Xq=!1,da.KeyInputManager.instance.sa(r.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown));this.Fp=!0;this.tableRange=this.I1c(this.tableManager.Bn(this.sourceRange.topLeft));ia.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.jA=this.tableRange,this.co=1,this.Qh=(this.Wq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:
[12],this.oh=6,this.ix(this.iL,this.jL),this.zH=this.$ia,this.TI=this.roa,this.gA(la.clientPoint,la.Gb,this.Wq?11:12,!0,!0),this.hJ(!0)):(this.Qh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.oh=6,this.ix(this.iL,this.jL),this.gA(la.clientPoint,la.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.gf=this.sourceRange.gf,this.isRow||this.gf?(this.co=3,this.gF=this.isRow?1:2,this.oh=
6,this.Qh=this.isRow?[11]:[12],this.ix(this.R6,this.S6),this.zH=this.$ia,this.TI=this.roa,this.gA(la.clientPoint,la.Gb,this.isRow?11:12,!0,!0),this.hJ(!0)):(this.co=2,this.gF=0,this.ix(this.Hh,this.Qf),this.zH=this.Fub,this.TI=this.JNb,this.gA(la.clientPoint,la.Gb,this.hba(),!1,!0),this.Zy(!0))):(this.ix(this.Hh,this.Qf),da.KeyInputManager.instance.sa(r.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.gF=this.sourceRange.isRow?1:this.sourceRange.gf?2:0,this.gA(la.clientPoint,la.Gb,this.hba(),
!1),this.Zy()))}vza(){this.Fp=!1;this.Zh&&(this.co=0);this.qb.Zg(this.lB());if(!this.$.aq([this.hb],!1))return this.At(this.Hh,this.Qf),this.oh=-1,!0;if(this.ha.ra.ed.equals(this.hb)||this.Pba(this.hb)||this.Pba(this.sourceRange))this.oh=-1;else{this.sG();this.ha.sourceRange=this.sourceRange.clone();const la=this.ha.sourceRange,hb=this.ha.ra.ed;this.Zh?this.$.Xc(-694765314,2,30,{[v.a.xaa]:this.Ju,[v.a.XU]:la,[v.a.WU]:hb,[v.a.JJa]:this.Ku}):this.$.Xc(-694765314,2,30,{[v.a.xaa]:this.Ju,[v.a.XU]:la,
[v.a.WU]:hb})}!this.Zh&&this.tableRange||this.At(this.Hh,this.Qf);return!0}q3c(la){la&&(da.KeyInputManager.instance.Ba(r.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.Zh&&ia.h(this.$).yf.hm(v.a.ZQ),this.Fp=!1);for(la=1;4>=la;la++){const hb=this.Tg[la.toString()];hb&&hb.parentNode.removeChild(hb);this.Tg[la.toString()]=null}this.Qh=null}Yqc(la){const hb=this.ha.mo(la.clientPoint,la.Gb,5,void 0,void 0,!0);this.$w=la;return this.Ryb(hb)?(this.hb=this.t3(hb),this.Ayb(!0),!0):this.wmd(hb)?
(this.hb=this.aia(hb),this.Byb(!0),!0):!1}Ryb(la){return!!this.jA&&1!==this.co&&!!la&&this.jA.contains(la.topLeft)}wmd(la){return!!this.jA&&1===this.co&&!!la&&!this.jA.contains(la.topLeft)}Ayb(la){this.tableRange=this.jA;this.co=1;const hb=!this.Ku;la?(this.Sx(!1),this.Qh=this.Wq?[11]:[12],this.AAa(hb),this.hJ(hb)):(this.C3(!1),this.GO(hb),this.Zy(hb))}Byb(la){this.tableRange=null;this.co=2;const hb=!this.Ku;la?(this.Sx(!1),this.Qh=this.Wq?[11]:[12],this.Xq=this.Wq,this.uRa(hb),this.hJ(hb)):(this.kia(!1),
this.GO(hb),this.Zy(hb))}qec(){return this.ha.ra.ed}sG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Zy(la=!1){this.qb.Ri(this.hb,this.lB());this.qb.Tn(this.lB());this.Uy(la);return!0}hJ(la=!1){this.qb.Ri(this.hb,this.Qh);this.qb.Tn(this.Qh);this.Uy(la)}Hvb(){n.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}FDc(){return!1}uoa(){if(!ia.h(this.$).ha.ra.Pg)return!1;const la=ia.h(this.$).getRangeInformation(this.ha.ra.ed);
for(const hb of la)if(Object(ha.a)(ca.PivotTableRange,hb))return!1;return!0}I1c(la){if(la&&la.contains(this.sourceRange)&&!la.equals(this.sourceRange)){if(la.yba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===la.top){const hb=new ja.Range(this.sourceRange.top,this.sourceRange.left,la.bottom,this.sourceRange.right,!1,!1);if(!hb.equals(la))return this.sourceRange=hb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),la}this.Zh?this.Wq=la.left===this.sourceRange.left&&
la.right===this.sourceRange.right:this.isRow=la.left===this.sourceRange.left&&la.right===this.sourceRange.right;if(la.top===this.sourceRange.top&&la.bottom===this.sourceRange.bottom||this.zy())return la}return null}t3(la){const hb=la.clone();this.zy()?hb.left=Math.max(la.left-this.vgc,1):hb.top=Math.max(la.top-this.SFc,1);hb.right=hb.left+this.sourceRange.width-1;hb.bottom=hb.top+this.sourceRange.height-1;return this.o_a(hb)}FBb(){const la=this.hb.topLeft.Fd(this.sourceRange);return la||this.Zh&&
!this.tableRange?la:this.zy()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}cLd(){if(this.zy()&&this.hb.left!==this.tableRange.left||!this.zy()&&this.hb.top!==this.tableRange.top){const la=ba.a.dd(1,1,0,915,0,2065438552,"RearrangeInvalidDest");db.a(this.$).Qr([la]);return!0}return!1}zJd(){const la=this.$.Kb.Cc("UserAction","RearrangeRowColumnClientSide"),hb={["CopyPasteTargetType"]:1,["OperationId"]:Z.a.create().toString(),["Stopwatch"]:la,["DragDropIsShiftKeyDown"]:this.Ku,
["EncounteredDeploymentErrors"]:!1},Kb=this.Ju?2:1,dc=this.$.da.Aa(254);(new Promise((sb,bb)=>{this.Avb(Ob=>{Ob.Errors&&0<Ob.Errors.length?bb(new ua.a(22,Ob.Errors)):sb(!0)},Ob=>{Ob=ra.a.Oe(Ob.data);bb(new ua.a(22,Ob))})})).then(()=>{n.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');dc&&dc.dtf(hb,Kb,this.sourceRange,this.hb);return Promise.resolve(!0)},sb=>{n.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${sb?
copyPasteInfra.getStringifiedError(sb):"null"}, copyPasteTargetType="${1}"`);return dc?dc.XHf(sb,hb,Kb,this.sourceRange,this.hb):Promise.reject(sb)})}Avb(la=null,hb=null){const Kb={};this.zy()?(Kb.FirstRow=this.hb.top-1,Kb.FirstColumn=0,Kb.DeltaColumn=0,Kb.DeltaRow=this.hb.bottom-this.hb.top+1):(Kb.FirstRow=0,Kb.FirstColumn=this.hb.left-1,Kb.DeltaColumn=this.hb.right-this.hb.left+1,Kb.DeltaRow=0);Kb.LastRow=aa.a.Oz;Kb.LastColumn=aa.a.Sw;Kb.SheetName=this.$.va.na?this.$.va.na.name:this.$.Cb.getItemByName(this.$.Cb.na.name).sheetName;
const dc=Za.v(this.sourceRange,this.$);this.$.userOperationManager.Ic(new Pa.a(514,0,(sb,bb,Ob)=>Oa(this.$.pa.xa,dc,Kb,la?Ua.b(sb,la):sb,hb?Ua.a(bb,hb):bb,Ob,null),64,()=>new La(dc,Kb)),null)}Pba(la){la=ia.h(this.$).getRangeInformation(la);for(let hb=0,Kb=la.length;hb<Kb;++hb)if(Object(ha.a)(ca.PivotTableRange,la[hb]))return la=ba.a.dd(1,0,0,900,0,2105176604,"InsDelCellsPivotTable"),db.a(this.$).Qr([la]),!0;return!1}gA(la,hb,Kb,dc,sb=!1){var bb=z.DOMElementExtensions.getBoundingClientRect(hb);let Ob=
hb===this.ms[Ra.LJa]||hb===this.ms[Ra.o$c];if(this.Zh){var gc=hb===this.ms[Ra.p$c]||hb===this.ms[Ra.KJa];this.isRow&&gc||this.gf&&Ob?gc="100px":(Ob=this.isRow||Ob,gc=(Ob?sb?Ab.N_d:Ab.T_d:sb?Ab.M_d:Ab.Q_d)+"px");hb=Ob?hb===this.ms[Ra.LJa]?"top":"bottom":hb===this.ms[Ra.KJa]?"right":"left";la=100*(Ob?la.x-bb.x:la.y-bb.y)/(Ob?bb.width:bb.height);for(bb=1;4>=bb;bb++){dc=document.createElement("div");var mb=document.createElement("div");const Nb=document.createElement("div");dc.appendChild(mb);dc.appendChild(Nb);
sb&&(mb=document.createElement("div"),dc.appendChild(mb),Nb.style.fontWeight="bold");dc.className=fa.GWe;this.Tg[bb.toString()]=dc;this.qb.Gv(Kb,bb).zf.appendChild(dc);dc=this.Tg[bb.toString()];dc.style[hb]=gc;dc.style[Ob?"left":"top"]=la+"%"}}else for(sb=(Ob?-Ab.S_d:-Ab.P_d)+"px",gc=Ob?hb===this.ms[Ra.LJa]?"top":"bottom":hb===this.ms[Ra.KJa]||dc?"right":"left",hb=100*(Ob?dc?0:la.x-bb.x:la.y-bb.y)/(Ob?bb.width:bb.height),la=1;4>=la;la++)bb=document.createElement("div"),bb.className=fa.FWe,this.Tg[la.toString()]=
bb,this.qb.Gv(Kb,la).zf.appendChild(bb),bb=this.Tg[la.toString()],bb.style[gc]=sb,bb.style[Ob?"left":"top"]=hb+"%"}Uy(la=!1){const hb=this.hb.toString();if(this.Zh)for(var Kb=1;4>=Kb;Kb++)if(this.thb){const dc=this.Tg[Kb.toString()];dc&&dc.childNodes&&0<dc.childNodes.length&&(dc.childNodes[0].innerText=hb,dc.childNodes[1].innerText=this.zH,la&&(dc.childNodes[2].innerText=this.TI))}else this.Tg[Kb.toString()].childNodes[0].innerText=hb,this.Tg[Kb.toString()].childNodes[1].innerText=this.zH,la&&(this.Tg[Kb.toString()].childNodes[2].innerText=
this.TI);else for(la=1;4>=la;la++)if(this.thb){if(Kb=this.Tg[la.toString()])Kb.innerText=hb}else this.Tg[la.toString()].innerText=hb}kpa(la=0){0===la?this.Ju=!1:1===la&&(this.Ku=!1);this.Zh&&(this.Ju||this.Ku)||(da.KeyInputManager.instance.Ba(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.E5=!1)}Sx(la){this.qb.Zg(this.lB());this.At(this.Hh,this.Qf,void 0,la)}C3(la){this.qb.Zg(this.Qh);this.At(this.R6,this.S6,void 0,la)}kia(la){this.qb.Zg(this.Qh);this.At(this.iL,this.jL,void 0,la)}GO(la=
!1){this.oh=5;this.ix(this.Hh,this.Qf);this.zH=this.Fub;this.TI=this.JNb;this.gA(this.$w.clientPoint,this.$w.Gb,this.hba(),!1,la)}uRa(la=!1){this.oh=6;this.ix(this.R6,this.S6);this.zH=this.$ia;this.TI=this.roa;this.gA(this.$w.clientPoint,this.$w.Gb,this.isRow||this.Wq?11:12,!0,la)}AAa(la=!1){this.oh=6;this.ix(this.iL,this.jL);this.zH=this.$ia;this.TI=this.roa;this.gA(this.$w.clientPoint,this.$w.Gb,this.zy()?11:12,!0,la)}u5(la){return la.Ca.keyCode===Ga.a.L1||l.a.isMac&&la.Ca.keyCode===Ga.a.mfa}zy(){return!this.Zh&&
this.isRow||this.Zh&&this.Wq}hba(){return this.Zh?48:6}lB(){return this.Zh?Ab.n$c:Ab.q$c}}Ab.P_d=50;Ab.S_d=25;Ab.Q_d=-85;Ab.T_d=-40;Ab.M_d=-120;Ab.N_d=-50;Ab.Z1a="copy";Ab.q$c=[6];Ab.n$c=[48];Object(t.a)(Ab,"DragSelectionClickBehavior",Ra,[]);var Mb=a(82);class pb extends Ra{constructor(la,hb,Kb,dc,sb){super(la,hb,Kb,sb);this.Qh=null;this.gf=this.isRow=!1;this.Cg=()=>{this.domElement.classList.remove(fa.selecting)};this.Pp=()=>{this.domElement.classList.add(fa.selecting)};this.Pc=()=>{if(this.$.isEditMode){const bb=
this.uoa();this.lBa(bb)}};this.tableManager=dc;K.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.lBa(this.uoa()&&this.$.isEditMode);this.Tg={};this.Fp=!1;this.ha.e3(this.Pp);this.ha.WY(this.Cg);this.ha.QE(this.Pc);this.thb=this.$.isChangeGateEnabled("OfficeVSO:7148113_FixShowToolTipBug7144260")}dispose(){this.ha&&(this.ha.u7(this.Pp),this.ha.cX(this.Cg),this.ha.FI(this.Pc),K.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")||this.ha.IKb(this.Oma));
if(this.Tg)for(let la=1;4>=la;la++)z.DOMElementExtensions.tf(this.Tg[la.toString()]);this.Tg=this.Qh=null;super.dispose()}q3c(la){la&&(this.Zh&&ia.h(this.$).yf.hm(v.a.ZQ),da.KeyInputManager.instance.Ba(r.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.Fp=!1);for(la=1;4>=la;la++){const hb=this.Tg[la.toString()];hb&&hb.parentNode.removeChild(hb);this.Tg[la.toString()]=null}this.Qh=null}qec(){return this.ha.ra.ed}sG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Zy(la=!1){this.qb.Ri(this.hb,
this.lB());this.qb.Tn(this.lB());this.Uy(la);return!0}hJ(la=!1){this.qb.Ri(this.hb,this.Qh);this.qb.Tn(this.Qh);this.Uy(la)}Hvb(){n.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}FDc(){return!1}gA(la,hb,Kb,dc,sb=!1){var bb=z.DOMElementExtensions.getBoundingClientRect(hb);let Ob=hb===this.ms[Ra.LJa]||hb===this.ms[Ra.o$c];if(this.Zh){var gc=hb===this.ms[Ra.p$c]||hb===this.ms[Ra.KJa];this.isRow&&gc||this.gf&&
Ob?gc="100px":(Ob=this.isRow||Ob,gc=(Ob?sb?pb.N_d:pb.T_d:sb?pb.M_d:pb.Q_d)+"px");hb=Ob?hb===this.ms[Ra.LJa]?"top":"bottom":hb===this.ms[Ra.KJa]?"right":"left";la=100*(Ob?la.x-bb.x:la.y-bb.y)/(Ob?bb.width:bb.height);for(bb=1;4>=bb;bb++){dc=document.createElement("div");var mb=document.createElement("div");const Nb=document.createElement("div");dc.appendChild(mb);dc.appendChild(Nb);sb&&(mb=document.createElement("div"),dc.appendChild(mb),Nb.style.fontWeight="bold");dc.className=fa.GWe;this.Tg[bb.toString()]=
dc;this.qb.Gv(Kb,bb).zf.appendChild(dc);dc=this.Tg[bb.toString()];dc.style[hb]=gc;dc.style[Ob?"left":"top"]=la+"%"}}else for(sb=(Ob?-pb.S_d:-pb.P_d)+"px",gc=Ob?hb===this.ms[Ra.LJa]?"top":"bottom":hb===this.ms[Ra.KJa]||dc?"right":"left",hb=100*(Ob?dc?0:la.x-bb.x:la.y-bb.y)/(Ob?bb.width:bb.height),la=1;4>=la;la++)bb=document.createElement("div"),bb.className=fa.FWe,this.Tg[la.toString()]=bb,this.qb.Gv(Kb,la).zf.appendChild(bb),bb=this.Tg[la.toString()],bb.style[gc]=sb,bb.style[Ob?"left":"top"]=hb+"%"}mkg(la,
hb,Kb){const dc=ia.h(this.$),sb=dc.fg(la);var bb=dc.Df(this.paneType);Kb=ka.a.Xs(bb.view.fi,this.domElement.parentNode,Kb,dc.rtl);bb=!1;let Ob=2;hb&&Kb.y-sb.topLeft.y>sb.height/2?(bb=!0,Ob=1):!hb&&Kb.x-sb.topLeft.x>sb.width/2&&(bb=!0);if(bb){hb=dc.jk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",dc.KH,Ob);try{hb.Ks(la),hb.$$mn(),hb.$$cu()}finally{hb&&hb.dispose()}}}kia(la){this.qb.Zg(this.Qh);this.At(this.iL,this.jL,void 0,la)}Sx(la){this.qb.Zg(this.lB());this.At(this.Hh,this.Qf,
void 0,la)}hba(){return this.Zh?48:6}lB(){return this.Zh?pb.n$c:pb.q$c}u5(la){return la.Ca.keyCode===Ga.a.L1||l.a.isMac&&la.Ca.keyCode===Ga.a.mfa}Pba(la){la=ia.h(this.$).getRangeInformation(la);for(let hb=0,Kb=la.length;hb<Kb;++hb)if(Object(ha.a)(ca.PivotTableRange,la[hb]))return la=ba.a.dd(1,0,901,900,0,2105176604,"InsDelCellsPivotTable"),db.a(this.$).Qr([la]),!0;return!1}}pb.P_d=50;pb.S_d=25;pb.Q_d=-85;pb.T_d=-40;pb.M_d=-120;pb.N_d=-50;pb.q$c=[6];pb.n$c=[48];Object(t.a)(pb,"DragSelectionClickBehaviorTemporary",
Ra,[]);class Qb extends pb{constructor(la,hb,Kb,dc,sb){super(la,hb,Kb,dc,sb);this.jA=null;this.Wq=this.Xq=!1;this.WCb=0;this.TI=this.zH=null;this.co=0;this.$ia=Wa.a.instance.ga(2263);this.Fub=Wa.a.instance.ga(2264);this.roa=Wa.a.instance.ga(2265);this.JNb=Wa.a.instance.ga(2266);this.onKeyDown=bb=>{if(this.Zh){if(this.u5(bb)||bb.Ca.keyCode===Ga.a.x8)return this.E5||(da.KeyInputManager.instance.sa(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.E5=!0),!this.Ju&&this.u5(bb)&&(ia.h(this.$).yf.hm(Ra.Z1a),
this.Ju=!0),this.Ku||bb.Ca.keyCode!==Ga.a.x8||(ia.h(this.$).yf.hm(Ra.MJa),this.Ku=!0,2===this.co?(this.Sx(!1),this.gF=0,this.Qh=this.Wq?[11]:[12],this.Xq=this.Wq,this.uRa(),this.hJ()):3===this.co?(this.C3(!1),this.gF=this.isRow?1:2,this.GO(),this.Zy()):1===this.co&&(this.kia(!1),this.GO(),this.Zy())),!0}else if(!this.Ju&&(bb.Ca.keyCode===Ga.a.L1||l.a.isMac&&bb.Ca.keyCode===Ga.a.mfa))return da.KeyInputManager.instance.sa(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),ia.h(this.$).yf.hm(Ra.Z1a),
this.Ju=!0;return!1};this.onKeyUp=bb=>{if(this.Zh){if(this.u5(bb)||bb.Ca.keyCode===Ga.a.x8)return this.WCb=this.u5(bb)?0:1,this.Fp&&ia.h(this.$).yf.hm(Ra.MJa),bb.Ca.keyCode===Ga.a.x8&&(2===this.co?(this.C3(!1),this.gF=0,this.GO(!0),this.Zy(!0)):3===this.co?(this.Sx(!1),this.gF=this.isRow?1:2,this.Qh=this.isRow?[11]:[12],this.uRa(!0),this.hJ(!0)):1===this.co&&(this.Sx(!1),this.Qh=this.Wq?[11]:[12],this.AAa(!0),this.hJ(!0))),this.kpa(this.WCb),!0}else if(bb.Ca.keyCode===Ga.a.L1||l.a.isMac&&bb.Ca.keyCode===
Ga.a.mfa)return this.kpa(),this.Fp&&ia.h(this.$).yf.hm(Ra.l$c),!0;return!1};this.jL=bb=>{bb=Y.a(this.$).Vd(bb);5===this.oh?this.fFd(bb):(this.Fp=!1,this.qb.Zg(this.Qh),!this.$.aq([this.hb],!1)||this.cLd()||this.FBb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Zh?this.zJd():this.Avb(),this.zy()?this.hb.top>this.sourceRange.top&&(bb=this.hb.height,this.hb.top-=bb,this.hb.bottom-=bb):this.hb.left>this.sourceRange.left&&(bb=this.hb.width,this.hb.left-=bb,this.hb.right-=bb),this.sG()),this.Exd());
this.At(this.iL,this.jL);this.tableRange=null;this.oh=-1;this.Zh&&(this.jA=null,this.co=0);return!0};this.S6=()=>{this.Fp=!1;this.co=0;this.qb.Zg(this.Qh);if(!this.$.aq([this.hb],!1))return this.At(this.R6,this.S6),this.oh=-1,!0;if(!(this.ha.ra.ed.equals(this.hb)||this.Pba(this.hb)||this.Pba(this.sourceRange)||this.FBb()||(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.xaa]:this.Ju,[v.a.B9b]:!0,[v.a.D9b]:this.Xq,[v.a.XU]:this.ha.sourceRange,[v.a.WU]:this.ha.ra.ed,
[v.a.JJa]:this.Ku}),this.Ju))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Xq)){var bb=this.hb.height;this.hb.top-=bb;this.hb.bottom-=bb}else this.hb.left>this.sourceRange.left&&(this.gf||this.hb.top===this.sourceRange.top&&!this.Xq)&&(bb=this.hb.width,this.hb.left-=bb,this.hb.right-=bb);this.sG()}this.At(this.R6,this.S6);this.jA=this.tableRange=null;this.oh=-1;this.Xq=!1;this.Exd();return!0};this.iL=bb=>{const Ob=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Ob&&(bb=Y.a(this.$).Vd(bb));var gc=bb.clientPoint;Ob||(bb=Y.a(this.$).Vd(bb));this.Zh&&(this.$w=bb);if(bb=this.ha.mo(gc,bb.Gb,5,void 0,void 0,!0)){if(this.tableRange.contains(bb.topLeft)){if(this.mkg(bb,this.zy(),gc),this.hb=this.t3(bb),this.ha.sourceRange=this.hb,this.qb.Ri(this.hb,this.Qh),this.qb.Tn(this.Qh),this.qb.Zg(this.lB()),6!==this.oh){for(gc=1;4>=gc;gc++)bb=this.Tg[gc.toString()],bb.parentNode.removeChild(bb),this.qb.Gv(this.zy()?11:12,gc).zf.appendChild(bb);this.oh=6}}else if(this.hb=
this.aia(bb),this.Zh)this.Byb(!1);else if(this.qb.Ri(this.hb,this.lB()),this.qb.Tn(this.lB()),this.qb.Zg(this.Qh),5!==this.oh){for(gc=1;4>=gc;gc++)bb=this.Tg[gc.toString()],bb.parentNode.removeChild(bb),this.qb.Gv(this.hba(),gc).zf.appendChild(bb);this.oh=5}this.Uy()}return!0};this.R6=bb=>{var Ob=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Ob&&(bb=Y.a(this.$).Vd(bb));var gc=bb.clientPoint;Ob||(bb=Y.a(this.$).Vd(bb));this.$w=bb;if(Ob=this.ha.mo(gc,bb.Gb,5,
void 0,void 0,!0)){if(this.Ryb(Ob))return this.hb=this.aia(Ob),this.Ayb(!1),!0;var mb=ia.h(this.$),Nb=mb.fg(Ob),ic=mb.Df(this.paneType);gc=ka.a.Xs(ic.view.fi,this.domElement.parentNode,gc,mb.rtl);ic=!1;let gb=2;this.Xq=!1;if(this.isRow||this.gf){this.isRow&&gc.y-Nb.topLeft.y>Nb.height/2?(ic=!0,gb=1):this.gf&&gc.x-Nb.topLeft.x>Nb.width/2&&(ic=!0);if(ic){bb=mb.jk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",mb.KH,gb);try{bb.Ks(Ob),bb.$$mn(),Ob=bb.$$cu().range}finally{bb&&bb.dispose()}}this.hb=
this.aia(Ob)}else{gc.x-Nb.topLeft.x===Nb.width?(this.Xq=!1,ic=!0):gc.y-Nb.topLeft.y>Nb.height/2&&(this.Xq=ic=!0,gb=1);this.jA&&(this.Xq=this.Wq);if(ic){mb=mb.jk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",mb.KH,gb);try{mb.Ks(Ob),mb.$$mn(),Ob=mb.$$cu().range}finally{mb&&mb.dispose()}}this.qb.Zg(this.Qh);this.Qh=this.Xq?[11]:[12];for(mb=1;4>=mb;mb++)(Nb=this.Tg[mb.toString()])&&Nb.parentNode.removeChild(Nb),this.Tg[mb.toString()]=null;this.gA(bb.clientPoint,bb.Gb,this.Xq?11:
12,!0);this.hb=this.t3(Ob)}this.ha.sourceRange=this.hb;this.qb.Ri(this.hb,this.Qh);this.qb.Tn(this.Qh);this.qb.Zg(this.lB());if(6!==this.oh){for(bb=1;4>=bb;bb++)Ob=this.Tg[bb.toString()],Ob.parentNode.removeChild(Ob),this.qb.Gv(this.isRow||this.Xq?11:12,bb).zf.appendChild(Ob);this.oh=6}this.Uy()}return!0};this.Oma=()=>{this.Zh?this.Fp&&5<=this.oh&&(this.tableRange?this.Ku?this.Sx(!0):this.kia(!0):this.Ku?this.isRow||this.gf?this.Sx(!0):this.C3(!0):this.isRow||this.gf?this.C3(!0):this.Sx(!0)):this.Fp&&
5<=this.oh&&(this.tableRange?(this.qb.Zg(this.Qh),this.At(this.iL,this.jL)):(this.qb.Zg(this.lB()),this.At(this.Hh,this.Qf)))};this.tableRange=null;this.E5=this.Ju=this.Ku=!1;this.ha.d1b(this.Oma)}dispose(){K.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.IKb(this.Oma);this.Ju&&this.kpa();this.Zh&&this.Ku&&this.kpa(1);super.dispose()}Vqc(la){this.Zh&&(this.$w=la,this.jA=null,this.Wq=this.isRow=this.gf=this.Xq=!1,da.KeyInputManager.instance.sa(r.a.Pb,
this.domElement.ownerDocument.body,this.onKeyDown));this.Fp=!0;this.tableRange=this.I1c(this.tableManager.Bn(this.sourceRange.topLeft));ia.h(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.jA=this.tableRange,this.co=1,this.Qh=(this.Wq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.oh=6,this.ix(this.iL,this.jL),this.zH=this.$ia,this.TI=this.roa,this.gA(la.clientPoint,la.Gb,this.Wq?11:12,!0,!0),this.hJ(!0)):
(this.Qh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.oh=6,this.ix(this.iL,this.jL),this.gA(la.clientPoint,la.Gb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.gf=this.sourceRange.gf,this.isRow||this.gf?(this.co=3,this.gF=this.isRow?1:2,this.oh=6,this.Qh=this.isRow?[11]:[12],this.ix(this.R6,this.S6),this.zH=this.$ia,this.TI=this.roa,this.gA(la.clientPoint,la.Gb,this.isRow?11:12,
!0,!0),this.hJ(!0)):(this.co=2,this.gF=0,this.ix(this.Hh,this.Qf),this.zH=this.Fub,this.TI=this.JNb,this.gA(la.clientPoint,la.Gb,this.hba(),!1,!0),this.Zy(!0))):(this.ix(this.Hh,this.Qf),da.KeyInputManager.instance.sa(r.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown),this.gF=this.sourceRange.isRow?1:this.sourceRange.gf?2:0,this.gA(la.clientPoint,la.Gb,this.hba(),!1),this.Zy()))}vza(){this.Fp=!1;this.Zh&&(this.co=0);this.qb.Zg(this.lB());if(!this.$.aq([this.hb],!1))return this.At(this.Hh,this.Qf),
this.oh=-1,!0;if(this.ha.ra.ed.equals(this.hb)||this.Pba(this.hb)||this.Pba(this.sourceRange))this.oh=-1;else{this.sG();this.ha.sourceRange=this.sourceRange.clone();const la=this.ha.sourceRange,hb=this.ha.ra.ed;this.Zh?this.$.Xc(-694765314,2,30,{[v.a.xaa]:this.Ju,[v.a.XU]:la,[v.a.WU]:hb,[v.a.JJa]:this.Ku}):this.$.Xc(-694765314,2,30,{[v.a.xaa]:this.Ju,[v.a.XU]:la,[v.a.WU]:hb})}!this.Zh&&this.tableRange||this.At(this.Hh,this.Qf);this.Exd();return!0}Yqc(la){const hb=this.ha.mo(la.clientPoint,la.Gb,5,
void 0,void 0,!0);this.$w=la;return this.Ryb(hb)?(this.hb=this.t3(hb),this.Ayb(!0),!0):this.wmd(hb)?(this.hb=this.aia(hb),this.Byb(!0),!0):!1}Uy(la=!1){const hb=this.hb.toString();if(this.Zh)for(var Kb=1;4>=Kb;Kb++)if(this.thb){const dc=this.Tg[Kb.toString()];dc&&dc.childNodes&&0<dc.childNodes.length&&(dc.childNodes[0].innerText=hb,dc.childNodes[1].innerText=this.zH,la&&(dc.childNodes[2].innerText=this.TI))}else this.Tg[Kb.toString()].childNodes[0].innerText=hb,this.Tg[Kb.toString()].childNodes[1].innerText=
this.zH,la&&(this.Tg[Kb.toString()].childNodes[2].innerText=this.TI);else for(la=1;4>=la;la++)if(this.thb){if(Kb=this.Tg[la.toString()])Kb.innerText=hb}else this.Tg[la.toString()].innerText=hb}Ryb(la){return!!this.jA&&1!==this.co&&!!la&&this.jA.contains(la.topLeft)}wmd(la){return!!this.jA&&1===this.co&&!!la&&!this.jA.contains(la.topLeft)}Ayb(la){this.tableRange=this.jA;this.co=1;const hb=!this.Ku;la?(this.Sx(!1),this.Qh=this.Wq?[11]:[12],this.AAa(hb),this.hJ(hb)):(this.C3(!1),this.GO(hb),this.Zy(hb))}Byb(la){this.tableRange=
null;this.co=2;const hb=!this.Ku;la?(this.Sx(!1),this.Qh=this.Wq?[11]:[12],this.Xq=this.Wq,this.uRa(hb),this.hJ(hb)):(this.kia(!1),this.GO(hb),this.Zy(hb))}uoa(){if(!ia.h(this.$).ha.ra.Pg)return!1;const la=ia.h(this.$).getRangeInformation(this.ha.ra.ed);for(const hb of la)if(Object(ha.a)(ca.PivotTableRange,hb))return!1;return!0}I1c(la){if(la&&la.contains(this.sourceRange)&&!la.equals(this.sourceRange)){if(la.yba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===la.top){const hb=
new ja.Range(this.sourceRange.top,this.sourceRange.left,la.bottom,this.sourceRange.right,!1,!1);if(!hb.equals(la))return this.sourceRange=hb,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),la}this.Zh?this.Wq=la.left===this.sourceRange.left&&la.right===this.sourceRange.right:this.isRow=la.left===this.sourceRange.left&&la.right===this.sourceRange.right;if(la.top===this.sourceRange.top&&la.bottom===this.sourceRange.bottom||this.zy())return la}return null}t3(la){const hb=la.clone();
this.zy()?hb.left=Math.max(la.left-this.vgc,1):hb.top=Math.max(la.top-this.SFc,1);hb.right=hb.left+this.sourceRange.width-1;hb.bottom=hb.top+this.sourceRange.height-1;return this.o_a(hb)}FBb(){const la=this.hb.topLeft.Fd(this.sourceRange);return la||this.Zh&&!this.tableRange?la:this.zy()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}cLd(){if(this.zy()&&this.hb.left!==this.tableRange.left||!this.zy()&&this.hb.top!==this.tableRange.top){const la=ba.a.dd(1,1,0,915,0,
2065438552,"RearrangeInvalidDest");db.a(this.$).Qr([la]);return!0}return!1}zJd(){const la=this.$.Kb.Cc("UserAction","RearrangeRowColumnClientSide"),hb={["CopyPasteTargetType"]:1,["OperationId"]:Z.a.create().toString(),["Stopwatch"]:la,["DragDropIsShiftKeyDown"]:this.Ku,["EncounteredDeploymentErrors"]:!1},Kb=this.Ju?2:1,dc=this.$.da.Aa(254);(new Promise((sb,bb)=>{this.Avb(Ob=>{Ob.Errors&&0<Ob.Errors.length?bb(new ua.a(22,Ob.Errors)):sb(!0)},Ob=>{Ob=ra.a.Oe(Ob.data);bb(new ua.a(22,Ob))})})).then(()=>
{n.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');dc&&dc.dtf(hb,Kb,this.sourceRange,this.hb);return Promise.resolve(!0)},sb=>{n.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${sb?copyPasteInfra.getStringifiedError(sb):"null"}, copyPasteTargetType="${1}"`);return dc?dc.XHf(sb,hb,Kb,this.sourceRange,this.hb):Promise.reject(sb)})}Avb(la=null,hb=null){const Kb={};this.zy()?
(Kb.FirstRow=this.hb.top-1,Kb.FirstColumn=0,Kb.DeltaColumn=0,Kb.DeltaRow=this.hb.bottom-this.hb.top+1):(Kb.FirstRow=0,Kb.FirstColumn=this.hb.left-1,Kb.DeltaColumn=this.hb.right-this.hb.left+1,Kb.DeltaRow=0);Kb.LastRow=aa.a.Oz;Kb.LastColumn=aa.a.Sw;Kb.SheetName=this.$.va.na?this.$.va.na.name:this.$.Cb.getItemByName(this.$.Cb.na.name).sheetName;const dc=Za.v(this.sourceRange,this.$);this.$.userOperationManager.Ic(new Pa.a(514,0,(sb,bb,Ob)=>Oa(this.$.pa.xa,dc,Kb,la?Ua.b(sb,la):sb,hb?Ua.a(bb,hb):bb,Ob,
null),64,()=>new La(dc,Kb)),null)}kpa(la=0){0===la?this.Ju=!1:1===la&&(this.Ku=!1);this.Zh&&(this.Ju||this.Ku)||(da.KeyInputManager.instance.Ba(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.E5=!1)}GO(la=!1){this.oh=5;this.ix(this.Hh,this.Qf);this.zH=this.Fub;this.TI=this.JNb;this.gA(this.$w.clientPoint,this.$w.Gb,this.hba(),!1,la)}uRa(la=!1){this.oh=6;this.ix(this.R6,this.S6);this.zH=this.$ia;this.TI=this.roa;this.gA(this.$w.clientPoint,this.$w.Gb,this.isRow||this.Wq?11:12,!0,la)}AAa(la=
!1){this.oh=6;this.ix(this.iL,this.jL);this.zH=this.$ia;this.TI=this.roa;this.gA(this.$w.clientPoint,this.$w.Gb,this.zy()?11:12,!0,la)}zy(){return!this.Zh&&this.isRow||this.Zh&&this.Wq}C3(la){this.qb.Zg(this.Qh);this.At(this.R6,this.S6,void 0,la)}Exd(){const la=Mb.a.instance.Rb("Common.ISystemInitiatedFeedback");la&&la.execute(hb=>{hb.logActivity("DragDrop",null)})}}Object(t.a)(Qb,"DragSelectionClickBehaviorCellRangeAndTable",pb,[]);var xb=a(321),pa=a(138);class Ma extends pb{constructor(la,hb,Kb,
dc,sb){super(la,hb,Kb,dc,sb);this.Oma=()=>{this.Fp&&this.kia(!0);5===this.oh&&this.Sx(!0)};this.jL=bb=>{Y.a(this.$).Vd(bb);this.Fp=!1;this.qb.Zg(this.Qh);this.ha.sourceRange=this.sourceRange.clone();this.onf?this.$.Xc(927125067,C.a.Db,30,null):this.B7a?(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.xaa]:!0,[v.a.XU]:this.ha.sourceRange,[v.a.WU]:this.ha.ra.ed,[v.a.JJa]:!1}),ia.h(this.$).yf.hm(v.a.ZQ),this.B7a=!1):this.q8i();this.At(this.iL,this.jL);this.oh=-1;
return!0};this.iL=bb=>{bb=Y.a(this.$).Vd(bb);const Ob=bb.clientPoint;this.$w=bb;let gc=this.ha.mo(Ob,bb.Gb,5,void 0,void 0,!0);if(gc){if(!this.xtd(gc))return this.A8h(bb),!0;this.mkg(gc,this.isRow,Ob);if(this.isRow||this.gf)this.hb=this.t3(gc);this.ha.sourceRange=this.hb;this.qb.Ri(this.hb,this.Qh);this.qb.Tn(this.Qh);this.qb.Zg(this.lB());this.Uy()}return!0};this.onKeyDown=bb=>this.u5(bb)?(this.E5||(da.KeyInputManager.instance.sa(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.E5=!0),
this.B7a||(ia.h(this.$).yf.hm(Ra.Z1a),this.B7a=!0),!0):!1;this.onKeyUp=bb=>{this.u5(bb)&&(da.KeyInputManager.instance.Ba(r.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.E5=!1,this.Fp?ia.h(this.$).yf.hm(Ra.MJa):ia.h(this.$).yf.hm(v.a.ZQ),this.B7a=!1);return!0};this.CGf=bb=>{bb.Errors&&0<bb.Errors.length?(n.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${ba.a.sc(bb.Errors)}]`),this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right,this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1?(this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.hb.top||(this.hb.top-=this.sourceRange.height),this.hb.bottom=this.hb.top+this.sourceRange.height-1):this.sourceRange.left<=this.hb.left&&this.sourceRange.right>=this.hb.left-1?(this.hb.left=this.sourceRange.left,this.hb.right=
this.sourceRange.right):(this.sourceRange.left>this.hb.left||(this.hb.left-=this.sourceRange.width),this.hb.right=this.hb.left+this.sourceRange.width-1);this.sG();this.oh=-1};this.BGf=bb=>{bb=ra.a.Oe(bb.data);n.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${ba.a.sc(bb)}]`)};this.ha.d1b(this.Oma);this.B7a=this.E5=!1}dispose(){K.EwaSettings.isChangeGateEnabled("OfficeVSO:7117157_ChangesInDragDropRefactoredCode")&&this.ha&&this.ha.IKb(this.Oma);
super.dispose()}Vqc(la){this.$w=la;this.isRow=this.gf=!1;this.Fp=!0;da.KeyInputManager.instance.sa(r.a.Pb,this.domElement.ownerDocument.body,this.onKeyDown);(this.kc=this.tableManager.oka(this.sourceRange))||n.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.onf=(new pa.a(this.$.va)).li;ia.h(this.$);ia.h(this.$).yf.hm(Ra.MJa);this.xtd(this.hb)?(this.isRow=this.Msi(),this.gf=this.umi(),this.isRow||
this.gf?(this.o8a=!1,this.AAa(la),this.hb=this.t3(this.hb),this.hJ()):(this.o8a=!0,this.GO(la),this.Zy())):(this.o8a=!0,this.GO(la),this.Zy())}vza(){return this.onf?(this.$.Xc(927125067,C.a.Db,30,null),this.Sx(!0),this.o8a=!1,this.oh=-1,!0):this.B7a?(this.sG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.Xc(-694765314,2,30,{[v.a.xaa]:!0,[v.a.XU]:this.ha.sourceRange,[v.a.WU]:this.ha.ra.ed,[v.a.JJa]:!1}),ia.h(this.$).yf.hm(v.a.ZQ),this.Sx(!0),this.Fp=this.o8a=!1,this.oh=-1,!0):5===this.oh?(this.Sx(!0),
this.o8a=!1,this.fHj(),this.oh=-1,!0):!1}Yqc(la){const hb=this.ha.mo(la.clientPoint,la.Gb,5,void 0,void 0,!0);this.$w=la;return this.o8a?!1:this.xtd(hb)?(this.B8h(la),!0):!1}Uy(){let la=new ja.Range(this.hb.top,this.hb.left,this.hb.bottom,this.hb.right,!1,!0);6===this.oh&&(this.isRow?(--la.top,la.bottom=la.top+this.hb.height-1):(--la.left,la.right=la.left+this.hb.width-1));for(let hb=1;4>=hb;hb++)if(this.thb){const Kb=this.Tg[hb.toString()];Kb&&Kb.childNodes&&0<Kb.childNodes.length&&(Kb.childNodes[0].innerText=
la.toString())}else this.Tg[hb.toString()].childNodes[0].innerText=la.toString()}uoa(){if(!ia.h(this.$).ha.ra.Pg)return!1;var la=ia.h(this.$).getRangeInformation(this.ha.ra.ed);for(var hb of la)if(Object(ha.a)(ca.PivotTableRange,hb)&&(la=this.tableManager.oka(hb)))return hb=!la.isOlap||!la.lOa(!0),n.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",la),la.isActionable&&hb;return!1}t3(la){la=la.clone();this.isRow?
(la.left=this.sourceRange.left,la.right=this.kc.right,la.bottom=la.top+this.sourceRange.height-1):this.gf?(la.top=this.sourceRange.top,la.bottom=this.kc.EL.bottom,la.right=la.left+this.sourceRange.width-1):n.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.o_a(la)}q8i(){const la={},hb=Za.v(this.sourceRange,this.$);ia.h(this.$).getRangeInformation(this.hb);if(this.isRow){hb.FirstColumn=la.FirstColumn=this.hb.left-
1;hb.LastColumn=la.LastColumn=this.hb.right-1;if(this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1){n.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.hb.top?la.LastRow=la.FirstRow=this.hb.top-1:(la.FirstRow=this.hb.top-this.sourceRange.height-1,la.LastRow=la.FirstRow+this.sourceRange.height-1)}else{la.FirstRow=this.hb.top;la.LastRow=this.hb.bottom-1;if(this.sourceRange.left<=this.hb.left&&
this.sourceRange.right>=this.hb.left-1){n.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}la.LastColumn=this.sourceRange.left>this.hb.left?la.FirstColumn=this.hb.left-1:la.FirstColumn=this.hb.left-this.sourceRange.width-1}const Kb={};Kb.SheetName=this.$.va.na?this.$.va.na.name:this.$.Cb.getItemByName(this.$.Cb.na.name).sheetName;Kb.Ranges=Array(2);Kb.Ranges[0]=hb;Kb.Ranges[1]=la;this.gEh(Kb)}gEh(la){this.$.userOperationManager.Ic(new Pa.a(265,
0,(hb,Kb,dc)=>ib(this.$.pa.xa,la,this.CGf?Ua.b(hb,this.CGf):hb,this.BGf?Ua.a(Kb,this.BGf):Kb,dc,null),64),null)}xtd(la){return null!==this.kc&&(null===this.kc.EL||la.left>=this.kc.EL.left)&&(null===this.kc.fF||la.right<=this.kc.fF.right)&&(null===this.kc.fF||la.top>=this.kc.fF.top)&&(null===this.kc.EL||la.bottom<=this.kc.EL.bottom)}Msi(){return null!==this.kc&&null!==this.kc.EL&&this.kc.EL.top<=this.hb.top&&this.kc.EL.left<=this.hb.left&&this.kc.EL.right>=this.hb.left}umi(){return null!==this.kc&&
null!==this.kc.fF&&this.kc.fF.top===this.hb.top&&this.kc.fF.left<=this.hb.left&&this.kc.fF.right>=this.hb.right}AAa(la){this.oh=6;this.Qh=this.isRow?[11]:[12];this.ix(this.iL,this.jL);this.gA(la.clientPoint,la.Gb,this.isRow?11:12,!0,!1)}GO(la){this.oh=5;this.ix(this.Hh,this.Qf);this.gA(la.clientPoint,la.Gb,this.hba(),!1,!1)}B8h(la){this.Sx(!1);this.AAa(la);this.hb=this.t3(this.hb);this.hJ()}A8h(la){this.kia(!1);this.GO(la);this.Zy()}fHj(){if(!this.Pba(this.hb)){var la=ba.a.dd(1,0,903,902,0,2069074184,
"PivotTableInvalidMove");la.HelpTopicId=xb.a.UKj;la.HelpDescription=Wa.a.instance.ga(910);db.a(this.$).Qr([la])}}}Object(t.a)(Ma,"DragSelectionClickBehaviorPivotTableRange",pb,[]);var ya=a(375);class Ea extends Q{constructor(la,hb){super(la);this.Cg=()=>{this.domElement.classList.remove(fa.selecting);ya.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Pp=()=>{this.domElement.classList.add(fa.selecting)};this.onPointerDown=Kb=>{2===Kb.tb&&Kb.lo===Sys.UI.MouseButton.leftButton&&
(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.ra.ed,ya.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.Zca=()=>{this.gridView.$.Xc(1983983164,2,30,null);return!0};this.$c=()=>{z.DOMElementExtensions.setVisible(this.Qaa,this.gridView.$.isEditMode)};this.Y6=()=>{z.DOMElementExtensions.setVisible(this.Qaa,!1)};this.X6=()=>{z.DOMElementExtensions.setVisible(this.Qaa,!0)};this.LEf=()=>{z.DOMElementExtensions.setVisible(this.Qaa,!1)};
this.KEf=()=>{z.DOMElementExtensions.setVisible(this.Qaa,!0)};this.sGb=(Kb,dc)=>{z.DOMElementExtensions.setVisible(this.Qaa,!dc.kpe)};this.gridView=hb;hb=document.createElement("div");hb.className=U.a.KCh;this.Qaa=hb;this.$c(null,null);la.appendChild(hb);x.a.instance.sa(r.a.pointerDown,this.Qaa,this.onPointerDown);L.a.instance.sa(r.a.Dk,this.Qaa,this.Zca);this.gridView.ha.e3(this.Pp);this.gridView.ha.WY(this.Cg);this.gridView.$.$k(this.$c);this.gridView.$.rb.m1b(this.Y6);this.gridView.$.rb.l1b(this.X6);
this.gridView.Rre(this.sGb);this.gridView.jc.Zk(this.LEf);this.gridView.jc.Qm(this.KEf)}dispose(){x.a.instance.Ba(r.a.pointerDown,this.Qaa,this.onPointerDown);L.a.instance.Ba(r.a.Dk,this.Qaa,this.Zca);this.gridView.$&&(this.gridView.ha.u7(this.Pp),this.gridView.ha.cX(this.Cg),this.gridView.$.ul(this.$c),this.gridView.$.rb.awc(this.Y6),this.gridView.$.rb.$vc(this.X6),this.gridView.EWf(this.sGb),this.gridView.jc.Uk(this.LEf),this.gridView.jc.fm(this.KEf));super.dispose()}}Object(t.a)(Ea,"FillHandleClickBehavior",
Q,[]);class Na extends T{constructor(la,hb){super(la);this.wYi=Kb=>{const dc=G.HelperMethods.Go(Kb);var sb=this.wwa.B3d(Kb.clientPoint);if(!sb)return!1;var bb=sb.je,Ob=this.wwa.Da.wxb(bb.hashCode).Pva(sb.iJ);if(!Ob)return!1;Kb=bb.Zi.domElement;sb=G.HelperMethods.Tqe(G.HelperMethods.Oxb(bb.domElement,Kb),sb.iJ);bb=0;Ob=this.wwa.Ub(Ob.getRange());for(let mb=0,Nb=Na.zCe.length;mb<Nb;++mb){const ic=Na.zCe[mb];if((128===ic||64===ic)&&this.wwa.$.isEditMode)continue;var gc=Ob.xLa(ic);if(!gc||!gc.k7a||"none"===
gc.k7a.style.display)continue;gc=gc.k7a;const gb=G.HelperMethods.Oxb(gc,Kb);gc=new Sys.UI.Bounds(gb.x,gb.y,gc.offsetWidth,gc.offsetHeight);if(M.a.PN(gc,sb)){bb=ic;break}}return 0!==bb?(Ob.invoke(bb,dc),!0):!1};this.Gxg=hb;L.a.instance.sa(r.a.click,la,this.wYi)}get wwa(){return this.Gxg}}Na.zCe=[1,2,32,256,128,64];Object(t.a)(Na,"IPadSelectionClickThroughBehavior",T,[]);var kb=a(22);class lb{constructor(la){this.eef=hb=>{this.IEc(hb.Gb,1);return!0};this.fef=hb=>{this.IEc(hb.Gb,-1);return!0};this.Cg=
()=>{this.msd=!1};this.Pp=()=>{this.msd=!0};this.gridView=la;this.J6a=0;this.msd=this.hjc=!1;this.d6=Number.NaN;this.gridView.ha.e3(this.Pp);this.gridView.ha.WY(this.Cg);this.gridView.ha.d1b(this.Cg)}dispose(){this.gridView.ha.u7(this.Pp);this.gridView.ha.cX(this.Cg);this.gridView.ha.IKb(this.Cg)}OAa(){this.J6a=0;this.hjc=!1;this.d6=Number.NaN}aPe(la){this.hjc=!0;this.IEc(la,1)}bPe(la){this.hjc=!1;this.IEc(la,-1)}IEc(la,hb){if(la)if(la.parentNode)if(this.msd)isNaN(this.d6)||(this.WEc(this.d6,!1),
this.d6=Number.NaN);else if(la=parseInt(la.parentNode.getAttribute(v.a.$6a),10),isNaN(la))n.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.d6)&&la!==this.d6){if(this.hjc)return;this.WEc(this.d6,!1)}if(isNaN(this.d6)||la!==this.d6)this.d6=la,this.J6a=0;!this.J6a&&0<hb&&this.WEc(la,!0);this.J6a=Math.max(this.J6a+hb,0);!this.J6a&&0>hb&&(this.WEc(la,!1),this.d6=Number.NaN)}else n.ULS.shipAssertTag(537159367,
0,!!la.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else n.ULS.shipAssertTag(537159368,0,!!la,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}WEc(la,hb){for(let dc=1;4>=dc;dc++){var Kb=this.gridView.qb.Gv(3,dc,la).zf;z.DOMElementExtensions.toggleCssClass(Kb,fa.gCh,hb);for(Kb=Kb.firstChild;Kb;Kb=Kb.nextSibling)kb.a.contains(Kb.className,"resizemarqueehandle",!0)&&z.DOMElementExtensions.toggleCssClass(Kb,fa.kCh,hb)}}}Object(t.a)(lb,"MarqueeHoveringManager",
null,[]);var oa=a(178),Ba=a(83),sa=a(825),qb=a(1238);class Jb extends T{constructor(la,hb){super(la);this.Wqc=()=>{if(!this.Fu)return n.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.Fu.ORf(this.DN,!1);this.Fu.TQe(this.DN,!1);if(3===this.Fu.model.state)return!0;this.Fu.bef(!0);return!0};this.fda=()=>{if(!this.Fu)return!1;this.Fu.z$i();this.Fu.fPd(this.DN,!1);if(3===this.Fu.model.state)return!0;this.Fu.bef(!1);return!0};
this.onPointerDown=Kb=>this.Fu?2===Kb.tb&&Kb.lo===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.PGb=()=>{if(!this.Fu)return!1;this.Fu.fPd(this.DN,!0);this.Fu.ORf(this.DN,!0);this.Fu.TQe(this.DN,!0);this.Fu.sMb(!0);return!0};this.onDoubleClick=Kb=>{if(Kb.Ca)return Kb.Ca.stopPropagation(),!0;n.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.Fu=Object(Ba.a)(qb.a,hb.metadata);this.EF=document.createElement("div");this.EF.id=
`${la.id}-${v.a.pCe}`;this.EF.className=sa.a.h2g;this.DN=document.createElement("div");this.DN.id=`${la.id}-${v.a.A2c}`;this.DN.className=sa.a.A2c;this.EF.appendChild(this.DN);la.appendChild(this.EF);n.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");x.a.instance.sa(r.a.IW,this.EF,this.Wqc);x.a.instance.sa(r.a.NB,this.EF,this.fda);x.a.instance.sa(r.a.pointerDown,this.EF,this.onPointerDown);oa.a.instance.sa(r.a.click,
this.EF,this.PGb);oa.a.instance.sa(r.a.Dk,this.EF,this.onDoubleClick);z.DOMElementExtensions.setVisible(this.EF,hb.isVisible)}dispose(){x.a.instance.Ba(r.a.IW,this.EF,this.Wqc);x.a.instance.Ba(r.a.NB,this.EF,this.fda);x.a.instance.Ba(r.a.pointerDown,this.EF,this.onPointerDown);oa.a.instance.Ba(r.a.click,this.EF,this.PGb);oa.a.instance.Ba(r.a.Dk,this.EF,this.onDoubleClick);z.DOMElementExtensions.tf(this.DN);this.DN=null;z.DOMElementExtensions.tf(this.EF);this.Fu=this.EF=null;super.dispose()}n_a(la){this.Fu=
Object(Ba.a)(qb.a,la.metadata);la.isVisible!==la.kya&&(this.Fu.gBj(la.isVisible?1:0),z.DOMElementExtensions.setVisible(this.EF,la.isVisible))}}Object(t.a)(Jb,"RangeCatchUpActivityHighlightBehavior",T,[]);class Yb extends W{constructor(la,hb,Kb,dc){super(la,hb,Kb,dc)}get j5(){return 16}get Ydb(){return this.gridView.ha.rangePicker.Zfd(!1)}BTa(){return(this.gridView.inRangePicker||this.gridView.ji)&&super.BTa()}}Object(t.a)(Yb,"RangePickerTouchGrippiesBehavior",W,[]);class jb extends T{constructor(la,
hb){super(la);const Kb=document.createElement("div"),dc=document.createElement("div");Kb.className=hb?fa.SCh:fa.UCh;dc.className=hb?fa.TCh:fa.RCh;la.appendChild(Kb);la.appendChild(dc)}}Object(t.a)(jb,"RearrangeHighlightBehavior",T,[]);var ab;(function(la){la[la.topLeft=0]="topLeft";la[la.topRight=1]="topRight";la[la.bottomLeft=2]="bottomLeft";la[la.bottomRight=3]="bottomRight";la[la.error=4]="error"})(ab||(ab={}));Object(t.b)("Corner",ab);class vb extends T{constructor(la,hb,Kb,dc,sb){super(la);this.eb=
this.pG=null;this.X3=0;this.hb=this.sourceRange=null;this.nUa=!1;this.onPointerDown=bb=>{bb=Y.a(this.$).Vd(bb);if(this.H8f(bb)&&!this.nUa){this.stf();this.eb=this.yo.lcc();this.pG=this.yo.m8e(bb);if(!this.eb||!this.pG||!this.pG.range)return n.ULS.shipAssertTag(537159361,0,!!this.eb,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),n.ULS.shipAssertTag(537159360,0,!!this.pG,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),n.ULS.shipAssertTag(537159331,0,
!!this.pG.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.hb=this.pG.range.clone();this.sourceRange=this.hb.clone();this.X3=this.e4e(bb);if(4===this.X3)return n.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Ob=this.X5e(bb,!0);if(!Ob)return n.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;
if(!this.CJe(Ob))return n.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.RMa=!0;this.eb.XE(!1);this.VF.aPe(bb.Gb);this.yo.uRf(!0,this.Bba.xU);this.eb.textBox.removeSelection();this.eb.P0b(this.Paf);this.KUf();this.nUa=!0;Ca.b(this.$,!0)}return!0};this.Hh=bb=>{bb=Y.a(this.$).Vd(bb);bb=this.X5e(bb,!1);if(!bb)return!0;bb=this.CJe(bb);if(!bb)return n.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),
this.jbc(!0),!1;if(this.hb.equals(bb))return!0;this.hb=bb;bb=this.Zy();bb||(n.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.jbc(!0));return bb};this.Qf=bb=>{Y.a(this.$).Vd(bb);bb=this.sG();n.ULS.shipAssertTag(537159325,0,bb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.jbc(!bb);return bb};this.Paf=()=>{this.jbc(!0)};this.gridView=hb;this.$=hb.$;this.zL=[];this.ha=this.gridView.ha;this.VF=Kb;this.yo=dc;this.Bba=
sb;this.coloredReferencesManager=this.$.da.Aa(281);n.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.vB=y.a.vB(this.$))hb=this.$.da.Aa(464),n.ULS.shipAssertTag(510255176,0,!!hb,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.jB=hb.jB;for(const bb of this.XZf())hb=this.yo.PIe(la,
bb,this.Dte(),this.onPointerDown),this.zL.push(hb);for(const bb of this.zL)x.a.instance.sa(r.a.IW,bb,this.VF.eef),x.a.instance.sa(r.a.NB,bb,this.VF.fef);this.n_a(sb)}dispose(){this.zL.forEach(la=>{x.a.instance.Ba(r.a.pointerDown,la,this.onPointerDown)});this.zL.length=0;super.dispose()}n_a(la){this.Bba=la;this.Mte(la);this.yo.nNb(la,this.zL,this.CVd());this.VF.OAa()}X5e(la,hb){const Kb=la.Gb;la=la.clientPoint;if(!Kb||!la)return n.ULS.shipAssertTag(537159324,0,!!Kb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),
n.ULS.shipAssertTag(537159323,0,!!la,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;hb&&(la=this.sxf(la));hb=this.ha.mo(la,Kb,0,!0,!1,!0);hb||(la=this.sxf(la),hb=this.ha.mo(la,Kb,0,!0,!1,!0));return hb}sxf(la){la.y+=0===this.X3||1===this.X3?2:-2;la.x+=0===this.X3||2===this.X3?2:-2;return la}CJe(la){if(!la||!this.sourceRange)return n.ULS.shipAssertTag(537159322,0,!!la,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),n.ULS.shipAssertTag(537159321,0,!!this.sourceRange,
"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.X3)return new ja.Range(la.top,la.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.X3)return new ja.Range(la.top,this.sourceRange.left,this.sourceRange.bottom,la.right,!0,!1);if(2===this.X3)return new ja.Range(this.sourceRange.top,la.left,la.bottom,this.sourceRange.right,!0,!1);if(3===this.X3)return new ja.Range(this.sourceRange.top,this.sourceRange.left,la.bottom,la.right,!0,!1);n.ULS.shipAssertTag(537159320,
0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${ab[this.X3]}`);return null}sG(){return this.vB?this.jB.eFb(this.eb,this.pG,this.hb):this.coloredReferencesManager.eFb(this.eb,this.pG,this.hb)}Zy(){return this.sG()}jbc(la){la&&n.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.VF.bPe(this.zL[0]);this.yo.uRf(!1,this.Bba.xU);this.eb.textBox.setCaretPositionToEnd();
this.eb.Jvc(this.Paf);this.Cig();this.nUa=this.gridView.RMa=!1;Ca.b(this.$,!1);this.yo.lTf()}}Object(t.a)(vb,"ResizeMarqueeBehaviorBase",T,[]);class Da extends vb{constructor(la,hb,Kb,dc,sb){super(la,hb,Kb,dc,sb)}XZf(){return[fa.YCh,fa.ZCh,fa.WCh,fa.XCh]}Dte(){return[fa.VCh]}e4e(la){la=la.Gb;if(la===this.zL[0])return 0;if(la===this.zL[1])return 1;if(la===this.zL[2])return 2;if(la===this.zL[3])return 3;n.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}KUf(){this.yo.ix(this.Hh,this.Qf,!0)}Cig(){this.yo.r1d(this.Hh,this.Qf,!0)}H8f(la){return 2===(C.a.Db=la.tb)&&la.lo===Sys.UI.MouseButton.leftButton}CVd(){return!0}stf(){n.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}Mte(la){for(const hb of this.zL)hb.style.backgroundColor=la.zf.style.borderColor}}Object(t.a)(Da,"ResizeMarqueeMouseBehavior",vb,[]);class Fa extends vb{constructor(la,hb,Kb,dc,sb){super(la,hb,Kb,
dc,sb);this.KGb=()=>{const bb=3===C.a.Db;this.Zvd&&!bb?this.yo.nNb(this.Bba,this.zL,!1):!this.Zvd&&bb&&this.yo.nNb(this.Bba,this.zL,!0);this.Zvd=bb};this.CXi=(bb,Ob)=>{Ob.$6a===this.Bba.xU&&this.yo.nNb(this.Bba,this.zL,!Ob.start&&this.CVd())};C.a.yse(this.KGb);this.Zvd=3===C.a.Db;this.yo.ONg(this.CXi)}dispose(){C.a.fXf(this.KGb);super.dispose()}XZf(){return[U.a.$Bh,U.a.ZBh]}Dte(){const la=!K.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[la?U.a.xWe:U.a.wWe,U.a.fac,la?U.a.YBh:
U.a.eac]}e4e(la){la=la.Gb;if(la===this.zL[0])return 0;if(la===this.zL[1])return 3;n.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}KUf(){l.a.Lw?this.yo.ix(this.Hh,this.Qf,!1):this.yo.Eej(this.Hh,this.Qf)}Cig(){l.a.Lw?this.yo.r1d(this.Hh,this.Qf,!1):this.yo.UWj(this.Hh,this.Qf)}H8f(la){return 3===(C.a.Db=la.tb)}CVd(){return 3===C.a.Db}stf(){n.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}Mte(){}}
Object(t.a)(Fa,"ResizeMarqueeTouchBehavior",vb,[]);class nb extends T{constructor(la,hb){super(la);nb.Ysb(la,S.a.pCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.horizontal);nb.Ysb(la,S.a.oCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.vertical);nb.Ysb(la,S.a.lCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.horizontal);nb.Ysb(la,S.a.nCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.vertical);nb.Ysb(la,U.a.mCh)}static Ysb(la,hb,Kb){const dc=document.createElement("div");dc.className=hb;Kb&&(dc.style.backgroundImage=
`url("${Kb}")`);la.appendChild(dc)}}Object(t.a)(nb,"SelectionCutCopyBehavior",T,[]);class Ta extends T{constructor(la){super(la);appChrome.renderSpinner(la)}}Object(t.a)(Ta,"SelectionPasteBehavior",T,[]);class V extends T{constructor(la,hb){super(la);V.otb(la,S.a.QCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.horizontal);V.otb(la,S.a.PCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.vertical);V.otb(la,S.a.MCh+" "+U.a.cva,null===hb||void 0===hb?void 0:hb.horizontal);V.otb(la,S.a.OCh+" "+U.a.cva,null===
hb||void 0===hb?void 0:hb.vertical);V.otb(la,U.a.NCh)}static otb(la,hb,Kb){const dc=document.createElement("div");dc.className=hb;Kb&&(dc.style.backgroundImage=`url("${Kb}")`);la.appendChild(dc)}}Object(t.a)(V,"SelectionRangePickerBehavior",T,[]);class va extends W{constructor(la,hb,Kb,dc){super(la,hb,Kb,dc)}get j5(){return 0}get Ydb(){return this.gridView.ha.ra.ed}BTa(){const la=this.gridView.ji||this.gridView.gb;return this.gridView.ha.ra.Pg&&!la&&super.BTa()}}Object(t.a)(va,"SelectionTouchGrippiesBehavior",
W,[]);var wb=a(52);class fc extends w.a{constructor(la,hb){super();this.jqb=(Kb,dc)=>{Kb=dc.j5;const sb=this.gridView;dc=dc.xci;const bb=dc.zf,Ob=dc.D$;l.a.$g&&Ob.push(new Na(bb,sb));switch(Kb){case 24:dc.D$.push(new Jb(bb,dc));break;case 0:dc.D$.push(new Ea(bb,sb));l.a.Hp||(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(Ob.push(new Qb(bb,this.gridView.$,dc.paneType,this.tableManager,this.yo)),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&Ob.push(new Ma(bb,this.gridView.$,dc.paneType,this.tableManager,this.yo))):Ob.push(new Ab(bb,this.gridView.$,dc.paneType,this.tableManager,this.yo)));Ob.push(new va(dc,bb,sb,dc.paneType));break;case 3:Ob.push(new Q(bb));l.a.Hp||(Ob.push(new Ya(bb,this.gridView.$,dc.paneType,this.VF,this.yo,dc)),Ob.push(new Da(bb,this.gridView,this.VF,this.yo,dc)),Ob.push(new Fa(bb,this.gridView,this.VF,this.yo,dc)));break;case 4:case 5:Ob.push(new nb(bb,this.Yue));break;case 30:Ob.push(new Ta(bb));break;case 16:Ob.push(new V(bb,
this.Yue));Ob.push(new Yb(dc,bb,sb,dc.paneType));break;case 11:case 12:Ob.push(new jb(bb,11===Kb));break;case 17:Ob.push(new Q(bb));break;case 19:Ob.push(new Q(bb)),Ob.push(new X(dc,bb,sb,dc.paneType))}dc.R2b=!0};this.$=la;this.gridView=ia.h(la);this.tableManager=hb;this.VF=new lb(this.gridView);this.yo=new D(this.gridView);this.gridView.qb&&(this.gridView.qb.jNg(this.jqb),this.gridView.qb.update(!1));la.da.Ga(64,this)}get Yue(){K.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.Xue&&(this.Xue={vertical:wb.a.current.io(105),horizontal:wb.a.current.io(106)});return this.Xue}dispose(){this.gridView.qb.Pij(this.jqb);this.VF&&(this.VF.dispose(),this.VF=null);super.dispose()}}Object(t.a)(fc,"GridHighlightsBehaviorManager",w.a,[]);class Fc extends b.a{constructor(la){super();this.$=la;this.Fb()}create(){m.TaskExtensions.za(h.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),la=>{this.ob(this.$.da.Aa(64)||new fc(this.$,la.result))},this.ka,3)}static la(la){la.da.Ga(149,
new Fc(la))}}Object(t.a)(Fc,"GridHighlightsBehaviorManagerFactory",b.a,[]);a.d(E,"a",function(){return Qa});const Qa=()=>{c.a.Fa(Fc.la);c.a.Fa(d.la)}},1150:function(t,E,a){var c=a(9);t=a(0);var b=a(695),e=a(48),f=a(37),d=a(184),h=a(55);class m{constructor(Qa){this.cqh=Qa}nc(){return!1}executeCommand(Qa,la){Qa=la.command;la=null;switch(Qa){case 1243860697:this.cqh.hSj();break;default:la=d.a(Qa)}return la||h.Task.Ra(!0)}yc(Qa,la){return 1243860697===la.command}Lc(){return!1}}Object(t.a)(m,"SheetDropdownMenuCommandHandler",
null,[219]);class l extends b.a{constructor(Qa){super(Qa)}ld(){this.$.qy(Qa=>{Qa.Ygc().then(()=>{f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,32,33,this.Ya),la=>{this.Zc([new m(la.result.OCj)])},this.$.ka)})})}static la(Qa){b.a.Nd(392,new l(Qa))}}Object(t.a)(l,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var w=a(222),n=a(5),x=a(74),r=a(33),u=a(1),v=a(15),B=a(27),z=a(178),A=a(14),y=a(89),D=a(45),I=a(240),M=a(155),T=a(108),S=a(39),H=a(419),C=a(83),G=a(13),J=a(35);class L{constructor(){this.GNe=
new J.a(!0);this.HKc=0}get H9c(){return this.HKc}get navigationButtonsDisabled(){return!!(this.H9c&1)}get operationButtonsDisabled(){return!!(this.H9c&2)}BSg(Qa,la){this.GNe.add(Qa,la);this.VS()}VS(){this.HKc=0;J.a.forEach(this.GNe.Lu,Qa=>{this.HKc=this.H9c|Qa.value})}}Object(t.a)(L,"SheetTabBarDisabledStateManager",null,[]);var P=a(238),aa=a(31);class U{}U.lzh="ewa-stb-uir";U.aUe="ewa-stb-drag";U.Wyh="ewa-stb-navarea";U.Xyh="ewa-stb-navarea-dimensions";U.Zyh="ewa-stb-navbutton";U.FU="cui-disabled";
U.Yyh="ewa-stb-navareaextra";U.Kia="cui-img-container";U.Qyh="ewa-stb-contentarea";U.bUe="ewa-stb-left-scrollable";U.mUe="ewa-stb-right-scrollable";U.jzh="ewa-stb-tabarea";U.izh="ewa-stb-sheettabmoveindicator";U.oUe="ewa-stb-tabs";U.SOj="tab-active";U.$Oj="tab-inactive";U.ZOj="tab-hover";U.kzh="ewa-stb-tabs-ghost";U.UOj="tab-anchor-text";U.dark="dark";U.light="light";U.TOj="tab-active-text";U.XOj="tab-content-container";U.bPj="tab-text";U.bzh="ewa-stb-nsv-inactive";U.czh="ewa-stb-nsv-inactive-svg";
U.$yh="ewa-stb-nsv-active";U.azh="ewa-stb-nsv-active-svg";U.Mxh="ewa_nsv_margin";U.Ryh="ewa-stb-disable-scrollbar";U.Iyi="leave-size-fixed-on-tab-hover-old";U.Hyi="leave-size-fixed-on-tab-hover";U.fUe="ewa-stb-locked-sheet";U.gUe="ewa-stb-locked-sheet-svg-16px";U.Syh="ewa-stb-dropdown-menu-button";U.tuh="ewa-active-sheet-menu-item";Object(t.a)(U,"CssClassNames",null,[]);var K=a(735),Y=a(19),na=a(260),W=a(102),X=a(188),Aa=a(248),Q=a(46),fa=a(287),Ca=a(52),ia=a(12),Ra=a(71),Ya=a(320),Ga=a(11),da=a(100),
Z=a(350),ha=a(21),Wa=a(191),ca=a(375),ja=a(371),ua=a(44),Za=a(224),Pa=a(85);class ka extends P.a{constructor(Qa,la,hb=!1){super(Qa);this.Nbb=this.bta=null;this.$=la;this.kY=hb}get disabled(){return this.kY}dispose(){this.Nbb=this.bta=this.$=null;super.dispose()}NS(Qa){this.kY=Qa;this.domElement.setAttribute(n.a.Osa,Qa.toString());ia.DOMElementExtensions.toggleCssClass(this.domElement,K.a.FU,Qa)}}Object(t.a)(ka,"SheetBarButton",P.a,[]);var ra=a(711);class ba extends ka{constructor(Qa,la,hb,Kb=!1){super(document.createElement("a"),
la,Kb);this.fd=dc=>{this.disabled||this.$.Xc(-1935155518,dc.tb,30,null);return!0};this.RGb=dc=>{dc="mouseover"===dc.type||"focus"===dc.type;const sb=ca.a(this.$)?this.Nbb:this.bta;Ga.HelperMethods.A_d(sb,this.Wha,this.Wha+n.a.Cgc,dc&&!ha.h(this.$).inRangePicker)};this.Th=()=>{this.NS(!0)};this.jg=()=>{this.NS(!1)};this.Wha=u.EwaSettings.oa(469)?Y.a.Jbd:Y.a.XUe;this.bta=hb.pb(this.domElement,G.a.instance.ga(509),0,this.Wha,G.a.instance.ga(510),ra.a.W4c,Kb);Qa.appendChild(this.domElement);this.Gc.la("contextmenu",
dc=>{Ra.g(dc)});u.EwaSettings.oa(469)||(this.Gc.la("mouseover",this.RGb),this.Gc.la("mouseout",this.RGb));Za.a.instance.sa(A.a.click,this.domElement,this.fd);this.Nla=T.KeyInputManager.instance.Qs(this.domElement,this.fd,Pa.a.Kh,Pa.a.QX);ha.h(this.$).jc.Zk(this.Th);ha.h(this.$).jc.Qm(this.jg)}dispose(){Za.a.instance.Ba(A.a.click,this.domElement,this.fd);T.KeyInputManager.instance.Xv(this.domElement,this.Nla);ha.h(this.$)&&ha.h(this.$).jc&&(ha.h(this.$).jc.Uk(this.Th),ha.h(this.$).jc.fm(this.jg));
super.dispose()}NS(Qa){const la=ba.E8f(this.$);super.NS(Qa||la)}static E8f(Qa){return!Qa.isEditMode||!Qa.va.count}}Object(t.a)(ba,"InsertSheetButton",ka,[]);class Ua extends ka{constructor(Qa,la,hb){super(document.createElement("a"),la);this.fd=Kb=>{this.$.Xc(-684145703,Kb.tb,0,null);return!0};this.RGb=Kb=>{Ga.HelperMethods.A_d(this.oAe,this.Wha,this.Wha+n.a.Cgc,("mouseover"===Kb.type||"focus"===Kb.type)&&!ha.h(this.$).inRangePicker)};this.$=la;this.Wha=u.EwaSettings.oa(469)?Y.a.Jbd:Y.a.XUe;this.oAe=
hb.pb(this.domElement,G.a.instance.ga(511),0,this.Wha,G.a.instance.ga(512),ra.a.W4c);Qa.appendChild(this.domElement);this.Gc.la("contextmenu",Kb=>{Ra.g(Kb)});this.Gc.la("mouseover",this.RGb);this.Gc.la("mouseout",this.RGb);Za.a.instance.sa(A.a.click,this.domElement,this.fd);this.Nla=T.KeyInputManager.instance.Qs(this.domElement,this.fd,Pa.a.Kh,Pa.a.QX)}dispose(){Za.a.instance.Ba(A.a.click,this.domElement,this.fd);T.KeyInputManager.instance.Xv(this.domElement,this.Nla);this.oAe=null;super.dispose()}}
Object(t.a)(Ua,"InsertTemplateButton",ka,[]);class Ka{constructor(Qa,la){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Qa;this.newSheetIndex=la}getSheetName(){return this.sheetName}}Object(t.a)(Ka,"MacroRecorderSheetReorderedPayload",null,[145]);var Oa=a(92);class ib extends P.a{constructor(Qa,la){super(document.createElement("div"));this.UR=()=>{v.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.dYf(!1,"OnSheetsChanged")};this.mQi=()=>{this.Oj()};this.lQi=()=>{this.gk()};
this.$=Qa;this.APj=la;this.hV=!1;this.fQb=0}dispose(){this.gk();super.dispose()}hSj(){this.dYf(!0,"TogglerSheetDropdownMenu")}dYf(Qa,la){v.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${la}, toggle: ${Qa}, toggleStateId: ${this.fQb}`);Qa&&(this.fQb+=1);const hb=this.$.Kb.Cc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${la}, toggle: ${Qa}, toggleStateId: ${this.fQb}, sheetCount: ${this.$.va.count}`);Qa=this.ahh();appChrome.renderSheetDropdownMenu(this.domElement,
this.APj,Qa,this.fQb,this.mQi,this.lQi,()=>{hb.stop()},ca.a(this.$))}ahh(){const Qa=this.$.va,la=[];for(let Kb=0;Kb<Qa.count;Kb++){var hb=Object(C.a)(da.a,Qa.getItem(Kb));0===hb.UB&&(hb=this.$gh(hb),la.push(hb))}return la}$gh(Qa){const la={};la.key=Qa.name;la.text=Qa.name;la.onClick=this.bhh(Qa);Qa.active&&(la.className=ca.a(this.$)?"ewa-active-sheet-menu-item-present-mode":U.tuh);return la}bhh(Qa){return()=>{const la=new Oa.a(-1876836819,0,this.$.Hc,30,null);this.$.Ka.Lb(la,{[n.a.HUd]:Qa.name})}}Oj(){if(!this.hV){const Qa=
this.$.va;Qa.Wf(this.UR);Qa.ZXc(this.UR);Qa.VY(this.UR);Qa.tha(this.UR);Qa.PGa(this.UR);Qa.vse(this.UR);Qa.a_a(this.UR);this.hV=!0}}gk(){if(this.hV){const Qa=this.$.va;Qa.Dg(this.UR);Qa.bNd(this.UR);Qa.t7(this.UR);Qa.zna(this.UR);Qa.KRa(this.UR);Qa.dXf(this.UR);Qa.AKb(this.UR);this.hV=!1}}}Object(t.a)(ib,"SheetDropdownMenu",P.a,[896,3]);var La=a(354);class db extends ka{constructor(Qa,la,hb){super(document.createElement("a"),Qa,!0);this.sg=()=>{this.NS(!1);this.$.ea.Pn(this.sg)};this.fd=Kb=>{this.Jfg(Kb.tb);
return!0};this.onKeyDown=Kb=>13===Kb.Ca.keyCode||32===Kb.Ca.keyCode?(this.Jfg(Kb.tb),!0):!1;this.bta=la.pb(this.domElement,G.a.instance.ga(513),0,Y.a.Pyh,G.a.instance.ga(513),ra.a.b8h,this.disabled);this.domElement.classList.add(U.Syh);hb.appendChild(this.domElement);this.gsh();this.mej()}dispose(){this.PWj();super.dispose()}NS(Qa){super.NS(Qa||!this.$.ea.kla)}gsh(){const Qa=this.$.ea;Qa.Yf?this.NS(!1):Qa.Lk(this.sg)}Jfg(Qa){this.disabled||(v.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${La.a[Qa]}`),
this.$.Ka.Lb(new Oa.a(1243860697,Qa,this.$.Hc,30,null)))}mej(){Za.a.instance.sa(A.a.click,this.domElement,this.fd);T.KeyInputManager.instance.sa(A.a.Pb,this.domElement,this.onKeyDown)}PWj(){Za.a.instance.Ba(A.a.click,this.domElement,this.fd);T.KeyInputManager.instance.Ba(A.a.Pb,this.domElement,this.onKeyDown)}}Object(t.a)(db,"SheetDropdownMenuAnchor",ka,[]);var Ab=a(60);const Mb=(Qa,la,hb,Kb,dc,sb,bb,Ob=null)=>{Ob=Qa.Oa(9,Ob);Ob.sheetName=la;Ob.newSheetIndex=hb;return Ab.g(Qa,"ReorderSheets",Ob,Kb,
dc,sb,bb,0)};var pb=a(173),Qb=a(129),xb=a(187),pa=a(131),Ma=a(59),ya=a(208),Ea=a(199),Na=a(167),kb=a(132);class lb{constructor(Qa,la,hb){this.ym=la;this.Ow=hb;this.sheet=Qa;this.altText=G.a.instance.ga(1988)}PK(){return this.sheet.active}gsd(){return this.sheet.isLockPausedInSession}pta(){return this.ym?Y.a.eUe:this.PK()?Y.a.dUe:Y.a.cUe}Moa(){return this.sheet.li?ra.a.BQf:ra.a.CWj}iZd(){return 16}jia(){return null}qta(){return this.ym?this.Ow?U.gUe:U.fUe:null}K_d(){return null}Ws(){return null}pod(){return 0}GZc(){return!0}}
Object(t.a)(lb,"LockPausedSheetIconDataSource",null,[905]);class oa{constructor(Qa,la,hb){this.ym=la;this.Ow=hb;this.sheet=Qa;this.altText=G.a.instance.ga(1987)}PK(){return this.sheet.active}gsd(){return this.sheet.li}pta(){return this.ym?Y.a.eUe:this.PK()?Y.a.dUe:Y.a.cUe}Moa(){return ra.a.BQf}iZd(){return 16}jia(){return null}qta(){return this.ym?this.Ow?U.gUe:U.fUe:null}K_d(){return null}Ws(){return null}pod(){return 0}GZc(){return!0}}Object(t.a)(oa,"LockedSheetIconDataSource",null,[905]);class Ba{constructor(Qa,
la,hb,Kb){this.sheet=Qa;this.altText=G.a.instance.ga(1899);this.vSj=la;this.B9f=hb;this.Ow=Kb}PK(){return this.sheet.active}gsd(){return this.sheet.Hd.Kv}jia(){return this.Ow?this.PK()?U.azh:U.czh:this.PK()?U.$yh:U.bzh}pta(){return!this.PK()&&this.B9f()?Y.a.OAh:Y.a.NAh}Moa(){return!this.PK()&&this.B9f()?ra.a.ZCj:ra.a.YCj}iZd(){return 14}qta(){return U.Mxh}K_d(){return this.sheet.Hd.lob}Ws(){return this.vSj}pod(){return 8}GZc(){return!1}}Object(t.a)(Ba,"NamedSeetViewSheetIconDataSource",null,[905]);
var sa=a(156),qb=a(128);class Jb{constructor(Qa,la){this.cra=this.h2=this.VBa=this.Il=null;this.cmf=!1;this.wUc=this.Moa=this.qta=this.jia=this.pta=null;this.oO=()=>{this.dataSource.PK()&&f.TaskExtensions.za(this.YDb,()=>{dialogControls.renderToolTip(this.dataSource.Ws(),"SheetIconTooltip",this.dataSource.K_d(),this.YI,10,!1,!1,1)},this.$.ka,3)};this.nO=()=>{this.dataSource.PK()&&this.clearToolTip()};this.$=Qa;this.dataSource=la;this.Ow=r.a.Mtd()}get Gc(){return this.h2||(this.h2=qb.a.instance.oe(this.YI))}get YDb(){if(this.cra)return this.cra;
const Qa=new sa.a;this.$.qy(la=>{f.TaskExtensions.za(la.gxd(),()=>{Qa.setResult(!0)},this.$.ka,3)});return this.cra=Qa.task}get YI(){return this.wUc}Xjg(){if(this.YI&&(this.Il||this.VBa)){if(this.Ow){var Qa=this.dataSource.Moa();this.Moa!==Qa&&(this.VBa&&this.VBa.parentNode.removeChild(this.VBa),this.rgf(),this.Moa=Qa)}else Qa=this.dataSource.pta(),this.pta!==Qa&&(this.gOd(this.Il,this.pta,Qa),this.pta=Qa);Qa=this.dataSource.jia();this.jia!==Qa&&(this.Ow?this.mlj(this.VBa,this.jia,Qa):this.gOd(this.Il,
this.jia,Qa),this.jia=Qa);Qa=this.dataSource.qta();this.qta!==Qa&&(this.gOd(this.YI,this.qta,Qa),this.qta=Qa);this.dataSource.Ws()&&!this.dataSource.PK()&&this.clearToolTip()}}GHj(Qa,la,hb){this.Ehi(Qa,la,hb);ia.DOMElementExtensions.setVisible(this.YI,this.dataSource.gsd())}clearToolTip(){f.TaskExtensions.za(this.YDb,()=>{dialogControls.clearToolTip(this.dataSource.Ws())},this.$.ka,3)}Ehi(Qa,la,hb){this.YI&&this.cmf!==Qa&&(this.YI.parentNode.removeChild(this.YI),this.qta=this.jia=this.Moa=this.pta=
this.wUc=null,this.dataSource.Ws()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.YI||(this.wUc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.YI,K.a.Kia),Sys.UI.DomElement.addCssClass(this.YI,Y.a.fs),u.EwaSettings.oa(469)?Qa===this.dataSource.GZc()?la.appendChild(this.YI):la.insertBefore(this.YI,hb):Qa?la.insertBefore(this.YI,hb):la.appendChild(this.YI),this.Ow?this.rgf():(this.Il=document.createElement("img"),this.Il.tabIndex=-1,this.Il.alt=this.dataSource.altText,
this.YI.appendChild(this.Il),this.Il.src=Ca.a.de(this.dataSource.pod())),this.dataSource.Ws()&&(this.Gc.la("mouseover",this.oO,!0),this.Gc.la("mouseout",this.nO,!0)),this.cmf=Qa)}mlj(Qa,la,hb){Qa&&(Sys.UI.DomElement.removeCssClass(Qa,la),Sys.UI.DomElement.addCssClass(Qa,hb))}gOd(Qa,la,hb){la&&Sys.UI.DomElement.removeCssClass(Qa,la);hb&&Sys.UI.DomElement.addCssClass(Qa,hb)}dispose(){y.a.Ia(this.h2)}rgf(){const Qa=this.$.da.Aa(388);Qa?(this.VBa=Qa.ska(this.dataSource.Moa(),this.dataSource.iZd()))?this.YI.appendChild(this.VBa):
v.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Moa()} was not found.`):v.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(t.a)(Jb,"SheetIcon",null,[3]);var Yb=a(355),jb=a(95),ab=a(153);class vb extends jb.a{constructor(Qa,la){super(Qa.domElement);this.onKeyDown=hb=>{121===hb.keyCode&&hb.shiftKey&&!this.qoa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.qoa.anchor),
Ra.g(hb))};this.Zca=hb=>{if(!this.$.isEditMode||this.qoa.disabled)return!0;this.rename(!1,hb.tb);return!0};this.am=hb=>this.qoa.disabled?!0:this.showContextMenu(hb.clientPoint,hb.tb,hb.Gb);this.ule=Qa;this.$=la;Za.a.instance.sa(A.a.Dk,Qa.domElement,this.Zca);Yb.a.instance.sa(Qa.domElement,this.am);this.Gc.la("keydown",this.onKeyDown)}get qoa(){return this.ule}dispose(){this.qoa&&(Za.a.instance.Ba(A.a.Dk,this.qoa.domElement,this.Zca),Yb.a.instance.Ba(this.qoa.domElement,this.am),this.ule=null);this.$=
null;super.dispose()}showContextMenu(Qa,la,hb){this.qoa.activate(la,r.a.zud());la=new Oa.a(-1075099431,la,this.$.Hc,30,null);let Kb;return!ab.a(Kb=this.$.Ka.Lb(la,{[n.a.e8f]:Qa,[vb.PCj]:this.qoa.sheet,[n.a.f8f]:hb}))&&(6!==Kb.status||Kb.result)}rename(Qa,la){this.$.Xc(817296323,la,Qa?19:0,null)}}vb.PCj="Sheet";Object(t.a)(vb,"SheetOpsSheetClickHelper",jb.a,[]);var Da=a(41);class Fa extends ka{constructor(Qa,la,hb,Kb,dc,sb,bb){super(document.createElement("li"),Qa);this.u4c=this.t4c=this.d8f=this.c8f=
0;this.Y7c=.5;this.hV=this.FUd=!1;this.color=this.tKc=this.hF=this.qFb=this.lP=null;this.$jc=this.Wkf=!1;this.I7b="#BEBBB8";this.QHc=null;this.onKeyDown=Ob=>13!==Ob.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Tz=Ob=>32!==Ob.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.oO=()=>{this.disabled||(this.BS.VYi(this),this.BS.RF||this.ioa(!0,void 0,"OnMouseOver"))};this.nO=()=>{this.disabled||this.ioa(!1,void 0,"OnMouseOut")};this.QGb=()=>{this.BS.RF||(this.gMj(),this.sheet.h1||
ha.h(this.$).jLb(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.P6=()=>{this.IQe(!1);return!1};this.fd=Ob=>{if(this.disabled)return!0;const gc=ha.h(this.$);this.sheet.active||3!==Ob.tb?this.ym?this.activateSheet(Ob.tb):r.a.zud()&&gc.focus():(!r.a.jOa(this.$)&&!this.GCb||gc.gb||gc.ji||gc.lub(),this.activateSheet(Ob.tb));return 3!==Ob.tb};this.onPointerDown=Ob=>{if(this.disabled)return!0;this.IQe(!0);ha.h(this.$).inRangePicker&&v.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var gc=3===Ob.tb;if(2===Ob.tb||gc&&this.Oxa)this.ym?(this.ioa(!0,!gc,"OnPointerDown"),gc=h.Task.delay(gc?this.d8f:this.c8f).np(()=>!0)):gc=this.activateSheet(Ob.tb),this.$Bb&&(this.$jc=!0,this.BS.lwc=f.TaskExtensions.za(gc,()=>{this.$jc&&this.BS.XYi(this,Ob)},this.ka,11));return!1};this.Qf=Ob=>{if(this.disabled||!this.$Bb&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;const gc=this.BS.RF&&!r.a.nlf();this.$jc=!1;this.ym&&this.ioa(2===Ob.tb,void 0,"OnPointerUp");
this.BS.lwc&&(f.TaskExtensions.za(this.BS.lwc,()=>{this.BS.WYi(this)},this.ka,11),this.BS.lwc=null);return gc};this.sO=()=>{this.$jc=!1;this.FUd||this.ioa(!1,void 0,"OnTouchMove");return!1};this.uEe=new vb(this,Qa);this.ym=sb;this.Ow=bb;this.GCb=r.a.GCb(Qa);this.crd=u.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.Ow;this.ym?(this.c8f=Qa.ya.SheetDragReorderDelayInMilliseconds,this.d8f=Qa.ya.SheetDragReorderDelayInMillisecondsForTouch,this.t4c=18,this.u4c=20):(this.t4c=
19,this.u4c=22);this.$=Qa;this.PYb=Kb;this.BS=dc;this.$Bb=dc.rue();this.lhh();this.ebh();this.Rnd=Qa.Kb.Qg("UserAction",this.name);this.fsd=!1;ia.DOMElementExtensions.Yt(this.domElement,n.a.Oq,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.hF);this.ooa=new xb.a;Qa=new oa(this.sheet,this.ym,this.Ow);this.ooa.add(new Jb(this.$,Qa));this.$.ea.FNb&&(Qa=new lb(this.sheet,this.ym,this.Ow),this.ooa.add(new Jb(this.$,Qa)));this.crd||(Qa=new Ba(this.sheet,this.BS.Tzc,()=>
this.color?Fa.NVd(this.color):!1,this.Ow),this.qFb=new Jb(this.$,Qa),this.ooa.add(this.qFb));this.Oxa=this.BS.Oxa;this.ihb();this.Cfj();this.wze=new fa.a(this.domElement,1);la.insertBefore(this.domElement,hb);ca.a(this.$)&&this.Rkg(!0)}get Mkh(){return this.tKc||(this.tKc=Ea.a.yp("#F5F5F5"))}get name(){return this.lP.innerText}set name(Qa){this.lP&&(this.lP.innerText=Qa,this.vEc(),this.Skg())}get sheet(){return this.PYb}get anchor(){return this.QHc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Qa){this.anchor.tabIndex=
Qa}pVh(){return ia.DOMElementExtensions.Hf(this.anchor)?this.anchor:null}dispose(){if(this.hV){I.a.instance.Ba(A.a.pointerDown,this.domElement,this.onPointerDown);T.KeyInputManager.instance.Ba(A.a.Pb,this.domElement,this.onKeyDown);T.KeyInputManager.instance.Ba(A.a.Ip,this.domElement,this.Tz);Za.a.instance.Ba(A.a.click,this.domElement,this.fd);I.a.instance.Ba(A.a.IW,this.domElement,this.QGb);I.a.instance.Ba(A.a.NB,this.domElement,this.P6);if(this.$Bb||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))I.a.instance.Ba(A.a.Rf,
this.domElement,this.Qf),this.Oxa&&(M.a.instance.Ba(A.a.we,this.domElement,this.Qf),M.a.instance.Ba(A.a.$f,this.domElement,this.sO));this.hV=!1;this.I7b="#BEBBB8"}y.a.rc([this.uEe,this.wze]);this.lP=this.hF=this.QHc=this.BS=this.wze=this.uEe=null;if(this.ooa){for(let Qa of this.ooa)Qa.dispose();this.ooa=null}this.color=this.PYb=null;super.dispose()}NS(Qa){Qa&&this.ioa(!1,!1);super.NS(Qa)}uWd(Qa){if(Ma.a.Ag.pR){this.MNe();var la=e.GetServiceTaskFactory.Na(this.$.da,322,323,1);f.TaskExtensions.za(la,
hb=>{pb.UISurfaces.QH().then(Kb=>{const dc=hb.result;dc.Wyj(Kb);dc.show(Qa);return null},Kb=>{v.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Kb}`);return null})},this.ka,3)}}Xqe(){if(this.sheet.active&&this.$.ur){var Qa=this.$.ur,la=ha.h(this.$),hb=la.Ej;if(this.sheet.Hd.Kv){if(!this.qFb){var Kb=new Ba(this.sheet,this.BS.Tzc,()=>this.color?Fa.NVd(this.color):!1,this.Ow);this.qFb=new Jb(this.$,Kb);this.ooa.add(this.qFb)}hb&&la.Zgb(1);
Qa.classList.add(Y.a.BWe);Qa=Fa.Pid(n.a.Xxf);la=Fa.Pid(n.a.hBd);hb=Fa.Pid(n.a.Oxf);Kb=this.sheet.Hd.AVd;this.sheet.Hd.AVd=!1;"true"===hb&&Kb&&this.$.ea.DVd?(Qb.a.Uu(n.a.Oxf,"false",Qb.a.nW),this.$.ea.DVd=!1,this.uWd(3)):"true"===Qa&&"true"===la&&"true"===hb?this.$.ea.EVd&&this.$.ea.$Nb&&(this.sheet.Hd.hI?(Qa=1,Qb.a.Uu(n.a.hBd,"false",Qb.a.nW),this.$.ea.$Nb=!1):Qa=0,Qb.a.Uu(n.a.Xxf,"false",Qb.a.nW),this.$.ea.EVd=!1,this.uWd(Qa)):this.sheet.Hd.hI&&"true"===la&&"true"===hb&&this.$.ea.$Nb&&(Qb.a.Uu(n.a.hBd,
"false",Qb.a.nW),this.$.ea.$Nb=!1,this.uWd(2))}else this.MNe(),hb&&la.Zgb(0),Qa.classList.remove(Y.a.BWe)}}MNe(){const Qa=this.$.da.Aa(322);Qa&&Qa.dismiss()}ihb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.m8a()?U.SOj:U.$Oj;u.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.lP.parentNode.classList.add(U.Hyi):this.lP.parentNode.classList.add(U.Iyi);this.Skg();this.crd&&this.Xqe();this.HHj();this.Zkg();this.vEc();this.crd||this.Xqe()}UYi(){this.FUd=
!0;this.ioa(!0,!0,"OnSheetReorderStarted")}TYi(){this.FUd=!1;this.ioa(!1,void 0,"OnSheetReorderEnded")}activate(Qa=0,la=!1){this.B4b()||(this.sheet.activate(),la&&ha.h(this.$).focus(),Qa={["InputMethod"]:La.a[Qa],["AppMode"]:this.$.Hc,["Location"]:"canvas"},kb.b(this.$).vd(pa.a.LCj,Qa))}Rkg(Qa){this.I7b=Qa?"#797775":"#BEBBB8";this.Y7c=Qa?-.5:.5;this.tKc=Qa?Ea.a.yp("#3B3A39"):Ea.a.yp("#F5F5F5");this.Zkg()}Mvj(Qa){this.$Bb=Qa}IDd(Qa){Qa.m5c();this.JCe(Qa)}JCe(Qa){Qa.K1a();this.sheet.activate()}BHg(Qa){Qa=
new Oa.a(-1876836819,Qa,this.$.Hc,30,null);return this.$.Ka.Lb(Qa,{[n.a.HUd]:this.sheet.name})}Skg(){this.lP.parentNode.setAttribute("sheet-title",this.lP.innerText)}vEc(){const Qa=this.SOh();this.anchor.setAttribute(n.a.qv,Qa);this.anchor.setAttribute(n.a.v$,this.sheet.active.toString())}SOh(){const Qa=this.sheet.Hd.Kv,la=this.sheet.Hd.lob,hb=this.sheet.li,Kb=this.sheet.isLockPausedInSession;return Qa&&hb?String.format(G.a.instance.mb(20),this.name,la):Qa&&Kb?String.format(G.a.instance.mb(22),this.name,
la):Qa?String.format(G.a.instance.mb(19),this.name,la):hb?String.format(G.a.instance.mb(18),this.name):Kb?String.format(G.a.instance.mb(21),this.name):this.name}activateSheet(Qa=0){if(r.a.zud()){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.B4b())return h.Task.Ra(!1);Na.a.current.tS="ActivateSheet";this.sheet.activate();return h.Task.Ra(!0)}return this.BHg(Qa)}Zkg(){const Qa=this.sheet.tabColor;this.color=Qa?Ea.a.yp(Qa):this.Mkh;this.Wkf=Fa.NVd(this.color);
this.ioa(!1,void 0,"UpdateTabColor")}ioa(Qa,la=!1,hb=null){if(this.sheet){hb=this.sheet.active;var Kb=this.m8a(),dc=!!this.sheet.tabColor,sb=Ea.a.BG(hb||Kb?ya.a.white:this.color);this.hF.style.background="";hb||Kb?(dc?u.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.BMa?this.OAj():this.ym?this.NAj():this.MAj():this.ym||(this.hF.style.backgroundColor=sb),this.hF.style.height=this.t4c.toString()+"px"):(this.hF.style.filter="",this.hF.style.backgroundColor=
sb,this.hF.style.height=this.u4c.toString()+"px");this.lP.className=hb?U.TOj:Kb?U.dark:this.Wkf?U.light:U.dark;for(let bb of this.ooa)bb.Xjg();this.ym&&(Qa&&!dc&&(this.hF.style.backgroundColor="#E1DFDD"),ia.DOMElementExtensions.toggleCssClass(this.domElement,U.ZOj,Qa),la?(dc||(this.hF.style.backgroundColor=this.I7b),this.domElement.style.backgroundColor=this.I7b):(dc||(this.hF.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.lP.style.fontWeight=hb||Kb||!this.ym&&Qa?this.ym?
"600":"bold":""}else v.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${hb}`)}NAj(){const Qa=this.hF.style,la=Ea.a.BG(Fa.K2c(this.color,this.Y7c));Qa.background=la}MAj(){const Qa=this.hF.style,la=Ea.a.BG(Fa.K2c(this.color,1)),hb=Ea.a.BG(Fa.K2c(this.color,this.Y7c));Qa.background=`$linear-gradient(${la}, ${hb})`}OAj(){this.hF.style.background="transparent"}ebh(){this.QHc=document.createElement("a");
this.anchor.removeAttribute("Href");this.anchor.className=U.UOj;ia.DOMElementExtensions.Yt(this.anchor,n.a.Xpb,null,null);this.tabIndex=-1}lhh(){this.hF=document.createElement("span");this.hF.className=U.XOj;this.lP=document.createElement("span");this.lP.className=U.bPj;this.lP.dir=this.sheet.rtlName?"rtl":"ltr";this.hF.appendChild(this.lP)}HHj(){const Qa=this.$.HJ;for(let la of this.ooa)la.GHj(Qa,this.hF,this.lP)}m8a(){return ha.h(this.$).m8a(this.sheet)}gMj(){this.Rnd.start();this.fsd=!0}IQe(Qa){this.fsd&&
(this.Rnd.stop(),v.ULS.sendTraceTag(537153686,0,50,Da.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Rnd.Bc,["Has been clicked"]:Qa})),this.fsd=!1)}Cfj(){I.a.instance.sa(A.a.pointerDown,this.domElement,this.onPointerDown);T.KeyInputManager.instance.sa(A.a.Pb,this.domElement,this.onKeyDown);T.KeyInputManager.instance.sa(A.a.Ip,this.domElement,this.Tz);this.Gc.la("mouseover",this.oO);this.Gc.la("mouseout",this.nO);I.a.instance.sa(A.a.IW,this.domElement,
this.QGb);I.a.instance.sa(A.a.NB,this.domElement,this.P6);if(this.$Bb||u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))I.a.instance.sa(A.a.Rf,this.domElement,this.Qf),this.Oxa&&(M.a.instance.sa(A.a.we,this.domElement,this.Qf),M.a.instance.sa(A.a.$f,this.domElement,this.sO));Za.a.instance.sa(A.a.click,this.domElement,this.fd);this.hV=!0}B4b(){const Qa=this.$.da.Aa(65);return Qa&&Qa.lla()?(Qa.Bxc(),this.JCe(Qa),!0):!1}static Pid(Qa){let la=Qb.a.get(Qa);la||(Qb.a.Uu(Qa,
"true",Qb.a.nW),la=Qb.a.get(Qa));return la}static K2c(Qa,la){if(1<la||-1>la)return Qa;let hb=Qa.r,Kb=Qa.g;Qa=Qa.b;0<la?(hb=hb*(1-la)+255*la,Kb=Kb*(1-la)+255*la,Qa=Qa*(1-la)+255*la):(hb*=1+la,Kb*=1+la,Qa*=1+la);return ya.a.Awb(Math.round(hb),Math.round(Kb),Math.round(Qa))}static NVd(Qa){return 128>=(222*Qa.r+707*Qa.g+71*Qa.b)/1E3}}Object(t.a)(Fa,"SheetTabButton",ka,[]);class nb extends ka{constructor(Qa,la,hb){super(document.createElement("a"),la);this.Wha=u.EwaSettings.oa(469)?Y.a.Jbd:Y.a.hAh;hb.pb(this.domElement,
G.a.instance.ga(713),0,this.Wha,G.a.instance.ga(713),ra.a.W4c,!0);Qa.appendChild(this.domElement);this.Gc.la("contextmenu",Kb=>{Ra.g(Kb)})}}Object(t.a)(nb,"WorkbookProtectionButton",ka,[]);var Ta=a(51),V=a(42),va=a(57);class wb extends P.a{constructor(Qa,la,hb=null,Kb=null){super(la);this.sheetTabActivatePreviousHidden=G.a.instance.ga(722);this.sheetTabActivateNextHidden=G.a.instance.ga(724);this.svgIconProvider=null;this.zh=[];this.dL=Array(6);this.sBd=Array(6);this.sTa=this.jAb=this.WH=this.Wzc=
this.Neb=this.Yzc=this.MUd=this.hl=null;this.isRtl=!1;this.SK=this.zv=0;this.v9b=this.kwc=!1;this.Vsc=this.Rna=0;this.fN=this.j4=this.zaa=this.F9b=null;this.Yec=this.tD=0;this.rPb=null;this.cDb=-1;this.BZ=null;this.Wrc=0;this.FBc=-1;this.lna=0;this.sua=new L;this.wOc=!1;this.lwc=this.Zzc=this.HNb=this.qle=this.j0=null;this.wde=!1;this.Kod=null;this.JAd=!1;this.htmlSanitizationHelper=this.ple=null;this.ND=(dc,sb)=>{this.CJf(sb.item)};this.Aza=(dc,sb)=>{dc=this.$.va.na.index;for(let bb=0,Ob=this.zh.length;bb<
Ob;bb++){const gc=this.YQ(bb);if(gc.name===sb.oldName){gc.name=sb.newName;this.G0();bb===dc&&this.T0(6);break}}};this.GJf=(dc,sb)=>{(dc=this.j4a(sb.item))&&dc.ihb()};this.HJf=(dc,sb)=>{sb.visible?(this.jTa(!1),this.DJf(sb.item)):this.CJf(sb.item)};this.iO=dc=>{this.RF?(this.BZ=dc,this.UQb()):(this.BZ&&(this.Vsc+=this.BZ.clientPoint.x-dc.clientPoint.x),this.BZ=dc,Math.abs(this.Vsc)>=this.Vph&&this.UQb());return!0};this.sO=dc=>{dc.Ca.preventDefault();return!1};this.r2f=dc=>{this.n2f(dc,!0)};this.q2f=
dc=>{this.n2f(dc,!1)};this.L6=dc=>{if(this.RF&&(this.Jz||this.pnf(dc)))if(this.v9b=this.sjf(dc),this.Jz){let sb;dc=(sb=this.YQ(this.tD+1))?sb.sheet:null;this.reorderSheets(dc,this.tD+1===this.KUd,!0)}else dc=this.JAd?null:this.Kod,this.reorderSheets(dc,this.JAd,!0);this.GQ();return!0};this.Gh=(dc,sb)=>{sb.UD&&this.B2d(sb.UD);this.$yc(!1);this.G0();sb.na&&(this.B2d(sb.na),this.T0(6),this.ea.Sma())};this.iAf=(dc,sb)=>{this.nFc(sb.item)};this.jAf=(dc,sb)=>{this.nFc(sb.item)};this.kAf=(dc,sb)=>{this.nFc(sb.item)};
this.XPa=(dc,sb)=>{this.nFc(sb.item)};this.iza=()=>{this.K3c()};this.$c=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.K3c();this.G7c();u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(va.d(this.$)||va.e(this.$))&&(V.PageLoadTrackingInfo.instance.jS(n.a.wBa,["sheetTabBar"]),V.PageLoadTrackingInfo.instance.fX(n.a.wBa,["sheetTabBar"]));this.o7c();this.G0();this.jTa(!0);this.T0(6)};this.Kj=()=>{this.isVisible&&(this.G0(),this.T0(6))};this.Bf=()=>{Object(H.a)(ba,
this.WH)===W.k(this.$.lg)&&this.o7c();for(const dc of this.zh)dc.Mvj(!W.k(this.$.lg))};this.FJf=(dc,sb)=>{this.clj(sb.item,sb.isUserOperation)};this.hHb=(dc,sb)=>{this.DJf(sb.item)};this.onKeyDown=dc=>{switch(dc.keyCode){case 9:var sb=this.domElement.querySelectorAll(ia.DOMElementExtensions.Fr);const bb=ia.DOMElementExtensions.um(sb);sb=ia.DOMElementExtensions.mB(sb);ia.DOMElementExtensions.nBa(dc,bb,sb);break;case 39:case 37:ia.DOMElementExtensions.r5f(dc,this.domElement.querySelectorAll(ia.DOMElementExtensions.Fr),
39===dc.keyCode?!this.isRtl:this.isRtl)}v.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${dc.keyCode}`)};this.onScroll=()=>{this.hl.scrollLeft!==this.Rna&&this.DQj()};this.qO=dc=>{if(dc.ctrlKey||dc.J3)return!1;this.hl.scrollLeft+=Math.floor(30*dc.bDa);if(this.Jz&&this.RF){const sb=this.z4e("OnMouseWheel");sb&&this.lZd(0<dc.bDa,sb.x+sb.width/2)}return!0};this.aG=(dc,sb)=>{if(this.sua)this.dbf("PartialInteractivity",sb.zM?3:0);else{this.GQ(!1);this.mTd(sb.zM);for(const bb of this.sye)bb&&
bb.NS(sb.zM);for(const bb of this.zh)bb&&bb.NS(sb.zM)}};this.sGb=(dc,sb)=>{dc=0;sb.kpe&&(dc=2|(sb.QCj?1:0));this.dbf("ComponentRangePicker",dc)};this.$=Qa;this.ea=this.$.ea;this.N9b=(this.Jz=r.a.nlf())&&!u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.ym=u.EwaSettings.oa(469);this.Ow=r.a.Mtd();this.mnf=this.ym&&!this.$.Mw;this.Jz&&(this.wde=this.ym&&!B.a.Lw);this.xpi=u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",
!1);this.wJi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.vJi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;this.Vph=this.$.ya.SheetTabDragStartPixelThreshold;this.GQa=this.HQa=-1;this.K5c=!1;this.htmlSanitizationHelper=Kb;this.Ow&&(this.svgIconProvider=hb);this.MC=new fa.a(this.domElement,3);this.ym&&this.domElement.classList.add(U.lzh);this.Teh();this.tch();this.Ueh();u.EwaSettings.QN()&&document.getElementById(n.a.xba)||this.Zfh();this.$yc(!0);this.$c(null,null);Qa=this.$.va;Qa.Wf(this.Gh);
Qa.ZXc(this.iza);Qa.VY(this.ND);Qa.tha(this.hHb);Qa.PGa(this.Aza);Qa.vse(this.FJf);Qa.a_a(this.HJf);Qa.vNg(this.GJf);Qa.jYc(this.iAf);Qa.rse(this.jAf);Qa.sse(this.kAf);Qa.tse(this.XPa);this.$.$k(this.$c);this.$.DC(this.Kj);na.a(this.$).di(this);this.$.da.Ga(32,this);u.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.pu(this.Bf);this.Xzc=this.Be.oe(this.domElement);this.Xzc.la("keydown",this.onKeyDown);ua.a(this.$).Gp()&&this.aG(null,new ja.a(!0));ua.a(this.$).Zf.h$(this.aG);
ha.h(this.$).Rre(this.sGb);this.Xzc.la("mousedown",dc=>{dc.preventDefault()});z.a.instance.sa(A.a.GD,this.domElement,this.qO);this.LUd=this.Be.oe(this.hl);this.LUd.la("scroll",this.onScroll);this.DQj=Ya.a(()=>{this.G0()},200,this.$.ka,Q.a.WCj,!0);this.$.rB(n.a.LJj);this.mnf&&(this.ple=new ib(this.$,this.sTa.domElement));u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&V.PageLoadTrackingInfo.instance.K0(n.a.wBa,["sheetTabBar"])}get mc(){return this.domElement}get Hf(){return this.isVisible}get he(){return Aa.a.JUd}get RF(){return this.wOc}get KUd(){return this.zh.length}get Tzc(){return this.qle}get Oxa(){return this.wde}get navigationButtonsDisabled(){return!!this.sua&&
this.sua.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.sua&&this.sua.operationButtonsDisabled}get rBd(){return this.ym?this.$.HJ?[Y.a.P$b,Y.a.jUe,Y.a.lUe,Y.a.O$b,Y.a.$ua,Y.a.$ua]:[Y.a.O$b,Y.a.lUe,Y.a.jUe,Y.a.P$b,Y.a.$ua,Y.a.$ua]:this.$.HJ?[Y.a.P$b,Y.a.iUe,Y.a.kUe,Y.a.O$b,Y.a.$ua,Y.a.$ua]:[Y.a.O$b,Y.a.kUe,Y.a.iUe,Y.a.P$b,Y.a.$ua,Y.a.$ua]}get tBd(){return this.$.HJ?[null,ra.a.mGe,ra.a.kGe]:[null,ra.a.kGe,ra.a.mGe]}get cPf(){return this.$.HJ?[null,ra.a.nGe,ra.a.lGe]:[null,ra.a.lGe,
ra.a.nGe]}get IDb(){if(this.isRtl){if(B.a.SF)return 0;if(B.a.Jf)return-1*(this.hl.scrollWidth-this.hl.clientWidth);if(B.a.Lw)return this.hl.scrollWidth-this.hl.clientWidth;v.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get DLb(){if(this.isRtl){if(B.a.SF)return this.hl.scrollWidth-this.hl.clientWidth;if(B.a.Jf||B.a.Lw)return 0;v.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.hl.scrollWidth-
this.hl.clientWidth}get sye(){return this.sua?[this.WH,this.jAb]:[this.WH,this.jAb,this.sTa]}get aPj(){return this.zh.concat(this.sTa)}get OCj(){return this.ple}pb(Qa,la,hb,Kb,dc,sb,bb=!1){Qa.removeAttribute("Href");Qa.setAttribute(n.a.Ad,n.a.rt);Qa.className=U.Zyh;Qa.title=la;Qa.tabIndex=0;this.Ow&&sb?hb=this.svgIconProvider.Jba(sb,12,12,Qa,24,24):(la=document.createElement("span"),la.className=this.ym?Y.a.L5g:Y.a.fs,la.classList.add(K.a.Kia),la.tabIndex=-1,Qa.appendChild(la),sb=document.createElement("img"),
sb.src=Ca.a.de(hb),sb.className=Kb,sb.alt=dc,sb.tabIndex=-1,la.appendChild(sb),hb=sb);bb&&Qa.classList.add(K.a.FU);return hb}dispose(){if(this.$){var Qa=this.$.va;Qa.Dg(this.Gh);Qa.bNd(this.iza);Qa.t7(this.ND);Qa.zna(this.hHb);Qa.KRa(this.Aza);Qa.dXf(this.FJf);Qa.AKb(this.HJf);Qa.Wij(this.GJf);Qa.mNd(this.iAf);Qa.aXf(this.jAf);Qa.bXf(this.kAf);Qa.cXf(this.XPa);this.$.ul(this.$c);this.$.jG(this.Kj);ua.a(this.$)&&ua.a(this.$).Zf.Xda(this.aG);this.sua&&ha.h(this.$).EWf(this.sGb);z.a.instance.Ba(A.a.GD,
this.domElement,this.qO)}y.a.rc(this.sBd);this.sBd=null;if(this.dL)for(Qa=0;Qa<this.dL.length;Qa++){const la=ia.DOMElementExtensions.vK(this.dL[Qa],this.domElement,!1,"a");la&&D.a.tna(la)}y.a.Ia(this.MC);y.a.Ia(this.Xzc);y.a.Ia(this.LUd);this.LUd=this.Xzc=this.jAb=this.WH=this.MC=null;this.$&&this.Jz&&this.GQ(!1);this.zaa=null;this.ESd(null,"Dispose");this.rPb=this.fN=this.F9b=null;this.K3c();this.Neb=this.Yzc=this.MUd=this.hl=this.dL=this.$=this.ea=null;super.dispose()}kg(Qa,la){if(!la){v.ULS.shipAssertTag(537153760,
0,0<this.zh.length,"There is no sheet tab button.");if(!this.zh.length)return!1;Qa=null;for(const hb of this.zh)if(Qa=hb.pVh())break;if(!Qa)return v.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ia.DOMElementExtensions.setFocus(Qa)}return!la}nh(Qa){return ia.DOMElementExtensions.Af(this.mc,Qa)}qj(){}dk(){}reorderSheets(Qa,la,hb){if(this.j0&&this.j0!==Qa){const Kb=this.j0.index;this.blj(this.j0,Qa,la);Qa=Qa?Qa.index-1:la?this.$.va.count-1:0;Kb!==Qa&&(this.aDi(Kb,Qa,hb),
this.Ksh(this.j0.name,Qa))}}o6h(Qa){Qa=this.yja(Qa);return-1!==Qa&&this.zv<=Qa&&Qa<=this.SK?this.zh[Qa].domElement:null}i0j(Qa){if(this.Ow){for(var la=0;la<this.dL.length;la++){const hb=this.dL[la];if(hb&&this.svgIconProvider){const Kb=hb.parentNode;this.gWf(hb);Kb&&(this.dL[la]=this.svgIconProvider.Jba(Qa?this.cPf[la]:this.tBd[la],12,12,Kb,24,24))}}for(la=0;la<this.zh.length;la++)this.zh[la].Rkg(Qa);this.sTa&&this.sTa.bta&&this.Qkg(ra.a.c8h,this.sTa,Qa);this.WH&&this.WH.bta&&this.Qkg(ra.a.Q7g,this.WH,
Qa)}}Qkg(Qa,la,hb){la.Nbb||(la.Nbb=this.svgIconProvider.Jba(Qa,12,12,la.bta.parentNode,24,24));la.Nbb&&(ia.DOMElementExtensions.setVisible(la.bta,!hb),ia.DOMElementExtensions.setVisible(la.Nbb,hb))}XYi(Qa,la){var hb=ha.h(this.$);const Kb=hb.inRangePicker,dc=Ga.HelperMethods.Go(la);if(hb.gb&&!Kb){const sb=hb.Vl?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let bb=void 0;u.EwaSettings.p8a&&(bb=[Object(Wa.a)(hb.jc.textBox.cCa)]);Wa.b(this.$).rCa(dc.rawEvent,sb,bb);hb.endEdit(!0,
"SheetTabBar.OnSheetTabMouseDown")}hb=this.Oxa&&3===la.tb;!(2===la.tb&&dc.button===Sys.UI.MouseButton.leftButton||hb)||Kb||this.RF||ua.a(this.$).Gp()||(hb&&Qa.UYi(),this.cDb=la.clientPoint.x,this.BZ=la,this.QVg(Qa))}VYi(Qa){!this.Jz&&this.RF&&this.DWd(Qa.sheet,!1)}WYi(Qa){this.Jz||(this.RF&&this.reorderSheets(Qa.sheet,!1,!0),this.GQ());this.G0()}rue(){return this.$.isEditMode&&!W.k(this.$.lg)}G0(){const Qa=Ga.HelperMethods.v6(()=>{this.fZj();this.ym&&this.oAj();this.mTd()});v.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Qa}`)}oAj(){const Qa=this.SK===this.zh.length-1;ia.DOMElementExtensions.toggleCssClass(this.Neb,this.$.HJ?U.mUe:U.bUe,!!this.zv);ia.DOMElementExtensions.toggleCssClass(this.Neb,this.$.HJ?U.bUe:U.mUe,!Qa)}mTd(Qa=!1){const la=!this.zv,hb=this.SK===this.zh.length-1;this.$5f(4,this.sheetTabActivatePreviousHidden,!la);this.$5f(5,this.sheetTabActivateNextHidden,!hb);this.nzc(0,la||Qa);this.nzc(1,la||Qa);this.nzc(2,hb||Qa);this.nzc(3,
hb||Qa)}$5f(Qa,la,hb){if(Qa=this.dL[Qa]){ia.DOMElementExtensions.setVisible(Qa,hb);var Kb=this.e6e(Qa);Kb.title="img"===Qa.nodeName?Qa.alt=0<this.zh.length&&hb?la:"":Qa.title=0<this.zh.length&&hb?la:"";Kb.tabIndex=hb?0:-1}}e6e(Qa){return this.Ow?Qa.parentNode:Qa.parentNode.parentNode}nzc(Qa,la){if(Qa=this.dL[Qa])Qa=this.e6e(Qa),void 0!==Qa&&null!==Qa&&(!this.zh.length||la?(Qa.classList.add(K.a.FU),Qa.setAttribute(n.a.Osa,"true")):(Qa.classList.remove(K.a.FU),Qa.setAttribute(n.a.Osa,"false")))}jTa(Qa){const la=
this.$.HJ?this.zh.length-1:0;let hb=this.D8e(this.$.HJ?0:this.zh.length-1);hb&&(hb.borderRightWidth=Qa?"1px":"0");this.zv!==this.SK&&(hb=this.D8e(la))&&(hb.borderRightWidth="0")}kre(Qa,la){this.zh||(this.zh=[]);-1===la?this.zh.push(Qa):this.zh.splice(la,0,Qa)}b7b(Qa,la){let hb=-1,Kb=null;la||(hb=this.tZh(Qa.index),-1!==hb&&(Kb=this.PLa(hb)));Qa=new Fa(this.$,this.hl,Kb,Qa,this,this.ym,this.Ow);this.kre(Qa,hb);ia.DOMElementExtensions.setVisible(Qa.domElement,!0)}DWd(Qa,la){var hb=this.j4a(Qa);if(hb){this.Kod=
Qa;this.JAd=la;Qa=hb.domElement;hb=this.isRtl?Qa.offsetLeft+(this.hl.scrollWidth-this.hl.clientWidth-this.hl.scrollLeft):Qa.offsetLeft-this.hl.scrollLeft;if(!this.isRtl&&la||this.isRtl&&!la)hb+=Qa.offsetWidth;this.Wzc.style.left=Ga.HelperMethods.uc(hb-4);ia.DOMElementExtensions.setVisible(this.Wzc,!0)}}qdf(){ia.DOMElementExtensions.setVisible(this.Wzc,!1)}T0(Qa){const la=Ga.HelperMethods.v6(()=>{switch(Qa){case 0:this.Qxc(0);break;case 1:this.Qxc(this.zv-1);break;case 2:this.Qxc(this.zv+1);break;
case 3:this.scrollIntoView(this.zh.length-1);break;case 4:this.zv&&1<=this.zh.length&&(this.Voe(this.zv-1),this.cRd());break;case 5:this.SK!==this.zh.length-1&&1<=this.zh.length&&(this.Voe(this.SK+1),this.cRd());break;case 6:this.cRd()}});this.N9b&&this.RF&&this.UQb();v.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Qa}, duration = ${la}`)}Voe(Qa){(Qa=this.YQ(Qa))&&Qa.activate()}PHh(Qa){if(0===Qa.UB){const la=this.$.va;let hb=0;for(let Kb=0,dc=la.count;Kb<dc;Kb++){const sb=
Object(C.a)(da.a,la.getItem(Kb));if(sb===Qa)return hb;0===sb.UB&&hb++}}return-1}CHh(Qa){const la=this.$.va;for(let hb=Qa.index+1,Kb=la.count;hb<Kb;hb++)if(Qa=Object(C.a)(da.a,la.getItem(hb)),0===Qa.UB)return Qa;return null}yja(Qa){for(let la=0;la<this.zh.length;la++){const hb=this.YQ(la);if(!hb)v.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${la}] is null even though index is not out of bounds!`);else if(hb.sheet===Qa)return la}return-1}j4a(Qa){Qa=
this.yja(Qa);return this.YQ(Qa)}aDi(Qa,la,hb){const Kb={};Kb.a=this.$.ya.UserSessionId;Kb.b=hb;Kb.c=this.v9b;Kb.d=Qa;Kb.e=la;Kb.f=this.$.va.count;Ta.b().Qe(2,Kb,hb)}blj(Qa,la,hb){const Kb=Object(C.a)(Z.a,this.$.va);la?(la=la.index,la=Qa.index<la?la-1:la):la=hb?Kb.count-1:0;Kb.reorderSheet(Qa,la,!0)}w5f(Qa){ha.h(this.$).yf.hm(Qa)}QVg(Qa){if(!this.kwc){const la=this.domElement.ownerDocument.body;this.Jz?(I.a.instance.sa(A.a.Mj,document.documentElement,this.iO),this.Oxa&&(M.a.instance.sa(A.a.$f,document.documentElement,
this.iO),M.a.instance.sa(A.a.$f,this.domElement,this.sO))):(I.a.instance.sa(A.a.Mj,la,this.iO),M.a.instance.sa(A.a.$f,la,this.iO));I.a.instance.sa(A.a.Rf,document.documentElement,this.L6);M.a.instance.sa(A.a.we,la,this.L6);this.kwc=!0}this.j0=Qa.sheet;this.v9b=!1;this.Jz?(this.fN=null,this.F9b=Qa,this.zaa=Qa.domElement,this.ESd(ia.DOMElementExtensions.getBoundingClientRect(this.zaa),"BeginSheetTabButtonDrag")):(v.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(U.aUe),this.domElement.style.cursor="",this.w5f("pointer"))}GQ(Qa=!0){if(this.kwc){this.w5f(n.a.ZQ);const la=this.domElement.ownerDocument.body;this.Jz?(I.a.instance.Ba(A.a.Mj,document.documentElement,this.iO),this.Oxa&&(M.a.instance.Ba(A.a.$f,document.documentElement,this.iO),M.a.instance.Ba(A.a.$f,this.domElement,this.sO))):(I.a.instance.Ba(A.a.Mj,la,this.iO),M.a.instance.Ba(A.a.$f,la,this.iO));I.a.instance.Ba(A.a.Rf,document.documentElement,this.L6);M.a.instance.Ba(A.a.we,
la,this.L6);this.wOc=this.kwc=!1}this.Vsc=0;this.v9b=!1;this.Kod=this.j0=null;this.Jz?(this.zaa&&(this.zaa.style.visibility="visible",this.zaa=null),this.F9b=null,this.ESd(null,"EndSheetTabButtonDrag"),this.fN&&(this.fN.parentNode&&this.fN.parentNode.removeChild(this.fN),this.fN=null),this.pnj(Qa)):(this.domElement.classList.remove(U.aUe),this.qdf())}pnj(Qa){this.uYd(Qa);this.tD=this.cDb=-1}Ksh(Qa,la){const hb=this.$.pa,Kb=hb?hb.xa:null;this.$.userOperationManager.Ic(new X.a(557,0,(dc,sb,bb)=>Mb(Kb,
Qa,la,dc,sb,bb,null),64,()=>new Ka(Qa,la)),null)}YQ(Qa){return 0<=Qa&&Qa<this.zh.length?this.zh[Qa]:null}C8e(Qa){return(Qa=this.YQ(Qa))?Qa.sheet:null}PLa(Qa){return(Qa=this.YQ(Qa))?Qa.domElement:null}D8e(Qa){return(Qa=this.PLa(Qa))?Qa.style:null}tZh(Qa){const la=this.$.va;Qa+=1;let hb=-1;const Kb=this.zh?this.zh.length:0;for(;Qa<la.count;){const dc=Object(C.a)(da.a,la.getItem(Qa));if(0===dc.UB){for(hb=0;hb<Kb&&this.C8e(hb)!==dc;hb++);break}Qa++}return-1===hb||hb===Kb?-1:hb}CJf(Qa){var la=this.j4a(Qa);
la&&(this.Jz&&this.RF&&(v.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.GQ()),this.hl.removeChild(la.domElement),la=Array.indexOf(this.zh,la),this.zh.splice(la,1),this.G0(),(!this.isRtl&&la===this.zh.length||this.isRtl&&!la)&&this.jTa(!0),this.N9b&&this.RF?Qa===this.j0?(this.GQ(),this.T0(6)):this.UQb():
this.T0(6))}DJf(Qa){const la=Object(C.a)(da.a,Qa);this.Jz&&this.RF&&(v.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.GQ());if(0===la.UB){this.jTa(!1);var hb=this.yja(Qa);-1===hb&&(v.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.b7b(la,!1),hb=this.yja(Qa));this.lbf(hb,!0)}}clj(Qa,la){const hb=this.j4a(Qa);hb&&(this.Jz&&this.RF&&!la&&(v.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.GQ()),Qa=this.OOj(Qa,hb),!u.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Jz&&Qa&&la&&Qa.TYi())}OOj(Qa,
la){var hb=Array.indexOf(this.zh,la);const Kb=this.PHh(Object(C.a)(da.a,Qa));if(-1===Kb||-1===hb)return null;hb!==Kb||this.Jz?(this.jTa(!1),{pIh:this.zv,Jxi:this.SK}=wb.Zkj(hb,Kb,this.zv,this.SK),la&&la.domElement.parentNode===this.hl&&(this.hl.removeChild(la.domElement),this.zh.splice(hb,1)),la=this.CHh(Qa),hb=this.yja(la),la=new Fa(this.$,this.hl,this.PLa(hb),Object(C.a)(da.a,Qa),this,this.ym,this.Ow),this.kre(la,hb),hb=this.yja(Qa),this.lbf(hb,!1,!this.ym)):la=null;return la}zth(){const Qa=this.zh?
this.zh.length:0,la=this.zv,hb=this.SK;for(let Kb=0;Kb<Qa;Kb++){const dc=this.YQ(Kb),sb=Kb>=la;dc&&(dc.tabIndex=sb&&Kb<=hb?0:-1)}}QXj(){const Qa=this.zh?this.zh.length:0;for(let la=0;la<Qa;la++){const hb=this.YQ(la);hb&&hb.ihb()}}lbf(Qa,la,hb=!0){la&&Qa<=this.zv&&this.zv++;this.zth();this.jTa(!0);this.G0();this.N9b&&this.RF?this.UQb():hb&&this.T0(6)}$yc(Qa){const la=this.$.HJ;if(Qa||this.isRtl!==la)this.isRtl=la,this.domElement.classList.remove(this.isRtl?Y.a.hUe:Y.a.nUe),this.domElement.classList.add(this.isRtl?
Y.a.nUe:Y.a.hUe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.QXj();Qa||this.jTa(!0);for(Qa=0;Qa<this.dL.length;Qa++)0!==Qa&&3!==Qa&&(!this.ym||4!==Qa&&5!==Qa)&&this.a6f(Qa)}Teh(){const Qa=this.MUd=document.createElement("div");Qa.className=U.Wyh;this.ym&&Qa.classList.add(U.Xyh);this.domElement.appendChild(Qa);this.W6b(Qa,1,717,716);this.W6b(Qa,2,719,718);this.mnf&&(this.sTa=new db(this.$,this,Qa));this.ym||this.W6b(Qa,4,723,722)}Ueh(){const Qa=this.Yzc=document.createElement("div");Qa.className=
U.Yyh;this.domElement.appendChild(Qa);this.ym||this.W6b(Qa,5,725,724);this.o7c()}Zfh(){const Qa=document.getElementById(n.a.MCj),la=document.getElementById(n.a.NCj);Qa&&!la&&v.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Qa.parentNode.id}. progressBar div has child: ${!!Qa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(n.a.CUd)}`);const hb=r.a.snf(this.$);if(hb&&Qa&&la)this.domElement.appendChild(Qa),
this.HNb=Qa.firstChild,this.Zzc=document.getElementById(n.a.CUd),la.style.visibility="visible";else{const Kb=document.createElement("div"),dc=document.createElement("div");Kb.className=Y.a.gzh;dc.className=Y.a.ezh;u.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(dc.id=n.a.Jeb);dc.style.display="none";const sb=document.createElement("div");sb.className=Y.a.hzh;const bb=document.createElement("div");bb.className=Y.a.fzh;const Ob=document.createElement("div");Ob.className=
Y.a.dzh;dc.appendChild(sb);dc.appendChild(bb);dc.appendChild(Ob);Kb.appendChild(dc);this.domElement.appendChild(Kb);this.HNb=dc;this.Zzc=bb;v.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",hb,Qa,la)}}a6f(Qa){var la=this.dL[Qa];if(la)if(this.Ow){const hb=la.parentNode;this.gWf(la);la=ca.a(this.$)?this.cPf[Qa]:this.tBd[Qa];this.dL[Qa]=
this.svgIconProvider.Jba(la,12,12,hb,24,24)}else la.className=this.rBd[Qa]}gWf(Qa){(null===Qa||void 0===Qa?0:Qa.parentNode)&&Qa.parentNode.removeChild(Qa)}tch(){const Qa=this.Neb=document.createElement("div");Qa.className=U.Qyh;this.domElement.appendChild(Qa);this.chh(Qa)}chh(Qa){const la=document.createElement("div");la.className=U.jzh;la.classList.add(U.Ryh);this.$.printingEnabled||la.classList.add(aa.a.vWe);Qa.appendChild(la);this.hl=document.createElement("ul");ia.DOMElementExtensions.Yt(this.hl,
n.a.k_c,null,null);this.hl.className=aa.a.oUe;la.appendChild(this.hl);this.Meh();this.qle=document.createElement("div");this.Tzc.id="SheetIconTooltipContainer";la.appendChild(this.Tzc)}Meh(){const Qa=document.createElement("div");var la="<div class='"+Y.a.O5g+"'>{0}</div>";const hb=Ca.a.Dgd(Y.a.gAh,0,"55_16_N","");la=String.format(la,hb);u.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")&&
this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(Qa,la):Qa.innerHTML=la;Qa.className=U.izh;ia.DOMElementExtensions.setVisible(Qa,!1);this.Wzc=Qa;this.hl.appendChild(Qa)}G7c(){const Qa=this.$.va;for(let la=0,hb=Qa.count;la<hb;la++){const Kb=Object(C.a)(da.a,Qa.getItem(la));0===Kb.UB&&(this.b7b(Kb,!0),Kb.active&&Kb.activate())}}K3c(){y.a.rc(this.zh);this.zh=[];this.SK=this.zv=0}W6b(Qa,la,hb,Kb){const dc=document.createElement("a");Qa.appendChild(dc);Qa=this.tBd[la];this.dL[la]=this.pb(dc,
G.a.instance.ga(Kb),0,this.rBd[la],G.a.instance.ga(hb),Qa);if(5===la||4===la)ia.DOMElementExtensions.vK(this.dL[la],dc,!1,"span").style.marginTop="10px";this.a6f(la);hb=this.sBd[la]=this.Be.oe(dc);I.a.instance.sa(A.a.pointerDown,dc,bb=>bb.ctrlKey&&this.EPi(la)?!0:this.KGf(la));I.a.instance.sa(A.a.Rf,dc,()=>this.LGf());M.a.instance.sa(A.a.we,dc,()=>this.LGf());I.a.instance.sa(A.a.pointerOut,dc,()=>this.C3c());T.KeyInputManager.instance.sa(A.a.Pb,dc,bb=>13!==bb.Ca.keyCode&&32!==bb.Ca.keyCode||this.K5c?
!1:(this.K5c=!0,this.KGf(la)));T.KeyInputManager.instance.sa(A.a.Gd,dc,bb=>13===bb.Ca.keyCode||32===bb.Ca.keyCode?(this.K5c=!1,this.C3c()):!1);const sb=this.rue();Kb=bb=>{"mouseup"===bb.type&&this.Jz&&this.RF||Ra.g(bb);dc.classList.contains(K.a.FU)||(sb?this.MVi(bb,la):this.ym||this.MGf(bb,la))};hb.la("mouseover",Kb);hb.la("mouseout",Kb);hb.la("focus",Kb);hb.la("blur",Kb);sb&&hb.la("mouseup",Kb)}sjf(Qa){let la=!1;const hb=this.$.vf;hb&&(la=S.a.PN(ia.DOMElementExtensions.getBoundingClientRect(hb),
Qa.clientPoint));return la}pnf(Qa){return S.a.PN(ia.DOMElementExtensions.getBoundingClientRect(this.domElement),Qa.clientPoint)||this.sjf(Qa)}LHh(Qa){let la=null;const hb=Qa.clientPoint;let Kb=this.zv;if(this.pnf(Qa))for(Kb=this.zv;Kb<=this.SK;Kb++)if(la=this.YQ(Kb))if(Qa=ia.DOMElementExtensions.getBoundingClientRect(la.domElement),!this.isRtl&&hb.x<Qa.x+Qa.width||this.isRtl&&hb.x>Qa.x)break;return{returnValue:la,vGj:Kb>this.SK}}UQb(){if(this.Jz){if(!this.fN){v.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.fN=this.zaa.cloneNode(!0);if(!this.Q0f(this.fN,this.zaa,!0,"UpdateDragAndDropState"))return;this.zaa.style.visibility="hidden";this.fN.classList.add(U.kzh);this.fN.style.borderRightWidth="";this.Yec=this.BZ.clientPoint.x-this.j4.width/2;this.fN.style.left=this.Yec+"px";this.tD=this.yja(this.j0);0>this.tD&&v.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.N9b&&(this.tD=this.yja(this.j0));var Qa=ia.DOMElementExtensions.getBoundingClientRect(this.hl),
la=Qa.x;Qa=Qa.x+Qa.width;let hb=this.BZ.clientPoint.x-this.j4.width/2;hb=Math.min(hb,Qa-this.j4.width);hb=Math.max(hb,la);this.fN.style.transform="translateX("+Math.abs(hb-this.Yec)*(this.Yec<hb?1:-1)+"px)";const Kb=this.BZ.clientPoint.x>this.cDb;let dc=this.BZ.clientPoint.x;hb>=Qa-this.j4.width?(dc=Qa-this.j4.width/2,this.$Qd()||this.lna||(v.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Wrc=
this.hl.scrollLeft,this.lna=window.requestAnimationFrame(this.r2f))):hb<=la?(dc=la+this.j4.width/2,this.ZQd()||this.lna||(v.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Wrc=this.hl.scrollLeft,this.lna=window.requestAnimationFrame(this.q2f))):this.lna&&(v.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.uYd());
this.BZ.clientPoint.x!==this.cDb&&(this.lZd(Kb,dc),this.cDb=this.BZ.clientPoint.x)}else(Qa=({vGj:la}=this.LHh(this.BZ)).returnValue)?this.DWd(Qa.sheet,la):this.qdf();this.wOc=!0}lZd(Qa,la){let hb;for(;({Z3b:hb}=this.Wph(la,Qa)).returnValue;)this.rPb=hb,this.uRg(Qa)}uRg(Qa){if(this.rPb){var la=(Qa?1:-1)*this.j4.width;if(Qa&&!this.$.HJ||!Qa&&this.$.HJ){var hb=this.zaa;var Kb=this.tD+1;var dc=!0}else hb=(Kb=this.YQ(this.tD+1))?Kb.domElement:null,Kb=this.tD-1,dc=!1;if(this.Q0f(this.rPb,hb,dc,"AnimateSheetSwap")){v.ULS.sendTraceTag(537153738,
0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.tD} and other sheet-index ${Kb}. amount of sheets in the bar: ${this.KUd} isMovingRight: ${Qa}`);0<=this.tD&&this.tD<this.zh.length&&0<=Kb&&Kb<this.zh.length?(Qa=this.zh[Kb],this.zh[Kb]=this.zh[this.tD],this.zh[this.tD]=Qa):(v.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.zh.length}, ghostIndex: ${this.tD}, swappedSheetIndex: ${Kb}`),this.GQ());this.tD=
Kb;var sb=this.rPb;sb.style.transform="translateX("+la+"px)";window.requestAnimationFrame(()=>{sb.style.transform="translateX(0px)"})}}}Q0f(Qa,la,hb,Kb){const dc=sb=>sb?`Node ID: ${sb.id} , Node class: ${sb.className}, Node name: ${sb.nodeName},`:null;try{return this.hl.insertBefore(Qa,la),!0}catch(sb){return Qa=this.j4a(this.j0),v.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
Qa?Qa!==this.F9b?"Changed":"NoChange":"Removed",Kb,dc(la),dc(la.parentNode),dc(this.hl),hb,this.tD,this.KUd,sb),this.GQ(),!1}}Wph(Qa,la){var hb=this.$.HJ===la?this.YQ(this.tD-1):this.YQ(this.tD+1);if(!hb)return{returnValue:!1,Z3b:null};hb=hb.domElement;const Kb=ia.DOMElementExtensions.getBoundingClientRect(hb);return this.j4?la?{returnValue:Qa+this.j4.width/2>=Kb.x+.5*Kb.width,Z3b:hb}:{returnValue:Qa-this.j4.width/2<=Kb.x+.5*Kb.width,Z3b:hb}:(v.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.GQ(),{returnValue:!1,Z3b:hb})}n2f(Qa,la){let hb;hb=la?this.r2f:this.q2f;if(-1===this.FBc)this.FBc=Qa,this.lna=window.requestAnimationFrame(hb);else{Qa=Math.floor((Qa-this.FBc)/1E3*300);var Kb=this.DLb>this.IDb?1:-1;this.scrollLeft(Math.abs(this.hl.scrollLeft-(la?this.Wrc+Qa*Kb:this.Wrc-Qa*Kb))*(la?-1:1));if(Qa=this.z4e("ScrollStep"))this.lZd(la,Qa.x+Qa.width/2),la&&!this.$Qd()||!la&&!this.ZQd()?this.lna=window.requestAnimationFrame(hb):(v.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.uYd())}}$Qd(){const Qa=this.DLb>this.IDb;return Qa&&this.Rna>=this.DLb||!Qa&&this.Rna<=this.DLb}ZQd(){const Qa=this.DLb>this.IDb;return Qa&&this.Rna<=this.IDb||!Qa&&this.Rna>=this.IDb}uYd(Qa=!0){this.hl&&(this.Rna=this.hl.scrollLeft);window.cancelAnimationFrame(this.lna);this.lna=0;this.FBc=-1;Qa&&this.G0()}ESd(Qa,la){Qa||v.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${la}`);this.j4=Qa}EPi(Qa){return 2===Qa?(this.T0(3),
!0):1===Qa?(this.T0(0),!0):!1}KGf(Qa){v.ULS.shipAssertTag(537153732,0,-1===this.HQa&&-1===this.GQa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.HQa&&(window.clearTimeout(this.HQa),this.HQa=-1);-1!==this.GQa&&(window.clearInterval(this.GQa),this.GQa=-1);this.T0(Qa);this.HQa=window.setTimeout(()=>{this.vMj(Qa)},this.wJi);return!0}vMj(Qa){this.GQa=window.setInterval(()=>{this.T0(Qa)},this.vJi)}LGf(){this.C3c();
return!this.Jz||!this.RF}C3c(){window.clearTimeout(this.HQa);window.clearInterval(this.GQa);this.GQa=this.HQa=-1;return!0}MGf(Qa,la){const hb=this.rBd[la];Ga.HelperMethods.A_d(this.dL[la],hb,hb+n.a.Cgc,"mouseover"===Qa.type||"focus"===Qa.type)}MVi(Qa,la){const hb=this.fjc(la),Kb=5===la;if("mouseup"===Qa.type){if(Kb||4===la)hb||this.reorderSheets(null,Kb,!1),this.GQ()}else!this.Jz&&this.RF?(hb||this.DWd(this.C8e(Kb?this.SK:this.zv),Kb),this.T0(Kb?2:1)):this.ym||this.MGf(Qa,la)}fjc(Qa){return!!ia.DOMElementExtensions.Ehd(this.dL[Qa],
"a").title}nFc(Qa){this.B2d(Qa);this.G0()}B2d(Qa){(Qa=this.j4a(Qa))&&Qa.ihb()}cRd(){var Qa=this.$.va;if(Qa.na&&(!va.e(this.$)||Qa.count))if(Qa=this.yja(Qa.na),-1===Qa)v.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var la=this.PLa(Qa);Qa<this.zv?this.Qxc(Qa):Qa>this.zv&&!this.Aud(la)&&this.scrollIntoView(Qa)}}fZj(){this.zv=0;this.SK=this.zh.length-1;let Qa=!1;for(let la=0;la<this.zh.length;la++){const hb=this.YQ(la);if(!hb)break;
const Kb=this.Aud(hb.domElement);hb.tabIndex=Kb?0:-1;if(!Qa&&Kb)this.zv=la,Qa=!0;else if(Qa&&!Kb){this.SK=la-1;break}}}Qxc(Qa){this.$.va.count&&(this.zh.length||this.G7c(),this.k4f(this.PLa(Math.max(0,Math.min(Qa,this.zh.length-1)))),this.G0())}scrollIntoView(Qa){v.ULS.shipAssertTag(537153697,0,Qa>=this.zv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.va.count){this.zh.length||this.G7c();var la=this.PLa(Math.max(0,Math.min(Qa,
this.zh.length-1))),hb=this.PLa(this.zv);if(!this.Aud(la)){la=ia.DOMElementExtensions.getBoundingClientRect(la);var Kb=ia.DOMElementExtensions.getBoundingClientRect(this.Neb);la=this.isRtl?Kb.x-la.x:la.x+la.width-(Kb.x+Kb.width);for(Kb=0;hb&&Kb<la;){const dc=ia.DOMElementExtensions.getBoundingClientRect(hb);Kb+=dc.width;hb=hb.nextSibling}hb?this.k4f(hb):v.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.zv}, lastVisibleSheetTabIndex = ${this.SK}, scroll to index: ${Qa}`)}this.G0()}}k4f(Qa){const la=
ia.DOMElementExtensions.getBoundingClientRect(this.hl);Qa=ia.DOMElementExtensions.getBoundingClientRect(Qa);this.isRtl?this.scrollLeft(Math.floor(la.x+la.width-(Qa.x+Qa.width+.5))):this.scrollLeft(Math.ceil(la.x-Qa.x-.5))}scrollLeft(Qa){(0>Qa&&this.$Qd()||0<Qa&&this.ZQd())&&v.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const la=this.hl.scrollLeft;if(this.isRtl){if(B.a.SF||B.a.Jf){this.hl.scrollLeft=this.Rna=la-Qa;
return}if(B.a.aI){this.hl.scrollLeft=this.Rna=la+Qa;return}v.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.hl.scrollLeft=this.Rna=la-Qa}Aud(Qa){Qa=ia.DOMElementExtensions.getBoundingClientRect(Qa);const la=ia.DOMElementExtensions.getBoundingClientRect(this.Neb);return Qa&&la?Qa.x>=la.x-1&&Qa.x+Qa.width<=la.x+la.width+1:(v.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}nfh(){const Qa=
this.Yzc;if(ba.E8f(this.$))this.ym?(y.a.Ia(this.WH),this.WH=new ba(Qa,this.$,this,!0)):(y.a.Ia(this.WH),this.WH=null);else if(!this.WH||this.ym)y.a.Ia(this.WH),W.k(this.$.lg)?this.WH=new nb(Qa,this.$,this):this.WH=new ba(Qa,this.$,this)}IJe(Qa,la){var hb=this.$.va;if(!this.$.isEditMode||!hb.count)y.a.Ia(la),la=null;else if(!la)if(hb=this.ym?this.MUd:this.Yzc,W.k(this.$.lg))la=new nb(hb,this.$,this);else switch(Qa){case 0:la=new ba(hb,this.$,this);break;case 1:la=new Ua(hb,this.$,this);break;default:v.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return la}o7c(){this.xpi?(this.WH=this.IJe(0,this.WH),this.jAb=this.IJe(1,this.jAb)):this.nfh()}z4e(Qa){const la=ia.DOMElementExtensions.getBoundingClientRect(this.fN);la||(v.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Qa}: GetBoundingClientRect returned null for the dragged sheet.`),this.GQ());return la}dbf(Qa,
la){this.sua.BSg(Qa,la);this.GQ(!1);this.mTd(this.navigationButtonsDisabled);for(const hb of this.aPj)hb&&hb.NS(this.navigationButtonsDisabled);for(const hb of this.sye)hb&&hb.NS(this.operationButtonsDisabled)}static Zkj(Qa,la,hb,Kb){Qa<hb?(la>hb&&hb--,la>Kb&&Kb--):Qa>Kb?(la<hb&&hb++,la<Kb&&Kb++):la<hb&&hb++;return{pIh:hb,Jxi:Kb}}}Object(t.a)(wb,"SheetTabBarControl",P.a,[881,3,66]);class fc extends w.a{constructor(Qa){super();this.$=Qa;this.Fb()}create(){const Qa=this.$.Eb;if(x.a(this.$.ya,1))V.PageLoadTrackingInfo.instance.$da(n.a.wBa,
["sheetTabBar"]);else{var la=document.getElementById(Qa+n.a.N8c);if(la){u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&V.PageLoadTrackingInfo.instance.hBa(n.a.wBa);var hb=u.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:7308078_ReduceInnerHTMLUsageSheetTabBar")?e.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):h.Task.Ra(null),Kb=r.a.Mtd()?e.GetServiceTaskFactory.Na(this.$.da,388,387,this.Ya):
h.Task.Ra(null);f.TaskExtensions.za(f.TaskExtensions.Ed([Kb,hb],this.$.ka),()=>{this.ob(this.$.da.Aa(32)||new wb(this.$,la,Kb.result,hb.result))},this.$.ka,3)}else V.PageLoadTrackingInfo.instance.$da(n.a.wBa,["sheetTabBar"])}}static la(Qa){Qa.da.Ga(33,new fc(Qa))}}Object(t.a)(fc,"SheetTabBarFactory",w.a,[]);a.d(E,"a",function(){return Fc});const Fc=()=>{c.a.Fa(Qa=>{fc.la(Qa);l.la(Qa)})}},1157:function(t,E,a){var c=a(9),b=a(1);t=a(0);var e=a(222),f=a(15),d=a(31),h=a(5),m=a(12),l=a(22),w=a(13),n=a(255),
x=a(21),r=a(30);class u{constructor(ha){this.wxc=ha||""}static get sQe(){return u.u$d||(u.u$d=new u(""))}static get wyd(){return u.vfe||(u.vfe=u.kfd(2).wxc)}static D4a(ha){ha=r.a.rg(ha||"");return new u(ha)}static Wbc(ha){return u.D4a(w.a.instance.ga(ha))}static kfd(ha){return new u(w.a.instance.Ua(ha))}static RKh(ha,...Wa){return u.QKh(w.a.instance.mb(ha),...Wa)}static QKh(ha,...Wa){const ca=Wa.length,ja=Array(ca);for(let ua=0;ua<ca;ua++)ja[ua]=(Wa[ua]||u.sQe).wxc;return new u(String.format(ha,ja))}}
u.u$d=null;u.vfe=null;Object(t.a)(u,"SafeHtml",null,[892]);const v=(ha,Wa)=>{Wa&&(ha.append(Wa),ha.append(u.wyd))};class B{constructor(ha,Wa,ca,ja=null){this.WBf=(ua,Za)=>{this.GSf(Za.Wd.command)};this.$=ha;this.htmlSanitizationHelper=ja;this.xfa=document.createElement("div");this.xfa.setAttribute(h.a.i3,h.a.Ak);this.xfa.className=d.a.Abd;Wa.insertBefore(this.xfa,ca);this.Kga=document.createElement("div");this.Kga.setAttribute(h.a.i3,h.a.Ak);this.Kga.className=d.a.Abd;Wa.insertBefore(this.Kga,this.xfa);
this.pAg=w.a.instance.Ua(2);this.C$=document.createElement("div");this.C$.setAttribute(h.a.Ad,h.a.Nsa);this.C$.setAttribute(h.a.Psa,h.a.Spb);this.C$.className=d.a.Abd;Wa.insertBefore(this.C$,this.Kga);this.register();this.$.da.Ga(211,this)}get wya(){return this.pAg}get isActive(){return!0}get activeCell(){return x.h(this.$).Ub(null)}get ztd(){return b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")}dispose(){this.$&&
this.unregister();m.DOMElementExtensions.tf(this.C$);m.DOMElementExtensions.tf(this.xfa);m.DOMElementExtensions.tf(this.Kga);this.Kga=this.xfa=this.C$=this.$=null}setEnabled(ha){this.W4f(this.Kga,ha)}gxj(){this.W4f(this.xfa,!0)}readText(ha){this.tJb(u.D4a(ha),!0)}gRa(ha){this.tJb(u.D4a(ha),!1)}JSf(ha,Wa){if(1>Wa||!ha)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ca=new Sys.StringBuilder;ha=String.format(w.a.instance.mb(34),Wa,ha);v(ca,ha);v(ca,w.a.instance.ga(856));
this.tJb(u.D4a(ca.toString()),!1)}}Wbj(ha,Wa,ca){if(1>ca||1>Wa||Wa>ca||!ha)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ja=new Sys.StringBuilder;v(ja,ha);ja.append(String.format(w.a.instance.mb(55),Wa,ca));this.tJb(u.D4a(ja.toString()),!1)}}GSf(ha){ha=this.N1h(ha);this.tJb(ha,!1)}tJb(ha,Wa){if(ha=ha?ha.wxc:null)Wa=Wa?this.Kga:this.xfa,l.a.equals(Wa.innerHTML,ha,!1)&&(ha+=u.wyd),this.ztd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(Wa,ha):Wa.innerHTML=
ha}xcb(ha,Wa){this.C$.getAttribute(h.a.Psa)!==Wa&&this.C$.setAttribute(h.a.Psa,Wa);ha=ha?u.D4a(ha).wxc:"";this.ztd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(this.C$,ha):this.C$.innerHTML=ha}Xbj(ha,Wa,ca,ja){const ua=w.a.instance.mb(54);f.ULS.shipAssertTag(537153949,0,!(void 0===ha||null===ha));f.ULS.shipAssertTag(537153948,0,!(void 0===Wa||null===Wa));f.ULS.shipAssertTag(537153947,0,!(void 0===ca||null===ca));f.ULS.shipAssertTag(537153946,0,!(void 0===ja||null===ja));f.ULS.shipAssertTag(537153945,
0,!(void 0===ua||null===ua));ha=String.format(ua,ha||"",Wa||"",ca||"",ja||"");this.xcb(ha,h.a.sHa)}UXj(ha){var Wa=this.Kga.style;ha?(ha=n.a.r3b(ha.cell,Wa),Wa=ha.YB,Wa.top=Wa.left=Wa.bottom=Wa.right=null,ha.g3()):Wa.cssText=""}N1h(ha){switch(ha){case -1985798686:return u.Wbc(12);case -911352779:return u.Wbc(11);case 237279923:return u.Wbc(13);case -1502853784:return u.kfd(81);case -111689794:return u.kfd(78);case -287251124:return this.Kjd(1329,Wa=>Wa.bold);case -1925065947:return this.Kjd(1330,Wa=>
Wa.italic);case 1764140053:return this.Kjd(1331,Wa=>Wa.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.LGa(this.WBf))}unregister(){this.$&&this.$.Ka.GAa(this.WBf)}W4f(ha,Wa){const ca=ha===this.xfa;Wa?(ha.setAttribute(h.a.Psa,h.a.sHa),ca&&ha.setAttribute(h.a.Ad,h.a.Nsa),ha.setAttribute(h.a.i3,h.a.vr),ha.removeAttribute(h.a.i3),
this.ztd&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(ha,ha.innerHTML+" "):ha.innerHTML+=" "):(ha.removeAttribute(h.a.Psa),ca&&ha.removeAttribute(h.a.Ad),ha.setAttribute(h.a.i3,h.a.Ak))}Kjd(ha,Wa){const ca=this.activeCell;if(!ca)return null;const ja=b.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),ua=[7,8];Wa=Wa(ca)?!0:!1;return u.RKh(ja?ua[+Wa]:ua[+!Wa],u.Wbc(ha))}}Object(t.a)(B,"AriaLiveNotifier",null,[885,863,3]);var z=a(48),A=a(37);class y extends e.a{constructor(ha){super();
this.$=ha;this.Fb()}create(){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&b.EwaSettings.isChangeGateEnabled("OfficeVSO:7143612_ReduceInnerHTMLUsageForAriaLiveNotifier")){const ha=z.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya);A.TaskExtensions.za(A.TaskExtensions.Ed([ha],this.$.ka),()=>{this.ob(this.$.da.Aa(211)||new B(this.$,this.$.uu,this.$.vf,ha.result))},this.ka,3)}else this.ob(this.$.da.Aa(211)||new B(this.$,this.$.uu,this.$.vf))}static la(ha){ha.da.Ga(212,
new y(ha))}}Object(t.a)(y,"AriaLiveNotifierFactory",e.a,[]);var D=a(27),I=a(212),M=a(139),T=a(65);class S{constructor(ha,Wa){this.F0=this.ZW=this.EO=null;this.Kja=Wa;this.pgh(ha);this.N6i();b.EwaSettings.xb()&&ha.da.Ga(244,this)}get isActive(){return!!this.Kja&&document.activeElement===this.Kja}readText(ha){ha=String.format(w.a.instance.mb(30),ha);this.EO.setAttribute(h.a.qv,ha);this.ZW.setAttribute(h.a.qv,ha);this.LOj()}dispose(){this.F0&&this.F0.parentNode&&this.F0.parentNode.removeChild(this.F0);
this.ZW=this.EO=this.F0=this.Kja=null}pgh(ha){var Wa=ha.Eb+"readoutElementWrapper";const ca=ha.Eb+"readoutElement1",ja=ha.Eb+"readoutElement2";this.F0=document.getElementById(Wa);this.F0||(this.F0=document.createElement(I.a.div),this.F0.id=Wa,this.EO=document.createElement(I.a.label),this.EO.id=ca,this.EO.setAttribute(M.a.contentEditable,T.a.LRb),this.EO.setAttribute(h.a.Ad,h.a.Q_a),this.ZW=document.createElement(I.a.label),this.ZW.id=ja,this.ZW.setAttribute(M.a.contentEditable,T.a.LRb),this.ZW.setAttribute(h.a.Ad,
h.a.Q_a),this.EO.style.width="0px",this.EO.style.height="0px",this.ZW.style.width="0px",this.ZW.style.height="0px",this.EO.tabIndex=-1,this.ZW.tabIndex=-1,this.F0.appendChild(this.EO),this.F0.appendChild(this.ZW),ha=ha.Eb+h.a.Z5b,Wa=document.getElementById(ha),f.ULS.shipAssertTag(537153942,3,!!Wa,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${ha}`),Wa&&Wa.appendChild(this.F0))}N6i(){this.Kja&&this.EO&&this.ZW&&(this.Kja.setAttribute(h.a.aZ,this.EO.id),
this.Kja.setAttribute(h.a.l2b,`${this.EO.id} ${this.ZW.id}`))}LOj(){if(this.isActive){let ha="";m.DOMElementExtensions.hasAttribute(this.Kja,h.a.aZ)&&(ha=this.Kja.getAttribute(h.a.aZ).toString());this.Kja.setAttribute(h.a.aZ,ha===this.EO.id?this.ZW.id:this.EO.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static P7a(){if(null==S.lwb)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!D.a.WNa)S.lwb=
!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(S.lwb=!1,D.a.aI||D.a.Jf)S.lwb=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return S.lwb}static la(ha){S.P7a()&&ha.da.Ga(244,new S(ha,x.h(ha).jc.textBox.Ke))}}S.lwb=null;Object(t.a)(S,"FocusBasedReadout",null,[863,3]);class H extends e.a{constructor(ha){super();this.$=ha;this.Fb()}create(){S.P7a()?
x.h(this.$).jc.textBox.qU(()=>{const ha=this.$.da.Aa(244)||new S(this.$,x.h(this.$).jc.textBox.Ke);this.ob(ha)}):this.ob(null)}static la(ha){ha.da.Ga(315,new H(ha))}}Object(t.a)(H,"FocusBasedReadoutFactory",e.a,[]);var C=a(7),G=a(89),J=a(83);const L=ha=>{switch(ha){case 1:return 1452;case 2:return 1453;case 3:return 1454;case 4:return 1455;case 5:return 1456;case 6:return 1457;case 7:return 1458;case 8:return 1459;case 9:return 1460;case 10:return 1461;case 11:return 1462;case 12:return 1463;case 13:return 1464;
case 14:return 1465;case 15:return 1466;case 16:return 1467;case 17:return 1468;case 18:return 1469;case 19:return 1470;case 20:return 1471;case 21:return 1472;case 22:return 1475;case 23:return 1473;case 24:return 1474;case 25:return 1476;case 26:return 1477;case 27:return 1478;case 28:return 1479;default:return 1480}};var P=a(24),aa=a(40),U=a(211),K=a(47),Y=a(46),na=a(122);class W{static get Laj(){return W.fje||(W.fje=RegExp("([A-Z]+)","g"))}static get Kaj(){return W.eje||(W.eje=RegExp("([A-Z])",
"g"))}static get Q3g(){return W.R7d||(W.R7d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static zjd(ha){return W.x7e(ha.toString())}static x7e(ha){return W.Q3g.test(ha)?ha.replace(W.Laj,"$1 ").replace(W.Kaj,' "$1"').trim():ha}static wlj(ha){const Wa=ha.lastIndexOf("!");return ha.substring(0,-1<Wa?Wa+1:0)+W.x7e(ha.substring(-1<Wa?Wa+1:0,ha.length))}}W.fje=null;W.eje=null;W.R7d=null;Object(t.a)(W,"RangeAriaExtensions",
null,[]);class X{constructor(){this.activeItemName=null;this.Ymf=!1;this.tableName=null;this.A1a=0;this.wCc=!1}}Object(t.a)(X,"SelectionReadoutState",null,[]);a(66);var Aa=a(76);class Q{constructor(ha,Wa,ca,ja,ua){this.gridReadoutNotifier=null;this.scb=!1;this.dta=this.dqb=null;this.Ida=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):x.h(this.$).gb||this.r2b.vq()};
this.BMi=()=>{if(!x.h(this.$).ha.Ta.Zsd){var Za,Pa=({activeCell:Za}=this.TNh()).returnValue;this.readText(Pa,Za)}};this.Np=()=>{const Za=this.activeCell;this.readText("Editing",Za);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Za&&Za.Kfc&&!x.h(this.$).Jbf||this.r2b.cancel()};this.Pc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.Ida(),this.scb&&x.h(this.$).inRangePicker&&1===Aa.a.Db&&(null===this.dqb?this.dqb=K.a.instance.create(this.VKd,Q.GWc,"readSelectedRanges"):this.dqb.vq()))};this.$=Wa;this.ariaLiveNotifier=ha;this.sparklineManager=ja;this.tableManager=ca;this.WD=new X;this.P7a=S.P7a();this.scb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.P7a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=ua:this.gridReadoutNotifier=Wa.da.Aa(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Q.GWc=700);this.r2b=K.a.instance.create(this.BMi,Q.GWc,Y.a.Itj,!1);this.Oj()}get activeCell(){return x.h(this.$).Ub(null)}dispose(){this.$&&this.gk();G.a.Ia(this.r2b);this.sparklineManager=this.$=this.r2b=null}e2e(ha,Wa,ca=!0){if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:7449834_NoReadoutWhenFindAndReplaceDialogOpen")&&this.$.rb.Mv&&null!==this.$.rb.dh&&null!==this.$.rb.dh.pc&&"FindAndReplaceDialog"===this.$.rb.dh.pc||!ha)return"";
var ja=this.$.da;const ua=new Sys.StringBuilder;this.pSg(ua,ha,Wa);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Za=this.tableManager.oka(ha.range);(null===Za||void 0===Za?0:Za.$Vd)&&this.vve(ua,Za);Za=this.tableManager.Bn(ha.range);(null===Za||void 0===Za?0:Za.yba)&&this.vve(ua,Za)}Za=ha.wba?this.X4e(ha):ha.text;v(ua,Za);Za=this.$.activeItemName;this.WD.activeItemName!==Za&&(v(ua,Za),this.WD.activeItemName=Za);Za=1===Wa.length?aa.K(Wa).isSingle?"":w.a.instance.ga(852):
String.format(w.a.instance.mb(31),Wa.length);v(ua,Za);for(var Pa of Wa)v(ua,W.zjd(Pa)),1===Wa.length&&Q.Xui(Pa)&&(Za=x.h(this.$).Da.rs(Pa.bottomRight),void 0!==Za&&null!==Za&&Za.text&&(Za=Za.wba?this.W4e(Za,Za.text):Za.text,v(ua,Za)));Pa=ha.cell;Pa=this.i_h(Pa.eqj,Pa.S6g);v(ua,Pa);this.ZRg(ua,ha);ca&&(ha.t8a?v(ua,w.a.instance.ga(840)):ha.Lxa&&v(ua,w.a.instance.ga(841)));if(ha.hasAutoFilter||ha.d5)this.qSg(ua,ha.hasAutoFilter?ha.cell.autoFilterType:ha.cell.m4i),ca&&v(ua,w.a.instance.ga(843));U.c(this.$,
ha.range)&&v(ua,w.a.instance.ga(847));this.WRg(ua,ha);ca=(ca=ja.Aa(14))?ca.ROh():"";v(ua,ca);ha.pB&&(ca=x.h(this.$).Da.rs(ha.range),ca=!!ca&&ca.$bf,Q.lDj(ha)?Q.XRg(ua,ha):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&ca?v(ua,w.a.instance.ga(845)):v(ua,w.a.instance.ga(844)));ha.cR&&(v(ua,w.a.instance.ga(846)),ha.Qyb&&v(ua,String.format(w.a.instance.mb(16),ha.Ajh)),v(ua,ha.iconName));ha.hasRichValueIcon&&(Pa=this.$.da.Aa(271),ca="",Pa&&ha.cell.lrf&&(Pa=Pa.UU(ha.cell.lrf))&&
Pa.DomainId.Id!==Q.P4j&&(ca=Pa.Name),ha.cell.ali?(v(ua,String.format(w.a.instance.mb(187),ca)),v(ua,w.a.instance.ga(1803))):(v(ua,String.format(w.a.instance.mb(185),ca)),v(ua,w.a.instance.ga(1802))));this.xai(ha)&&v(ua,Q.JVh(ha));(ja=ja.Aa(231))&&v(ua,ja.i5e(Wa,!0));1===Wa.length&&Wa[0].isSingle&&Q.kDj(ha,Wa[0],this.$)&&(Wa=this.$.da.Aa(271))&&v(ua,Wa.bPh());ha.iQb&&ha.jQb&&v(ua,ha.jQb);(Wa=ha.cell.B2g)&&v(ua,Wa);ha.NNa&&ha.qIb&&(ha=ha.vHd)&&(v(ua,w.a.instance.ga(1979)),v(ua,ha));return ua.toString()}EAe(ha){this.dta=
this.WD;this.WD=Object(C.a)(new X,{activeItemName:this.dta.activeItemName,wCc:ha?this.dta.wCc:!1,tableName:ha?this.dta.tableName:"",A1a:ha?this.dta.A1a:-1})}p_f(){this.dta&&(this.WD=this.dta,this.dta=null)}i_h(ha,Wa){return 2===ha||2===Wa?w.a.instance.ga(874):1===ha||1===Wa?w.a.instance.ga(875):""}X4e(ha){return this.W4e(ha.cell,ha.text)}pSg(ha,Wa,ca){if(ca&&1===ca.length&&ca[0].isSingle){ca="";var ja=this.tableManager.oka(Wa.range);if(ja){ca=ja.pivotTableName;this.HZc(ha,ca);var ua=ja.Hic?w.a.instance.ga(835):
"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(ua+=(ja.altText?ja.altText+" . ":"")+(ja.altTextSummary?ja.altTextSummary:""));this.xve(ha,!0,ca,ua);v(ha,this.tableManager.Ksi(ja,Wa.range)?w.a.instance.ga(837):"");v(ha,this.tableManager.tmi(ja,Wa.range)?w.a.instance.ga(836):"")}else if(ja=this.tableManager.Bn(Wa.range)){ca=(ua=x.h(this.$).Ab.Cj(Wa.range))?ua.name:"";this.HZc(ha,ca);let Za="";ua&&(Za=(ua.BUa?ua.BUa+" . ":"")+(ua.CUa?ua.CUa:""));this.xve(ha,
!1,ca,Za);v(ha,this.tableManager.dkf(ja,Wa.range)?w.a.instance.ga(836):"")}else this.HZc(ha,ca),this.WD.tableName="",this.WD.A1a=-1}}HZc(ha,Wa){Wa!==this.WD.tableName&&this.WD.tableName&&(ha.append(w.a.instance.ga(this.WD.wCc?834:833)),v(ha," "+this.WD.tableName))}xve(ha,Wa,ca,ja){ca!==this.WD.tableName&&(ha.append(w.a.instance.ga(Wa?832:831)),v(ha," "+ca),v(ha,ja),this.WD.tableName=ca,this.WD.wCc=Wa,this.WD.A1a=-1)}vve(ha,Wa){const ca=x.h(this.$).ha.ra.activeCell;if(ca.top!==Wa.top&&ca.left!==this.WD.A1a){ha.append(w.a.instance.ga(836));
Wa=new P.Range(Wa.top,ca.left,Wa.top,ca.left,!0,!0);v(ha,W.zjd(Wa));if(Wa=x.h(this.$).Ub(Wa))Wa=Wa.wba?this.X4e(Wa):Wa.text,v(ha,Wa);this.WD.A1a=ca.left}}W4e(ha,Wa){const ca=ha.M6a;return ha.Gwa?String.format(w.a.instance.mb(14),Wa,ca):String.format(w.a.instance.mb(13),Wa,W.wlj(ca))}Oj(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var ha=x.h(this.$);f.ULS.shipAssertTag(537153929,0,!!ha,"Can't register to grid's events");ha&&(ha.Vb.Zk(this.Np),ha.Da.lw(this.Ida),
ha.FC(this.Ida),this.scb&&ha.Vb.Qm(this.jg.bind(this)),ha=ha.ha,f.ULS.shipAssertTag(537153928,0,!!ha,"Can't register to selectionManager's events"),ha&&(ha.hH(this.Pc),ha.fH(this.Ida),ha.Ta.c3(this.Ida),this.scb&&(this.VKd=this.VKd.bind(this))))}}gk(){if(this.$){var ha=x.h(this.$);ha&&(ha.Vb.Uk(this.Np),ha.Da.jx(this.Ida),ha.aE(this.Ida),this.scb&&ha.Vb.fm(this.jg),ha=ha.ha)&&(ha.kG(this.Ida),ha.tL(this.Ida),ha.Ta.yna(this.Ida))}}readText(ha,Wa){this.P7a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?
this.gridReadoutNotifier.readText(ha):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(ha),this.scb&&!Wa||this.ariaLiveNotifier.UXj(Wa))}jg(){this.dqb&&this.dqb.cancel()}VKd(){this.readText(this.y2h())}y2h(){let ha="";x.h(this.$).ha.rangePicker.nL.forEach(()=>{ha+=void 0});return ha+=" selected"}TNh(){let ha;ha=null;var Wa=x.h(this.$).ha;if(1!==Wa.Ne&&!Wa.Ta.$b)return f.ULS.sendTraceTag(537153927,
0,15,`selectionManager.CommandSelectionMode=${Wa.Ne} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:ha};switch(Wa.Ne){case 2:return{returnValue:this.RQh(Wa),activeCell:ha};case 64:var ca=Wa.Ta.$b.floatingObject,ja="";if(Wa=Wa.Ta.$b.$s||Wa.Ta.$b.Kd)ja=(ja=Wa.firstChild)?m.DOMElementExtensions.getTextContent(ja):"";return{returnValue:String.format(w.a.instance.mb(53),Q.jcc(ca.altText,ca.altTextDescription,ca.name),ja,ca.altTextDescription),activeCell:ha};case 4:return{returnValue:Q.hRg(Wa.Ta.$b.floatingObject),
activeCell:ha};case 512:return{returnValue:na.a.E3e(Wa.Ta.$b.floatingObject.C$c),activeCell:ha};case 8:return ca=Wa.Ta.$b.floatingObject,{returnValue:String.format(w.a.instance.mb(51),ca?ca.name:""),activeCell:ha};case 1:return ha=this.activeCell,{returnValue:this.e2e(ha,Wa.ra.selectedRanges),activeCell:ha}}return{returnValue:"",activeCell:ha}}RQh(ha){const Wa=new Sys.StringBuilder;Wa.append(Q.h3g(ha));const ca=this.$.da.Aa(231);ca&&v(Wa,ca.i5e(ha.Ta.$b.floatingObject,!1));return Wa.toString()}xai(ha){ha=
ha.iif();let Wa=!1;this.WD.Ymf!==ha&&(this.WD.Ymf=ha,Wa=!0);return Wa}ZRg(ha,Wa){if(Wa.$yb)if(Wa=this.sparklineManager.v3h(Wa)){var ca=w.a.instance,ja=ca.ga;a:switch(Wa.type){case 0:var ua=828;break a;case 1:ua=829;break a;default:ua=830}ca=ja.call(ca,ua);v(ha,String.format(w.a.instance.mb(25),ca));Wa=String.format(w.a.instance.mb(24),W.zjd(Wa.kLj));v(ha,Wa)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),v(ha,String.format(w.a.instance.mb(25),""))}qSg(ha,
Wa){switch(Wa){case 1:case 11:v(ha,w.a.instance.ga(848));break;case 6:v(ha,w.a.instance.ga(848));v(ha,w.a.instance.ga(850));break;case 7:v(ha,w.a.instance.ga(848));v(ha,w.a.instance.ga(851));break;case 2:v(ha,w.a.instance.ga(849));v(ha,w.a.instance.ga(850));break;case 3:v(ha,w.a.instance.ga(849));v(ha,w.a.instance.ga(851));break;default:v(ha,w.a.instance.ga(849))}}WRg(ha,Wa){var ca;const ja=this.$.da.Aa(65);Wa=ja?ja.hLa(Wa.range):null;let ua="";const Za=Object(J.a)(445,Wa);if(Wa)ua=!Wa.Z7a&&Za&&Za.wui?
String.format(w.a.instance.mb(29),Za.CPj):String.format(w.a.instance.mb(23),Wa.author);else if(null===(ca=null===ja||void 0===ja?void 0:ja.Xm)||void 0===ca?0:ca.CF)ua=String.format(w.a.instance.mb(28),ja.Xm.eO.author);v(ha,ua)}static hRg(ha){return String.format(w.a.instance.mb(52),Q.jcc(ha.altText,ha.altTextDescription,ha.name),ha.altTextDescription)}static JVh(ha){return w.a.instance.ga(ha.iif()?838:839)}static jcc(ha,Wa,ca){return ha||Wa?ha:ca}static h3g(ha){var Wa=ha.Ta.$b;ha=Wa.floatingObject;
const ca=ha.Vc,ja=ca.ChartTitle,ua=ha.altText,Za=ha.altTextDescription,Pa=!!(ca.Attributes&4);return(Wa=Wa.getSelectionDescription())?Wa:ca.DataRangeForDisplay?String.format(w.a.instance.mb(Pa?49:47),Q.jcc(ua,Za,ha.name),Za,ja,w.a.instance.ga(L(ca.ChartCategory)),ca.DataRangeForDisplay):String.format(w.a.instance.mb(Pa?50:48),Q.jcc(ua,Za,ha.name),Za,ja,w.a.instance.ga(L(ca.ChartCategory)))}static lDj(ha){return b.EwaSettings.oa(101)&&(ha.H7a||ha.Fic)}static XRg(ha,Wa){Wa.gUa?Wa.H7a?v(ha,String.format(w.a.instance.mb(26),
Wa.gUa.topLeft.toString())):Wa.Fic&&(Wa=Wa.gUa.MS(),v(ha,String.format(w.a.instance.mb(27),(Wa.LastColumn-Wa.FirstColumn+1).toString(),(Wa.LastRow-Wa.FirstRow+1).toString()))):f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static kDj(ha,Wa,ca){return ha.pB||!b.EwaSettings.oa(136)?!1:(ha=ca.da.Aa(271))?ha.dic(Wa):!1}static Xui(ha){return ha.top===ha.bottom&&ha.left+1===ha.right||
ha.top+1===ha.bottom&&ha.left===ha.right}}Q.P4j=268435712;Q.GWc=500;Object(t.a)(Q,"SelectionReadoutHandler",null,[884,3]);var fa=a(55),Ca=a(698);class ia extends e.a{constructor(ha){super();this.$=ha;this.Fb()}create(){const ha=this.$.da,Wa=z.GetServiceTaskFactory.Na(ha,211,212,this.Ya),ca=z.GetServiceTaskFactory.Na(ha,66,134,this.Ya),ja=z.GetServiceTaskFactory.Na(ha,240,239,this.Ya);let ua=fa.Task.Ra(null);b.EwaSettings.xb()&&(ua=z.GetServiceTaskFactory.Na(ha,244,315,this.Ya));A.TaskExtensions.za(A.TaskExtensions.Ed([Wa,
ca,ja,ua],this.ka),()=>{const Za=Object(Ca.a)(this.$.da,226,()=>new Q(Wa.result,this.$,ca.result,ja.result,ua.result));this.ob(Za)},this.$.ka,3)}static la(ha){ha.da.Ga(227,new ia(ha))}}Object(t.a)(ia,"SelectionReadoutHandlerFactory",e.a,[]);class Ra{constructor(ha,Wa){this.$=Wa;this.ariaLiveNotifier=ha}QSf(){const ha=this.TOh();this.ariaLiveNotifier.xcb(ha,h.a.Spb)}TOh(){const ha=new Sys.StringBuilder;this.$.workbookContext&&v(ha,this.$.workbookContext.WorkbookFileName);v(ha,w.a.instance.ga(854));
v(ha,this.VOh());v(ha,this.UOh());v(ha,w.a.instance.ga(855));return ha.toString()}VOh(){return this.$.isEditMode?w.a.instance.ga(859):w.a.instance.ga(860)}UOh(){var ha=this.$3j();const Wa=this.$.va.na;ha=1!==ha?String.format(w.a.instance.mb(32),ha):w.a.instance.ga(853);ha=new Sys.StringBuilder(ha);Wa&&Wa.sheetName&&(ha.append(u.wyd),ha.append(String.format(w.a.instance.mb(33),Wa.sheetName)));return ha.toString()}$3j(){let ha=0;for(const Wa of this.$.va.items)Wa.visible&&ha++;return ha}}Object(t.a)(Ra,
"WorkbookReadout",null,[]);class Ya{constructor(ha,Wa,ca){this.EFf=()=>{this.m4d.QSf();this.ariaLiveNotifier.setEnabled(!0)};this.$=Wa;this.ariaLiveNotifier=ha;this.m4d=new Ra(ha,Wa);this.Dbc=ca.ejd(this.$);this.Dbc.CNg(this.EFf)}dispose(){this.Dbc&&this.Dbc.cjj(this.EFf);this.Dbc=this.ariaLiveNotifier=this.$=null}}Object(t.a)(Ya,"EmbeddedWorkbookReadoutHandler",null,[3]);class Ga{constructor(ha,Wa){this.tW=()=>{this.Dd||this.Uue()};this.Dd=!1;this.DZ=Wa.AZ;this.ariaLiveNotifier=ha;this.m4d=new Ra(ha,
Wa);this.DZ&&this.DZ.kR?this.Uue():this.Oj()}dispose(){this.gk();this.ariaLiveNotifier=this.DZ=null;this.Dd=!0}Oj(){if(this.DZ){this.DZ.pv(this.tW);this.DZ.Da.lw(this.tW);this.DZ.FC(this.tW);var ha=Object(J.a)(250,this.DZ);ha&&(ha.Vb.Zk(this.tW),ha.ha.hH(this.tW),ha.ha.fH(this.tW),ha.ha.Ta.c3(this.tW))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}gk(){if(this.DZ){this.DZ.Da.jx(this.tW);this.DZ.aE(this.tW);const ha=Object(J.a)(250,this.DZ);
ha&&(ha.Vb.Uk(this.tW),ha.ha.kG(this.tW),ha.ha.tL(this.tW),ha.ha.Ta.yna(this.tW))}}Uue(){this.m4d.QSf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.gxj();this.dispose()}}Object(t.a)(Ga,"WorkbookReadoutHandler",null,[3]);class da extends e.a{constructor(ha){super();this.$=ha;this.Fb()}create(){const ha=z.GetServiceTaskFactory.Na(this.$.da,211,212,this.Ya);if(this.$.MK){const Wa=z.GetServiceTaskFactory.Na(this.$.da,12,477,this.Ya);A.TaskExtensions.za(A.TaskExtensions.Ed([ha,Wa],this.$.ka),
()=>{const ca=Object(Ca.a)(this.$.da,228,()=>new Ya(ha.result,this.$,Wa.result));this.ob(ca)},this.$.ka,3)}else A.TaskExtensions.za(ha,Wa=>{const ca=Object(Ca.a)(this.$.da,228,()=>new Ga(Wa.result,this.$));this.ob(ca)},this.$.ka,3)}static la(ha){ha.da.Ga(229,new da(ha))}}Object(t.a)(da,"WorkbookReadoutHandlerFactory",e.a,[]);a.d(E,"a",function(){return Z});const Z=()=>{c.a.Fa(ha=>{y.la(ha);b.EwaSettings.xb()?H.la(ha):S.la(ha);ia.la(ha);da.la(ha)})}},1160:function(t,E,a){var c=a(9);t=a(0);var b=a(695),
e=a(48),f=a(37),d=a(15),h=a(4),m=a(31),l=a(5),w=a(24),n=a(76),x=a(58);class r{constructor(Oa,ib){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=Oa;this.sortType=ib}tV(){return this.autoFilterOptions}}Object(t.a)(r,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[145]);class u{constructor(Oa){this.autoFilterOptions=null;this.autoFilterOptions=Oa}tV(){return this.autoFilterOptions}}Object(t.a)(u,"MacroRecorderRangeItemFilteredPayload",null,[145]);var v=a(1130),B=a(40),z=a(374),
A=a(188),y=a(60),D=a(162),I=a(211),M=a(47),T=a(46),S=a(12),H=a(283),C=a(1),G=a(184),J=a(22),L=a(282),P=a(21);class aa{constructor(Oa,ib){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=Oa;this.tableRange=B.l(Oa.Ranges[0],Oa.SheetName);this.styleIndex=ib}}Object(t.a)(aa,"MacroRecorderTableStyleAppliedPayload",null,[145]);class U extends aa{constructor(Oa,ib,La,db){super(Oa,La);this.isCreation=this.hasHeaders=!1;this.hasHeaders=ib;this.isCreation=db}}Object(t.a)(U,"MacroRecorderRangeFormatedAsTablePayload",
aa,[]);class K{constructor(Oa,ib,La){this.description=this.title=this.tableRange=null;this.tableRange=Oa;this.title=ib;this.description=La}Bn(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(t.a)(K,"MacroRecorderTableAltTextEditedPayload",null,[145]);class Y{constructor(Oa,ib){this.newName=this.oldName=null;this.oldName=Oa;this.newName=ib}}Object(t.a)(Y,"MacroRecorderTableRenamedPayload",null,[145]);class na{constructor(Oa){this.originalRange=
null;this.originalRange=Oa}}Object(t.a)(na,"MacroRecorderTableResizedPayload",null,[145]);class W{constructor(Oa,ib,La){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=Oa;this.optionType=ib;this.isPivotTable=La}}Object(t.a)(W,"MacroRecorderTableStyleOptionToggledPayload",null,[145]);var X=a(29),Aa=a(44);class Q{constructor(Oa){this.tableName=null;this.tableName=Oa}}Object(t.a)(Q,"MacroRecorderTableConvertedToRangePayload",null,[145]);var fa=a(810);class Ca{constructor(Oa,
ib,La){this.ttd=!1;this.sharedSheetRange=ib;this.$=Oa;this.ei=this.$.Kb.Qg("UserAction","ConvertToRangeManager");this.tableName=La}Abb(){this.ei.start();const Oa=this.$.pa.xa.Wb();return fa.i(this.$.pa.xa,this.sharedSheetRange,ib=>{this.showDialog(ib)},null,null,null,Oa)}showDialog(Oa){d.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.ei.Bc} milliseconds`);Oa&&!H.a(Oa)&&((this.ttd=Oa.Result)?(Oa=X.a.dd(3,2,0,738,0,-66108047,"ConvertToRange"),
f.TaskExtensions.za(Aa.a(this.$).uj(Oa),ib=>{d.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.ei.Bc} milliseconds`);0===ib.result&&this.hah()},this.$.ka,11)):this.iah());this.ei.stop();d.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.ei.Bc} milliseconds`)}Fze(){const Oa={};Oa.IsQueryTable=this.ttd;Oa.Range=this.sharedSheetRange;return Oa}hah(){const Oa=this.$.pa.xa;d.ULS.sendTraceTag(537151190,
0,50,"Convert To Range initiated for Query Table");this.shf(194,(ib,La,db)=>fa.d(Oa,this.Fze(),ib,La,db,null));d.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}iah(){const Oa=this.$.pa.xa;d.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.shf(193,(ib,La,db)=>fa.c(Oa,this.Fze(),ib,La,db,null),()=>new Q(this.tableName));d.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}shf(Oa,ib,La=null){z.a(this.$.userOperationManager,
ib,db=>new A.a(Oa,0,db,void 0,La),null)}}Object(t.a)(Ca,"ConvertToRangeManager",null,[]);var ia=a(1129),Ra=a(950),Ya=a(13);class Ga extends Ra.a{constructor(Oa,ib){super(Oa);this.yPb=ib}get pc(){return"FormatAsTableDialog"}get dC(){return 215}get Ql(){return Ya.a.instance.ga(732)}ik(){const Oa=B.s(this.haa.TableRange);return()=>new U(Oa,this.hasHeaders,this.yPb,!0)}nH(){const Oa=B.s(this.haa.TableRange),ib=this.haa.HasTotalRow;return(La,db,Ab)=>fa.h(this.$.pa.xa,Oa,this.hasHeaders,!1,ib,this.yPb,
La,db,Ab,null)}}Object(t.a)(Ga,"FormatAsTableReactDialog",Ra.a,[]);Ra=a(285);var da=a(88);class Z extends Ra.a{constructor(Oa){super(Oa);this.qPj=(ib,La)=>{1===ib&&this.XTj(B.D(this.NMf(La[Z.$Rf])))};this.Dxb=ib=>{ib=this.qid(ib);return this.Efd(ib)};this.gridView=P.h(Oa);this.ra=this.gridView.ha.ra;this.Xrc=this.gridView.Ab.Cj(this.ra.activeCell).usedRange;Oa=this.vN(this.Xrc.toString());this.initializeAndShow(Ya.a.instance.ga(733),this.qPj,Oa)}get pc(){return"ResizeTableDialog"}NMf(Oa){Oa=Oa.startsWith("=")?
Oa.substring(1,Oa.length):Oa;if(({sheetName:Oa,range:ib}=B.Z(Oa,this.$.va)).returnValue&&ib){var ib=B.v(ib,this.$);ib.SheetName=J.a.equals(Oa,"",!0)?this.$.na.name:Oa;return ib}return null}vN(Oa){return{[Z.KV]:"ResizeTableDialog",[Z.$Rf]:Oa,["getInputErrorIfInvalid"]:this.Dxb}}qid(Oa){Oa=this.NMf(Oa);if(!Oa)return 1;const ib=B.D(Oa);return J.a.equals(Oa.SheetName,this.$.na.sheetName,!0)&&this.Xrc.top===ib.top&&this.Xrc.Fd(ib)?0:2}Efd(Oa){let ib="";switch(Oa){case 1:ib=Ya.a.instance.ga(75);break;case 2:ib=
da.a.xf(Ya.a.instance.ga(74))}return ib}XTj(Oa){this.$.Xc(-1400250766,n.a.Db,8,{["ResizeTableRange"]:Oa,["OriginalTableRange"]:this.Xrc})}}Z.KV="id";Z.$Rf="range";Object(t.a)(Z,"ResizeTableDialog",Ra.a,[]);class ha extends Ra.a{constructor(Oa){super(Oa);Oa=P.h(this.$);Oa=Oa.Ab.Cj(Oa.ha.ra.activeCell);J.a.sh(Oa.BUa)?this.rGd="":this.rGd=Oa.BUa;J.a.sh(Oa.CUa)?this.qGd="":this.qGd=Oa.CUa;Oa=this.vN(this.rGd,this.qGd);this.initializeAndShow(Ya.a.instance.ga(742),this.fPj,Oa)}get pc(){return"TableAltTextDialog"}fPj(Oa,
ib){1===Oa&&(Oa=ib[ha.JRj],ib=ib[ha.Nlh],Oa===this.rGd&&ib===this.qGd||this.$.Xc(868579142,n.a.Db,8,{["Title"]:Oa,["Description"]:ib}))}vN(Oa,ib){return{["id"]:"AltTextDialog",["title"]:Oa,["description"]:ib}}}ha.KV="id";ha.JRj="title";ha.Nlh="description";Object(t.a)(ha,"TableAltTextDialog",Ra.a,[]);var Wa=a(774),ca=a(775),ja=a(112),ua=a(70),Za=a(55),Pa=a(33),ka=a(145),ra=a(102);class ba{constructor(Oa,ib,La,db){this.menuId=null;this.JSa=-1;this.zPi=Ab=>{if(!H.a(Ab)){const pb=P.h(this.$);var Mb=
new w.Range(1,1,1,1,!0,!1);Mb=B.v(Mb,this.$);null!=Ab.Result&&(ka.a("CreateSampleTable.NewSheet"),Mb.SheetName=Ab.Result.toString());pb.gg(Mb,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.kKf=()=>{this.Pda()};this.o_i=Ab=>{if(!(this.ra.eNa()||(!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||H.a(Ab)||this.xNa())&&H.a(Ab)&&this.xNa())){Ab=this.ra.activeCell;var Mb=this.ra.activeRange;const pb=this.tableManager.Kg.usedRange;
2===this.JSa&&D.g(this.tableManager.Kg)&&Ab.bottom===pb.bottom&&(Mb=Mb.V5?new w.Range(Mb.top-1,Mb.left,Mb.bottom-1,Mb.right,!1,!0):new w.Range(Mb.top,Mb.left,Mb.bottom-1,Mb.right,!1,!0),Ab=Mb.contains(Ab)?Ab:w.Range.Qc(Mb.bottom,Ab.left),P.h(this.$).ha.updateSelection(Mb,Ab,0,3))}};this.HZi=Ab=>{H.a(Ab)?(d.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.af()):d.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};
this.GZi=()=>{d.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.af()};this.IZi=(Ab,Mb)=>{Mb&&this.PS(Mb);H.b(Ab,-569193796)&&(ua.a(this.$).hd.CM(-569193796),this.wyi(Ab.Errors[0]))};this.$=Oa;this.tableManager=ib;this.namedSheetViewPublic=La;this.frame=this.$.frame;this.ha=P.h(this.$).ha;this.ra=this.ha.ra;this.Fz=C.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.uB=Pa.a.uB(this.$);this.tableStyleManager=db;this.tableStyleManager.IOg(this.kKf)}nc(Oa,
ib){switch(ib){case -544558380:return!(this.tableManager&&this.ra.IK()&&!this.xNa()&&D.d(this.tableManager.Kg));case 1544516694:return!(this.tableManager&&(this.ra.IK()?!this.xNa():this.ra.eNa()));case -697806646:case 323142015:return!this.ra.IK();case 341449783:case 2128797448:return C.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ra.IK()?!this.xNa():this.ra.eNa())):!(this.tableManager&&this.tableManager.Bud(this.ra.activeCell));case -123538519:return!(this.ra.IK()&&
this.tableStyleManager&&this.tableStyleManager.Cud());case 756677940:return!(C.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename")&&this.wki());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.xki());case 844144422:return!this.ra.IK();case -723113214:return!this.ra.IK();case 1371713064:case 875133075:return!Pa.a.uB(this.$)||ra.k(this.$.lg)}return!1}executeCommand(Oa,ib,La){var db;Oa=f.TaskExtensions.Vj();const Ab=this.$.pa.xa;let Mb=null,pb=1;const Qb=
ib.command,xb=this.$.pa.xa.Wb();let pa=null;if(this.uB)switch(Qb){case -2058042992:case 504133448:case -798968736:case 477776686:I.d(this.$,La.TopCellAddress,Qb,null);break;case -1400250766:I.d(this.$,La.OriginalTableRange,Qb,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:const ya=P.h(this.$);I.d(this.$,ya.ha.ra.activeCell,Qb,null)}switch(Qb){case -2058042992:const ya=x.a.$h(La[n.a.ng]);C.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&
!ya.CriteriaType&&(ya.CriteriaType=0);ba.h4f(this.$,ya);Mb=(V,va,wb)=>fa.a(Ab,ya,null,null,!1,!1,!1,Wa.a.T5a(ja.a.yHa,ca.a.clearAutoFilter,V),va,wb,null);pb=176;pa=()=>new u(ya);break;case 504133448:case -798968736:case 477776686:const Ea=x.a.$h(La[n.a.ng]),Na=La.TopCellAddress;ba.h4f(this.$,Ea);const kb=504133448===ib.command?1:-798968736===ib.command?2:3;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&Na){La=this.tableManager.Bn(Na);if(!La){var Ma=this.$.va.na;
(null===(db=B.D(Ma.g1))||void 0===db?0:db.contains(Na))?La=B.D(Ma.g1):d.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(La&&!this.$.$Zc([La],!0,1))break}else if(La&&!this.$.aq([La],!0,1))break}Mb=(V,va,wb)=>y.H(Ab,Ea,kb,L.b(V,this.IZi),va,wb,Na,xb);pb=177;pa=()=>new r(Ea,kb);break;case 341449783:case 2128797448:this.JSa=341449783===Qb?0:2;({ZCa:Mb,operationName:pb,ik:pa}=this.toggleTableStyleOption(Ab,
xb));break;case -712419744:this.Fz?this.dhf(La[l.a.event]):this.dhf(null);break;case 875133075:case 1371713064:let lb=B.r(this.ra.selectedRanges,this.$);if(!lb)break;const oa=this.j2h(La);Mb=(V,va,wb)=>fa.e(Ab,lb,oa,L.b(V,this.zPi),va,wb,null,xb);db="TestHost"===this.$.ya.DocumentHostInfo.HostTier;d.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.ya.HostName||db,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");pb=1025;break;case 1868184698:if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&
({KAb:db,ZCa:Mb,ik:pa}=this.Wgg(null,xb),db)){pb=206;break}new ia.a(this.$);break;case 844144422:new Z(this.$);break;case 1544516694:case -544558380:if(db=La[n.a.Kc])this.JSa=this.r4h(db),-1!==this.JSa&&({ZCa:Mb,operationName:pb,ik:pa}=this.toggleTableStyleOption(Ab,xb));break;case 756677940:if(this.xNa()&&this.dmf()){d.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}const Ba=
La.Text,sa=this.FXh();if(sa){Mb=(va,wb,fc)=>fa.j(Ab,Ba,sa,L.b(va,this.HZi),L.a(wb,this.GZi),fc,xb);pb=217;let V=null;this.tableManager.Kg?V=this.tableManager.Kg.name:this.tableManager.$Id?V=this.tableManager.$Id.name:d.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");V&&(pa=()=>new Y(V,Ba))}else return d.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),
Za.Task.Ra(!1);break;case 323142015:if(this.xNa())break;return(new Ca(this.$,this.Xfd(),this.tableManager.Kg.name)).Abb();case -1400250766:pb=211;Mb=this.eoj(La,Ab,xb);const qb=B.m(La.OriginalTableRange,this.$.va.na);pa=()=>new na(qb);break;case 1872288872:this.tableManager.r$i();break;case -123538519:const Jb=this.q4h(La);db=J.a.contains(La[n.a.Kc],l.a.OIb,!0)||J.a.contains(La[l.a.vG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";d.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${db} with style index ${Jb.toString()}`);
let Yb=this.q8e();Yb&&(Mb=(V,va,wb)=>fa.b(Ab,Yb,Jb,V,va,wb,null,xb),pa=()=>new aa(Yb,Jb),pb=212);break;case 753331043:db=La[n.a.Kc];if(!db)break;const jb=Number.parseInvariant(db);if(this.ra.IK()){d.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${jb}`);let V=this.q8e();V&&(Mb=(va,wb,fc)=>fa.h(Ab,V,!1,!1,!1,jb,va,wb,fc,null,xb),pa=()=>new U(V,!1,jb,!1),pb=215);break}if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&
({KAb:La,ZCa:Mb,ik:pa}=this.Wgg(jb,xb),La)){pb=215;break}d.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${jb}`);new Ga(this.$,Number.parseInvariant(db));break;case 71074531:const ab=La.HasHeader,vb=La.TableRange;Mb=(V,va,wb)=>fa.f(Ab,vb,ab,!1,!1,V,va,wb,null);pa=()=>new v.a(ab,vb);pb=206;break;case -723113214:new ha(this.$);break;case 868579142:d.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");pb=1022;const Da=La.Title,
Fa=La.Description,nb=this.Xfd();Mb=(V,va,wb)=>fa.g(Ab,Da,Fa,nb,V,va,wb,null);let Ta;this.tableManager.Kg&&(Ma=J.a.sh(this.tableManager.Kg.BUa)?"":this.tableManager.Kg.BUa,Ta=J.a.sh(this.tableManager.Kg.CUa)?"":this.tableManager.Kg.CUa);pa=Da==Ma?()=>new K(nb,void 0,Fa):Fa==Ta?()=>new K(nb,Da,void 0):()=>new K(nb,Da,Fa);break;default:return G.a(Qb)}if(Mb){const ya=Ea=>new A.a(pb,0,Ea,void 0,pa);Oa=!this.namedSheetViewPublic||-2058042992!==Qb&&504133448!==Qb&&-798968736!==Qb&&477776686!==Qb?z.a(this.$.userOperationManager,
Mb,ya,ib):this.namedSheetViewPublic.MTa().continueWith(Ea=>{Ea.result&&z.a(this.$.userOperationManager,Mb,ya,ib)})}return Oa}toggleTableStyleOption(Oa,ib){const La=this.ra.eNa();d.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${La?"PivotTable":"table"} style option ${this.JSa} was toggled.`);const db=this.Xfd();return{ZCa:(Ab,Mb,pb)=>fa.l(Oa,db,this.JSa,L.b(Ab,this.o_i),Mb,pb,null,ib),operationName:196,ik:()=>new W(db,this.JSa,La)}}eoj(Oa,ib,La){const db=Oa.OriginalTableRange,
Ab=B.m(Oa.ResizeTableRange,this.$.va.na),Mb=()=>{this.tableManager.Xdg(db)},pb=Qb=>{Qb.Errors&&this.tableManager.Xdg(db)};return(Qb,xb,pa)=>fa.k(ib,Ab,L.b(Qb,pb),L.a(xb,Mb),pa,null,La)}q4h(Oa){var ib=-1;Oa[n.a.Kc]&&(ib=Oa[n.a.Kc],ib=J.a.contains(ib,l.a.OIb,!0)?this.tableStyleManager.Cxb(ib):Number.parseInvariant(Oa[n.a.Kc]));return ib}j2h(Oa){return(Oa=Oa[n.a.Kc])?Number.parseInvariant(Oa):0}yc(Oa,ib){Oa=!1;switch(ib.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:Oa=
!0;break;case 756677940:Oa=C.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename");break;case 875133075:case 1371713064:Oa=Pa.a.uB(this.$)}return Oa}Lc(Oa,ib,La){Oa=!1;switch(ib){case "PopulateTableMoreStylesMenu":this.menuId=La.MenuId;this.tableStyleManager.Cud()||this.tableStyleManager.X5a("formatAsTableMenu");Oa=this.tableStyleManager.iOf(ib,La);break;case "PopulateTableAccessibleStylesMenu":this.menuId=La.MenuId,this.tableStyleManager.Cud()||this.tableStyleManager.X5a("accessibilityTab"),
Oa=this.tableStyleManager.iOf(ib,La)}return Oa}dispose(){this.tableStyleManager.Wjj(this.kKf)}Pda(){(J.a.contains(this.menuId,"Format",!0)||J.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.ux(this.menuId)}Xfd(){return B.v(this.ra.activeCell,this.$)}FXh(){const Oa=this.tableManager.Svd;return Oa?B.v(Oa,this.$):null}dhf(Oa){if(this.tableManager){var ib=P.h(this.$),La=this.ra.activeCell,db=this.tableManager.Bn(La),Ab=null;if(!db||db.KBa)for(let Mb of ib.tia)for(let pb of Mb)ib=pb.Mt,
La.left>=ib[0]&&La.left<=ib[ib.length-1]&&(Ab=(ib=pb.us(La).vK())?S.DOMElementExtensions.nk(ib,m.a.due):null);else{const Mb=ib.Ub(w.Range.Qc(db.top,La.left));if(this.Fz){M.a.instance.create(()=>{Mb.invoke(8,Oa)},0,T.a.Rdg,!0,!0);return}Ab=Mb.xLa(56).k7a}Ab&&M.a.instance.create(()=>{S.DOMElementExtensions.Ehc(Ab,null)},0,T.a.Rdg,!0,!0)}}r4h(Oa){Oa=Number.parseInvariant(Oa);return-1<Oa&&8>=Oa?Oa:-1}xNa(){return!this.tableManager.Kg}dmf(){return this.tableManager.$Id?!1:(d.ULS.sendTraceTag(537151173,
0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}xki(){const Oa=this.ra.IK(),ib=this.ra.Pg&&!P.h(this.$).Ab.O5(this.ra.ed);return Oa||ib}wki(){return this.ra.IK()||!this.dmf()}u4h(Oa){const ib=[];for(const La of Oa)if(Oa=I.b(this.$,La),null===Oa||void 0===Oa?0:Oa.length)for(const db of Oa)db.usedRange&&!ib.includes(db.usedRange)&&ib.push(db.usedRange);return ib}q8e(){const Oa=this.ra.selectedRanges;let ib=[];if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))ib=
this.u4h(Oa);else for(const La of Oa)P.h(this.$).Ab.O5(La)&&ib.push(La);return ib&&ib.length?B.r(ib,this.$):null}PS(Oa){Pa.a.Cla(this.$)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,430,431,1),ib=>{ib.result.Zea(Oa);d.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ka,3)}wyi(Oa){f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,446,447,0),ib=>{ib.result.khh(this.$,Oa)},this.$.ka,3)}static h4f(Oa,ib){ib.SheetName=
Oa.na.name;ib.NamedObjectView=Oa.ea.isNamedObjectViewMode}Wgg(Oa,ib){let La,db;if(!this.ra.Pg||1!=this.ra.ed.TC)return{KAb:!1,ZCa:La,ik:db};let Ab=B.v(this.ra.ed,this.$);Ab.LastColumn=Ab.FirstColumn+3-1;Ab.LastRow=Ab.FirstRow+4-1;const Mb=B.D(Ab),pb=P.h(this.$);if(!Mb.Mz||!pb.Ab.Mxa(Mb))return{KAb:!1,ZCa:La,ik:db};h.AFrameworkApplication.Hs("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",
!1))return{KAb:!1,ZCa:La,ik:db};if(null==Oa)La=(Qb,xb,pa)=>fa.f(this.$.pa.xa,Ab,!1,!1,!1,Qb,xb,pa,ib),db=()=>new v.a(!1,Ab);else{const Qb=B.s(Ab);La=(xb,pa,Ma)=>fa.h(this.$.pa.xa,Qb,!1,!1,!1,Oa,xb,pa,Ma,ib);db=()=>new U(Qb,!1,Oa,!0)}return{KAb:!0,ZCa:La,ik:db}}}Object(t.a)(ba,"TableCommandHandler",null,[219]);class Ua extends b.a{constructor(Oa){super(Oa)}dispose(){super.dispose()}ld(){const Oa=e.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),ib=e.GetServiceTaskFactory.create(this.$.da,
330,this.ka,this.Ya),La=e.GetServiceTaskFactory.Na(this.$.da,309,310,this.Ya);if(Pa.a.uB(this.$)){const db=e.GetServiceTaskFactory.create(this.$.da,128,this.ka,this.Ya);f.TaskExtensions.za(Za.Task.jJ(Oa,La,ib,db),()=>{this.Zc([new ba(this.$,Oa.result,La.result,ib.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.ka,3)}else f.TaskExtensions.za(Za.Task.jJ(Oa,La,ib),()=>{this.Zc([new ba(this.$,Oa.result,La.result,ib.result)],[2128797448,341449783,1544516694,
-544558380,-123538519,753331043,756677940])},this.$.ka,3)}static la(Oa){b.a.Nd(86,new Ua(Oa))}}Object(t.a)(Ua,"TableCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return Ka});const Ka=()=>{c.a.Fa(Oa=>{Ua.la(Oa)})}},1166:function(t,E,a){t=a(0);var c=a(84),b=a(553),e=a(15);class f{constructor(){this.rHc={}}sHg(Ra){this.rHc[Ra.id.toString()]=Ra}TKi(Ra){const Ya=this.rHc;for(let Ga in Ya)Ya[Ga].notify(Ra,!1);this.rHc={}}w9i(Ra,Ya){Ya&&this.sHg(Ya);return this.sIf(Ra,Ya)}$$c(Ra){this.TKi(Ra)}oQe(Ra,
Ya){Ra.notify(Ya,!0)}}Object(t.a)(f,"AEventEmitter",null,[879]);var d;(function(Ra){Ra[Ra.notStarted=0]="notStarted";Ra[Ra.waiting=1]="waiting";Ra[Ra.shouldRetry=2]="shouldRetry";Ra[Ra.complete=3]="complete"})(d||(d={}));Object(t.b)("EventResultState",d);class h{constructor(){this._state=0}get state(){return this._state}set state(Ra){e.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:d[this._state],["NewState"]:d[Ra]},"ResultType",this.S7e());this._state=Ra}}Object(t.a)(h,
"AEventResult",null,[909]);class m extends h{constructor(){super();this.IUc=this.kmb=null;this.state=0;this.BNc=this.cce=!1}get XR(){return this.kmb}get Joa(){return this.IUc}get Sii(){return this.cce}S7e(){return"GetMoreInfo Result"}}Object(t.a)(m,"GetMoreInfoResult",h,[911,909]);var l=a(4),w=a(80),n=a(39),x=a(688),r=a(376),u=a(164),v=a(644),B=a(576),z=a(106),A=a(25);class y{constructor(Ra,Ya,Ga,da,Z,ha,Wa,ca){this.La=Ra;this.Ah=Ya;this.Ysg=Ga;this.T1=da;this.ke=Z;this.fMc=ha;this.Lxg=Wa;this.vZb=
ca}bej(){this.J$a.Nb(A.a.openUrlInNewTab,z.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.J$a.Nb(A.a.pQa,z.a.frame,Object(c.a)(this,this.pQa,"openDocumentUrl"));l.AFrameworkApplication.eN?this.Ssf():this.J$a.Me(A.a.u9b,z.a.frame,Object(c.a)(this,this.u9b,"documentLoaded"),96)}openUrlInNewTab(Ra,Ya,Ga,da,Z){Z&&Z.MenuItemId&&(e.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:Z.SourceControlId,["AppType"]:B.a[this.Oca]}),n.a.kf(Z.MenuItemId.toString(),"_blank",void 0,
"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}pQa(Ra,Ya,Ga,da,Z){if(Z&&Z.MenuItemId){const ha=l.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),Wa=l.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");e.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ha,Wa);if(ha&&Wa){e.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Z.SourceControlId,["AppType"]:B.a[this.Oca]});Ra=Z.MenuItemId.toString();
const ca={};ca[r.a.kRa]="1";ca[r.a.documentUrl]=Ra;ca[r.a.reason]=v.a.open;e.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.AV().execute(ja=>{ja.Sj(u.a.zua,ca)})}else this.openUrlInNewTab(Ra,Ya,Ga,da,Z)}return 32}u9b(){this.Ssf();return 32}UOa(Ra,Ya,Ga=""){if(Ya&&Ya.MF){const da=x.a[Ya.status];Ya=Ya.MF.getTime();const Z=this.Ew()-Ya;e.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:Ra,["RequestStatus"]:da,
["ElapsedMs"]:Z,["StartTime"]:Ya,["Notes"]:Ga})}else e.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Ra})}Ssf(){var Ra=l.AFrameworkApplication.fa.qa("QPGVCI"),Ya=w.a.oy(document.URL,"wdNewAndOpenCt",Ra);if(Ya){Ya=parseInt(Ya);var Ga=w.a.oy(document.URL,"wdPreviousSession",Ra);Ra=w.a.oy(document.URL,"wdPreviousCorrelation",Ra);var da=l.AFrameworkApplication.fa.qa("NAOPLP");if(l.AFrameworkApplication.eN){var Z=l.AFrameworkApplication.eN.getTime();
!Ya||Ya>Z?e.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:Ya,["DocumentLoadedTime"]:Z,["SessionId"]:Ga,["Correlation"]:Ra}):e.ULS.sendTraceTag(5849683,202,da?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:Z-Ya,["ClickTimestamp"]:Ya,["SessionId"]:Ga,["Correlation"]:Ra})}else e.ULS.sendTraceTag(5849681,202,da?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:Ya,["SessionId"]:Ga,["Correlation"]:Ra})}}get J$a(){return this.La.value}get wFb(){return this.Ah.value}get kyf(){return this.Ysg.value}get Oca(){return this.T1.value}get zoc(){return this.ke.value}get Ew(){return this.fMc}get m0(){return this.Lxg.value}get supportsGetMoreInfoForPersonalStorage(){return this.vZb.value}static get instance(){return y.Ma||(y.Ma=y.oN())}static oN(){return new y(new b.a(()=>l.AFrameworkApplication.ub),new b.a(()=>l.AFrameworkApplication.zd),new b.a(()=>
l.AFrameworkApplication.ta),new b.a(()=>l.AFrameworkApplication.ta.Pa.Ij),new b.a(()=>l.AFrameworkApplication.Fi),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.ta.Pa.m0),new b.a(()=>l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}y.Ma=null;Object(t.a)(y,"NewAndOpenCommonHelpers",null,[878]);var D=a(107);class I{constructor(Ra,Ya,Ga){this.GYb=this.Xi=null;this.WSc=0;this.zDg=Ra;this.ke=Ya;this.z9d=Ga}uQg(){this.WSc=this.Fdb+1}jPd(Ra){this.Xi&&(this.ke.rp(this.Xi),this.Xi=
null);Ra&&(this.WSc=0)}pMj(Ra){const Ya=this.yRj;0<=Ya?(this.uQg(),this.jPd(!1),this.Xi=new D.a(4,1,Ya,Ra,107),this.ke.Eg(this.Xi)):(this.jPd(!0),e.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.z9d}))}get Fdb(){return this.WSc}get yRj(){return this.Fdb>=this.J3f.length?-1:this.J3f[this.Fdb]}get J3f(){if(!this.GYb){const Ra=(this.zDg.value||"0").split(",");this.GYb=[];for(let Ya=0;Ya<Ra.length;Ya++){const Ga=parseInt(Ra[Ya]);isNaN(Ga)?e.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",
{["Action"]:this.z9d,["Entry"]:Ra[Ya]}):Array.add(this.GYb,Ga)}}return this.GYb}}Object(t.a)(I,"RetryHelper",null,[]);var M=a(41),T=a(30);class S extends f{constructor(Ra,Ya){super();this.y2=Ra;this.Lmb=new I(Ya,this.$Eb.zoc,"GetMoreInfo");this.fp=new m}aFi(){this.rzd("Document opened")}Ceh(Ra){return()=>{this.rzd(Ra,!0)}}sIf(Ra,Ya=null){e.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Ra});3===this.fp.state?(Ya&&this.oQe(Ya,this.fp),e.ULS.sendTraceTag(5849619,
202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Ra})):this.rzd(Ra);return this.fp}rzd(Ra,Ya=!1){this.Lmb.jPd(!Ya);1===this.fp.state?e.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Ra,["RetryIndex"]:this.Lmb.Fdb}):(e.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:Ra,["RetryIndex"]:this.Lmb.Fdb}),this.fp.state=1,Ya=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.$Eb.m0,l.AFrameworkApplication.Hi),
this.$Eb.wFb.pha(Ya,1,null,null,[S.qie,S.nme],!1,5,this.Fdh(),this.Edh(Ra),null))}Fdh(){return Ra=>{var Ya=!1;let Ga=!1;var da=!1,Z;l.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(Ra.data.fe?({Gt:Z}=M.d(Ra.data.fe)).returnValue?Z?(da=!0,this.fp.IUc=Z.StorageServiceDisplayName,this.fp.kmb=S.zof(Z.PersonalFileStorageUrl)?Z.PersonalFileStorageUrl:"",""===this.fp.XR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Xa("FileSource")&&(this.fp.kmb=w.a.Rda(l.AFrameworkApplication.breadcrumbFolderUrl)),
Ya=""===this.fp.XR&&""!==this.fp.Joa):e.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):e.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));da||((Z=Ra.data.responseHeaders)?
(this.fp.IUc=(Z[S.nme]||"").toString(),Ya=(Z[S.qie]||"").toString(),this.fp.kmb=S.zof(Ya)?Ya:"",""===this.fp.XR&&"SharePointOnlineConsumer"===l.AFrameworkApplication.fa.Xa("FileSource")?(this.fp.kmb=w.a.Rda(l.AFrameworkApplication.breadcrumbFolderUrl),Ya=""===this.fp.XR&&""!==this.fp.Joa):Ya=""===Ya&&""!==this.fp.Joa):(e.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Ga=!0));da=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.Lmb.Fdb,Ga,Ya,da);this.$Eb.UOa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Ra.data,da);this.a4f(3,Ya,Ga)}}Edh(Ra){return Ya=>{this.$Eb.UOa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ya.data,"Failure");this.a4f(2);this.Lmb.pMj(this.Ceh(Ra))}}a4f(Ra,Ya=!1,Ga=!1){this.fp.state=Ra;this.fp.cce=Ya;this.fp.BNc=Ga;this.$$c(this.fp)}get $Eb(){return this.y2.value}static get instance(){return S.Ma||(S.Ma=S.oN())}static oN(){return new S(new b.a(()=>y.instance),new b.a(()=>
l.AFrameworkApplication.QYh))}static zof(Ra){if(!Ra)return e.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(T.a.wl(Ra).startsWith("https://"))return!0;e.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}S.qie="PersonalFileStorageUrl";S.nme="StorageServiceDisplayName";S.Ma=null;Object(t.a)(S,"GetMoreInfoActor",f,[]);var H=a(103),C=a(97);class G{constructor(Ra,Ya,Ga,da,Z){this.ryg=6E4;this.Yef="inactive";this.$oe=
"active";this.sT=!0;this.ke=Ra;this.rxg=Ya;this.fMc=Ga;this.KZb=da;this.Za=new C.a;Z&&this.iMj();this.eee=this.t5e()}Qpe(Ra){this.Za.addHandler(this.$oe,Ra)}SJg(Ra){this.Za.addHandler(this.Yef,Ra)}iMj(){const Ra=new D.a(5,2,this.ryg,Object(c.a)(this,this.Zdi,"inactiveLoop"),108);this.$di.Eg(Ra)}Zdi(){const Ra=this.t5e(),Ya=this.Ew()-Ra;Ya>this.gDc&&this.sT&&(e.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ya}),this.sT=!1,this.Za.raiseEvent(this.Yef));Ra-this.eee>
this.gDc&&(this.sT=!0,this.Za.raiseEvent(this.$oe));this.eee=Ra}get $di(){return this.ke.value}get t5e(){return this.rxg}get Ew(){return this.fMc}get gDc(){return this.KZb.value}static get instance(){return G.Ma||(G.Ma=G.oN())}static oN(){return new G(new b.a(()=>H.a.instance),()=>l.AFrameworkApplication.twd.getTime(),()=>(new Date).getTime(),new b.a(()=>l.AFrameworkApplication.gDc),!0)}}G.Ma=null;Object(t.a)(G,"InactivityManager",null,[]);var J=a(83),L=a(909);class P extends h{constructor(){super();
this.nge=this.pge=this.oge=null;this.state=this.gne=0;this.BNc=!1}get TAd(){return this.oge}get wxf(){return this.pge}get SAd(){return this.nge}get ERj(){return this.gne}S7e(){return"MruActor Result"}}Object(t.a)(P,"MruResult",h,[908,909]);var aa=a(241);class U{constructor(Ra,Ya,Ga){this.task=null;this.dhc=Ra;this.HGi=Ya;this.taskManager=Ga;this.retryCount=this.nAb=0;this.dSc=this.iDb=null}ori(Ra,Ya){return Ra===aa.a.Ied||20===Ya||18===Ya||3===Ya}Csi(Ra){return 3===Ra||5===Ra||6===Ra||7===Ra||9===
Ra||10===Ra||11===Ra||12===Ra||13===Ra||14===Ra||15===Ra||16===Ra||23===Ra||26===Ra||27===Ra||28===Ra}get Htc(){return this.dSc}reset(){this.nAb=this.retryCount=0;this.dSc=this.iDb=null;this.task&&(this.taskManager.rp(this.task),this.task=null)}$hi(Ra,Ya,Ga,da){this.dSc=String.format("{0}_{1}",Ga,da);if(this.retryCount>=this.HGi)return e.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.ori(Ga,da))return e.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),
!1;if(this.Csi(da)&&1<=this.nAb)return this.iDb=Ga,!1;Ya=Math.max(Ya,this.dhc*Math.pow(2,this.nAb));if(26===da)Ya=Math.max(Ya,3E4);else if(27===da||28===da)Ya=Math.max(Ya,6E4);9===da||412===Ga&&(null==this.iDb||412!==this.iDb)?Ya=500:this.nAb+=1;this.iDb=Ga;this.retryCount+=1;this.task&&this.taskManager.rp(this.task);e.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Ya);this.task=new D.a(2,1,Ya,Ra,107);this.taskManager.Eg(this.task);return!0}}Object(t.a)(U,"RetryManager",null,
[]);var K=a(98),Y=a(135),na=a(137);class W{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(t.a)(W,"WriteOptions",null,[]);var X=a(557),Aa=a(189);class Q extends f{constructor(Ra,Ya,Ga,da,Z,ha,Wa){super();this.y2=Ra;this.gAg=Ya;this.Fra=new U(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.OD.zoc);this.dsa=new U(l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.OD.zoc);this.xCg=Ga;this.uoe=da;this.LGg={};this.wT=new P;this.nxg=Z;this.PWb="";this.dw=ha;this.x$d=Wa}get zGc(){return this.LGg}Ufj(){this.OD.J$a.Nb(A.a.renameMostRecentlyUsedFileEntry,z.a.frame,Object(c.a)(this,this.Okj,"renameMruEntry"))}Okj(){return this.u4d("Rename")}kFi(){this.zvf("File Opened")}lFi(){this.zvf("IntervalUpdate")}zvf(Ra){e.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:Ra});this.u4d(Ra)}L4(Ra){(Ra=T.a.L4(Ra))&&Ra.startsWith(".")&&(Ra=Ra.substring(1,Ra.length));return Ra}y1e(){switch(this.OD.Oca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Y5h(Ra){var Ya=this.nxg();if(!Ya)return null;const Ga=new W;Ga.documentUrl=this.x$d.value?encodeURI(Ya):Ya;Ga.mruItemId=this.PWb;Ga.app=this.y1e();if(Ya=this.dw())Ga.folderName=Ya.breadcrumbFolderName,
Ya=Ya.sn,Ga.documentName=T.a.mq(Ya),Ga.documentExt=this.L4(Ya);Ra&&(Ga.documentName?Ga.documentName.length?255<=Ga.documentName.length?Ra.set("DocumentNameLength","Long"):2084<=Ga.documentName.length&&Ra.set("DocumentNameLength","VeryLong"):Ra.set("DocumentNameLength","0"):Ra.set("DocumentNameLength","Null"));return JSON.stringify(Ga)}u4d(Ra,Ya=!1){if(4===this.OD.Oca&&!l.AFrameworkApplication.yua)return 2;var Ga=Y.a.gs();Ga&&(Ga.set("Trigger",Ra),Ga.set("IsRetry",Ya?"true":"false"),Ga.set("MruIdSent",
this.PWb?"true":"false"),Ga.set("URLEncoded",this.x$d.value?"true":"false"));K.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Ga);Ra=this.Y5h(Ga);if(!Ra)return Ya=!l.AFrameworkApplication.webEditingEnabled,Ga&&(Ga.set("WebEditingIsEnabled",l.AFrameworkApplication.webEditingEnabled?"true":"false"),Ga.set("ProtectedFile",l.AFrameworkApplication.Rtc?"true":"false")),K.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Ya,!1,Object.assign(new Aa.a,{extendedProperties:Ga})),2;this.dsa&&
!Ya&&this.dsa.reset();Ga=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.OD.m0,this.localeName);this.uoe?this.zGc["X-FileId"]=l.AFrameworkApplication.Hi:Ga+=String.format("&{0}",l.AFrameworkApplication.Hi);l.AFrameworkApplication.Qb&&(this.zGc["X-Office-AudienceGroup"]=Object(J.a)(String,l.AFrameworkApplication.Qb.AudienceGroup)||"");this.zGc["X-Timeout"]=15E3;return this.OD.wFb.Om(Ga,2,Ra,this.zGc,!0,5,Object(c.a)(this,this.x5j,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.nih,
"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}x5j(Ra){this.Uaf(Ra.data)}Uaf(Ra){const Ya=Y.a.gs();this.dsa&&(Ya&&this.dsa.Htc&&(Ya.set("LastError",this.dsa.Htc),Ya.set("NumRetries",this.dsa.retryCount.toString())),this.dsa.reset());const Ga=L.c(Ra.fe);Ga&&Ga.diagnostics_data&&(this.PWb=Ga.diagnostics_data.mru_id);Ra=+Ra.N3-+Ra.MF;Ya&&Ya.set("RequestDuration",Ra.toString());K.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Aa.a,{extendedProperties:Ya}))}nih(Ra){if(Ra.data.httpStatus===
aa.a.ttb)this.Uaf(Ra.data);else{var Ya=Ra.data.httpStatus===aa.a.HIb,Ga=Y.a.gs();this.gbf(this.dsa,Ra,this.aih(),Ga);Ga&&(Ga.set("StatusCode",Ra.data.httpStatus.toString()),Ya||this.pXc(Ra.data,Ga));K.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Ra.data.httpStatus),Ya,!1,Object.assign(new Aa.a,{extendedProperties:Ga}))}}aih(){return()=>{this.u4d("Retry",!0)}}WYh(){this.ync("Polling")}VYh(){this.ync("Retry",!0)}cFi(){this.ync("Open")}bFi(){this.ync("Activity")}ync(Ra,
Ya=!1){e.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Ra});const Ga=Y.a.gs();Ga&&(Ga.set("Trigger",Ra),Ga.set("IsRetry",Ya?"true":"false"));K.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Ga);this.Fra&&!Ya&&this.Fra.reset();this.Gdh(Object(c.a)(this,this.YYh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.UYh,"getMruFromServerFailureCallback"))}pXc(Ra,Ya){Ra&&Ra.responseHeaders&&(Ra=Ra.responseHeaders["X-CorrelationId"])&&Ya.set("ServerCorrelationId",
Ra)}PBi(Ra,Ya){Ra&&(Ya&&Ya.set("RequestDuration",(+Ra.N3-+Ra.MF).toString()),K.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Aa.a,{extendedProperties:Ya})))}YYh(Ra){this.ZYh(Ra)}ZYh(Ra){var Ya="";let Ga=null,da=null,Z=null;const ha=L.c(Ra.data.fe);ha&&(Ga=ha.places?ha.places.items:[],da=ha.documents?ha.documents.items:[],(Z=L.a(ha,!1))&&(Ya=M.c(Z)));l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Pa.N_&&na.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ya,!0));
Ya=Y.a.gs();this.Fra&&(Ya&&this.Fra.Htc&&(Ya.set("LastError",this.Fra.Htc),Ya.set("NumRetries",this.Fra.retryCount.toString())),this.Fra.reset());Z||Ga||da?(this.OD.UOa("MruActor.GetMruV2FromServerSuccessCallback",Ra.data,"Success"),this.bFc(3,Z,Ga,da),this.PBi(Ra.data,Ya)):(this.OD.UOa("MruActor.GetMruV2FromServerSuccessCallback",Ra.data,"Failure: Invalid JSON"),Ya&&this.pXc(Ra.data,Ya),K.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Aa.a,{extendedProperties:Ya})),
this.bFc(3,null,null,null,!0));this.$$c(this.wT)}gbf(Ra,Ya,Ga,da){let Z=0,ha=0;const Wa=L.c(Ya.data.fe);Wa&&(null!=Wa.response_code&&(Z=Wa.response_code,da&&da.set("MruResponseCode",Z.toString()),9===Z&&(this.PWb="")),Wa.error_data&&null!=Wa.error_data.retry_after_ms&&(ha=Wa.error_data.retry_after_ms,da&&da.set("ExpectedRetryAfter",ha.toString())));Ra&&(Ya=Ra.$hi(Ga,ha,Ya.data.httpStatus,Z),da&&(da.set("CurrentRetryCount",Ra.retryCount.toString()),da.set("RetryScheduled",Ya?"true":"false")))}UYh(Ra){this.XYh(Ra)}XYh(Ra){const Ya=
Ra.data.httpStatus===aa.a.HIb,Ga=Y.a.gs();Ga&&(Ga.set("StatusCode",Ra.data.httpStatus.toString()),Ya||this.pXc(Ra.data,Ga));this.OD.UOa("MruActor.GetMruFromServerFailureCallback",Ra.data,"Failure");this.bFc(2);this.gbf(this.Fra,Ra,Object(c.a)(this,this.VYh,"getMruFromServerRetryTask"),Ga);K.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Ra.data.httpStatus),Ya,!1,Object.assign(new Aa.a,{extendedProperties:Ga}));this.$$c(this.wT);l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Pa.N_&&
na.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}bFc(Ra,Ya=null,Ga=null,da=null,Z=!1){if(3!==this.wT.state||3===Ra)this.wT.oge=Ya,this.wT.pge=Ga,this.wT.nge=da,this.wT.state=Ra,this.wT.BNc=Z,this.wT.gne=this.OD.Ew()}sIf(Ra,Ya){e.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Ra,["ResultState"]:this.wT.state});Ya&&3===this.wT.state&&this.oQe(Ya,this.wT);return this.wT}Gdh(Ra,Ya){this.bFc(1);
let Ga;const da={};Ga=String.format(this.OD.m0+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.y1e(),this.localeName);this.xCg.value||(Ga+="&entity=docs");l.AFrameworkApplication.Qb&&(da["X-Office-AudienceGroup"]=Object(J.a)(String,l.AFrameworkApplication.Qb.AudienceGroup)||"");this.uoe?da["X-FileId"]=l.AFrameworkApplication.Hi:Ga+=String.format("&{0}",l.AFrameworkApplication.Hi);this.OD.wFb.Om(Ga,1,null,da,!0,5,Ra,Ya,null)}get OD(){return this.y2.value}get localeName(){return this.gAg.value}static get instance(){return Q.Ma||
(Q.Ma=Q.oN())}static oN(){return new Q(new b.a(()=>y.instance),new b.a(()=>X.a.uK(l.AFrameworkApplication.lcid).name),new b.a(()=>l.AFrameworkApplication.ta.Pa.Lv),l.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.ta.Pa.Ux,()=>l.AFrameworkApplication.sm,new b.a(()=>l.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}Q.Ma=null;Object(t.a)(Q,"MruActor",f,[]);class fa{constructor(){this.Mnb=this.oje=this.$a=null;this.Km=!1}get name(){return"Common.App.NewAndOpen.Core"}Oh(Ra){this.$a=
Ra;Ra.register(878,"Common.INewAndOpenCommonHelpers").wc().Ac(()=>y.instance);Ra.register(879,"Common.IEventEmitter<Common.IGetMoreInfoResult>").wc().Ac(()=>S.instance);Ra.register(879,"Common.IEventEmitter<Common.IMruResult>").wc().Ac(()=>Q.instance)}init(){l.AFrameworkApplication.fa.Iu(()=>{this.Zzb()})}Zzb(){this.$a.resolve("Common.INewAndOpenCommonHelpers");this.$a.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.$a.resolve("Common.IEventEmitter<Common.IMruResult>");var Ra=!1;y.instance.bej();
l.AFrameworkApplication.pma&&(Ra=!0);l.AFrameworkApplication.ISf&&(Q.instance.cFi(),0<l.AFrameworkApplication.xxf&&this.uqe(),this.dCj(),Ra=!0);l.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Ra&&S.instance.aFi();l.AFrameworkApplication.h_j&&(Ra=Q.instance,Ra.Ufj(),Ra.kFi(),H.a.instance.Eg(this.i_j))}dCj(){G.instance.Qpe(Object(c.a)(Q.instance,Q.instance.bFi,"makeGetMruRequestActivityTrigger"));G.instance.Qpe(Object(c.a)(this,this.uqe,"addGetMruFromServerTask"));G.instance.SJg(Object(c.a)(this,
this.rlh,"deleteGetMruFromServerTask"))}rlh(){H.a.instance.rp(this.yxf)}uqe(){H.a.instance.Eg(this.yxf)}get yxf(){return this.oje||(this.oje=new D.a(5,2,l.AFrameworkApplication.xxf,Object(c.a)(Q.instance,Q.instance.WYh,"getMruFromServerTask"),109))}get i_j(){return this.Mnb||(this.Mnb=new D.a(2,2,6E4*l.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(Q.instance,Q.instance.lFi,"makeUpdateMruTask"),197))}dispose(){this.Km||(this.Km=
!0,this.Mnb&&(H.a.instance.rp(this.Mnb),this.Mnb=null))}}Object(t.a)(fa,"CorePackageManager",null,[4,5,3]);var Ca=a(249);a.d(E,"a",function(){return ia});const ia=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");Ca.a.instance.vi(new fa)}},1170:function(t,E,a){t=a(0);var c=a(4),b=a(222),e=a(15),f=a(84),d=a(54),h=a(196);class m{constructor(){this.dle=this.NTc=!1;const La=c.AFrameworkApplication.yk;0>=La||(this.yk=La,e.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
{["AccessTokenTtl"]:this.yk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Qha}),h.a.instance.FYc(Object(f.a)(this,this.gQa,"onSessionExpiredDetected")),h.a.instance.DYc(Object(f.a)(this,this.oJf,"onSessionExpiringDetected")))}gQa(){h.a.instance.JNd(Object(f.a)(this,this.gQa,"onSessionExpiredDetected"));e.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.x$h()}oJf(){h.a.instance.INd(Object(f.a)(this,this.oJf,"onSessionExpiringDetected"));this.dle||this.NTc||
(e.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.dle=!0,this.UIj())}x$h(){this.NTc||(c.AFrameworkApplication.mG(d.a.Cyc),this.NTc=!0,this.TIj())}}Object(t.a)(m,"ASessionExpirationManager",null,[]);var l=a(89),w=a(38),n=a(29),x=a(13),r=a(44),u=a(251),v=a(6),B=a(81),z=a(254),A=a(70);class y extends m{constructor(La){super();this.Qa=new w.a;this.EH=this.Fnb=!1;this.$=La}Tse(La){this.Qa.addHandler("SessionExpired",La)}$ob(La){this.Qa.addHandler("TokenRefreshed",
La)}Pvc(La){this.Qa.removeHandler("TokenRefreshed",La)}get accessTokenExpiringMessage(){const La=(new Date(this.yk)).format(this.$.ya.ShortTimeFormat);return String.format(x.a.instance.mb(78),La)}get tokenExpired(){return this.Fnb}get Reb(){return!1}get kca(){return!1}get KLd(){return!1}get b6(){return!1}Lfc(){return h.a.instance.tR(c.AFrameworkApplication.yk)}dispose(){l.a.Ia(this.Qa);this.$=null}UIj(){this.$.isEditMode&&this.lfc(!1)}TIj(){this.Fnb=!0;this.lfc(!0);this.Qa.raiseEvent("SessionExpired")}lfc(La){e.ULS.sendTraceTag(537170715,
0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${La}, GotDeploymentOrTimedOutError ${this.$.ea.X4}`);const db=this.$.rb.pp;La&&db&&db.isVisible&&1299163859===db.error.MessageId&&this.$.rb.pp.wv();const Ab=this.dd(La);r.a(this.$).Ns(new u.a(v.a.ky,5,()=>{const Mb=A.a(this.$),pb=Mb.hd.activityState;pb[B.a.U2]=this.$.Uqb(this.$.isEditMode);pb[B.a.BM]=B.a.G$a;pb[z.a.Jq]=v.a.accessTokenExpiringWarning;Mb.hd.qr([Ab])}))}dd(La){return La?n.a.lKe():this.Xgh()}Xgh(){const La=
n.a.dd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");La.Description=this.accessTokenExpiringMessage;return La}}Object(t.a)(y,"EwaAccessTokenExpirationManager",m,[761,762,3]);var D=a(7),I=a(171),M=a(80),T=a(642),S=a(28);class H{constructor(La,db){this.OJb=!1;this.correlationID=La;this.Q7c=db;this.sDc=!1;this.creationTime=S.a.Sa.zb}}Object(t.a)(H,"RefreshAccessTokenContext",null,[]);var C=a(58),G=a(60),J=a(172),L=a(46),P=a(110),aa=a(118),U=a(1),K=a(22),Y=a(143),na=a(36),W=a(115);class X{}Object(t.a)(X,
"Error",null,[]);class Aa{}Object(t.a)(Aa,"NamedResult",null,[]);class Q extends Aa{}Object(t.a)(Q,"ErrorInfo",Aa,[]);class fa{constructor(La,db){this.NZb=La;this.TG=db}get tokens(){return this.NZb}get errors(){return this.TG}}Object(t.a)(fa,"TokenRefreshArgs",null,[758]);class Ca{constructor(La,db){this.documentVisibilityObserver=null;this.Qa=new w.a;this.Qx=null;this.Hfb=this.Dmb=!1;this.Nuc=null;this.TJb=!1;this.syd=!0;this.pee=this.Nde=this.EH=this.Fnb=!1;this.jT=null;this.Vaf=()=>{if(this.$.ea.Zb)this.tbf(!1);
else if(this.syd){this.syd=!1;const Ab=A.a(this.$);e.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${Ab.gi?Ab.gi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.nfg()}]`)}};this.Tc=(Ab,Mb)=>{this.context&&(Ab=this.$.ea,Mb.XH&&this.context.OJb&&!this.context.sDc?(this.context.sDc=!0,Mb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Mb.IsUserActive=
Ab.Re.Hr,Mb.RefreshAccessTokenCorrelationID=this.context.correlationID,Mb=C.a.fc(Mb),e.ULS.sendTraceTag(537170708,0,50,Mb)):!this.Dmb||Ab.Zb||this.context.Q7c||(Mb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.Qx&&(this.Qx.cancel(),Mb.Aborted=!0,Mb.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Hfb=!1),Mb.TimeUntilTokenExpirationInMin=this.nfg(),Mb.RefreshAccessTokenCorrelationID=this.context.correlationID,Mb=C.a.fc(Mb),e.ULS.sendTraceTag(572019856,
0,50,Mb)))};this.uza=()=>{if(this.context&&this.context.OJb&&!this.context.sDc){var Ab={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Ab.CreatedForExpired=this.context.Q7c;Ab.RefreshAccessTokenCorrelationID=this.context.correlationID;Ab.OpenWorkbookErrors=n.a.sc(this.$.ea.cG);Ab.ExecutionContextErrors=n.a.sc(A.a(this.$).hd.errors);Ab.accesstokenTTL=c.AFrameworkApplication.yk;Ab=C.a.fc(Ab);e.ULS.sendTraceTag(537170707,0,15,Ab)}};this.sbf=()=>{this.Hfb=!1;this.tbf(!0)};this.TFd=
()=>{this.TJb&&(this.$.ea.Re.IAa(this.TFd),this.TJb=!1);this.Rbg()};this.$=La;this.E_d=db;this.HLd=La.Kb.Qg("WebServiceCall","refreshToken");h.a.instance.FYc(this.sbf);h.a.instance.DYc(this.Vaf);db=this.$.ea;db.Xj(this.Tc);db.W0b(this.uza);this.NHi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.i8f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.VTf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.elg(La.ea.pMf,c.AFrameworkApplication.yk);La=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.yk,
["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.Qha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.i4d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.k4d});e.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${La}`);this.$.da.fb(291,Ab=>{this.documentVisibilityObserver=Ab})}Tse(La){this.Qa.addHandler("SessionExpired",La)}$ob(La){this.Qa.addHandler("TokenRefreshed",La)}Pvc(La){this.Qa.removeHandler("TokenRefreshed",La)}get tokenExpired(){return this.Fnb}get kca(){return this.Nde}get b6(){return this.pee}get context(){return this.jT}get Reb(){return this.b6?
!1:this.$.ea.Re.Hr?1>W.a.B6:6>W.a.C6}get KLd(){return this.Dmb}Lfc(){return h.a.instance.tR(c.AFrameworkApplication.yk)}dispose(){h.a.instance.JNd(this.sbf);h.a.instance.INd(this.Vaf);const La=this.$.ea;La&&(La.tk(this.Tc),La.Rvc(this.uza));l.a.Ia(this.Qa);this.documentVisibilityObserver=this.$=null}nfg(){return this.Lfc()?0:(c.AFrameworkApplication.yk-(new Date).getTime())/6E4}elg(La,db){if(0<db&&!this.Lfc()){const Ab=c.AFrameworkApplication.fa.ud("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.LY),
Mb=(db-La.getTime())/6E4;e.ULS.shipAssertTag(537170713,0,0<=Mb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${db}] creationTime [${La.getTime()}] tokenLifetimeInMin [${Mb}]`);Mb<this.NHi?(e.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.i8f}] tokenLifetimeInMin [${Mb}]`),c.AFrameworkApplication.LY=this.i8f):
c.AFrameworkApplication.LY!==Ab&&(e.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${Ab}] tokenLifetimeInMin [${Mb}]`),c.AFrameworkApplication.LY=Ab)}}nbh(La){return!this.context||this.context.OJb||this.context.Q7c!==La?(La=new H(I.a.create().toString(),La),this.context&&!this.context.sDc&&e.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${La.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.OJb}] `),
this.jT=La,!0):!1}qnj(La){La&&this.EH&&!this.kca&&this.$.ea.Re.Hr&&!this.b6&&(this.EH=!1)}tbf(La){this.qnj(La);if(!(this.Dmb||this.Hfb&&!La||this.EH)&&this.Reb){this.Dmb=!0;var db=this.context?this.context.creationTime:null,Ab=this.nbh(La);this.syd=!0;var Mb=this.$.ea,pb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};pb.newContextCreated=Ab;pb.IsUserActive=Mb.Re.Hr;pb.IsSessionActive=Mb.Zb;pb.ContainsChangesWorkbookOperations=this.$.userOperationManager.Dta();pb.isSessionExpired=
La;pb.stopRefreshRetriesUntilTokenExpired=this.Hfb;pb.FailedToRefreshExpiredToken=this.EH;pb.numOfFailuresWhileUserIsActive=W.a.B6;pb.numOfFailuresWhileUserIsInActive=W.a.C6;pb.numOfFailuresWhileOffline=W.a.aza;pb.RefreshAccessTokenCorrelationID=this.context.correlationID;Ab&&db&&(pb.TimeInMinFromPreviosContextCreation=Math.round(aa.b(S.a.Sa,db)/60));db=C.a.fc(pb);e.ULS.sendTraceTag(40416199,0,50,db);this.HLd.start();this.Nde=Mb.Re.Hr;this.Qx=new T.a;this.izi(La);var Qb=this.E_d.Kdj(!La,this.Qx?this.Qx.token:
null);Qb.continueWith(()=>{this.Q4g();const xb=this.E_d.I8i(Qb);this.HLd.stop();const pa=this.Lfc();if(!xb||U.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&pa){const Ma=Qb.result.errors;xb&&pa&&this.$Ig(Ma);this.e$h(Ma,La)}else this.Hfb=!1,this.f$h(Qb.result.tokens,La);this.Dmb=!1},8)}}$Ig(La){const db=[Object(D.a)(new X,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];La.add(Object(D.a)(new Q,{Name:"ExpiredTokenAfterSuccessfulRefresh",
Errors:db}))}izi(La){La&&(this.$.ea.Re.Hr?this.Rbg():(this.$.ea.Re.uha(this.TFd),this.TJb=!0))}Rbg(){this.Nuc=J.AsyncMethodContext.Dr(()=>{this.Jdj()},1E3*this.VTf,L.a.sdj,this.Nuc)}Q4g(){this.Nuc&&this.Nuc.cancel();this.TJb&&(this.$.ea.Re.IAa(this.TFd),this.TJb=!1);this.Qx=null}Jdj(){e.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.VTf}]`);this.Qx.cancel()}e$h(La,db){this.Hfb=!0;db&&(this.EH||(this.Fnb=this.EH=
!0),this.E_d.PBb(La)&&(this.pee=!0));const Ab=!db||this.Reb&&!W.a.pAc?40380379:39982555;db=this.NIe(db);db.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";db.FailedToRefreshExpiredToken=this.EH;db.LastErrorIsPermanent=this.b6;if(0<La.count){var Mb=La.ma(0);db.errorName=Mb.Name;0<Mb.Errors.length&&(db.ErrorId=Mb.Errors[0].Id,Mb=Mb.Errors[0].Details,db.ErrorDetails=this.uph(Mb.toString())?"PiiScrubbed":Mb)}db=C.a.fc(db);e.ULS.sendTraceTag(Ab,0,15,db);this.Qa.raiseEvent("TokenRefreshed",
new fa(null,La))}uph(La){return K.a.contains(La,"makes the internet safe for businesses",!0)}NIe(La){const db={},Ab=this.$.ea;db.Name="";db.IsUserActive=Ab.Re.Hr;db.IsSessionActive=Ab.Zb;db.GotDeploymentOrTimedOutError=Ab.X4;db.TimeInSecFromLastStatefulSuccessfulRequest=Ab.u1;db.TimeFromLastUserActivityInMs=Ab.Re.ggb;db.calledFromSessionExpiredFlow=La;db.RefreshTokenDurationInMS=this.HLd.Bc;db.numOfFailuresWhileUserIsActive=W.a.B6;db.numOfFailuresWhileUserIsInActive=W.a.C6;db.numOfFailuresWhileOffline=
W.a.aza;db.RefreshAccessTokenCorrelationID=this.context.correlationID;db.accessTokenTTL=c.AFrameworkApplication.yk;db.ContainsChangesWorkbookOperations=this.$.userOperationManager.Dta();db.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.ki.toString():"Unknown";db.TimeFromFirstOpenInHr=Math.floor(aa.b(S.a.Sa,P.toUtc(Ab.pMf))/3600);return db}f$h(La,db){this.EH=!1;this.L0j();this.elg(new Date,c.AFrameworkApplication.yk);const Ab=this.$.ea,Mb=!db&&Ab.Re.Hr,pb=!this.$.isEditMode&&
Ab.ycb;db=this.NIe(db);db.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";db.shouldTriggerSilentReloadAfterExpiring=Mb;db.WopiTokenTaskItemPriority=c.AFrameworkApplication.k4d;db.isDirtyViewSession=pb;db=C.a.fc(db);e.ULS.sendTraceTag(39982556,0,15,db);this.Qa.raiseEvent("TokenRefreshed",new fa(La,null));pb?Ab.Re.Hr&&(e.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),
Ab.Oed()):Ab.Re.Hr?Mb&&(La=A.a(this.$).hd.activityState,La[W.a.Agb]=!0,La[Y.a.PY]=!0,La[na.a.$r]=this.$.isEditMode,r.a(this.$).Ns(new u.a(v.a.boa,2,null))):Ab.Zb&&G.j(this.$.pa.xa,!0,!1,!1,null,null,null,null,null)}L0j(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=M.a.XT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.UP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=M.a.XT(this.$.ea.workbookContext.WorkbookUri,
c.AFrameworkApplication.MY,c.AFrameworkApplication.yk.toString()),this.$.ea.Mrc()):e.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.yk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=
M.a.XT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.UP,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=M.a.XT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.MY,c.AFrameworkApplication.yk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=M.a.XT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.UP,c.AFrameworkApplication.accessToken),
this.$.ya.EmbedConfiguratorUrl=M.a.XT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.MY,c.AFrameworkApplication.yk.toString()));this.context.OJb=!0}}Object(t.a)(Ca,"EwaAccessTokenExpirationRefreshManager",null,[761,762,3]);var ia=a(187),Ra=a(156),Ya=a(83),Ga=a(419);class da{}da.S_b="ActivityDuration";da.error="Error";da.cbd="Errors";da.failed="Failed";da.cIh="FirstActivity";da.initialized="Initialized";da.uxi="LastActivity";da.y_f="RetryOverride";da.Pmj="RequestGroups";da.requests="Requests";
da.m_f="Responses";da.Dyc="SessionDuration";da.status="Status";da.success="Success";da.successful="Successful";da.tokens="Tokens";Object(t.a)(da,"SessionExpirationStrings",null,[]);var Z=a(107);class ha{constructor(La){this.cp={};this.dY={};this.UBg={};this.Msf=15;this.Ide=!1;this.DDg=new Date;this.hWb=new Date;this.ke=La;this.BZb=new Z.a(2,2,6E4*this.Msf,Object(f.a)(this,this.cog,"writeMeasures"),135,"SL",!1);this.ke.Eg(this.BZb);this.Zgi()}cog(){e.ULS.sendTraceTag(41964821,217,50,e.ULS.fc({["Aggregate"]:this.dY,
["Current"]:this.cp}))}Zgi(){this.dY[da.Pmj]=0;this.dY[da.requests]=0;this.dY[da.m_f]=0;this.dY[da.status]=da.initialized;this.dY[da.cIh]=new Date;this.dY[da.Dyc]=0;this.dY[da.S_b]=0;this.dY[da.Dyc]=0;this.cp[da.Dyc]=0;this.dY[da.S_b]=0;this.cp[da.S_b]=0}Fod(La,db){var Ab=La[db];Ab=Ab?Ab:0;Ab++;La[db]=Ab;this.cTd(La)}cTd(La){const db=new Date;La[da.S_b]=+db-+this.hWb;this.hWb=db;La[da.Dyc]=+this.hWb-+this.DDg;La[da.uxi]=this.hWb}d1(La,db){this.cp[La]=db;this.cTd(this.cp)}ASd(La,db){this.cp[La]=db;
this.cTd(this.cp)}incrementCounter(La){this.Fod(this.cp,La);this.Fod(this.dY,La);this.Fod(this.UBg,La)}flush(){this.Ide||(this.dY[da.status]=this.cp[da.status],this.cog(this.BZb),this.ke.Fna(this.BZb,6E4*this.Msf))}stop(){e.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Ide=!0;this.ke.rp(this.BZb)}}Object(t.a)(ha,"SessionLogger",null,[835]);var Wa=a(98),ca=a(643),ja=a(30),ua=a(376),Za=a(164),Pa=a(941),ka=a(189),ra=a(166);class ba{constructor(La,db,Ab,
Mb=null,pb=!1,Qb=null,xb=!1,pa=!1){this.K9=0;this.K2=this.Xi=null;this.NZb=new ia.a;this.TG=new ia.a;this.xk=null;this.KXa=!1;this.Hnb=this.Inb=null;this.ke=La;this.Fie=db;this.Fie.execute(Ma=>{Ma.em(Za.a.Mnd,Object(f.a)(this,this.QTi,"onHostResponseReceived"))});this.aH=Ab;this.hne=new Pa.a("WebServiceCall","TokenRefresh");this.lh=Mb||new ha(La);this.yDg=pb;this.KT=Qb?Qb:ca.SessionStatusManager.instance;this.w$d=xb;this.DUb=pa}QTi(La){if(La.MessageId!==Za.a.Mnd)ra.a(39408099,306,15,"Unexpected message.");
else{var db=new ia.a,Ab=new ia.a;this.lh.incrementCounter(da.m_f);var Mb=La.Values[ua.a.P3f];if(!Mb||0>=Mb.length)ra.a(40122317,306,15,"Found no tokens in the dictionary"),Mb=La.Values;ra.a(40122318,306,100,"The Tokens array contains {0} tokens",Mb.length);this.lh.d1("Correlation",La.CorrelationId);var pb="";for(let pa=0;pa<Mb.length;pa++){this.lh.ASd(da.tokens,Mb.length);var Qb=Mb[pa],xb=Qb;if(!xb||!xb.Name)continue;this.lh.incrementCounter(xb.Name);const Ma=Qb;if(Ma&&Ma.Value)ra.a(39408128,306,
100,"Received token with name: {0}",Ma.Name),db.add(Ma),this.NZb.add(Ma),this.DUb||this.lh.d1(da.status,da.success),this.w$d&&this.KT&&this.KT.Rnj();else if(Qb=this.r2h(Qb),ra.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",xb.Name,JSON.stringify(Qb),this.K2),Ab.add(Qb),this.DUb||(this.TG.add(Qb),pb=JSON.stringify(Qb),this.lh.d1(da.error,JSON.stringify(Qb)),this.lh.d1(da.status,da.failed)),this.w$d)for(const ya of Qb.Errors)xb=this.jUh(ya),this.KT&&this.KT.tLg(xb)}this.DUb?
(0<Ab.count?this.Hnb?this.Hnb(new fa(db,Ab)):ra.a(512267295,306,15,"Received errors but the promise has completed"):this.Inb?this.Inb(new fa(db,Ab)):ra.a(512267294,306,15,"Received valid tokens but the promise has completed"),ra.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",db.count,Ab.count,La.CorrelationId,this.K2)):(0<Ab.count&&""!==pb?(Mb=Object.assign(new ka.a,{extendedProperties:new Map}),Mb.extendedProperties.set("Errors",pb),Mb.extendedProperties.set("RetryCount",
this.K9.toString()),Mb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Mb.extendedProperties.set("IsTokenExpiring",this.KXa.toString()),Wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Mb)):Wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ra.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",db.count,Ab.count,La.CorrelationId,this.K2),0<Ab.count&&!this.PBb(Ab)?(La=this.aH.T7e(Ab),
La!==this.aH.Gdb&&(this.lh.ASd(da.y_f,La),this.ke.Fna(this.Xi,La))):(this.lh.flush(),this.Xi&&(ra.a(39408131,306,100,"Deleting task {0} from task manager",this.Xi.name),this.ke.rp(this.Xi)),this.xk&&!this.xk.task.isCompleted?this.xk.setResult(new fa(db,Ab)):ra.a(512267293,306,15,"Received results but the task has completed")))}}r2h(La){if(!La)return null;const db=Object.assign(new Q,{Name:La.Name,Errors:[]});for(const Ab of La.Errors)La=new X,La.Id=Ab.Id,La.Details=ja.a.Sjd(Ab.Details,500),db.Errors.push(La);
return db}requestTokensOnce(){this.uZf()}uZf(){c.AFrameworkApplication.uya("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.K9>=this.aH.gwf?(ra.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.K2),this.TIe(this.xk,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Wa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Z2f())}Z2f(){const La={};La[ua.a.P3f]=this.aH.tokens;
const db=I.a.create().toString();ra.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.aH.tokens),this.K9+1,db,this.K2);this.Fie.execute(Ab=>{Ab.Sj(Za.a.kve,La,db)});this.K9++;this.lh.incrementCounter(da.requests)}TIe(La,db,Ab){const Mb=new ia.a;for(let pb=0;pb<this.aH.tokens.length;pb++){const Qb=Object.assign(new Q,{Name:this.aH.tokens[pb],Errors:[Object.assign(new X,{Id:db,Details:Ab})]});Mb.add(Qb);this.TG.add(Qb)}this.ke.rp(this.Xi);this.lh.d1(da.cbd,
JSON.stringify(this.TG));this.lh.d1(da.status,da.failed);La&&!La.task.isCompleted&&La.setResult(new fa(new ia.a,this.TG))}Kdj(La,db=null){c.AFrameworkApplication.uya("258ec738;j5j99381");c.AFrameworkApplication.uya("85gid169;g470d326");this.hne.start();this.KXa=La;this.K2=I.a.create().toString();ra.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.K2,this.KXa);this.K9=0;this.TG.clear();this.NZb.clear();const Ab=new Ra.a;this.xk=Ab;db&&db.R(()=>{const Mb=!!Ab&&!Ab.task.isCompleted;
ra.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.K2,this.KXa,Mb);Mb&&this.TIe(Ab,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.DUb?this.vZf(this.aH.gwf).then(Mb=>{this.xk&&!this.xk.task.isCompleted&&this.xk.setResult(Mb);this.Hnb=this.Inb=null;this.lh.d1(da.cbd,JSON.stringify(this.TG));this.lh.d1(da.status,da.success);this.lh.flush()}).catch(Mb=>{this.xk&&!this.xk.task.isCompleted&&this.xk.setResult(Object(Ya.a)(758,
Mb));this.Hnb=this.Inb=null;this.lh.d1(da.cbd,JSON.stringify(this.TG));this.lh.d1(da.status,da.failed);this.lh.flush()}):(this.Xi=new Z.a(this.aH.priority,2,this.aH.Gdb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Za.a.kve,!0),this.yDg&&this.uZf(),this.ke.Eg(this.Xi));return this.xk.task}vZf(La){const db=this,Ab=new Promise((pa,Ma)=>{db.Inb=pa;db.Hnb=Ma;Wa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);db.Z2f()}),Mb=this,pb=new Promise((pa,Ma)=>{window.setTimeout(()=>
{Ma(Mb.YIe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Mb.aH.Gdb)});let Qb=La;const xb=this;return new Promise((pa,Ma)=>{Qb--;Promise.race([Ab,pb]).then(ya=>{Wa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);pa(ya)}).catch(ya=>{var Ea=xb.aH.Gdb;if(Object(Ga.a)(758,ya)&&(ya=Object(Ya.a)(758,ya),0<ya.errors.count)){xb.xBi(ya.errors);xb.qr(ya.errors);if(xb.PBb(ya.errors)){Ma(ya);return}const Na=xb.aH.T7e(ya.errors);Na!==xb.aH.Gdb?(xb.lh.ASd(da.y_f,
Na),Ea=Na):xb.Rui(ya.errors)&&(Ea=0)}Qb?window.setTimeout(()=>{xb.vZf(Qb).then(pa).catch(Ma)},Ea):(Ea=xb.YIe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),xb.qr(Ea.errors),Ma(Ea),ra.a(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",xb.K2))})})}qr(La){for(let db of La)this.TG.add(db)}Rui(La){if(!La.count)return!1;La=La.ma(La.count-1);return La.Errors.length?"TIMEOUT"==La.Errors[0].Id:!1}YIe(La,db){const Ab=
new ia.a;for(let Mb=0;Mb<this.aH.tokens.length;Mb++){const pb=this.cdh(this.aH.tokens[Mb],La,db);Ab.add(pb)}return new fa(new ia.a,Ab)}cdh(La,db,Ab){return Object.assign(new Q,{Name:La,Errors:[Object.assign(new X,{Id:db,Details:Ab})]})}xBi(La){if(La.count){La=La.ma(La.count-1);La=JSON.stringify(La);var db=Object.assign(new ka.a,{extendedProperties:new Map});db.extendedProperties.set("Errors",La);db.extendedProperties.set("RetryCount",this.K9.toString());db.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString());db.extendedProperties.set("IsTokenExpiring",this.KXa.toString());Wa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,db);this.lh.d1(da.error,La);this.lh.d1(da.status,da.failed)}}I8i(La){this.hne.stop();const db=this.rai(La.result.errors);e.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!db,this.K2,this.KXa,this.K9,this.TG.count,0<La.result.errors.count?La.result.errors.ma(0).Name:"",0<La.result.errors.count&&0<La.result.errors.ma(0).Errors.length?La.result.errors.ma(0).Errors[0].Id:"",0<La.result.errors.count&&0<La.result.errors.ma(0).Errors.length?La.result.errors.ma(0).Errors[0].Details:"");return db?!1:this.H8i(La.result.tokens)}PBb(La){return this.aH.PBb(La)}H8i(La){for(let db=0;db<La.count;db++){const Ab=La.ma(db);if(Ab.Name===ua.a.accessToken){const Mb=(new Date).getTime();
Ab.Expiry>c.AFrameworkApplication.yk?(e.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Ab.Expiry,["NowGetTime"]:Mb,["BootTime"]:c.AFrameworkApplication.Qha},"PreviousAccessTokenTtl",c.AFrameworkApplication.yk),c.AFrameworkApplication.accessToken=Ab.Value,c.AFrameworkApplication.yk=Math.floor(Ab.Expiry),c.AFrameworkApplication.j4d=Mb,c.AFrameworkApplication.yZa=Math.floor(Ab.Expiry)):e.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",
{["AccessTokenTtl"]:Ab.Expiry,["NowGetTime"]:Mb,["BootTime"]:c.AFrameworkApplication.Qha},"PreviousAccessTokenTtl",c.AFrameworkApplication.yk)}}return!0}rai(La){let db=!1;for(let Ab=0;Ab<La.count;Ab++){db=!0;const Mb=La.ma(Ab);e.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Mb.Name,JSON.stringify(Mb.Errors),this.K2)}return db}jUh(La){let db=d.a.Cyc;La=parseInt(La.Id);if(isNaN(La))db=d.a.T4j;else{switch(La){case 401:db=d.a.W4j;break;case 403:db=d.a.R4j;
break;case 500:db=d.a.S4j;break;case 503:db=d.a.V4j}db===d.a.Cyc&&(db=500<La?d.a.U4j:d.a.Q4j)}return db}}Object(t.a)(ba,"TokenRefreshManager",null,[759]);class Ua{constructor(){this.Gdb=c.AFrameworkApplication.Z4j;this.gwf=c.AFrameworkApplication.X4j;this.tokens=c.AFrameworkApplication.e7h();this.priority=c.AFrameworkApplication.k4d;this.Qje=this.Nzj();this.hWc=c.AFrameworkApplication.d7h()}PBb(La){La=JSON.stringify(La);if(this.hWc&&0<this.hWc.length)for(const db of this.hWc)if(0<db.length&&0<=La.indexOf(db))return!0;
return!1}T7e(La){try{if(La)for(let db of La)if(db.Errors)for(const Ab of db.Errors)if(Ab.Id in this.Qje)return Number.parseInvariant(this.Qje[Ab.Id].toString())}catch(db){e.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",db.toString())}return this.Gdb}Nzj(){const La={};try{if(!c.AFrameworkApplication.Xec()||0>=c.AFrameworkApplication.Xec().length||""===c.AFrameworkApplication.Xec()[0])return La;for(const db of c.AFrameworkApplication.Xec())0<db.length&&
(La[db]=c.AFrameworkApplication.Y4j)}catch(db){e.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",db.toString())}return La}}Object(t.a)(Ua,"TokenRefreshPolicy",null,[742]);class Ka extends b.a{constructor(La){super();this.$=La;this.Fb()}create(){c.AFrameworkApplication.ZN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.ob(this.hdh()):
this.ob(this.$.da.Aa(38)||this.$.da.Ga(38,new y(this.$)))}hdh(){var La=this.$.da.Aa(38);if(La)return La;La=new ba(c.AFrameworkApplication.Fi,c.AFrameworkApplication.AV(),new Ua);return this.$.da.Ga(38,new Ca(this.$,La))}static la(La){La.da.Ga(39,new Ka(La))}}Object(t.a)(Ka,"AccessTokenExpirationManagerFactory",b.a,[]);var Oa=a(9);a.d(E,"a",function(){return ib});const ib=()=>{Oa.a.Fa(Ka.la)}},1202:function(t,E,a){t=a(0);var c=a(84),b=a(146);class e extends b.a{constructor(A){super(!1,!1,!0);this.ASb=
A}start(){const A={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.ASb.Snd}};this.initializeAndShow("",Object(c.a)(this,this.Qoj,"resultHandler"),A)}Qoj(A,y){1===A&&(this.ASb.Snd=y.tooltipPersistenceEnabled)}}Object(t.a)(e,"AccessibilitySettingsDialog",b.a,[]);var f=a(106),d=a(25);class h{constructor(A,y){this.La=A;this.ASb=y}Hg(){this.La.Nb(d.a.rGj,f.a.frame,Object(c.a)(this,this.sGj,"showAccessibilitySettingsDialogHandler"))}sGj(){(new e(this.ASb)).start();
return 32}}Object(t.a)(h,"AccessibilitySettingsDialogActor",null,[282]);var m=a(156),l=a(4);const w=A=>{const y=new m.a;l.AFrameworkApplication.zd.Om(n(A),1,null,null,!0,2,D=>{200===D.data.httpStatus?y.setResult("true"===D.data.fe.toLowerCase()):y.setResult(!1)},()=>{y.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return y.task},n=A=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",A,l.AFrameworkApplication.Hi);
var x=a(137);class r{constructor(){this.uXa=null}get Snd(){return!!this.uXa}set Snd(A){A!==this.uXa&&(this.uXa=A,x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A),this.Kmf()&&l.AFrameworkApplication.zd.Om(n("saveHoverableRibbonTooltipIsEnabled"),2,A.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}Mzi(){const A=new m.a;if(this.uXa)A.setResult(this.uXa);else if(this.Kmf()){const y=w("getHoverableRibbonTooltipIsEnabled");y.continueWith(()=>
{this.uXa=y.result;x.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(y.result);A.setResult(y.result)},8)}else A.setResult(!1)}Kmf(){const A=l.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),y=l.AFrameworkApplication.fa.qa("IsAnonymousUser");return A&&!y}}Object(t.a)(r,"AccessibilitySettingsInfo",null,[281]);var u=a(249),v=a(166);class B{constructor(){this.$a=null}get name(){return"Common.App.AccessibilitySettings"}Oh(A){this.$a=A;this.$a.register(r,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ac(()=>
new r).wc();this.$a.register(h,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ac(()=>new h(l.AFrameworkApplication.ub,this.$a.yg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).wc()}init(){const A=this.$a.yg("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),y=this.$a.yg("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");A&&y?(y.Hg(),A.Mzi()):v.a(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){u.a.instance.vi(new B)}}Object(t.a)(B,"AccessibilitySettingsPackage",null,[4,5]);a.d(E,"a",function(){return z});const z=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");B.main()}},1203:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(15),f=a(89),d=a(27),h=a(419),m=a(480),l=a(523),w=a(165),n=a(225),x=a(24),r=a(66),u=a(40),v=a(162),
B=a(211),z=a(47),A=a(46),y=a(12),D=a(71),I=a(128),M=a(1),T=a(11),S=a(21),H=a(346),C=a(240),G=a(14),J=a(155),L=a(95),P=a(5),aa=a(250),U=a(76),K=a(44),Y=a(34);class na extends L.a{constructor(ja,ua,Za,Pa){super(ja);this.Ydg=[6];this.Tdg=[26];this.ds=null;this.CBb=this.Ykc=!1;this.Es=this.vba=null;this.onPointerDown=ka=>{if(1!==this.$.Ka.NH())return!0;ka=Y.a(this.$).Vd(ka);if(this.wB)return!0;var ra=K.a(this.$).jsd||K.a(this.$).Gp();if(this.aud||ra)return this.tdb(),!0;this.Es=this.en;this.yMd();this.tnd();
ra=2===ka.tb&&ka.lo===Sys.UI.MouseButton.leftButton;const ba=3===ka.tb;if(ra||ba)ka=this.ha.mo(ka.clientPoint,ka.Gb,5,void 0,void 0,!0),ka||(ka=this.Es),this.CBb=ra,this.Ykc=ba,this.Es=this.P9e(ka),this.tnd(),ra?this.Sej():ba&&this.Lfj(),aa.b(this.$,!0);return!0};this.Hh=ka=>{ka=Y.a(this.$).Vd(ka);if(!this.wB)return!1;let ra=this.CBb?this.ha.mo(ka.clientPoint,ka.Gb,5,void 0,void 0,!0):this.ha.mo(ka.clientPoint,ka.Gb,5,!0,!1,!0);ra||(ra=this.ha.Ipb(ka.clientPoint,ka.Gb,5));ra&&(ka=this.P9e(this.o_a(ra)),
this.j3b(ka.bottomRight),this.Es.equals(ka)||(this.Es=ka,this.hKb(!1),this.yMd(!1),this.tnd(!1),this.qci(),this.qb.update(!1)),this.NYj(this.Es));return!0};this.Qf=ka=>{Y.a(this.$).Vd(ka);if(!this.wB)return!1;this.resizeTable();this.tdb();return!0};this.sHb=ka=>{Y.a(this.$).Vd(ka);if(!this.wB)return e.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.tdb();return!0};this.fda=ka=>{Y.a(this.$).Vd(ka);this.tdb();
return!0};this.nBf=()=>{this.wB&&this.tdb()};this.gridView=ua;this.$=ua.$;this.tableManager=Pa;this.ha=ua.ha;this.qb=ua.qb;this.parentElement=ja;this.GZg();d.a.Hp||d.a.H5||C.a.instance.sa(G.a.pointerDown,this.vba,this.onPointerDown);this.en=Za;this.IOc=this.aud=!1;this.tableManager.dMg(this.nBf)}get wB(){return this.CBb||this.Ykc}get Lnf(){return this.IOc}dispose(){this.tdb();this.tableManager.Shj(this.nBf);this.Lnf||d.a.Hp||d.a.H5||C.a.instance.Ba(G.a.pointerDown,this.vba,this.onPointerDown);if(this.wB){aa.b(this.$,
!1);try{this.Yv()}catch(ja){e.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ja}`)}}this.parentElement&&this.parentElement.contains(this.vba)&&this.parentElement.removeChild(this.vba);this.vba=this.parentElement=null;super.dispose()}P9e(ja){const ua=ja.bottom-this.en.topLeft.bottom-1;return 0<=ja.right-this.en.topLeft.right+1&&0<=ua&&ja.bottom>=this.en.top&&ja.right>=this.en.left?new x.Range(this.en.top,this.en.left,ja.bottom,ja.right,
!1,!1):this.Es}tnd(ja=!0){this.hzc([this.Es],6,ja);this.qb.Tn(this.Ydg)}hKb(ja=!0){this.qb.Zg(this.Ydg);this.hzc([null],6,ja)}yMd(ja=!0){this.qb.Zg(this.Tdg);this.hzc([null],26,ja)}qci(){const ja=this.pPj();0<ja.length&&(this.hzc(ja,26,!1),this.qb.Tn(this.Tdg))}pPj(){const ja=[];this.en.contains(this.Es)&&(this.en.right!==this.Es.right&&ja.push(new x.Range(this.en.top,this.Es.right+1,this.Es.bottom,this.en.right,!1,!1)),this.en.bottom!==this.Es.bottom&&ja.push(new x.Range(this.Es.bottom+1,this.en.left,
this.en.bottom,this.en.right,!1,!1)));return ja}resizeTable(){if(!this.Es.equals(this.en)){const ja=new x.Range(this.en.top,this.en.left,this.Es.bottom,this.Es.right,!1,!1);this.cUj(ja);this.aud=!0}}onKeyDown(ja){Y.a(this.$).Vd(ja);return!0}oab(){this.Lnf&&(d.a.Hp||d.a.H5||(C.a.instance.sa(G.a.pointerDown,this.vba,this.onPointerDown),this.vba.classList.remove("ewr-table-resize-default-cursor"),this.IOc=this.vba.disabled=!1),this.IOc=!1)}GZg(){const ja=document.createElement("div");ja.className="ewr-table-resize-handle";
const ua=document.createElement("div");ua.className="ewr-table-resize-fillhandle-higher";const Za=document.createElement("div");Za.className="ewr-table-resize-fillhandle-broader";ja.appendChild(ua);ja.appendChild(Za);this.vba=ja;this.parentElement.appendChild(this.vba)}j3b(ja){let ua=60;const Za=this.Es.contains(ja);let Pa=ja.top,ka=ja.bottom,ra=ja.left,ba=ja.right,Ua=null;if(Za){if(this.gridView.NK(this.en.topLeft)&&!this.en.KBa)return;ja.bottom<this.Es.bottom?(Pa=Math.max(1,ka-2,this.en.top),ua=
16):(ra=Math.max(1,ba-2,this.en.left),ua=4);ka=Pa;ba=ra;Ua=new x.Range(Pa,ra,Pa,ra,!1,!1)}else ja.right>=this.en.right?(ba+=2,ua=8):ja.bottom>=this.en.bottom&&(ka+=2,ua=32),Pa=ka,ra=ba,Ua=new x.Range(ka,ba,ka,ba,!1,!1),ua=16;this.gridView.NK(Ua)||(this.ds?this.ds.qq||(this.ds=z.a.instance.create(()=>{this.gridView.Eu(Ua,ua,"TableResizeBehavior.BringRangeIntoView")},40,A.a.Wdg)):this.ds=z.a.instance.create(()=>{this.gridView.Eu(Ua,ua,"TableResizeBehavior.BringRangeIntoView")},40,A.a.Wdg))}o_a(ja){let ua=
ja;if(this.gridView.ib.c5){if(!this.gridView.Ub(ja.topLeft)){const Za=this.gridView.jk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.KH,this.Es.top!==ja.top?1:2);try{Za.Sk=this.Es.top<ja.top||this.Es.left<ja.left,Za.Ks(ja.topLeft),ua=Za.$$cu().range}finally{Za&&Za.dispose()}}ua.right=ua.left+ja.width-1;ua.bottom=ua.top+ja.height-1}return ua}hzc(ja,ua,Za=!0){const Pa=[];for(const ka of ja)Pa.push(new H.a(ka,r.d(this.$.na)));this.qb.qx(Pa,[ua],!0,void 0,Za)}Sej(){C.a.instance.sa(G.a.Mj,
document.documentElement,this.Hh);for(const ja of this.gridView.Ln)C.a.instance.sa(G.a.Mj,ja.domElement,this.Hh);C.a.instance.sa(G.a.Rf,document.documentElement,this.Qf);this.zNe()}Lfj(){J.a.instance.sa(G.a.$f,document.documentElement,this.Hh);for(const ja of this.gridView.Ln)J.a.instance.sa(G.a.$f,ja.domElement,this.Hh);J.a.instance.sa(G.a.we,document.documentElement,this.sHb);this.zNe()}Yv(){this.CBb&&this.YWj();this.Ykc&&this.jXj()}YWj(){C.a.instance.Ba(G.a.Mj,document.documentElement,this.Hh);
for(const ja of this.gridView.Ln)C.a.instance.Ba(G.a.Mj,ja.domElement,this.Hh);C.a.instance.Ba(G.a.Rf,document.documentElement,this.Qf);this.TTf()}jXj(){J.a.instance.Ba(G.a.$f,document.documentElement,this.Hh);for(const ja of this.gridView.Ln)J.a.instance.Ba(G.a.$f,ja.domElement,this.Hh);J.a.instance.Ba(G.a.we,document.documentElement,this.sHb);this.TTf()}zNe(){this.gridView.jc.a$b(!0)}TTf(){this.gridView.jc.a$b(!1)}cUj(ja){this.$.Xc(-1400250766,U.a.Db,30,{["ResizeTableRange"]:ja,["OriginalTableRange"]:this.en})}NYj(ja){if(!this.en.contains(ja)){ja=
this.oPj();for(const ua of ja)if(this.tableManager.Bud(ua)){this.gridView.yf.hm(P.a.HKi);return}}this.gridView.rtl?this.gridView.yf.hm(P.a.PJi):this.gridView.yf.hm(P.a.SLi)}tdb(){if(this.wB){aa.b(this.$,!1);try{this.Yv()}catch(ja){e.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ja}`)}}this.ds&&(this.ds.cancel(),this.ds.dispose());this.Ykc=this.CBb=!1;this.hKb();this.yMd();aa.b(this.$,!1);this.gridView.yf.hm(P.a.ZQ)}oPj(){const ja=[];
this.en.right!==this.Es.right&&ja.push(new x.Range(this.en.top,this.en.right+1,this.Es.bottom,this.Es.right,!1,!1));this.en.bottom!==this.Es.bottom&&ja.push(new x.Range(this.en.bottom+1,this.en.left,this.Es.bottom,this.en.right,!1,!1));return ja}static createInstance(ja,ua,Za,Pa){if(!ua)return null;const ka=ja.qb;ka.qx(Za,[27],!0);ka.Tn(na.hPj);Za=ka.Gv(27,ja.ib.Mi(ua.bottomRight),na.BTh(ua,Za)).zf;return new na(Za,ja,ua,Pa)}static BTh(ja,ua){var Za;for(let Pa=0;Pa<ua.length;Pa++)if((null===(Za=ua[Pa])||
void 0===Za?0:Za.range)&&ua[Pa].range.equals(ja))return Pa;return 0}}na.hPj=[27];Object(t.a)(na,"TableResizeBehavior",L.a,[]);var W=a(7);L=a(238);class X{}X.wzh="ewa-ttrd-buttonarea";Object(t.a)(X,"CssClassNames",null,[]);var Aa=a(50),Q=a(131),fa=a(92),Ca=a(22),ia=a(13),Ra=a(255),Ya=a(132),Ga=a(263);class da extends L.a{constructor(ja){super(document.createElement("div"));this.JWc=this.ord=this.IMf=this.aR=!1;this.vMb=null;this.Sh=()=>{B.c(this.$,this.gridView.ha.ra.activeCell)?(this.fNa=!0,this.Usb(!1)):
(this.A_=this.fNa=!1,this.Oig())};this.Tt=()=>{this.fNa?this.Usb(!0):this.A_=!1};this.rBf=()=>{this.JWc=!0;this.fNa&&(this.A_=!1)};this.onContentReady=()=>{this.$.isEditMode?B.c(this.$,this.gridView.ha.ra.activeCell)&&(this.fNa=!0,this.Usb(!1)):this.A_=!1};this.hza=()=>{this.JWc=!1;this.fNa?this.Usb(!1):this.A_=!1};this.sf=(ua,Za)=>{this.fNa&&(ua=this.gridView.mbb(Za.Yc.block.ae.BlockCachePosition.PaneType).fC(Za.Yc.hash))&&(ua.ONd(this.ycf),ua.MYc(this.ycf))};this.ycf=()=>{this.$Xf()};this.$=ja;
this.gridView=S.h(this.$);this.parentElement=this.domElement;this.parentElement.className=X.wzh;this.YLa=this.gridView.zj;this.fNa=!0;this.Hgi();this.cUg();this.Usb(!1);e.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get A_(){return this.ord}set A_(ja){this.ord!==ja&&(this.ord=this.isVisible=ja)}get zCb(){return!!(this.$.qd&16)}get Wpi(){const ja=this.gridView.ha.ra.activeCell;return ja.right===ja.maxColumns}get gob(){const ja=this.gridView.Ub(null);return ja&&
this.gridView.dca(ja.range)?this.hwa(ja):(ja&&e.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.hmh();this.$=this.gridView=this.parentElement=this.YLa=null;super.dispose()}uRh(ja){const ua=this.j5h(this.gridView.Ub(null).range);return ua?`=SUBTOTAL(${ja},${ua})`:null}j5h(ja){var ua=S.h(this.$).Ab.Cj(ja);if(!ua)return null;ua=v.a(ua,!1);ua.right=ua.left=ja.left;return ua.toString()}Hgi(){da.IM={};da.IM["100"]=
ia.a.instance.ga(1101);da.IM["101"]=ia.a.instance.ga(1104);da.IM["102"]=ia.a.instance.ga(1103);da.IM["103"]=ia.a.instance.ga(1108);da.IM["104"]=ia.a.instance.ga(1105);da.IM["105"]=ia.a.instance.ga(1106);da.IM["109"]=ia.a.instance.ga(1102);da.IM["107"]=ia.a.instance.ga(1109);da.IM["110"]=ia.a.instance.ga(1111);da.IM["111"]=ia.a.instance.ga(1162)}C2i(){var ja=this.gridView.Ub(null);if(ja&&(ja=ja.pB?ja.formulaBarText:null))if("=SUBTOTAL("===ja.substring(0,10)){if(ja=ja.substring(10,13),ja in da.IM)return ja}else return"111";
return"100"}cUg(){this.gridView.Da.pt(this.sf);this.gridView.ha.fH(this.Sh);this.gridView.pv(this.onContentReady);this.gridView.jc.Zk(this.rBf);this.gridView.jc.Qm(this.hza)}hmh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.tL(this.Sh),this.gridView.Da.dr(this.sf)),this.gridView.Ny(this.onContentReady),this.gridView.jc&&(this.gridView.jc.Uk(this.rBf),this.gridView.jc.fm(this.hza)),this.Oig())}Usb(ja){this.YYj(ja);this.zCb&&(this.NNj(),this.gob?(this.IMf||this.mUg(),this.JWc?this.A_=!1:(this.A_=
!0,this.$Xf())):(e.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.A_=!1))}$Xf(){appChrome.renderTableTotalRowOptions(this.parentElement,da.IM,da.IM[this.C2i()].toString(),Math.round(Y.a(this.$).zi(17)),ja=>{e.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ja}`);let ua={["SelectedOption"]:da.IM[ja],["FunctionKeyCode"]:ja,["Location"]:"canvas"};Ya.b(this.$).vd(Q.a.tPj,
ua,null,!0);if("111"===ja)return this.cki(),!0;if("100"!==ja){this.vMb=this.uRh(ja);if(!this.vMb)return e.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.WSa(this.vMb)}else this.WSa("");y.DOMElementExtensions.setFocus(this.gridView.Vb.textBox.domElement);return!0})}cki(){e.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");const ja=new fa.a(753860909,0,this.$.isEditMode?
2:1,19,null);this.$.Ka.Lb(ja)}hwa(ja){if(!ja)return null;var ua=this.gridView.jc.textBox.domElement;var Za=0<y.DOMElementExtensions.getHeight(ua)&&0<y.DOMElementExtensions.getWidth(ua)&&0<=ua.offsetTop&&0<=ua.offsetLeft;if(Za)ua=y.DOMElementExtensions.hwa(ua,this.gridView.zj);else{ua=this.gridView.getCellBounds(ja.cell);var Pa=y.DOMElementExtensions.getBoundingClientRect(this.gridView.zj);ua=new Sys.UI.Bounds(ua.x-Pa.x,ua.y-Pa.y,ua.width,ua.height)}if(ua)if(Za)2<ua.height&&2<ua.height&&(ua.x+=1,ua.y+=
1,ua.height-=2,ua.width-=2);else if(Za=S.h(this.$).sK(ja.cell))Za=Za.width,Pa=Ca.a.equals(Ra.a.gxb(ja.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Pa&&(ua.x=ua.x+ua.width-Za),ja.Gla&&this.gridView.rtl===Pa&&(ua.width=Za);else return null;return ua}YYj(ja){var ua=this.gob;if(ua){var Za=17>=ua.height?ua.y:ua.y+ua.height-17-2;ua=this.Wpi?this.gridView.rtl?ua.x:ua.x+ua.width-(17<ua.height?17:ua.height):this.gridView.rtl?ua.x-(17<ua.height?17:ua.height):ua.x+ua.width;var Pa=Y.a(this.$).qka(new Sys.UI.Point(ua,
Za));this.parentElement.style.top=T.HelperMethods.uc(Pa.y);this.parentElement.style.left=T.HelperMethods.uc(Pa.x);Y.a(this.$).dzj(this.parentElement);ja&&(this.A_=this.gridView.flc(new Aa.a(ua,Za)))}else this.A_=!1}mUg(){this.YLa.insertBefore(this.parentElement,this.YLa.firstChild);this.IMf=!0}NNj(){this.aR||(this.gridView.view.qt(this.Tt),this.aR=!0)}Oig(){this.aR&&this.gridView.view&&(this.gridView.view.fr(this.Tt),this.aR=!1)}WSa(ja){const ua=this.gridView.Vb,Za=this.gridView.Ub(null);Za&&(ja=
Object(W.a)(new Ga.a,{Text:ja}),this.gridView.setCell(ja,Za.range,0,127,null),ua.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}da.sPj="TableTotalRowDropDownIconButtonId";da.IM=null;Object(t.a)(da,"TableTotalRowOptions",L.a,[3]);class Z extends m.a{constructor(ja){super(S.h(ja));this.orb=this.r1=this.zCc=this.mrb=null;this.cve=!1;this.dee=null;this.WTb=0;this.K7b=null;this.B2b=()=>{const ua={},Za=this.Djd();for(let ka in Za){const ra=Za[ka];if(!ra)continue;const ba=this.o4h(ra);if(ba){if(ba in
this.xGa){var Pa=this.xGa[ba];if(Pa.wB){Pa.en.equals(ra)||(Pa.en=ra);delete this.xGa[ba];ua[ba]=Pa;continue}}(Pa=na.createInstance(S.h(this.$),ra,this.rOh(),this))?ua[ba]=Pa:e.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ra.Hw(!1)}`)}}this.J4b(null,null);this.ESb=ua};this.J4b=()=>{const ua=this.xGa;for(let ka in ua){var Za=ka,Pa=ua[ka];Pa&&(Pa.dispose(),delete this.xGa[Za])}this.ESb={}};this.dSf=()=>{this.J4b(null,null);this.B2b(null,
null)};this.onFocus=()=>{this.dee=S.h(this.$).ha.ra.activeCell};this.JR=()=>{this.$.isEditMode&&this.Sh(null,null)};this.Sh=()=>{!this.cve&&B.c(this.$,this.gridView.ha.ra.activeCell)&&this.Xzi()};this.pW=()=>{this.cAb(1);this.$.ea.Pn(this.pW)};this.BIb=()=>{this.cve=!0;this.zCc=new da(this.$)};this.$=ja;this.gridView=S.h(this.$);this.$.da.Ga(66,this);this.ESb={};this.B2b(null,null);this.$.va&&this.$.va.Wf(this.dSf);this.yYc(this.B2b);this.$.ea.UY(this.JR);this.gridView.ha.fH(this.Sh);this.$.isEditMode&&
this.Sh(null,null)}yYc(ja){this.addHandler(m.a.pcb,ja)}CNd(ja){this.removeHandler(m.a.pcb,ja)}dMg(ja){this.addHandler("tce",ja)}Shj(ja){this.removeHandler("tce",ja)}get xGa(){return this.ESb}get Svd(){return this.dee}get kJa(){return this.WTb}get Kg(){const ja=S.h(this.$);return ja.Ab.Cj(ja.ha.ra.activeCell,!1)}get $Id(){return this.Svd?S.h(this.$).Ab.Cj(this.Svd,!1):null}Bud(ja){return!!this.S6e(ja)}Bn(ja){return this.P0h(this.A7e(ja))}Qwb(ja){return this.A7e(ja)}Ifj(ja){ja?(this.orb?this.orb!==
ja&&(f.a.Ia(this.r1),this.r1=null,this.orb=ja):this.orb=ja,this.r1||(this.r1=I.a.instance.oe(this.orb)),this.r1.Oi("focusin")||this.r1.la("focusin",this.onFocus)):e.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}dkf(ja,ua){return ja?ja.yba&&ja.top===ua.top:(e.ULS.shipAssertTag(537151244,0,!!ja,"autofilterRange can't be null"),!1)}oka(ja){ja=this.mrb?u.I(ja,this.mrb):this.view.getRangeInformation(ja);return 0<ja.length&&Object(h.a)(n.PivotTableRange,
ja[0])?ja[0]:null}tmi(ja,ua){return ja?!ja.Hic&&!!ja.fF&&ja.fF.Fd(ua):(e.ULS.shipAssertTag(537151243,0,!!ja,"Pivot table can't be null"),!1)}Ksi(ja,ua){return ja?!ja.Hic&&!!ja.EL&&ja.EL.Fd(ua):(e.ULS.shipAssertTag(537151242,0,!!ja,"Pivot table can't be null"),!1)}u0b(ja){super.u0b(ja);if((ja=T.HelperMethods.c7e(ja))&&0<ja.length){this.mrb=Array(ja.length);for(let ua=0;ua<ja.length;ua++)this.mrb[ua]=w.a.QQ(ja[ua])}}aKb(){super.aKb();this.mrb=null}Kah(ja,ua){return this.YHe(ja,ua).returnValue}YHe(ja,
ua){var Za=!1;if(!ja||!ua)return{returnValue:!1,dZ:Za};ja=ja.clone();ja.right+=1;ja.left=ja.right;return!ja.Mz||ja.top<ua.ib.$i&&(Za=ja.clone(),Za.bottom>=ua.ib.$i&&(Za.bottom=ua.ib.$i-1),!({dZ:Za}=this.XHe(Za,ua)).returnValue)||ja.bottom>=ua.ib.$i&&(Za=ja.clone(),Za.top<=ua.ib.$i&&(Za.top=ua.ib.$i),!({dZ:Za}=this.XHe(Za,ua)).returnValue)?{returnValue:!1,dZ:Za}:{returnValue:!0,dZ:Za}}Xdg(ja){(ja=this.Bn(ja.topLeft))&&ja.toString()in this.xGa&&(this.xGa[ja.toString()].aud=!1)}r$i(){this.raiseEvent("tce")}Yh(ja,
ua){if(!this.zCc)return!1;switch(ua){case -569786022:case 541421805:if(this.zCc.A_){const Za=document.getElementById(da.sPj);Za&&z.a.instance.create(()=>{y.DOMElementExtensions.Ehc(Za,null)},0,A.a.lPj,!0,!0)}return!0;default:return!1}}dispose(){this.J4b(null,null);this.CNd(this.B2b);this.$.va.Dg(this.dSf);this.$.tl(this.J4b);this.ESb=null;this.$.ea&&this.$.ea.J0(this.JR);this.gridView.ha.tL(this.Sh);this.zCc=null;M.EwaSettings.isChangeGateEnabled("OfficeVSO:7427871_TableRename")&&this.r1&&(f.a.Ia(this.r1),
this.r1=null);super.dispose()}L$h(ja,ua,Za,Pa){const ka=this.gridView.Ab.Cj(new x.Range(ua,Za,ua,Za,!1,!1));if(this.K7b=ka){var ra=ka.usedRange,ba=ja.ctrlKey||d.a.isMac&&D.b(ja),Ua=!ja.shiftKey&&ba;ja=ja.shiftKey&&!ba;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(S.h(this.$).ha.selectionType=3);switch(Pa){case 0:this.WTb=0;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ua=this.M7c(ja,ra.top,Za,ra.bottom,Za),this.GTd(ua,
Ua,ja)):this.HTd(ra.top,Za,ra.bottom,Za,v.d(ka),v.g(ka),Ua);break;case 1:this.WTb=1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ua=this.M7c(ja,ua,ra.left,ua,ra.right),this.GTd(ua,Ua,ja)):this.HTd(ua,ra.left,ua,ra.right,!1,!1,Ua);break;case 2:this.WTb=2;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ua=this.M7c(ja,ra.top,ra.left,ra.bottom,ra.right),this.GTd(ua,Ua,ja)):this.HTd(ra.top,ra.left,ra.bottom,ra.right,
v.d(ka),v.g(ka),Ua);break;default:e.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Pa.toString()}`);return}M.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(S.h(this.$).ha.selectionType=3);e.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else e.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}JDj(ja){const ua=
this.K7b.usedRange;return this.imf(ja)||1!==this.kJa&&this.imf(new x.Range(ua.top,ja.left,ua.bottom,ja.right,!1,!1))?!0:!1}tKd(ja){return ja.Autofilters}XHe(ja,ua){let Za;Za=!1;const Pa=ua.ib.Mi(ja),ka=ua.Df(Pa).ui;if(!ka)return e.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Pa}`),{returnValue:!1,dZ:Za};if(!ka.He(ja))return{returnValue:!0,dZ:Za};ja=ua.jk("TableManager.CouldExpandImpl",ja,2);try{for(;ja.$$mn();){if(ja.$$cu().text||ja.ao.acf)return Za=
!0,{returnValue:!1,dZ:Za};if(ja.$$cu().bI)return{returnValue:!1,dZ:Za}}}finally{ja&&ja.dispose()}return{returnValue:!0,dZ:Za}}P0h(ja){if(!ja)return null;const ua=new l.AutofilterRange(ja.top,ja.left,ja.bottom,ja.right,null,null,null,ja.id,ja.yba);ua.KBa=ja.KBa;const Za=this.gridView.Ab.Cj(ja,!0);if(!Za)return null;for(let Pa=0,ka=this.rangeList.length;Pa<ka;Pa++){const ra=this.rangeList[Pa],ba=this.gridView.Ab.Cj(ra,!0);ba&&ba.name===Za.name&&ra!==ja&&this.Qri(ra)&&(ua.union(ra),ra.KBa&&(ua.KBa=!0))}return ua}Qri(ja){return!!S.h(this.$).Ab.Cj(ja)}rOh(){const ja=
[];for(const ua of this.rangeList){const Za=new H.a(this.Bn(ua.topLeft),r.d(this.$.na));ja.push(Za)}return ja}Djd(){const ja={};for(const ua of this.rangeList){if(!ua)continue;const Za=this.Bn(ua.topLeft);Za&&(ja[Za.toString()]=this.Bn(ua.topLeft))}return ja}Xzi(){this.$.ea.Yf?this.cAb(0):this.$.ea.Lk(this.pW)}cAb(ja){this.$.qy(ua=>{ua.bba(ja).then(this.BIb)})}o4h(ja){const ua=this.gridView.Ab.Cj(ja);return ua?ua.name:ja.toString()}HTd(ja,ua,Za,Pa,ka,ra,ba){const Ua=ja+(ka?1:0),Ka=Za-(ra?1:0),Oa=
this.gridView.inRangePicker||this.gridView.ji;let ib=!1;const La=new x.Range(Ua,ua,Ka,Pa,!1,!1);if(ka||ra){ka=Oa?H.a.ntb(this.gridView.ha.rangePicker.nL):this.gridView.ha.ra.selectedRanges;for(const db of ka){ib=this.ssb(db,Ua,ua,Ka,Pa);ka=this.ssb(db,ja,ua,Za,Pa);if(Oa&&ib)break;if(!Oa&&(ib||ka)){this.gridView.ha.updateSelection(db,db.topLeft,0,1);if(ba&&ka)return;break}}}ib&&(La.top=ja,La.bottom=Za);ja=La.topLeft;ba?this.gridView.ha.updateSelection(La,ja,0,1):Oa?this.gridView.ha.rx([La],0,ja,0):
this.gridView.ha.updateSelection(La,ja,0,3)}GTd(ja,ua,Za){ja&&(Za=Za?S.h(this.$).ha.ra.activeCell:ja.topLeft,ua?this.gridView.ha.updateSelection(ja,Za,0,1):this.gridView.ha.rx([ja],0,Za,0))}M7c(ja,ua,Za,Pa,ka){const ra=v.d(this.K7b),ba=v.g(this.K7b),Ua=ua+(1!==this.kJa&&ra?1:0),Ka=Pa-(1!==this.kJa&&ba?1:0),Oa=this.gridView.inRangePicker||this.gridView.ji;if(ja){var ib=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Oa&&!H.a.ntb(this.gridView.ha.rangePicker.nL).length?
new x.Range(Ua,Za,Ka,ka,!1,!1):Oa?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ra.activeCell;ib=new x.Range(ib.top<Ua?ib.top:Ua,ib.left<Za?ib.left:Za,ib.bottom>Ka?ib.bottom:Ka,ib.right>ka?ib.right:ka,!1,!1)}else ib=new x.Range(Ua,Za,Ka,ka,!1,!1);if(1!==this.kJa&&(ra||ba)&&(!ja||ja&&this.ssb(ib,Ua,Za,Ka,ka))){ja=Oa?H.a.ntb(this.gridView.ha.rangePicker.nL):this.gridView.ha.ra.selectedRanges;for(const La of ja)if(this.ssb(La,Ua,Za,Ka,ka)){ib.top=ua;ib.bottom=Pa;break}}return ib}imf(ja){const ua=
this.gridView.inRangePicker||this.gridView.ji?H.a.ntb(this.gridView.ha.rangePicker.nL):this.gridView.ha.ra.selectedRanges;for(const Za of ua)if(this.ssb(Za,ja.top,ja.left,ja.bottom,ja.right))return!0;return!1}ssb(ja,ua,Za,Pa,ka){return!!ja&&ja.top===ua&&ja.bottom===Pa&&ja.left===Za&&ja.right===ka}}Object(t.a)(Z,"TableManager",m.a,[871,3]);class ha extends b.a{constructor(ja){super();this.tableManager=null;this.$=ja;this.Fb()}create(){this.ob(this.tableManager||(this.tableManager=new Z(this.$)))}}
Object(t.a)(ha,"TableManagerFactory",b.a,[]);var Wa=a(1220);a.d(E,"a",function(){return ca});const ca=()=>{c.a.Fa(ja=>{ja.da.Ga(134,new ha(ja));ja.da.Ga(330,new Wa.a(ja))})}},1220:function(t,E,a){t=a(0);var c=a(222),b=a(48),e=a(37),f=a(7),d=a(15),h=a(111),m=a(819),l=a(1465),w=a(726),n=a(1394),x=a(38),r=a(5),u=a(161),v=a(76),B=a(60),z=a(162),A=a(47),y=a(46),D=a(110);a(28);var I=a(193),M=a(29),T=a(283),S=a(1),H=a(22),C=a(13);a(30);class G{}Object(t.a)(G,"TableStyleElement",null,[]);var J=a(752),L=a(208),
P=a(90),aa=a(528);class U{static Ttf(Aa,Q){return U.$dg[Aa.Type]-U.$dg[Q.Type]}static w5a(Aa,Q){try{return appChrome.buildTableStyleGalleryIconNew(U.WBa,U.Poa,Aa,Q)}catch(fa){return null}}static Nnf(Aa){return Aa&&v.a.Kc in Aa&&(Aa=Aa[v.a.Kc])?H.a.$I(Aa,r.a.OIb):!1}static Ita(Aa){const Q=[];let fa=0;for(const Ca of Aa){Q[fa]={};Q[fa].backgroundColor="white";Q[fa].color="black";for(let ia in Ca)switch(Aa=Ca[ia],ia){case "background-color":Q[fa].backgroundColor=Aa;break;case "color":Q[fa].color=Aa;
break;case "font-size":Q[fa].fontSize=Aa;break;case "border-bottom":Q[fa].borderBottom=Aa;break;case "border-right":Q[fa].borderRight=Aa;break;case "border-left":Q[fa].borderLeft=Aa;break;case "border-top":Q[fa].borderTop=Aa}fa++}return Q}static m6b(Aa,Q){const fa=[];if(null===Aa||void 0===Aa?0:Aa.TableStyleElementsList){var Ca=0===Aa.Category;for(let ia=0;ia<U.Poa;ia++)fa.push(...U.rSh(Aa,Q,Ca,ia))}else{if(U.i9c)return U.i9c;Aa={color:"black","background-color":"white"};for(Q=0;Q<U.Poa;Q++)for(Ca=
0;Ca<U.WBa;Ca++)fa.push(Aa);U.i9c=fa}return fa}static p4h(Aa,Q){if(!Aa.TableStyleElementsList)return"";let fa="";for(const Ca of Aa.TableStyleElementsList)if(Ca.BackgroundColor&&"#000000"!==Ca.BackgroundColor)switch(Ca.Type){case 0:fa=Ca.BackgroundColor;break;case 5:case 7:if(Q.sia||Q.qS)fa=Ca.BackgroundColor;break;case 3:case 4:if(Q.firstCol||Q.lastCol)fa=Ca.BackgroundColor;break;case 2:Q.totalRow&&(fa=Ca.BackgroundColor);break;case 1:Q.headerRow&&(fa=Ca.BackgroundColor)}return fa}static n5b(Aa){Aa=
new L.a(parseInt(String("0x"+Aa.substr(1,2)),16),parseInt(String("0x"+Aa.substr(3,2)),16),parseInt(String("0x"+Aa.substr(5,2)),16));return J.a.ALa(Aa)}static k9e(Aa,Q){if(!Aa||!Q)return"";Q=(Q=U.p4h(Aa,Q))?U.n5b(Q)+", ":C.a.instance.ga(2064)+", ";switch(Aa.Index){case 0:return Q+C.a.instance.ga(1998);case 1:return Q+C.a.instance.ga(1999);case 2:return Q+C.a.instance.ga(2E3);case 3:return Q+C.a.instance.ga(2001);case 4:return Q+C.a.instance.ga(2002);case 5:return Q+C.a.instance.ga(2003);case 6:return Q+
C.a.instance.ga(2004);case 7:return Q+C.a.instance.ga(2005);case 8:return Q+C.a.instance.ga(2006);case 9:return Q+C.a.instance.ga(2007);case 10:return Q+C.a.instance.ga(2008);case 11:return Q+C.a.instance.ga(2009);case 12:return Q+C.a.instance.ga(2010);case 13:return Q+C.a.instance.ga(2011);case 14:return Q+C.a.instance.ga(2012);case 15:return Q+C.a.instance.ga(2013);case 16:return Q+C.a.instance.ga(2014);case 17:return Q+C.a.instance.ga(2015);case 18:return Q+C.a.instance.ga(2016);case 19:return Q+
C.a.instance.ga(2017);case 20:return Q+C.a.instance.ga(2018);case 21:return Q+C.a.instance.ga(2019);case 22:return Q+C.a.instance.ga(2020);case 23:return Q+C.a.instance.ga(2021);case 24:return Q+C.a.instance.ga(2022);case 25:return Q+C.a.instance.ga(2023);case 26:return Q+C.a.instance.ga(2024);case 27:return Q+C.a.instance.ga(2025);case 28:return Q+C.a.instance.ga(2026);case 29:return Q+C.a.instance.ga(2027);case 30:return Q+C.a.instance.ga(2028);case 31:return Q+C.a.instance.ga(2029);case 32:return Q+
C.a.instance.ga(2030);case 33:return Q+C.a.instance.ga(2031);case 34:return Q+C.a.instance.ga(2032);case 35:return Q+C.a.instance.ga(2033);case 36:return Q+C.a.instance.ga(2034);case 37:return Q+C.a.instance.ga(2035);case 38:return Q+C.a.instance.ga(2036);case 39:return Q+C.a.instance.ga(2037);case 40:return Q+C.a.instance.ga(2038);case 41:return Q+C.a.instance.ga(2039);case 42:return Q+C.a.instance.ga(2040);case 43:return Q+C.a.instance.ga(2041);case 44:return Q+C.a.instance.ga(2042);case 45:return Q+
C.a.instance.ga(2043);case 46:return Q+C.a.instance.ga(2044);case 47:return Q+C.a.instance.ga(2045);case 48:return Q+C.a.instance.ga(2046);case 49:return Q+C.a.instance.ga(2047);case 50:return Q+C.a.instance.ga(2048);case 51:return Q+C.a.instance.ga(2049);case 52:return Q+C.a.instance.ga(2050);case 53:return Q+C.a.instance.ga(2051);case 54:return Q+C.a.instance.ga(2052);case 55:return Q+C.a.instance.ga(2053);case 56:return Q+C.a.instance.ga(2054);case 57:return Q+C.a.instance.ga(2055);case 58:return Q+
C.a.instance.ga(2056);case 59:return Q+C.a.instance.ga(2057);default:return Aa.Name?Aa.Name:""}}static uZh(Aa){return(Aa+1)%U.kdi}static nyb(Aa,Q,fa=""){return Aa||!fa?`${U.uef}, ${Aa.Index.toString()}, -version, ${Q.toString()}`:`${U.uef}, ${fa}, -version, ${Q.toString()}`}static rSh(Aa,Q,fa,Ca){const ia=[];for(let Ra=0;Ra<U.WBa;Ra++)ia.push(U.Ugd(Aa,Q,fa,Ca,Ra));return ia}static Ugd(Aa,Q,fa,Ca,ia){Aa=Aa.TableStyleElementsList;let Ra=new G;const Ya={};if(!Aa)return Ya;for(var Ga of Aa)if(0===Ga.Type){Ra=
Ga;break}Ga=!!Ra.BackgroundColor;let da="";!fa&&Ra.TableStyleBorderFromatList&&0<Ra.TableStyleBorderFromatList.length&&(da=Ra.TableStyleBorderFromatList[0].Color);Ya["background-color"]=Ga?Ra.BackgroundColor:"#FFFFFF";Ra.FontColor||(Ra.FontColor="#000000");Ya.color=Ra.FontColor;U.$Ce(Ca,ia,Ya,Ra,da,fa,Ga);for(const Z of Aa)Z&&0!==Z.Type&&(2!==Z.Type||Ga||(Z.BackgroundColor=Ra.BackgroundColor),U.sud(Z,Ca,ia,Q)&&(Z.BackgroundColor&&(Ya["background-color"]=Z.BackgroundColor),Ya.color=Z.FontColor||Ra.FontColor,
U.$Ce(Ca,ia,Ya,Z,da,fa,Ga)));return Ya}static wV(Aa,Q,fa,Ca,ia,Ra){fa&&(fa.Color&&!fa.Style&&(fa.Style=1),fa.Style&&!fa.Color&&(fa.Color=ia?"#000000":Ca?Ca:Ra?"#FFFFFF":"#000000"),Q[U.borders[Aa]]="1px "+U.hW[fa.Style]+" "+fa.Color)}static sud(Aa,Q,fa,Ca){return-1===Aa.Type?!1:U.uud(Aa,Q,fa,Ca)||U.$ti(Aa,Q,fa,Ca)||U.vud(Aa,Q,fa,Ca)}static $ti(Aa,Q,fa,Ca){return!Q&&Ca.headerRow||Q===U.Poa-1&&Ca.totalRow?!1:1===Q%2&&5===Aa.Type&&Ca.qS&&Ca.headerRow||1<Q&&!!((Q-1)%(Aa.BandSize+1))&&6===Aa.Type&&Ca.qS&&
Ca.headerRow||!(Q%2)&&5===Aa.Type&&Ca.qS&&!Ca.headerRow||!!(Q%(Aa.BandSize+1))&&6===Aa.Type&&Ca.qS&&!Ca.headerRow||!(fa%2)&&7===Aa.Type&&Ca.sia||!!(fa%(Aa.BandSize+1))&&8===Aa.Type&&Ca.sia}static vud(Aa,Q,fa,Ca){return Q===U.Poa-1&&2===Aa.Type&&Ca.totalRow||fa===U.WBa-1&&Q===U.Poa-1&&12===Aa.Type&&Ca.totalRow&&Ca.lastCol||!fa&&Q===U.Poa-1&&11===Aa.Type&&Ca.totalRow&&Ca.firstCol||fa===U.WBa-1&&4===Aa.Type&&Ca.lastCol}static uud(Aa,Q,fa,Ca){return!Q&&1===Aa.Type&&Ca.headerRow||!fa&&3===Aa.Type&&Ca.firstCol||
!fa&&!Q&&9===Aa.Type&&Ca.headerRow&&Ca.firstCol||fa===U.WBa-1&&!Q&&10===Aa.Type&&Ca.headerRow&&Ca.lastCol}static $Ce(Aa,Q,fa,Ca,ia,Ra,Ya){if(Ca.TableStyleBorderFromatList)for(const Ga of Ca.TableStyleBorderFromatList)if(Ga.Style)switch(Ga.Position){case 0:Aa&&12!==Ca.Type&&11!==Ca.Type&&2!==Ca.Type&&5!==Ca.Type&&6!==Ca.Type||U.wV(0,fa,Ga,ia,Ra,Ya);break;case 1:Aa!==U.Poa-1&&1!==Ca.Type&&10!==Ca.Type&&9!==Ca.Type&&5!==Ca.Type&&6!==Ca.Type||U.wV(1,fa,Ga,ia,Ra,Ya);break;case 2:Q&&12!==Ca.Type&&10!==
Ca.Type&&7!==Ca.Type&&8!==Ca.Type&&4!==Ca.Type||U.wV(2,fa,Ga,ia,Ra,Ya);break;case 3:Q!==U.WBa-1&&9!==Ca.Type&&11!==Ca.Type&&3!==Ca.Type&&7!==Ca.Type&&8!==Ca.Type||U.wV(3,fa,Ga,ia,Ra,Ya);break;case 5:Q!==U.WBa-1&&3!==Ca.Type&&4!==Ca.Type&&7!==Ca.Type&&8!==Ca.Type&&U.wV(3,fa,Ga,ia,Ra,Ya);break;case 6:Aa!==U.Poa-1&&2!==Ca.Type&&1!==Ca.Type&&5!==Ca.Type&&6!==Ca.Type&&U.wV(1,fa,Ga,ia,Ra,Ya)}}static s4h(){const Aa=Array(12);Aa[0]=0;Aa[7]=1;Aa[8]=2;Aa[5]=3;Aa[6]=4;Aa[4]=5;Aa[3]=6;Aa[1]=7;Aa[2]=8;Aa[9]=9;
Aa[10]=10;Aa[11]=11;Aa[12]=13;return Aa}}U.Poa=5;U.WBa=5;U.kdi=5;U.uef="TableStyleIcon";U.hW=[null,P.a.solid,P.a.dashed,P.a.dotted,P.a.dashed,P.a.dotted,P.a.dashed,P.a.double];U.borders=[aa.a.borderTop,aa.a.borderBottom,aa.a.borderLeft,aa.a.borderRight];U.$dg=U.s4h();U.i9c=null;Object(t.a)(U,"TableStyleHelper",null,[]);class K{constructor(Aa,Q,fa,Ca,ia,Ra){this.headerRow=Aa;this.totalRow=Q;this.firstCol=fa;this.lastCol=Ca;this.qS=ia;this.sia=Ra}equals(Aa){return Aa?this.headerRow===Aa.headerRow&&
this.totalRow===Aa.totalRow&&this.firstCol===Aa.firstCol&&this.lastCol===Aa.lastCol&&this.sia===Aa.sia&&this.qS===Aa.qS:!1}}Object(t.a)(K,"TableStyleOptions",null,[]);var Y=a(793);class na extends x.a{constructor(Aa,Q,fa){super();this.z7i={["height"]:"100%"};this.RJb={};this.ZIa=this.wkd=0;this.lastSyncTime=new Date;this.nea=-1;this.AO=null;this.ina={};this.QL=null;this.aJ={};this.DUa={};this.Kuc=null;this.rCb=this.S7a=this.isInitialized=this.bmf=!1;this.Lxc=null;this.XBc=this.dPb=this.D_e=!1;this.sTi=
(Ca,ia,Ra)=>{let Ya=!1;if(T.a(Ca))-315732528!==Ca.Errors[0].MessageId&&(d.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${M.a.sc(Ca.Errors)}`),this.EEf(null,ia,Ra));else if(d.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(Ca=Ca.Result)&&Ca.TableStyleItems.length){Ra=60<Ca.TableStyleItems.length;var Ga=!1,da=!1;if(this.QL)for(var Z=0;60>Z;++Z){const ha=Ca.TableStyleItems[Z],
Wa=this.QL.TableStyleItems[Z];if(ha.HasStyleViolations!==Wa.HasStyleViolations){Ya=da=!0;break}for(let ca=0;9>ca&&!(ca>=ha.TableStyleElementsList.length);ca++)if(!H.a.equals(ha.TableStyleElementsList[ca].BackgroundColor,Wa.TableStyleElementsList[ca].BackgroundColor,!1)){Ya=Ga=!0;break}}else{this.ZIa=0;for(Z of Ca.TableStyleItems)Z.TableStyleElementsList&&Z.TableStyleElementsList.sort(U.Ttf),this.aJ[Z.Name]=Z}if(Ga||da)for(Ga=0;60>Ga;++Ga)da=Ca.TableStyleItems[Ga],this.aJ[da.Name]=da;if(Ra&&this.QL)for(d.ULS.sendTraceTag(42821700,
0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${Ca.TableStyleItems.length-60}`),Ya=!0,Ra=60;Ra<Ca.TableStyleItems.length;++Ra)Ga=Ca.TableStyleItems[Ra],Ga.Name in this.aJ||Ga.TableStyleElementsList&&Ga.TableStyleElementsList.sort(U.Ttf),this.aJ[Ga.Name]=Ga;if(Y.a(this.aJ).length!==Ca.TableStyleItems.length)for(Ya=!0,Ga=Ra=60;Ga<this.QL.TableStyleItems.length;)Ra>=Ca.TableStyleItems.length?delete this.aJ[this.QL.TableStyleItems[Ga].Name]:Ra>=Ca.TableStyleItems.length||
!H.a.equals(Ca.TableStyleItems[Ra].Name,this.QL.TableStyleItems[Ga].Name,!1)?delete this.aJ[this.QL.TableStyleItems[Ga].Name]:++Ra,++Ga;this.QL=Ca;this.kUf(Ya);Ya&&this.f1c();ia&&("accessibility"===ia?(this.dPb=!1,this.XBc=!0):this.XBc=!1);this.bmf||(this.rui()&&this.$.af(),this.bmf=!0);this.wkd=0;this.rCb||this.D_e?this.XBc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.D_e=!0)}};this.EEf=()=>{d.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");
this.wkd++;5>this.wkd&&A.a.instance.create(()=>{this.X5a("getTableStylesFailed")},1E3,y.a.Zdg,!0,!0)};this.jKf=()=>{this.rCb&&(this.rCb=!1,this.Lxc&&this.Lxc(),A.a.instance.create(()=>{this.X5a("galleryMenuClosed")},1E3,y.a.Zdg,!0,!0))};this.$=Aa;this.Va=Q;this.tableManager=fa;this.$.da.Ga(329,this);this.C1c=this.jxb();this.$.Ka.b_a(this.jKf)}qbf(Aa){const Q=this.tableManager.Kg;if(!Q)return!1;Aa=Aa[v.a.Kc];if(!Aa)return!1;switch(Number.parseInvariant(Aa)){case 0:return z.d(Q);case 1:return z.c(Q);
case 2:return z.g(Q);case 3:return z.e(Q);case 4:return z.f(Q);case 5:return z.b(Q);case 6:return Q.hasAutoFilter}return!1}iOf(Aa,Q){if(h.a.isEmpty(this.aJ))return!0;if("PopulateTableMoreStylesMenu"!==Aa&&"PopulateTableAccessibleStylesMenu"!==Aa)return!1;if("PopulateTableAccessibleStylesMenu"===Aa&&!this.XBc)return this.dPb||(this.dPb=!0,this.X5a("accessibilityTab")),!0;this.rCb=!0;const fa=this.Va.gq("TableStylesMenu"),Ca=this.Va.$A("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),
ia=this.Va.$A("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ra=this.Va.$A("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Ya=this.Va.$A("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let Ga=-123538519,da;if(Q.MenuId)if(H.a.contains(Q.MenuId,"FormatAsTable",!0))Ga=753331043,this.S7a=!0;else{da=C.a.instance.ga(1997);var Z=U.nyb(null,1,"-1");S.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Ya.nu("-1",Ga,"QueryTableStyle",
0,"-1",Z,void 0,void 0,da):Ya.nu("-1",Ga,"QueryTableStyle",0,"-1",void 0,void 0,void 0,da);this.S7a=!1}Z=0;const ha=this.aJ;for(let Wa in ha){const ca=ha[Wa];if("PopulateTableAccessibleStylesMenu"===Aa&&ca.HasStyleViolations)continue;let ja;da=U.k9e(ca,this.jxb());ja=U.nyb(ca,this.ZIa);if(ca)switch(ca.Category){case 0:Ca.nu(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),ja,void 0,void 0,da);Z++;break;case 3:ia.nu(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),ja,void 0,
void 0,da);break;case 2:Ra.nu(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),ja,void 0,void 0,da);break;case 1:Ya.nu(ca.Index.toString(),Ga,"QueryTableStyle",0,ca.Index.toString(),ja,void 0,void 0,da)}}0<Z&&this.a3(fa,Ca,1965);this.a3(fa,Ya,1966);this.a3(fa,Ra,1967);this.a3(fa,ia,1968);Q.MenuItems=fa.NC();this.isInitialized||(this.isInitialized=!0);return!0}imd(Aa){Aa[m.a.On]=!1;let Q=Aa[v.a.Kc];if(Q&&!h.a.isEmpty(this.aJ)){H.a.contains(Aa.ParentMenuId,"FormatAsTable",!0)?this.S7a=
!0:this.S7a=!1;this.S7a||this.yjg();U.Nnf(Aa)&&(Q=this.Cxb(Q).toString());var fa=this.jxb();Aa[m.a.Alt]="-1"===Q?C.a.instance.ga(1997):U.k9e(this.vkd(Q),fa);if(Q in this.DUa&&fa.equals(this.C1c))this.kOf(Aa,Q,fa,!0);else{if(!this.Kuc||this.Kuc&&!this.Kuc.qq)this.ina={},this.Kuc=A.a.instance.create(()=>{this.kUf();this.C1c=this.jxb()},0,y.a.rPj,!0,!0);this.THd(fa,Aa,Q)}}}getTableStyleIndexFromName(Aa){if(!Aa||h.a.isEmpty(this.aJ))return-1;if(Aa in this.aJ)return this.aJ[Aa].Index;this.X5a("getTableStyleIndexFromName");
return-1}Cud(){return!!this.QL}Cxb(Aa){this.AO||this.f1c();return Aa in this.AO?this.AO[Aa]:-1}X5a(Aa){if(this.$.isEditMode){var Q=new Date;if(30<D.getElapsedSeconds(this.lastSyncTime,Q)||h.a.isEmpty(this.aJ)||this.dPb){let fa=this.$.pa.xa.Wb();this.lastSyncTime=Q;Aa=this.dPb&&"accessibilityTab"===Aa||"galleryMenuClosed"===Aa;B.m(this.$.pa.xa,Aa,this.sTi,this.EEf,null,Aa?"accessibility":"normal",fa)}}}dispose(){this.AO=this.DUa=this.QL=this.aJ=null;this.$.Ka.CKb(this.jKf);super.dispose()}IOg(Aa){this.addHandler("RefreshTableStyleGallery",
Aa)}Wjj(Aa){this.removeHandler("RefreshTableStyleGallery",Aa)}f1c(){const Aa={};this.tableManager.Kg&&(this.nea=this.getTableStyleIndexFromName(this.tableManager.Kg.yCc));for(let Q=1;7>=Q;Q++)Aa["preview"+Q]=this.yYh(Q);this.AO=Aa}yYh(Aa){var Q=this.QL.TableStyleItems.length;Q=4>=this.nea?this.nea+Aa-1:4<this.nea&&this.nea<Q-4?4===Aa?this.nea:Math.floor(this.nea+Aa-4):this.nea+Aa-1;-1===Q||Q.toString()in this.DUa||(Q=Aa-3);return Q}yjg(){if(this.tableManager.Kg){let Aa=!1;const Q=this.getTableStyleIndexFromName(this.tableManager.Kg.yCc);
if(Q!==this.nea){if(this.AO){const fa=this.AO;for(let Ca in fa)fa[Ca]===Q&&(Aa=!0)}this.nea=Q;Aa||h.a.isEmpty(this.DUa)||this.f1c()}}}a3(Aa,Q,fa){const Ca=this.Va.Fc();Ca.hq="Thin";Ca.title=C.a.instance.ga(fa);Ca.buttons.push(Q);Aa.tc.push(Ca)}jxb(){const Aa=this.tableManager.Kg;return this.S7a||!Aa?new K(!0,!1,!1,!1,!0,!1):new K(z.d(Aa),z.g(Aa),z.c(Aa),z.e(Aa),z.f(Aa),z.b(Aa))}kUf(Aa=!1){const Q={},fa={},Ca=this.jxb();if(!h.a.isEmpty(this.aJ)&&(this.tableManager.Kg&&this.yjg(),!Ca.equals(this.C1c)||
Aa||h.a.isEmpty(this.DUa))){this.ZIa=U.uZh(this.ZIa);Aa=this.aJ;for(var ia in Aa){const Ra=Aa[ia],Ya=U.nyb(Ra,this.ZIa);Q[Ra.Index.toString()]=U.w5a(U.Ita(U.m6b(Ra,Ca)),Ya);fa[Ya]=Q[Ra.Index.toString()];this.zAa(fa)}ia=U.nyb(null,this.ZIa,"-1");Q["-1"]=U.w5a(U.Ita(U.m6b(null,Ca)),ia);fa[ia]=Q["-1"];this.zAa(fa);I.c(this.DUa,Q,!1)}}rui(){const Aa=u.a(this.$);return Aa?Aa.Qn.fA===r.a.rJb:!1}THd(Aa,Q,fa){Number.parseInvariant(fa);"-1"===fa&&H.a.contains(Q.ParentMenuId,"FormatAsTable",!0)||this.kOf(Q,
fa,Aa,!1)}kOf(Aa,Q,fa,Ca){const ia=U.nyb(null,this.ZIa,Q);U.Nnf(Aa)?(ia in this.ina?fa=this.ina[ia]:(fa=U.Ita(U.m6b(this.vkd(Q),fa)),this.ina[ia]=fa),Aa[m.a.GalleryButtonProps]=Object(f.a)(new l.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ia,Alt:Aa[m.a.Alt],MenuItemId:Q,TableCellStyles:fa,TableStyles:this.z7i})):(Aa[w.a.Icon]=ia,Aa[m.a.GalleryButtonProps]=Object(f.a)(new n.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:ia,Alt:Aa[m.a.Alt],MenuItemId:Q}),Ca||(Ca=[],this.vkd(Q),
"-1"===Q||H.a.contains(Aa.ParentMenuId,"FormatAsTable",!0)||(Ca=U.m6b(this.QL.TableStyleItems[Number.parseInvariant(Q)],fa)),this.DUa[Q]=U.w5a(U.Ita(Ca),ia)))}zAa(Aa){if(this.rCb)this.Lxc=()=>{this.zAa(Aa)};else{this.Lxc=null;var Q=[];for(let Ca in Aa){var fa=Ca;fa in this.RJb?Q.push(fa):this.RJb[fa]=!0}try{0<Q.length&&appChrome.api.unregisterIcons(Q),h.a.isEmpty(Aa)||appChrome.api.registerIconProvider(()=>Aa)}catch(Ca){}}}vkd(Aa){Aa=Number.parseInvariant(Aa);if(-1===Aa||!this.QL)return null;if(60<
Aa)for(let Q=60;Q<this.QL.TableStyleItems.length;++Q){const fa=this.QL.TableStyleItems[Q];if(fa.Index===Aa)return fa}return this.QL.TableStyleItems[Aa]}}Object(t.a)(na,"TableStyleManager",x.a,[277,3]);var W=a(55);a.d(E,"a",function(){return X});class X extends c.a{constructor(Aa){super();this.tableStyleManager=null;this.$=Aa;this.Fb()}create(){const Aa=b.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya),Q=b.GetServiceTaskFactory.Na(this.$.da,66,134,this.Ya);e.TaskExtensions.za(W.Task.jJ(Aa,
Q),()=>{this.ob(this.tableStyleManager||(this.tableStyleManager=new na(this.$,Aa.result,Q.result)))},this.$.ka,8)}}Object(t.a)(X,"TableStyleManagerFactory",c.a,[])},1233:function(t,E,a){t=a(0);var c=a(222),b=a(15),e=a(164),f=a(248),d=a(376),h=a(4),m=a(645),l=a(87),w=a(95),n=a(260),x=a(161),r=a(74),u=a(423),v=a(48),B=a(37),z=a(92),A=a(71),y=a(1),D=a(573),I=a(21),M=a(33);class T extends w.a{constructor(aa,U){super(aa);this.vT=[];this.Zde=null;this.uLb=K=>{let Y="forward";K.Values[d.a.direction]?Y=K.Values[d.a.direction].toLowerCase():
b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");K=0;let na=!0;"backward"===Y?(K=this.Ovd.length-1,na=!1):"forward"===Y?(K=0,na=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Y}`);this.qxf(na,K,!1)};this.DFf=()=>{this.vT=[]};this.YPa=K=>{-411645385===this.$.shortcutKeyManager.vs(K,!0)&&this.Lkf()&&(this.$.Ka.Lb(new z.a(-411645385,1,this.$.Hc,6,null),{["event"]:K},K),K.stopPropagation())};this.OUi=K=>{this.Lma(K)};this.jb=U;this.Bq=
I.h(this.jb);this.Gc.la("keydown",this.OUi);this.Gc.la("keyup",this.YPa);n.a(U).UOg(this.DFf);r.a(U.ya,27)&&B.TaskExtensions.za(v.GetServiceTaskFactory.Na(U.da,21,137,1),K=>{K=K.result;K.vo(e.a.Ldf);K.em(e.a.Ldf,this.uLb)},U.ka)}get $(){return this.jb}get Ovd(){this.vT.length||(this.vT=this.p5e());return this.vT}get Pla(){return this.Zde}set Pla(aa){this.Zde=aa;this.vT=this.p5e()}dispose(){this.$&&n.a(this.$).jkj(this.DFf);this.jb=null;this.vT.length=0;super.dispose()}j8i(aa){this.Lma(aa)}qxf(aa,
U,K=!0,Y=null){var na=this.GOj(aa,U,K,Y);if(!na){K=U;var W=aa?1:-1,X=this.Ovd;do{na=!1;if(r.a(this.$.ya,27)){if(K+=W,K>=X.length||0>K)na=!0}else K=(K+W+X.length)%X.length;if(na){this.aEi(aa,U,Y);break}else if(na=this.Idg(aa,U,K,!1,Y))break}while(K!==U)}}GOj(aa,U,K=!0,Y=null){let na=null;0<=U&&(na=this.vT[U]);return(null===na||void 0===na?0:na.Hf)&&na.kg(aa,K)?(Y&&A.g(Y),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${na.he} into a sub region`),na.qj(),!0):!1}Idg(aa,U,K,
Y,na=null){K=this.vT[K];if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const W=n.a(this.jb).oB(f.a.GKa),X=n.a(this.jb).oB(f.a.wyb),Aa=this.Bq.ha.Ta.E_;if(K===X&&Aa||K===W&&!Y&&!Aa)return!1}if((null===K||void 0===K?0:K.Hf)&&K.kg(aa,!1)){na&&A.g(na);K.qj();if(aa=this.vT[U])aa.dk(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${aa.he} to ${K.he}`);return!0}return!1}aEi(aa,U,K=null){K&&A.g(K);if(U=this.vT[U])U.dk(),b.ULS.sendTraceTag(537166666,
0,50,`Lost focus from section ${U.he}`);B.TaskExtensions.za(v.GetServiceTaskFactory.Na(this.$.da,21,137,0),Y=>{Y.result.Sj(e.a.Wnb,{[d.a.direction]:aa?"forward":"backward"})},this.$.ka)}Lma(aa){var U=this.$.isEditMode?x.a(this.$):null;if(!this.$.rb.Hxa||T.wpi(U))if(117===aa.keyCode&&(aa.ctrlKey||A.b(aa))){U=this.i8e(aa.target);var K=!aa.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${U}`);if(y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)){var Y=n.a(this.jb).oB(f.a.zLb);Y=this.vT.indexOf(Y);h.AFrameworkApplication.ta.Pa.Nw&&this.$.O_&&-1!==Y&&U===Y&&m.ShyRibbon.PJ(this.$.nfb,0)}else h.AFrameworkApplication.ta.Pa.Nw&&this.$.O_&&1===U&&m.ShyRibbon.PJ(this.$.nfb,0);this.qxf(K,U,!0,aa)}else 117!==aa.keyCode||T.WXe?-411645385===this.$.shortcutKeyManager.vs(aa)?this.Lkf()&&(this.$.Ka.Lb(new z.a(-411645385,1,this.$.Hc,6,null),{["event"]:aa},aa),aa.stopPropagation()):1588554917===this.$.shortcutKeyManager.vs(aa)?0===this.mode?(D.a(this.$)||
this.$.Ka.Lb(new z.a(1588554917,1,this.$.Hc,6,null),{["event"]:aa},aa),aa.preventDefault(),aa.stopPropagation()):3===this.mode&&(aa.preventDefault(),aa.stopPropagation()):y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.vs(aa)?(U=this.i8e(aa.target),Y=n.a(this.jb).oB(f.a.zLb),K=n.a(this.jb).oB(f.a.GKa),Y=this.vT.indexOf(Y),K=this.vT.indexOf(K),h.AFrameworkApplication.ta.Pa.Nw&&this.$.O_&&-1!==Y&&U===Y&&1===this.$.nfb&&m.ShyRibbon.PJ(1,
0),-1!==K&&U!==K&&this.Idg(!0,U,K,!0,aa)):this.S8h(aa):(aa=u.a.GJ.notificationBar.iaa(l.a.vUh(),!1),M.a.UBb()?aa.image=3:aa.image=0,u.a.GJ.notificationBar.KE(aa),T.WXe=!0)}i8e(aa){const U=this.Ovd;for(let K=0,Y=U.length;K<Y;++K){const na=U[K];if(na&&na.nh(aa))return K}return-1}p5e(){const aa=[];for(let U=0,K=this.Pla.length;U<K;U++){const Y=n.a(this.$).oB(this.Pla[U]);Y&&aa.push(Y)}return aa}Lkf(){return 0===this.mode||4===this.mode}static wpi(aa){return aa?aa.inKeytipMode:!1}}T.WXe=!1;Object(t.a)(T,
"AccessibilityManager",w.a,[898,3]);var S=a(149),H=a(22),C=a(13);class G extends T{constructor(aa){super(document.documentElement,aa);this.pC=0;this.zVg=[f.a.NHe,f.a.kCd,f.a.Wfc,f.a.I_d,f.a.zLb,f.a.h1c,f.a.Xed,f.a.N$e,f.a.p0c,f.a.ECc,f.a.XJj,f.a.wyb,f.a.w2c,f.a.GKa,f.a.JUd,f.a.C2c,f.a.ecg,f.a.trf,f.a.L0c];this.B3j=[f.a.Wfc,f.a.Lmg,f.a.Kmg,f.a.Mmg];this.L7i=[f.a.Wfc,f.a.EPf,f.a.FPf,f.a.HPf];this.v2g=[f.a.O_e,f.a.M$e,f.a.Ved,f.a.Ted];this.q7i=[f.a.NHe,f.a.kCd,f.a.h1c,f.a.Xed,f.a.p0c,f.a.ECc,f.a.wyb,
f.a.w2c,f.a.GKa,f.a.JUd,f.a.ePf,f.a.C2c,f.a.L0c];this.A7i=[f.a.wyb,f.a.T_e];const U=C.a.instance.Ua(253);this.Lxj=this.$.shortcutKeyManager.v5a(U);this.mode=0;aa.da.Ga(15,this);B.TaskExtensions.za(v.GetServiceTaskFactory.Na(aa.da,21,137,1),K=>{K=K.result;K.vo(e.a.Wnb);K.em(e.a.Wnb,this.uLb)},aa.ka)}get mode(){return this.pC}set mode(aa){this.pC=aa;switch(aa){case 0:this.Pla=this.zVg;break;case 2:this.Pla=this.B3j;break;case 3:this.Pla=this.L7i;break;case 4:this.Pla=this.v2g;break;case 5:this.Pla=
this.q7i;break;case 6:this.Pla=this.A7i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}Lma(aa){this.$.qd&65536&&super.Lma(aa)}S8h(aa){if(H.a.equals(this.Lxj,this.$.shortcutKeyManager.Xhd(aa),!1)){const U=S.b(this.$);if(null===U||void 0===U?0:U.Hf)A.g(aa),U.kg(!0,!1)}}}Object(t.a)(G,"EwaAccessibilityManager",T,[]);class J extends c.a{constructor(aa){super();this.$=aa;this.Fb()}create(){this.ob(this.$.da.Aa(15)||new G(this.$))}static la(aa){aa.da.Ga(157,
new J(aa))}}Object(t.a)(J,"AccessibilityManagerFactory",c.a,[]);var L=a(9);a.d(E,"a",function(){return P});const P=()=>{L.a.Fa(J.la)}},1234:function(t,E,a){var c=a(9);t=a(0);var b=a(15),e=a(222),f=a(37),d=a(52),h=a(1),m=a(288),l=a(212);class w{}w.pUe="ewa-svg-icon";Object(t.a)(w,"CssClassNames",null,[]);var n=a(48),x=a(12),r=a(317),u=a(185);class v{constructor(A,y){this.htmlSanitizationHelper=null;this.sg=()=>{this.yrf();this.$.ea.Pn(this.sg)};this.$=A;this.Hdg={};this.jZd={};this.htmlSanitizationHelper=
y;(y=this.Z4e("excelInitialAppSprite"))?(this.ore(y),this.$.ea.Yf?this.yrf():A.ea.Lk(this.sg),this.$.da.Ga(388,this)):b.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.jZd=null;this.$.ea.Pn(this.sg)}ska(A,y,D=null,I=null){let M;(M=this.jZd[A])||(this.jZd[A]=M=this.c3i(this.Hdg[A]));if(!M)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${A} was not found in loaded SVG sprites.`),null;const T=M.cloneNode(!0);if(!T.style){const S=
r.b(M),H=r.b(T),C={};C.iconId=A;C.isOriginalNodeStyleNull=void 0===M.style||null===M.style;C.isOriginalNodeCurrentStyleNull=void 0===M.currentStyle||null===M.currentStyle;C.isClonedNodeCurrentStyleNull=void 0===T.currentStyle||null===T.currentStyle;C.originalNode=S.substring(0,S.indexOf(">")+1);C.clonedNode=H.substring(0,H.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(C)}`)}T.setAttribute("style",`height: ${y}px; width: ${y}px;`);
I&&(A=document.createElement("title"),h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")?this.htmlSanitizationHelper.ni(A,I):A.innerHTML=I,T.insertBefore(A,T.childNodes[0]));if(D)for(const S of D)Sys.UI.DomElement.addCssClass(T,S);return T}Jba(A,y,D,I,M=0,T=0,S=null,H=null){M&&T||(T=x.DOMElementExtensions.getBoundingClientRect(I),M=T.height,T=T.width);if(S=this.ska(A,y,S,H))I.appendChild(S),
(I=x.DOMElementExtensions.c_(S,"style",null))?S.setAttribute("style",I+` margin: ${(M-y)/2}px ${(T-D)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${A}`);return S}yrf(){f.TaskExtensions.za(n.GetServiceTaskFactory.Na(this.$.da,283,284,0),A=>{A=u.c(A.result.kn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.za(A,()=>{const y=this.Z4e("excelUiSlice20Sprite");y?this.ore(y):b.ULS.sendTraceTag(537151259,
0,15,"window[excelUiSlice20Sprite].icons returned null.")},this.$.ka,3)},this.$.da.ka,3)}ore(A){for(const y of A)y.type===l.a.hZd&&(this.Hdg[y.id]=y)}c3i(A){if(!A)return null;const y=A.viewBox;A=A.children;const D=document.createElementNS(m.a.kZd,l.a.hZd);Sys.UI.DomElement.addCssClass(D,w.pUe);D.setAttribute("focusable","false");D.setAttribute("viewBox",y);this.aLg(D,A);return D}aLg(A,y){for(const I of y){const M=document.createElementNS(m.a.kZd,I.type);for(let T in I){y=T;var D=I[T];"className"===
y?M.setAttribute("class",D):M.setAttribute(y,D)}A.appendChild(M)}}Z4e(A){return(A=window[A])?A.icons:null}}Object(t.a)(v,"SvgIconProvider",null,[877,3]);class B extends e.a{constructor(A){super();this.$=A;this.Fb()}create(){var A=[130];if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7128638_SvgIconProviderInnerHtmlCleanup")){A=d.a.YN(A,4,this.Ya,void 0,void 0,void 0,387);const y=n.GetServiceTaskFactory.Na(this.$.da,498,499,
0);f.TaskExtensions.za(f.TaskExtensions.Ed([A,y],this.$.ka),()=>{window.excelInitialAppSprite?this.ob(this.$.da.Aa(388)||new v(this.$,y.result)):b.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}else f.TaskExtensions.za(d.a.YN(A,4,this.Ya,void 0,void 0,void 0,387),()=>{window.excelInitialAppSprite?this.ob(this.$.da.Aa(388)||new v(this.$,null)):b.ULS.sendTraceTag(509694111,0,50,"window.[excelInitialAppSprite] returned null.")},this.ka,3)}static la(A){A.da.Ga(387,
new B(A))}}Object(t.a)(B,"SvgIconProviderFactory",e.a,[]);a.d(E,"a",function(){return z});const z=()=>{c.a.Fa(B.la)}},1259:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(21),f=a(480);class d extends f.a{constructor(l,w){super(l);w.Ga(240,this)}v3h(l){for(const w of this.rangeList)if(l.range.contains(w))return w;return null}tKd(l){return l.GridBlockModel&&(l=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(l.GridBlockModel))?l.getSparklineRanges():null}}Object(t.a)(d,"SparklineManager",
f.a,[882]);class h extends b.a{constructor(l){super();this.sparklineManager=null;this.$=l;this.Fb()}create(){this.ob(this.sparklineManager||(this.sparklineManager=new d(e.h(this.$),this.$.da)))}static la(l){l.da.Ga(239,new h(l))}}Object(t.a)(h,"SparklineManagerFactory",b.a,[]);a.d(E,"a",function(){return m});const m=()=>{c.a.Fa(h.la)}},1281:function(t,E,a){t=a(0);var c=a(144),b=a(601);class e extends b.a{constructor(){super()}dispose(){c.WacAirSpace.jqd()&&c.WacAirSpace.lDc()}animate(h,m,l,w,n){m&&
c.WacAirSpace.IL(h.element,m);c.WacAirSpace.animate(h,w,n);l&&c.WacAirSpace.ogj(h.element,l)}}Object(t.a)(e,"AnimationManager",b.a,[3]);var f=a(101);a.d(E,"a",function(){return d});const d=()=>{f.a.Ul.Ga(141,new e)}},1456:function(t,E,a){a.r(E);t=a(1202);E=a(1166);var c=a(1124),b=a(1125),e=a(1126),f=a(1128);a(1127);var d=a(1233),h=a(1281),m=a(9),l=a(0),w=a(222),n=a(187),x=a(553),r=a(15),u=a(815),v=a(520),B=a(82),z=a(4),A=a(78),y=a(909);class D extends A.a{constructor(C){super();this.Lwd=null;this.$=
C;r.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}$oj(){const C=new n.a,G=v.a.xq(B.a.instance.Rb("Common.IEventEmitter<Common.IMruResult>")),J=new x.a(()=>G.result);this.Lwd=new x.a(()=>new u.a(J.value,null));if(!this.Lwd)return C;var L=this.Lwd.value.m_("NewAndOpenCoreManager",!1);if(!L||3!==L.state||!L.SAd)return L?r.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${L.state}, mruResult MruDocuments is null: ${!L.SAd}`):r.ULS.sendTraceTag(544289227,
0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;L=L.SAd;const P=["xlsx","xlsb","xlsm"];for(let U=0;U<L.length;U++){var aa=L[U];if(0>Array.indexOf(P,aa.extension))continue;const K=`${aa.title}.${aa.extension}`,Y=y.b(aa,z.AFrameworkApplication.isRtl);aa=aa.url;K&&Y&&aa?C.add({[D.fileName]:K,[D.friendlyPath]:Y,[D.section]:"mru",[D.absoluteUrl]:aa}):aa||r.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return C}dispose(){super.dispose()}}
D.fileName="FileName";D.friendlyPath="FriendlyPath";D.section="Section";D.absoluteUrl="AbsoluteUrl";Object(l.a)(D,"NewAndOpenCoreManager",A.a,[883,3]);class I extends w.a{constructor(C){super();this.$=C;this.Fb()}create(){this.ob(this.$.da.Aa(451)||this.$.da.Ga(451,new D(this.$)))}static la(C){C.da.Ga(164,new I(C))}}Object(l.a)(I,"NewAndOpenCoreFactory",w.a,[]);l=a(1157);w=a(1259);A=a(1234);var M=a(1203),T=a(1160),S=a(1150),H=a(1170);a=a(1142);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(t.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(E.a)();Object(c.a)();Object(b.a)();Object(e.a)();Object(d.a)();m.a.Fa(I.la);Object(h.a)();Object(l.a)();Object(w.a)();Object(A.a)();Object(f.a)();Object(M.a)();Object(T.a)();Object(S.a)();
Type.registerNamespace("Common.App.SessionExpiration");Object(H.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/04bb4213fd06aee83fc0a50c7ad2ebf2/EwaDSEsNext.acc.js.map