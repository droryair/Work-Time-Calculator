'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1237:function(t,E,a){t=a(0);var c=a(7),b=a(15),e=a(27),f=a(89),d=a(14),h=a(83),m=a(419),l=a(78),w=a(8),n=a(65),x=a(462);class r{constructor(W,X){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=X;this.parentElement=W}Mbh(){const W=this.Nbh();x.a(this.$,243,242,0,X=>{this.cardViewManager=X;X.W9f(this.parentElement,2,W)})}Zcf(){this.cardViewManager&&
this.cardViewManager.zMa(-1,-1,this.parentElement)}Nbh(){const W={layoutId:"AutoDetectTooltip"};W.description=this.longDescription;W.convertToDomainName=this.convertToDomainName;W.longDescription=this.longDescription;W.urlValue=this.urlValue;W.imageAltText=this.imageAltText;W.helpText=this.helpText;W.helpId=this.helpId;return W}}Object(t.a)(r,"AutoDetectCardManager",null,[]);var u=a(31),v=a(209),B=a(30),z=a(224),A=a(19),y=a(52),D=a(1);class I extends l.a{constructor(W,X,Aa){super();this.fd=Q=>{if(Q.Gb.id===
this.Aua.firstChild.id){Q=this.aye;const fa={};fa.Id=Q.rqb;this.convertToLinkedEntityManager.T5c(fa,!0,Q);this.Aua.removeChild(this.Aua.firstChild);return!0}return!1};this.aye=W;this.convertToLinkedEntityManager=X;this.Aua=document.createElement("div");this.Aua.className="clip16x16";this.Xka=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',B.a.rg("autodetectid"+this.aye.left),A.a.Zbd,y.a.de(11));D.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
D.EwaSettings.isChangeGateEnabled("OfficeVSO:7188168_ReduceInnerHTMLUsageForAutoDetectColumnHeaderButton")?Aa.ni(this.Aua,this.Xka):this.Aua.innerHTML=this.Xka;W=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");z.a.instance.sa(d.a.click,W,this.fd)}get domElement(){return this.Aua}dispose(){if(this.Aua){const W=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");z.a.instance.Ba(d.a.click,W,this.fd)}super.dispose()}static get j_g(){return"clip16x16"}}Object(t.a)(I,
"AutoDetectColumnHeaderButton",l.a,[]);var M=a(1090),T=a(11),S=a(21),H=a(177);class C extends l.a{constructor(W,X,Aa){super();this.htmlSanitizationHelper=null;this.$=W;this.gridView=S.h(W);this.convertToLinkedEntityManager=X;this.htmlSanitizationHelper=Aa;this.D4c=new H.a}dispose(){super.dispose()}$nh(W){for(let X of this.gridView.tia)for(let Aa of X){const Q=Aa,fa=Q.Mt,Ca=M.a(Q.f5);this.EIg(W,Ca,fa);Q.YSd(Ca)}}EIg(W,X,Aa){if(X.length){var Q=Aa.length;Aa[Q-1]<W.left||(Aa=T.HelperMethods.ow(new v.a(Aa),
0,Q,W.left,T.HelperMethods.GB),0>Aa||!(X=X[Aa]))||(this.gridView.rtl?X.classList.add(u.a.oBh):X.classList.add(u.a.nBh),this.D4c.kb(W.left)||this.D4c.add(W.left,new I(W,this.convertToLinkedEntityManager,this.htmlSanitizationHelper)),W=this.D4c.ma(W.left).domElement,!X.getElementsByClassName(I.j_g).length&&this.hLj(X)&&X.appendChild(W))}}hLj(W){const X=parseInt(W.style.width,10);var Aa=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";Aa=C.wdh(Aa);W=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.htmlSanitizationHelper.k2h(W.firstChild.innerHTML),
Aa,!0,D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<X-(X/2+W/2)?!0:!1}static wdh(W){return`${"normal"} ${"normal"} ${W} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(t.a)(C,"AutoDetectColumnHeaderManager",l.a,[]);var G=a(428),J=a(24),L=a(66),P=a(138),aa=a(12),U=a(13),K=a(145),Y=a(72);a.d(E,"a",function(){return na});class na extends l.a{constructor(W,X,Aa,Q,fa){super();this.isMac=e.a.isMac;this.GZa=-1;
this.r7b=null;this.Vta=-1;this.XN=this.slc=this.NWd=this.Y_=this.bye=!1;this.iU=null;this.Cg=()=>{this.hxa&&this.gridView&&this.AX()};this.xc=()=>{this.ty()};this.fd=()=>{this.JIa();S.h(this.$).kg(!0,!1)};this.qza=(ia,Ra)=>{Ra?(this.cjg(this.r7b),this.lfb()):(ia=[29],this.gridView.qb.Zg(ia),this.gridView.qb.Ri(null,ia),this.iU&&this.iU.Zcf())};this.Kj=()=>{this.j8a()&&this.Fh.hide();1===this.gridView.ha.Ne&&this.AX()};this.MR=()=>{const ia=this.gridView.ha.Ne;this.gridView.ha.ra.activeCell&&1===ia&&
this.AX()};this.onKeyUp=ia=>this.DDb?this.Y_?!1:17===ia.Ca.keyCode&&this.NWd?(this.XN?(this.lfb(),this.dea()):this.iNb(),!0):!1:this.Y_=!1;this.onKeyDown=ia=>{if(!this.DDb)return this.Y_=!1;this.NWd=!1;this.Y_=ia.ctrlKey;switch(ia.Ca.keyCode){case 27:return this.XN?(this.qza(null,!1),this.dea()):this.iU&&(this.iU.Zcf(),this.iNb()),!0;case 13:if(this.XN)return this.XN=!1,this.JIa(),!0;break;case 17:return this.NWd=!0}return!1};const {AutoDetectActionButton:Ca}=a(1347);this.$=W;this.sqb=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",
!1);X||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=Q;Q.zIb();this.Fh=new Ca(W,X,this.fd,Aa,"");this.OUg=new C(this.$,Q,fa);this.gridView=S.h(this.$);this.gridView.ha.bU(this.Cg);this.gridView.Vb.XZa(this.Cg);this.gridView.pv(this.MR);W.xj(this.xc);W.DC(this.Kj);this.gridBlockManager=Object(h.a)(359,this.gridView.Da);this.Ko=W.frame.$t;this.AX()}get mc(){return this.Fh.domElement(1)}get DDb(){const W=this.Fh.domElement(na.ifa);
return W?aa.DOMElementExtensions.isVisible(W):!1}get hxa(){return this.$.isEditMode&&D.EwaSettings.oa(133)&&D.EwaSettings.oa(136)&&(new P.a(this.$.va)).li?!1:-1!==this.Vta}dispose(){this.gridView&&this.gridView.ha.iS(this.Cg);if(this.$){const W=this.$;W.tl(this.xc);W.jG(this.Kj);S.h(W).Ny(this.MR)}f.a.Ia(this.Fh);this.Ko=this.$=this.gridView=this.Fh=null;super.dispose()}ty(){this.qza(null,!1);this.GZa=-1;this.Fh.hide();this.oWj();this.XN=!1}dea(){this.Fh.getButton(na.ifa).udb();this.XN=!1}iNb(){this.Fh.getButton(na.ifa).uIb();
this.cjg(this.r7b);this.XN=!0;this.$.da.fb(211,W=>{W.gRa(U.a.instance.ga(1742))})}onAutoDetectUIShown(){if(this.hxa&&-1!==this.GZa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}PUg(W){var X=new J.Range(1===W.top?1:W.top-1,W.left,W.bottom,W.right,!0,!1);X=this.gridView.getRangeInformation(X);for(const Aa of X)if(Object(m.a)(G.AutoDetectRange,Aa)&&this.dic(W,!1,Aa))return!0;return!1}JIa(){if(this.hxa&&-1!==this.GZa){this.Fh.getButton(na.ifa).uIb();var W={};W.Id=this.Vta;W.StringId=null;this.convertToLinkedEntityManager.T5c(W,
!0,this.r7b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");W=[Object(c.a)(new Y.a,{name:"Domain",int64:this.Vta})];K.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,W);this.Vta=-1}}YPh(){let W=U.a.instance.ga(1738);if(-1!==this.Vta){W+=" ";try{W+=this.convertToLinkedEntityManager.ZCb(this.Vta.toString())}catch(X){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Vta}`)}}W+=
" ";return W=this.sqb?W+U.a.instance.ga(1741):W+U.a.instance.ga(this.isMac?1740:1739)}lfb(){this.sqb&&(this.iU||(this.iU=new r(this.mc,this.$),this.iU.convertToDomainName=U.a.instance.ga(1743),this.iU.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.iU.imageAltText=U.a.instance.ga(1745),this.iU.helpId="HID_DataTypes_Wolfram",this.iU.helpText=U.a.instance.ga(1744)),this.iU.longDescription=this.convertToLinkedEntityManager.O_d(this.GZa.toString()),
this.iU.Mbh())}dic(W,X,Aa){if((new J.Range(Aa.top,Aa.left,Aa.bottom===w.a.gh?Aa.bottom:Aa.bottom+1,Aa.right,!0,!1)).Fd(W)){if(X){if(Aa&&Aa.rqb!==this.GZa){this.GZa=Aa.rqb;W=Aa.rqb.toString();X=this.sqb?"":this.convertToLinkedEntityManager.O_d(W);const Q=this.convertToLinkedEntityManager.hdi(W);this.Fh.ihb(this.convertToLinkedEntityManager.ZCb(W),X,Q,na.ifa)}this.Vta=Aa.rqb;this.r7b=Aa}return!0}return!1}AX(){if(this.convertToLinkedEntityManager){var W=this.gridView.ha.Ne;if(this.gridBlockManager&&
this.gridBlockManager.omd){var X=this.gridView.ha.ra.activeCell,Aa=!this.gridBlockManager.rs(X),Q=this.gridView.getRangeInformation(this.gridView.ui);for(const fa of Q)if(Object(m.a)(G.AutoDetectRange,fa))switch(Q=fa,Q.u4g){case 3:if(this.dic(X,!0,Q)){if(1!==W||Aa){this.ty();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.YLd();this.Fh.DBa(X,this.qza);this.bye||(this.bye=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",
!1)||D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.OUg.$nh(Q);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.ty()}}cjg(W){const X=[29];this.gridView.qb.Ri(W,X);this.gridView.qb.Tn(X)}j8a(){return this.$.ea.isNamedObjectViewMode&&L.f(this.$.na)}YLd(){this.sqb&&!this.slc&&this.Ko&&(this.Ko.Rs(d.a.Pb,this.$.domElement,this.onKeyDown,!0),this.Ko.Rs(d.a.Gd,
this.$.domElement,this.onKeyUp,!0),this.slc=!0)}oWj(){this.sqb&&this.slc&&this.Ko&&(this.Ko.Ys(d.a.Pb,this.$.domElement,this.onKeyDown,!0),this.Ko.Ys(d.a.Gd,this.$.domElement,this.onKeyUp,!0),this.slc=!1)}static get ifa(){return 1}static fSh(W){return U.a.instance.ga(1799)+n.a.space+W}}Object(t.a)(na,"AutoDetectManager",l.a,[])},1347:function(t,E,a){a.r(E);a.d(E,"AutoDetectActionButton",function(){return d});t=a(0);E=a(78);var c=a(1237),b=a(52),e=a(13),f=a(21);class d extends E.a{constructor(h,m,
l,w,n){super();this.$=h;this.zo=w.Y6b(h,m,l,"",b.a.de(11),n,"AutoDetectPointerDown",e.a.instance.ga(1799)+"...")}get Cz(){return this.zo.Cz}dispose(){this.zo.dispose();this.$=null;super.dispose()}domElement(h){return this.zo.domElement(h)}getButton(h){return this.zo.getButton(h,!1)}ihb(h,m,l,w){this.zo.qVa(c.a.fSh(h),m,w);this.zo.Yjg(l,m,w)}DBa(h,m){const l=f.h(this.$),w=l.ib.Mi(h);h=l.fg(h,w);const n=l.Df(w).$m;if(h&&0<=h.x&&0<=h.y&&n.width>h.width+160){let x=h.bottomRight.x+this.Cz,r=h.topLeft.y+
this.Cz,u=!1;x+160>n.bottomRight.x&&(x=h.topLeft.x-this.Cz,u=!0);if(r<n.topLeft.y+this.Cz){if(l.ib.nCa){this.hide();return}r=n.topLeft.y+this.Cz}this.zo.$9b(m,w);this.Tp(x,r,l.rtl,w,u)}else this.hide()}Tp(h,m,l,w,n){this.zo.Tp(h,m,l,w,!1,n)}hide(){this.zo.hide()}}Object(t.a)(d,"AutoDetectActionButton",E.a,[])},1455:function(t,E,a){a.r(E);t=a(0);var c=a(695),b=a(15),e=a(5),f=a(76),d=a(37),h=a(1),m=a(184),l=a(21),w=a(145);class n{constructor(P,aa){this.$=aa;this.convertToLinkedEntityManager=P}nc(P,
aa){switch(aa){case -1203788282:case 48568533:case -1662108744:return P=l.h(this.$),aa=this.convertToLinkedEntityManager.XGi||7E3,(null===P||void 0===P?0:P.ha)&&P.ha.ra.ed.TC>aa?!0:!1;default:return!1}}executeCommand(P,aa,U){P=d.TaskExtensions.Vj();aa=aa.command;switch(aa){case -1203788282:this.convertToLinkedEntityManager.eah(U[f.a.Kc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();
break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(U[f.a.Kc].toString());break;case 1266950951:this.convertToLinkedEntityManager.Zxi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:h.EwaSettings.oa(611)&&this.convertToLinkedEntityManager.BQe();break;case 1702917262:h.EwaSettings.oa(611)&&this.convertToLinkedEntityManager.showHelpArticle(e.a.HXj);
break;case -90814711:h.EwaSettings.oa(611)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===aa||U[f.a.Vqf]&&"ConvertToLinkedEntityGallery"===U[f.a.Vqf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),w.a("ExpandDataTypeGallery");break;default:P=m.a(aa)}return P}yc(P,aa){switch(aa.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return h.EwaSettings.oa(128);
case -1081442996:case 1702917262:case -90814711:return h.EwaSettings.oa(611);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Lc(P,aa,U){return"PopulateConvertToLinkedEntityMenu"===aa&&h.EwaSettings.oa(128)?this.convertToLinkedEntityManager.Lc(P,aa,U):!1}}Object(t.a)(n,"ConvertToLinkedEntityCommandHandler",null,[219]);var x=a(462);class r extends c.a{constructor(P){super(P)}ld(){x.a(this.$,271,272,this.Ya,P=>{this.Zc([new n(P,this.$)])})}static la(P){c.a.Nd(273,
new r(P))}}Object(t.a)(r,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);var u=a(55);E=a(222);var v=a(761),B=a(48),z=a(420),A=a(698);class y extends E.a{constructor(P){super();this.$=P;this.Fb()}create(){const P=B.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Ya),aa=B.GetServiceTaskFactory.Na(this.$.da,5,4,this.Ya),U=B.GetServiceTaskFactory.Na(this.$.da,388,387,this.Ya),K=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7126083_ReduceInnerHTMLUsageForEnrichmentTaskPaneWrapper")?
B.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):u.Task.Ra(null),Y=B.GetServiceTaskFactory.Na(this.$.da,257,258,this.Ya),na=z.a(this.$);d.TaskExtensions.za(d.TaskExtensions.Ed([P,Y,na,aa,U,K],this.ka),()=>{this.ob(Object(A.a)(this.$.da,271,()=>new v.ConvertToLinkedEntityManager(this.$,P.result,U.result,Y.result,na.result,aa.result,K.result)))},this.$.ka,3)}static la(P){P.da.Ga(272,new y(P))}}Object(t.a)(y,"ConvertToLinkedEntityManagerFactory",E.a,[]);var D=a(238),I=a(260),M=a(33),T=a(248),S=
a(12),H=a(704);const C=a(19).a.WAh;class G extends D.a{constructor(P,aa,U){super(P);this.yq=0;this.Vp=!1;this.xc=()=>{this.wg(!1)};this.$=aa;this.taskPaneManager=U;I.a(aa).di(this);this.$.xj(this.xc);M.a.gd(this.$)&&(this.isVisible=!1)}WP(P){this.get_events().addHandler("EnrichmentTaskPaneRemoved",P)}hS(P){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",P)}RE(P){this.addHandler("EnrichmentTaskPaneVilibilityChanged",P)}lG(P){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",P)}bOg(P){this.addHandler("EnrichmentTaskPaneOnFocus",
P)}yjj(P){this.removeHandler("EnrichmentTaskPaneOnFocus",P)}get isVisible(){return super.isVisible}set isVisible(P){super.isVisible=P;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Hf(){return this.isVisible}get he(){return T.a.Osh}get kh(){return 10}get Ek(){return C}get FN(){return this.titleText}get titleText(){return"Enrichment"}get Lp(){return 300}get isResizable(){return!1}get mc(){return this.domElement}get height(){return this.taskPaneManager.iP.offsetHeight}get $B(){return this.taskPaneManager.Eva(this.mc,
this.titleText,this.Lp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Lp)}pq(){return this.Vp}Fs(){return this.Vp}VR(){}dispose(){this.$&&this.$.tl(this.xc);this.taskPaneManager=this.$=null;super.dispose()}kg(P,aa){aa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!aa}nh(P){return S.DOMElementExtensions.Af(this.mc,P)}qj(){}dk(){}wg(P){this.Vp=P;const aa=this.taskPaneManager;this.isVisible=P;M.a.gd(this.$)?P?this.taskPaneManager.a7("EnrichmentTaskPane",
this.$B):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(P&&0<aa.ZB.length&&(!aa.ph||10!==aa.ph.taskPane.kh||aa.isCollapsed)&&aa.oG(this,!0),aa.nA());P||(l.h(this.$).kg(!0,!1),this.$.af())}bR(){return!1}static la(P,aa){var U=P.Eb;let K=document.getElementById(U+e.a.YQe);K||(K=H.a("div",P.Eb+e.a.YQe,"cui-taskpane"),M.a.gd(P)||(U=document.getElementById(U+e.a.IR),void 0!==U&&null!==U?U.appendChild(K):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${P.zD}`)));
U=P.da;return U.Aa(257)||U.Ga(257,new G(K,P,aa))}}Object(t.a)(G,"EnrichmentTaskPane",D.a,[293,3,280,66]);class J extends E.a{constructor(P){super();this.ih=this.yi=null;this.$=P;this.Fb()}get QD(){this.yi||(this.yi=d.TaskExtensions.za(z.a(this.$),P=>{this.ih=G.la(this.$,P.result)},this.ka,3));return this.yi}create(){const P=B.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Ya),aa=B.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya);d.TaskExtensions.za(d.TaskExtensions.ts(d.TaskExtensions.Ed([P,
aa],this.ka),()=>this.QD,this.ka),()=>{this.ob(this.ih)},this.ka,3)}dispose(){this.ih=this.yi=this.$=null;super.dispose()}static la(P){P.da.Ga(258,new J(P))}}Object(t.a)(J,"EnrichmentTaskPaneFactory",E.a,[]);var L=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{L.a.Fa(P=>{J.la(P);y.la(P);r.la(P)})})()},761:function(t,E,a){a.r(E);var c=a(0),b=a(15),e=a(89),f=a(264),d=a(4),h=a(30),m=a(819),l=a(134),w=a(82),n=a(38),x=a(19),r=a(5),u=a(161),v=a(1237),B=a(1240),
z=a(171),A=a(557),y=a(349),D=a(60);const I=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"GetRichDataClassificationLabels",Nb,bb,Ob,gc,mb,4)},M=(sb,bb,Ob,gc,mb,Nb,ic,gb,Eb=null)=>{Eb=sb.Oa(1,Eb);Eb.selectedRanges=bb;Eb.domainId=Ob;Eb.autodetect=gc;return D.g(sb,"ConvertToLinkedEntity",Eb,mb,Nb,ic,gb,4)},T=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"OnAutoDetectUIShown",Nb,bb,Ob,gc,mb,4)},S=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"GetLinkedEntityMetadata",Nb,
bb,Ob,gc,mb,4)},H=(sb,bb,Ob,gc,mb,Nb,ic=null)=>{ic=sb.Oa(1,ic);ic.selectedRanges=bb;return D.g(sb,"ConvertLinkedEntityToText",ic,Ob,gc,mb,Nb,4)},C=(sb,bb,Ob,gc,mb,Nb,ic=null)=>{ic=sb.Oa(1,ic);ic.selectedRanges=bb;return D.g(sb,"RefreshLinkedEntitiesInRange",ic,Ob,gc,mb,Nb,4)},G=(sb,bb,Ob,gc,mb,Nb,ic,gb,Eb,Lc,Ec=null)=>{Ec=sb.Oa(1,Ec);Ec.selectedRanges=bb;Ec.isChangeObject=Ob;Ec.isFloodgateEnabled=gc;Ec.isStarterData=mb;Ec.starterDataDomainId=Nb;return D.g(sb,"GetDataSelectorPaneData",Ec,ic,gb,Eb,
Lc,4)},J=(sb,bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=sb.Oa(9,gb);gb.activeCell=bb;gb.selectionIndex=Ob;return D.g(sb,"SelectLinkedEntityForDisambiguation",gb,gc,mb,Nb,ic,4)},L=(sb,bb,Ob,gc,mb,Nb,ic,gb,Eb,Lc,Ec,Cb=null)=>{Cb=sb.Oa(1,Cb);Cb.searchCell=bb;Cb.searchQuery=Ob;Cb.isFloodgateEnabled=gc;Cb.isStarterData=mb;Cb.starterDataDomainId=Nb;Cb.starterDataDomainIdString=ic;return D.g(sb,"LinkedEntitySearch",Cb,gb,Eb,Lc,Ec,4)},P=(sb,bb,Ob,gc,mb,Nb,ic,gb,Eb=null)=>{Eb=sb.Oa(1,Eb);Eb.cell=bb;Eb.starterDataDomainId=
Ob;Eb.starterDataDomainIdString=gc;return D.g(sb,"InsertStarterDataTable",Eb,mb,Nb,ic,gb,4)},aa=(sb,bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=sb.Oa(1,gb);gb.activeCell=bb;gb.isBackward=Ob;return D.g(sb,"MoveToNextAmbiguousLinkedEntity",gb,gc,mb,Nb,ic,4)},U=(sb,bb,Ob,gc,mb,Nb,ic=null)=>{ic=sb.Oa(9,ic);ic.activeCell=bb;return D.g(sb,"CancelSearchLinkedEntity",ic,Ob,gc,mb,Nb,4)},K=(sb,bb,Ob,gc,mb,Nb,ic,gb=null)=>{gb=sb.Oa(1,gb);gb.selectedRanges=bb;gb.letyDomainId=Ob;return D.g(sb,"GetDataTypeSelectorData",gb,
gc,mb,Nb,ic,4)},Y=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"GetErrorMessageForLinkedDataTypeRefresh",Nb,bb,Ob,gc,mb,4)},na=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"GetHasUntrustedImageUrls",Nb,bb,Ob,gc,mb,4)},W=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"LinkedEntitiesEnableUntrustedImages",Nb,bb,Ob,gc,mb,0)},X=(sb,bb,Ob,gc,mb,Nb=null)=>{Nb=sb.Oa(1,Nb);return D.g(sb,"LinkedEntityTryAutoRefresh",Nb,bb,Ob,gc,mb,0)};var Aa=a(84),Q=a(704),fa=a(791);class Ca{}
Ca.bdi="EnrichmentContentFrame";Ca.width=320;Object(c.a)(Ca,"EnrichmentConstants",null,[]);class ia{constructor(sb){this.messageType=0;this.messageType=sb}}Object(c.a)(ia,"EnrichmentResponseMessage",null,[]);class Ra extends ia{constructor(sb,bb){super(sb);this.messageContent=null;this.messageContent=bb}}Object(c.a)(Ra,"EnrichmentResponseMessageWithContent",ia,[]);class Ya extends Ra{constructor(sb,bb,Ob){super(sb,bb);this.telemetryJson=null;this.telemetryJson=Ob}}Object(c.a)(Ya,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ra,[]);var Ga=a(261),da=a(14),Z=a(96),ha=a(45),Wa=a(85),ca=a(108),ja=a(41),ua=a(80),Za=a(27),Pa=a(106),ka=a(696),ra=a(25);class ba{constructor(sb,bb,Ob,gc,mb){this.kr=this.wk=this.Tbe=this.Rbe=this.fw=this.hv=null;this.yx=!1;this.Gi=sb;this.Yd=bb;this.JP=Ob;this.Yb=gc;this.La=mb;this.yqa=ca.KeyInputManager.Hl(Wa.a.spa,0)}get NNb(){return!0}get Yub(){return d.AFrameworkApplication.fa.Xa("EnrichmentPaneUrl")}dispose(){this.NNb&&this.kr&&(this.Gi.Ba(da.a.click,this.kr,Object(Aa.a)(this,this.rk,"onClosePaneClick")),
this.Yd.Ba(da.a.Gd,this.kr,Object(Aa.a)(this,this.CFf,"onKeyHide")));this.kr=null;this.fw&&(this.VWj(),this.fw.parentNode.removeChild(this.fw),this.fw=null);this.Yb.Ci("EnrichmentPaneId").Hk(this.yqa)}show(sb,bb,Ob){this.hv=sb;this.yx||(this.wk=this.e2a(),this.Lna.appendChild(this.wk),this.Kej(),this.La.Nb(ra.a.NEe,Pa.a.frame,Object(Aa.a)(this,this.J8h,"handleEscapeKeyAction")),this.qTa(),this.yx=!0);this.fw.src=this.Yub&&this.Yub.length?this.Yub+"?culture="+bb.market+"&appName="+bb.applicationName+
"&themeId="+bb.themeId+"&featuresBitMask="+bb.featuresBitMask:ba.izf;this.Rbe=bb;this.Tbe=Ob;this.ffb()}OEc(sb,bb){sb=new Ya(2,sb,bb);this.ftc(sb)}qTa(){const sb=this.Yb.Ci("EnrichmentPaneId");sb.parent=Ga.AFrame.iPa;this.Gi.Dob("EnrichmentPaneId",this.wk);sb.bindAction(this.yqa,ra.a.NEe)}m5f(){if(this.fw){Z.FocusManager.epa(this.fw.contentWindow);const sb=new Ya(4,null,null);this.ftc(sb)}}rk(){this.f5b();return!0}CFf(sb){sb=sb.Ca.keyCode;return sb===Sys.UI.Key.enter||sb===Sys.UI.Key.space?(this.f5b(),
!0):!1}f5b(){this.hide();if(this.hv)this.hv.onPaneClosed()}e2a(){const sb=Q.a("div","EnrichmentPaneId","EnrichmentPane");this.NNb&&sb.appendChild(this.W6c());this.Ngi(sb);return sb}W6c(){const sb=Q.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),bb=Q.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");bb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;bb.title=CommonUIStrings.l_EnrichmentPaneTitle;const Ob=fa.a.pb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.Gi.sa(da.a.click,Ob,Object(Aa.a)(this,this.rk,"onClosePaneClick"));this.Yd.sa(da.a.Gd,Ob,Object(Aa.a)(this,this.CFf,"onKeyHide"));sb.appendChild(bb);sb.appendChild(Ob);this.kr=Ob;return sb}Ngi(sb){this.fw=Q.b("iframe","","EnrichmentFrame");sb.appendChild(this.fw);this.fw.id=Ca.bdi;this.fw.setAttribute("role","presentation")}Kej(){ha.a.addHandler(this.fw,"load",Object(Aa.a)(this,this.fFf,"onIFrameLoad"));ha.a.addHandler(this.fw,"error",Object(Aa.a)(this,this.mqc,
"onIFrameError"));$addHandler(window,"message",Object(Aa.a)(this,this.gFf,"onIFrameMessage"))}VWj(){ha.a.removeHandler(this.fw,"load",Object(Aa.a)(this,this.fFf,"onIFrameLoad"));ha.a.removeHandler(this.fw,"error",Object(Aa.a)(this,this.mqc,"onIFrameError"));$removeHandler(window,"message",Object(Aa.a)(this,this.gFf,"onIFrameMessage"))}Ujh(){this.fw.src=ba.izf}hide(){this.igc();this.Ujh()}J8h(sb,bb,Ob){if(1!==Ob&&(this.hide(),this.hv))this.hv.onPaneClosed();return 32}fFf(){}mqc(){}gFf(sb){sb=sb.rawEvent;
if(!this.fw||-1!==this.fw.src.indexOf(sb.origin)){try{var bb=ja.a(sb.data)}catch(Ob){return}if(!ka.c(bb.messageType)){sb=window.g_badCastCallback;window.g_badCastCallback=null;switch(bb.messageType){case 2:this.ftc(new Ya(1,ja.c(this.Rbe),this.Tbe));break;case 1:this.ftc(new Ra(0,this.xOh()));break;case 3:this.hv&&this.hv.selectEntity(bb.messageContent);break;case 5:this.hv&&this.hv.fFb(bb.messageContent);break;case 8:this.hv&&(bb=ja.a(bb.messageContent),0<bb.DomainId?this.hv.eRd(bb.Query,bb.TelemetryJson,
bb.DomainId,bb.DomainIdString):this.hv.searchEntity(bb.Query,bb.TelemetryJson));break;case 6:this.hv&&this.hv.cancelSearch();break;case 11:bb=ja.a(bb.messageContent);bb=ba.U6b("keydown","f6",Wa.a.wSb,!0,!1,bb,!0,!1);this.fw&&this.fw.dispatchEvent(bb);break;case 12:if(ja.a(bb.messageContent).keyCode===Wa.a.JG&&(bb=ba.U6b("keydown","esc",Wa.a.JG,!0,!1,!1,!1,!1),this.fw&&(this.fw.dispatchEvent(bb),this.hide(),this.hv)))this.hv.onPaneClosed();break;case 13:this.hv&&this.hv.selectDataType(bb.messageContent);
break;case 14:this.hv&&this.hv.showHelpArticle(bb.messageContent);break;case 15:this.hv&&this.hv.showSurveyDialog(bb.messageContent);break;case 16:this.hv&&(bb=ja.a(bb.messageContent),this.hv.insertTable(bb.DomainId,bb.DomainIdString))}window.g_badCastCallback=sb}}}xOh(){return ja.c([2,1,3,5,8,6])}ftc(sb){sb=ja.c(sb);this.fw.contentWindow.postMessage(sb,ua.a.nba(this.Yub))}static U6b(sb,bb,Ob,gc,mb,Nb,ic,gb){Za.a.Lw?(Nb=String.format("{0} {1} {2}",Nb?"Shift":"",ic?"Control":"",gb?"Alt":""),Nb.trim(),
Ob=document.createEvent("KeyboardEvent"),Ob.initKeyboardEvent(sb,gc,mb,window.self,bb,0,Nb,!1,"en-US")):(bb={},bb.keyCode=Ob,bb.ctrlKey=ic,bb.shiftKey=Nb,bb.altKey=gb,bb.bubbles=gc,bb.cancelable=mb,Ob=new KeyboardEvent(sb,bb));return Ob}}ba.izf="about:blank";Object(c.a)(ba,"EnrichmentPane",null,[395,3]);class Ua extends ba{constructor(sb){super(d.AFrameworkApplication.ta.Wy,d.AFrameworkApplication.ta.$t,d.AFrameworkApplication.ta.Pea,d.AFrameworkApplication.ta.Le,d.AFrameworkApplication.ub);this.taskPane=
sb;this.taskPane.bOg(this.m5f)}get Lna(){return this.taskPane.mc}ffb(){this.taskPane.isVisible||this.taskPane.wg(!0)}igc(){this.taskPane.wg(!1)}dispose(){this.taskPane&&(this.taskPane.yjj(this.m5f),this.taskPane=null);super.dispose()}}Object(c.a)(Ua,"EnrichmentTaskPaneWrapper",ba,[]);class Ka{constructor(sb){this.fz=null;this.Sfa=sb}byi(sb,bb){this.fz=sb;this.Sfa&&this.Sfa.show(this,bb,null)}OEc(sb,bb){this.Sfa&&this.Sfa.OEc(sb,bb)}tzb(){this.Sfa&&this.Sfa.hide()}dispose(){this.Sfa&&(this.Sfa.dispose(),
this.Sfa=null)}selectEntity(sb){return this.fz?this.fz.selectEntity(sb):!1}searchEntity(sb,bb){this.fz&&this.fz.searchEntity(sb,bb)}eRd(sb,bb,Ob,gc){this.fz&&this.fz.eRd(sb,bb,Ob,gc)}fFb(sb){return this.fz?this.fz.fFb(sb):!1}onPaneClosed(){if(this.fz)this.fz.onPaneClosed()}cancelSearch(){this.fz&&this.fz.cancelSearch()}selectDataType(sb){this.fz&&this.fz.selectDataType(sb)}showHelpArticle(sb){this.fz&&this.fz.showHelpArticle(sb)}showSurveyDialog(sb){this.fz&&this.fz.showSurveyDialog(sb)}insertTable(sb,
bb){this.fz&&this.fz.insertTable(sb,bb)}}Object(c.a)(Ka,"EnrichmentManager",null,[394,3]);class Oa extends Ka{constructor(sb){super(sb)}dispose(){super.dispose()}}Object(c.a)(Oa,"ExcelEnrichmentManager",Ka,[]);var ib=a(13);class La{constructor(sb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=sb;this.commentQuestion=
ib.a.instance.mb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=ib.a.instance.mb(195);this.ratingValuesAscending=[ib.a.instance.mb(196),ib.a.instance.mb(197),ib.a.instance.mb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=ib.a.instance.mb(194)}}Object(c.a)(La,"FloodgateSurvey",null,[]);var db=a(24),Ab=a(76),Mb=a(422),pb=a(40),Qb=a(374),xb=a(188),pa=a(33),Ma=a(92),ya=a(29),Ea=a(1),Na=a(282),kb=a(21);class lb{constructor(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(lb,"EnrichmentMessageContentAppProperties",null,[]);class oa{constructor(sb,bb,Ob,gc,mb){this.tua=this.HNe=!1;this.$db=this.yxa=!0;this.DHb=this.WNb=!1;this.rfb=null;this.jsc=0;this.MR=()=>{(this.$db||this.tua)&&2!==this.jsc&&(this.DHb||this.Cwd(!1))};this.Tc=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.sPi=Nb=>{ya.a.dg(Nb.Errors)?(Nb=ya.a.sc(Nb.Errors),Nb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Nb}`)):Nb.Result&&(this.$.ea.tk(this.Tc),this.$.ea.Xj(this.Tc),Nb=Nb.Result,this.rfb=Nb.SkydanceFeatureBitmask,this.QAd(Nb),this.WNb=!0)};this.Cg=()=>{(this.$db||this.tua)&&this.Cwd(!1)};this.fqc=(Nb,ic)=>{ya.a.dg(Nb.Errors)?b.ULS.sendTraceTag(36975688,
0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${ya.a.sc(Nb.Errors)}`):Nb.Result&&(Nb=Nb.Result,Nb.DisambiguationJson?(this.WNb=!1,this.m6f(ic),this.rfb=Nb.SkydanceFeatureBitmask,ic=Nb.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.DHb=!1,this.Sqf(ic)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};
this.aSi=(Nb,ic)=>{ya.a.dg(Nb.Errors)?(ic=ya.a.sc(Nb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${ic}`)):Nb.Result&&(Nb=Nb.Result,Nb.DisambiguationJson?(this.m6f(ic),this.rfb=Nb.SkydanceFeatureBitmask,ic=Nb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.DHb=!0,this.Sqf(ic)):b.ULS.sendTraceTag(537166939,0,
10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.HVi=Nb=>{ya.a.dg(Nb.Errors)?(Nb=ya.a.sc(Nb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Nb}`),this.$db=!0):Nb.Result&&(Nb=Nb.Result,this.rfb=Nb.SkydanceFeatureBitmask,this.QAd(Nb),this.WNb=!0)};this.uYi=Nb=>{if(ya.a.dg(Nb.Errors)){const ic=ya.a.sc(Nb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${ic}`)}Nb.Result?
(this.QAd(Nb.Result),this.WNb=!0):this.tta()};this.YIf=Nb=>{ya.a.dg(Nb.Errors)?(Nb=ya.a.sc(Nb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Nb}`)):Nb.Result?this.i$b.OEc(Nb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.tta())};this.pUi=Nb=>{ya.a.dg(Nb.Errors)?(Nb=ya.a.sc(Nb.Errors),b.ULS.sendTraceTag(537166926,
0,15,`Failed to insert starter data table. Error id names: ${Nb}`)):this.tta()};this.$=sb;this.gridView=kb.h(this.$);this.gridView.ha.bU(this.Cg);this.gridView.pv(this.MR);this.zRe=gc;this.convertToLinkedEntityManager=mb;pa.a.gd(this.$)||Ob.IN(bb);sb=new Ua(bb);this.i$b=new Oa(sb);w.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Nb=>{Nb.isFeatureEnabled("mso_sendASmile",!0).then(ic=>{this.yxa=ic;return null})})}dispose(){this.$&&(this.gridView.ha.iS(this.Cg),
this.gridView.Ny(this.MR))}selectEntity(sb){const bb=pb.o(this.gridView.ha.ra.activeCell,this.$),Ob=()=>new Mb.a;Qb.a(this.$.userOperationManager,(gc,mb,Nb)=>J(this.$.pa.xa,bb,sb,Na.b(gc,this.uYi),mb,Nb,null),gc=>new xb.a(109,0,gc,void 0,Ob),null);return!0}searchEntity(sb,bb,Ob=!1,gc=0,mb=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${bb}`);const Nb=pb.o(this.gridView.ha.ra.activeCell,this.$);Qb.a(this.$.userOperationManager,
(ic,gb,Eb)=>L(this.$.pa.xa,Nb,sb,this.yxa,Ob,gc,mb,Na.b(ic,this.YIf),gb,Eb,null),ic=>new xb.a(110,0,ic,16),null)}fFb(sb){const bb=pb.o(this.gridView.ha.ra.activeCell,this.$);this.$db=!1;Qb.a(this.$.userOperationManager,(Ob,gc,mb)=>aa(this.$.pa.xa,bb,sb,Na.b(Ob,this.HVi),gc,mb,null),Ob=>new xb.a(111,0,Ob,16),null);return!0}onPaneClosed(){this.tua=!1;this.HNe=!0;this.jsc=0;this.DHb=!1}cancelSearch(){const sb=this.vRd();sb&&Qb.a(this.$.userOperationManager,(bb,Ob,gc)=>U(this.$.pa.xa,sb,Na.b(bb,this.YIf),
Ob,gc,null),bb=>new xb.a(112,0,bb,16),null)}selectDataType(sb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.tta();if(sb&&sb.length)if(sb=JSON.parse(sb))if(null==sb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var bb={};bb.Id=sb.domainId;bb.StringId=sb.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(bb)}else b.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(sb){const bb=new Ma.a(-859308420,Ab.a.Db,this.$.Hc,9,null);this.$.Ka.Lb(bb,{[Ab.a.ng]:"HelpID="+sb,["InputMethod"]:Ab.a.Db,["ShouldCanvasTakeFocus"]:!0,[Ab.a.Kc]:r.a.IV})}showSurveyDialog(sb){B.a.wOb(new La(sb))}insertTable(sb,bb){const Ob=this.vRd();Ob&&Qb.a(this.$.userOperationManager,(gc,mb,Nb)=>
P(this.$.pa.xa,Ob,sb,bb,Na.b(gc,this.pUi),mb,Nb,null),gc=>new xb.a(259,0,gc,1),null)}Cwd(sb){this.launchOrCloseDisambiguationPane(sb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const sb=this.ttj();sb&&Qb.a(this.$.userOperationManager,(bb,Ob,gc)=>G(this.$.pa.xa,sb,!0,this.yxa,!1,null,Na.b(bb,this.aSi),Ob,gc,1),bb=>new xb.a(114,0,bb,16),null)}launchLinkedEntityDataTypeSelectorPane(sb,
bb){Qb.a(this.$.userOperationManager,(Ob,gc,mb)=>K(this.$.pa.xa,sb,bb,Na.b(Ob,this.fqc),gc,mb,2),Ob=>new xb.a(233,0,Ob,16),null)}Wxi(sb,bb){sb&&Qb.a(this.$.userOperationManager,(Ob,gc,mb)=>G(this.$.pa.xa,sb,!1,!1,!0,bb,Na.b(Ob,this.fqc),gc,mb,2),Ob=>new xb.a(257,0,Ob,16),null)}m6f(sb){sb&&(this.jsc=sb)}Sqf(sb){if(Ea.EwaSettings.oa(611)){var bb=new Ma.a(-90814711,Ab.a.Db,0,10,null);this.$.Ka.Lb(bb,null)}this.tua?this.i$b.OEc(sb,null):(bb=3,null!=this.rfb?bb=this.rfb:b.ULS.shipAssertTag(537166937,0,
!1,"SkydanceFeatureBitmask was not set"),(sb=this.hUh(sb,bb))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.zRe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.i$b.byi(this.zRe,sb),this.tua=!0)}tta(){this.tua&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.i$b.tzb(),this.tua=!1,this.jsc=0,this.DHb=!1)}QAd(sb){var bb=sb.Row+1;sb=sb.Column+1;
0>bb||0>sb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.tta(),this.$.ea.tk(this.Tc)):(bb=new db.Range(bb,sb,bb,sb,!0,!1),this.gridView.ha.updateSelection(bb,bb,60),this.$db=!0)}hUh(sb,bb){const Ob=new lb;Ob.applicationVersion=d.AFrameworkApplication.buildVersion;Ob.applicationName="ExcelWac";Ob.anid="00000000-0000-0000-0000-000000000000";Ob.sessionId=d.AFrameworkApplication.userSessionId;Ob.appCorrelationId=
z.a.create().toString();var gc=A.a.uK(d.AFrameworkApplication.lcid);gc=gc?gc.name:null;Ob.uiLanguage=gc;Ob.market=this.Xcc(gc);Ob.themeId=0;Ob.disambiguationJson=sb;bb<=y.a.aT?Ob.featuresBitMask=bb:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ob}Xcc(sb){sb=sb.split("-");return sb[sb.length-1]}launchOrCloseDisambiguationPane(sb){const bb=this.gridView.ha.ra.activeCell;if(this.vRd()&&bb)if(this.gridView.Ab.xAb(bb)){if((!this.HNe||
sb||this.WNb)&&!this.gridView.gb){sb&&(this.$db=!0);var Ob=pb.q(bb,this.$);Qb.a(this.$.userOperationManager,(gc,mb,Nb)=>G(this.$.pa.xa,Ob,!1,this.yxa,!1,null,Na.b(gc,this.fqc),mb,Nb,1),gc=>new xb.a(114,0,gc,16),null)}}else this.tta();else this.tta()}zdj(){if(this.tua){var sb=this.gridView.ha.ra.activeCell;if(sb){var bb=pb.q(sb,this.$);Qb.a(this.$.userOperationManager,(Ob,gc,mb)=>G(this.$.pa.xa,bb,!1,this.yxa,!1,null,Na.b(Ob,this.fqc),gc,mb,1),Ob=>new xb.a(114,0,Ob,16),null)}else this.tta()}}vRd(){const sb=
this.gridView.ha.ra;return sb.hca()?pb.o(sb.activeCell,this.$):null}ttj(){const sb=this.gridView.ha.ra;return sb.hca()?pb.q(sb.activeCell,this.$):null}}Object(c.a)(oa,"ConvertToLinkedEntityDisambiguationPane",null,[3]);var Ba=a(7),sa=a(378),qb=a(1394),Jb=a(52),Yb=a(711);class jb{constructor(sb,bb,Ob){this.orf=2;this.nrf="Size64by48";this.$=sb;this.Va=bb;this.convertToLinkedEntityManager=Ob}xMh(sb,bb){var {ConvertToLinkedEntityManager:Ob}=a(761);this.wZj();bb=this.Va.gq(bb).NC();let gc=0,mb=0,Nb=!1;
for(var ic of sb.Categories){const gb=this.bNh(ic,gc);gb&&(mb===Ob.M9a&&(Nb=!0),bb.MenuSectionList.push(gb),++gc);++mb}Nb&&gc<=Ob.prf&&bb.MenuSectionList.splice(Ob.M9a,1);Ob=this.Va.Fc().q3b();ic=Jb.a.de(11);for(const gb of sb.LongButtons)this.convertToLinkedEntityManager.DFj(gb)&&this.CKg(Ob,gb,ic);0<Ob.ControlList.length&&bb.MenuSectionList.push(Ob);return bb}CKg(sb,bb,Ob){if(bb){var gc="Data.ConvertToLinkedEntityMenuItem_"+bb.Name,mb=this.convertToLinkedEntityManager.UU(bb.DomainId);mb&&(bb=Object(Ba.a)(new sa.a,
{Id:gc,ExternalId:gc,Command:"-1662108744",LabelText:bb.Name,Alt:bb.SuperTip,Visible:!0,MenuItemId:a(761).ConvertToLinkedEntityManager.b3a(bb.DomainId),Image16by16:Ob,Image16by16Class:this.Idi(mb.FontLocator)}),sb.ControlList.push(bb))}}XMh(sb,bb){return Object(Ba.a)(new qb.a,{Id:a(761).ConvertToLinkedEntityManager.tPe+sb.toString(),ExternalId:a(761).ConvertToLinkedEntityManager.tPe+sb.toString(),MenuItemId:a(761).ConvertToLinkedEntityManager.B$c+sb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.tef(bb.FontLocator),LabelText:bb.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.bhd(bb)})}QUg(sb){switch(sb){case "Animal":return Yb.a.pRg;case "Apple":return Yb.a.tSg;case "Atom":return Yb.a.LTg;case "Beaker":return Yb.a.FVg;case "Bridge":return Yb.a.fXg;case "Cat":return Yb.a.d2g;case "City":return Yb.a.r4g;case "Constellation":return Yb.a.p9g;case "Dog":return Yb.a.Bph;case "Finance":return Yb.a.yVg;case "GradCap":return Yb.a.x7h;case "HumanAnatomy":return Yb.a.Zci;
case "LocationPointer":return Yb.a.xAi;case "Map":return Yb.a.b1i;case "MedicineNeedle":return Yb.a.bHi;case "Mountain":return Yb.a.uIi;case "Movie":return Yb.a.NIi;case "Music":return Yb.a.ZIi;case "OuterSpace":return Yb.a.F1i;case "Planet":return Yb.a.H4i;case "Satellite":return Yb.a.Sqj;case "WolframGeneric":return Yb.a.Ppj;default:return Yb.a.dah}}Idi(sb){if("PowerBIRibbon"!==sb)return x.a.Zbd;switch(sb){case "AnimalRibbon":return x.a.mAh;case "AppleRibbon":return x.a.nAh;case "AtomRibbon":return x.a.oAh;
case "BeakerRibbon":return x.a.pAh;case "BridgeRibbon":return x.a.qAh;case "CenterMapRibbon":return x.a.rAh;case "CityRibbon":return x.a.sAh;case "CurrencyRibbon":return x.a.tAh;case "ExerciseRibbon":return x.a.uAh;case "FinanceRibbon":return x.a.UVe;case "FirstAidRibbon":return x.a.vAh;case "GlobeLightningRibbon":return x.a.wAh;case "GradCapRibbon":return x.a.xAh;case "HumanAnatomyRibbon":return x.a.yAh;case "LeafRibbon":return x.a.zAh;case "LocationPointerRibbon":return x.a.BAh;case "MapRibbon":return x.a.SVe;
case "MountainRibbon":return x.a.CAh;case "MovieRibbon":return x.a.DAh;case "MusicRibbon":return x.a.EAh;case "NotablePeopleRibbon":return x.a.FAh;case "OuterSpaceRibbon":return x.a.GAh;case "PartlySunnyWeatherRibbon":return x.a.HAh;case "PowerBIRibbon":return x.a.TVe;case "SatelliteRibbon":return x.a.IAh;case "WolframGenericRibbon":return x.a.AAh;case "YogaRibbon":return x.a.KAh;default:return x.a.RVe}}tef(sb){switch(sb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}bNh(sb,bb){bb=this.Va.$A("ConvertToLinkedEntitySection_"+bb,this.orf,this.nrf);var Ob=!1;for(var gc of sb.DomainIds){const mb=this.convertToLinkedEntityManager.UU(gc);if(!mb||
mb.DomainBlocked||!mb.ShowInRibbon)continue;Ob=mb.Name;const Nb=a(761).ConvertToLinkedEntityManager.b3a(gc);bb.nu("Data.ConvertToLinkedEntityMenuItem_"+Nb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Nb,this.tef(mb.FontLocator),void 0,void 0,this.bhd(mb),Ob);Ob=!0}if(!Ob)return null;gc=bb.Tqb(!0);bb=this.Va.Fc();bb.title=sb.Name;sb=bb.q3b();sb.ControlList.push(gc);return sb}wZj(){this.orf=5;this.nrf="Size112by64"}bhd(sb){return sb.RibbonTooltipHeader?sb.RibbonTooltipHeader+"\n\n"+sb.RibbonTooltip:
sb.RibbonTooltip}}Object(c.a)(jb,"ConvertToLinkedEntityMenuRenderer",null,[358]);var ab=a(58),vb=a(284),Da=a(116),Fa=a(145),nb=a(72);class Ta{constructor(sb,bb){this.Imd=this.Jmd=!1;this.hXi=Ob=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Jmd=!0;if(ya.a.dg(Ob.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${ya.a.sc(Ob.Errors)}`);else{var gc=0,mb=[],Nb=!1;try{if(!Ob.Result)return;const ic=Ob.Result;if(!ic){b.ULS.sendTraceTag(537166678,
0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}mb=this.V2i(ic);if(!mb||!mb.length)return;gc=mb.length;this.qHi(mb);this.UAa.GZf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.UAa.Bcb.length}`);if(Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const gb of this.UAa.Bcb)if(1===(gb.Id&1048320)>>8){Nb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Nb}`)}}finally{b.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${gc} data types.`),Ob=[],Ob.push(Object(Ba.a)(new nb.a,{name:"MruCount",int64:gc})),Ob.push(Object(Ba.a)(new nb.a,{name:"MruWolframAvailable",bool:Nb})),Fa.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Ob)}this.Imd&&(this.dog(this.UAa.Bcb),this.Imd=!1)}};this.A0i=Ob=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");ya.a.dg(Ob.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${ya.a.sc(Ob.Errors)}`):
Ob.Result&&(Ob.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.CIf=(Ob,gc,mb)=>{Ob=Da.a.Oe(Ob.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${mb}. Errors: ${ya.a.sc(Ob)}.`)};this.$=sb;this.UAa=bb}$0h(){this.Jmd||Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.Zb||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
vb.w(this.$.pa.xa,0,this.hXi,this.CIf,null,null))}dog(sb){sb&&sb.length?this.Jmd?(sb=this.$uj(sb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),vb.C(this.$.pa.xa,0,sb,this.A0i,this.CIf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Imd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}$uj(sb){if(!sb||
!sb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var bb=[];for(const Ob of sb)sb={},sb.Id=Ob.Id,Ob.StringId&&(sb.StringId=Ob.StringId),bb.push(sb);bb="<DataTypes>"+ab.a.fc(bb)+"</DataTypes>";return 1906<bb.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):bb}V2i(sb){if(!sb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!sb.startsWith("<DataTypes>")||!sb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;sb=sb.substring(11,sb.length-12);if(!sb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let bb=[];try{bb=ab.a.$h(sb)}catch(Ob){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Ob.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${bb.length} data types.`);return bb}qHi(sb){const bb=this.UAa.Bcb,Ob=this.UAa.scj;if(bb.length!==Ob){for(let gc=0;gc<sb.length&&bb.length<Ob;++gc){const mb=sb[gc];this.UAa.UU(mb)&&!bb.includes(mb)&&bb.push(mb)}this.UAa.Bcb=bb}}}Object(c.a)(Ta,"LinkedDataTypeRoamingHandler",null,[]);var V=a(59),va=a(48),wb=a(190),fc=a(37),Fc=a(47),Qa=a(28),la=a(283),hb=a(22),Kb=a(99);a.d(E,"ConvertToLinkedEntityManager",function(){return dc});
class dc extends n.a{constructor(sb,bb,Ob,gc,mb,Nb,ic){super();this.Bnf=this.qud=this.mvd=this.ktd=this.jtd=this.u8a=this.nqd=null;this.IFb=this.jmd=0;this.Tla=null;this.xqd=!1;this.mfd=this.fo=this.aQd=null;this.Js=0;this.fZ=null;this.mMa=8;this.V1c=this.mrf=this.Gjf=this.cbb=!1;this.Pza=this.X0e=this.RYe=null;this.R_c=0;this.bVg=5;this.I2b=3E4;this.qgg=!1;this.l3=null;this.Jua=Array(5);this.Tig=this.C1d=!1;this.T_f=this.bxd=0;this.htmlSanitizationHelper=this.Kfe=null;this.lag=!0;this.Tc=(gb,Eb)=>
{Eb.Zb&&!Eb.jCb&&this.showUntrustedImageBusinessBarIfNecessary()};this.bTi=gb=>{if(gb.Result){var Eb=gb.Result;if(Eb&&Eb.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Eb.length} labels`);var Lc=va.GetServiceTaskFactory.Na(this.$.da,274,275,0);fc.TaskExtensions.za(Lc,()=>{Lc.result.H_c(Eb,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ka,3)}}else b.ULS.sendTraceTag(537166923,
0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.Bf=()=>{this.wBb&&(this.FUj(),this.r9h(this.$.ea.Lo.LinkedEntityAsyncRefreshStateId));this.C8a?this.t$h(this.$.ea.Lo.RichDataClassificationLabelStateId):this.K7a&&this.P0d(!0)};this.yQi=()=>{this.C1d=!0;this.fo&&this.fo.zdj()};this.tSi=gb=>{if(gb&&!la.a(gb))try{gb.Result.HasUntrustedImageUrl&&(this.businessBar.mh(59,null),this.Tig=!0)}catch(Eb){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Eb}.`)}};
this.Pqf=()=>{if(!this.mrf&&this.PAb()&&!this.lrd())if(Fa.a("DataTabActive"),V.a.Ag.pR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var gb=this.H6b();if(gb){var Eb={};Eb.InputMethod=Ab.a.Db;Eb.CalloutName=8;Eb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ka.Lb(gb,Eb);this.mrf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.tPi=gb=>{ya.a.dg(gb.Errors)||(this.C8a||this.P0d(!1),this.raiseEvent("LinkedEntityConverted"))};this.xZi=()=>{this.$.da.fb(211,gb=>{gb.readText(ib.a.instance.ga(1804))})};this.$c=(gb,Eb)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Eb.aW?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.kDe():this.tnj(),Ea.EwaSettings.oa(611)&&this.C1d&&this.BQe())};this.DSi=gb=>{this.P4b();if(gb.Result){var Eb=gb.Result;gb=Eb.DomainDataArray;if(this.Tla=Eb.Ribbon){var Lc={};Lc.Name=ib.a.instance.ga(1794);Lc.DomainIds=this.TK;this.Tla.Categories.splice(dc.M9a,0,Lc)}0<Eb.MaximumCellsToConvert&&(this.Kfe=Eb.MaximumCellsToConvert);this.Js=2;Eb=!1;if(gb){b.ULS.sendTraceTag(39949271,0,50,
`OnGetLinkedEntityServiceDomainsSuccess: Received ${gb.length} domains`);this.JOa||(this.JOa=[]);Lc=ib.a.instance.ga(1791);const Ec=ib.a.instance.ga(1793);for(const Cb of gb)Cb.DomainId?(this.JOa.push(Cb),Cb.DomainBlocked?(gb=!!Cb.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${gb?Cb.DomainId.Id.toString():Cb.Name} is telemetry only, do not show in menu (Has String ID: ${gb})`)):(this.TU.ia(dc.b3a(Cb.DomainId),Cb),Cb.Name===Lc||268435456===Cb.DomainId.Id?this.RYe=Cb.DomainId.Id.toString():
Cb.Name===Ec||536870912===Cb.DomainId.Id?this.X0e=Cb.DomainId.Id.toString():268435712===Cb.DomainId.Id&&Cb.ShowInRibbon&&(this.V1c=!0),Eb=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Eb||(this.JOa=null);this.Gjg();this.aQd.$0h();this.qgg||(this.BUj(),this.qgg=!0)}else this.JOa=null,this.Js=3,-1<this.mMa&&window.setTimeout(()=>{this.zIb()},100*(8-this.mMa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.GLd();this.qJe();this.V1c&&this.Ykf&&wb.c(this.Pqf,this.$.ka,500);this.K7a&&!this.C8a&&this.P0d(!0)};this.CSi=gb=>{gb=Da.a.Oe(gb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${ya.a.sc(gb)}].`);this.JOa=null;this.Js=3;this.cbb=!0;this.GLd()};this.onContentReady=()=>{this.Dhg()&&this.gridView.Ny(this.onContentReady);this.lag&&this.$.workbookContext.Options&1048576&&(this.businessBar.rJj(),this.lag=!1)};this.Kj=()=>{this.P4b()};this.gVi=gb=>{if(la.a(gb)){const Eb=
va.GetServiceTaskFactory.Na(this.$.da,5,4,0);fc.TaskExtensions.za(Eb,()=>{let Ec=null;if(null===gb||void 0===gb?0:gb.Errors)Ec=gb.Errors[0];Eb.result.Q$f(Ec,null)},this.$.ka,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${ya.a.sc(gb.Errors)}].`);const Lc=ya.a.QB(gb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.To(Lc)}};
this.M1c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.I2b} millisecond interval`);this.jhf("Periodic auto-refresh check",this.LNi,this.KNi)};this.LNi=gb=>{la.a(gb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${ya.a.sc(gb.Errors)}].`),++this.R_c):this.R_c=0;e.a.Ia(this.Pza);this.R_c>=this.bVg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.Pza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.Pza=Fc.a.instance.create(this.M1c,this.I2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.KNi=gb=>{gb=Da.a.Oe(gb.data);f.a.sh(gb)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${ya.a.sc(gb)}].`);e.a.Ia(this.Pza);this.Pza=Fc.a.instance.create(this.M1c,this.I2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.fWi=gb=>{gb=!!gb.Result&&gb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${gb.toString()}`);gb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Qa.a.Sa.ve.m-
this.jmd} ms, retry count = ${this.IFb}`),this.zIb()):this.EBc()};this.eWi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.EBc()};this.eSi=gb=>{gb.Result?(gb=gb.Result)?(this.SMd(),this.businessBar.Q$f(null,gb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=sb;this.businessBar=Nb;this.svgIconProvider=
Ob;this.htmlSanitizationHelper=ic;this.JOa=[];this.TK=[];this.gridView=kb.h(this.$);this.Efc=-1;this.dqi=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.K7a=this.$.oa(412)&&this.$.oa(274);this.C8a=this.$.oa(630);this.wBb=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.Ykf=Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.TU=new Kb.a;
this.r$a=new jb(sb,bb,this);gc&&(this.fo=new oa(sb,gc,mb,this,this));this.$.$k(this.$c);u.a(this.$)&&u.a(this.$).Dwj(this);this.kDe();(this.wBb||this.K7a||this.C8a)&&this.$.ea.pu(this.Bf);Ea.EwaSettings.oa(128)&&Ea.EwaSettings.oa(136)&&(this.Dhg()||this.gridView.pv(this.onContentReady));this.$.DC(this.Kj);Ea.EwaSettings.oa(611)&&(this.$.ea.Xj(this.Tc),this.showUntrustedImageBusinessBarIfNecessary());this.aQd=new Ta(this.$,this)}dispose(){(this.wBb||this.K7a||this.C8a)&&this.$.ea.Rv(this.Bf);Ea.EwaSettings.oa(611)&&
this.$.ea.tk(this.Tc);!this.l3&&Ea.EwaSettings.oa(128)&&Ea.EwaSettings.oa(136)&&this.gridView.Ny(this.onContentReady);this.fo&&this.fo.dispose();this.$.jG(this.Kj);this.$.ul(this.$c);this.K7a&&(this.nqd=null);e.a.Ia(this.Pza)}INg(sb){this.addHandler("LinkedEntityConverted",sb)}ijj(sb){this.removeHandler("LinkedEntityConverted",sb)}get scj(){return 5}get Bcb(){return this.TK}set Bcb(sb){this.TK=sb}selectEntity(sb){return this.fo?this.fo.selectEntity(sb):!1}searchEntity(sb,bb){this.fo&&this.fo.searchEntity(sb,
bb)}eRd(sb,bb,Ob,gc){this.fo&&this.fo.searchEntity(sb,bb,!0,Ob,gc)}fFb(sb){return this.fo?this.fo.fFb(sb):!1}onPaneClosed(){if(this.fo)this.fo.onPaneClosed()}cancelSearch(){this.fo&&this.fo.cancelSearch()}selectDataType(sb){this.fo&&this.fo.selectDataType(sb)}showHelpArticle(sb){this.fo&&this.fo.showHelpArticle(sb)}showSurveyDialog(sb){this.fo&&this.fo.showSurveyDialog(sb)}insertTable(sb,bb){this.fo&&this.fo.insertTable(sb,bb)}t$h(sb){this.$.isEditMode&&this.T_f!==sb&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&
(this.T_f=sb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),I(this.$.pa.xa,this.bTi,null,null,null))}BQe(){this.$.userOperationManager.Ic(new xb.a(589,0,(sb,bb,Ob)=>W(this.$.pa.xa,Na.b(sb,this.yQi),bb,Ob,null),80),null)}showUntrustedImageBusinessBarIfNecessary(){this.C1d||this.Tig||!this.$.ea.Zb||this.guj()}guj(){this.$.userOperationManager.Ic(new xb.a(588,0,(sb,bb,Ob)=>na(this.$.pa.xa,Na.b(sb,this.tSi),bb,Ob,null),80),
null)}P0d(sb){if(this.K7a&&null==this.nqd&&!this.C8a&&d.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.u8a&&this.u8a&&(!sb||this.$.workbookContext.Options&262144)){var bb=va.GetServiceTaskFactory.Na(this.$.da,274,275,0);fc.TaskExtensions.za(bb,()=>{this.nqd=bb.result.qUf(2)},this.$.ka,3)}}get IEb(){return this.Jua.length}get XGi(){return this.Kfe}eah(sb){(sb=this.Fph(sb))?this.convertToLinkedEntity(sb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(sb){b.ULS.sendTraceTag(34415004,
0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${sb.Id}].`);if(this.gridView){var bb=this.gridView.ha.ra.ed,Ob=bb.He(this.gridView.KH);this.xqd&&this.pLg(sb);if(Ob){Ob=this.gridView.Ab.Mxa(Ob);if(!this.Lbf(sb)&&this.Zlf(sb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(V.a.Ag.pR){bb=this.ugd();if(!bb){b.ULS.sendTraceTag(537166917,
0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ob=this.H6b();if(!Ob){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var gc={["InputMethod"]:Ab.a.Db,CalloutName:3};gc.Target=bb;gc.RibbonButtonLabel=Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.H_f(sb):this.ZCb(sb.Id.toString());gc.ExampleEntities=this.SWe(sb);this.$.Ka.Lb(Ob,gc);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Zlf(sb.Id)&&
!sb.StringId)this.launchLinkedEntityDataTypeSelectorPane(dc.b3a(sb));else{if(Ob){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.uOj(sb)){bb=pb.r(this.gridView.ha.ra.selectedRanges,this.$);this.fo.Wxi(bb,sb);return}if(V.a.Ag.pR){bb=this.ugd();if(!bb){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}Ob=this.H6b();if(!Ob){b.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}gc={["InputMethod"]:Ab.a.Db,CalloutName:2};gc.Target=bb;gc.RibbonButtonLabel=this.H_f(sb);gc.ExampleEntities=this.SWe(sb);gc.BlankCellResourceId=this.fWg(sb);gc.HasBlankCellWalkthrough=this.hai(sb);gc.ServiceDomain=sb.Id;this.$.Ka.Lb(Ob,gc);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.T5c(sb,
!1,bb)}}}else b.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.l3&&this.l3.JIa()}onAutoDetectUIShown(){Qb.a(this.$.userOperationManager,(sb,bb,Ob)=>T(this.$.pa.xa,sb,bb,Ob,null),sb=>new xb.a(230,0,sb,80),null)}T5c(sb,bb,Ob){const gc=pb.q(Ob,this.$),mb=()=>new Mb.a;Qb.a(this.$.userOperationManager,(Nb,ic,gb)=>M(this.$.pa.xa,gc,sb,bb,Na.b(Nb,this.tPi,this.xZi,this.fo.sPi),ic,gb,null),Nb=>new xb.a(115,0,Nb,void 0,mb),null)}pLg(sb){if(this.xqd){var bb=
{};bb.Id=sb.Id;sb.StringId&&(bb.StringId=sb.StringId);if(!(0<this.TK.length&&this.TK[0].Id===bb.Id&&this.TK[0].StringId===bb.StringId)){sb=!1;this.TK.splice(0,0,bb);for(let Ob=1;Ob<this.TK.length;++Ob)if(this.TK[Ob].Id===bb.Id&&this.TK[Ob].StringId===bb.StringId){this.TK.splice(Ob,1);sb=!0;break}for(;5<this.TK.length;)this.TK.splice(this.TK.length-1,1);this.Tla.Categories[dc.M9a].DomainIds=this.TK;this.GZf();sb||this.aQd.dog(this.TK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,
"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var sb=pb.q(this.gridView.ha.ra.ed,this.$);Qb.a(this.$.userOperationManager,(bb,Ob,gc)=>H(this.$.pa.xa,sb,bb,Ob,gc,null),bb=>new xb.a(116,0,bb),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(kb.h(this.$)){this.$.isEditMode||
b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.SMd();var sb=pb.r(this.gridView.ha.ra.selectedRanges,this.$);Qb.a(this.$.userOperationManager,(bb,Ob,gc)=>C(this.$.pa.xa,sb,bb,Ob,gc,null),bb=>new xb.a(248,0,bb),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}DFj(sb){sb=this.UU(sb.DomainId);if(!sb||sb.DomainBlocked||Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!sb.HasCuratedData)return!1;if(this.dqi){for(let bb of this.TU)if(bb.value.DomainId.Id===sb.DomainId.Id&&bb.value.ShowInRibbon)return!0;return!1}return sb.ShowInRibbon}rEj(sb){return 2!==this.Js||!this.Jua[sb]}launchDisambiguationPaneForSearch(){this.fo&&this.fo.launchDisambiguationPaneForSearch()}Lc(sb,bb,Ob){if("PopulateConvertToLinkedEntityMenu"!==bb)return!1;this.mfd=Ob.MenuId;if(0===this.Js||3===this.Js)return this.h5i(),!0;if(!this.Tla)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.TU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.fZ=this.fZ||this.r$a.xMh(this.Tla,Ob.MenuId);Ob.MenuItems=this.fZ;return this.xqd=!0}h5i(){-1===this.Efc&&(this.zIb(),this.Efc=window.setInterval(()=>{this.zIb()},2E3))}zIb(){this.$.ea.Zb&&2!==this.Js&&(this.mMa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.Js=1,S(this.$.pa.xa,this.DSi,this.CSi,null,null))}lrd(){return this.$.isEditMode&&
2!==this.Js&&(0<=this.mMa||!this.cbb)}n2d(sb){d.AFrameworkApplication.Og?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):u.a(this.$)?(this.ZZj(),sb&&this.$.af()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}tnj(){this.IFb=0;this.mMa=8;this.cbb=!1;this.Js=this.Efc=0;this.JOa=this.Tla=null;this.P4b();for(let sb=0;sb<this.IEb;++sb)this.Jua[sb]=null;this.PAb()&&this.n2d(!0)}P4b(){this.fZ=null}PAb(){const sb=
r.a.qJb,bb=u.a(this.$);return!!bb&&bb.Qn.fA===sb}Gjg(){if(this.Tla){let Ob=0;var sb=-1,bb=-1;let gc=0,mb=0,Nb=0,ic=0;const gb=[null,null,null,null,null];for(const Eb of this.Tla.Categories){let Lc=!1;for(const Ec of Eb.DomainIds){let Cb=this.UU(Ec);Cb&&!Cb.DomainBlocked&&Cb.ShowInRibbon&&(Ob<this.IEb?(this.Jua[Ob]=Ec,mb===dc.M9a&&(-1===sb&&(sb=Ob),bb=Ob,ic=bb-sb+1),++Ob):Ob===this.IEb&&gc<ic&&mb!==dc.M9a&&(gb[gc]=Ec,++gc),Lc=!0)}Lc&&++Nb;++mb}if(-1<sb&&Nb<=dc.prf){for(;bb>=sb;--bb)this.Jua.splice(bb,
1);for(sb=0;sb<ic;++sb)this.Jua.splice(Ob+sb,0,gb[sb])}for(;Ob<this.IEb;)this.Jua[Ob]=null,++Ob}}Dhg(){const sb=kb.h(this.$).Da,bb=this.gridView.ha.Ne;if(sb&&sb.omd&&1===bb&&this.gridView.ha.ra.activeCell){const Ob=va.GetServiceTaskFactory.Na(this.$.da,12,477,1);Ea.EwaSettings.isChangeGateEnabled("OfficeVSO:7252908_ConvertToLinkedEntityManagerInvalidOperationFix")?fc.TaskExtensions.za(Ob,()=>{this.l3=new v.a(this.$,this.svgIconProvider,Ob.result,this,this.htmlSanitizationHelper)},this.$.ka,3):this.l3=
new v.a(this.$,this.svgIconProvider,Ob.result,this,this.htmlSanitizationHelper);return!0}return!1}Zxi(){this.fo&&this.fo.Cwd(!0)}launchLinkedEntityDataTypeSelectorPane(sb){if(this.fo)if(sb=this.h$c(sb))if(sb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var bb=pb.r(this.gridView.ha.ra.selectedRanges,this.$);this.fo.launchLinkedEntityDataTypeSelectorPane(bb,sb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}t9g(sb){const bb=
this.Hdi(sb),Ob=h.a.rg(this.ZCb(sb));sb=h.a.rg(this.O_d(sb));return dc.$Lh(bb,Jb.a.de(11),Ob,sb)}O_d(sb){try{return this.GOe(parseInt(sb,10)).Description}catch(bb){}return ib.a.instance.ga(1788)}ZCb(sb){try{return this.GOe(parseInt(sb,10)).Name}catch(bb){}return ib.a.instance.ga(1774)}H_f(sb){try{return this.UU(sb).Name}catch(bb){}return this.ZCb(sb.Id.toString())}fWg(sb){try{return this.UU(sb).BlankCellResourceId}catch(bb){}return null}hai(sb){try{return this.UU(sb).HasBlankCellWalkthrough}catch(bb){}return!1}Lbf(sb){try{const bb=
dc.b3a(sb);if(this.TU.kb(bb))return this.TU.ma(bb).HasCuratedData}catch(bb){}return!1}uOj(sb){try{return this.UU(sb).SupportsStarterData}catch(bb){}return!1}Zlf(sb){return 268435968===sb}ugd(){return 2===u.a(this.$).AL?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}H6b(){return new Ma.a(-847286761,Ab.a.Db,this.$.Hc,0,r.a.C0)}qJe(){if(this.PAb()&&!this.lrd()&&!this.Gjf&&Ea.EwaSettings.oa(412)&&this.Lbf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
V.a.Ag.pR){const Ob=this.ugd();if(Ob){var sb=this.H6b();if(sb){var bb={["InputMethod"]:Ab.a.Db,CalloutName:6};bb.Target=Ob;bb.ShouldCanvasTakeFocus=!0;this.$.Ka.Lb(sb,bb);this.Gjf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}hdi(sb){sb=
this.h$c(sb);return sb?this.r$a.QUg(sb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}dic(sb){return this.l3?this.l3.PUg(sb):!1}bPh(){return this.l3?this.l3.YPh():""}jli(){return this.l3?this.l3.DDb:!1}RTh(sb,bb){const Ob=this.gff(sb);if(0>Ob)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${sb}`);else if(sb=(sb=this.HOe(sb))?this.UU(sb):
null)bb[m.a.GalleryButtonProps]=this.r$a.XMh(Ob,sb),bb[m.a.Alt]=this.r$a.bhd(sb)}GZf(){this.Gjg();this.PAb()&&this.n2d(!0);this.P4b()}Hdi(sb){return sb===this.RYe?x.a.UVe:sb===this.X0e?x.a.SVe:x.a.RVe}SWe(sb){try{return this.UU(sb).ExampleEntities}catch(bb){}return ib.a.instance.ga(1796)}GLd(){(0>this.mMa||this.cbb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Js||0>this.mMa||this.cbb)&&window.clearInterval(this.Efc);this.lrd()?
this.mfd&&this.$.frame.ux(this.mfd):this.n2d(this.PAb())}Hb(sb){return this.$.Eb+sb}ZZj(){var sb=!0;const bb=Array(this.IEb),Ob=u.a(this.$)?u.a(this.$).Qn:null;if(Ob){for(let gc=0;gc<bb.length;++gc)this.rEj(gc)?bb[gc]=!0:sb=bb[gc]=!1;Ob.wTd(["ConvertToLinkedEntityGallery"],sb);if(!sb)for(sb=0;sb<bb.length;++sb)bb[sb]&&Ob.wTd([this.QTh(sb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}UU(sb){const bb=dc.b3a(sb);if(this.TU.kb(bb))return this.TU.ma(bb);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${sb.Id} (Has String ID: ${!!sb.StringId})`);return null}QTh(sb){return"ConvertToLinkedEntityPreview"+sb.toString()}e2d(){l.a.get_instance().Zj(10,()=>{this.qJe();this.V1c&&this.Ykf&&wb.c(this.Pqf,this.$.ka,500)})}tfc(sb,bb){switch(sb){case "QueryLinkedEntityGalleryButtons":if(!bb[m.a.InnerHTML]){sb=bb[Ab.a.Kc].toString();const Ob=hb.a.equals(sb,ib.a.instance.ga(1791),!0)||hb.a.equals(sb,ib.a.instance.ga(1792),!0),gc=hb.a.equals(sb,ib.a.instance.ga(1793),
!0);Ob||gc||this.RTh(sb,bb)}break;case "QueryLinkedEntityMenuGalleryButtons":bb[m.a.InnerHTML]||(bb[m.a.InnerHTML]=this.t9g(bb[Ab.a.Kc]))}return bb}Fph(sb){var bb=this.HOe(sb);if(bb)return bb;if(bb=this.h$c(sb))return bb.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${sb}`);return null}GOe(sb){const bb={};bb.Id=sb;return this.UU(bb)}h$c(sb){return this.TU.kb(sb)?this.TU.ma(sb):null}gff(sb){if(!sb.startsWith(dc.B$c))return-1;const bb=parseInt(sb.substr(dc.B$c.length),
10);return isNaN(bb)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${sb}`),-1):bb}HOe(sb){sb=this.gff(sb);return 0>sb?null:this.Jua[sb]}jhf(sb,bb,Ob){this.wBb&&this.TU&&this.TU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${sb})`),sb=this.$.pa.xa.Wb(),this.$.ea.Zb&&X(this.$.pa.xa,Na.b(this.gVi,bb),Ob,null,null,sb))}BUj(){this.jhf("Auto-refresh on load",null,null)}FUj(){this.wBb&&this.TU&&this.TU.count&&
(this.Pza?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Lo.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Pza=Fc.a.instance.create(this.M1c,this.I2b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}EBc(){if(this.$.ea.Zb&&null!=this.u8a&&null!=this.jtd&&null!=this.ktd&&null!=this.mvd&&null!=this.qud)if(++this.IFb,12>=this.IFb){1===this.IFb&&(this.jmd=Qa.a.Sa.ve.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const sb=this.$.pa.xa.Wb();
vb.u(this.$.pa.xa,this.czi,this.dzi(),this.fWi,this.eWi,null,sb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Qa.a.Sa.ve.m-this.jmd} ms`),this.cbb=!0,this.GLd()}kDe(){if(this.$.isEditMode)if(null!=this.u8a)this.EBc();else{var sb=Qa.a.Sa.ve.m,bb=[];w.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ob=>{Ob.isFeatureEnabled("ExcelPowerBiPro",!1).then(gc=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Qa.a.Sa.ve.m-sb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${gc}]`);return this.u8a=gc}).then(()=>{bb.push(Ob.isFeatureEnabled("ExcelWolframAlpha",!1).then(gc=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Qa.a.Sa.ve.m-sb} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${gc}]`);return this.mvd=gc}))}).then(()=>{bb.push(Ob.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(gc=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Qa.a.Sa.ve.m-sb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${gc}]`);
let mb;const Nb=[(mb=new nb.a,mb.name="IsRestrictedByLicense",mb.bool=gc,mb)];Fa.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Nb);this.Bnf=gc&&Ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return gc}))}).then(()=>{bb.push(Ob.isFeatureEnabled("StockHistory",!1).then(gc=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Qa.a.Sa.ve.m-sb} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${gc}]`);return this.qud=gc}))}).then(()=>{bb.push(Ob.isFeatureEnabled("ExcelPowerBiFree",!1).then(gc=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Qa.a.Sa.ve.m-sb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${gc}]`);return this.jtd=gc}))}).then(()=>
{bb.push(Ob.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(gc=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Qa.a.Sa.ve.m-sb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${gc}]`);return this.ktd=gc}))}).then(()=>{Promise.all(bb).then(()=>{this.EBc()})})})}}get czi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}dzi(){return[this.u8a,
this.mvd,this.qud,this.jtd,this.ktd,this.Bnf]}SMd(){this.businessBar&&this.businessBar.qla(58)&&this.businessBar.removeEntry(58)}r9h(sb){this.bxd!==sb&&this.businessBar&&((this.bxd=sb)?Y(this.$.pa.xa,this.eSi,null,null,null):this.SMd())}static $Lh(sb,bb,Ob,gc){sb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',sb,bb,gc);Ob=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Ob);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',sb,Ob)}static b3a(sb){return sb.StringId?sb.Id.toString()+"."+sb.StringId:sb.Id.toString()}}dc.tPe="ConvertToLinkedEntityPreview";dc.B$c="PreviewGalleryButtonIndex.";dc.M9a=0;dc.prf=2;Object(c.a)(dc,"ConvertToLinkedEntityManager",n.a,[297,298,3,299])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/c27e35e40aea89fe191dab54f319b1ec/EwaDSEsNext.le.js.map