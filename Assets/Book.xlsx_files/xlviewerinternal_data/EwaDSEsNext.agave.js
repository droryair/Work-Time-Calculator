/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1147:function(t,E,a){t=a(0);var c=a(15),b=a(695),e=a(76),f=a(37);class d{constructor(la,hb){this.automateCommandManager=la;this.$=hb}nc(){return!1}executeCommand(la,hb,Kb){la=f.TaskExtensions.Vj();hb=hb.command;switch(hb){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Xc(2045014907,-1,0,null),this.automateCommandManager.jmc(hb,
1904816141===hb?Kb[e.a.Kc].toString():null)}return la}yc(la,hb){la=!1;switch(hb.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:la=this.$.XV}return la}Lc(la,hb,Kb){return"PopulateAutomateGalleryMenu"===hb&&this.$.XV?(this.automateCommandManager.Lc(hb,Kb),!0):!1}}Object(t.a)(d,"AutomateCommandHandler",null,[219]);var h=a(462);class m extends b.a{constructor(la){super(la)}ld(){h.a(this.$,374,375,
this.Ya,()=>{const la=this.$.da.Aa(352);la?this.Zc([new d(la,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static la(la){la.da.Ga(308,new m(la))}}Object(t.a)(m,"AutomateCommandHandlerFactory",b.a,[]);b=a(222);var l=a(7),w=a(4);class n{constructor(){this.token=null;this.timeStamp=0}}Object(t.a)(n,"AuthContext",null,[]);var x=a(724),r=a(131),u=a(110),v=a(28),B=a(767),z=a(145),A=a(72);class y{constructor(la,hb,Kb){var dc,
sb;this.$=la;this.oAuthManager=hb;this.rv=Kb;this.j3=new n;this.qqb=null!==(sb=null===(dc=this.oAuthManager)||void 0===dc?void 0:dc.kNa())&&void 0!==sb?sb:!1}getAuthContext(){return this.j3}lba(){const la=v.a.Sa.zb,hb=[];if(this.oAuthManager)hb.push(Object(l.a)(new A.a,{name:"IsAuthSupported",bool:this.qqb}));else return this.gva(hb,la,"need_OAuthManager","No OAuthManager");if(!this.rv.Mo||!this.rv.Mo.value)return this.gva(hb,la,"need_license","No License");if(w.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.gva(hb,
la,"need_user","Anonymous User");if(33E5>Date.now()-this.j3.timeStamp)return hb.push(Object(l.a)(new A.a,{name:"UsedCachedToken",bool:!0})),z.a(r.a.Y$a,!0,0,hb),Promise.resolve(Object(l.a)(new B.a,{IsSuccess:!0,Token:this.j3.token}));hb.push(Object(l.a)(new A.a,{name:"UsedCachedToken",bool:!1}));let Kb=1;const dc=(sb,bb)=>(new Promise(Ob=>{window.setTimeout(()=>{Ob(sb)},bb)})).then(Ob=>{hb.push(Object(l.a)(new A.a,{name:"Error"+Kb,string:Ob.ErrorMessage}));hb.push(Object(l.a)(new A.a,{name:"ErrorCode"+
Kb,string:Ob.ErrorCode}));Kb++;return this.AQb()});return this.AQb().catch(sb=>dc(sb,200)).catch(sb=>dc(sb,400)).then(sb=>{sb.IsSuccess?(this.j3.token=sb.Token,this.j3.timeStamp=Date.now()):(hb.push(Object(l.a)(new A.a,{name:"Error"+Kb,string:sb.ErrorMessage})),hb.push(Object(l.a)(new A.a,{name:"ErrorCode"+Kb,string:sb.ErrorCode})));hb.push(Object(l.a)(new A.a,{name:"Attempts",int64:Kb}));hb.push(Object(l.a)(new A.a,{name:"Error",string:sb.ErrorMessage}));hb.push(Object(l.a)(new A.a,{name:"ErrorCode",
string:sb.ErrorCode}));z.a(r.a.Y$a,sb.IsSuccess,u.getElapsedMilliseconds(la,v.a.Sa.zb),hb);return Promise.resolve(sb)}).catch(sb=>{hb.push(Object(l.a)(new A.a,{name:"Error"+Kb,string:sb.ErrorMessage}));hb.push(Object(l.a)(new A.a,{name:"ErrorCode"+Kb,string:sb.ErrorCode}));hb.push(Object(l.a)(new A.a,{name:"Attempts",int64:Kb}));return this.gva(hb,la,sb.ErrorCode,sb.ErrorMessage)})}gva(la,hb,Kb,dc){la.push(Object(l.a)(new A.a,{name:"Error",string:dc}));la.push(Object(l.a)(new A.a,{name:"ErrorCode",
string:Kb}));z.a(r.a.Y$a,!1,u.getElapsedMilliseconds(hb,v.a.Sa.zb),la);return Promise.resolve(Object(l.a)(new B.a,{IsSuccess:!1,ErrorMessage:dc,ErrorCode:Kb}))}AQb(){var la=x.a.Hkd();let hb=0;la=this.oAuthManager.YL("Maker",la).then(Kb=>{if(Kb)return!Kb.IsSuccess&&this.zVd(Kb)?Promise.reject(Kb):Promise.resolve(Kb);Kb=Object(l.a)(new B.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Kb)}).catch(Kb=>{let dc=new B.a;Object.getType(Kb)===Object.getType(dc)?
dc=Kb:(dc.ErrorMessage=Kb.toString(),dc.ErrorCode="exception");return Promise.reject(dc)});return Promise.race([la,new Promise((Kb,dc)=>{hb=window.setTimeout(()=>{dc(Object(l.a)(new B.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(Kb=>{window.clearTimeout(hb);return Kb})}zVd(la){return"interaction_required"===la.ErrorCode||"InitFailed"===la.ErrorCode||"invalid_resource"===la.ErrorCode||"login_required"===la.ErrorCode&&la.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(t.a)(y,"AutomateCommandAuth",null,[510]);var D=a(819);class I{constructor(){this.Ru=null}}Object(t.a)(I,"AutomateCommandGalleryBase",null,[]);var M=a(378),T=a(30),S=a(559),H=a(1394),C=a(19),G=a(52),J=a(13);a(316);var L=a(577);class P{constructor(la,hb){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=la;this.currentUserMlapiToken=hb}}Object(t.a)(P,"UserInfo",null,[]);var aa=a(188),U=a(60),K=a(33),Y=a(1),na=a(282);const W=la=>"TestHost"===la.ya.DocumentHostInfo.HostTier,
X=(la,hb)=>{hb.WacTaskPaneInfra=K.a.gd(la);hb.TaskpanelessRFB=!0;hb.OfficeScriptsAutomateTask=x.a.Tzf;hb.DeferAdminCheck=x.a.jua;hb.SharedScriptsButton=Aa();hb.OAuthManagerAPI=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)},Aa=()=>Y.EwaSettings.getBooleanFeatureGate(x.a.KCj,!1),Q=(la,hb)=>{W(la)&&(Y.EwaSettings.getBooleanFeatureGate(x.a.ema,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(la.ya.UserSessionId);
makerstorage.setUserAccessInfo(new P(hb,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")},fa=la=>{if(W(la))return Y.EwaSettings.getBooleanFeatureGate(x.a.ema,!1)?"makerservicelocal":"localstorage";la=x.a.BLa();return x.a.kyb(la)},Ca=(la,hb,Kb,dc,sb)=>{const bb=la.userOperationManager,Ob=la.pa;let gc=null,mb=null,Nb=null;const ic=()=>{if(bb.Dta()||0<Ob.xa.iV||0<Ob.Ok.iV)return!1;gc&&bb.oo(gc);mb&&Ob.Lr(mb);Nb&&Ob.kx(Nb);bb.oD(new aa.a(507,0,(gb,Eb,Lc)=>U.g(Ob.xa,"ExecuteRichApiRequest",
dc,na.b(gb,hb),na.a(Eb,Kb),Lc,null,0),80));return!0};ic()||(gc=()=>{ic()},mb=()=>{ic()},Nb=()=>{ic()},bb.tr(gc),Ob.Mq(mb),Ob.mw(Nb));return sb.task},ia=la=>{la=la.pa.xa.Oa(1);la.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return la},Ra=la=>K.a.gd(la)?la.isChromeRtl?C.a.RTe:C.a.QTe:C.a.fKa,Ya=la=>K.a.gd(la)?C.a.Gbd:C.a.Fbd;class Ga{constructor(la,
hb){this.automateCommandManager=la;this.$=hb}Ofd(la){const hb=this.automateCommandManager.Va.gq().NC();if(!Aa()){var Kb=Ga.eD(la,J.a.instance.ga(2133));this.JGa(Kb,x.a.LFd,this.automateCommandManager.Od,x.a.DCd,J.a.instance.ga(2129),this.automateCommandManager.Va);hb.MenuSectionList.push(Kb)}Kb=Ga.eD(la,J.a.instance.ga(2134));this.JGa(Kb,x.a.cBd,x.a.Vw?this.automateCommandManager.Uh.Ovb(this.automateCommandManager.Od):this.automateCommandManager.ug.Ovb(this.automateCommandManager.Od),x.a.NFb,J.a.instance.ga(2130),
this.automateCommandManager.Va);hb.MenuSectionList.push(Kb);Kb=Ga.eD(la,J.a.instance.ga(2135));this.JGa(Kb,x.a.xQd,this.automateCommandManager.Vk,x.a.NFb,"",this.automateCommandManager.Va);hb.MenuSectionList.push(Kb);Kb=Object(l.a)(new M.a,{Id:x.a.rpb,ExternalId:x.a.rpb,Command:"1606046412",LabelText:J.a.instance.ga(2126),Alt:J.a.instance.ga(2127),Image16by16:G.a.de(16),Image16by16Class:C.a.Kbd,Visible:!0});la=Ga.eD(la,null);la.ControlsId="myScriptsSection.Controls";if(Aa()){const dc=Object(l.a)(new M.a,
{Id:x.a.iUd,ExternalId:x.a.iUd,Command:"1043696663",LabelText:J.a.instance.ga(2136),Alt:J.a.instance.ga(2136),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});la.ControlList.push(dc)}la.ControlList.push(Kb);hb.MenuSectionList.push(la);return hb}JGa(la,hb,Kb,dc,sb,bb){if(Kb&&0<Kb.length){hb=bb.$A(hb,1,"Size150by20").Tqb();sb={};bb={};bb.root=Ga.yZ(320,30);bb.flexContainer=Ga.O6c(!1);bb.label=Ga.g7c(!1);sb.galleryButtonInExpanded=bb;hb.GalleryStyle=sb;for(sb=0;sb<Kb.length&&sb<dc;sb++)bb=Kb.Iw(sb),
hb.GalleryItems.push(Ga.SIa(bb.id,bb));la.ControlList.push(hb)}else Kb=Object(l.a)(new L.a,{Id:hb,ExternalId:hb,LabelText:sb}),la.ControlsId=Kb.Id+".Controls",la.ControlList.push(Kb)}static aMh(la){if(la){const hb=String.format(x.a.mgf,la.isShared?x.a.Agg:x.a.b2f,G.a.de(16));la=String.format(x.a.ngf,T.a.rg(la.name));return String.format(x.a.lgf,hb,la)}return""}static eD(la,hb){return Object(l.a)(new S.a,{Id:la,Title:hb,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,
ControlList:[]})}static SIa(la,hb){const Kb=x.a.s0d,dc=x.a.SQd,sb=x.a.t0d,bb=x.a.TQd;return hb?Ga.etb(hb.shareId||hb.id,"1904816141",hb.name,hb.isShared&&!Aa()?Kb:dc,la,la,hb.isShared&&!Aa()?sb:bb):Ga.etb("","1904816141","","",la,la)}static etb(la,hb,Kb,dc,sb=null,bb=null,Ob=null){const gc={},mb={};gc.root=Ga.yZ(20,20);mb.root=Ga.yZ(20,20);return Object(l.a)(new H.a,{Id:la,ExternalId:sb||la,MenuItemId:bb||la,Command:hb,Icon:dc,Image:G.a.de(16),ImageClass:Ob,LabelText:Kb,FullIconStyle:gc,PreviewIconStyle:mb,
Alt:Kb})}static O6c(la){const hb={display:"flex"};la?hb.flexDirection="column":(hb.height="100%",hb.flexWrap="nowrap",hb.justifyContent="left",hb.alignItems="left",hb.lineHeight="normal");return hb}static g7c(la){const hb={margin:"0px 3px"};la&&(hb["max-width"]="68px");return hb}static yZ(la,hb){const Kb={};Kb.width=la;Kb["min-width"]=la;Kb.height=hb;return Kb}}Object(t.a)(Ga,"AutomateCommandRenderer",null,[]);class da{constructor(la,hb){this.scripts=la;this.LOb=hb}get length(){return this.scripts.length}yN(la){for(let hb=
0;hb<this.scripts.length;hb++)if(this.scripts[hb].id===la||this.scripts[hb].shareId===la)return hb;return-1}sort(){this.LOb(this.scripts)}Mh(la){return-1===this.yN(la.id)?(this.scripts.push(la),!0):!1}IGa(la){return-1===this.yN(la.id)?(this.scripts=[la].concat(this.scripts),!0):!1}PAd(la){la=this.yN(la.id);if(-1!==la){for(var hb=this.scripts[la].wU();0<la;)this.scripts[la]=this.scripts[la-1],la--;this.scripts[0]=hb}}OX(la){const hb=this.yN(la.id);if(-1!==hb){const Kb=this.scripts[hb].shareId;this.scripts[hb]=
la;this.scripts[hb].shareId=Kb}}DBb(la){const hb=this.yN(la.id);return-1!==hb?la.name===this.scripts[hb].name:!1}PU(la){la=this.yN(la);return-1!==la?(this.scripts.splice(la,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}Um(la){la=this.yN(la);return-1!==la?this.scripts[la]:null}Iw(la){return 0<=la&&this.length>la?this.scripts[la]:null}Ovb(la){const hb=new da([],this.LOb);for(let Kb=0;Kb<this.scripts.length;Kb++){const dc=this.scripts[Kb];la.Um(dc.id)||hb.Mh(dc)}return hb}KX(){const la=
[];for(const hb of this.scripts)la.push(hb.jgb());return la}}Object(t.a)(da,"ScriptCollection",null,[]);var Z=a(193);class ha{constructor(la){this.wz=Z.b(la)||{};this.shareId=this.shareId||null}get id(){return this.wz.id}get shareId(){return this.wz.shareId}set shareId(la){this.wz.shareId=la||null}get name(){return this.wz.name}get Rtb(){return this.wz.dateLastPublished}get body(){return this.wz.body}get description(){return this.wz.description}get LAb(){return this.wz.isCreator}get isShared(){return!!this.shareId&&
0<this.shareId.length}wU(){return new ha(this.wz)}jgb(){return this.wz}}Object(t.a)(ha,"ScriptCore",null,[]);var Wa=a(41);class ca extends I{constructor(la,hb){super();this.$=la;this.Se=hb}MLa(la){switch(la){case "1":case "2":case "3":case "4":case "5":case "6":return this.Ru.Iw(parseInt(la,10)-1);default:return this.Se.Uh.Um(la)||this.Se.ug.Um(la)||this.Se.Od.Um(la)||this.Se.Vk.Um(la)}}vLa(la,hb){let Kb=null;if(this.Se.HV)switch(la){case "1":case "2":case "3":case "4":case "5":case "6":Kb=this.Ru.Iw(parseInt(la,
10)-1);break;default:Kb=this.Ru.Um(la)}K.a.isReactRibbonEnabled()?hb[D.a.GalleryButtonProps]=Ga.SIa(la,Kb):hb[D.a.InnerHTML]=Ga.aMh(Kb);hb[D.a.Alt]=Kb?Kb.name:""}Qp(la){this.Ru=this.lRa();this.$.af();const hb=[];hb.push(Object(l.a)(new A.a,{name:"Operation",string:la}));hb.push(Object(l.a)(new A.a,{name:"HasReadRecentCachedScripts",bool:this.Se.Hka}));hb.push(Object(l.a)(new A.a,{name:"ReadScriptsDone",bool:this.Se.qMa}));hb.push(Object(l.a)(new A.a,{name:"ReadSamplesScriptsDone",bool:this.Se.p7}));
hb.push(Object(l.a)(new A.a,{name:"SamplesScriptCount",int64:this.Se.Vk.length}));hb.push(Object(l.a)(new A.a,{name:"ReadRecentScriptsDone",bool:this.Se.YW}));hb.push(Object(l.a)(new A.a,{name:"RecentScriptCount",int64:this.Se.Uh.length}));hb.push(Object(l.a)(new A.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ps}));hb.push(Object(l.a)(new A.a,{name:"WorkbookScriptCount",int64:this.Se.Od.length}));z.a(r.a.ipc,!0,0,hb)}lMa(la){let hb=!1,Kb="";const dc=new ha(la.scriptMetadata),sb={Operation:"HandleRefreshRibbonGallery"};
sb.RefreshOperation=la.operationName;switch(la.operationName){case x.a.MJb:({message:Kb,returnValue:hb}=this.kMa(dc));break;case x.a.KJb:({message:Kb,returnValue:hb}=this.iMa(dc));break;case x.a.JJb:({message:Kb,returnValue:hb}=this.hMa(dc));break;case x.a.LJb:({message:Kb,returnValue:hb}=this.jMa(dc));break;case x.a.CLd:({message:Kb,returnValue:hb}=this.Zld(dc))}(sb.GalleryUpdated=hb)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${Kb}`),this.Qp("RefreshGallery")):
c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${Kb}`);sb.Message=Kb;c.ULS.sendTraceTag(537170320,0,50,Wa.c(sb))}lRa(){const la=new da([],()=>{}),hb=this.Se.Od?this.Se.Od.length:0,Kb=this.Se.Uh?this.Se.Uh.length:0,dc=this.Se.Vk?this.Se.Vk.length:0;let sb=0,bb=x.a.NIb;for(let Ob=0;Ob<bb;Ob++)if(Ob<hb)la.Mh(this.Se.Od.Iw(Ob));else if(Ob-hb+sb<Kb){const gc=this.Se.Uh.Iw(Ob-hb+sb);this.Se.Od.Um(gc.id)?(sb++,Ob--):la.Mh(gc)}else Ob-
hb-Kb+sb<dc&&la.Mh(this.Se.Vk.Iw(Ob-hb+sb-Kb));return la}kMa(la){let hb;if(this.Se.Uh.IGa(la))hb="";else{hb="";const Kb=la.wU();this.Se.Od.OX(Kb);this.Se.Od.sort();this.Se.Uh.OX(la)}return{returnValue:!0,message:hb}}iMa(la){this.Se.Od.PU(la.id);return this.Se.Uh.PU(la.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}hMa(la){const hb=la.wU();hb.shareId=null;this.Se.Uh.IGa(hb);return this.Se.Od.Mh(la)?(this.Se.Od.sort(),
{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}jMa(la){return this.Se.Od.PU(la.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Zld(la){const hb=la.wU();let Kb=!1;this.Se.Od.DBb(hb)&&(this.Se.Od.OX(hb),this.Se.Od.sort(),Kb=!0);this.Se.Uh.IGa(la)?Kb=!0:this.Se.Uh.DBb(la)&&(this.Se.Uh.OX(la),this.Se.Uh.PAd(la),Kb=!0);return{returnValue:Kb,message:""}}}Object(t.a)(ca,
"AutomateCommandGallery",I,[]);var ja=a(82);class ua{constructor(){this.Mo=null}}Object(t.a)(ua,"AutomateCommandLicensingBase",null,[]);class Za{constructor(la,hb,Kb=null,dc="",sb=""){this.value=la;this.isSuccess=hb;this.timeStamp=Kb;this.errorCode=dc;this.errorMessage=sb}}Object(t.a)(Za,"BoolResultWrapper",null,[]);class Pa extends ua{constructor(){super()}ota(){const la=v.a.Sa.zb,hb=[];return new Promise(Kb=>{ja.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>
{dc.isFeatureEnabled("ExcelOfficeScripting",!1).then(sb=>{hb.push(Object(l.a)(new A.a,{name:"IsLicensed",bool:sb}));z.a(r.a.epc,!0,u.getElapsedMilliseconds(la,v.a.Sa.zb),hb);this.Mo=new Za(sb,!0);Kb(sb)}).catch(sb=>{hb.push(Object(l.a)(new A.a,{name:"IsLicensed",bool:!1}));hb.push(Object(l.a)(new A.a,{name:"Error",string:sb.toString()}));hb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:"exception"}));z.a(r.a.epc,!1,u.getElapsedMilliseconds(la,v.a.Sa.zb),hb);this.Mo=new Za(!1,!1,void 0,"exception",
sb.toString());Kb(!1)})})})}}Object(t.a)(Pa,"AutomateCommandLicensing",ua,[]);var ka=a(1307),ra=a(1305),ba=a(1304),Ua=a(1306),Ka=a(1395),Oa=a(27),ib=a(171),La=a(571),db=a(239),Ab=a(5);class Mb{constructor(la,hb,Kb,dc){this.I6a=la;this.wac=hb;this.xW=Kb;this.tZ=dc}}Object(t.a)(Mb,"LaunchSDXParams",null,[]);class pb{constructor(la,hb,Kb,dc,sb,bb){this.actionName=la;this.shapeId=hb;this.scriptLink=Kb;this.clickId=dc;this.sR=sb;this.buttonText=bb}}Object(t.a)(pb,"RunfromButtonParameters",null,[]);var Qb=
a(161),xb=a(58),pa=a(753),Ma=a(51),ya=a(42),Ea=a(137);class Na{constructor(la,hb,Kb,dc,sb,bb,Ob,gc,mb){this.PA=null;this.cache=new db.a;this.G_=!1;this.HM={};this.$=la;this.Mmb=Kb;this.indexedDB=dc;this.wqb=sb;this.rv=bb;this.Kha=Ob;this.Se=gc;this.IC=mb;this.hVg=new Ga(this,la);this.rNc=v.a.Sa.zb;this.aPb="";dc.Zd()&&(this.G_=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));la=!0;if(Oa.a.P0c){this.cache.Zd()&&!x.a.jua&&(hb=this.Se.W1e(x.a.dLa(this.$)),hb.isSuccess&&(la=u.getElapsedSeconds(hb.timeStamp,
v.a.Sa.zb),this.rv.Mo=new Za(!0,!0),this.PA=new Za(hb.value,!0),la=this.PA.value?604800<la:86400<la,this.Xyb=this.GTa(!0)));this.cgd();if("undefined"!==typeof makerstorage&&this.Z8a)if(this.aPb=fa(this.$),W(this.$))Q(this.$,"localstorageToken"),this.rv.Mo=new Za(!0,!0),this.PA=new Za(!0,!0),this.Xyb=this.GTa(!0);else if((hb=x.a.BLa())&&makerstorage.setStorageEnvironmentOverride(hb),la||x.a.jua)try{this.$.yeb("automateTab",!0),this.Xyb=x.a.jua?this.rv.ota().then(()=>this.Kha.lba()).then(()=>this.GTa(!1)).catch(()=>
this.GTa(!1)):this.rv.ota().then(()=>this.Kha.lba()).then(Nb=>this.fai(Nb)).then(()=>this.GTa(!1)).catch(()=>this.GTa(!1))}catch(Nb){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Nb.message}`),this.Xyb=Promise.resolve(!1),this.$.yeb("automateTab",!1)}this.Xyb?this.Xyb.then(Nb=>{this.lOd(Nb);this.Se.ykd()}):this.lOd(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),
this.lOd(!1)}get ug(){return this.Se.ug}get Od(){return Aa()?new da([],()=>{}):this.Se.Od}get Vk(){return this.Se.Vk}get Uh(){return this.Se.Uh}get Va(){return this.Mmb}get HV(){return this.Se.HV}get initTime(){return this.rNc}get sR(){const la=!!this.rv.Mo&&this.rv.Mo.isSuccess&&this.rv.Mo.value;var hb=!!this.PA&&!this.PA.isSuccess;const Kb=!!this.PA&&this.rv.Mo.isSuccess&&this.PA.value;hb=x.a.jua||Kb||hb&&!Oa.a.gca(11);return this.Z8a&&la&&hb}get Z8a(){const la="TestHost"===this.$.ya.DocumentHostInfo.HostTier;
var hb=w.AFrameworkApplication.fa.Xa("UserPrincipalName");hb=!w.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!hb&&!hb.includes("ext#")&&!hb.includes("guest#");return!Oa.a.H5&&(la||this.Kha.qqb&&hb)}GTa(la){const hb=w.AFrameworkApplication.fa.qa("IsO365CommercialHost");let Kb="",dc="",sb=!1;var bb,Ob=(bb=this.rv.Mo&&this.rv.Mo.isSuccess)&&this.rv.Mo.value;bb=x.a.jua?bb:!(Ob&&(!this.PA||!this.PA.isSuccess));this.rv.Mo&&!this.rv.Mo.isSuccess?(dc=this.rv.Mo.errorCode,Kb=this.rv.Mo.errorMessage):this.PA&&
!this.PA.isSuccess&&(dc=this.PA.errorCode,Kb=this.PA.errorMessage);Ob=[];Ob.push(Object(l.a)(new A.a,{name:"IsScriptingEnabled",bool:this.sR}));Ob.push(Object(l.a)(new A.a,{name:"IsValidHost",bool:hb}));Ob.push(Object(l.a)(new A.a,{name:"IsUserLicensed",bool:this.rv.Mo?this.rv.Mo.value:!1}));x.a.jua||Ob.push(Object(l.a)(new A.a,{name:"IsAdminSwitchOn",bool:this.PA?this.PA.value:!1}));Ob.push(Object(l.a)(new A.a,{name:"ShowTab",bool:this.sR}));x.a.jua||Ob.push(Object(l.a)(new A.a,{name:"ServiceChecked",
bool:!la}));this.sR?K.a.Nxa(this.$)&&(la=Qb.a(this.$),(null===la||void 0===la?0:la.Qn)?(Ob.push(Object(l.a)(new A.a,{name:"RibbonType",string:"React"})),la.Qn.PIj(Ab.a.Gda),la.Qn.wTd(["AutomateAutomateTask"],!x.a.Tzf&&!x.a.jBd),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(sb=!0)):(dc="ribbon_manager_error",Kb="The RibbonManager or RibbonUser is null")):this.aci();
Ob.push(Object(l.a)(new A.a,{name:"Error",string:Kb}));Ob.push(Object(l.a)(new A.a,{name:"ErrorCode",string:dc}));z.a(r.a.jMi,bb,u.getElapsedMilliseconds(this.initTime,v.a.Sa.zb),Ob);this.$.yeb("automateTab",!1);return Promise.resolve(sb)}Lc(la,hb){if(!hb)return!1;hb.MenuItems=this.hVg.Ofd(hb.MenuId);return!0}KHd(){this.G_&&(x.a.Vw?this.Se.vJb(this.IC).continueWith(la=>{la.result&&this.IC.Qp(x.a.FO)}):this.Se.UKd(this.IC));W(this.$)?this.fyb(Object(l.a)(new B.a,{IsSuccess:!0,Token:"FakeToken"})):
this.Kha.lba().then(la=>{this.fyb(la)})}vLa(la,hb,Kb){if(x.a.Vw)this.IC.vLa(la,hb,Kb);else{Kb=null;if(this.Se.HV)switch(la){case "1":case "2":case "3":case "4":case "5":case "6":Kb=this.IC.Ru.Iw(parseInt(la,10)-1);break;default:Kb=this.IC.Ru.Um(la)}hb[D.a.GalleryButtonProps]=Ga.SIa(la,Kb);hb[D.a.Alt]=Kb?Kb.name:""}}lMa(la){if(x.a.Vw)this.IC.lMa(la);else{let hb=!1,Kb="";const dc=new ha(la.scriptMetadata),sb={Operation:"HandleRefreshRibbonGallery"};sb.RefreshOperation=la.operationName;switch(la.operationName){case x.a.MJb:({message:Kb,
returnValue:hb}=this.kMa(dc));break;case x.a.KJb:({message:Kb,returnValue:hb}=this.iMa(dc));break;case x.a.JJb:({message:Kb,returnValue:hb}=this.hMa(dc));break;case x.a.LJb:({message:Kb,returnValue:hb}=this.jMa(dc))}(sb.GalleryUpdated=hb)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${Kb}`),this.Qp("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${Kb}`);
sb.Message=Kb;c.ULS.sendTraceTag(537170311,0,50,Wa.c(sb))}}bmd(la,hb,Kb,dc){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.aq(null,!1,1023))la=new pb(x.a.RLb,la,hb,Kb,this.sR,dc),this.wqb.Cwa(la)}Hyb(la,hb,Kb){la=new pb(x.a.F3d,la,hb,Kb,this.sR);this.wqb.Cwa(la)}Bld(la){this.wqb.fMa(x.a.KWd,la)}Ald(la){this.wqb.fMa(x.a.w5c,la)}Cld(la){this.wqb.fMa(x.a.tYd,la)}jmc(la,hb){var Kb=Ma.b().tj(la);const dc=[];dc.push(Object(l.a)(new A.a,{name:"SessionId",string:this.$.ya.UserSessionId}));
x.a.jBd||(dc.push(Object(l.a)(new A.a,{name:"MenuItemId",string:hb})),dc.push(Object(l.a)(new A.a,{name:"WorkbookScriptCount",int64:this.Od.length})),dc.push(Object(l.a)(new A.a,{name:"PublishedScriptCount",int64:this.ug.length})),dc.push(Object(l.a)(new A.a,{name:"RecentScriptCount",int64:this.Uh.length})),dc.push(Object(l.a)(new A.a,{name:"Command",string:Kb})));hb=this.Qjd(la,hb);if(Kb=this.G8f(la)?this.NXh():this.Bid(la,Kb,hb))this.G8f(la)?(ka.a.instance.h6(Kb.wac,"Taskpane",Kb.tZ,Kb.I6a,Kb.xW),
z.a(r.a.BOf,void 0,void 0,dc)):(dc.push(Object(l.a)(new A.a,{name:x.a.WC,string:Kb.xW.Dh[x.a.WC]})),ka.a.instance.h6(Kb.wac,"Taskpane",Kb.tZ,Kb.I6a,Kb.xW),1904816141===la&&(dc.push(Object(l.a)(new A.a,{name:"ScriptId",string:hb.id})),dc.push(Object(l.a)(new A.a,{name:"ShareId",string:hb.shareId})),dc.push(Object(l.a)(new A.a,{name:"IsPreviewGallery",bool:!!this.IC.Ru.Um(hb.id)})),dc.push(Object(l.a)(new A.a,{name:"IsOwner",bool:hb.LAb||!!this.ug.Um(hb.id)})),this.$.af()),z.a(r.a.Qzf,void 0,void 0,
dc))}NXh(){const la=new ra.a(x.a.Twa,x.a.vva,x.a.locale),hb=new ba.a(x.a.BGd,OSF.StoreType.Sdx,OSF.StoreType.Sdx,x.a.CGd),Kb=new Ua.a;Kb.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.Vxb(this.$);return new Mb(la,hb,Kb,null)}Bid(la,hb,Kb){let dc=null;const sb=x.a.yq,bb=new ra.a(x.a.Twa,x.a.vva,x.a.locale),Ob=new ba.a(x.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,x.a.DSa),gc=new Ua.a;gc.Dh.AdminPolicyForFeedback=Wa.c(this.HM);gc.Dh.DocumentHostInfo=xb.a.fc(this.$.ya.DocumentHostInfo);
gc.Dh.CodeEditorUrl=x.a.K4(this.$);gc.Dh.MakerTestService=Y.EwaSettings.getBooleanFeatureGate(x.a.ema,!1);gc.Dh[x.a.FLb]=x.a.sV(this.$);gc.Dh.StorageModePreference=this.aPb||"";gc.Dh.Source="Ribbon";gc.Dh[x.a.EPb]=xb.a.fc(sb);gc.Dh[x.a.Hqb]=this.$.dpc?"true":"false";gc.Dh[x.a.WC]=ib.a.create().toString();var mb=Ra(this.$);const Nb=Ya(this.$);gc.optionalProperties.HeaderCssClass=mb;gc.optionalProperties.TitleCssClass=Nb;gc.Dh[x.a.gzb]=mb;gc.Dh[x.a.aQb]=Nb;mb={};mb.ribbonCommand=hb;mb[x.a.ZOb]=this.Kha.getAuthContext();
mb[x.a.QW]=this.Se.uJb?this.ug.KX():null;mb[x.a.n4d]=this.Se.fRa?this.Od.KX():null;x.a.Vw&&(mb[x.a.FO]=this.Se.eRa?this.Uh.KX():null);gc.Dh[x.a.sAb]=xb.a.fc(mb);hb={};X(this.$,hb);gc.Dh[x.a.bwb]=xb.a.fc(hb);switch(la){case -45542983:gc.Dh.Script="";gc.Dh.Destination="Editor";gc.Dh.IsOwner=!0;gc.optionalProperties[Ka.a.ij]=J.a.instance.ga(2122);gc.optionalProperties[Ka.a.taskPaneWidth]=sb;gc.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.K4(this.$);dc=x.a.wta;break;case -1342227603:gc.optionalProperties[Ka.a.ij]=
J.a.instance.ga(2124);gc.optionalProperties[Ka.a.taskPaneWidth]=sb;gc.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.Vxb(this.$);break;case 971811139:case 1606046412:gc.Dh.Script="";gc.Dh.Destination="BackStage";gc.Dh.IsOwner=!0;gc.optionalProperties[Ka.a.ij]=J.a.instance.ga(2122);gc.optionalProperties[Ka.a.taskPaneWidth]=sb;gc.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.K4(this.$);dc=x.a.wta;break;case 1043696663:gc.Dh.Script="";gc.Dh.Destination="BackStage_Workbook";
gc.optionalProperties[Ka.a.ij]=J.a.instance.ga(2122);gc.optionalProperties[Ka.a.taskPaneWidth]=sb;gc.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.K4(this.$);dc=x.a.wta;break;case 1845457202:gc.optionalProperties[Ka.a.ij]=J.a.instance.ga(2123);gc.optionalProperties[Ka.a.taskPaneWidth]=sb;gc.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.jec(this.$);dc=x.a.VQd;break;case -2126202430:case 1623358083:case 1904816141:if(Kb)gc.Dh.Script=xb.a.fc(Kb.jgb()),gc.Dh.Destination=
"Details",gc.Dh.IsOwner=Kb.LAb||!!this.ug.Um(Kb.id),gc.optionalProperties[Ka.a.ij]=J.a.instance.ga(2122),gc.optionalProperties[Ka.a.taskPaneWidth]=sb,gc.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.K4(this.$),dc=x.a.wta;else return null;break;default:return null}return new Mb(bb,Ob,gc,dc)}Qjd(la,hb){switch(la){case -2126202430:la=this.Se.f8.Um(x.a.JPb);break;case 1623358083:la=this.Se.f8.Um(x.a.KPb);break;default:la=hb?this.MLa(hb):null}return la}cgd(){ja.a.instance.Rb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(la=>
{this.HM.FeedbackEnabled=!0;this.HM.ScreenshotEnabled=!0;this.HM.EmailEnabled=!0;la.xF("Enabled").then(hb=>{this.HM.FeedbackEnabled=hb},()=>{});la.xF("IncludeScreenshot").then(hb=>{this.HM.ScreenshotEnabled=hb},()=>{});la.xF("IncludeEmail").then(hb=>{this.HM.EmailEnabled=hb},()=>{})})}fai(la){const hb=v.a.Sa.zb,Kb=[];if(!la||!la.IsSuccess){const dc=la?la.ErrorCode:"need_token";la=la?la.ErrorMessage:"No Access Token";Kb.push(Object(l.a)(new A.a,{name:"ServiceChecked",bool:!1}));Kb.push(Object(l.a)(new A.a,
{name:"Error",string:la}));Kb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:dc}));z.a(r.a.QCd,!1,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.PA=new Za(!1,!1,void 0,dc,la);return Promise.resolve(!1)}Kb.push(Object(l.a)(new A.a,{name:"ServiceChecked",bool:!0}));Q(this.$,la.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(dc=>{this.PA=new Za(dc.OfficeScriptingEnabled,!0);this.Se.BAe(x.a.dLa(this.$),dc.OfficeScriptingEnabled);Kb.push(Object(l.a)(new A.a,{name:"IsEnabled",
bool:this.PA.value}));z.a(r.a.QCd,!0,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);return Promise.resolve(this.PA.value)}).catch(dc=>{Object.getType(dc)===makerstorage.StorageServiceError?(Kb.push(Object(l.a)(new A.a,{name:"Error",string:dc.message})),Kb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:`makerstorage_${dc.errorCode.toString()}_${dc.status.toString()}`}))):(Kb.push(Object(l.a)(new A.a,{name:"Error",string:dc.toString()})),Kb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:"exception"})));
z.a(r.a.QCd,!1,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.PA=new Za(!1,!1,void 0,"exception",dc.toString());return Promise.resolve(!1)})}fyb(la){this.Se.Njd(this.IC);x.a.Vw?this.Se.Ejd(la,this.IC,this.cache):this.wjd(la);Aa()||this.Se.TKd(hb=>{this.Se.$jd(hb,la,this.IC)},this.IC)}wjd(la){const hb=v.a.Sa.zb,Kb=[];if(la&&la.IsSuccess){Q(this.$,la.Token);var dc=La.a.create().toString();Kb.push(Object(l.a)(new A.a,{name:"CorrelationId",string:dc}));makerstorage.getScripts(dc).then(sb=>{Kb.push(Object(l.a)(new A.a,
{name:"HasReadCachedScripts",bool:this.Se.e5}));this.ug.clear();for(const bb of sb)this.ug.Mh(new ha(bb));this.ug.sort();this.Se.uJb=!0;this.Se.XW=!0;this.G_&&(sb=xb.a.fc(this.ug.KX()),this.indexedDB.Ona(new pa.a(x.a.QW,sb)));Kb.push(Object(l.a)(new A.a,{name:"ScriptCount",int64:this.ug.length}));z.a(r.a.Tca,!0,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.Qp(x.a.QW)}).catch(sb=>{Object.getType(sb)===makerstorage.StorageServiceError?(Kb.push(Object(l.a)(new A.a,{name:"Error",string:sb.message})),
Kb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:`makerstorage_${sb.errorCode.toString()}_${sb.status.toString()}`})),17===sb.errorCode&&this.cache.iKb(x.a.dLa(this.$))):(Kb.push(Object(l.a)(new A.a,{name:"Error",string:sb.toString()})),Kb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:"exception"})));z.a(r.a.Tca,!1,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.Se.XW=!0;this.Qp(x.a.QW)})}else dc=la?la.ErrorCode:"need_token",la=la?la.ErrorMessage:"No Access Token",Kb.push(Object(l.a)(new A.a,
{name:"ServiceChecked",bool:!1})),Kb.push(Object(l.a)(new A.a,{name:"Error",string:la})),Kb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:dc})),z.a(r.a.Tca,!1,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb),this.Se.XW=!0,this.Qp(x.a.QW)}MLa(la){if(x.a.Vw)return this.IC.MLa(la);switch(la){case "1":case "2":case "3":case "4":case "5":case "6":return this.IC.Ru.Iw(parseInt(la,10)-1);default:return this.ug.Um(la)||this.Od.Um(la)||this.Vk.Um(la)}}kMa(la){let hb;if(this.ug.Mh(la))this.ug.sort(),hb="";else{hb=
"";const Kb=la.wU();this.Od.OX(Kb);this.Od.sort();this.ug.OX(la);this.ug.sort()}return{returnValue:!0,message:hb}}iMa(la){this.Od.PU(la.id);return this.ug.PU(la.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}hMa(la){const hb=la.wU();hb.shareId=null;this.ug.Mh(hb)&&this.ug.sort();return this.Od.Mh(la)?(this.Od.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}jMa(la){return this.Od.PU(la.id)?
{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Qp(la){if(x.a.Vw)this.IC.Qp(la);else{this.lRa();this.$.af();const hb=[];hb.push(Object(l.a)(new A.a,{name:"Operation",string:la}));hb.push(Object(l.a)(new A.a,{name:"HasReadCachedScripts",bool:this.Se.e5}));hb.push(Object(l.a)(new A.a,{name:"ReadScriptsDone",bool:this.Se.qMa}));hb.push(Object(l.a)(new A.a,{name:"ReadSamplesScriptsDone",bool:this.Se.p7}));hb.push(Object(l.a)(new A.a,
{name:"SamplesScriptCount",int64:this.Vk.length}));hb.push(Object(l.a)(new A.a,{name:"ReadPublishedScriptsDone",bool:this.Se.XW}));hb.push(Object(l.a)(new A.a,{name:"PublishedScriptCount",int64:this.ug.length}));hb.push(Object(l.a)(new A.a,{name:"ReadWorkbookScriptsDone",bool:this.Se.Ps}));hb.push(Object(l.a)(new A.a,{name:"WorkbookScriptCount",int64:this.Od.length}));z.a(r.a.ipc,!0,0,hb)}}lRa(){this.IC.Ru=new da([],()=>{});const la=this.Od?this.Od.length:0,hb=this.ug?this.ug.length:0,Kb=this.Vk?
this.Vk.length:0;let dc=0;const sb=x.a.NIb;for(let bb=0;bb<sb;bb++)if(bb<la)this.IC.Ru.Mh(this.Od.Iw(bb));else if(bb-la+dc<hb){const Ob=this.ug.Iw(bb-la+dc);this.Od.Um(Ob.id)?(dc++,bb--):this.IC.Ru.Mh(Ob)}else bb-la-hb+dc<Kb&&this.IC.Ru.Mh(this.Vk.Iw(bb-la+dc-hb))}lOd(la){Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(la?(ya.PageLoadTrackingInfo.instance.K0(Ab.a.MO,
["automateTab"]),ya.PageLoadTrackingInfo.instance.jS(Ab.a.MO,["automateTab"]),ya.PageLoadTrackingInfo.instance.fX(Ab.a.MO,["automateTab"])):ya.PageLoadTrackingInfo.instance.$da(Ab.a.MO,["automateTab"]))}aci(){Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Ea.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Ab.a.Gda))}G8f(la){return x.a.jBd&&-1342227603===la}}Object(t.a)(Na,"AutomateCommandManager",null,[508]);var kb=a(1362),lb=a(1309),oa=
a(250),Ba=a(860),sa=a(48),qb=a(104),Jb=a(21),Yb;(function(la){la.preparing="preparing";la.running="running";la.succeeded="succeeded";la.fetchFailed="fetchFailed";la.runFailed="runFailed";la.canceled="canceled";la.alreadyRunning="alreadyRunning";la.initializing="initializing"})(Yb||(Yb={}));Object(t.b)("OfficeScriptsRunStatus",Yb);class jb{constructor(la,hb,Kb,dc,sb,bb){this.scriptLink="";this.runStatus=Yb.preparing;this.clickId="";this.hasLogs=this.isOwner=this.buttonText=void 0;this.scriptLink=la;
this.runStatus=hb;this.clickId=Kb;this.buttonText=dc;this.isOwner=sb;this.hasLogs=bb}}Object(t.a)(jb,"OfficeScriptsBusinessBarParams",null,[]);class ab{constructor(la){this.shareId="";this.shareId=la}}Object(t.a)(ab,"OfficeScriptsShareLinkObject",null,[]);class vb{constructor(la,hb,Kb,dc){this.cW=!1;this.Vca=()=>{this.VNb()?(this.GIb(),Jb.h(this.$).Da.tKb(this.Vca)):this.cW&&Jb.h(this.$).Da.tKb(this.Vca)};this.JDd=(sb,bb)=>{Object.getType(bb)===String&&bb.toString().endsWith(x.a.pba(this.$))&&(this.cW=
!1)};this.$=la;this.Kha=hb;this.rv=Kb;this.businessBarManager=dc;this.cUd()}Cwa(la){if(la.sR){const hb=[];hb.push(Object(l.a)(new A.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.cW}));hb.push(Object(l.a)(new A.a,{name:"actionName",string:la.actionName}));hb.push(Object(l.a)(new A.a,{name:x.a.WC,string:la.clickId.toString()}));this.cW?this.zMb(la):this.Old(la);z.a(r.a.Rzf,void 0,void 0,hb)}}fMa(la,hb){const Kb={};Kb[x.a.WC]=hb;this.OSa(la,Kb)}cUd(){this.VNb()?this.GIb():Jb.h(this.$).Da.TXc(this.Vca)}VNb(){if(this.cW||
W(this.$))return!1;const la=qb.a(this.$);return Jb.h(this.$).Da.qpb&&la.Fhf()}GIb(){this.rv.Mo?this.rv.Mo.value&&this.Kha.lba():this.rv.ota().then(la=>{la&&this.Kha.lba()});z.a(r.a.Mzf)}MRd(){const la=ib.a.create().toString();var hb={};X(this.$,hb);const Kb={};Kb[x.a.ZOb]=this.Kha.getAuthContext();const dc={};dc[x.a.bwb]=xb.a.fc(hb);dc[x.a.sAb]=xb.a.fc(Kb);dc[x.a.f$c]=xb.a.fc(this.$.ya.DocumentHostInfo);dc[x.a.xYd]=fa(this.$);dc[x.a.EPb]=xb.a.fc(x.a.yq);dc[x.a.Hqb]=this.$.dpc?"true":"false";dc[x.a.FLb]=
x.a.sV(this.$);dc[x.a.gzb]=Ra(this.$);dc[x.a.aQb]=Ya(this.$);dc[x.a.WC]=la;hb=[];hb.push(Object(l.a)(new A.a,{name:x.a.WC,string:la}));z.a(r.a.Pzf,void 0,void 0,hb);this.OSa(x.a.bpd,dc)}Old(la){this.VVd(la);W(this.$)&&Q(this.$,"localstorage");f.TaskExtensions.za(sa.GetServiceTaskFactory.Na(this.$.da,374,375,1),hb=>{this.mxd(hb.result).continueWith(()=>{this.LRd(la)});this.cW=!0},this.$.ka,3)}mxd(la){const hb={};hb.SolutionId=x.a.solutionId;hb.Version=x.a.DSa;hb.StoreType=OSF.StoreType.Sdx;hb.StoreId=
OSF.StoreType.Sdx;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(hb.AssetId=null,hb.AssetStoreId=null):(hb.AssetId=x.a.solutionId,hb.AssetStoreId=OSF.StoreType.Sdx);hb.TargetType=1;hb.SharedRuntimeId=x.a.pba(this.$);hb.SourceLocationOverrideResourceId=x.a.pba(this.$);hb.IsToBePersisted=!1;const Kb=new kb.a;Kb.ij=J.a.instance.ga(2146);Kb.taskPaneWidth=x.a.yq;const dc=new Ba.a;dc.NUa=Ya(this.$);dc.q_=Ra(this.$);return la.cMb(hb,Kb,void 0,void 0,dc)}LRd(la){this.MRd();
oa.a(this.$)&&oa.a(this.$).aYc(this.JDd);this.zMb(la)}zMb(la){const hb={};hb[x.a.rQd]=la.shapeId;hb[x.a.qQd]=la.scriptLink;hb[x.a.WC]=la.clickId.toString();hb[x.a.pQd]=la.buttonText;this.OSa(la.actionName,hb)}OSa(la,hb){const Kb=new ba.a(x.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,x.a.DSa),dc=new ra.a(x.a.Twa,x.a.vva,this.$.ya.UICultureTag),sb=new Ua.a;sb.optionalProperties[Ka.a.ij]=J.a.instance.ga(2146);sb.optionalProperties[Ka.a.sourceLocationOverrideResourceId]=x.a.pba(this.$);sb.optionalProperties[Ka.a.s_b]=
hb;sb.optionalProperties[Ka.a.taskPaneWidth]=x.a.yq;ka.a.instance.h6(Kb,lb.a.action,la,dc,sb)}VVd(la){la.actionName===x.a.RLb&&(la=new jb(la.scriptLink,"initializing",la.clickId.toString(),la.buttonText),this.businessBarManager.HXc(64,la))}}Object(t.a)(vb,"AutomateCommandRunFromButton",null,[507]);var Da=a(156),Fa=a(22);class nb{constructor(){this.Uh=null;this.e5=this.p7=this.Ps=this.XW=this.fRa=this.uJb=this.eRa=this.YW=this.Hka=!1;this.f8=this.Vk=this.Od=this.ug=null}get HV(){const la=x.a.Vw?this.Hka:
this.e5;return this.p7||la||this.qMa}get qMa(){return(x.a.Vw?this.YW:this.XW)&&this.Ps&&this.p7}static AXd(la){la.sort((hb,Kb)=>Kb.Rtb-hb.Rtb)}static Doa(la){la.sort((hb,Kb)=>Fa.a.compare(hb.name,Kb.name,!0))}static lkd(la){let hb,Kb;Kb=hb=null;if(la){const dc=la.indexOf(":");if(-1!==dc)return hb=la.substr(0,dc),Kb=la.substr(dc+1),{returnValue:!0,$Ob:hb,shareId:Kb}}return{returnValue:!1,$Ob:hb,shareId:Kb}}static Vjd(la,hb){const Kb={};Kb[x.a.iSb]=encodeURIComponent(la.workbookContext.WorkbookFileName);
Kb[x.a.hMb]=hb.KX();return Wa.c(Kb)}static wJb(la,hb){return f.TaskExtensions.WJ(hb.jba(x.a.ypa),Kb=>{Kb=Kb.result;if(""!==Kb){var dc=Wa.b(Kb);Kb=dc[x.a.hMb];if(dc[x.a.iSb]===encodeURIComponent(la.workbookContext.WorkbookFileName)){dc=new da([],sb=>{nb.Doa(sb)});for(const sb of Kb)dc.Mh(new ha(sb));dc.sort();return dc}}},la.ka,3)}}Object(t.a)(nb,"AutomateCommandStorageBase",null,[]);var Ta=a(116),V=a(99);class va extends nb{constructor(la,hb){super();this.$=la;this.Bua=new DOMParser;this.cache=new db.a;
this.indexedDB=hb;hb.Zd()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.e5=!1;this.ug=new da([],Kb=>{nb.AXd(Kb)});this.Od=new da([],Kb=>{nb.Doa(Kb)});this.Vk=new da([],Kb=>{nb.Doa(Kb)});this.Uh=new da([],()=>{});this.f8=new da([],Kb=>{nb.Doa(Kb)})}BAe(la,hb){if(this.cache.Zd()){const Kb={};Kb.TimeStamp=v.a.Sa.zb;Kb.IsEnabled=hb;this.cache.lNb(la,xb.a.fc(Kb))}}W1e(la){let hb=!1,Kb=!1,dc=null;this.cache.Zd()&&(la=Wa.b(this.cache.zLa(la)))&&(Kb=la.IsEnabled,dc=new Date(la.TimeStamp),
hb=!0);return new Za(Kb,hb,dc)}vJb(la){const hb=v.a.Sa.zb,Kb=[];return f.TaskExtensions.WJ(this.indexedDB.jba(x.a.FO),dc=>{const sb=!this.YW||!this.Uh.length;dc=dc.result;Kb.push(Object(l.a)(new A.a,{name:"ExistingScriptCount",int64:this.Uh.length}));if(""!==dc&&(dc=Wa.b(dc),Kb.push(Object(l.a)(new A.a,{name:"CachedScriptCount",int64:dc.length})),sb)){for(const bb of dc)this.Uh.Mh(new ha(bb));this.Hka=!0;this.eRa=0<dc.length;z.a(r.a.gpc,sb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.sRa(la);return!0}z.a(r.a.gpc,
sb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);return!1},this.$.ka,3)}UKd(la){Y.EwaSettings.getBooleanFeatureGate(x.a.U_c,!1)&&!Aa()&&this.XKd(la);x.a.Vw?this.vJb(la):this.SKd(la)}Ejd(la,hb,Kb){const dc=v.a.Sa.zb,sb=[];if(la&&la.IsSuccess){Q(this.$,la.Token);var bb=La.a.create().toString();sb.push(Object(l.a)(new A.a,{name:"CorrelationId",string:bb}));makerstorage.getRecentScripts(bb).then(Ob=>{sb.push(Object(l.a)(new A.a,{name:"HasReadCachedScripts",bool:this.Hka}));this.Uh.clear();for(const gc of Ob)this.Uh.Mh(new ha(gc));
this.YW=this.eRa=!0;this.indexedDB.Zd()&&(Ob=xb.a.fc(this.Uh.KX()),this.indexedDB.Ona(new pa.a(x.a.FO,Ob)));sb.push(Object(l.a)(new A.a,{name:"ScriptCount",int64:this.Uh.length}));z.a(r.a.Tca,!0,u.getElapsedMilliseconds(dc,v.a.Sa.zb),sb);hb.Qp(x.a.FO)}).catch(Ob=>{Object.getType(Ob)===makerstorage.StorageServiceError?(sb.push(Object(l.a)(new A.a,{name:"Error",string:Ob.message})),sb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:`makerstorage_${Ob.errorCode.toString()}_${Ob.status.toString()}`})),
17===Ob.errorCode&&Kb.iKb(x.a.dLa(this.$))):(sb.push(Object(l.a)(new A.a,{name:"Error",string:Ob.toString()})),sb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:"exception"})));z.a(r.a.Nzf,!1,u.getElapsedMilliseconds(dc,v.a.Sa.zb),sb);this.YW=!0;hb.Qp(x.a.FO)})}else bb=la?la.ErrorCode:"need_token",la=la?la.ErrorMessage:"No Access Token",sb.push(Object(l.a)(new A.a,{name:"ServiceChecked",bool:!1})),sb.push(Object(l.a)(new A.a,{name:"Error",string:la})),sb.push(Object(l.a)(new A.a,{name:"ErrorCode",
string:bb})),z.a(r.a.Tca,!1,u.getElapsedMilliseconds(dc,v.a.Sa.zb),sb),this.YW=!0,hb.Qp(x.a.FO)}TKd(la,hb){const Kb=new Da.a,dc=ia(this.$);Ca(this.$,sb=>{if((sb=sb.Result)&&200===sb.ResponseStatusCode)sb=sb.ResponseBody.join(""),sb=JSON.parse(sb),la(this.WGd(sb.value)),Kb.setResult(!0);else{sb=sb?"RichApi_"+sb.ResponseStatusCode:"RichApiError";const bb=[];bb.push(Object(l.a)(new A.a,{name:"Error",string:"Failed to read shared script ids from document"}));bb.push(Object(l.a)(new A.a,{name:"ErrorCode",
string:sb}));this.Ps=!0;this.uU(hb,v.a.Sa.zb,0,bb);Kb.setResult(!1)}},sb=>{sb=Ta.a.Oe(sb.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const bb=[];bb.push(Object(l.a)(new A.a,{name:"Error",string:"Failure using rich api: "+sb}));bb.push(Object(l.a)(new A.a,{name:"ErrorCode",string:"RichApiFailure"}));this.Ps=!0;this.uU(hb,v.a.Sa.zb,0,bb);Kb.setResult(!1)},dc,Kb)}$jd(la,hb,Kb){const dc=v.a.Sa.zb;let sb=0,bb=0;this.Ps=sb===la.count;const Ob=
[];Ob.push(Object(l.a)(new A.a,{name:"ScriptIds",int64:la.count}));if(la.count)if(hb&&hb.IsSuccess){Q(this.$,hb.Token);for(var gc of la){const mb=La.a.create().toString();makerstorage.getSharedScript(gc.value,mb).then(Nb=>{const ic=[];ic.push(Object(l.a)(new A.a,{name:"BodySize",int64:Nb.body.length}));ic.push(Object(l.a)(new A.a,{name:"CorrelationId",string:mb}));z.a(r.a.hpc,!0,u.getElapsedMilliseconds(dc,v.a.Sa.zb),ic);sb++;Nb=new ha(Nb);Nb.shareId=la.ma(Nb.id);this.Od.Mh(Nb);this.Ps=sb===la.count;
this.fRa=!0;this.uU(Kb,dc,bb,Ob)}).catch(Nb=>{const ic=[];Object.getType(Nb)===makerstorage.StorageServiceError?(Ob.push(Object(l.a)(new A.a,{name:"Error",string:Nb.message})),Ob.push(Object(l.a)(new A.a,{name:"ErrorCode",string:`makerstorage_${Nb.errorCode.toString()}_${Nb.status.toString()}`}))):(ic.push(Object(l.a)(new A.a,{name:"Error",string:Nb.toString()})),ic.push(Object(l.a)(new A.a,{name:"ErrorCode",string:"exception"})));ic.push(Object(l.a)(new A.a,{name:"CorrelationId",string:mb}));z.a(r.a.hpc,
!1,u.getElapsedMilliseconds(dc,v.a.Sa.zb),ic);sb++;bb++;this.Ps=sb===la.count;this.uU(Kb,dc,bb,Ob)}).finally(()=>{if(Y.EwaSettings.getBooleanFeatureGate(x.a.U_c,!1)&&this.indexedDB.Zd()&&this.Ps){const Nb=nb.Vjd(this.$,this.Od);this.indexedDB.Ona(new pa.a(x.a.ypa,Nb))}})}}else gc=hb?hb.ErrorCode:"need_token",hb=hb?hb.ErrorMessage:"No Access Token",Ob.push(Object(l.a)(new A.a,{name:"Error",string:hb})),Ob.push(Object(l.a)(new A.a,{name:"ErrorCode",string:gc})),this.Ps=!0,this.uU(Kb,dc,bb,Ob);else this.Ps=
this.fRa=!0,this.uU(Kb,dc,bb,Ob),Y.EwaSettings.getBooleanFeatureGate(x.a.U_c,!1)&&f.TaskExtensions.WJ(nb.wJb(this.$,this.indexedDB),mb=>{mb.result&&(this.indexedDB.u8b(x.a.ypa),this.Od.clear(),Kb.Qp("CachedScripts"))},this.$.ka,3)}Njd(la){const hb={id:"samples-6"};hb.name=J.a.instance.ga(2140);this.Vk.Mh(new ha(hb));hb.id="samples-8";hb.name=J.a.instance.ga(2141);this.Vk.Mh(new ha(hb));hb.id="samples-2";hb.name=J.a.instance.ga(2137);this.Vk.Mh(new ha(hb));hb.id="samples-4";hb.name=J.a.instance.ga(2138);
this.Vk.Mh(new ha(hb));hb.id="samples-5";hb.name=J.a.instance.ga(2139);this.Vk.Mh(new ha(hb));hb.id="samples-9";hb.name=J.a.instance.ga(2142);this.Vk.Mh(new ha(hb));this.p7=!0;la.Qp("SampleScripts")}ykd(){const la={};la.id=x.a.JPb;la.name=J.a.instance.ga(2143);this.f8.Mh(new ha(la));la.id=x.a.KPb;la.name=J.a.instance.ga(2144);this.f8.Mh(new ha(la))}WGd(la){const hb=new V.a;if(la=this.Bua.parseFromString(la,"text/xml").querySelector('[id="script-ids-node-id"]')){la=la.getElementsByTagName("scriptId");
for(let Kb=0;Kb<la.length;Kb++){const dc=la[Kb].getAttribute("id");if(dc){let sb,bb;({$Ob:sb,shareId:bb}=nb.lkd(dc)).returnValue&&hb.ia(sb,bb)}}}return hb}XKd(la){const hb=v.a.Sa.zb,Kb=[];f.TaskExtensions.WJ(nb.wJb(this.$,this.indexedDB),dc=>{dc=dc.result;Kb.push(Object(l.a)(new A.a,{name:"ExistingScriptCount",int64:this.Od.length}));if(dc){Kb.push(Object(l.a)(new A.a,{name:"CachedScriptCount",int64:dc.length}));const sb=!this.Ps||0===this.Od.length;if(sb){for(const bb of dc.getScripts())this.Od.Mh(bb);
this.Od.sort();z.a(r.a.X$a,sb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.sRa(la);return!0}z.a(r.a.X$a,sb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb)}else z.a(r.a.X$a,!1,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);return!1},this.$.ka,3)}SKd(la){const hb=v.a.Sa.zb,Kb=[];f.TaskExtensions.WJ(this.indexedDB.jba(x.a.QW),dc=>{const sb=!this.XW||!this.ug.length;dc=dc.result;Kb.push(Object(l.a)(new A.a,{name:"ExistingScriptCount",int64:this.ug.length}));if(""!==dc&&(dc=Wa.b(dc),Kb.push(Object(l.a)(new A.a,
{name:"CachedScriptCount",int64:dc.length})),sb)){for(const bb of dc)this.ug.Mh(new ha(bb));this.ug.sort();z.a(r.a.fpc,sb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);this.sRa(la);return!0}z.a(r.a.fpc,sb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),Kb);return!1},this.$.ka,3)}uU(la,hb,Kb,dc){this.Ps&&(dc.push(Object(l.a)(new A.a,{name:"ScriptCount",int64:this.Od.length})),dc.push(Object(l.a)(new A.a,{name:"ScriptErrorCount",int64:Kb})),z.a(r.a.Ozf,!Kb,u.getElapsedMilliseconds(hb,v.a.Sa.zb),dc),this.Od.sort(),
la.Qp(x.a.ypa))}sRa(la){this.e5=!0;la.Qp("CachedScripts")}}Object(t.a)(va,"AutomateCommandStorage",nb,[]);var wb=a(698);class fc extends b.a{constructor(la){super();this.$=la;this.Fb()}create(){const la=sa.GetServiceTaskFactory.Na(this.$.da,349,350,this.Ya),hb=G.a.loadScript(133,4,this.Ya,void 0,void 0,351),Kb=sa.GetServiceTaskFactory.create(this.$.da,102,this.$.ka,this.Ya),dc=sa.GetServiceTaskFactory.create(this.$.da,396,this.$.ka,this.Ya),sb=sa.GetServiceTaskFactory.Na(this.$.da,5,4,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([la,
hb,Kb,dc,sb],this.ka,3),()=>{const bb=la.result,Ob=dc.result;var gc=sb.result;const mb=new Pa,Nb=new y(this.$,bb,mb),ic=new va(this.$,Ob),gb=new ca(this.$,ic),Eb=new vb(this.$,Nb,mb,gc);gc=Object(wb.a)(this.$.da,352,()=>new Na(this.$,bb,Kb.result,Ob,Eb,mb,Nb,ic,gb));this.ob(gc)},this.ka,3)}static la(la){la&&la.da.Ga(351,new fc(la))}}Object(t.a)(fc,"AutomateCommandManagerFactory",b.a,[]);var Fc=a(9);a.d(E,"a",function(){return Qa});const Qa=()=>{Fc.a.Fa(la=>{m.la(la);fc.la(la)})}},1189:function(t,
E,a){t=a(0);var c=a(15),b=a(84),e;(function(S){S[S.generalException=0]="generalException";S[S.invalidArgument=1]="invalidArgument";S[S.notAllowed=2]="notAllowed";S[S.apiNotAvailable=3]="apiNotAvailable";S[S.unresolvedPendingRequest=4]="unresolvedPendingRequest";S[S.timeout=5]="timeout";S[S.adalTimeout=6]="adalTimeout";S[S.userNotSignedIn=7]="userNotSignedIn";S[S.userAborted=8]="userAborted";S[S.silentSignInFailed=9]="silentSignInFailed";S[S.invalidResourceUrl=10]="invalidResourceUrl";S[S.invalidGrant=
11]="invalidGrant";S[S.connectionLost=12]="connectionLost";S[S.clientError=13]="clientError";S[S.serverError=14]="serverError"})(e||(e={}));Object(t.b)("ErrorCodes",e);a(1303);class f{constructor(S,H){this.requestCallback=this.requestParameters=null;this.requestParameters=S;this.requestCallback=H}}Object(t.a)(f,"OutstandingRequest",null,[]);class d{}d.zKi="AADSTS50058";d.invalidResourceUrl="AADSTS50001";d.uKi="AADSTS65001";d.JKi="AADSTS70011";d.userAborted="13002";d.O5i="Popup Window is null";d.N5i=
"Popup Window closed";d.adalTimeout="Token renewal operation failed due to timeout";d.oSj="tokenRevoked";Object(t.a)(d,"WopiHostErrorType",null,[]);var h=a(4),m=a(732),l=a(571),w=a(41),n=a(1302);class x{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(t.a)(x,"WopiIdentityInfo",null,[448]);class r{constructor(S,H,C){this.expiration=this.authority=this.accessToken=null;this.accessToken=S;this.authority=H;this.expiration=C}}Object(t.a)(r,
"WopiIdentityToken",null,[447]);var u=a(27),v=a(147),B=a(376),z=a(164),A=a(72),y=a(347);class D{constructor(S){this._initialized=!1;this.fbb={};this.UBc={};this.dP=h.AFrameworkApplication.ta.kE;this.Lnd=S}y3a(S){this._initialized||(S.vo(z.a.pOf),S.em(z.a.pOf,Object(b.a)(this,this.lXi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(S,H,C=null){this.WOa(S,H);return new Promise((G,J)=>{if(this.iqd(H))if(H in this.fbb)J("unresolvedPendingRequest");else{var L=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,
344,10,w.c({["error"]:"Request timeout.",["callerId"]:H}));J("timeout")},12E4);this.Tfd(S,H,C,(P,aa)=>{window.clearTimeout(L);P?G(P):(c.ULS.sendTraceTag(37856033,369,15,w.c({["error"]:e[aa]})),J(aa))})}else c.ULS.sendTraceTag(37856034,344,10,w.c({["error"]:"Caller is not allowed."})),J("notAllowed")})}getPrimaryIdentityInfo(S){return new Promise((H,C)=>{this.iqd(S)?this.g0h((G,J)=>{G?H(G):(c.ULS.sendTraceTag(37856064,369,10,w.c({["error"]:J.toString()})),C(J))}):(c.ULS.sendTraceTag(37856065,344,10,
w.c({["error"]:"Caller is not allowed."})),C("notAllowed"))})}getAuthContext(S){return new Promise((H,C)=>{const G=this.getAuthContextSync(S);G?H(G):C("notAllowed")})}getAuthContextSync(S){if(this.iqd(S)){const H=new n.a;H.upn=h.AFrameworkApplication.fa.Xa("UserPrincipalName");H.userId=h.AFrameworkApplication.fa.Xa("LoggableUserId");H.authority=h.AFrameworkApplication.fa.Xa("HostAuthAuthority");H.tenantId=h.AFrameworkApplication.fa.Xa("TenantId");H.isAnonymous=h.AFrameworkApplication.fa.qa("IsAnonymousUser");
H.supportsAuthToken=this.Rci(S);S=h.AFrameworkApplication.fa.Xa("HostAuthType");H.authorityType="aad"===S.toLowerCase()?2:"msa"===S.toLowerCase()?1:0;return H}c.ULS.sendTraceTag(40751647,344,10,w.c({["error"]:"Caller is not allowed."}));return null}Rci(S){const H=m.a.Azb;return u.a.Vxa?H&&m.a.reg?Array.contains(m.a.reg,S.toLowerCase()):!1:H}Tfd(S,H,C,G){var J=[];Array.add(J,Object.assign(new A.a,{name:"CallerId",string:H}));Array.add(J,Object.assign(new A.a,{name:B.a.KXd,string:S.correlationId}));
v.a.sendTelemetryEvent(Object.assign(new y.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:J}));J=l.a.create().toString();const L="getAccessToken_"+J,P=this.dP.Cc("ComponentAttach",L);this.UBc[L]=P;const aa={};aa[B.a.LXd]=J;aa[B.a.JLj]=S.resource;aa[B.a.KLj]=S.scope;aa[B.a.tbg]=h.AFrameworkApplication.fa.Xa("HostAuthType");aa[B.a.NLj]=h.AFrameworkApplication.fa.Xa("UserPrincipalName");aa[B.a.LLj]=S.silentLogin;aa[B.a.GLj]=S.options;aa[B.a.KXd]=S.correlationId;aa[B.a.HLj]=
H;C&&(aa[B.a.addinName]=C.AddinName,aa[B.a.FLj]=C.AddinTrustId);this.Lnd.execute(U=>{this.y3a(U);U.Sj(z.a.getAuthToken,aa)});this.fbb[J]=new f(S,G)}g0h(S){const H=h.AFrameworkApplication.fa.Xa("UserName"),C=h.AFrameworkApplication.fa.Xa("UserPrincipalName"),G=h.AFrameworkApplication.fa.Xa("LoggableUserIdSpace"),J=new x;J.email=C;J.displayName=H;switch(G){case "OrgIdPuid":J.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":J.authority="MicrosoftAccount";break;default:J.authority=
G}S(J,null)}lXi(S){let H=null;try{let G=S.Values[B.a.LXd];const J=S.Values[B.a.ELj],L=S.Values[B.a.tbg],P=S.Values[B.a.MLj];let aa=null,U=null;const K=this.fbb[G];if("undefined"!==typeof K&&K){var C=[];Array.add(C,Object.assign(new A.a,{name:B.a.KXd,string:K.requestParameters.correlationId}));v.a.sendTelemetryEvent(Object.assign(new y.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:C}));H=K.requestCallback;delete this.fbb[G];"undefined"!==typeof J&&J&&J.length?
U=new r(J,L,P):aa=e[this.EFi(S)];C="getAccessToken_"+G;C in this.UBc&&(this.UBc[C].stop(),delete this.UBc[C]);H(U,aa)}else c.ULS.sendTraceTag(37856066,344,10,w.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:G}))}catch(G){S=S.Values[B.a.LXd],S in this.fbb&&delete this.fbb[S],this.Jmc(),c.ULS.sendTraceTag(37856067,344,10,w.c({["error"]:G.message,["stack"]:G.stack})),H&&H(null,"generalException")}}iqd(S){var H=h.AFrameworkApplication.c7h();S=S.toLowerCase();for(const C of H)if(S===
C.toLowerCase())return!0;H=m.a.DZc;for(let C in H)if(S===H[C].toLowerCase())return!0;return!1}EFi(S){S=S.Values[B.a.ILj];this.Jmc();c.ULS.sendTraceTag(39068821,344,15,w.c({["error"]:S}));return S?-1<S.indexOf(d.zKi)?9:-1<S.indexOf(d.O5i)||-1<S.indexOf(d.N5i)?12:-1<S.indexOf(d.invalidResourceUrl)?10:-1<S.indexOf(d.userAborted)?8:-1<S.indexOf(d.JKi)||-1<S.indexOf(d.uKi)||S===d.oSj?11:-1<S.indexOf(d.adalTimeout)?6:0:13}WOa(S,H){S=this.rdj(S.resource);c.ULS.sendTraceTag(39921882,344,50,w.c({["callerId"]:H,
["resource"]:S}))}Jmc(){c.ULS.sendTraceTag(39068822,344,50,w.c({["userAgent"]:window.navigator.userAgent}))}rdj(S){return(S?S:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(t.a)(D,"WopiIdentityManager",null,[436]);var I=a(249);class M{constructor(){this.$a=null}get name(){return"Common.App.WopiIdentity"}Oh(S){this.$a=S;S.register(D,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").wc().Ac(()=>new D(S.Rb("Postmessage.IHostPostmessenger")))}init(){h.AFrameworkApplication.fa&&
h.AFrameworkApplication.fa.Iu(Object(b.a)(this,this.IB,"onFullAppSettingsReady"))}IB(){try{this.$a.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(S){c.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+S)}}dispose(){}static main(){I.a.instance.vi(new M)}}Object(t.a)(M,"WopiIdentityPackage",null,[4,5]);a.d(E,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.WopiIdentity");M.main()}},1194:function(t,E,a){a.r(E);t=a(0);var c=
a(7),b=a(15),e=a(4),f=a(156),d=a(187),h=a(83),m=a(188),l=a(60),w=a(48),n=a(37),x=a(227),r=a(116),u=a(529);class v{constructor(Ga){Ga=Ga.split("|");this.Ex=Ga[1];this.vUc=Ga[2];this.EYd=Ga[3]}get solutionId(){return this.Ex}get solutionVersion(){return this.vUc}get needToRestoreManifest(){return this.EYd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(v,"AddinStoreInfo",null,[]);class B{}Object(t.a)(B,"CustomFunctionRegistrationInfos",null,[]);var z=a(197),A=a(68);const y=(Ga,da,Z)=>D(Ga,da,z.a.none,
A.a.current,Z),D=(Ga,da,Z,ha,Wa)=>{Z=Ga.continueWith(()=>{da(Ga)},3,Z,ha);Z.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,Wa)},4);return Z},I=(Ga,da,Z)=>M(Ga,da,z.a.none,A.a.current,Z),M=(Ga,da,Z,ha,Wa)=>{Z=Ga.np(()=>da(Ga),3,Z,ha);Z.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,Wa)},4);return n.TaskExtensions.pEc(Z)},T=(Ga,da,Z)=>S(Ga,da,z.a.none,A.a.current,Z),S=(Ga,da,Z,ha,Wa)=>{Z=Ga.np(()=>da(Ga),3,Z,ha);Z.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,Wa)},4);return Z},H=(Ga,
da,Z)=>C(Ga,da,z.a.none,A.a.current,Z),C=(Ga,da,Z,ha,Wa)=>{Z=Ga.np(()=>da(Ga),3,Z,ha);Z.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,Wa)},4);return n.TaskExtensions.pEc(Z)},G=(Ga,da,Z)=>J(Ga,da,z.a.none,A.a.current,Z),J=(Ga,da,Z,ha,Wa)=>{Z=Ga.continueWith(()=>{da(Ga)},3,Z,ha);Z.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,Wa)},4);return Z},L=(Ga,da)=>{T(a(1194).CustomFunctionsInstaller.D5e("CustomFunctionsRuntimeLogging"),Z=>{if(Z.result&&window.console)switch(Z=P(Ga.severity)+" "+Ga.message+
da,Ga.severity){case 2:window.console.log&&window.console.log(Z);break;case 0:window.console.info&&window.console.info(Z);break;case 1:window.console.error&&window.console.error(Z)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},P=Ga=>{switch(Ga){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var aa=a(964);class U{}Object(t.a)(U,"InstallationInfo",null,[]);class K{}Object(t.a)(K,"UninstallationInfo",
null,[]);var Y=a(28),na=a(92),W=a(35),X=a(29),Aa=a(1),Q=a(22),fa=a(282),Ca=a(753),ia=a(55);class Ra{constructor(Ga,da){this.TTc=Ga;this._message=da}get severity(){return this.TTc}get message(){return this._message}}Object(t.a)(Ra,"CustomFunctionLog",null,[]);a.d(E,"CustomFunctionsInstaller",function(){return Ya});class Ya{constructor(Ga,da,Z){this.G_=!1;this.LF={};this.$=Ga;this.vj=da;this.Gpd().Nna();this.indexedDB=Z;this.indexedDB.Zd()&&(this.G_=!0,this.indexedDB.initialize(Ya.Wzb,Ya.Xzb))}get NV(){return this.vj.NV}Cgf(Ga,
da,Z,ha){if(ha.invariantNamespace)for(let Wa=0;Wa<ha.invariantNamespace.length;++Wa){const ca=ha.invariantNamespace.charAt(Wa);if("."!==ca&&"_"!==ca&&"a">ca&&"z"<ca&&"A">ca&&"Z"<ca&&"0">ca&&"9"<ca)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${ca}', Position=${Wa}.`),Error.create("InvariantNamespace validation failed");}return I(this.X_g(Z,ha.manifest),()=>I(this.PKd(Ga),Wa=>{let ca=Wa.result;return(null===ca||void 0===
ca?0:ca.isDynamicMetadata)?this.ULd(Ga,da,ca,!1,!1,!1):I(this.C5j(Ga,da,ha),ja=>{let ua;ca=(ua=new U,ua.addinId=Z,ua.locale=ha.locale,ua.addinInvariantNamespace=ha.invariantNamespace,ua.addinNamespace=ha.namespace,ua.addinTitle=ha.title,ua.isXllCompatible=ha.isXllCompatible,ua.metadataContent=JSON.stringify(JSON.parse(ja.result)),ua);return this.ULd(Ga,da,ca,!1,Ya.gFh(ha.osfControl.getStoreType()),aa.a(this.$,ha))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}Egf(Ga,da,Z,ha){if(!Ya.Xud(Z))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return I(this.PKd(Ga),Wa=>{Wa=Wa.result;if(!Wa&&(Wa=W.a.Ec(this.NV,Ga),!Wa))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,
da,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");Wa.metadataContent=JSON.stringify(JSON.parse(Z));Wa.isDynamicMetadata=!0;return this.ULd(Ga,da,Wa,!0,!0,ha)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}eig(Ga,da){this.vj.hja();const Z=Object(c.a)(new K,{solutionId:Ga}),ha=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,
da,null)}.`;return I(this.EMd(Ga),()=>I(this.KMd(Ga),()=>this.p1d(this.vj,Ga,da,Z),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),ha)}C5j(Ga,da,Z){const ha=new f.a;OSF.OUtil.xhrGet(Z.metadataUrl,Wa=>{Wa?ha.setResult(Wa):ha.setException(Error.create("Invalid manifest"))},Wa=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,
da,null)}. ErrorCode: ${Wa}.`);Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:7223300_HandleFaultedTaskXhrGetMetadataAsync")?ha.Or():ha.setException(Error.create("Failed to download manifest"))});return ha.task}Gpd(){return I(this.ruc(),Ga=>{const da=Ga.result;if(!da.length)return ia.Task.Ra(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ga=new d.a;const Z=[];for(let ha=0;ha<da.length;ha++){const Wa=Object(h.a)(String,
da[ha]);Ga.add(T(this.PKd(Wa),ca=>{if(ca=ca.result){const ja=W.a.Ec(this.LF,ca.addinId);ja&&ja===ca.metadataContent||(this.LF[ca.addinId]=ca.metadataContent,this.NV[Wa]=ca,Z.push(ca))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return H(ia.Task.WhenAllEnumerable(Ga),()=>{if(Z.length){let ha;const Wa=(ha=new B,ha.registrationInfos=Z,ha);return this.P2b(this.vj,da,Wa)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return ia.Task.Ra(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}Fgf(){var Ga=new f.a;new d.a;const da=[],Z=[];Object.keys(this.NV).forEach(ha=>{ha=Object(h.a)(String,ha);const Wa=W.a.Ec(this.NV,ha);da.push(Wa);Z.push(ha)});if(!Z.length)return Ga.setResult(!0),Ga.task;Ga=Object(c.a)(new B,{registrationInfos:da});return this.P2b(this.vj,Z,Ga)}ruc(){return T(this.Fid(u.a.k_a),Ga=>{Ga=Ga.result;
return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Ga||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Ga||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}eog(Ga){return this.gTd(u.a.k_a,Sys.Serialization.JavaScriptSerializer.serialize(Ga))}PKd(Ga){return I(this.Fid(u.a.C5a(Ga)),da=>{da=da.result||"";return 0<da.length?ia.Task.Ra(Sys.Serialization.JavaScriptSerializer.deserialize(da,!0)):ia.Task.Ra(null)},
"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}u5j(Ga,da){return I(this.bRe(Ga),()=>I(this.gTd(u.a.C5a(Ga),Sys.Serialization.JavaScriptSerializer.serialize(da)),()=>Ya.hTd(u.a.vmd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}EMd(Ga){return I(this.tVf(Ga),()=>I(this.MVf(u.a.C5a(Ga)),
()=>I(this.ruc(),da=>da.result.length?ia.Task.Ra(!0):Ya.hTd(u.a.vmd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}KSf(Ga){return this.Fid(u.a.A5a(Ga))}bog(Ga,da){return I(this.bRe(Ga),()=>this.gTd(u.a.A5a(Ga),
da),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}KMd(Ga){return I(this.tVf(Ga),()=>this.MVf(u.a.A5a(Ga)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}bRe(Ga){return I(this.ruc(),da=>{da=da.result;const Z=Ga.toLowerCase();if(da.includes(Z))return ia.Task.Ra(!0);da.push(Z);return this.eog(da)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}tVf(Ga){return I(this.ruc(),
da=>{da=da.result;const Z=Ga.toLowerCase();return da.includes(Z)?(da.splice(Array.indexOf(da,Z),1),this.eog(da)):ia.Task.Ra(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}X_g(Ga,da){if(Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Ga=new OSF.AddinIdInfo(Ga),Ga.needToRestoreManifest()?this.bog(Ga.getSolutionId(),da):ia.Task.Ra(!0);Ga=new v(Ga);return Ga.needToRestoreManifest?this.bog(Ga.solutionId,
da):ia.Task.Ra(!0)}Moj(Ga){if(Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Z=new OSF.AddinIdInfo(Ga);return Z.needToRestoreManifest()?T(this.KSf(Z.getSolutionId()),ha=>{(ha=ha.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Z.getSolutionId(),Z.getSolutionVersion(),ha,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ia.Task.Ra(!0)}const da=new v(Ga);return da.needToRestoreManifest?
T(this.KSf(da.solutionId),Z=>{(Z=Z.result)&&OSF.OsfManifestManager.cacheManifestFromXml(da.solutionId,da.solutionVersion,Z,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):ia.Task.Ra(!0)}MVf(Ga){return this.G_?this.indexedDB.u8b(Ga):Ya.ahj(Ga)}gTd(Ga,da){return this.G_?this.indexedDB.Ona(new Ca.a(Ga,da)):Ya.hTd(Ga,da)}Fid(Ga){return this.G_?this.indexedDB.jba(Ga):Ya.D5e(Ga)}ULd(Ga,da,Z,ha,Wa,ca){const ja=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,
da,null)}.`;return n.TaskExtensions.pEc(T(this.VLd(this.vj,Ga,da,Z,!1,ha,ca),()=>Wa?this.u5j(Ga,Z):ia.Task.Ra(!0),ja))}VLd(Ga,da,Z,ha,Wa,ca,ja){if(!ca&&(ca=W.a.Ec(this.LF,ha.addinId))&&ca===ha.metadataContent)return ia.Task.Ra(!0);this.LF[ha.addinId]=ha.metadataContent;this.NV[da]=ha;ja||Ga.fKb(da);Ga.hja();return I(this.wej(da,Z,ha),()=>this.xJd(ha.addinId,Wa),"Failed to register functions for customfunction addin")}wej(Ga,da,Z){const ha=new f.a,Wa=this.KHa(Z);return this.w4(ca=>{L(Ya.Ltb,Ga);(ca=
ca.Result)&&204===ca.ResponseStatusCode?ha.setResult(!0):(delete this.LF[Z.addinId],delete this.NV[Ga],y(this.EMd(Ga),()=>{y(this.KMd(Ga),()=>{this.V9f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Ga}. Received status code ${ca?ca.ResponseStatusCode.toString():"Unknown"}.`),ha.setResult(!1))},ca=>{ca=r.a.Oe(ca.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,
da,null)}. Errors: ${X.a.sc(ca)}.`);L(Ya.Ktb,Ga);delete this.LF[Z.addinId];delete this.NV[Ga];ha.setResult(!1)},Wa,ha,!0)}P2b(Ga,da,Z){const ha=new f.a,Wa=Y.a.Sa.ve.m;da.forEach(ja=>{ja=Object(h.a)(String,ja);Ga.bDe(ja)});Ga.hja();const ca=this.V0c(Z);return this.w4(ja=>{L(Ya.Ltb,Sys.Serialization.JavaScriptSerializer.serialize(da));ja=ja.Result;let ua=!0;var Za=Sys.Serialization.JavaScriptSerializer.deserialize(ja.ResponseBody.toString());Za=Array.isArray(Za.value)?Za.value:null;const Pa=new d.a;
for(let ka=0;ka<Za.length;ka++)if(!Za[ka]){ua=!1;const ra=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${ja.ResponseStatusCode}.`;Pa.add(I(this.EMd(da[ka]),()=>{delete this.LF[Z.registrationInfos[ka].addinId];delete this.NV[da[ka]];return this.KMd(da[ka])},ra))}G(ia.Task.WhenAllEnumerable(Pa),()=>{y(this.xJd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${Y.a.Sa.ve.m-
Wa} Millisecond.`);ua?ha.setResult(ua):G(this.V9f(),()=>{ha.setResult(ua)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},ja=>{ja=r.a.Oe(ja.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${X.a.sc(ja)}.`);
L(Ya.Ktb,Sys.Serialization.JavaScriptSerializer.serialize(da));for(ja=0;ja<Z.registrationInfos.length;ja++)delete this.LF[Z.registrationInfos[ja].addinId],delete this.NV[da[ja]];ha.setResult(!1)},ca,ha,!0)}p1d(Ga,da,Z,ha){return I(this.RWj(Ga,da,Z,ha),()=>this.xJd(ha.solutionId,!1),"Failed to unregister functions for customfunction addin")}RWj(Ga,da,Z,ha){const Wa=new f.a;Ga.fKb(da);(Ga=W.a.Ec(this.NV,da))&&delete this.LF[Ga.addinId];delete this.NV[da];ha=this.g1c(ha);return this.w4(()=>{L(Ya.p8c,
da);Wa.setResult(!0)},ca=>{ca=r.a.Oe(ca.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Z,null)}. Errors: ${X.a.sc(ca)}.`);L(Ya.o8c,da);Wa.setResult(!1)},ha,Wa,!1)}w4(Ga,da,Z,ha,Wa){const ca=this.$.userOperationManager,ja=this.$.pa;let ua=null,Za=null,Pa=null;const ka=()=>{if(ca.Dta()||0<ja.xa.iV||0<ja.Ok.iV)return!1;ua&&ca.oo(ua);Za&&ja.Lr(Za);Pa&&
ja.kx(Pa);const ra=Z.request;let ba=0;Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?ra.RequestFlags&1&&256!==(ra.RequestFlags&256)||(ba=16):ba=ra.RequestFlags&1?0:16;ca.oD(new m.a(507,0,(Ua,Ka,Oa)=>{L(Wa?Ya.n8c:Ya.q8c,ra.RequestBody);return l.g(ja.xa,"ExecuteRichApiRequest",Z,fa.b(Ua,Ga),fa.a(Ka,da),Oa,null,0)},ba|64));return!0};ka()||(ua=()=>{ka()},Za=()=>{ka()},Pa=()=>{ka()},ca.tr(ua),ja.Mq(Za),ja.mw(Pa));return ha.task}KHa(Ga){const da={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};da.RequestBody=JSON.stringify(Ga);da.RequestFlags=1;Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(da.RequestFlags|=256);Ga=this.$.pa.xa.Oa(1);Ga.request=da;return Ga}V0c(Ga){const da={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};da.RequestBody=JSON.stringify(Ga);da.RequestFlags=1;Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(da.RequestFlags|=256);Ga=this.$.pa.xa.Oa(1);Ga.request=da;return Ga}g1c(Ga){const da={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};da.RequestBody=JSON.stringify(Ga);da.RequestFlags=1;Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(da.RequestFlags|=256);Ga=this.$.pa.xa.Oa(1);Ga.request=da;return Ga}xJd(Ga,da){const Z=w.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);return M(Z,()=>{Z.result.TOd();return Ga&&da?this.Moj(Ga):
ia.Task.Ra(!0)},this.$.ka,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}V9f(){const Ga=new na.a(1949669462,0,this.$.Hc,0,null);return this.$.Ka.Lb(Ga)}static D5e(Ga){try{return ia.Task.Ra(localStorage.getItem(Ga))}catch(da){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${da.message||"Unknown"}`),ia.Task.Ra(null)}}static hTd(Ga,
da){try{return localStorage.setItem(Ga,da),ia.Task.Ra(!0)}catch(Z){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Z.message||"Unknown"}`),ia.Task.Ra(!1)}}static ahj(Ga){try{return localStorage.removeItem(Ga),ia.Task.Ra(!0)}catch(da){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${da.message||"Unknown"}`),
ia.Task.Ra(!1)}}static gFh(Ga){return Q.a.equals(Ga,"registry",!0)||Q.a.equals(Ga,"uploadfiledevcatalog",!0)||e.AFrameworkApplication.userNameUnknown||e.AFrameworkApplication.limitedEdit}static Xud(Ga){if(!Ga)return!1;try{JSON.parse(Ga)}catch(da){return!1}return!0}}Ya.Wzb="CustomFunctionCache";Ya.Xzb="CustomFunction";Ya.n8c=new Ra(2,"CustomFunctions [Registration] [Begin] SolutionId=");Ya.Ltb=new Ra(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Ya.Ktb=new Ra(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Ya.q8c=new Ra(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Ya.p8c=new Ra(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Ya.o8c=new Ra(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(Ya,"CustomFunctionsInstaller",null,[307])},1197:function(t,E,a){a.r(E);t=a(0);var c=a(7),b=a(15),e=a(937),f=a(156),d=a(83),h=a(188),m=a(60),l=a(48),w=a(37),n=a(116),x=a(529),r=a(964);class u{constructor(L){L=L.split("|");this.Ex=L[1];this.vUc=L[2];this.EYd=
L[3]}get solutionId(){return this.Ex}get solutionVersion(){return this.vUc}get needToRestoreManifest(){return this.EYd===OSF.StoreTypeEnum.Registry.toString()}}Object(t.a)(u,"AddinStoreInfo",null,[]);class v{}Object(t.a)(v,"CustomFunctionRegistrationInfos",null,[]);const B=(L,P)=>{if(a(1197).CustomFunctionsLegacyInstaller.Gxb("CustomFunctionsRuntimeLogging")&&window.console)switch(P=z(L.severity)+" "+L.message+P,L.severity){case 2:window.console.log&&window.console.log(P);break;case 0:window.console.info&&
window.console.info(P);break;case 1:window.console.error&&window.console.error(P)}},z=L=>{switch(L){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class A{}Object(t.a)(A,"InstallationInfo",null,[]);class y{}Object(t.a)(y,"UninstallationInfo",null,[]);var D=a(153),I=a(35),M=a(29),T=a(13),S=a(282),H=a(866),C=a(55);class G{constructor(L,P){this.TTc=L;this._message=P}get severity(){return this.TTc}get message(){return this._message}}Object(t.a)(G,"CustomFunctionLog",
null,[]);a.d(E,"CustomFunctionsLegacyInstaller",function(){return J});class J{constructor(L){this.LF={};this.$=L;this.Gpd().Nna()}Cgf(L,P,aa,U){const K=new f.a;if(U.invariantNamespace)for(P=0;P<U.invariantNamespace.length;++P){const na=U.invariantNamespace.charAt(P);if("."!==na&&"_"!==na&&"a">na&&"z"<na&&"A">na&&"Z"<na&&"0">na&&"9"<na)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${na}', Position=${P}.`),K.setResult(!1),
K.task}J.cacheManifest(aa,U.manifest);let Y=J.QKd(L);(null===Y||void 0===Y?0:Y.isDynamicMetadata)?this.TLd(L,Y,K,!1,!1):OSF.OUtil.xhrGet(U.metadataUrl,na=>{Y=Object(c.a)(new A,{addinId:aa,locale:U.locale,addinInvariantNamespace:U.invariantNamespace,addinNamespace:U.namespace,addinTitle:U.title,isXllCompatible:U.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(na))});this.TLd(L,Y,K,!1,r.a(this.$,U))},na=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${L}. ErrorCode: ${na}.`);
K.setResult(!1)});return K.task}Egf(L,P,aa,U){P=new f.a;if(!J.Xud(aa))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),P.setResult(!1),P.task;const K=J.QKd(L);if(!K)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),P.setResult(!1),P.task;K.metadataContent=JSON.stringify(JSON.parse(aa));K.isDynamicMetadata=
!0;this.TLd(L,K,P,!0,U);return P.task}eig(L){const P=new f.a,aa=l.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);w.TaskExtensions.za(aa,()=>{const U=aa.result;U.hja();const K=Object(c.a)(new y,{solutionId:L});J.FMd(L);J.LMd(L);w.TaskExtensions.za(this.p1d(U,L,K),Y=>{D.b(Y)?P.setResult(Y.result):(Y.Of?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${L}.`):Y.rh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${L}.`),
P.setResult(!1))},this.$.ka,0)},this.$.ka,3);return P.task}Gpd(){const L=new f.a,P=J.WKd();0<P.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const aa=[];P.forEach(K=>{K=Object(d.a)(String,K);if(K=J.QKd(K)){const Y=I.a.Ec(this.LF,K.addinId);Y&&Y===K.metadataContent||(this.LF[K.addinId]=K.metadataContent,aa.push(K))}});if(!aa.length)return L.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),
L.task;const U=l.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);w.TaskExtensions.za(U,()=>{const K=U.result,Y=Object(c.a)(new v,{registrationInfos:aa});w.TaskExtensions.za(this.P2b(K,P,Y),na=>{D.b(na)?L.setResult(na.result):(na.Of?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):na.rh&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),
L.setResult(!1))},this.$.ka,0)},this.$.ka,3);return L.task}Loj(L){L=new u(L);if(L.needToRestoreManifest){const P=J.Ybj(L.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(L.solutionId,L.solutionVersion,P,this.$.ya.UICultureTag)}}TLd(L,P,aa,U,K){const Y=l.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,1);w.TaskExtensions.za(Y,()=>{w.TaskExtensions.za(this.VLd(Y.result,L,P,!1,U,K),na=>{D.b(na)?((na=na.result)&&J.v5j(L,P),aa.setResult(na)):(na.Of?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${L}.`):
na.rh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${L}.`),aa.setResult(!1))},this.$.ka,0)},this.$.ka,3)}VLd(L,P,aa,U,K,Y){if(!K&&(K=I.a.Ec(this.LF,aa.addinId))&&K===aa.metadataContent)return C.Task.Ra(!0);this.LF[aa.addinId]=aa.metadataContent;const na=new f.a;Y||L.fKb(P);L.hja();L=this.KHa(aa);return this.w4(W=>{B(J.Ltb,P);const X=W.Result;204===X.ResponseStatusCode?w.TaskExtensions.za(this.wJd(na,aa.addinId,
U),Aa=>{Aa.Of?P?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${P}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${aa.addinId}.`):Aa.rh&&(P?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${P}.`):
b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${aa.addinId}.`));na.setResult(!1)},this.$.ka,4):(W=()=>{delete this.LF[aa.addinId];J.FMd(P);J.LMd(P);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${P}. Received status code ${X.ResponseStatusCode}.`);na.setResult(!1)},W=Object(c.a)(new H.a,{TMa:OSF.InfoType.Error,title:aa.addinTitle,
description:String.format(T.a.instance.mb(153),T.a.instance.ga(1883)),buttonText:T.a.instance.ga(4),Vha:W,ogc:!1,Wia:W,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),e.a.RVd(W))},W=>{W=n.a.Oe(W.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${P}. Errors: ${M.a.sc(W)}.`);B(J.Ktb,P);delete this.LF[aa.addinId];na.setResult(!1)},L,na,!0)}P2b(L,P,aa){const U=new f.a;P.forEach(Y=>
{Y=Object(d.a)(String,Y);L.bDe(Y)});L.hja();const K=this.V0c(aa);return this.w4(Y=>{B(J.Ltb,Sys.Serialization.JavaScriptSerializer.serialize(P));Y=Y.Result;let na=!0;var W=Sys.Serialization.JavaScriptSerializer.deserialize(Y.ResponseBody.toString());W=Array.isArray(W.value)?W.value:null;for(let X=0;X<W.length;X++)W[X]||(na=!1,delete this.LF[aa.registrationInfos[X].addinId],J.FMd(P[X]),J.LMd(P[X]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${P[X]}. Received status code ${Y.ResponseStatusCode}.`));
w.TaskExtensions.za(this.wJd(U,"",!1),X=>{X.Of?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):X.rh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");U.setResult(!1)},this.$.ka,4);U.setResult(na)},Y=>{Y=n.a.Oe(Y.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(P)}. Errors: ${M.a.sc(Y)}.`);
B(J.Ktb,Sys.Serialization.JavaScriptSerializer.serialize(P));for(const na of aa.registrationInfos)delete this.LF[na.addinId];U.setResult(!1)},K,U,!0)}p1d(L,P,aa){const U=new f.a;L.fKb(P);L=this.g1c(aa);return this.w4(()=>{B(J.p8c,P);w.TaskExtensions.za(this.wJd(U,aa.solutionId,!1),K=>{K.Of?P&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${P}.`):K.rh&&P&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${P}.`);
U.setResult(!1)},this.$.ka,4)},K=>{K=n.a.Oe(K.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${P}. Errors: ${M.a.sc(K)}.`);B(J.o8c,P);U.setResult(!1)},L,U,!1)}w4(L,P,aa,U,K){const Y=this.$.userOperationManager,na=this.$.pa;let W=null,X=null,Aa=null;const Q=()=>{if(Y.Dta()||0<na.xa.iV||0<na.Ok.iV)return!1;W&&Y.oo(W);X&&na.Lr(X);Aa&&na.kx(Aa);const fa=aa.request;Y.oD(new h.a(507,0,(Ca,ia,Ra)=>
{B(K?J.n8c:J.q8c,fa.RequestBody);return m.g(na.xa,"ExecuteRichApiRequest",aa,S.b(Ca,L),S.a(ia,P),Ra,null,0)},(fa.RequestFlags&1?0:16)|64));return!0};Q()||(W=()=>{Q()},X=()=>{Q()},Aa=()=>{Q()},Y.tr(W),na.Mq(X),na.mw(Aa));return U.task}KHa(L){const P={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};P.RequestBody=JSON.stringify(L);P.RequestFlags=1;L=this.$.pa.xa.Oa(1);L.request=P;return L}V0c(L){const P={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
P.RequestBody=JSON.stringify(L);P.RequestFlags=1;L=this.$.pa.xa.Oa(1);L.request=P;return L}g1c(L){const P={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};P.RequestBody=JSON.stringify(L);P.RequestFlags=1;L=this.$.pa.xa.Oa(1);L.request=P;return L}wJd(L,P,aa){const U=l.GetServiceTaskFactory.create(this.$.da,153,this.$.ka,1);w.TaskExtensions.za(U,()=>{U.result.TOd();P&&aa&&this.Loj(P);L.setResult(!0)},this.$.ka,3);return U}Fgf(){return C.Task.Ra(!0)}static WKd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(J.Gxb(x.a.k_a)||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(J.Gxb(x.a.k_a)||"[]"):null)||[]}static fog(L){J.iTd(x.a.k_a,Sys.Serialization.JavaScriptSerializer.serialize(L))}static QKd(L){L=J.Gxb(x.a.C5a(L))||"";return 0<L.length?Sys.Serialization.JavaScriptSerializer.deserialize(L,!0):null}static v5j(L,P){J.aRe(L);J.iTd(x.a.C5a(L),Sys.Serialization.JavaScriptSerializer.serialize(P))}static FMd(L){J.sVf(L);J.NVf(x.a.C5a(L))}static Ybj(L){return J.Gxb(x.a.A5a(L))}static w5j(L,P){J.aRe(L);J.iTd(x.a.A5a(L),
P)}static LMd(L){J.sVf(L);J.NVf(x.a.A5a(L))}static aRe(L){const P=J.WKd();L=L.toLowerCase();P.includes(L)||(P.push(L),J.fog(P))}static sVf(L){const P=J.WKd();L=L.toLowerCase();P.includes(L)&&(P.splice(Array.indexOf(P,L),1),J.fog(P))}static cacheManifest(L,P){L=new u(L);L.needToRestoreManifest&&J.w5j(L.solutionId,P)}static Gxb(L){try{return localStorage.getItem(L)}catch(P){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${P.message||
"Unknown"}`),null}}static iTd(L,P){try{localStorage.setItem(L,P)}catch(aa){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${aa.message||"Unknown"}`)}}static NVf(L){try{localStorage.removeItem(L)}catch(P){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${P.message||"Unknown"}`)}}static Xud(L){if(!L)return!1;try{JSON.parse(L)}catch(P){return!1}return!0}}
J.n8c=new G(2,"CustomFunctions [Registration] [Begin] SolutionId=");J.Ltb=new G(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");J.Ktb=new G(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");J.q8c=new G(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");J.p8c=new G(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");J.o8c=new G(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(t.a)(J,"CustomFunctionsLegacyInstaller",null,[307])},
1236:function(t,E,a){t=a(0);var c=a(197),b=a(15);class e{}Object(t.a)(e,"AddinCommandsHost",null,[]);var f=a(1319),d=a(1396),h=a(864),m=a(60);const l=(I,M,T,S,H,C)=>{const G=I.Oa(9);G.sharedInfo=M;return m.g(I,"InsertAgaveTaskpane",G,T,S,H,C,0)},w=(I,M,T,S,H,C,G=null)=>{G=I.Oa(9,G);G.sharedInfo=M;return m.g(I,"ShowAgaveTaskpane",G,T,S,H,C,0)};var n=a(374),x=a(188),r=a(37),u=a(1),v=a(282),B=a(146);class z extends B.a{constructor(I){super();this.Ee=this.YDa="AddInCommandsDialog";this.Tb=5;this.dialogWidth=
695;this.dialogHeight=438;this.F9g="100%";this.C9g="408px";this.D9g="15px";this.E9g="0";this.gBg=I}get containerDiv(){return this.Xk}Zz(){super.Zz();this.Xk.style.width=this.F9g;this.Xk.style.height=this.C9g;this.Xk.style.marginTop=this.D9g;this.Xk.style.padding=this.E9g}VI(){super.VI();this.wb.style.width=String.format("{0}px",this.dialogWidth);this.wb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.gBg()}}Object(t.a)(z,"AddInCommandsDialog",B.a,[]);var A=a(55),
y=a(68);B=a(99);a.d(E,"a",function(){return D});class D extends e{constructor(I,M,T,S=null,H=null){super();this.$=I;this.Xd=M;this.ownerAddinInfo=T;this.Wd=H;this.Hdb=S||A.Task.Ra(!0)}y9g(){const I=this.Hdb;this.Hdb=A.Task.Ra(!0);return I}disposeHost(I){this.Xd.FRa(I)}setOwnerAddinEToken(I){this.ownerAddinInfo.eToken=I}showTaskpane(I,M,T){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let S=null,H=!1,C=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new h.a,
!0)).lLe(I.solutionId.substr(this.ownerAddinInfo.solutionId.length));S=M.getSharedRuntimeForTaskpane("Workbook",C);H=!!S&&1===S.LifeTime;this.Xd.eDe(H?this.ownerAddinInfo.solutionId:I.solutionId,H?S:null,null)||(this.ptf(H,!0),this.Hdb=this.Epd(I,S,(G,J)=>{G?(H&&(G.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,G.SharedRuntime=S),G.WebExtensionOsfControlType=3,this.Xd.TIa(G),T(G.InstanceId,J),this.ptf(H,!1),u.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),T(null,J))}))}getSettings(I,M){let T=this.Xd.Saa(I.solutionId);T?M(this.Xd.XZ(T).OsfPropertyBag):this.Hdb=this.Epd(I,null,S=>{S?M(S.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(I,M,T){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const S=this.$.pa.xa,H=G=>{const J=G.Result,L=J?J.AgaveData:
null;L?(this.Xd.gKe(L,()=>{const P=new z(()=>{this.disposeHost(L.InstanceId)});P.initializeAndShow("",null,null);return P.containerDiv}),T(L.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),T(null,G.Errors?G.Errors[0].ErrorCause:5001))},C=D.rtb(I,this.ownerAddinInfo);this.Hdb=n.a(this.$.userOperationManager,(G,J,L)=>l(S,C,v.b(G,H),J,L,null),G=>new x.a(500,0,G,64),this.Wd)}createUILessSandbox(I,M,T){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");
const S=M.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),H=!!S&&1===S.LifeTime;(M=this.Xd.KHh(H?this.ownerAddinInfo.solutionId:I.solutionId,H?S:null))?T(M,0):this.Hdb=this.Epd(I,S,(C,G)=>{C?(H?(C.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,C.SharedRuntime=S,C.TaskpaneVisible=!1,C.WebExtensionOsfControlType=3,this.Xd.TIa(C)):(C.WebExtensionOsfControlType=4,this.Xd.gKe(C,()=>{D.Kgb.ia(C.InstanceId,new d.a);return D.Kgb.ma(C.InstanceId).Uia})),T(C.InstanceId,G)):(b.ULS.sendTraceTag(537170636,
220,10,"UILess: instance id is null."),T(null,G))})}Epd(I,M,T){let S=null;const H=this.$.pa.xa,C=aa=>{const U=aa.Result;(S=U?U.AgaveData:null)||T(null,aa.Errors?aa.Errors[0].ErrorCause:5001)},G=D.rtb(I,this.ownerAddinInfo);M&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),G.SharedRuntimeId=M.Resid);let J=500;var L=(aa,U,K)=>l(H,G,v.b(aa,C),U,K,null);let P=0;void 0===G.IsToBePersisted||null===G.IsToBePersisted||G.IsToBePersisted||(J=538,L=(aa,U,K)=>{b.ULS.sendTraceTag(537170633,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return w(H,G,v.b(aa,C),U,K,null)},P=16);P|=64;L=n.a(this.$.userOperationManager,L,aa=>new x.a(J,0,aa,P),this.Wd);return r.TaskExtensions.ts(L,()=>S?this.oxd(H,S.InstanceId,(aa,U)=>{if(aa){M||(S.PrimaryMarketplace.MarketplaceType=I.storeType);
u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(I.assetId?I.assetId.toLowerCase().startsWith("wa")?S.AssetMarketplace={SolutionId:I.assetId,SolutionVersion:I.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:I.assetStoreId}:(S.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,50,"WACExcelAddinCommandsHost: AssetId is not a valid value")):S.AssetMarketplace=null);S.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;S.OwnerAddinStoreType=this.ownerAddinInfo.storeType;
S.OsfPropertyBag=[];for(U=0;U<aa.Settings.length;U++){const K=[];K[0]=aa.Settings[U].Name;K[1]=aa.Settings[U].Value;S.OsfPropertyBag[U]=K}T(S,0)}else T(null,U.Errors?U.Errors[0].ErrorCause:5001)}):A.Task.Ra(!1),c.a.none,3,y.a.current)}oxd(I,M,T){const S=H=>{T(H.Result,H)};return n.a(this.$.userOperationManager,(H,C,G)=>{H=v.b(H,S);const J=I.Oa(1);J.controlId=M;return m.g(I,"DdaLoadSettings",J,H,C,G,null,0)},H=>new x.a(501,0,H,80),this.Wd)}ptf(I,M){var T;I&&(null===(T=window.performance)||void 0===
T?0:T.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${M}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(I){D.Kgb.kb(I)&&D.Kgb.ma(I).initializeAndShowWithTitle()}static hideUILessDialog(I){D.Kgb.kb(I)&&D.Kgb.ma(I).hide()}static rtb(I,M){const T={};T.SolutionId=I.solutionId;T.Version=I.version;T.StoreType=
M.storeType;T.StoreId=I.storeId;T.AssetId=I.solutionId;T.AssetStoreId="omex";T.TargetType=1;T.Width=350;T.OwnerAddinSolutionId=M.solutionId;T.OwnerAddinStoreType=M.storeType;T.SharedRuntimeId=null;T.Preload=!1;return T}}D.Kgb=new B.a;Object(t.a)(D,"WACExcelAddinCommandsHost",e,[])},1242:function(t,E,a){var c=a(9);t=a(0);var b=a(695),e=a(15),f=a(103),d=a(4),h=a(1310),m=a(1),l=a(184),w=a(55);class n{constructor(B,z,A){this.Otb=null;this.$=B;z?(e.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),
this.Otb=new h.a(B,z,A)):e.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}nc(){return!1}executeCommand(B,z,A){B=!1;switch(z.command){case 73979048:this.Otb&&this.Otb.U6i(z,f.a.instance,d.AFrameworkApplication.fa,A),B=!0}return B?w.Task.Ra(!0):l.a(z.command)}yc(B,z){return 73979048===z.command&&m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Lc(){return!1}dispose(){this.Otb&&this.Otb.dispose()}}
Object(t.a)(n,"DataFromPictureCommandHandler",null,[219,3]);var x=a(37),r=a(48);class u extends b.a{constructor(B){super(B)}ld(){const B=r.GetServiceTaskFactory.Na(this.$.da,328,327,1),z=r.GetServiceTaskFactory.Na(this.$.da,484,485,1);x.TaskExtensions.za(x.TaskExtensions.Ed([B,z],this.$.ka),()=>{this.Zc([new n(this.$,B.result,z.result)])},this.$.ka,3)}static la(B){b.a.Nd(452,new u(B))}}Object(t.a)(u,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return v});const v=()=>{c.a.Fa(B=>
{u.la(B)})}},1302:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static aPh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(t.a)(c,"WopiAuthContext",null,[449])},1303:function(t,
E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.pLf="OneDriveWOPI";Object(t.a)(c,"HostApplicationType",null,[])},1310:function(t,E,a){(function(c){a.d(E,"a",function(){return D});var b=a(0),e=a(15),f=a(171),d=a(83),h=a(1316),m=a(38),l=a(250),w=a(40),n=a(374),x=a(188),r=a(60),u=a(92),v=a(13),B=a(21),z=a(41),A=a(1317),y=a(1);class D extends m.a{constructor(I,M,T){super();this.Ndi=h.a.getTypeName();this.Kzb=this.yU=this.Wd=null;this.imageHeight=this.imageWidth=0;this.QMa=this.errorMessage=this.tableData=
null;this.Und=0;this.vWc=!1;this.rLe=S=>{if(S){var H={};if(({Gt:H}=z.d(this.ekh(S.data))).returnValue&&(S=Object(d.a)(Object,H),"."===S.DataFromPictureWildcard))if(S.SessionId!==this.QMa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
S.CmdType){case "ACK":this.vWc=!0;this.meg.stop();e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.juj();0<this.errorMessage.length?this.f3f():0<this.tableData.length&&this.y3f();break;case "insert_html":const G=this.$.pa.xa;H={};var C=B.h(this.$).ha.ra.ed.clone();H.PasteId=f.a.create().toString();H.DestinationRanges=w.s(w.v(C,this.$));C=S.Parameters.split("|",3);y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||e.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${C[0]}|${C[1]}|${C[2]}.`);C=S.Parameters.indexOf("|");C=S.Parameters.indexOf("|",C+1);C=S.Parameters.indexOf("|",C+1);H.SourceHtml=S.Parameters.substring(C+1);H.CopyOperationId=null;const J=G.Oa(1,G.Wb());J.pasteHtmlParameters=H;n.a(this.$.userOperationManager,(L,P,aa)=>r.g(G,"pasteHtmlContent",J,L,P,aa,null,64),L=>new x.a(204,0,L,1),null);this.Und++;e.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Und.toString()}`)}}};
this.Mdi=(S,H)=>{if(S=H.KM)if(!H.parentPath||1>=H.parentPath.length||H.parentPath[1]!==this.QMa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");H=S.errorCode;switch(H){case null:case -1:this.errorMessage=v.a.instance.ga(2267);break;case 1:this.errorMessage=v.a.instance.ga(2268);
break;case 2:this.errorMessage=v.a.instance.ga(2269)}0<this.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${H?H.toString():"null"}.`);this.Rue.stop();this.tableData=S.html;this.vWc&&(0<this.errorMessage.length?this.f3f():0<this.tableData.length&&this.y3f())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=I;this.augmentationLoopManager=
M;this.uploaderCreator=T;this.initialize()}dispose(){window.removeEventListener("message",this.rLe,!1);this.augmentationLoopManager.unregister("DataFromPicture");super.dispose()}zZi(I,M){e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let T=new Image;T.onload=()=>{var S=document.createElement("canvas");S.width=T.width;S.height=T.height;const H=S.getContext("2d");try{H.drawImage(T,0,0,T.width,T.height)}catch(J){e.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${J.message}`);
return}let C;try{C=S.toDataURL("image/jpeg")}catch(J){e.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${J.message}`);return}S=C.split(",");if(2>S.length)e.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{S=S[1];try{var G=window.self.atob(S)}catch(J){e.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${J.message}`);
return}28E5<G.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),M.qHj()):(this.Aqj(this.Wd,this.yU,S,T.width,T.height),URL.revokeObjectURL(T.src),T=null,e.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};T.src=I}U6i(I,M,T,S){this.Wd=I;this.yU=S;this.uploaderCreator.ugi(this.$,M,T,S,this)}Aqj(I,M,T,S,H){this.QMa=f.a.create().toString();this.Und=0;this.Kzb=T;this.imageWidth=S;this.imageHeight=
H;this.errorMessage=this.tableData="";this.vWc=!1;this.meg=this.$.Kb.Qg("LoadResource","DataFromPictureTaskpaneLaunch");this.meg.start();this.j1i(I,M);this.Rue=this.$.Kb.Qg("LoadResource","DataFromPictureAnnotation");this.Rue.start();this.c1j()}c1j(){if(this.Kzb.length){var I=window.self.atob(this.Kzb);var M=new Uint8Array(I.length);for(let T=0;T<I.length;T++)M[T]=I.charCodeAt(T);this.augmentationLoopManager.b1j(M,this.QMa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}j1i(I,
M){M.SessionID=this.QMa;M.DataFromPictureAssetId="FA000000050";M.LoadDataFromPictureTaskpane=!0;I=new u.a(-859308420,I.method,I.mode,I.We,I.tabName);this.$.Ka.Lb(I,M)}fad(I){try{const M=c.from(I,"utf16le").toString("base64");return A.a.JIa(this.QMa,M)}catch(M){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}ekh(I){try{const M=A.a.JIa(this.QMa,I);return c.from(M,"base64").toString("utf16le")}catch(M){return e.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}juj(){if(this.Kzb.length){var I=l.a(this.$).Saa("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.imageData=this.fad(this.Kzb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",M,T=>{T&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}y3f(){if(this.tableData.length){var I=
l.a(this.$).Saa("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.tableHtml=this.fad(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",M,T=>{T&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}f3f(){if(this.errorMessage.length){var I=
l.a(this.$).Saa("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.errorMessage=this.fad(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",M,T=>{T&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",
this.rLe,!1);this.augmentationLoopManager.register(this.augmentationLoopManager.tcc().dzc("DataFromPicture").Ryc(()=>{}).activateAnnotation({annotationType:this.Ndi,NN:!1,oma:this.Mdi}).build())}}Object(b.a)(D,"DataFromPictureManager",m.a,[516])}).call(this,a(1311).Pog)},1311:function(t,E,a){(function(c){function b(){try{var H=new Uint8Array(1);H.__proto__={__proto__:Uint8Array.prototype,f7j:function(){return 42}};return"function"===typeof H.subarray&&0===H.subarray(1,1).byteLength}catch(C){return!1}}
function e(H,C){if((f.xP?2147483647:1073741823)<C)throw new RangeError("Invalid typed array length");f.xP?(H=new Uint8Array(C),H.__proto__=f.prototype):(null===H&&(H=new f(C)),H.length=C);return H}function f(H,C,G){if(!(f.xP||this instanceof f))return new f(H,C,G);if("number"===typeof H){if("string"===typeof C)throw Error("If encoding is specified then the first argument must be a string");return m(this,H)}return d(this,H,C,G)}function d(H,C,G,J){if("number"===typeof C)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&C instanceof ArrayBuffer){C.byteLength;if(0>G||C.byteLength<G)throw new RangeError("'offset' is out of bounds");if(C.byteLength<G+(J||0))throw new RangeError("'length' is out of bounds");C=void 0===G&&void 0===J?new Uint8Array(C):void 0===J?new Uint8Array(C,G):new Uint8Array(C,G,J);f.xP?(H=C,H.__proto__=f.prototype):H=l(H,C);C=H}else if("string"===typeof C){J=H;H=G;if("string"!==typeof H||""===H)H="utf8";if(!f.kjf(H))throw new TypeError('"encoding" must be a valid string encoding');
G=x(C,H)|0;J=e(J,G);C=J.write(C,H);C!==G&&(J=J.slice(0,C));C=J}else C=w(H,C);return C}function h(H){if("number"!==typeof H)throw new TypeError('"size" argument must be a number');if(0>H)throw new RangeError('"size" argument must not be negative');}function m(H,C){h(C);H=e(H,0>C?0:n(C)|0);if(!f.xP)for(var G=0;G<C;++G)H[G]=0;return H}function l(H,C){var G=0>C.length?0:n(C.length)|0;H=e(H,G);for(var J=0;J<G;J+=1)H[J]=C[J]&255;return H}function w(H,C){if(f.isBuffer(C)){var G=n(C.length)|0;H=e(H,G);if(0===
H.length)return H;C.copy(H,0,0,G);return H}if(C){if("undefined"!==typeof ArrayBuffer&&C.buffer instanceof ArrayBuffer||"length"in C)return(G="number"!==typeof C.length)||(G=C.length,G=G!==G),G?e(H,0):l(H,C);if("Buffer"===C.type&&M(C.data))return l(H,C.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function n(H){if(H>=(f.xP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.xP?2147483647:
1073741823).toString(16)+" bytes");return H|0}function x(H,C){if(f.isBuffer(H))return H.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(H)||H instanceof ArrayBuffer))return H.byteLength;"string"!==typeof H&&(H=""+H);var G=H.length;if(0===G)return 0;for(var J=!1;;)switch(C){case "ascii":case "latin1":case "binary":return G;case "utf8":case "utf-8":case void 0:return z(H).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
G;case "hex":return G>>>1;case "base64":return y(H).length;default:if(J)return z(H).length;C=(""+C).toLowerCase();J=!0}}function r(H,C,G){var J=!1;if(void 0===C||0>C)C=0;if(C>this.length)return"";if(void 0===G||G>this.length)G=this.length;if(0>=G)return"";G>>>=0;C>>>=0;if(G<=C)return"";for(H||(H="utf8");;)switch(H){case "hex":H=C;C=G;G=this.length;if(!H||0>H)H=0;if(!C||0>C||C>G)C=G;J="";for(G=H;G<C;++G)H=J,J=this[G],J=16>J?"0"+J.toString(16):J.toString(16),J=H+J;return J;case "utf8":case "utf-8":return B(this,
C,G);case "ascii":H="";for(G=Math.min(this.length,G);C<G;++C)H+=String.fromCharCode(this[C]&127);return H;case "latin1":case "binary":H="";for(G=Math.min(this.length,G);C<G;++C)H+=String.fromCharCode(this[C]);return H;case "base64":return 0===C&&G===this.length?I.Y_e(this):I.Y_e(this.slice(C,G));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":C=this.slice(C,G);G="";for(H=0;H<C.length;H+=2)G+=String.fromCharCode(C[H]+256*C[H+1]);return G;default:if(J)throw new TypeError("Unknown encoding: "+
H);H=(H+"").toLowerCase();J=!0}}function u(H,C,G,J,L){if(0===H.length)return-1;"string"===typeof G?(J=G,G=0):2147483647<G?G=2147483647:-2147483648>G&&(G=-2147483648);G=+G;isNaN(G)&&(G=L?0:H.length-1);0>G&&(G=H.length+G);if(G>=H.length){if(L)return-1;G=H.length-1}else if(0>G)if(L)G=0;else return-1;"string"===typeof C&&(C=f.from(C,J));if(f.isBuffer(C))return 0===C.length?-1:v(H,C,G,J,L);if("number"===typeof C)return C&=255,f.xP&&"function"===typeof Uint8Array.prototype.indexOf?L?Uint8Array.prototype.indexOf.call(H,
C,G):Uint8Array.prototype.lastIndexOf.call(H,C,G):v(H,[C],G,J,L);throw new TypeError("val must be string, number or Buffer");}function v(H,C,G,J,L){function P(Y,na){return 1===aa?Y[na]:Y.ecj(na*aa)}var aa=1,U=H.length,K=C.length;if(void 0!==J&&(J=String(J).toLowerCase(),"ucs2"===J||"ucs-2"===J||"utf16le"===J||"utf-16le"===J)){if(2>H.length||2>C.length)return-1;aa=2;U/=2;K/=2;G/=2}if(L)for(J=-1;G<U;G++)if(P(H,G)===P(C,-1===J?0:G-J)){if(-1===J&&(J=G),G-J+1===K)return J*aa}else-1!==J&&(G-=G-J),J=-1;
else for(G+K>U&&(G=U-K);0<=G;G--){U=!0;for(J=0;J<K;J++)if(P(H,G+J)!==P(C,J)){U=!1;break}if(U)return G}return-1}function B(H,C,G){G=Math.min(H.length,G);for(var J=[];C<G;){var L=H[C],P=null,aa=239<L?4:223<L?3:191<L?2:1;if(C+aa<=G)switch(aa){case 1:128>L&&(P=L);break;case 2:var U=H[C+1];128===(U&192)&&(L=(L&31)<<6|U&63,127<L&&(P=L));break;case 3:U=H[C+1];var K=H[C+2];128===(U&192)&&128===(K&192)&&(L=(L&15)<<12|(U&63)<<6|K&63,2047<L&&(55296>L||57343<L)&&(P=L));break;case 4:U=H[C+1];K=H[C+2];var Y=H[C+
3];128===(U&192)&&128===(K&192)&&128===(Y&192)&&(L=(L&15)<<18|(U&63)<<12|(K&63)<<6|Y&63,65535<L&&1114112>L&&(P=L))}null===P?(P=65533,aa=1):65535<P&&(P-=65536,J.push(P>>>10&1023|55296),P=56320|P&1023);J.push(P);C+=aa}H=J.length;if(H<=T)J=String.fromCharCode.apply(String,J);else{G="";for(C=0;C<H;)G+=String.fromCharCode.apply(String,J.slice(C,C+=T));J=G}return J}function z(H,C){C=C||Infinity;for(var G,J=H.length,L=null,P=[],aa=0;aa<J;++aa){G=H.charCodeAt(aa);if(55295<G&&57344>G){if(!L){if(56319<G){-1<
(C-=3)&&P.push(239,191,189);continue}else if(aa+1===J){-1<(C-=3)&&P.push(239,191,189);continue}L=G;continue}if(56320>G){-1<(C-=3)&&P.push(239,191,189);L=G;continue}G=(L-55296<<10|G-56320)+65536}else L&&-1<(C-=3)&&P.push(239,191,189);L=null;if(128>G){if(0>--C)break;P.push(G)}else if(2048>G){if(0>(C-=2))break;P.push(G>>6|192,G&63|128)}else if(65536>G){if(0>(C-=3))break;P.push(G>>12|224,G>>6&63|128,G&63|128)}else if(1114112>G){if(0>(C-=4))break;P.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw Error("Invalid code point");
}return P}function A(H){for(var C=[],G=0;G<H.length;++G)C.push(H.charCodeAt(G)&255);return C}function y(H){var C=I,G=C.MRj;H=(H.trim?H.trim():H.replace(/^\s+|\s+$/g,"")).replace(S,"");if(2>H.length)H="";else for(;0!==H.length%4;)H+="=";return G.call(C,H)}function D(H,C,G,J){for(var L=0;L<J&&!(L+G>=C.length||L>=H.length);++L)C[L+G]=H[L];return L}var I=a(1313);a(1314);var M=a(1315);E.Pog=f;E.D6j=function(H){+H!=H&&(H=0);return f.kue(+H)};E.k6j=50;f.xP=void 0!==c.xP?c.xP:b();E.n7j=f.xP?2147483647:1073741823;
f.from=function(H,C,G){return d(null,H,C,G)};f.xP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.kue=function(H){h(H);return e(null,H)};f.VQg=function(H){return m(null,H)};f.isBuffer=function(H){return!(null==H||!H.Ryg)};f.compare=function(H,C){if(!f.isBuffer(H)||!f.isBuffer(C))throw new TypeError("Arguments must be Buffers");if(H===C)return 0;
for(var G=H.length,J=C.length,L=0,P=Math.min(G,J);L<P;++L)if(H[L]!==C[L]){G=H[L];J=C[L];break}return G<J?-1:J<G?1:0};f.kjf=function(H){switch(String(H).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(H,C){if(!M(H))throw new TypeError('"list" argument must be an Array of Buffers');if(0===H.length)return f.kue(0);var G;if(void 0===C)for(G=C=
0;G<H.length;++G)C+=H[G].length;C=f.VQg(C);var J=0;for(G=0;G<H.length;++G){var L=H[G];if(!f.isBuffer(L))throw new TypeError('"list" argument must be an Array of Buffers');L.copy(C,J);J+=L.length}return C};f.byteLength=x;f.prototype.Ryg=!0;f.prototype.toString=function(){var H=this.length|0;return 0===H?"":0===arguments.length?B(this,0,H):r.apply(this,arguments)};f.prototype.equals=function(H){if(!f.isBuffer(H))throw new TypeError("Argument must be a Buffer");return this===H?!0:0===f.compare(this,
H)};f.prototype.compare=function(H,C,G,J,L){if(!f.isBuffer(H))throw new TypeError("Argument must be a Buffer");void 0===C&&(C=0);void 0===G&&(G=H?H.length:0);void 0===J&&(J=0);void 0===L&&(L=this.length);if(0>C||G>H.length||0>J||L>this.length)throw new RangeError("out of range index");if(J>=L&&C>=G)return 0;if(J>=L)return-1;if(C>=G)return 1;C>>>=0;G>>>=0;J>>>=0;L>>>=0;if(this===H)return 0;var P=L-J,aa=G-C,U=Math.min(P,aa);J=this.slice(J,L);H=H.slice(C,G);for(C=0;C<U;++C)if(J[C]!==H[C]){P=J[C];aa=
H[C];break}return P<aa?-1:aa<P?1:0};f.prototype.includes=function(H,C,G){return-1!==this.indexOf(H,C,G)};f.prototype.indexOf=function(H,C,G){return u(this,H,C,G,!0)};f.prototype.lastIndexOf=function(H,C,G){return u(this,H,C,G,!1)};f.prototype.write=function(H,C,G,J){if(void 0===C)J="utf8",G=this.length,C=0;else if(void 0===G&&"string"===typeof C)J=C,G=this.length,C=0;else if(isFinite(C))C|=0,isFinite(G)?(G|=0,void 0===J&&(J="utf8")):(J=G,G=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var L=this.length-C;if(void 0===G||G>L)G=L;if(0<H.length&&(0>G||0>C)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(L=!1;;)switch(J){case "hex":C=Number(C)||0;J=this.length-C;G?(G=Number(G),G>J&&(G=J)):G=J;J=H.length;if(0!==J%2)throw new TypeError("Invalid hex string");G>J/2&&(G=J/2);for(J=0;J<G;++J){L=parseInt(H.substr(2*J,2),16);if(isNaN(L))break;this[C+J]=L}return J;case "utf8":case "utf-8":return D(z(H,this.length-C),this,C,G);case "ascii":return D(A(H),
this,C,G);case "latin1":case "binary":return D(A(H),this,C,G);case "base64":return D(y(H),this,C,G);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=H;L=this.length-C;for(var P=[],aa=0;aa<J.length&&!(0>(L-=2));++aa){var U=J.charCodeAt(aa);H=U>>8;U%=256;P.push(U);P.push(H)}return D(P,this,C,G);default:if(L)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase();L=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.I6j||this,0)}};var T=4096;
f.prototype.slice=function(H,C){var G=this.length;H=~~H;C=void 0===C?G:~~C;0>H?(H+=G,0>H&&(H=0)):H>G&&(H=G);0>C?(C+=G,0>C&&(C=0)):C>G&&(C=G);C<H&&(C=H);if(f.xP)C=this.subarray(H,C),C.__proto__=f.prototype;else{G=C-H;C=new f(G,void 0);for(var J=0;J<G;++J)C[J]=this[J+H]}return C};f.prototype.ecj=function(H){if(0!==H%1||0>H)throw new RangeError("offset is not uint");if(H+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[H]<<8|this[H+1]};f.prototype.copy=function(H,
C,G,J){G||(G=0);J||0===J||(J=this.length);C>=H.length&&(C=H.length);C||(C=0);0<J&&J<G&&(J=G);if(J===G||0===H.length||0===this.length)return 0;if(0>C)throw new RangeError("targetStart out of bounds");if(0>G||G>=this.length)throw new RangeError("sourceStart out of bounds");if(0>J)throw new RangeError("sourceEnd out of bounds");J>this.length&&(J=this.length);H.length-C<J-G&&(J=H.length-C+G);var L=J-G;if(this===H&&G<C&&C<J)for(J=L-1;0<=J;--J)H[J+C]=this[J+G];else if(1E3>L||!f.xP)for(J=0;J<L;++J)H[J+C]=
this[J+G];else Uint8Array.prototype.set.call(H,this.subarray(G,G+L),C);return L};f.prototype.fill=function(H,C,G,J){if("string"===typeof H){"string"===typeof C?(J=C,C=0,G=this.length):"string"===typeof G&&(J=G,G=this.length);if(1===H.length){var L=H.charCodeAt(0);256>L&&(H=L)}if(void 0!==J&&"string"!==typeof J)throw new TypeError("encoding must be a string");if("string"===typeof J&&!f.kjf(J))throw new TypeError("Unknown encoding: "+J);}else"number"===typeof H&&(H&=255);if(0>C||this.length<C||this.length<
G)throw new RangeError("Out of range index");if(G<=C)return this;C>>>=0;G=void 0===G?this.length:G>>>0;H||(H=0);if("number"===typeof H)for(J=C;J<G;++J)this[J]=H;else for(H=f.isBuffer(H)?H:z((new f(H,J)).toString()),L=H.length,J=0;J<G-C;++J)this[J+C]=H[J%L];return this};var S=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1312))},1312:function(t){var E=function(){return this}();try{E=E||(new Function("return this"))()}catch(a){"object"===typeof window&&(E=window)}t.exports=E},1313:function(t,E){function a(f){var d=
f.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=d);return[f,f===d?0:4-f%4]}E.byteLength=function(f){f=a(f);var d=f[1];return 3*(f[0]+d)/4-d};E.MRj=function(f){var d=a(f);var h=d[0];d=d[1];var m=new e(3*(h+d)/4-d),l=0,w=0<d?h-4:h,n;for(n=0;n<w;n+=4)h=b[f.charCodeAt(n)]<<18|b[f.charCodeAt(n+1)]<<12|b[f.charCodeAt(n+2)]<<6|b[f.charCodeAt(n+3)],m[l++]=h>>16&255,m[l++]=h>>8&255,m[l++]=h&255;2===d&&(h=b[f.charCodeAt(n)]<<2|b[f.charCodeAt(n+1)]>>
4,m[l++]=h&255);1===d&&(h=b[f.charCodeAt(n)]<<10|b[f.charCodeAt(n+1)]<<4|b[f.charCodeAt(n+2)]>>2,m[l++]=h>>8&255,m[l++]=h&255);return m};E.Y_e=function(f){for(var d=f.length,h=d%3,m=[],l=0,w=d-h;l<w;l+=16383){for(var n=m,x=n.push,r,u=f,v=l+16383>w?w:l+16383,B=[],z=l;z<v;z+=3)r=(u[z]<<16&16711680)+(u[z+1]<<8&65280)+(u[z+2]&255),B.push(c[r>>18&63]+c[r>>12&63]+c[r>>6&63]+c[r&63]);r=B.join("");x.call(n,r)}1===h?(f=f[d-1],m.push(c[f>>2]+c[f<<4&63]+"==")):2===h&&(f=(f[d-2]<<8)+f[d-1],m.push(c[f>>10]+c[f>>
4&63]+c[f<<2&63]+"="));return m.join("")};var c=[],b=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(t=0;64>t;++t)c[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(t)]=t;b[45]=62;b[95]=63},1314:function(t,E){E.read=function(a,c,b,e,f){var d=8*f-e-1;var h=(1<<d)-1,m=h>>1,l=-7;f=b?f-1:0;var w=b?-1:1,n=a[c+f];f+=w;b=n&(1<<-l)-1;n>>=-l;for(l+=d;0<l;b=256*b+a[c+f],f+=w,l-=8);d=b&(1<<-l)-1;
b>>=-l;for(l+=e;0<l;d=256*d+a[c+f],f+=w,l-=8);if(0===b)b=1-m;else{if(b===h)return d?NaN:Infinity*(n?-1:1);d+=Math.pow(2,e);b-=m}return(n?-1:1)*d*Math.pow(2,b-e)};E.write=function(a,c,b,e,f,d){var h,m=8*d-f-1,l=(1<<m)-1,w=l>>1,n=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;d=e?0:d-1;var x=e?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,e=l):(e=Math.floor(Math.log(c)/Math.LN2),1>c*(h=Math.pow(2,-e))&&(e--,h*=2),c=1<=e+w?c+n/h:c+n*Math.pow(2,1-w),2<=c*h&&(e++,h/=2),e+
w>=l?(c=0,e=l):1<=e+w?(c=(c*h-1)*Math.pow(2,f),e+=w):(c=c*Math.pow(2,w-1)*Math.pow(2,f),e=0));for(;8<=f;a[b+d]=c&255,d+=x,c/=256,f-=8);e=e<<f|c;for(m+=f;0<m;a[b+d]=e&255,d+=x,e/=256,m-=8);a[b+d-x]|=128*r}},1315:function(t){var E={}.toString;t.exports=Array.isArray||function(a){return"[object Array]"==E.call(a)}},1316:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);E=a(725);var c=a(700);class b extends E.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,
{T_:b.getTypeName(),B_:b.Pd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Pd(){return["AugLoop_Core_Annotation"]}}Object(t.a)(b,"DetectedHtmlTableAnnotation",E.a,[])},1317:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{static JIa(b,e){if(!(b&&e&&b.length&&e.length)||256<b.length)return"";const f=Array(256),d=Array(256);let h,m=0,l=0;let w,n="";for(h=0;256>h;h++)f[h]=h;for(h=0;256>h;h++){var x=b.charCodeAt(h%b.length);if(256<=x)return"";m=
(m+f[h]+x)%256;x=f[h];f[h]=f[m];f[m]=x}for(h=0;256>h;h++)d[h]=f[256-h-1];m=h=0;for(b=0;b<e.length;b++){h=(h+1)%256;m=(m+f[h])%256;x=f[h];f[h]=f[m];f[m]=x;x=e.charCodeAt(b);if(256<=x)return"";w=x^f[(f[h]+f[m])%256];l=(l+d[h])%256;x=d[h];d[h]=d[l];d[l]=x;n+=String.fromCharCode(w^f[(d[h]+d[l])%256])}return n}}Object(t.a)(c,"RC4A",null,[])},1319:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);a(15);var c=a(4);class b{constructor(e,f,d,h){this.Jlb=e;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&
d.BYh();this.Ex=f;this.PDg=h}get rFb(){return this.Jlb}get solutionId(){return this.Ex}get pVd(){return this.PDg}kLa(e){e=this.rFb+this.solutionId+e;return this.pVd?(e in b.p1b||(b.p1b[e]="AddinControl"+b.JPg++),b.p1b[e]):e}lLe(e){if(this.pVd){const d=b.p1b;for(let h in d){var f=h;if(e===d[h])return f.substr(this.rFb.length+this.solutionId.length)}}return e}h9e(e){e=this.rFb+this.solutionId+e;return this.pVd?(e in b.SYc||(b.SYc[e]="AddinTab"+b.UPg++),b.SYc[e]):e}}b.p1b={};b.SYc={};b.UPg=0;b.JPg=0;
Object(t.a)(b,"DefaultRibbonNamingProvider",null,[343])},1366:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(83),e;(function(r){r[r.none=0]="none";r[r.testEvent=1]="testEvent";r[r.test1Event=2]="test1Event";r[r.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";r[r.worksheetActivatedEvent=11]="worksheetActivatedEvent";r[r.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";r[r.worksheetAddedEvent=13]="worksheetAddedEvent";r[r.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";
r[r.worksheetDeletedEvent=15]="worksheetDeletedEvent";r[r.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";r[r.worksheetFilteredEvent=17]="worksheetFilteredEvent";r[r.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";r[r.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";r[r.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";r[r.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";r[r.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";r[r.worksheetFormulaChangedEvent=
23]="worksheetFormulaChangedEvent";r[r.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";r[r.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";r[r.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";r[r.worksheetMovedEvent=27]="worksheetMovedEvent";r[r.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";r[r.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";r[r.workbookFormulaReferenceStyleChangedEvent=30]=
"workbookFormulaReferenceStyleChangedEvent";r[r.chartAddedEvent=50]="chartAddedEvent";r[r.chartActivatedEvent=51]="chartActivatedEvent";r[r.chartDeactivatedEvent=52]="chartDeactivatedEvent";r[r.chartDeletedEvent=53]="chartDeletedEvent";r[r.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";r[r.tableDataChangedEvent=101]="tableDataChangedEvent";r[r.tableAddedEvent=102]="tableAddedEvent";r[r.tableDeletedEvent=103]="tableDeletedEvent";r[r.tableFilteredEvent=104]="tableFilteredEvent";r[r.agaveVisualUpdateEvent=
150]="agaveVisualUpdateEvent";r[r.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";r[r.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";r[r.commentAddedEvent=250]="commentAddedEvent";r[r.commentDeletedEvent=251]="commentDeletedEvent";r[r.commentChangedEvent=252]="commentChangedEvent";r[r.invocationMessage=1E3]="invocationMessage";r[r.cancellationMessage=1001]="cancellationMessage";r[r.metadataMessage=1002]="metadataMessage";r[r.visualSelectionChangedEvent=
2E3]="visualSelectionChangedEvent";r[r.visualChangeEvent=2001]="visualChangeEvent";r[r.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";r[r.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";r[r.shapeActivatedEvent=2101]="shapeActivatedEvent";r[r.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";r[r.shapeAddedEvent=2103]="shapeAddedEvent";r[r.shapeDeletedEvent=2104]="shapeDeletedEvent";r[r.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";
r[r.wacOperationEvent=2201]="wacOperationEvent";r[r.recordingStateChangedEvent=2202]="recordingStateChangedEvent";r[r.workbookActivatedEvent=2203]="workbookActivatedEvent";r[r.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";r[r.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";r[r.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";r[r.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";
r[r.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";r[r.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";r[r.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";r[r.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";r[r.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";r[r.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";r[r.lineageActivityFilterUpdatedEvent=
2801]="lineageActivityFilterUpdatedEvent";r[r.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";r[r.pivotTableAddedEvent=2900]="pivotTableAddedEvent";r[r.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";r[r.namedItemAddedEvent=3E3]="namedItemAddedEvent";r[r.namedItemDeletedEvent=3001]="namedItemDeletedEvent";r[r.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";r[r.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";
r[r.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";r[r.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(t.b)("MessageType",e);var f=a(768),d=a(250),h=a(737),m=a(58),l=a(37),w=a(153),n=a(1);a.d(E,"DdaEventDispatch",function(){return x});class x{constructor(r){this.bB=null;this.agg={};this.cgg={};this.Xdd={};this.gCd={};this.$ld=(u,v)=>{u=this.$.Kb.Cc("Task","DdaEventDispatch.HandleServerEvent");v=v.F3f;for(let y=0;y<
v.length;y++)switch(v[y].EventType){case 2:var B=v[y],z={};z.Name=B.Name;z.BindingType=B.BindingType;z.ColCount=B.ColCount;z.RowCount=B.RowCount;this.Awa(B.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,z,null);break;case 4:this.Awa(v[y].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(B=v[y],B.InstanceId){z=Array(B.Entries.length);for(var A=0;A<B.Entries.length;A++)z[A]=x.mec(B.Entries[A],B.IsRemoteOverride);0<B.Entries.length&&1===B.Entries[0].Category?
this.g8i(B.InstanceId,z):B.InstanceId&&this.Awa(B.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,z)}else{this.Xdd={};this.gCd={};for(z=0;z<B.Entries.length;z++)this.UNe(B.Entries[z],B.IsRemoteOverride);B=JSON.stringify(this.Xdd);z=JSON.stringify(this.gCd);A=JSON.stringify(this.agg);const D=JSON.stringify(this.cgg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${B}, Number of Not Fired event: ${z}, Total Number of Fired event: ${A}, Total Number of Not Fired event: ${D}`)}}u.stop()};
this.yMb=(u,v)=>{this.Awa(u,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)};this.$=r;this.yyc=this.$ld}T0b(r){r&&(this.hja(),this.bB.push(r))}Lvc(r){this.bB&&(Array.remove(this.bB,r),this.bB.length||(this.$.wantServerEvents=!1,this.$.mkj(this.yyc),this.bB=null))}g8i(r,u){const v=Object(b.a)(h.DdaFacade,d.a(this.$));l.TaskExtensions.za(v.XZh(r),B=>{if(w.b(B)){var z=B.result;B=v.yn(z);if(z)if(B.Ojc)this.Awa(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(B.Q7b)for(z=0;z<u.length;z++)B.Q7b.push(u[z]);
else B.Q7b=u}else B.Of?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):B.rh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ka,0)}D8i(r,u){const v=Object(b.a)(h.DdaFacade,d.a(this.$)),B=v.eOh(r);B?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(B,u,this.yMb):v.$ah(r,u)}UNe(r,u){let v=!1;const B=parseInt(r.Type,
10);var z=r.Target;const A=Object(b.a)(h.DdaFacade,d.a(this.$));if((z=A.hj.b_h(B,z))&&0<Object.keys(z).length){v=!0;for(let D in z)if(z=D,A.hj.d2b(z)){const I=Array(1);I[0]=x.mec(r,u);if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var y=I[0][3];if(void 0!==y&&null!==y&&(y=Object(b.a)(Object,m.a.$h(y)))&&void 0!==y.triggerControlId&&null!==y.triggerControlId&&void 0!==y.triggerSource&&null!==y.triggerSource){let M=!1;u?(y.triggerSource="Unknown",M=!0):A.Soh(y.triggerControlId,
z)&&(y.triggerSource="ThisLocalAddin",M=!0);M&&(I[0][3]=m.a.fc(y))}}this.Awa(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,I)}}v?(this.Ugc(e[B],this.Xdd),this.Ugc(e[B],this.agg)):(this.Ugc(e[B],this.gCd),this.Ugc(e[B],this.cgg))}hja(){this.bB||(this.bB=[],this.$.hte(this.yyc),this.$.wantServerEvents=!0)}Ugc(r,u){r in u||(u[r]=0);u[r]+=1}mN(r,u,v){const B={};B.Target=u;B.Category=65536;B.Type=r;B.Message=v;B.Id=-1;this.UNe(B,!1)}$Hh(r,u){const v={Target:"",Category:2,Type:1E3};v.Message=u;v.Id=
0;u=Array(1);u[0]=x.mec(v,!1);this.D8i(r,u)}mbc(r,u,v,B){const z={};z.Target=v;z.Category=65536;z.Type=u;z.Message=B;z.Id=-1;u=Array(1);u[0]=x.mec(z,!1);this.Awa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}ZHh(r,u){this.Awa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}Awa(r,u,v,B){if(this.bB){var z=Object(b.a)(h.DdaFacade,d.a(this.$));if(!z||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||z.hj.d2b(r)){r=new f.a(u,r,
v,B);for(let A=0,y=this.bB.length;A<y;A++)(u=this.bB[A])&&u(r)}}}static mec(r,u){const v=Array(6);v[0]=r.Category;v[1]=r.Type;v[2]=r.Target;v[3]=r.Message;v[4]=r.Id;v[5]=u;return v}}Object(t.a)(x,"DdaEventDispatch",null,[])},1396:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);E=a(146);var c=a(87);class b extends E.a{constructor(){super(void 0,void 0,void 0,!0);this.YDa="AddinCommandsUILessDialog";this.tVc="WACDialogTitleText";this.Efa="0";this.mY=380;this.tqa=190;this.Ee=this.YDa;this.Tb=
5;this.Wug=String.format("{0}px",this.mY);this.Dfa=String.format("{0}px",this.tqa);this.Fbf=this.Lt=!1;this.Zz()}Zz(){super.Zz();this.Xk.style.width=this.Wug;this.Xk.style.height=this.Dfa;this.Xk.style.padding=this.Efa}Tv(e){this.VI();document.getElementById(this.mi(this.tVc)).innerText=e}VI(){super.VI();this.wb.style.width=String.format("{0}px",this.mY);this.wb.style.height=String.format("{0}px",this.tqa);this.wb.removeAttribute(c.a.Ad);this.wb.removeAttribute(c.a.MM)}hide(){this.vzb()}get Uia(){return this.Xk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(t.a)(b,"AddinCommandsUILessDialog",E.a,[346])},1427:function(t,E,a){a.r(E);var c=a(513),b=a(957),e=a(1189),f=a(9),d=a(0),h=a(222),m=a(187),l=a(587);class w{constructor(){this.aib=null}get DVg(){this.aib||(this.aib=new m.a,this.aib.add(12),this.aib.add(11));return this.aib}oli(O){return this.DVg.contains(O.operation)}eWj(O){const Sa=[],Hb=O.payload;for(const hc of Hb.batchedOperations)Sa.push(new l.a(O.operation,hc));return Sa}}Object(d.a)(w,"MacroRecorderBatchedEventList",null,
[]);var n=a(15),x=a(58),r=a(121),u=a(641);class v{equals(O,Sa){return O===Sa}getHashCode(O){return O}dka(O){return O}}Object(d.a)(v,"UserOperationNameComparer",null,[106,107]);class B{static a7h(){B.Oc||(B.Oc=new u.a(new v),B.Oc.add(507),B.Oc.add(10),B.Oc.add(576),B.Oc.add(563),B.Oc.add(564),B.Oc.add(565),B.Oc.add(566),B.Oc.add(567),B.Oc.add(568),B.Oc.add(569),B.Oc.add(570),B.Oc.add(571),B.Oc.add(572),B.Oc.add(573),B.Oc.add(574),B.Oc.add(575),B.Oc.add(501),B.Oc.add(520),B.Oc.add(1),B.Oc.add(1002),
B.Oc.add(129),B.Oc.add(198),B.Oc.add(500),B.Oc.add(519),B.Oc.add(538),B.Oc.add(1E3),B.Oc.add(1003),B.Oc.add(144),B.Oc.add(502),B.Oc.add(505),B.Oc.add(179),B.Oc.add(205),B.Oc.add(134),B.Oc.add(230),B.Oc.add(103),B.Oc.add(110),B.Oc.add(112),B.Oc.add(113),B.Oc.add(124),B.Oc.add(133),B.Oc.add(154),B.Oc.add(162),B.Oc.add(168),B.Oc.add(172),B.Oc.add(201),B.Oc.add(222),B.Oc.add(227),B.Oc.add(513),B.Oc.add(534),B.Oc.add(539),B.Oc.add(545),B.Oc.add(600),B.Oc.add(547),B.Oc.add(555),B.Oc.add(558),B.Oc.add(562),
B.Oc.add(585),B.Oc.add(1001),B.Oc.add(1005),B.Oc.add(1008),B.Oc.add(1010),B.Oc.add(1011),B.Oc.add(1012),B.Oc.add(1018),B.Oc.add(252),B.Oc.add(253),B.Oc.add(258),B.Oc.add(101),B.Oc.add(102),B.Oc.add(108),B.Oc.add(257),B.Oc.add(119),B.Oc.add(120),B.Oc.add(123),B.Oc.add(126),B.Oc.add(127),B.Oc.add(130),B.Oc.add(140),B.Oc.add(159),B.Oc.add(160),B.Oc.add(165),B.Oc.add(166),B.Oc.add(167),B.Oc.add(169),B.Oc.add(189),B.Oc.add(223),B.Oc.add(214),B.Oc.add(228),B.Oc.add(233),B.Oc.add(247),B.Oc.add(504),B.Oc.add(511),
B.Oc.add(512),B.Oc.add(525),B.Oc.add(533),B.Oc.add(537),B.Oc.add(542),B.Oc.add(544),B.Oc.add(548),B.Oc.add(550),B.Oc.add(551),B.Oc.add(552),B.Oc.add(554),B.Oc.add(577),B.Oc.add(584),B.Oc.add(586),B.Oc.add(587),B.Oc.add(588),B.Oc.add(592),B.Oc.add(1009),B.Oc.add(1016),B.Oc.add(1017));return B.Oc}}B.Oc=null;Object(d.a)(B,"MacroRecorderUnrecognizedEventList",null,[]);class z{constructor(O,Sa,Hb){this.Svb=null;this.PEi=(hc,wc)=>{this.S8f()&&this.Udd(wc)};this.wvf=Sa;this.vvf=Hb;this.$=O;this.$.XV&&this.$.fOg(this.PEi);
O.da.Ga(297,this)}init(O){this.$.XV&&(O?this.Svb=O:n.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Udd(O){if(this.S8f())try{if(this.vvf.oli(O)){var Sa=this.vvf.eWj(O);for(const Hb of Sa)this.tZe(Hb)}else this.tZe(O)}catch(Hb){Sa=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${r.a(O.operation)}, Exception: ${Hb.stack}`;n.ULS.sendTraceTag(537155423,0,10,Sa);try{this.XHh(O)}catch(hc){}}}tZe(O){var Sa=this.wvf.J5e(O,!0);Sa?
(this.Svb(Sa.eventId,x.a.fc(O.payload)),n.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Sa.eventId}`)):(Sa=this.wvf.J5e(O,!1))?n.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${Sa.eventId}, but failed to match filters`):B.a7h().contains(O.operation)||(this.Svb(0,x.a.fc(O.operation)),O=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${r.a(O.operation)}`,n.ULS.sendTraceTag(537155420,0,50,O))}XHh(O){this.Svb(222,
x.a.fc(O.operation))}S8f(){return this.$.cca&&this.Svb&&this.$.Zba?!0:!1}}Object(d.a)(z,"MacroRecorderEventHandler",null,[476]);var A=a(1);class y{constructor(){this.pLc=this.qLc=this.pRc=this.QVc=null}get operations(){this.pRc||(this.pRc=new m.a,this.Xb());return this.pRc}get NFc(){this.QVc||(this.QVc=new m.a,this.ig());return this.QVc}get cYe(){this.pLc||(this.pLc=new m.a);return this.pLc}get featureGates(){this.qLc||(this.qLc=new m.a,this.bxa());return this.qLc}ig(){}bxa(){}kd(O){this.NFc.add(O)}Ob(O){this.operations.contains(O)||
this.operations.add(O)}Bob(){this.featureGates.add(629)}oqe(O){this.cYe.add(O)}}Object(d.a)(y,"MacroRecorderEventBase",null,[]);class D extends y{constructor(){super()}get eventId(){return 130}Xb(){this.Ob(100)}}Object(d.a)(D,"AccessibilityCheckRunEvent",y,[]);class I extends y{constructor(){super()}get eventId(){return 160}Xb(){this.Ob(241)}ig(){this.kd(O=>O.addToPrintArea)}}Object(d.a)(I,"AddedToPrintAreaEvent",y,[]);class M extends y{constructor(){super()}get eventId(){return 65}Xb(){this.Ob(516)}}
Object(d.a)(M,"AutoFilterToggledEvent",y,[]);class T extends y{constructor(){super()}get eventId(){return 118}Xb(){this.Ob(502)}ig(){this.kd(O=>!(O.R5a().FirstColumn===O.R5a().LastColumn&&O.R5a().FirstRow===O.R5a().LastRow))}}Object(d.a)(T,"AutoSumEvent",y,[]);class S extends y{constructor(O,Sa){super();this.Tfa=O;this.H2j=Sa}get eventId(){return this.Tfa}Xb(){this.Ob(529);this.Ob(594)}ig(){this.kd(O=>this.H2j.includes(O.bjd()))}}Object(d.a)(S,"ChartPropertyAppliedEventBase",y,[]);class H extends S{constructor(){super(84,
[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(d.a)(H,"ChartAxisChangedEvent",S,[]);class C extends S{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(d.a)(C,"ChartAxisTitleChangedEvent",S,[]);class G extends S{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(d.a)(G,"ChartDataLabelsChangedEvent",S,[]);class J extends S{constructor(){super(76,[-100])}}Object(d.a)(J,"ChartDataSelectedEvent",S,[]);class L extends S{constructor(){super(83,
[500,501,502])}}Object(d.a)(L,"ChartDataTableChangedEvent",S,[]);var P=a(554),aa=a(419),U=a(83);class K extends y{constructor(){super()}}Object(d.a)(K,"RichApiRequestExecutedEventBase",y,[]);class Y{constructor(O,Sa,Hb){this.response=this.request=this.eventId=this.source=null;O&&(this.source=O.source,this.eventId=O.eventId,this.request=Sa,this.response=Hb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(d.a)(Y,"MacroRecorderRichApiRequestExecutedPayload",
null,[145]);class na extends K{constructor(){super()}get eventId(){return 117}yy(O){na.s7||(na.s7=new u.a(P.a.ak()),na.s7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),na.s7.add("fa000000014"));return!!O&&na.s7.contains(O.toLowerCase())}Xb(){this.Ob(507);this.Ob(10);this.Ob(576)}ig(){this.kd(O=>Object(aa.a)(Y,O)&&(O=Object(U.a)(Y,O),O.isValid&&this.yy(O.source))?(n.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${O.eventId}`),!0):!1)}}
na.s7=null;Object(d.a)(na,"ChartFormatRichApiRequestExecutedEvent",K,[]);class W extends S{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(d.a)(W,"ChartGridlinesChangedEvent",S,[]);class X extends y{constructor(){super()}get eventId(){return 66}Xb(){this.Ob(528)}}Object(d.a)(X,"ChartInsertedEvent",y,[]);class Aa extends S{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(d.a)(Aa,"ChartLegendChangedEvent",S,[]);class Q extends S{constructor(){super(75,[-101])}}Object(d.a)(Q,
"ChartRowColumnSwitchedEvent",S,[]);class fa extends S{constructor(){super(79,[0,1,2,-102])}}Object(d.a)(fa,"ChartTitleChangedEvent",S,[]);class Ca extends S{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(d.a)(Ca,"ChartTypeChangedEvent",S,[]);class ia extends y{constructor(){super()}get eventId(){return 131}Xb(){this.Ob(521)}}Object(d.a)(ia,"ConnectorFloatingObjectResizedEvent",
y,[]);class Ra extends y{constructor(){super()}get eventId(){return 129}Xb(){this.Ob(109)}}Object(d.a)(Ra,"EntitySelectedEvent",y,[]);class Ya extends y{constructor(){super()}get eventId(){return 49}Xb(){this.Ob(149);this.Ob(147)}}Object(d.a)(Ya,"FindCellEvent",y,[]);class Ga extends y{constructor(){super()}get eventId(){return 96}Xb(){this.Ob(122)}}Object(d.a)(Ga,"FloatingObjectAltTextAppliedEvent",y,[]);class da extends y{constructor(){super()}get eventId(){return 93}Xb(){this.Ob(522)}}Object(d.a)(da,
"FloatingObjectDeletedEvent",y,[]);class Z extends y{constructor(){super()}get eventId(){return 94}Xb(){this.Ob(524)}}Object(d.a)(Z,"FloatingObjectMovedAndResizedEvent",y,[]);class ha extends y{constructor(){super()}get eventId(){return 95}Xb(){this.Ob(523)}}Object(d.a)(ha,"FloatingObjectRotatedEvent",y,[]);class Wa extends y{constructor(){super()}get eventId(){return 100}Xb(){this.Ob(543)}}Object(d.a)(Wa,"GroupDetailsShownOrHiddenEvent",y,[]);class ca extends y{constructor(){super()}get eventId(){return 154}Xb(){this.Ob(125)}}
Object(d.a)(ca,"HyperlinksRemovedFromRangeEvent",y,[]);class ja extends K{constructor(){super()}get eventId(){return 125}yy(O){ja.s7||(ja.s7=new u.a(P.a.ak()),ja.s7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ja.s7.add("fa000000005"));return!!O&&ja.s7.contains(O.toLowerCase())}Xb(){this.Ob(507);this.Ob(10);this.Ob(576)}ig(){this.kd(O=>Object(aa.a)(Y,O)?(O=Object(U.a)(Y,O),O.isValid&&this.yy(O.source)):!1)}}ja.s7=null;Object(d.a)(ja,"IdeasRichApiRequestExecutedEvent",K,[]);class ua extends y{constructor(){super()}get eventId(){return 136}Xb(){this.Ob(115)}}
Object(d.a)(ua,"LinkedEntityConvertedEvent",y,[]);class Za extends y{constructor(){super()}get eventId(){return 148}Xb(){this.Ob(114)}}Object(d.a)(Za,"LinkedEntityDisambiguationPaneToggledEvent",y,[]);class Pa extends y{constructor(){super()}get eventId(){return 127}Xb(){this.Ob(119)}}Object(d.a)(Pa,"MovedToEdgeEvent",y,[]);class ka extends y{constructor(){super()}get eventId(){return 135}Xb(){this.Ob(191)}bxa(){this.Bob()}}Object(d.a)(ka,"NamedSheetViewCreatedEvent",y,[]);class ra extends y{constructor(){super()}get eventId(){return 166}Xb(){this.Ob(200)}bxa(){this.Bob()}}
Object(d.a)(ra,"NamedSheetViewDeletedEvent",y,[]);class ba extends y{constructor(){super()}get eventId(){return 133}Xb(){this.Ob(192)}bxa(){this.Bob()}}Object(d.a)(ba,"NamedSheetViewExitedEvent",y,[]);class Ua extends y{constructor(){super()}get eventId(){return 162}Xb(){this.Ob(199)}bxa(){this.Bob()}}Object(d.a)(Ua,"NamedSheetViewRenamedEvent",y,[]);class Ka extends y{constructor(){super()}get eventId(){return 167}Xb(){this.Ob(195)}bxa(){this.Bob()}}Object(d.a)(Ka,"NamedSheetViewSwitchedEvent",y,
[]);class Oa extends y{constructor(){super()}get eventId(){return 99}Xb(){this.Ob(174)}}Object(d.a)(Oa,"OutlineLevelSetEvent",y,[]);class ib extends y{constructor(){super()}get eventId(){return 156}Xb(){this.Ob(244)}}Object(d.a)(ib,"PageBreakInsertedEvent",y,[]);class La extends y{constructor(){super()}get eventId(){return 157}Xb(){this.Ob(245)}}Object(d.a)(La,"PageBreakRemovedEvent",y,[]);class db extends y{constructor(){super()}get eventId(){return 158}Xb(){this.Ob(246)}}Object(d.a)(db,"PageBreaksAllResetEvent",
y,[]);class Ab extends y{constructor(){super()}get eventId(){return 112}Xb(){this.Ob(503)}ig(){this.kd(O=>!!O.pasteParameters.ClientEstimationFloatingObjectId&&2===O.pasteParameters.CopyPasteTargetType&&!O.isFromCurrentSession)}}Object(d.a)(Ab,"PasteArtOtherWorkbookEvent",y,[]);class Mb extends y{constructor(){super()}get eventId(){return 52}Xb(){this.Ob(503)}ig(){this.kd(O=>!!O.pasteParameters.ClientEstimationFloatingObjectId&&2===O.pasteParameters.CopyPasteTargetType&&O.isFromCurrentSession)}}Object(d.a)(Mb,
"PasteArtSameWorkbookEvent",y,[]);class pb extends y{constructor(){super()}get eventId(){return 110}Xb(){this.Ob(204)}}Object(d.a)(pb,"PasteHtmlEvent",y,[]);class Qb extends y{constructor(){super()}get eventId(){return 35}Xb(){this.Ob(506)}}Object(d.a)(Qb,"PasteRangeEvent",y,[]);class xb extends y{constructor(){super()}get eventId(){return 111}Xb(){this.Ob(503)}ig(){this.kd(O=>1===O.pasteParameters.CopyPasteTargetType)}}Object(d.a)(xb,"PasteShadowWorkbookRangeEvent",y,[]);class pa extends y{constructor(){super()}get eventId(){return 42}Xb(){this.Ob(180)}}
Object(d.a)(pa,"PasteStringEvent",y,[]);class Ma extends y{constructor(){super()}get eventId(){return 134}Xb(){this.Ob(220)}}Object(d.a)(Ma,"PendingMergeEvent",y,[]);class ya extends y{constructor(){super()}get eventId(){return 122}Xb(){this.Ob(510)}}Object(d.a)(ya,"PictureInsertedEvent",y,[]);class Ea extends y{constructor(){super()}get eventId(){return 153}Xb(){this.Ob(161)}}Object(d.a)(Ea,"PivotDrillToggledEvent",y,[]);class Na extends y{constructor(O,Sa){super();this.Tfa=O;this.opType=Sa}get eventId(){return this.Tfa}Xb(){this.Ob(225)}ig(){this.kd(O=>
O.opType===this.opType)}}Object(d.a)(Na,"PivotTableSettingsChangedEventBase",y,[]);class kb extends Na{constructor(){super(171,4)}}Object(d.a)(kb,"PivotTableAllItemLabelsRepeatedEvent",Na,[]);class lb extends Na{constructor(){super(184,17)}}Object(d.a)(lb,"PivotTableAltTextDescriptionChangedEvent",Na,[]);class oa extends Na{constructor(){super(183,16)}}Object(d.a)(oa,"PivotTableAltTextTitleChangedEvent",Na,[]);class Ba extends Na{constructor(){super(173,6)}}Object(d.a)(Ba,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",
Na,[]);class sa extends Na{constructor(){super(172,5)}}Object(d.a)(sa,"PivotTableBlankLineAfterEachItemToggledEvent",Na,[]);class qb extends Na{constructor(){super(170,3)}}Object(d.a)(qb,"PivotTableColumnGrandTotalShownEvent",Na,[]);class Jb extends y{constructor(){super()}get eventId(){return 98}Xb(){this.Ob(132)}}Object(d.a)(Jb,"PivotTableCreatedEvent",y,[]);class Yb extends Na{constructor(){super(177,10)}}Object(d.a)(Yb,"PivotTableDisplayErrorStringToggledEvent",Na,[]);class jb extends Na{constructor(){super(178,
11)}}Object(d.a)(jb,"PivotTableDisplayNullStringToggledEvent",Na,[]);class ab extends Na{constructor(){super(179,12)}}Object(d.a)(ab,"PivotTableErrorStringChangedEvent",Na,[]);class vb extends Na{constructor(){super(174,7)}}Object(d.a)(vb,"PivotTableExpandCollapseButtonsShownEvent",Na,[]);class Da extends Na{constructor(){super(187,20)}}Object(d.a)(Da,"PivotTableIndentChangedEvent",Na,[]);class Fa extends Na{constructor(){super(176,9)}}Object(d.a)(Fa,"PivotTableItemsWithNoDataOnColumnsShownEvent",
Na,[]);class nb extends Na{constructor(){super(175,8)}}Object(d.a)(nb,"PivotTableItemsWithNoDataOnRowsShownEvent",Na,[]);class Ta extends Na{constructor(){super(186,19)}}Object(d.a)(Ta,"PivotTableLayoutTypeSetEvent",Na,[]);class V extends Na{constructor(){super(180,13)}}Object(d.a)(V,"PivotTableNullStringChangedEvent",Na,[]);class va extends y{constructor(){super()}get eventId(){return 149}Xb(){this.Ob(219)}}Object(d.a)(va,"PivotTablePivotLocationChangedEvent",y,[]);class wb extends y{constructor(){super()}get eventId(){return 102}Xb(){this.Ob(145)}}
Object(d.a)(wb,"PivotTablePivotedEvent",y,[]);class fc extends Na{constructor(){super(182,15)}}Object(d.a)(fc,"PivotTableRefreshDataOnLoadToggledEvent",Na,[]);class Fc extends y{constructor(){super()}get eventId(){return 104}Xb(){this.Ob(50)}ig(){this.kd(O=>!!O.pivotTableId&&!!O.pivotTableName)}}Object(d.a)(Fc,"PivotTableRefreshedEvent",y,[]);class Qa extends Na{constructor(){super(168,1)}}Object(d.a)(Qa,"PivotTableRenamedEvent",Na,[]);class la extends Na{constructor(){super(169,2)}}Object(d.a)(la,
"PivotTableRowGrandTotalShownEvent",Na,[]);class hb extends Na{constructor(){super(181,14)}}Object(d.a)(hb,"PivotTableSaveSourceDataWithFileToggledEvent",Na,[]);var Kb=a(608);class dc extends y{constructor(){super()}get eventId(){return 155}Xb(){this.Ob(131)}ig(){this.kd(O=>{O=Object(U.a)(Kb.a,O);return!!O&&!!O.oLa()&&!!O.hierarchyName})}}Object(d.a)(dc,"PivotTableSortedEvent",y,[]);class sb extends Na{constructor(){super(185,18)}}Object(d.a)(sb,"PivotTableSubTotalsVisibilitySettingSetEvent",Na,[]);
class bb extends y{constructor(){super()}get eventId(){return 206}Xb(){this.Ob(560)}}Object(d.a)(bb,"PivotValueFieldSettingAppliedEvent",y,[]);class Ob extends y{constructor(){super()}get eventId(){return 161}Xb(){this.Ob(243)}}Object(d.a)(Ob,"PrintAreaClearedEvent",y,[]);class gc extends y{constructor(){super()}get eventId(){return 159}Xb(){this.Ob(241)}ig(){this.kd(O=>!O.addToPrintArea)}}Object(d.a)(gc,"PrintAreaSetEvent",y,[]);class mb extends y{constructor(){super()}get eventId(){return 57}Xb(){this.Ob(517)}}
Object(d.a)(mb,"RangeAutoFilterClearedEvent",y,[]);class Nb extends y{constructor(O,Sa){super();this.Tfa=O;this.d3d=Sa}get eventId(){return this.Tfa}Xb(){this.Ob(11)}ig(){this.kd(O=>16===O.d_().ValidMembers);this.kd(O=>O.d_().Font.ValidMembers===this.d3d)}}Object(d.a)(Nb,"RangeFontFormattedEventBase",y,[]);class ic extends Nb{constructor(){super(3,4)}}Object(d.a)(ic,"RangeBoldedEvent",Nb,[]);class gb extends y{constructor(){super()}get eventId(){return 2}Xb(){this.Ob(11)}ig(){this.kd(O=>128===O.d_().ValidMembers)}}
Object(d.a)(gb,"RangeBorderedEvent",y,[]);class Eb{}Eb.Zab="Table";Eb.Qrc="Sheet";Object(d.a)(Eb,"MacroRecorderEventConstants",null,[]);class Lc extends y{constructor(){super()}get eventId(){return 113}Xb(){this.Ob(208)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Qrc)}}Object(d.a)(Lc,"RangeCheckedItemsFilteredEvent",y,[]);class Ec extends y{constructor(){super()}get eventId(){return 109}Xb(){this.Ob(105)}}Object(d.a)(Ec,"RangeConditionalFormattingCreatedEvent",y,[]);class Cb extends y{constructor(){super()}get eventId(){return 124}Xb(){this.Ob(221)}}
Object(d.a)(Cb,"RangeConditionalFormattingRuleDeletedEvent",y,[]);class eb extends y{constructor(){super()}get eventId(){return 29}Xb(){this.Ob(508)}ig(){this.kd(O=>3===O.vs()||1===O.vs()||4===O.vs())}}Object(d.a)(eb,"RangeContentClearedEvent",y,[]);class Sb extends y{constructor(){super()}get eventId(){return 40}Xb(){this.Ob(104)}}Object(d.a)(Sb,"RangeCopiedCutCellsInsertedEvent",y,[]);class ld extends y{constructor(){super()}get eventId(){return 114}Xb(){this.Ob(209)}ig(){this.kd(O=>O.getParameters().FilterType===
Eb.Qrc)}}Object(d.a)(ld,"RangeCustomFilteredEvent",y,[]);class bd extends y{constructor(){super()}get eventId(){return 106}Xb(){this.Ob(121)}}Object(d.a)(bd,"RangeDataValidationChangedEvent",y,[]);class ec extends Nb{constructor(){super(4,64)}}Object(d.a)(ec,"RangeDoubleUnderlinedEvent",Nb,[]);class sc extends y{constructor(){super()}get eventId(){return 69}Xb(){this.Ob(190)}}Object(d.a)(sc,"RangeDuplicatesRemovedEvent",y,[]);class Dc extends y{constructor(){super()}get eventId(){return 1}Xb(){this.Ob(527);
this.Ob(12)}}Object(d.a)(Dc,"RangeEditedEvent",y,[]);class Ud extends y{constructor(){super()}get eventId(){return 164}Xb(){this.Ob(255)}ig(){this.kd(O=>4===O.actionType)}}Object(d.a)(Ud,"RangeExternalLinksBrokeAllLinksEvent",y,[]);class Ed extends y{constructor(){super()}get eventId(){return 119}Xb(){this.Ob(255)}ig(){this.kd(O=>3===O.actionType)}}Object(d.a)(Ed,"RangeExternalLinksBrokeLinkEvent",y,[]);class $d extends y{constructor(){super()}get eventId(){return 205}Xb(){this.Ob(256)}bxa(){this.oqe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(d.a)($d,"RangeExternalLinksChangeSourceEvent",y,[]);class ve extends y{constructor(){super()}get eventId(){return 163}Xb(){this.Ob(553)}ig(){this.kd(O=>1===O.actionType)}}Object(d.a)(ve,"RangeExternalLinksRefreshedAllEvent",y,[]);class ze extends y{constructor(){super()}get eventId(){return 77}Xb(){this.Ob(553)}ig(){this.kd(O=>0===O.actionType)}}Object(d.a)(ze,"RangeExternalLinksRefreshedEvent",y,[]);class We extends y{constructor(){super()}get eventId(){return 165}Xb(){this.Ob(224)}}Object(d.a)(We,
"RangeExternalLinksSetAutoRefreshEvent",y,[]);class md extends y{constructor(){super()}get eventId(){return 5}Xb(){this.Ob(11)}ig(){this.kd(O=>64===O.d_().ValidMembers)}}Object(d.a)(md,"RangeFillColoredEvent",y,[]);class $b extends y{constructor(){super()}get eventId(){return 59}Xb(){this.Ob(155)}}Object(d.a)($b,"RangeFilledEvent",y,[]);class $c extends y{constructor(){super()}get eventId(){return 115}Xb(){this.Ob(176)}ig(){this.kd(O=>O.tV().AutoFilterType===Eb.Qrc&&!!O.tV().CriteriaType)}}Object(d.a)($c,
"RangeFilterAppliedEvent",y,[]);class nd extends y{constructor(){super()}get eventId(){return 58}Xb(){this.Ob(176)}ig(){this.kd(O=>O.tV().AutoFilterType===Eb.Qrc&&!O.tV().CriteriaType)}}Object(d.a)(nd,"RangeFilterClearedEvent",y,[]);class Oc extends y{constructor(){super()}get eventId(){return 41}Xb(){this.Ob(518)}}Object(d.a)(Oc,"RangeFilterReappliedEvent",y,[]);class Gd extends y{constructor(){super()}get eventId(){return 86}Xb(){this.Ob(150)}}Object(d.a)(Gd,"RangeFlashFilledEvent",y,[]);class Qd extends Nb{constructor(){super(6,
32)}}Object(d.a)(Qd,"RangeFontColoredEvent",Nb,[]);class Ad extends Nb{constructor(){super(7,8)}}Object(d.a)(Ad,"RangeFontItalicizedEvent",Nb,[]);class Sd extends Nb{constructor(){super(8,1)}}Object(d.a)(Sd,"RangeFontNamedEvent",Nb,[]);class Ce extends Nb{constructor(){super(9,2)}}Object(d.a)(Ce,"RangeFontSizedEvent",Nb,[]);class we extends y{constructor(){super()}get eventId(){return 74}Xb(){this.Ob(215)}}Object(d.a)(we,"RangeFormattedAsTableEvent",y,[]);class Td extends y{constructor(){super()}get eventId(){return 97}Xb(){this.Ob(188)}}
Object(d.a)(Td,"RangeGroupedOrUngroupedEvent",y,[]);class he extends y{constructor(){super()}get eventId(){return 60}Xb(){this.Ob(11)}ig(){this.kd(O=>2===O.d_().ValidMembers)}}Object(d.a)(he,"RangeHorizontallyAlignedEvent",y,[]);class ee extends y{constructor(){super()}get eventId(){return 43}Xb(){this.Ob(526)}}Object(d.a)(ee,"RangeHyperlinkAppliedEvent",y,[]);class ge extends y{constructor(){super()}get eventId(){return 63}Xb(){this.Ob(11)}ig(){this.kd(O=>256===O.d_().ValidMembers)}}Object(d.a)(ge,
"RangeIndentChangedEvent",y,[]);class re extends y{constructor(){super()}get eventId(){return 53}Xb(){this.Ob(156)}ig(){this.kd(O=>2===O.vs()||5===O.vs()||6===O.vs()||7===O.vs())}}Object(d.a)(re,"RangeMergedEvent",y,[]);class Be extends y{constructor(){super()}get eventId(){return 107}Xb(){this.Ob(216)}}Object(d.a)(Be,"RangeNamedCellStyleAppliedEvent",y,[]);class Oe extends y{constructor(){super()}get eventId(){return 12}Xb(){this.Ob(11)}ig(){this.kd(O=>32===O.d_().ValidMembers)}}Object(d.a)(Oe,"RangeNumberFormattedEvent",
y,[]);var gf=a(959);class af extends y{constructor(){super()}get eventId(){return 108}Xb(){this.Ob(141)}ig(){this.kd(O=>Object(aa.a)(gf.a,O))}}Object(d.a)(af,"RangeSortedEvent",y,[]);class Ze extends Nb{constructor(){super(10,128)}}Object(d.a)(Ze,"RangeStrikedThroughEvent",Nb,[]);class Xa extends Nb{constructor(){super(11,16)}}Object(d.a)(Xa,"RangeUnderlinedEvent",Nb,[]);class qa extends y{constructor(){super()}get eventId(){return 61}Xb(){this.Ob(11)}ig(){this.kd(O=>1===O.d_().ValidMembers)}}Object(d.a)(qa,
"RangeVerticallyAlignedEvent",y,[]);class xa extends y{constructor(){super()}get eventId(){return 62}Xb(){this.Ob(11)}ig(){this.kd(O=>8===O.d_().ValidMembers)}}Object(d.a)(xa,"RangeWrapTextToggledEvent",y,[]);class ob extends y{constructor(){super()}get eventId(){return 103}Xb(){this.Ob(51)}}Object(d.a)(ob,"RefreshedAllEvent",y,[]);class Ib extends y{constructor(){super()}get eventId(){return 47}Xb(){this.Ob(148)}}Object(d.a)(Ib,"ReplaceAllEvent",y,[]);class Zb extends y{constructor(){super()}get eventId(){return 91}Xb(){this.Ob(532)}ig(){this.kd(O=>
95!==O.getShapeType()&&96!==O.getShapeType()&&97!==O.getShapeType()&&98!==O.getShapeType()&&100!==O.getShapeType()&&102!==O.getShapeType()&&103!==O.getShapeType())}}Object(d.a)(Zb,"ShapeInsertedEvent",y,[]);class zc extends y{constructor(){super()}get eventId(){return 92}Xb(){this.Ob(531)}}Object(d.a)(zc,"ShapeStyleSetEvent",y,[]);var Mc=a(818);class hd extends y{constructor(O,Sa){super();this.Tfa=O;this.d3d=Sa}get eventId(){return this.Tfa}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(aa.a)(Mc.a,O)&&
4===O.getShapeTextFormat().ValidMembers);this.kd(O=>Object(aa.a)(Mc.a,O)&&O.getShapeTextFormat().Font.ValidMembers===this.d3d)}}Object(d.a)(hd,"ShapeTextFontFormattedEventBase",y,[]);class id extends hd{constructor(){super(193,4)}}Object(d.a)(id,"ShapeTextBoldedEvent",hd,[]);var yd=a(961);class Yd extends y{constructor(){super()}get eventId(){return 191}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(aa.a)(yd.a,O))}}Object(d.a)(Yd,"ShapeTextChangedEvent",y,[]);class cc extends hd{constructor(){super(196,
32)}}Object(d.a)(cc,"ShapeTextFontColorChangedEvent",hd,[]);class Rc extends hd{constructor(){super(197,1)}}Object(d.a)(Rc,"ShapeTextFontNameChangedEvent",hd,[]);class vd extends hd{constructor(){super(198,2)}}Object(d.a)(vd,"ShapeTextFontSizeChangedEvent",hd,[]);class Zd extends y{constructor(){super()}get eventId(){return 199}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(aa.a)(Mc.a,O)&&2===O.getShapeTextFormat().ValidMembers)}}Object(d.a)(Zd,"ShapeTextHorizontallyAlignedEvent",y,[]);class pe extends hd{constructor(){super(194,
8)}}Object(d.a)(pe,"ShapeTextItalicizedEvent",hd,[]);class Qe extends hd{constructor(){super(195,16)}}Object(d.a)(Qe,"ShapeTextUnderlinedEvent",hd,[]);class bf extends y{constructor(){super()}get eventId(){return 200}Xb(){this.Ob(581)}ig(){this.kd(O=>Object(aa.a)(Mc.a,O)&&1===O.getShapeTextFormat().ValidMembers)}}Object(d.a)(bf,"ShapeTextVerticallyAlignedEvent",y,[]);class $e extends y{constructor(){super()}get eventId(){return 13}Xb(){this.Ob(138)}}Object(d.a)($e,"SheetAddedEvent",y,[]);var tf=a(8);
class oe extends y{constructor(){super()}get eventId(){return 142}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>{O=O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>O.DeltaColumn&&!O.DeltaRow&&(!!O.InsertDeleteRange.FirstRow||O.InsertDeleteRange.LastRow!==tf.a.Oz)||!O.DeltaColumn&&0>O.DeltaRow&&(!!O.InsertDeleteRange.FirstColumn||O.InsertDeleteRange.LastColumn!==tf.a.Sw)})}}Object(d.a)(oe,
"SheetCellsDeletedEvent",y,[]);class jf extends y{constructor(){super()}get eventId(){return 143}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>{O=O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<O.DeltaColumn&&!O.DeltaRow&&(!!O.InsertDeleteRange.FirstRow||O.InsertDeleteRange.LastRow!==tf.a.Oz)||!O.DeltaColumn&&0<O.DeltaRow&&(!!O.InsertDeleteRange.FirstColumn||O.InsertDeleteRange.LastColumn!==
tf.a.Sw)})}}Object(d.a)(jf,"SheetCellsInsertedEvent",y,[]);class Hf extends y{constructor(){super()}get eventId(){return 139}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);
this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===tf.a.Oz)}}Object(d.a)(Hf,"SheetColumnDeletedEvent",y,[]);class Ne extends y{constructor(){super()}get eventId(){return 138}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===tf.a.Oz)}}Object(d.a)(Ne,"SheetColumnInsertedEvent",y,[]);class Xe extends y{constructor(){super()}get eventId(){return 14}Xb(){this.Ob(137)}}Object(d.a)(Xe,"SheetDeletedEvent",y,[]);class Mf extends y{constructor(){super()}get eventId(){return 137}Xb(){this.Ob(185)}}Object(d.a)(Mf,"SheetDirectionChangedEvent",
y,[]);class Te extends y{constructor(){super()}get eventId(){return 54}Xb(){this.Ob(139)}}Object(d.a)(Te,"SheetDuplicatedEvent",y,[]);class cb extends y{constructor(){super()}get eventId(){return 15}Xb(){this.Ob(207)}}Object(d.a)(cb,"SheetNameEditedEvent",y,[]);class Rb extends y{constructor(){super()}get eventId(){return 90}Xb(){this.Ob(151)}}Object(d.a)(Rb,"SheetPaneFrozenEvent",y,[]);class uc extends y{constructor(){super()}get eventId(){return 120}Xb(){this.Ob(226)}}Object(d.a)(uc,"SheetPrintSettingsSavedEvent",
y,[]);var Kc=a(858);class pd extends y{constructor(){super()}get eventId(){return 215}Xb(){this.Ob(507)}bxa(){this.oqe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}ig(){this.kd(O=>Object.getType(O)===Kc.a)}}Object(d.a)(pd,"SheetProtectionPausedResumedEvent",y,[]);class xd extends y{constructor(){super()}get eventId(){return 64}Xb(){this.Ob(557)}}Object(d.a)(xd,"SheetReorderedEvent",y,[]);class Rd extends y{constructor(){super()}get eventId(){return 141}Xb(){this.Ob(237)}ig(){this.kd(O=>
!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===tf.a.Sw)}}Object(d.a)(Rd,
"SheetRowDeletedEvent",y,[]);class ke extends y{constructor(){super()}get eventId(){return 140}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>!O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);
this.kd(O=>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===tf.a.Sw)}}Object(d.a)(ke,"SheetRowInsertedEvent",y,[]);class fe extends y{constructor(){super()}get eventId(){return 39}Xb(){this.Ob(135)}}Object(d.a)(fe,"SheetRowsColumnsAutoFitEvent",y,[]);class Ee extends y{constructor(){super()}get eventId(){return 36}Xb(){this.Ob(136)}}Object(d.a)(Ee,"SheetRowsColumnsResizedEvent",y,[]);class nc extends y{constructor(){super()}get eventId(){return 68}Xb(){this.Ob(183)}}
Object(d.a)(nc,"SheetShowGridlinesToggledEvent",y,[]);class Sc extends y{constructor(){super()}get eventId(){return 67}Xb(){this.Ob(184)}}Object(d.a)(Sc,"SheetShowHeadingsToggledEvent",y,[]);class zb extends y{constructor(){super()}get eventId(){return 89}Xb(){this.Ob(213)}}Object(d.a)(zb,"SheetSpellCheckedEvent",y,[]);class Wb extends y{constructor(){super()}get eventId(){return 70}Xb(){this.Ob(515)}}Object(d.a)(Wb,"SheetTabColoredEvent",y,[]);class yc extends y{constructor(){super()}get eventId(){return 71}Xb(){this.Ob(157)}}
Object(d.a)(yc,"SheetVisibilityChangedEvent",y,[]);class Uc extends y{constructor(){super()}get eventId(){return 126}Xb(){this.Ob(239)}}Object(d.a)(Uc,"SheetsVisibilityChangedEvent",y,[]);class fd extends y{constructor(){super()}get eventId(){return 188}Xb(){this.Ob(203)}}Object(d.a)(fd,"SlicerInsertedEvent",y,[]);class rb extends y{constructor(){super()}get eventId(){return 189}Xb(){this.Ob(173)}ig(){this.kd(O=>!O.clearFilter)}}Object(d.a)(rb,"SlicerSelectionAppliedEvent",y,[]);class Ub extends y{constructor(){super()}get eventId(){return 190}Xb(){this.Ob(173)}ig(){this.kd(O=>
O.clearFilter)}}Object(d.a)(Ub,"SlicerSelectionClearedEvent",y,[]);class oc extends y{constructor(){super()}get eventId(){return 27}Xb(){this.Ob(208)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Zab)}}Object(d.a)(oc,"TableCheckedItemsFilteredEvent",y,[]);class Nc extends y{constructor(){super()}get eventId(){return 144}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Nc,"TableColumnDeletedEvent",y,[]);class ud extends y{constructor(){super()}get eventId(){return 145}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(d.a)(ud,"TableColumnInsertedEvent",y,[]);var Lb=a(960);class pc extends y{constructor(){super()}get eventId(){return 121}Xb(){this.Ob(141)}ig(){this.kd(O=>Object(aa.a)(Lb.a,O))}}Object(d.a)(pc,"TableColumnSortedEvent",y,[]);class Ha extends y{constructor(){super()}get eventId(){return 105}Xb(){this.Ob(193)}}Object(d.a)(Ha,"TableConvertedToRangeEvent",y,[]);class Bb extends y{constructor(){super()}get eventId(){return 16}Xb(){this.Ob(206)}}Object(d.a)(Bb,"TableCreatedEvent",y,[]);class bc extends y{constructor(){super()}get eventId(){return 30}Xb(){this.Ob(209)}ig(){this.kd(O=>
O.getParameters().FilterType===Eb.Zab)}}Object(d.a)(bc,"TableCustomFilteredEvent",y,[]);class tc extends y{constructor(){super()}get eventId(){return 25}Xb(){this.Ob(187)}ig(){this.kd(O=>1===O.options.OperationType)}}Object(d.a)(tc,"TableCustomSortedEvent",y,[]);class Zc extends y{constructor(){super()}get eventId(){return 28}Xb(){this.Ob(176)}ig(){this.kd(O=>O.tV().AutoFilterType===Eb.Zab);this.kd(O=>0===O.tV().CriteriaType)}}Object(d.a)(Zc,"TableFilterClearedEvent",y,[]);class wd extends y{constructor(){super()}get eventId(){return 32}Xb(){this.Ob(176)}ig(){this.kd(O=>
O.tV().AutoFilterType===Eb.Zab);this.kd(O=>{const Sa=new m.a;Sa.add(1);Sa.add(2);Sa.add(8);Sa.add(9);Sa.add(10);Sa.add(11);Sa.add(12);Sa.add(13);Sa.add(14);Sa.add(15);Sa.add(16);Sa.add(17);Sa.add(18);Sa.add(19);Sa.add(20);Sa.add(21);Sa.add(22);Sa.add(23);Sa.add(24);Sa.add(25);Sa.add(26);Sa.add(27);Sa.add(28);Sa.add(29);Sa.add(30);Sa.add(31);Sa.add(32);Sa.add(33);Sa.add(34);Sa.add(35);Sa.add(36);Sa.add(37);Sa.add(38);Sa.add(39);return Sa.contains(O.tV().CriteriaType)})}}Object(d.a)(wd,"TableItemFilteredEvent",
y,[]);class Ld extends y{constructor(){super()}get eventId(){return 101}Xb(){this.Ob(217)}}Object(d.a)(Ld,"TableRenamedEvent",y,[]);class ae extends y{constructor(){super()}get eventId(){return 73}Xb(){this.Ob(211)}}Object(d.a)(ae,"TableResizedEvent",y,[]);class ne extends y{constructor(){super()}get eventId(){return 44}Xb(){this.Ob(514)}}Object(d.a)(ne,"TableRowColumnRearrangedEvent",y,[]);class xe extends y{constructor(){super()}get eventId(){return 146}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);
this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.kd(O=>0>O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(xe,"TableRowDeletedEvent",y,[]);class Fe extends y{constructor(){super()}get eventId(){return 147}Xb(){this.Ob(237)}ig(){this.kd(O=>!!O.insertDeleteMultiRangeParameters);this.kd(O=>O.insertDeleteMultiRangeParameters.IsTableCommand);this.kd(O=>!O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.kd(O=>0<O.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(d.a)(Fe,"TableRowInsertedEvent",y,[]);class Ke extends y{constructor(){super()}get eventId(){return 26}Xb(){this.Ob(177)}ig(){this.kd(O=>O.tV().AutoFilterType===Eb.Zab)}}Object(d.a)(Ke,"TableSortedEvent",y,[]);class Ja extends y{constructor(){super()}get eventId(){return 87}Xb(){this.Ob(212)}}Object(d.a)(Ja,"TableStyleAppliedEvent",y,[]);class Gb extends y{constructor(){super()}get eventId(){return 88}Xb(){this.Ob(196)}}
Object(d.a)(Gb,"TableStyleOptionToggledEvent",y,[]);class xc extends y{constructor(){super()}get eventId(){return 31}Xb(){this.Ob(210)}ig(){this.kd(O=>O.getParameters().FilterType===Eb.Zab)}}Object(d.a)(xc,"TableTop10FilteredEvent",y,[]);class Tc extends y{constructor(){super()}get eventId(){return 207}Xb(){this.Ob(238)}}Object(d.a)(Tc,"TextToColumnsEvent",y,[]);class td extends y{constructor(){super()}get eventId(){return 128}Xb(){this.Ob(559)}}Object(d.a)(td,"ValuesSortedEvent",y,[]);class Nd extends y{constructor(){super()}get eventId(){return 55}Xb(){this.Ob(197)}}
Object(d.a)(Nd,"WorkbookCalculationModeSetEvent",y,[]);class le extends y{constructor(){super()}get eventId(){return 34}Xb(){this.Ob(181)}ig(){this.kd(O=>!!O.parentCommentId)}}Object(d.a)(le,"WorkbookCommentRepliedEvent",y,[]);class me extends y{constructor(){super()}get eventId(){return 33}Xb(){this.Ob(181)}ig(){this.kd(O=>!O.parentCommentId)}}Object(d.a)(me,"WorkbookCommentedEvent",y,[]);class df extends y{constructor(){super()}get eventId(){return 56}Xb(){this.Ob(128)}}Object(d.a)(df,"WorkbookRecalculatedEvent",
y,[]);class Ie extends y{constructor(){super()}get eventId(){return 46}Xb(){this.Ob(171)}}Object(d.a)(Ie,"WorkbookRedoEvent",y,[]);class nf extends y{constructor(){super()}get eventId(){return 45}Xb(){this.Ob(170)}}Object(d.a)(nf,"WorkbookUndoEvent",y,[]);class xf extends y{constructor(){super()}get eventId(){return 116}Xb(){this.Ob(507);this.Ob(576);this.Ob(10)}ig(){this.kd(O=>{if(Object(aa.a)(Y,O)&&(O=Object(U.a)(Y,O),void 0!==O.source&&null!==O.source&&void 0!==O.eventId&&null!==O.eventId))return n.ULS.sendTraceTag(537155426,
0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${O.source}; eventId: ${O.eventId}.`),!0;n.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(d.a)(xf,"DefaultRichApiRequestExecutedEvent",y,[]);class De extends y{constructor(){super()}get eventId(){return 216}Xb(){this.Ob(1022)}}Object(d.a)(De,"TablelAltTextEditedEvent",y,[]);class Nf extends y{constructor(){super()}get eventId(){return 217}Xb(){this.Ob(263)}}Object(d.a)(Nf,
"FloatingObjectZOrderChangedEvent",y,[]);var Uf=a(962);class Og extends y{constructor(){super()}get eventId(){return 192}Xb(){this.Ob(507)}ig(){this.kd(O=>Object(aa.a)(Uf.a,O)?!0:!1)}}Object(d.a)(Og,"VisualPropertySetEvent",y,[]);class kg extends S{constructor(){super(219,[510])}}Object(d.a)(kg,"ChartSeriesDeletedEvent",S,[]);class bg extends y{get eventId(){return 220}Xb(){this.Ob(1027)}}Object(d.a)(bg,"ChartDataChangedEvent",y,[]);class $a extends S{constructor(){super(221,[512])}}Object(d.a)($a,
"ChartSeriesDataChangedEvent",S,[]);class Db{constructor(O){this.yb=null;this.$=O}get macroRecorderEvents(){this.yb||(this.yb=new m.a,this.yb.add(new Dc),this.yb.add(new gb),this.yb.add(new ic),this.yb.add(new ec),this.yb.add(new md),this.yb.add(new Qd),this.yb.add(new Ad),this.yb.add(new Sd),this.yb.add(new Ce),this.yb.add(new Ze),this.yb.add(new Xa),this.yb.add(new Oe),this.yb.add(new $e),this.yb.add(new Xe),this.yb.add(new cb),this.yb.add(new Bb),this.yb.add(new Nc),this.yb.add(new ud),this.yb.add(new xe),
this.yb.add(new Fe),this.yb.add(new Ne),this.yb.add(new Hf),this.yb.add(new ke),this.yb.add(new Rd),this.yb.add(new tc),this.yb.add(new Ke),this.yb.add(new oc),this.yb.add(new Zc),this.yb.add(new eb),this.yb.add(new bc),this.yb.add(new xc),this.yb.add(new wd),this.yb.add(new me),this.yb.add(new le),this.yb.add(new Qb),this.yb.add(new Ee),this.yb.add(new oe),this.yb.add(new jf),this.yb.add(new fe),this.yb.add(new Sb),this.yb.add(new Oc),this.yb.add(new ee),this.yb.add(new pa),this.yb.add(new ne),this.yb.add(new Ie),
this.yb.add(new nf),this.yb.add(new Ib),this.yb.add(new Ya),this.yb.add(new Mb),this.yb.add(new re),this.yb.add(new Te),this.yb.add(new Nd),this.yb.add(new df),this.yb.add(new mb),this.yb.add(new nd),this.yb.add(new $b),this.yb.add(new he),this.yb.add(new qa),this.yb.add(new xa),this.yb.add(new ge),this.yb.add(new xd),this.yb.add(new M),this.yb.add(new X),this.yb.add(new Sc),this.yb.add(new nc),this.yb.add(new sc),this.yb.add(new yc),this.yb.add(new Wb),this.yb.add(new ae),this.yb.add(new we),this.yb.add(new Q),
this.yb.add(new J),this.yb.add(new ze),this.yb.add(new Ca),this.yb.add(new fa),this.yb.add(new C),this.yb.add(new Aa),this.yb.add(new G),this.yb.add(new L),this.yb.add(new H),this.yb.add(new W),this.yb.add(new Gd),this.yb.add(new Ja),this.yb.add(new Gb),this.yb.add(new zb),this.yb.add(new Rb),this.yb.add(new Zb),this.yb.add(new zc),this.yb.add(new da),this.yb.add(new Z),this.yb.add(new ha),this.yb.add(new Ga),this.yb.add(new Td),this.yb.add(new Jb),this.yb.add(new Oa),this.yb.add(new Wa),this.yb.add(new Ld),
this.yb.add(new wb),this.yb.add(new ob),this.yb.add(new Fc),this.yb.add(new Ha),this.yb.add(new bd),this.yb.add(new Be),this.yb.add(new af),this.yb.add(new Ec),this.yb.add(new pb),this.yb.add(new xb),this.yb.add(new Ab),this.yb.add(new Lc),this.yb.add(new ld),this.yb.add(new $c),this.yb.add(new T),this.yb.add(new ya),this.yb.add(new Ed),this.yb.add(new uc),this.yb.add(new pc),this.yb.add(new Cb),this.yb.add(new Uc),this.yb.add(new Pa),this.yb.add(new td),this.yb.add(new Ra),this.yb.add(new D),this.yb.add(new ia),
this.yb.add(new ba),this.yb.add(new Ma),this.yb.add(new ka),this.yb.add(new ua),this.yb.add(new Mf),this.yb.add(new Za),this.yb.add(new va),this.yb.add(new Ea),this.yb.add(new ca),this.yb.add(new dc),this.yb.add(new ib),this.yb.add(new La),this.yb.add(new db),this.yb.add(new gc),this.yb.add(new I),this.yb.add(new Ob),this.yb.add(new Ua),this.yb.add(new ve),this.yb.add(new Ud),this.yb.add(new We),this.yb.add(new ra),this.yb.add(new Ka),this.yb.add(new Qa),this.yb.add(new la),this.yb.add(new qb),this.yb.add(new kb),
this.yb.add(new sa),this.yb.add(new Ba),this.yb.add(new vb),this.yb.add(new nb),this.yb.add(new Fa),this.yb.add(new Yb),this.yb.add(new jb),this.yb.add(new ab),this.yb.add(new V),this.yb.add(new hb),this.yb.add(new fc),this.yb.add(new oa),this.yb.add(new lb),this.yb.add(new sb),this.yb.add(new Ta),this.yb.add(new Da),this.yb.add(new fd),this.yb.add(new rb),this.yb.add(new Ub),this.yb.add(new Yd),this.yb.add(new id),this.yb.add(new pe),this.yb.add(new Qe),this.yb.add(new cc),this.yb.add(new Rc),this.yb.add(new vd),
this.yb.add(new Zd),this.yb.add(new bf),this.yb.add(new $d),this.yb.add(new bb),this.yb.add(new Tc),this.yb.add(new pd),this.yb.add(new De),this.yb.add(new Nf),this.yb.add(new Og),this.yb.add(new kg),this.yb.add(new $a),this.yb.add(new bg),A.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Egj());return this.yb}J5e(O,Sa){let Hb=this.K5e(O,this.macroRecorderEvents,Sa);Hb||(Hb=this.K5e(O,Db.V6h(),Sa),!Hb&&this.elf(O,Db.bMe,Sa)&&(Hb=Db.bMe));return Hb}K5e(O,Sa,Hb){const hc=
new m.a;for(let wc of Sa)this.elf(O,wc,Hb)&&hc.add(wc);return 1===hc.count?hc.ma(0):1<hc.count?Db.qPh(hc):null}elf(O,Sa,Hb){const hc=Db.p1i(O,Sa);return Hb?hc&&Db.k3j(O,Sa):hc}Egj(){const O=new m.a;for(let Sa of this.yb){let Hb=!1;for(let hc of Sa.featureGates)if(!A.EwaSettings.oa(hc)){O.add(Sa);Hb=!0;break}if(!Hb)for(let hc of Sa.cYe)if(!A.EwaSettings.getBooleanFeatureGate(hc,!1)){O.add(Sa);break}}for(let Sa of O)this.yb.remove(Sa)}static V6h(){Db.EEb||(Db.EEb=new m.a,Db.EEb.add(new na),Db.EEb.add(new ja));
return Db.EEb}static p1i(O,Sa){return Sa.operations.contains(O.operation)}static k3j(O,Sa){Sa=Sa.NFc;if(!Sa.count)return!0;let Hb=!0;for(let hc of Sa)if(!hc(O.payload)){Hb=!1;break}return Hb}static qPh(O){let Sa=O.ma(0);for(let Hb of O)Hb.NFc.count>Sa.NFc.count&&(Sa=Hb);return Sa}}Db.EEb=null;Db.bMe=new xf;Object(d.a)(Db,"MacroRecorderEventList",null,[]);class Vb extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){this.ob(this.$.da.Aa(297)||new z(this.$,new Db(this.$),new w))}static la(O){O.da.Ga(298,
new Vb(O))}}Object(d.a)(Vb,"MacroRecorderEventHandlerFactory",h.a,[]);var Ac=a(1147),Wc=a(1242),jd=a(7);a(559);class Cd{constructor(){this.$tg=new m.a}get C3b(){return this.$tg}LZh(O){n.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",O);const Sa=new m.a;for(let Hb of this.C3b)for(let hc of Hb.VFb)hc.id===O&&Sa.add(hc);return Sa}aqe(O){this.C3b.add(O)}zgj(O){for(let Sa of this.C3b)if(Sa.eue===O.eue){this.C3b.remove(Sa);break}}static snh(O,Sa,Hb=null){O=Cd.WRh(O);0<O.length&&(Cd.czc(O,!1),Hb&&
Hb(Sa,O))}static WRh(O){const Sa=[];if(O&&O.VFb&&0<O.VFb.count)for(let Hb of O.VFb)if(Hb.controls&&0<Hb.controls.count)for(let hc of Hb.controls)if(hc.menuItems&&0<hc.menuItems.count)for(let wc of hc.menuItems)Array.add(Sa,wc.id);return Sa}static czc(O,Sa){if(O.length){var Hb=[];for(const hc of O)Hb.push(appChrome.actions.updateControlEnabledDisabledState(hc,Sa));appChrome.api.dispatch(Hb)}}}Object(d.a)(Cd,"ContextMenuExtensibilityCache",null,[347,348]);var ce=a(1466),Vd=a(84),Kd=a(4),se=a(866),qf=
a(816);class k{RZa(O,Sa=null){if(O=qf.a.K4a(O)){appChrome.addInApi.dispatchActionsToInstallAddIn(O,Sa);for(const Hb of O.tabs)if(Hb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(O,()=>{});break}}}VMd(O){(O=qf.a.K4a(O))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(O)}static Anh(O,Sa,Hb=null){O=k.M1h(O);0<O.length&&(k.czc(O,!1),Hb&&Hb(Sa,O))}static M1h(O){const Sa=[];if(O&&(O=O.uW,O.ot&&0<O.ot.count))for(let Hb of O.ot)if(Hb.groups&&0<Hb.groups.length)for(const hc of Hb.groups)if(hc.controls&&
0<hc.controls.length)for(const wc of hc.controls)Array.add(Sa,wc.id);return Sa}static czc(O){if(O.length){var Sa=[];for(const Hb of O)Sa.push(appChrome.actions.updateControlEnabledDisabledState(Hb,!0));appChrome.api.dispatch(Sa)}}}Object(d.a)(k,"OneLineRibbonExtensibilityManager",null,[369]);var Tb=a(937);class rc{constructor(){this.M6d=this.jHc=null}get xWc(){return this.jHc||(this.jHc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set xWc(O){this.jHc=O}get eVg(){return this.M6d||(this.M6d=
OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(O,Sa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(O,Sa)}getTaskPaneControlIdFromAssetIdRuntimeId(O,Sa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(O,Sa)}yld(O,Sa,Hb,hc,wc,ad=null,kd=null){n.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",O);if((O=Sa.xja(wc.ownerAddinInfo.storeType,wc.ownerAddinInfo.solutionId))&&
O.LB&&!O.LB.getIsUpgrading())if(Sa=null,0<O.LB.getNotificationParams().length&&(Sa=this.Pze(O.LB.getNotificationParams()[0]))&&2147758681===Sa.errorCode&&(O.isUpgraded=!0),2!==O.LB.getStatus()&&(1!==O.LB.getStatus()||Sa&&2147758681===Sa.errorCode))Sa&&this.G9f(O,Sa,kd);else try{Hb.setOwnerAddinEToken(O.LB.getEToken()),wc.action(Hb,hc.mda),ad&&ad()}catch(od){n.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Kd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
od.stack:od.message)),Tb.a.PVd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}G9f(O,Sa,Hb=null){const hc=O.LB;if(1===hc.getNotificationParams().length||Sa.ogc){const wc=Sa.Vha,ad=Sa.Wia;Sa.Vha=()=>{hc.removeFirstNotification();if(0<hc.getNotificationParams().length){const kd=this.Pze(hc.getNotificationParams()[0]);this.G9f(O,kd)}2147758681===Sa.errorCode&&(k.Anh(O.Vo,hc,Object(Vd.a)(this,this.Dff,"initUpgradeStateDetectTask")),Cd.snh(O.Jsb,hc,Object(Vd.a)(this,this.Dff,
"initUpgradeStateDetectTask")));wc&&wc()};Sa.Wia=()=>{ad&&ad();Hb&&Hb()};Tb.a.RVd(Sa)}}Dff(O,Sa){let Hb=null;Hb=()=>{O.getIsUpgrading()?window.setTimeout(Hb,1E3):O.getUpgradingFailed()?k.czc(Sa,!0):Kd.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Hb,1E3)}Pze(O){const Sa=new se.a;Sa.TMa=O.infoType;Sa.id=O.id;Sa.title=O.title;Sa.description=O.description;Sa.buttonText=O.buttonTxt;Sa.Vha=O.buttonCallback;Sa.ogc=O.highPriority;Sa.Wia=O.dismissCallback;Sa.errorCode=O.errorCode;Sa.Eef=O.iframeNotificationUrl;
return Sa}}Object(d.a)(rc,"AddinCommandsActionHandler",null,[353]);var Hc=a(82),dd=a(156),Bd=a(695),Hd=a(5),Wd=a(739),de=a(696);class Le{constructor(O,Sa){this.Va=O;this.X9g=Sa}CMh(O){if(void 0!==O&&null!==O&&O===Hd.a.kHe)O="ContextMenuCell";else return null;const Sa=this.Va.Fc();this.ULh(Sa,O);return Sa}ULh(O,Sa){Sa=this.X9g.LZh(Sa);for(let Hb of Sa){Sa=Hb.controls;for(let hc of Sa)this.HLh(O,hc)}}HLh(O,Sa){var Hb=Sa.CU[Wd.a.id];const hc=Sa.CU[Wd.a.RVa],wc=Sa.CU[Wd.a.VVa];let ad="Image16by16",kd=
Sa.CU[Wd.a.SVa];de.c(wc)&&(ad="None");0<Sa.menuItems.count?(Hb=this.Va.xw(Hb,Hb,hc,798637440),Hb.aNb(ad,wc,null),this.AMh(Hb.menu,Sa),O.buttons.push(Hb)):O.buttons.push(this.Va.MIa(Hb,hc,kd,wc,ad,null,!1))}AMh(O,Sa){const Hb=this.Va.Fc();for(let hc of Sa.menuItems){Sa=hc.ima[Wd.a.id];const wc=hc.ima[Wd.a.RVa],ad=hc.ima[Wd.a.VVa];let kd="Image16by16";const od=hc.ima[Wd.a.SVa];de.c(ad)&&(kd="None");Sa=this.Va.MIa(Sa,wc,od,ad,kd,null,!1);Hb.buttons.push(Sa)}O.tc.push(Hb)}}Object(d.a)(Le,"AddInCommandsContextMenuExtensibilityHandler",
null,[400]);var Ae=a(861);class Ef{constructor(){this.ti=null;this.visible=!1}}Object(d.a)(Ef,"AddinStatusCommandValues",null,[]);class Ia{static x9i(O){const Sa=new Ef;Sa.ti=O.j_a;Sa.visible=Sa.ti?!0:!1;return Sa}static RAc(O,Sa,Hb,hc,wc){const ad=document.getElementById(Hb);ad?Ia.XHj(O,Sa,ad,hc,wc):n.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Hb))}static XHj(O,Sa,Hb,hc,wc){Hb?O.j_a===CommonUIStrings.l_ErrorLoadingAddInsTitle?Tb.a.IGj(Sa,Hb,hc,wc):O.j_a===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
Tb.a.bIj(Sa,Hb):n.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(d.a)(Ia,"AddinCommandsStatusHandler",null,[]);var Fb=a(38),ac=a(226),vc=a(13);class Ic extends Fb.a{constructor(O,Sa){super();this.agaveCommandManager=this.statusBarManager=null;this.fEe=()=>{this.nG&&this.nG.JDe()};this.X$e=()=>{this.raiseEvent("LAC")};this.Tc=(Hb,hc)=>{!Hb.Zb&&ac.b(hc)&&this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null)};this.nG=
Sa;this.$=O;this.$Mj=O.Eb+"OfficeAddinLabel-Medium14";this.$.da.fb(29,Hb=>{this.statusBarManager=Hb;Hb.KJ(this)});this.$.ea.Xj(this.Tc);this.nG.OLg(this.X$e);this.$.da.fb(206,Hb=>{this.agaveCommandManager=Hb;Hb.pNg(this.fEe)})}Lq(O){this.addHandler("LAC",O)}er(O){this.removeHandler("LAC",O)}ps(O,Sa){if("QueryAddinLabel"!==O)return!1;Sa[Ae.a.LabelText]!==this.nG.j_a&&(O=Ia.x9i(this.nG),Sa[Ae.a.LabelText]=O.ti,Sa[Ae.a.Visible]=O.visible,window.setTimeout(()=>{this.RAc()},0));return!0}Fn(){return!0}RAc(){this.$&&
Ia.RAc(this.nG,this.$.domElement,this.$Mj,vc.a.instance.ga(333),vc.a.instance.ga(334))}dispose(){this.$.ea.tk(this.Tc);this.nG.Ihj(this.X$e);this.agaveCommandManager&&(this.agaveCommandManager.Vij(this.fEe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.iG(this),this.statusBarManager=null);this.nG=this.$=null;super.dispose()}}Object(d.a)(Ic,"AddinCommandsStatusBarManager",Fb.a,[214,215]);var rd=a(1318),qd=a(717),be=a(147),ta=a(120),wa=a(571),kc=a(134);class gd{constructor(){this.i_a=
null}setErrorMessageForAddin(O,Sa){this.i_a||(this.i_a={});this.i_a[O]=Sa}mUh(O){return this.i_a&&O in this.i_a?this.i_a[O]:null}}Object(d.a)(gd,"AddinCommandsErrorManager",null,[]);var Jd=a(335),je=a(97);class Ve{constructor(){this.rq=this.DO=0;this.OYc=null;this.Ptc=this.xDc=0;this.eqa=this.WLc=this.BHc=this.Y5b=this.Rja=this.j$=null}get NYc(){this.BHc||(this.BHc=new m.a);return this.BHc}get lfd(){this.WLc||(this.WLc=new m.a);return this.WLc}get DIa(){this.eqa||(this.eqa=new m.a);return this.eqa}}
Object(d.a)(Ve,"AddinCommandsListLoaderContext",null,[]);var rf=a(820);class If{}Object(d.a)(If,"AppsForOfficeEntitlementQueryInfo",null,[]);var wf=a(41);const lg=O=>{const Sa={};Sa.solutionId=O.solutionId;Sa.version=O.version;Sa.storeType=O.storeType;Sa.storeId=O.storeId;Sa.assetId=O.assetId;Sa.assetStoreId=O.assetStoreId;Sa.targetType=O.targetType;Sa.requireConsent=O.requireConsent||!1;Sa.isAddinCommands=!0;Sa.addinCommandsActionType=0;return Sa};class Rf{constructor(O,Sa){this.entitlement=O;this.metadata=
Sa}wfg(){const O=lg(this.entitlement);O.targetType=this.targetType;return O}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(d.a)(Rf,"AddinEntitlementEx",null,[]);var wg=a(257),Sf=a(30);class Mg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(Mg,"AddinAbstract",null,[]);class xg extends Sys.EventArgs{constructor(){super();this.Vo=this.qk=null}}Object(d.a)(xg,"InsertionParamEventArgs",Sys.EventArgs,[]);class $f{constructor(O,Sa,Hb,hc=null){this.GLb=Kd.AFrameworkApplication.fa.Xa("RoamingServiceHandlerWebServiceBase");this.appName=O;this.CEa=Sa;this.fkb=Hb;this.omb=hc}oac(O){this.kXe(O,
"getAddinTeachingCalloutSettings",Object(Vd.a)(this,this.R4,"getRequestSuccessCallback"),Object(Vd.a)(this,this.xN,"getRequestFailureCallback"))}eEh(){const O=new m.a;O.add(this.appName);this.kXe(O,"getTeachingCalloutSettingsForAddinBetterEntryPoint",Object(Vd.a)(this,this.w1h,"getRequestSuccessCallbackForBEP"),Object(Vd.a)(this,this.xN,"getRequestFailureCallback"))}kXe(O,Sa,Hb,hc){const wc=new Sys.StringBuilder(this.GLb);wc.append("RoamingServiceHandler.ashx?action=");wc.append(Sa);wc.append("&");
wc.append(this.xjd(O));wc.append("&");wc.append(Kd.AFrameworkApplication.Hi);Kd.AFrameworkApplication.zd.Om(wc.toString(),1,null,null,!0,2,Hb,hc,null)}X3a(O){this.pXe(O,"saveAddinTeachingCalloutSettings")}jEh(O){this.pXe(O,"saveTeachingCalloutSettingsForAddinBetterEntryPoint")}pXe(O,Sa){const Hb=new Sys.StringBuilder(this.GLb);Hb.append("RoamingServiceHandler.ashx?action=");Hb.append(Sa);Hb.append("&");Hb.append(Kd.AFrameworkApplication.Hi);Sa=Hb.toString();O=wf.c(O);Kd.AFrameworkApplication.zd.Om(Sa,
2,O,null,!0,4,null,Object(Vd.a)(this,this.yO,"postRequestFailureCallback"),null)}R4(O){let Sa=!1,Hb=null;try{if(0<O.data.fe.length){const hc=Object(U.a)(Object,wf.a(O.data.fe)),wc=hc?hc[this.appName]:null;wc&&(Hb=Object(U.a)(Object,wf.a(wc.toString())))}Sa=!0}catch(hc){this.xN(null)}Sa&&this.CEa&&this.CEa(Hb)}w1h(O){let Sa=!1,Hb=null;try{if(0<O.data.fe.length){const hc=Object(U.a)(Object,wf.a(O.data.fe));Hb=Object(U.a)(String,hc[this.appName])||null}Sa=!0}catch(hc){this.xN(null)}Sa&&this.CEa&&(O=
{},O.Platforms=Hb,this.CEa(O))}xN(O){this.fkb&&this.fkb(O?O.data:null)}yO(O){this.omb&&this.omb(O?O.data:null)}xjd(O){const Sa=new Sys.StringBuilder("requestedsettings=");for(let Hb=0;Hb<O.count;Hb++)Sa.append(O.ma(Hb)),Hb<O.count-1&&Sa.append(";");return Sa.toString()}}Object(d.a)($f,"AddinTeachingUIRoamingRequestHandler",null,[]);class ih extends Sys.EventArgs{constructor(O){super();this.solutionId=O.solutionId;this.assetId=O.assetId;this.storeType=O.storeType;this.storeId=O.storeId;this.assetStoreId=
O.assetStoreId;this.targetType=O.targetType;this.width=O.width;this.height=O.height;this.displayName=O.displayName;this.version=O.version}}Object(d.a)(ih,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Of=a(347);class Dg{constructor(O){this.l_a=this.qk=null;this.hea=!1;this.eqa=this.JSb=this.mna=this.Ph=this.bY=this.NO=null;this.Qa=O}get appName(){return Kd.AFrameworkApplication.fa.Xa("WebAppShortName")}get lpb(){this.bY||(this.bY=new $f(this.appName,Object(Vd.a)(this,this.R4,
"getRequestSuccessCallback"),Object(Vd.a)(this,this.xN,"getRequestFailureCallback"),Object(Vd.a)(this,this.yO,"postRequestFailureCallback")));return this.bY}get xsa(){this.JSb||(this.JSb=new m.a);return this.JSb}set xsa(O){this.JSb=O}get DIa(){this.eqa||(this.eqa=new m.a);return this.eqa}set DIa(O){this.eqa=O}sXc(O,Sa){window.addEventListener?(this.qk=O,this.l_a=Sa,window.addEventListener("LaunchAddinTaskpane",Object(Vd.a)(this,this.GEd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Vd.a)(this,this.tGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Vd.a)(this,this.oGb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Vd.a)(this,this.hGb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}A0d(O,Sa,Hb,hc){this.Ph=O;this.xsa=Sa;this.DIa=Hb;this.mna=hc;n.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",
Sa?Sa.count.toString():"null",Hb?Hb.count.toString():"null");0<this.xsa.count||0<this.DIa.count?(O=new m.a,O.add(this.appName),this.lpb.oac(O)):this.mna(new m.a,null)}GEd(){const O=new wg.ScriptSharpLegacyMap;this.l_a&&this.l_a.tabs&&!this.l_a.tabs[0].isOfficeTab&&O.ia("SDX.FeatureFlags","NonOfficeTab");this.Vla(Dg.zV(this.qk),"ClickOnLaunch",O);this.fma();this.l_a?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.l_a,()=>{const Sa=new xg;Sa.qk=this.qk;this.Qa.raiseEvent(qd.a.zwd,Sa)}):
n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}oGb(){this.Vla(Dg.zV(this.qk),"ClickOnClose");this.fma()}tGb(){this.Vla(Dg.zV(this.qk),"ClickOnDismiss");this.fma()}hGb(O){if(O&&(O=O.detail)&&O.id&&this.Aqd(O.id)){const Sa=(O.action||"").toLowerCase();if(O.success&&"opened"===Sa)this.Vla(Dg.zV(this.qk),"CampaignLaunched"),n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.fma(),window.removeEventListener&&
window.removeEventListener("FGWebSurfaceEvent",Object(Vd.a)(this,this.hGb,"onCampaignLaunchedHandler"),!0);else{let Hb;try{Hb=JSON.stringify(O),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Hb)}catch(hc){Hb="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Hb+" Error: "+(hc?hc.toString():""))}}}}Aqd(O){O=Sf.a.wl(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}XAa(O){if(this.appName){const Sa={},Hb={};Hb.LastTeachingUIShowTime=(new Date).toUTCString();Hb.AddinHasShown=O;Sa[this.appName]=wf.c(Hb);this.lpb.X3a(Sa);n.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(539530528,
220,10,"Fail to save roaming service since AppName is null")}fma(){if(!this.hea){const O=window.g_roamingAddinList;O&&(this.XAa(O),this.hea=!0)}}R4(O){O?this.bOb(O)?(n.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.NO="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.vsb()):(n.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.mna(this.xsa,null)):(n.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.NO=null,this.vsb())}xN(O){n.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",O?O.httpStatus:-1);this.mna(this.xsa,null)}yO(O){n.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}vsb(){const O=this.v9c();0===O.targetType?(O.solutionId?this.VJd(O):this.Vla(null,"NoSolutionId"),this.Fkg(O),this.mna(this.xsa,null)):this.mna(this.xsa,O);n.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",O.addinId)}VJd(O){const Sa=new If;
Sa.callbackFunc=Hb=>{if(Hb.errorCode){this.Vla(O.solutionId,"FailToGetAppDetails");var hc=window.g_roamingAddinList;hc&&this.XAa(hc)}else if(Hb.value)for(hc of Hb.value)if(Hb=hc[1],Hb===O.solutionId){const wc={};wc.solutionId=Hb;wc.assetId=hc[5];wc.storeType=hc[12];wc.storeId=hc[11];wc.assetStoreId=hc[6];wc.targetType=hc[3];wc.width=hc[7];wc.height=hc[8];wc.displayName=hc[0];wc.version=hc[4];n.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",O.solutionId);hc=new ih(wc);
this.Qa.raiseEvent(qd.a.WVd,hc);break}};Sa.storeType=OSF.StoreTypeEnum.PrivateCatalog;Sa.fromInsertDialog=!1;Sa.refresh=!1;this.Ph.queryEntitlementDetails(Sa)}bOb(O){if("LastTeachingUIShowTime"in O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<Kd.AFrameworkApplication.fa.tN("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",O),!1}else n.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");
return!0}v9c(){let O=new Jd.a(new Mg,0),Sa=new Jd.a(new Mg,0),Hb=0,hc=0,wc=0;var ad=new m.a;for(var kd of this.xsa)ad.add(kd);for(let od of this.DIa)ad.add(od);for(let od of ad)if(!("excatalog"!==od.storeType||de.c(od.installTimeInMS)||!od.installTimeInMS||od.installTimeInMS<=Kd.AFrameworkApplication.fa.tN("DateTimeInMSForNewAddin",16409952E5))){ad=Dg.Lwb(od);if(this.NO&&(kd=this.NO.split(","),0<kd.length&&Array.contains(kd,ad))){wc++;n.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");
continue}ad.startsWith("private_")?(O=Dg.u5e(od,O),hc++):(Sa=Dg.u5e(od,Sa),Hb++)}n.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",hc,Hb,wc);return 0<Sa.value?Sa.key:0<O.value?O.key:Object.assign(new Mg,{addinId:null,targetType:-1,solutionId:null})}Vla(O,Sa,Hb=null){O={["AppTeachingUICalloutAction"]:Sa,["SDX.Id"]:O,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Hb)for(let hc of Hb.keys)O[hc]=
Hb.ma(hc);be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}))}Fkg(O){O&&(window.g_roamingAddinList=this.NO?this.NO+","+O.addinId:O.addinId)}static zV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static u5e(O,Sa){return Sa.value<O.installTimeInMS?new Jd.a(Object.assign(new Mg,{addinId:Dg.Lwb(O),targetType:O.targetType,solutionId:O.solutionId}),O.installTimeInMS):
Sa}static Lwb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?"private_"+O.installTimeInMS:O.solutionId}}Object(d.a)(Dg,"PrivateCatalogTeachingCalloutHandler2",null,[]);var Hg=a(80);const Xg=()=>{const O=Hg.a.l_(window.location.href.toLowerCase(),"wdomexsrctype");return!!O&&"4"===O},Yg=()=>Hg.a.l_(window.location.href.toLowerCase(),"wdtpl"),ng=()=>{const O=Hg.a.l_(window.location.href.toLowerCase(),"wdomexsrctype");return!!O&&"1"===O},Pg=O=>{let Sa=null;
switch(O){case 0:Sa="omex";break;case 1:Sa="spcatalog";break;case 2:Sa="spapp";break;case 3:Sa="filesystem";break;case 4:Sa="exchange";break;case 6:Sa="registry";break;case 7:Sa="inmemory";break;case 8:Sa="uploadfiledevcatalog";break;case 9:Sa="hardcodedpreinstall";break;case 10:Sa="excatalog";break;case 16:Sa="wopicatalog"}return Sa},og=O=>{let Sa=-1;switch(O.toLowerCase()){case "omex":Sa=0;break;case "spcatalog":Sa=1;break;case "spapp":Sa=2;break;case "filesystem":Sa=3;break;case "exchange":Sa=
4;break;case "registry":Sa=6;break;case "inmemory":Sa=7;break;case "uploadfiledevcatalog":Sa=8;break;case "hardcodedpreinstall":Sa=9;break;case "excatalog":Sa=10;break;case "wopicatalog":Sa=16}return Sa};var ph=a(684);class qh{constructor(O){this.Yr=null;this.ju=O}get_current(){if(!this.Yr)throw Error.argumentOutOfRange();return this.Yr.data}moveNext(){if(!this.Yr)return this.Yr=this.ju,!!this.ju;if(!this.Yr.next)return!1;this.Yr=this.Yr.next;return!0}koc(){if(!this.Yr)return this.Yr=this.ju,!!this.ju;
if(!this.Yr.previous)return!1;this.Yr=this.Yr.previous;return!0}reset(){this.Yr=this.ju}}Object(d.a)(qh,"ListEnumerator",null,[0]);class dh{constructor(O,Sa,Hb){this.next=Hb;this.previous=Sa;this.data=O}}Object(d.a)(dh,"ListNode",null,[]);class eh{constructor(){this.LA=this.Cq=null;this._count=0}add(O){this.Cq?this.LA=this.LA.next=new dh(O,this.LA,null):this.Cq=this.LA=new dh(O,null,null);this._count=this.count+1}insert(O,Sa){if(O>this.count||0>O)throw Error.argumentOutOfRange("pos");if(O===this.count)this.add(Sa);
else{for(var Hb=this.Cq;0!==O--;)Hb=Hb.next;O=new dh(Sa,Hb.previous,Hb);O.previous?O.previous.next=O:this.Cq=O;O.next?O.next.previous=O:this.LA=O;this._count=this.count+1}}remove(O){let Sa=this.Cq;for(;Sa&&Sa.data!==O;)Sa=Sa.next;if(!Sa)return!1;Sa.previous?Sa.previous.next=Sa.next:this.Cq=Sa.next;Sa.next?Sa.next.previous=Sa.previous:this.LA=Sa.previous;this._count=this.count-1;return!0}clear(){let O=this.Cq,Sa;for(this.LA=this.Cq=null;O;)Sa=O.next,O.previous=null,O.next=null,O=Sa;this._count=0}indexOf(O){let Sa=
this.Cq,Hb=0;for(;Sa&&Sa.data!==O;)Sa=Sa.next,Hb++;return Sa?Hb:-1}ma(O){return this.at(O).data}get count(){return this._count}getEnumerator(){return new qh(this.Cq)}[Symbol.iterator](){return Object(ph.a)(this.getEnumerator())}idc(O){O=this.at(O);return new qh(O)}toArray(){const O=Array(this.count);let Sa=0;for(let Hb of this)O[Sa]=Hb,Sa++;return O}at(O){let Sa=this.Cq,Hb=0;for(;Hb!==O;){if(!Sa)throw Error.argumentOutOfRange("pos");Sa=Sa.next;Hb++}return Sa}}Object(d.a)(eh,"List",null,[1]);class Qg extends Sys.EventArgs{constructor(O){super();
this.properties=O}}Object(d.a)(Qg,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class fh{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(d.a)(fh,"MiniAddinInfo",null,[]);class of{constructor(O,Sa,Hb){this.Qa=new je.a;this.context=new Ve;this.$Uc=this.yXd=this.WGa=this.NO=this.bY=null;this.contextActivationMgr=O;this.KPg=Sa;this.XGa=Hb;this.appName=Kd.AFrameworkApplication.fa.Xa("WebAppShortName")}get FPb(){this.$Uc||(this.$Uc=new Dg(this.Qa));return this.$Uc}MLg(O){this.Qa.addHandler(qd.a.hpb,
O)}fPg(O){this.Qa.addHandler(qd.a.WVd,O)}zVj(O){null!==O&&(this.context.DO=O[qd.a.f3],this.context.rq=O[qd.a.GM],this.context.xDc=this.context.Ptc=0,O=qd.a.YGa in O?O[qd.a.YGa]:0,-1!==this.context.DO&&0!==this.context.rq&&(this.context.j$=new eh,this.context.Rja=new eh,this.context.Y5b=new eh,this.context.OYc=this.KPg.createAddinDataProvider(Pg(this.context.DO),this.contextActivationMgr),this.context.OYc?this.context.OYc.getEntitlementsAsync(this.contextActivationMgr.mda,!0,O,Sa=>{this.hVi(Sa)}):
n.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.DO)))}hVi(O){if(O&&0<O.length){this.context.xDc=O.length;const Hb=Kd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?Yg():null;for(let hc=0;hc<O.length;hc++){const wc=O[hc];if(Kd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&ng()&&wc&&wc.storeType&&"omex"===wc.storeType.toLowerCase()&&wc.assetId&&Hb&&wc.assetId.toLowerCase()===
Hb.toLowerCase()){var Sa={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:of.zV(wc)};be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ta.a.Aj(Sa)}))}!wc||1!==wc.targetType&&-1!==wc.targetType?this.ppc():(Sa={},Kd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(Sa.solutionId=wc.solutionId,Sa.version=wc.version):(Sa.marketplaceId=wc.solutionId,Sa.marketplaceVersion=
wc.version),Sa.storeType=wc.storeType,Sa.storeId=wc.storeId,Sa.targetData=wc,of.GPb?this.contextActivationMgr.isAddinCommandsExAsync(Sa,Object(Vd.a)(this,this.DUi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(Sa,(ad,kd,od)=>{ad?(kd&&this.context.j$.add(od.targetData),10===this.context.DO&&(ad=od.targetData,kd=ad.targetType,de.c(od.targetTypeForExp)||(kd=od.targetTypeForExp,ad.targetType=kd),this.context.Rja.add(ad),0===kd&&this.context.Y5b.add(ad))):(od=od.targetData,
n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(od.solutionId,od.storeType,od.assetId,null,null,od.storeId),od.storeType));this.ppc()}))}}else this.ppc()}ppc(){var O;(O=this.context).Ptc=O.Ptc+1;this.context.Ptc>=this.context.xDc&&(this.XGa.W3f(this.context.DO,!1),0<this.context.xDc&&10===this.context.DO&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(O=!1,Kd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&
Xg()&&(O=this.sBi()),this.FAi(),Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!O?of.GPb?this.FPb.A0d(this.contextActivationMgr,this.context.NYc,this.context.DIa,(Sa,Hb)=>{const hc=new m.a;for(let wc of Sa)Sa=wc.wfg(),Hb&&Hb.solutionId===wc.solutionId&&(Sa.showCallout=!0,this.FPb.Fkg(Hb)),hc.add(Sa);this.mna(hc)}):this.kOh(this.context.j$):this.m0b(this.context.j$)):this.m0b(this.context.j$))}m0b(O){if(of.GPb)this.mna(this.s8g(this.context.NYc));
else{var Sa=new m.a;if(O)for(let Hb of this.context.j$)Sa.add(lg(Hb));this.context.j$&&1>this.context.j$.count&&rf.a.Hgb(qd.a.ipb,"false",this.context.DO);O={["ack2"]:Sa};O[qd.a.f3]=this.context.DO;O[qd.a.GM]=this.context.rq;this.Qa.raiseEvent(qd.a.hpb,new Qg(O),this)}}s8g(O){const Sa=new m.a;if(O)for(let Hb of O)Sa.add(Hb.wfg());return Sa}mna(O){O&&O.count||rf.a.Hgb(qd.a.ipb,"false",this.context.DO);O={["ack2"]:O};O[qd.a.f3]=this.context.DO;O[qd.a.GM]=this.context.rq;this.Qa.raiseEvent(qd.a.hpb,
new Qg(O),this)}XAa(O){if(this.appName){const Sa={},Hb={};Hb.LastTeachingUIShowTime=(new Date).toUTCString();Hb.AddinHasShown=O;Sa[this.appName]=wf.c(Hb);this.bY&&(this.bY.X3a(Sa),n.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else n.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}kOh(O){(this.WGa=O)?(O=new m.a,O.add(this.appName),this.bY=new $f(this.appName,Object(Vd.a)(this,
this.R4,"getRequestSuccessCallback"),Object(Vd.a)(this,this.xN,"getRequestFailureCallback"),Object(Vd.a)(this,this.yO,"postRequestFailureCallback")),this.bY.oac(O)):(O={["ack2"]:new m.a},O[qd.a.f3]=this.context.DO,O[qd.a.GM]=this.context.rq,this.Qa.raiseEvent(qd.a.hpb,new Qg(O),this))}R4(O){O?this.bOb(O)?(n.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.NO="AddinHasShown"in O&&O.AddinHasShown?O.AddinHasShown.toString():null,this.vsb()):(n.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.m0b(this.WGa)):(n.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.NO=null,this.vsb())}xN(O){n.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",O?O.httpStatus:-1);this.m0b(this.WGa)}yO(O){n.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}vsb(){const O=this.v9c();0===O.targetType?(O.solutionId?(this.yXd=O.solutionId,this.VJd()):this.Vla("NoSolutionId"),O.addinId&&
(window.g_roamingAddinList=this.NO?this.NO+","+O.addinId:O.addinId),this.zqe(null)):this.zqe(O.addinId);n.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",O.addinId)}VJd(){const O=new If;O.callbackFunc=Sa=>{if(Sa.errorCode){this.Vla("FailToGetAppDetails");var Hb=window.g_roamingAddinList;Hb&&this.XAa(Hb)}else if(Sa.value)for(Hb of Sa.value)if(Sa=Hb[1],Sa===this.yXd){const hc={};hc.solutionId=Sa;hc.assetId=Hb[5];hc.storeType=Hb[12];hc.storeId=Hb[11];hc.assetStoreId=Hb[6];hc.targetType=
Hb[3];hc.width=Hb[7];hc.height=Hb[8];hc.displayName=Hb[0];hc.version=Hb[4];Hb=new ih(hc);this.Qa.raiseEvent(qd.a.WVd,Hb);break}};O.storeType=OSF.StoreTypeEnum.PrivateCatalog;O.fromInsertDialog=!1;O.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(O)}bOb(O){if("LastTeachingUIShowTime"in O){if(O=+new Date-+new Date(O.LastTeachingUIShowTime.toString()),O<Kd.AFrameworkApplication.fa.tN("AddinShowTeachingUIIntervalInMS",864E5))return n.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
O),!1}else n.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}v9c(){let O=new Jd.a(new fh,0),Sa=new Jd.a(new fh,0),Hb=0,hc=0,wc=0;var ad=new eh;if(0<this.context.j$.count)for(var kd of this.context.j$)ad.add(kd);if(0<this.context.Y5b.count)for(let od of this.context.Y5b)ad.add(od);for(let od of ad)if(!("excatalog"!==od.storeType||de.c(od.installTimeInMS)||!od.installTimeInMS||od.installTimeInMS<=Kd.AFrameworkApplication.fa.tN("DateTimeInMSForNewAddin",16409952E5))){ad=of.Lwb(od);
if(this.NO&&(kd=this.NO.split(","),0<kd.length&&Array.contains(kd,ad))){wc++;n.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}ad.startsWith("private_")?(O.value<od.installTimeInMS&&(O=new Jd.a(Object.assign(new fh,{addinId:ad,targetType:od.targetType,solutionId:od.solutionId}),od.installTimeInMS)),hc++):(Sa.value<od.installTimeInMS&&(Sa=new Jd.a(Object.assign(new fh,{addinId:ad,targetType:od.targetType,solutionId:od.solutionId}),od.installTimeInMS)),Hb++)}n.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",hc,Hb,wc);return 0<Sa.value?Sa.key:0<O.value?O.key:Object.assign(new fh,{addinId:null,targetType:-1,solutionId:null})}zqe(O){const Sa=new m.a;for(let Hb of this.WGa){const hc=lg(Hb);if(O){const wc=of.Lwb(Hb);O===wc&&(hc.showCallout=!0,window.g_roamingAddinList=this.NO?this.NO+","+O:O)}Sa.add(hc)}this.WGa&&1>this.WGa.count&&rf.a.Hgb(qd.a.ipb,"false",this.context.DO);O={["ack2"]:Sa};O[qd.a.f3]=this.context.DO;
O[qd.a.GM]=this.context.rq;this.Qa.raiseEvent(qd.a.hpb,new Qg(O),this)}sBi(){if(of.GPb)return this.tBi(this.context.lfd);var O=!1;if(this.context.Rja&&1>this.context.Rja.count)return O;const Sa=Yg();if(!Sa)return O;for(let Hb of this.context.Rja)if(Hb.storeId&&Hb.storeId.toLowerCase()===Sa.toLowerCase()||Hb.assetId&&Hb.assetId.toLowerCase()===Sa.toLowerCase())O={["SDX_Id"]:of.zV(Hb),["SDX_TargetType"]:de.c(Hb.targetType)?"":Hb.targetType.toString()},be.a.sendTelemetryEvent(Object.assign(new Of.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:ta.a.Aj(O)})),O=!0;return O}FAi(){if(of.GPb)this.GAi(this.context.lfd);else if(!(this.context.Rja&&1>this.context.Rja.count))if(this.XGa.alf()){var O=this.XGa.n7e();O?(O=this.$2e(this.context.Rja,O),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.$2e(this.context.Rja,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.XGa.x6f(O)}else n.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}$2e(O,
Sa){const Hb={};let hc=!1;for(let wc of O)if(O=of.zV(wc))!Sa||O in Sa||(this.b0(wc,O),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?hc||(hc=!0,Hb[O]=null):Hb[O]=null;return Hb}b0(O,Sa){var Hb=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Hb={["SDX.Id"]:Sa,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:de.c(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Hb};be.a.sendTelemetryEvent(Object.assign(new Of.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:ta.a.Aj(Hb)}));1===O.targetType&&(O={["SDX.Id"]:Sa,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ta.a.Aj(O)})))}tBi(O){let Sa=!1;if(O&&1>O.count)return Sa;const Hb=Yg();if(!Hb)return Sa;for(let hc of O)if(hc.storeId&&hc.storeId.toLowerCase()===Hb.toLowerCase()||hc.assetId&&hc.assetId.toLowerCase()===Hb.toLowerCase())O=
{["SDX_Id"]:of.q7e(hc),["SDX_TargetType"]:de.c(hc.targetType)?"":hc.targetType.toString()},be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:ta.a.Aj(O)})),Sa=!0;return Sa}GAi(O){if(!(O&&1>O.count))if(this.XGa.alf()){var Sa=this.XGa.n7e();Sa?(O=this.a3e(O,Sa),n.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(O=this.a3e(O,null),n.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.XGa.x6f(O)}else n.ULS.sendTraceTag(528589915,
306,50,"Local storage got disabled")}a3e(O,Sa){const Hb={};let hc=!1;for(let wc of O)if(O=of.q7e(wc))!Sa||O in Sa||(this.zDi(wc,O),n.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===O.toLowerCase()?hc||(hc=!0,Hb[O]=null):Hb[O]=null;return Hb}zDi(O,Sa){var Hb=O.installTimeInMS?(new Date(O.installTimeInMS)).toISOString():"";Hb={["SDX.Id"]:Sa,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:de.c(O.targetType)?"":O.targetType.toString(),["SDX.AdminDeploymentTime"]:Hb};
be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ta.a.Aj(Hb)}));1===O.targetType&&(O={["SDX.Id"]:Sa,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ta.a.Aj(O)})))}DUi(O,Sa,Hb,hc){O?(-1===hc.targetType&&(hc.targetType=Hb.targetTypeForExp),O=new Rf(Hb.targetData,hc),Sa&&this.context.NYc.add(O),10===this.context.DO&&(this.context.lfd.add(O),
0===O.targetType&&this.context.DIa.add(O))):(Sa=Hb.targetData,n.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,Sa.storeType,Sa.assetId,null,null,Sa.storeId),Sa.storeType));this.ppc()}Vla(O){O={["AppTeachingUICalloutAction"]:O,["SDX.Id"]:this.yXd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:ta.a.Aj(O)}))}static get GPb(){return Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static zV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static q7e(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static Lwb(O){return Telemetry.PrivacyRules.IsPrivateAddin(O.storeType,O.assetId,null,null,O.storeId)?
"private_"+O.installTimeInMS:O.solutionId}}Object(d.a)(of,"AddInCommandsListLoader",null,[]);class ma{constructor(O){this.rBg=O}get mda(){return this.rBg}insertOsfControl(O){return this.mda.insertOsfControl(O)}getManifestInvaildErrorString(){return this.mda.getManifestInvaildErrorString()}isAddinCommandsAsync(O,Sa){this.mda.isAddinCommandsAsync(O,Sa)}isAddinCommandsExAsync(O,Sa){this.mda.isAddinCommandsExAsync(O,Sa)}ownerAddinControlRecreated(O,Sa){this.mda.ownerAddinControlRecreated(O,Sa)}queryEntitlementDetails(O){this.mda.queryEntitlementDetails(O)}}
Object(d.a)(ma,"ContextActivationMgrWrapper",null,[345]);class yb{createAddinDataProvider(O,Sa){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(O,Sa.mda)}static get instance(){yb.Ma||(yb.Ma=new yb);return yb.Ma}}yb.Ma=null;Object(d.a)(yb,"OSFAddinDataProviderFactory",null,[344]);class jc{constructor(){this.Ver=1}}Object(d.a)(jc,"CacheItem",null,[]);class Cc{constructor(O){this.ZEa=O}Gl(O){const Sa=this.ZEa.getItem(O);if(Sa){let Hb=new jc;try{Hb=Sys.Serialization.JavaScriptSerializer.deserialize(Sa,
!0)}catch(hc){return this.ZEa.removeItem(O),null}return Hb.Data?Hb.Data:Hb.data}return null}DRa(O){this.ZEa.removeItem(O)}}Object(d.a)(Cc,"AppsDataCacheManager",null,[368]);var sd=a(821);class Md{constructor(){new Cc(sd.a.instance)}W3f(O,Sa){O=qd.a.f4e()+O;sd.a.instance.setItem(O,Sa.toString())}n7e(){var O=qd.a.r7e();n.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",O);O=sd.a.instance.getItem(O);return wf.a(O)}x6f(O){const Sa=qd.a.r7e();n.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
Sa);sd.a.instance.setItem(Sa,wf.c(O))}alf(){return!!sd.a.instance.localStorage}static get instance(){Md.Ma||(Md.Ma=new Md);return Md.Ma}}Md.Ma=null;Object(d.a)(Md,"AddInCommandsCacheManager",null,[350]);class ie{constructor(O){this.MCc=null;this.hea=!1;this.Qa=new je.a;this.HLb=this.Spa=null;this.contextActivationMgr=O;window.addEventListener&&(window.addEventListener("LaunchBEPCallout",Object(Vd.a)(this,this.SWi,"onPrimaryButtonClickedEventHandler"),!0),window.addEventListener("DismissBEPCallout",
Object(Vd.a)(this,this.tGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseBEPCallout",Object(Vd.a)(this,this.oGb,"onCloseButtonClickedEventHandler"),!0))}get appName(){de.b(this.Spa)&&(this.Spa=Kd.AFrameworkApplication.fa.Xa("WebAppShortName"));return this.Spa}GNg(O){this.Qa.addHandler(qd.a.Oqf,O)}A0d(){this.contextActivationMgr.queryStoreDisabled("omex",O=>{O?n.ULS.sendTraceTag(509686157,344,50,"Store is disabled for current user"):this.eUj()})}eUj(){this.MCc=new $f(this.appName,
Object(Vd.a)(this,this.R4,"getRequestSuccessCallback"),Object(Vd.a)(this,this.xN,"getRequestFailureCallback"),Object(Vd.a)(this,this.yO,"postRequestFailureCallback"));this.MCc.eEh()}R4(O){this.bOb(O)&&(n.ULS.sendTraceTag(509690977,344,50,"should show teaching UI"),this.LWd())}xN(O){n.ULS.sendTraceTag(509690976,344,10,"Failed to GET data from Roaming Settings with status: {0}",O?O.httpStatus:-1)}yO(O){n.ULS.sendTraceTag(509690975,344,10,"Failed to POST data to Roaming Settings with status: {0}",O?
O.httpStatus:-1)}bOb(O){if(!O)n.ULS.sendTraceTag(509690974,344,50,"userSettings is null");else if("Platforms"in O&&(this.HLb=Object(U.a)(String,O.Platforms),!de.b(this.HLb)&&(O=this.HLb.split(","),0<O.length&&Array.contains(O,"Web"))))return n.ULS.sendTraceTag(509690973,344,50,"callout has shown for this platform"),!1;return!0}LWd(){const O=Hc.a.instance.Rb("Common.ISystemInitiatedFeedback");if(O){var Sa=this.bOh();de.b(Sa)?n.ULS.sendTraceTag(509686979,344,50,"activity name is empty"):O.execute(Hb=>
{Hb.logActivity(Sa,null)})}else n.ULS.sendTraceTag(509690972,344,50,"Error resolving ISystemInitiatedFeedback Future")}SWi(){this.b0("ClickOnLaunch");this.HQd();this.Qa.raiseEvent(qd.a.Oqf)}oGb(){this.b0("ClickOnClose");this.HQd()}tGb(){this.b0("ClickOnDismiss");this.HQd()}bOh(){let O;switch(this.appName){case "Word":O="WordShowCalloutForBEPHomeTab";break;case "Excel":O="ExcelShowCalloutForBEPHomeTab";break;case "PowerPoint":O="PPTShowCalloutForBEPHomeTab";break;default:O=""}return O}b0(O){O={["AppTeachingUICalloutAction"]:O,
["AppTeachingUICalloutGoal"]:"BetterEntryPoint"};be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}))}HQd(){if(!this.hea)if(de.b(this.appName))n.ULS.sendTraceTag(509690970,344,10,"Fail saving to roaming service since AppName is null");else{const O={};O[this.appName]=this.HLb?this.HLb+",Web":"Web";this.MCc&&(this.MCc.jEh(O),n.ULS.sendTraceTag(509690971,344,50,"Initiating call to save Roaming Settings for current user"));this.hea=
!0}}}Object(d.a)(ie,"BetterEntryTeachingCalloutLauncher",null,[]);class He{constructor(O,Sa,Hb,hc,wc,ad){this.rq=O;this.qk=Sa;this.mX=Hb;this.displayName=wc;this.Opf=ad}}Object(d.a)(He,"PostLaunchAddinCommandsParameters",null,[]);class ef{constructor(O,Sa,Hb){this.hea=!1;this.bY=null;this.Za=O;this.Akb=Sa;this.Shb=Hb}sXc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Vd.a)(this,this.GEd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",
Object(Vd.a)(this,this.tGb,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Vd.a)(this,this.oGb,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(Vd.a)(this,this.hGb,"onCampaignLaunchedHandler"),!0)):n.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}GEd(){const O={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:ef.zV(this.Akb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.Shb&&this.Shb.tabs&&!this.Shb.tabs[0].isOfficeTab&&(O["SDX.FeatureFlags"]="NonOfficeTab");be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}));this.fma();this.Shb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Shb,()=>{const Sa=new xg;Sa.qk=this.Akb;this.Za.raiseEvent(qd.a.zwd,Sa)}):n.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}oGb(){const O=
{["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:ef.zV(this.Akb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}));this.fma()}tGb(){const O={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:ef.zV(this.Akb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object.assign(new Of.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}));this.fma()}hGb(O){if(O&&(O=O.detail)&&O.id&&this.Aqd(O.id)){const Hb=(O.action||"").toLowerCase();if(O.success&&"opened"===Hb){var Sa={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:ef.zV(this.Akb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(Sa)}));
n.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.fma();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Vd.a)(this,this.hGb,"onCampaignLaunchedHandler"),!0)}else try{Sa=JSON.stringify(O),n.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Sa)}catch(hc){Sa="id : "+O.id+" telemetryEventName: "+O.telemetryEventName,n.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Sa+" Error: "+
(hc?hc.toString():""))}}}Aqd(O){O=Sf.a.wl(O);return-1!==O.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==O.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==O.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==O.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==O.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==O.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}XAa(O){const Sa=Kd.AFrameworkApplication.fa.Xa("WebAppShortName");if(Sa){const Hb={},hc={};hc.LastTeachingUIShowTime=
(new Date).toUTCString();hc.AddinHasShown=O;Hb[Sa]=wf.c(hc);this.bY=new $f(Sa,null,null,Object(Vd.a)(this,this.yO,"postRequestFailureCallback")),this.bY.X3a(Hb),n.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else n.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")}fma(){if(!this.hea){const O=window.g_roamingAddinList;O&&(this.XAa(O),this.hea=!0)}}yO(O){n.ULS.sendTraceTag(523535566,
220,10,"failed to POST data to Roaming Settings Service with status: {0}",O?O.httpStatus:-1)}static zV(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}}Object(d.a)(ef,"PrivateCatalogTeachingCalloutHandler",null,[]);class uf{constructor(O){this.fee=null;this.Xbe=O}get dya(){return this.fee}RZa(O,Sa=null){this.Xbe.RZa(O,Sa);this.fee=O}VMd(O){this.Xbe.VMd(O)}}Object(d.a)(uf,"RibbonExtensibilityManagerWithChangeDetection",null,[369]);var cg=
a(865),qe=a(99);class N{static V4e(O){const Sa=new m.a;if(N.pGe)for(var Hb of N.pGe)Sa.add(Hb);Hb=null;switch(O){case "Workbook":Hb=N.e5j;break;case "Document":Hb=N.nph;break;case "Presentation":Hb=N.o7i}if(Hb)for(const hc of Hb)Sa.add(hc);return Sa}}N.pGe=["PrimaryCommandSurface","ContextMenu"];N.e5j=null;N.nph=null;N.o7i=null;Object(d.a)(N,"ExtensionPointType",null,[]);class za{constructor(O){this.fhe=null;if(de.c(O))throw n.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),
Error.create("The agave key should not be null or undefined");this.Hsg=O}get VFb(){return this.fhe||(this.fhe=new m.a)}get eue(){return this.Hsg}}Object(d.a)(za,"ContextMenuExtensibility",null,[355]);class F{constructor(O,Sa=null,Hb=0){if(de.c(O))throw n.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.kBg=O;this.yEg=Sa;this.jxg=Hb}get uW(){return this.kBg}get startedNode(){return this.yEg}get yNh(){return this.jxg}}
Object(d.a)(F,"RibbonExtensibility",null,[408]);class ea{constructor(O){this.jwg=O.entitlement}get entitlement(){return this.jwg}createActionContext(O,Sa){O={};O.ownerAddinInfo=this.entitlement;O.action=Sa;return O}}Object(d.a)(ea,"AddInCommandsContextProvider",null,[]);class fb{constructor(O,Sa,Hb){this.f6d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=O;this.eventBuilder=Sa;this.contextMenuBuilder=Hb}get addinInfo(){return this.f6d}ych(O){return new ea(O)}createActionBuilder(O,
Sa){return OfficeExt.DefaultControlActionBinder.createActionBuilder(O,Sa.entitlement,Sa.manifest)}startApplyAddin(O){this.f6d=O;const Sa=this.ych(O);this.actionBuilder=this.createActionBuilder(Sa,O)}endApplyAddin(){}Nfd(O,Sa,Hb=0){return this.ribbonBuilder.ot&&0<this.ribbonBuilder.ot.count?new F(this.PMh(O,Sa),this.addinInfo.startedNode,Hb):null}x0e(){var O=null;if(this.contextMenuBuilder.Qnc&&0<this.contextMenuBuilder.Qnc.count){O||(O=this.addinInfo.entitlement.solutionId);O=new za(O);for(let Sa of this.contextMenuBuilder.Qnc)O.VFb.add(Sa);
return O}return null}PMh(O,Sa){return this.ribbonBuilder.ot&&0<this.ribbonBuilder.ot.count?new qf.a(this.ribbonBuilder.ot,O,Sa):null}}Object(d.a)(fb,"AddinCommandsBuilder",null,[]);class ub{constructor(O,Sa,Hb,hc,wc,ad,kd){this.pUa=new qe.a;this.rq=O;this.Ph=Sa;this.gp=Hb;this.ribbonManager=hc;this.contextMenuManager=wc;this.nG=ad;this.wha=kd;this.dP=Kd.AFrameworkApplication.ta.kE}BDb(O,Sa,Hb,hc,wc,ad,kd){const od=(Dd,Pd,Se,Ue)=>{wc(Dd,Pd,Se,Ue);Dd=cg.a[this.rq]+Pd.assetId;({value:Pd}=this.pUa.Ec(Dd)).returnValue&&
(Pd.stop(),this.pUa.remove(Dd))};if(0!==this.rq&&O){n.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",O.count);4===this.rq&&(n.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",hc)),this.E4g(O,hc),ad());for(let Dd of O)if(O=Dd,n.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.Dmg(O))if(kd&&
O.requireConsent)kd(O,Pd=>{try{if(this.dP){const Ue=cg.a[this.rq]+Pd.solutionId,lf=this.dP.Cc("ComponentAttach",Ue);this.pUa.ia(Ue,lf)}const Se=this.nG.xja(Pd.storeType,Pd.solutionId);6!==this.rq&&(Se&&(this.N4b(Se),Se.LB.purge(!1)),this.Ph.insertOsfControl(this.JIb(Pd,Sa,Hb,od)),Se&&this.Ph.ownerAddinControlRecreated(Pd.solutionId,Pd.storeType))}catch(Se){n.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.solutionId,Pd.ownerAddinStoreType||Pd.storeType,Pd.assetId,null,null,Pd.storeId),Pd.version,Pd.storeType,Pd.storeId,Se.message)),od(!1,Pd,null,null)}});else try{if(this.dP){const Se=cg.a[this.rq]+O.solutionId,Ue=this.dP.Cc("ComponentAttach",Se);this.pUa.ia(Se,Ue)}const Pd=this.nG.xja(O.storeType,O.solutionId);6!==this.rq&&(Pd&&(this.N4b(Pd),Pd.LB.purge(!1)),this.Ph.insertOsfControl(this.JIb(O,Sa,Hb,od)),Pd&&this.Ph.ownerAddinControlRecreated(O.solutionId,
O.storeType))}catch(Pd){n.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,Pd.message)),od(!1,O,null,null)}else od(!1,O,null,null)}}$xi(O,Sa,Hb,hc,wc,ad){const kd=(od,Dd,Pd,Se)=>{ad(od,Dd,Pd,Se);od=cg.a[this.rq]+Dd.solutionId;
({value:Dd}=this.pUa.Ec(od)).returnValue&&(Dd.stop(),this.pUa.remove(od))};if(6===this.rq&&O)if(n.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId))),this.Dmg(O))try{if(this.dP){const Dd=cg.a[this.rq]+O.solutionId,Pd=this.dP.Cc("ComponentAttach",Dd);this.pUa.ia(Dd,Pd)}const od=this.nG.xja(O.storeType,O.solutionId);od||kd(!1,O,null,null);
Kd.AFrameworkApplication.ta&&Kd.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.V0e(O,Sa,hc,wc,Hb,Dd=>{kd(Dd,O,Hb,od.displayName)}):(this.V0e(O,Sa,hc,wc,Hb),kd(!0,O,Hb,od.displayName))}catch(od){n.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,
null,null,O.storeId),O.version,O.storeType,O.storeId,od.message)),kd(!1,O,null,null)}else kd(!1,O,null,null)}GMi(O,Sa,Hb,hc,wc,ad){if(ad)if(ad._isAddinCommandsManifest(this.gp.EN))try{Kd.AFrameworkApplication.ta&&Kd.AFrameworkApplication.ta.Pa.delayInstallAddInIsEnabled?this.U0e(O,Sa,Hb,wc,ad,kd=>{hc(kd,O,ad,ad.getDefaultDisplayName())}):(this.U0e(O,Sa,Hb,wc,ad),hc(!0,O,ad,ad.getDefaultDisplayName()))}catch(kd){n.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId,kd.message)),hc(!1,O,ad,ad.getDefaultDisplayName())}else n.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,
O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),hc(!1,O,null,null);else n.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.gp.EN,Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.ownerAddinStoreType||O.storeType,O.assetId,null,null,O.storeId),O.version,O.storeType,O.storeId)),hc(!1,O,null,null)}JIb(O,Sa,Hb,hc){const wc={},ad=document.createElement("div");ad.setAttribute("visible",
"false");wc.div=ad;wc.id=O.solutionId;wc.solutionId=O.solutionId;wc.version=O.version;wc.storeType=O.storeType;wc.storeId=O.storeId;wc.assetId=O.assetId;wc.assetStoreId=O.assetStoreId;wc.isvirtualOsfControl=!0;wc.virtualOsfControlActivationCallback=(kd,od)=>{const Dd=this.nG.xja(O.storeType,O.solutionId);Dd&&(Dd.isUpgraded&&(O.isUpgraded=!0),this.N4b(Dd));this.GMi(O,Sa,Hb,hc,kd,od)};wc.reason=3===this.rq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return wc}U0e(O,Sa,Hb,hc,wc,ad=null){const kd={};kd.solutionId=hc.getSolutionId();kd.version=hc.getVersion();kd.storeType=hc.getStoreType();kd.storeId=hc.getStoreId();kd.assetId=hc.getAssetId();kd.assetStoreId=hc.getAssetStoreId();kd.targetType=hc.getOsfControlType();let od=null,Dd=null;if(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))od=(new OfficeExt.Parser.AddinCommandsManifestParser(this.gp.EN,this.gp.formFactor)).parseExtensions(kd,
wc,this.wha),Dd=N.V4e(this.gp.EN);else try{od=(new OfficeExt.Parser.AddinCommandsManifestParser(this.gp.EN,this.gp.formFactor)).parseExtensions(kd,wc,this.wha),Dd=N.V4e(this.gp.EN)}catch(Se){throw n.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Se.message),Se;}if(Dd&&0<Dd.count){if(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Pd=Sa(O);Sa=Hb(O);Hb=!!Kd.AFrameworkApplication.fa&&
Kd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Pd=new fb(Pd,null,Sa);for(let Se of Dd)Pd.commandSurface=Se,od.apply(Pd,this.wha,Hb)}else try{let Se=Sa(O),Ue=Hb(O),lf=!!Kd.AFrameworkApplication.fa&&Kd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Pd=new fb(Se,null,Ue);for(let zg of Dd)Pd.commandSurface=zg,od.apply(Pd,this.wha,lf)}catch(Se){throw n.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Se.message),
Se;}if(OSF.OUtil.checkFlight(14))try{let Se=Pd.Nfd(O.solutionId,wc.getDefaultDisplayName()),Ue=Pd.x0e();Se&&this.ribbonManager.RZa(Se,ad);Ue&&this.contextMenuManager.aqe(Ue);this.nG.Hqe(hc,Se,Ue,wc.getDefaultDisplayName());n.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",wc.getDefaultDisplayName())}catch(Se){throw OfficeExt.DevConsole.log(Se),n.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Se.message),Se;}else try{let Se=Pd.Nfd(O.solutionId,wc.getDefaultDisplayName()),
Ue=Pd.x0e();Se&&this.ribbonManager.RZa(Se);Ue&&this.contextMenuManager.aqe(Ue);this.nG.Hqe(hc,Se,Ue,wc.getDefaultDisplayName());n.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",wc.getDefaultDisplayName())}catch(Se){throw n.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Se.message),Se;}}}V0e(O,Sa,Hb,hc,wc,ad=null){const kd={};kd.solutionId=O.solutionId;kd.version=O.version;kd.storeType=O.storeType;kd.storeId=O.storeId;kd.assetId=O.assetId;kd.assetStoreId=
O.assetStoreId;kd.targetType=O.targetType;const od=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.gp.EN,this.gp.formFactor);try{const Dd=Sa.getManifest(),Pd=od.parse(kd,Dd,wc,this.wha,Sa.getSharedRuntimeId(),Sa),Se=Hb(O),Ue=hc(O),lf=new fb(Se,null,Ue);lf.commandSurface="PrimaryCommandSurface";Pd.apply(lf,this.wha,!0);if(lf.ribbonBuilder.ot&&0<lf.ribbonBuilder.ot.count){const zg=lf.Nfd(O.solutionId,Sa.getManifest().getDefaultDisplayName(),1);Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.RZa(zg,ad):zg&&this.ribbonManager.RZa(zg,ad);this.nG.PJg(Sa,zg,wc,Sa.getManifest().getDefaultDisplayName());n.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Sa.getManifest().getDefaultDisplayName())}}catch(Dd){n.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Sa.getManifest().getDefaultDisplayName(),Dd.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Dd)}}N4b(O){O.Vo&&this.ribbonManager.VMd(O.Vo);
O.Jsb&&this.contextMenuManager.zgj(O.Jsb);this.nG.hgj(O.LB.getStoreType(),O.LB.getSolutionId())}E4g(O,Sa){Sa=Pg(Sa);for(let Hb of this.nG.i7a){if(Hb.LB.getStoreType()!==Sa)continue;let hc=!0;for(let wc of O){const ad=wc;if(ad&&Hb.Nmf(ad.storeType,ad.solutionId)){hc=!1;break}}hc&&(this.N4b(Hb),Hb.LB.purge(!1))}}Dmg(O){return!!O&&!!O.solutionId&&!!O.version&&!!O.storeType&&!!O.storeId}}Object(d.a)(ub,"AddInCommandsIntegration",null,[]);class Pb{constructor(O,Sa,Hb,hc,wc,ad,kd,od=null){this.Za=new je.a;
this.DHc=O;this.bvg=Sa;this.Hm=Hb;this.qne=hc;this.EYa=wc;this.vsg=ad;this.KSb=kd;this.cBg=od;this.Vyg=Kd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.FNc=Kd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}NLg(O){this.Za.addHandler(qd.a.yte,O)}FNg(O){this.Za.addHandler(qd.a.zwd,O)}ePg(O){this.Za.addHandler(qd.a.M9f,O)}ULg(O){this.Za.addHandler(qd.a.Q_c,O)}tyi(O,Sa,Hb){const hc=Hb[qd.a.gpb],
wc=void 0===Hb[qd.a.GM]?0:Hb[qd.a.GM];if(hc&&0!==wc)if(0>=hc.count&&4!==wc)this.vOf(new He(wc,null,null,Sa,null,!0));else{var ad=hc.count,kd=new uf(new k),od=void 0===Hb[qd.a.f3]?-1:Hb[qd.a.f3],Dd=new ub(wc,this.Hm,this.DHc,kd,this.bvg,this.EYa,this.KSb),Pd=jg=>this.qne.WYg(jg.solutionId,this.KSb,this.DHc,O),Se=jg=>this.qne.gYg(jg.solutionId),Ue=(jg,Zf,ag)=>{ad--;ag=new He(wc,Zf,kd,Sa,ag,0>=ad);if(jg&&Zf)this.vOf(ag);else{if(3===wc||Zf&&Zf.isUpgraded)jg="",Zf&&(jg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Zf.solutionId,
Zf.ownerAddinStoreType||Zf.storeType,Zf.assetId,null,null,Zf.storeId)),Zf={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:jg},be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ta.a.Aj(Zf)}));this.uOf(ag)}ad||Kd.AFrameworkApplication.ta.updateCommandUI()},lf=(jg,Zf,ag,mg)=>{Ue(jg,Zf,mg)},zg=()=>{this.tCd();0>=hc.count&&4===wc&&this.EYa.HSd()};6===wc?(od=Hb[qd.a.NJa],Hb=Hb[qd.a.OJa],Dd.$xi(hc.ma(0),
od,Hb,Pd,Se,(jg,Zf,ag,mg)=>{Ue(jg,Zf,mg)})):Dd.BDb(hc,Pd,Se,od,lf,zg,this.cBg)}else be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ta.a.Aj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),n.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.DHc.EN)),this.uOf(new He(wc,null,null,Sa,null,!0))}uOf(O){this.tCd(O);this.C$f(!1,
O)}vOf(O){const Sa=O.qk;let Hb=null;null!==Sa&&(Hb=Sa.storeType,Hb=Hb.toLowerCase());if(O&&"omex"===Hb&&(3===O.rq||Sa.isUpgraded)){var hc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,Sa.ownerAddinStoreType||Sa.storeType,Sa.assetId,null,null,Sa.storeId)};be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ta.a.Aj(hc)}))}this.tCd(O);hc=this.FNc&&ng()&&"omex"===
Hb&&!!O.mX&&!!Sa.solutionId&&2===O.rq&&Sa.solutionId.toLowerCase()===Yg().toLowerCase();var wc="omex"===Hb&&!!O.mX&&(3===O.rq&&"hardcodedpreinstall"!==Hb||Sa.isUpgraded);const ad=Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",!1)&&"excatalog"===Hb&&3===O.rq;if(wc||hc||ad)hc=new xg,hc.qk=Sa,hc.Vo=O.mX.dya,this.Za.raiseEvent(qd.a.Q_c,hc);this.Vyg&&(hc=Xg(),wc=Yg(),hc&&Sa&&"excatalog"===Sa.storeType&&O.mX&&5===O.rq&&wc&&(Sa.storeId&&Sa.storeId.toLowerCase()===
wc.toLowerCase()||Sa.assetId&&Sa.assetId.toLowerCase()===wc.toLowerCase())&&(hc=new xg,hc.qk=Sa,hc.Vo=O.mX.dya,this.Za.raiseEvent(qd.a.Q_c,hc),n.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));Sa&&(Md.instance.W3f(og(Hb),!0),"uploadfiledevcatalog"===Hb&&(hc=this.vsg.createAddinDataProvider(Hb,this.Hm))&&hc.localCacheAddinCommands(this.Hm.mda,Sa.solutionId,Sa.version,Sa.storeId),rf.a.Hgb(qd.a.ipb,"true",og(Hb)));this.C$f(!0,O)}C$f(O,Sa){O?Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Sa.mX&&5===Sa.rq&&Sa.mX.dya&&void 0!==Sa.qk.showCallout&&null!==Sa.qk.showCallout&&Sa.qk.showCallout?(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Dg(this.Za)).sXc(Sa.qk,qf.a.K4a(Sa.mX.dya)):(new ef(this.Za,Sa.qk,qf.a.K4a(Sa.mX.dya))).sXc(),O=new xg,O.Vo=Sa.mX.dya,O.qk=Sa.qk,this.Za.raiseEvent(qd.a.M9f,O)):3!==Sa.rq?Sa.Opf&&this.EYa.HSd():Sa.mX&&Sa.mX.dya&&"hardcodedpreinstall"!==Sa.qk.storeType&&Tb.a.KGj(Sa.displayName,
Sa.mX.dya,Sa.qk.isAutoLaunched):3===Sa.rq?Sa.qk&&"uploadfiledevcatalog"===Sa.qk.storeType.toLowerCase()?(Sa=this.KSb.mUh(Sa.qk.solutionId),Tb.a.PVd(Sa?Sa:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.EYa.c5f():Sa.Opf&&this.EYa.HSd()}tCd(O=null){var Sa=O?O.qk:null;const Hb=new xg;if(Hb.qk=Sa){var hc=this.EYa.xja(Sa.storeType,Sa.solutionId,6===O.rq?1:0);if(hc&&hc.Vo){Hb.Vo=hc.Vo;var wc=this.FNc?Yg():null;wc=this.FNc&&ng()&&!!Sa.solutionId&&!!wc&&Sa.solutionId.toLowerCase()===
wc.toLowerCase()&&2===O.rq;if(3===O.rq&&"hardcodedpreinstall"!==Sa.storeType||wc)O="",hc.Vo.uW&&hc.Vo.uW.ot&&(hc=hc.Vo.uW.ot.ma(0))&&(O=hc.id),Sa={["SDX_CommandPlacement"]:O,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa.solutionId,Sa.ownerAddinStoreType||Sa.storeType,Sa.assetId,null,null,Sa.storeId)},be.a.sendTelemetryEvent(Object.assign(new Of.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ta.a.Aj(Sa)}))}}this.Za.raiseEvent(qd.a.yte,
Hb)}}Object(d.a)(Pb,"LaunchAddinCommandsHandler",null,[354]);class qc{}qc.RVa="Alt";qc.SVa="Command";qc.id="Id";qc.VVa="Image16by16";qc.tSb="LabelText";qc.YVa="Title";qc.GROUP="Group";qc.a5d="Groups";qc.Khb="Controls";qc.button="Button";qc.Zaa="FlyoutAnchor";qc.LARGE="Large";qc.SMALL="Small";Object(d.a)(qc,"AddinDataNodeConstants",null,[]);a(378);a(567);a(562);a(137);class Vc{constructor(O,Sa){this.fFa=this.I8d=null;if(de.c(O)||de.c(Sa))throw n.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.ivg=Sa;this._id=O;this.CU[qc.id]=this._id}get id(){return this._id||""}get CU(){return this.I8d||(this.I8d={})}get controlType(){return this.ivg||""}get menuItems(){return this.fFa||(this.fFa=new m.a)}}Object(d.a)(Vc,"ControlDefinition",null,[352]);class cd{constructor(O){this.Nfe=null;if(de.c(O))throw n.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=O;this.ima[qc.id]=this._id}get ima(){return this.Nfe||(this.Nfe={})}get id(){return this._id||""}}Object(d.a)(cd,"MenuItemDefinition",null,[381]);class zd{constructor(O){this.gqa=null;if(de.c(O))throw n.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=O}get id(){return this._id}get controls(){return this.gqa||(this.gqa=new m.a)}}Object(d.a)(zd,"OfficeMenuDefinition",
null,[349]);var Od=a(25);class ye{constructor(O,Sa,Hb){this.pJ=this.KWa=null;this.PQc=O;this.AWa=Sa;this.$Va=Hb;this.BAg=new m.a}get woc(){return this.PQc}get jsb(){return this.AWa}get wWc(){return this.$Va}addButton(O){n.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",O.actionType);this.pJ=new Vc(this.Ysa(O.id),qc.button);this.pJ.CU[qc.tSb]=O.label;this.pJ.CU[qc.RVa]=O.label;this.pJ.CU[qc.VVa]=O.icon["16"];this.Fqb(this.pJ.CU[qc.id],O.action);this.DGa(this.pJ.CU);this.KWa.controls.add(this.pJ);
this.pJ=null}startBuildMenu(O){if(de.c(this.KWa))this.KWa=new zd(O.id);else{const Sa=this.Ysa(O.id);this.pJ=new Vc(Sa,qc.Zaa);this.B0a(this.pJ.CU,O);this.pJ.CU[qc.VVa]=O.icon["16"];this.pJ.CU[qc.SVa]=Od.a.alwaysEnabled}}addMenuItem(O){n.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",O.actionType);const Sa=new cd(this.Ysa(O.id));this.B0a(Sa.ima,O);O.icon&&(Sa.ima[qc.VVa]=O.icon["16"]);this.Fqb(Sa.ima[qc.id],O.action);this.DGa(Sa.ima);this.pJ.menuItems.add(Sa)}endBuildMenu(){de.c(this.pJ)?
(this.Qnc.add(this.KWa),this.KWa=null):(this.KWa.controls.add(this.pJ),this.pJ=null)}get Qnc(){return this.BAg}Fqb(O,Sa){this.wWc.bindAction(O,Sa)}DGa(O){this.jsb.DGa(O)}Ysa(O){return this.woc.kLa(O)}B0a(O,Sa){O[qc.tSb]=Sa.label;O[qc.RVa]=Sa.label}}Object(d.a)(ye,"ContextMenuExtensibilityCreator",null,[366,363]);class Ge{constructor(O){this.Jlb=O}get rFb(){return this.Jlb}kLa(O){return this.rFb+O}}Object(d.a)(Ge,"DefaultContextMenuNamingProvider",null,[365]);var ue=a(1319);class Je{bindAction(O,Sa){OfficeExt.DefaultControlActionBinder.bindAction(O,
Sa)}}Object(d.a)(Je,"DefaultUIControlActionBinder",null,[364]);class sf{constructor(O){this.KDa=O}get command(){return this.KDa}DGa(O){O[qc.SVa]=this.command}}Object(d.a)(sf,"DefaultUIControlCommandBinder",null,[361]);var Ye=a(32);class Re{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(d.a)(Re,"AddInControl",null,[]);class mf{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(d.a)(mf,"AddInGroup",null,[]);class Pe{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(d.a)(Pe,"AddInMenuItem",null,[]);class Af{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(d.a)(Af,"AddInTab",null,[]);class Ff{constructor(O,Sa,Hb,hc,wc,ad){this.HSb=new m.a;this.Zib=this.Gfa=this.LWa=null;this.PQc=O;this.$Va=
Sa;this.AWa=Hb;this.Ex=hc;this.KSb=wc;this.I$d=ad}get woc(){return this.PQc}get ot(){return this.HSb}get wWc(){return this.$Va}get jsb(){return this.AWa}startBuildTab(O){const Sa=O.isOfficeTab?O.id:this.woc.h9e(O.id),Hb=O.isOfficeTab?null:O.label;this.LWa=Object.assign(new Af,{id:Sa,title:Hb,isOfficeTab:O.isOfficeTab,visible:O.visible,groups:[],tabType:O.tabType,insertBefore:O.insertBefore,insertAfter:O.insertAfter,autoFocus:O.autoFocus})}startBuildGroup(O){const Sa=this.Ysa(O.id);this.Gfa=Object.assign(new mf,
{id:Sa,mlrId:O.mlrId,title:O.label,controls:[],groupType:0})}addNativeGroup(O){this.Gfa=Object.assign(new mf,{id:O.id,mlrId:O.mlrId,title:O.label,controls:[],groupType:1});this.LWa.groups.push(this.Gfa)}addButton(O){const Sa=this.Ysa(O.id);Sa&&(this.Fqb(Sa,O.action),n.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new Re,{id:Sa,title:O.label,iconLocation:this.gid(O),enabled:O.enabled,controlType:0,attributes:this.B0a()}),this.I$d.Npe(new Ye.a(Sa,
this.jsb.command.toString())),this.Gfa.controls.push(O))}addNativeControl(O){O.id&&(n.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",O.actionType),O=Object.assign(new Re,{id:O.id,title:"",iconLocation:"",enabled:O.enabled,controlType:2,attributes:this.B0a()}),this.Gfa.controls.push(O))}startBuildMenu(O){const Sa=this.Ysa(O.id);Sa&&(this.Zib=Object.assign(new Re,{id:Sa,title:O.label,iconLocation:this.gid(O),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(O){const Sa=
this.Ysa(O.id);Sa&&(this.Fqb(Sa,O.action),n.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",O.actionType),O=Object.assign(new Pe,{id:Sa,title:O.label,iconLocation:this.gid(O),enabled:O.enabled,attributes:this.B0a()}),this.I$d.Npe(new Ye.a(Sa,this.jsb.command.toString())),this.Zib.menuItems.push(O))}endBuildMenu(){de.c(this.Zib.id)||this.Gfa.controls.push(this.Zib);this.Zib=null}endBuildGroup(){de.c(this.Gfa.id)||this.LWa.groups.push(this.Gfa);this.Gfa=null}endBuildTab(){de.c(this.LWa.id)||
this.HSb.add(this.LWa);this.LWa=null}B0a(){const O={};this.DGa(O);return O}gid(O){return O.icon["80"]?O.icon["80"]:O.icon["32"]}DGa(O){this.jsb.DGa(O)}Ysa(O){return this.woc.kLa(O)}Fqb(O,Sa){this.wWc.bindAction(O,Sa)}}Object(d.a)(Ff,"OneLineRibbonExtensibilityCreator",null,[362,363]);class hg{constructor(O,Sa){this.Jlb=O;this.$Va=new Je;this.AWa=new sf(Sa)}gYg(O){O=new Ge(O);return new ye(O,this.AWa,this.$Va)}WYg(O,Sa,Hb,hc){Hb=new ue.a(this.Jlb,O,Hb,!0);return new Ff(Hb,this.$Va,this.AWa,O,Sa,hc)}}
Object(d.a)(hg,"UIExtensibilityFactory",null,[342]);var vg=a(92),Lg=a(864),yh=a(22),Yf=a(37),Rg=a(76),sg=a(48);class Sg{constructor(O){this.VGa=this.$Ga=this.qk=this.Vo=null;this.EVf=0;this.WUi=()=>{if(this.qk&&this.VGa){const Sa=new vg.a(Od.a.Z2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,Sa,{["SourceControlId"]:this.VGa},null);n.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.LGj=(Sa,Hb)=>{Sa=null;if(Hb)if(Sa=Hb,this.qk=Sa.qk,(this.Vo=Sa.Vo)&&this.Vo.uW&&
this.Vo.uW.ot&&(this.$Ga=this.Vo.uW.ot.ma(0)),this.$Ga&&this.$Ga.id)if(this.$Ga.isOfficeTab)if(Hb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Sa=this.qk.solutionId,Sa in Hb?this.VGa=Hb[Sa]:(Hb=Sg.GetPrivacyCompliantId(this.qk),n.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Hb}`),this.VGa=this.jOh(this.Vo)),this.VGa)if(yh.a.contains(this.$Ga.id,Hd.a.WW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(qf.a.K4a(this.Vo),
()=>{this.dag(this.yjd(this.VGa))});else{if(Hb=this.$.Ka)Hb.pte(this.hKf),n.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else n.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Hb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:ta.a.Aj(Hb)})),this.r6();else this.fag(this.yjd(this.$Ga.id),0);else n.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Hb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(Hb)})),this.r6();
else this.r6()};this.hKf=()=>{if(yh.a.contains(this.$Ga.id,appChrome.selectors.getSelectedTabId(),!0)){var Sa=this.$.Ka;Sa&&Sa.CXf(this.hKf);this.dag(this.yjd(this.VGa))}};this.YUi=()=>{var Sa={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Sg.TVa(this.aD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(Sa)}));this.r6();let Hb=
{};Hb[Rg.a.ng]=this.aD;Sa={};Sa.solutionId=this.aD.solutionId;Sa.assetId=this.aD.assetId;Sa.assetStoreId=this.aD.assetStoreId;Sa.height=0!=this.aD.height?this.aD.height:600;Sa.storeId=this.aD.storeId;Sa.storeType=this.aD.storeType;Sa.targetType=this.aD.targetType;Sa.width=0!=this.aD.width?this.aD.width:600;Sa.displayName=this.aD.displayName;Sa.version=this.aD.version;Sa.isAddinCommands=!1;Hb[qd.a.ysa]=Sa;let hc=new vg.a(-741808261,0,0,2,null);Yf.TaskExtensions.za(sg.GetServiceTaskFactory.Na(this.$.da,
374,375,1),wc=>{wc=wc.result;null!=wc&&wc.insertAgave(Hb,hc)},this.$.ka,3)};this.EOi=()=>{let Sa={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Sg.TVa(this.aD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(Sa)}));this.r6()};this.ZPi=()=>{let Sa={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Sg.TVa(this.aD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(Sa)}));this.r6()};this.yO=Sa=>{n.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${Sa?Sa.httpStatus:-1}`)};this.$=O.$;this.addinUICommandHandler=O;this.appName=Kd.AFrameworkApplication.fa.Xa("WebAppShortName")||"Excel";this.OPg=Kd.AFrameworkApplication.fa.ud("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}static TVa(O){return Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,O.storeType,O.assetId,null,null,O.storeId)}Afj(O){this.aD=O;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.YUi,!0),window.addEventListener("DismissCallout",this.ZPi,!0),window.addEventListener("CloseCallout",this.EOi,!0))}yjd(O){return"[id="+O+"]"}fag(O,
Sa){Sa>this.OPg?(window.clearTimeout(this.EVf),this.eag("[data-unique-id='pivotOverflowButton']"),n.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+O)?this.eag(O):this.EVf=window.setTimeout(()=>{this.fag(O,Sa+1)},1E3)}dag(O){var Sa=document.querySelector("button[data-unique-id='RightPaddle']");if(Sa)O={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}));else if(Sa=document.querySelector("button"+O),!Sa||"none"===window.getComputedStyle(Sa).display)if(Sa=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Sa){Sa={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(Sa)}));n.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.r6();return}this.Bgg(Sa,"ShowTeachingUIForAddinButton")}eag(O){O=document.querySelector("button"+O);if(!O&&(O=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!O)){O={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}));n.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.r6();return}this.Bgg(O,"ShowTeachingUIForAddinTab")}Bgg(O,Sa){O.setAttribute("lpp-id","latestAddin");const Hb=Hc.a.instance.Rb("Common.ISystemInitiatedFeedback");Hb&&O?(Hb.execute(hc=>{hc.logActivity(Sa,null)}),O={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)})),n.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(n.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),O={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Sg.GetPrivacyCompliantId(this.qk),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)})),this.r6())}jOh(O){if(!O)return null;O=O.uW;if((null===O||void 0===O?0:O.ot)&&0<O.ot.count)for(let Sa of O.ot)if(Sa.groups&&0<Sa.groups.length)for(const Hb of Sa.groups)if(Hb.controls&&0<Hb.controls.length)for(const hc of Hb.controls){if(hc.attributes&&
0===hc.controlType&&hc.enabled)return hc.id;if(hc.menuItems)for(const wc of hc.menuItems)if(wc.attributes&&wc.enabled)return hc.id}return null}dJj(){var O=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(O&&"none"!==window.getComputedStyle(O).display)n.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{O=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==O){O={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Sg.TVa(this.aD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)}));n.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.r6();return}n.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const Sa=Hc.a.instance.Rb("Common.ISystemInitiatedFeedback");null==
Sa||null==O?(O={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Sg.TVa(this.aD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)})),n.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.r6()):(Sa.execute(Hb=>{Hb.logActivity("ShowTeachingUIForContentAddin",null)}),O={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Sg.TVa(this.aD),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj(O)})),n.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}XAa(O){const Sa={},Hb={};Hb.LastTeachingUIShowTime=(new Date).toUTCString();Hb.AddinHasShown=O;Sa[this.appName]=wf.c(Hb);this.lpb=new $f(this.appName,null,null,
this.yO),this.lpb.X3a(Sa),n.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}r6(){if(!this.hea){const O=window.g_roamingAddinList;O&&(this.XAa(O),this.hea=!0)}}}Object(d.a)(Sg,"AddinTeachingCalloutHandler",null,[]);var $h=a(1236),Qi=a(423),Uh=a(11),oi=a(184),Vh=a(43),Cg=a(21),mh=a(55);class ai{constructor(O,Sa,Hb,hc,wc,ad,kd=null){this.disposed=!1;this.mNi=(od,Dd)=>{if(Dd)if(Dd)if(od=Dd.qk){if(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CheckIsDeepLinkTemplateFile",
!1)&&(ng()||Xg())){const Se=this.$.ea.workbookContext.WebExtensions;if(Se){let Ue=!1;for(var Pd of Se)if(Pd.PrimaryMarketplace.SolutionId.toLowerCase()===od.solutionId.toLowerCase()){Ue=!0;break}if(!Ue){n.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{n.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Dd=Dd.Vo;Pd=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(od.solutionId in Pd)Dd=
Pd[od.solutionId];else if(Dd=this.$Rh(Dd),void 0===Dd||null===Dd){n.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Pd=new vg.a(Od.a.Z2,0,0,2,null);this.executeCommand(0,Pd,{["SourceControlId"]:Dd},null);od.isAutoLaunched=!0}else n.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else n.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else n.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.ygf=(od,Dd)=>{"Insert"==
Dd.tabName&&(od=this.$.Ka,null!=od&&(od.CXf(this.ygf),n.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.FPb.dJj())};this.XUi=(od,Dd)=>{od=null;Dd&&(od=Dd);(null===od||void 0===od?0:od.Vo)&&this.Qzj(od.Vo);this.$.af();A.EwaSettings.oa(86)&&od&&od.qk&&this.dVg(od.qk)};this.$=O;n.ULS.shipAssertTag(537170659,0,!(void 0===Sa||null===Sa),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Vh.a.T3()}`);this.Xd=Sa;this.jHe=Hb;this.o1b=hc;this.xha=
wc;this.jpb=ad;this.gp=new Lg.a;this.wha=new gd;this.Wcd=kd;rd.a.zzb=rd.a.ZWe;this.Z8c=new m.a;this.U2a=new m.a}dispose(){void 0!==this.jpb&&null!==this.jpb&&(this.jpb.dispose(),this.jpb=null);this.Xd=this.$=null;this.disposed=!0}$Dj(O,Sa){switch(O){case Od.a.Z2:O=this.KDj(Sa);break;default:O=!1}return O}nc(){return!1}executeCommand(O,Sa,Hb){O=Yf.TaskExtensions.Vj();Sa=Sa.command;switch(Sa){case 843847158:break;case -2025863019:Tb.a.PVd(Hb[qd.a.PYc].toString(),()=>{Cg.h(this.$).focus()});break;case -1777565636:$h.a.showUILessDialog(Hb[qd.a.kpb].toString());
this.Xd.ZGj(Hb[qd.a.kpb].toString());break;case 1592314317:$h.a.hideUILessDialog(Hb[qd.a.kpb].toString());this.Xd.Nbi(Hb[qd.a.kpb].toString());break;case Od.a.Z2:O=this.yld(Hb);break;case Od.a.ADb:this.BDb(Hb);break;case Od.a.Hna:this.Hna(Hb);break;case Od.a.QVd:this.jpb.RAc();break;case Od.a.refreshAddinCommands:this.tdj();break;case 1949669462:this.xha.c5f(!0);break;case -1014260128:O=this.executeDynamicAddInCommandsAPI(Hb);break;case Od.a.Bgb:this.Bgb();break;default:O=oi.a(Sa)}return O}yc(O,Sa){O=
!1;switch(Sa.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Od.a.Hna:case Od.a.QVd:case Od.a.refreshAddinCommands:case 1949669462:case Od.a.ADb:case -1014260128:case Od.a.Bgb:O=!0;break;case Od.a.Z2:O=!Kd.AFrameworkApplication.protectedFile}return O}Lc(){return!1}$Rh(O){if(!O)return n.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((O=O.uW)&&O.ot&&0<O.ot.count)for(let Sa of O.ot){if(Sa.groups&&1===Sa.groups.length){O=Sa.groups[0];if(O.controls&&
1===O.controls.length){const Hb=O.controls[0];if(Hb.attributes&&!Hb.controlType&&Hb.enabled)return Hb.id}O.controls&&n.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Sa.groups&&n.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}tdj(){if(this.xha.rxd()){this.xha.JDe();var O=this.jgd();if(O&&0<O.count)for(let Sa of O)O={[qd.a.f3]:Sa,[qd.a.GM]:4,[qd.a.YGa]:(new Date).getTime()},this.Hna(O)}}Hna(O){n.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${O[qd.a.GM]}, DataProvider ${O[qd.a.f3]}.`);
this.xha.awj();window.setTimeout(()=>{if(void 0===this.Xd||null===this.Xd)n.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Vh.a.T3()}`);else{const Sa=new of(new ma(this.Xd.Ph),yb.instance,Md.instance);Sa.MLg((Hb,hc)=>{this.BDb(hc.properties)});Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&Sa.fPg((Hb,hc)=>{null==hc?be.a.sendTelemetryEvent(Object(jd.a)(new Of.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ta.a.Aj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):(this.FPb=new Sg(this),this.FPb.Afj(hc),Hb=this.$.Ka,null!=Hb&&(Hb.pte(this.ygf),n.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Sa.zVj(O)}},0)}Bgb(){if(this.mli)if(void 0===this.Xd||null===this.Xd)n.ULS.sendTraceTag(509686154,220,10,"DdaFacadeService should not be null");
else{const O=new ie(this.Xd.Ph);O.GNg(()=>{this.jyi()});O.A0d()}}get mli(){return!A.EwaSettings.oa(182)&&this.$.ea.Mg.get(27)&&this.$.ZY}jyi(){if(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)){const O=document.getElementById("InsertAddInFlyout");null==O||void 0===O?n.ULS.sendTraceTag(509677591,220,10,"Cannot find flyout button on ribbon"):
(O.click(),n.ULS.sendTraceTag(509677590,220,50,"Launch flyout"))}else n.ULS.sendTraceTag(509677589,220,50,"Launch insertDialog"),Yf.TaskExtensions.za(sg.GetServiceTaskFactory.Na(this.$.da,374,375,1),O=>{O=O.result;null!=O&&O.Ebg("TeachingCallout",null)},this.$.ka,3)}BDb(O){if(!this.disposed){n.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${O[qd.a.GM]}.`);try{if(A.EwaSettings.oa(182)){const Hb=O[qd.a.gpb];if(Hb&&0<Hb.count){const hc=Hb.count;for(let wc=hc-1;0<=wc;wc--){const ad=Hb.ma(wc);
OSF.OsfControl.isFirstPartyStoreString(ad.storeType)||Hb.remove(Hb.ma(wc))}if(Hb.count<hc){const wc=sg.GetServiceTaskFactory.Na(this.$.da,5,4,0);Yf.TaskExtensions.za(wc,()=>{wc.result.mh(36,null)},this.$.ka,3)}if(!Hb.count)return}}if(void 0===this.Xd||null===this.Xd)n.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Vh.a.T3()}`);else{var Sa=null;Sa=Kd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new Pb(this.gp,this.jHe,
new ma(this.Xd.Ph),new hg(this.$.Eb,Od.a.Z2),this.xha,yb.instance,this.wha,(Hb,hc)=>{const wc={};wc.InstanceId=wa.a.create().toString();wc.PrimaryMarketplace={};wc.PrimaryMarketplace.SolutionId=Hb.solutionId;wc.PrimaryMarketplace.SolutionVersion=Hb.version;wc.PrimaryMarketplace.MarketplaceType=Hb.storeType;wc.PrimaryMarketplace.MarketplaceRef=Hb.storeId;wc.WebExtensionType=1;this.Xd.jJj(wc,()=>{hc(Hb)})}):new Pb(this.gp,this.jHe,new ma(this.Xd.Ph),new hg(this.$.Eb,Od.a.Z2),this.xha,yb.instance,this.wha);
Sa.ULg(this.mNi);Sa.NLg(this.XUi);if(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){const Hb=new Sg(this);Sa.FNg(Hb.WUi);Sa.ePg(Hb.LGj)}this.$.da.Aa(53).Qn&&kc.a.get_instance().Zj(5,null).continueWith(()=>{this.disposed||Sa.tyi(this.Wcd,this.$.domElement,O)})}}catch(Hb){n.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Hb.message}.`)}}}yld(O){const Sa=Yf.TaskExtensions.Vj();O=O[this.gp.Aia];const Hb=
this.o1b.xWc(O),hc=new $h.a(this.$,this.Xd,Hb.ownerAddinInfo,Sa);return this.W$e(Sa,O,Hb,hc)}W$e(O,Sa,Hb,hc){this.o1b.yld(Sa,this.xha,hc,new ma(this.Xd.Ph),Hb,()=>{O=hc.y9g()},()=>{Cg.h(this.$).focus()});return O}dVg(O){const Sa=Yf.TaskExtensions.Vj();var Hb=this.Xd.Saa(O.solutionId);if(Hb){var hc=this.Xd.XZ(Hb);if(Uh.HelperMethods.Jw(hc)&&0!==hc.SharedRuntime.State)return}hc=this.o1b.eVg;const wc=O.solutionId in hc?hc[O.solutionId]:null;if(wc){const ad=this.o1b.xWc(wc),kd=new $h.a(this.$,this.Xd,
ad.ownerAddinInfo,Sa),od=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.solutionId,null!==ad.ownerAddinInfo?ad.ownerAddinInfo.storeType:O.storeType,O.assetId,null,null,O.storeId);hc=Dd=>{if(Dd){const Pd={};for(const Se of Dd)Pd[Se[0]]=Se[1];(Dd=qd.a.xte in Pd?Pd[qd.a.xte]:null)&&"true"===Dd.toLowerCase()&&(n.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${O.storeType}, StoreId ${O.storeId}, SolutionId ${od}.`),this.W$e(Sa,wc,ad,kd))}};n.ULS.sendTraceTag(537170651,
220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${O.storeType}, StoreId ${O.storeId}, SolutionId ${od}.`);if(Hb)hc(this.Xd.XZ(Hb).OsfPropertyBag);else if(Hb=this.$.ea.workbookContext.WebExtensions)for(const Dd of Hb)if((1===Dd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===O.targetType&&Dd.PrimaryMarketplace.MarketplaceType.toLowerCase()===O.storeType.toLowerCase()&&Dd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===O.storeId.toLowerCase()&&Dd.PrimaryMarketplace.SolutionId.toLowerCase()===
O.solutionId.toLowerCase()){hc(Dd.OsfPropertyBag);break}}}rZd(O,Sa,Hb=!1){O&&(!Hb||Sa||this.Z8c.contains(O)||this.Z8c.add(O),(Hb=this.U2a.contains(O))&&Sa&&this.U2a.remove(O),Hb||Sa||this.U2a.add(O))}Qzj(O){if((O=O.uW)&&O.ot)for(let Sa of O.ot)if(Sa.groups)for(const Hb of Sa.groups)if(Hb.controls)for(const hc of Hb.controls)if(this.rZd(hc.id,hc.enabled,!0),1===hc.controlType&&hc.menuItems)for(const wc of hc.menuItems)this.rZd(wc.id,wc.enabled,!0)}jgd(){const O=new m.a;A.EwaSettings.oa(52)&&(this.$.ea.Mg.get(27)&&
(O.add(0),O.add(16)),this.$.ea.Mg.get(33)&&O.add(1),O.add(8));return O}executeDynamicAddInCommandsAPI(O){let Sa=!0;if(void 0===O||null===O||void 0===O[qd.a.Jub]||null===O[qd.a.Jub])return mh.Task.Ra(!1);switch(O[qd.a.Jub]){case 1:Sa=this.IYj(O);break;case 2:Sa=this.Uzj(O);break;case 4:this.U2a.clear();this.U2a.addRange(this.Z8c);break;case 3:Sa=this.installContextualTab(O);break;default:Sa=!1}return mh.Task.Ra(Sa)}KDj(O){return O&&this.gp.Aia in O?(O=O[this.gp.Aia])?this.U2a.contains(O):!1:!1}IYj(O){var Sa=
null;let Hb=null,hc=null,wc=!0;void 0!==O[qd.a.l4]&&null!==O[qd.a.l4]&&void 0!==O[this.gp.Aia]&&null!==O[this.gp.Aia]&&void 0!==O[qd.a.k4]&&null!==O[qd.a.k4]&&(Sa=O[qd.a.l4],Hb=O[qd.a.M9b],hc=O[this.gp.Aia],wc=O[qd.a.k4]);if(!Sa||!hc)return n.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;O=(new ue.a(this.$.Eb,Sa,this.gp,!0)).kLa(hc);Sa={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Sa.AssetId=Hb;Sa.MaskedTabId=O;Sa.IsToEnable=wc;
n.ULS.sendTraceTag(537170648,220,50,x.a.fc(Sa));this.rZd(O,wc);Qi.a.GJ.updateCommandUI();return!0}Uzj(O){var Sa,Hb,hc=null,wc=null;let ad=null;var kd=null;let od=!0;void 0!==O[qd.a.z$c]&&null!==O[qd.a.z$c]&&void 0!==O[qd.a.l4]&&null!==O[qd.a.l4]&&void 0!==O[this.gp.Aia]&&null!==O[this.gp.Aia]&&void 0!==O[qd.a.k4]&&null!==O[qd.a.k4]&&(hc=O[qd.a.z$c],wc=O[qd.a.l4],ad=O[qd.a.M9b],kd=O[this.gp.Aia],od=O[qd.a.k4]);if(!hc||!wc||!kd)return n.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),
!1;O=(new ue.a(this.$.Eb,wc,this.gp,!0)).h9e(kd);kd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};kd.StoreType=hc;kd.AssetId=ad;kd.MaskedTabId=O;kd.IsToShow=od;n.ULS.sendTraceTag(537170646,220,15,x.a.fc(kd));hc=this.xha.xja(hc,wc,1);wc=!1;if(null===(Hb=null===(Sa=null===hc||void 0===hc?void 0:hc.Vo)||void 0===Sa?void 0:Sa.uW)||void 0===Hb?0:Hb.ot)for(let Dd of hc.Vo.uW.ot)if(Dd.id===O){wc=!0;break}if(!wc)return n.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),
!1;Sa=[];od?appChrome.selectors.getSelectedTabId()!==O&&Sa.push(appChrome.actions.activateRibbonTab(O)):(appChrome.selectors.getSelectedTabId()===O&&Sa.push(appChrome.actions.setCurrentTab(Hd.a.WW)),Sa.push(appChrome.actions.deactivateRibbonTab(O)));appChrome.api.dispatch(Sa);return!0}installContextualTab(O){let Sa=null,Hb=null,hc=null;var wc=null;if(void 0!==O[qd.a.l4]&&null!==O[qd.a.l4]&&void 0!==O[qd.a.k4]&&null!==O[qd.a.k4]){const ad=O[qd.a.k4];Sa=O[qd.a.l4];void 0!==ad[qd.a.NJa]&&null!==ad[qd.a.NJa]&&
void 0!==ad[qd.a.OJa]&&null!==ad[qd.a.OJa]&&(Hb=ad[qd.a.NJa],hc=ad[qd.a.OJa],wc=ad[qd.a.A$c])}if(!(Sa&&hc&&Hb&&wc))return n.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;O=this.xha.xja(wc.PrimaryMarketplace.MarketplaceType,wc.PrimaryMarketplace.SolutionId,1);if(null===O||void 0===O?0:O.Vo)return n.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;O={};O.solutionId=wc.PrimaryMarketplace.SolutionId;O.version=wc.PrimaryMarketplace.SolutionVersion;
O.storeType=wc.PrimaryMarketplace.MarketplaceType;O.storeId=wc.PrimaryMarketplace.MarketplaceRef;A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?wc.AssetMarketplace?(O.assetId=wc.AssetMarketplace.SolutionId,O.assetStoreId=wc.AssetMarketplace.MarketplaceRef):(O.assetId=null,O.assetStoreId=null):(O.assetId=wc.PrimaryMarketplace.SolutionId,O.assetStoreId=wc.PrimaryMarketplace.MarketplaceRef);O.targetType=wc.WebExtensionOsfControlType;O.width=wc.TaskpaneWidth;O.height=
0;O.isAddinCommands=!0;wc=new m.a;wc.add(O);O={};O[qd.a.gpb]=wc;O[qd.a.GM]=6;O[qd.a.NJa]=Hb;O[qd.a.OJa]=hc;this.BDb(O);return!0}}Object(d.a)(ai,"AddinUICommandHandler",null,[221,219,3]);var pi=a(62),Ri=a(602),Si=a(18),Kh=a(16);class $g extends Bd.a{constructor(O){super(O);this.handler=null;this.vHg=()=>{n.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.qd&16384)}]`);const Sa=new dd.a;this.$.da.fb(53,Pd=>{n.ULS.sendTraceTag(38410435,
0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");Sa.setResult(Pd)});const Hb=Sa.task,hc=new Cd,wc=ce.a.getInstance(),ad=new Ic(this.$,wc),kd=sg.GetServiceTaskFactory.create(this.$.da,203,this.ka,this.Ya),od=this.cej(hc),Dd=sg.GetServiceTaskFactory.Na(this.$.da,349,350,this.Ya);return Yf.TaskExtensions.za(Yf.TaskExtensions.Ed([Hb,kd,od,Dd],this.ka),()=>{n.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
Yf.TaskExtensions.za(sg.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Ya),Pd=>{this.handler=new ai(this.$,Pd.result,hc,new rc,wc,ad,Hc.a.instance.yg("Common.IExternalUICommandDefinitionMapping"));n.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Zc([this.handler]);this.$.da.Ga(198,this.handler)},this.ka,3)},this.ka,3)};this.Sjh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ka.Rcb(this.handler),this.$.da.QU(198),this.handler=
null):n.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.QU(204);Kh.a(Si.a,20,this.$.da,198)}}ld(){n.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");pi.a(this.$).add(Object(jd.a)(new Ri.a,{$zc:()=>{const O=this.$.ea.gI&&this.$.ea.Zb&&!!(this.$.qd&16384)&&this.$.isEditMode;this.$.ea.Zb&&n.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${O}] IsSessionFullyLoaded [${this.$.ea.gI}] IsSessionActive [${this.$.ea.Zb}] ShowCommandUI [${!!(this.$.qd&
16384)}] IsEditMode [${this.$.isEditMode}]`);return O},A_b:this.vHg,c8b:this.Sjh,c4a:2}))}cej(O){const Sa=sg.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya);return Yf.TaskExtensions.za(Sa,()=>{n.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new Le(Sa.result,O))},this.ka,3)}static la(O){Bd.a.Nd(199,new $g(O))}}Object(d.a)($g,"AddinUICommandHandlerFactory",Bd.a,[]);var qi=a(1194),
ri=a(1197),vh=a(698);class bi extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){let O;if(A.EwaSettings.oa(376)){const Sa=sg.GetServiceTaskFactory.create(this.$.da,106,this.$.ka,this.Ya),Hb=sg.GetServiceTaskFactory.create(this.$.da,396,this.$.ka,this.Ya);Yf.TaskExtensions.za(mh.Task.jJ(Sa,Hb),()=>{this.ob(Object(vh.a)(this.$.da,278,()=>new qi.CustomFunctionsInstaller(this.$,Sa.result,Hb.result)))},this.$.ka,3)}else O=Object(vh.a)(this.$.da,278,()=>new ri.CustomFunctionsLegacyInstaller(this.$)),
this.ob(O)}static la(O){O.da.Ga(279,new bi(O))}}Object(d.a)(bi,"CustomFunctionsInstallerFactory",h.a,[]);var nh=a(89),Hi=a(47),si=a(46);class Xc{constructor(O,Sa){this.hRa=this.iRa=null;this.Egg=(Hb,hc)=>{let wc=null,ad=null,kd=null;hc?(Object(aa.a)(276,hc)?(wc=hc.eHa,kd=hc.instanceId):Object(aa.a)(301,hc)&&(wc=hc.get_element(),kd=hc.instanceId),wc)?(ad=Object(U.a)(302,Hb),ad)?this.gTf(kd,wc,ad)||kd in this.hRa||(this.iRa[kd]=0,this.hRa[kd]=Hi.a.instance.dD(()=>{10<=this.iRa[kd]||this.gTf(kd,wc,ad)?
(delete this.iRa[kd],this.hRa[kd].dispose(),delete this.hRa[kd]):this.iRa[kd]+=1},500,si.a.zQg,!0,!1)):n.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):n.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):n.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=O;this.$=Sa;this.E_c=!1;this.$.da.Ga(224,this)}la(O){this.E_c?n.ULS.sendTraceTag(537170629,0,
10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.E_c=!0,this.hRa={},this.iRa={},O?O.yMg(this.Egg):n.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(O){if(O){O.mij(this.Egg);O=this.hRa;for(let Sa in O)nh.a.Ia(O[Sa]);this.iRa=this.hRa=null;this.E_c=!1}else n.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}gTf(O,Sa,Hb){if(this.Rki(Hb,O))return!1;
O=Sa.querySelector("iframe");if(!O)return n.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;O=O.title;if(!O||!O.length)return n.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(O);return!0}Rki(O,Sa){return(O=O.Ph.getOsfControl(Sa))?O.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(d.a)(Xc,"AgaveOnSelectedReadoutHandler",null,[303]);
class Fd extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){const O=this.$.da;Yf.TaskExtensions.za(sg.GetServiceTaskFactory.Na(O,211,212,this.Ya),Sa=>{Sa=O.Aa(224)||new Xc(Sa.result,this.$);this.ob(Sa)},this.ka,3)}static la(O){O.da.Ga(225,new Fd(O))}}Object(d.a)(Fd,"AgaveOnSelectedReadoutHandlerFactory",h.a,[]);var ig=a(737),ti=a(52);const ci=(O,Sa)=>ti.a.nxd(65,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,Kd.AFrameworkApplication.fa.ud("MaxRetriesForLoadingScript",
0),O,Sa);var Ii=a(241);class ui{constructor(O,Sa,Hb){this.iframe=O;this.onSuccess=Sa;this.onError=Hb;$addHandler(window,"message",Object(Vd.a)(this,this.fbf,"handleResponse"))}fbf(O){try{if(O&&O.rawEvent&&O.rawEvent.origin&&this.iframe&&this.iframe.id){var Sa=this.MMf(O.rawEvent.origin);const Hb=this.MMf(document.domain);if(P.a.ak().equals(Hb,Sa))if(O.rawEvent.source&&O.rawEvent.source.frameElement&&O.rawEvent.source.frameElement.id&&P.a.ak().equals(O.rawEvent.source.frameElement.id,this.iframe.id)){Sa=
null;try{Sa=JSON.parse(O.rawEvent.data)}catch(hc){n.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",hc.message)}Sa?(Sa.statusCode!==Ii.a.wP||void 0!==Sa.error&&Sa.error?(n.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Sa.statusCode,Sa.error),this.onError()):(n.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.onSuccess(Sa.authorizationCode?Sa.authorizationCode:Sa.signInUrl)),$removeHandler(window,"message",Object(Vd.a)(this,this.fbf,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):n.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):n.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):n.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else n.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else n.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else n.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Hb){n.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Hb.message)}}MMf(O){let Sa=
"";try{O&&(Sa=-1<O.indexOf("//")?O.split("/")[2]:O.split("/")[0])&&(Sa=Sa.split(":")[0],Sa=Sa.split("?")[0])}catch(Hb){n.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Hb.message)}return Sa}static la(O,Sa,Hb){new ui(O,Sa,Hb)}}Object(d.a)(ui,"ResponseHandler",null,[]);var Wh=a(253);class wh{constructor(O){this.pGa=O}tryAuthenticate(O,Sa){this.Abb(wh.kyg,()=>{O()},Sa)}tryAuthorize(O,Sa){this.Abb(wh.qtg,O,Sa)}getSignInUrl(O,Sa){this.Abb(wh.Nle,O,Sa)}signOut(O,Sa){this.Abb(wh.jEg,
O,Sa)}Abb(O,Sa,Hb){var hc=new Wh.QueryStringBuilder("AuthenticationProxyHandler.aspx");hc.oj("responseType",O);Kd.AFrameworkApplication.MZa(hc);hc=String.format("{0}{1}&{2}",this.pGa,hc.toString(),Kd.AFrameworkApplication.Hi);const wc=document.createElement("iframe");wc.setAttribute("id","privateCatalogIframe");wc.setAttribute("name","privateCatalogIframe");wc.setAttribute("style","display: none");P.a.ak().equals(O,wh.Nle)||wc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");
ui.la(wc,Sa,Hb);wc.setAttribute("src",hc);document.body.appendChild(wc)}}wh.qtg="authcode";wh.kyg="identitytoken";wh.Nle="signinurl";wh.jEg="signout";Object(d.a)(wh,"AuthenticationProxy",null,[]);class pg{}pg.getUserId="getUserId";pg.getLastStoreUpdate="laststoreupdate";pg.getEntitlement="getEntitlements";pg.getEToken="getEToken";pg.getManifest="getManifest";pg.getAppState="getAppState";pg.getKilledApps="getRemovedAddins";pg.getAppDetails="getAppDetails";pg.removeApps="removeAddin";pg.getLastPrivateCatalogUpdate=
"getLastPrivateCatalogUpdate";pg.getPrivateCatalogAddIns="getAddIns";pg.getPrivateCatalogManifests="getAppManifests";pg.isStoreDisabled="isStoreDisabled";Object(d.a)(pg,"S2SWebRequestActions",null,[]);var Hh=a(576);class Lh{getUserId(O,Sa){const Hb=new m.a;Hb.add(new Jd.a("corr",O));this.sX(pg.getUserId,Hb,1,Sa)}getLastStoreUpdate(O,Sa,Hb){const hc=new m.a;hc.add(new Jd.a("lc",O));hc.add(new Jd.a("corr",Sa));this.sX(pg.getLastStoreUpdate,hc,1,Hb)}getEntitlement(O,Sa,Hb,hc){O=new m.a;O.add(new Jd.a("av",
Sa));O.add(new Jd.a("corr",Hb));this.sX(pg.getEntitlement,O,1,hc)}getEToken(O,Sa,Hb,hc,wc,ad){const kd=new m.a;kd.add(new Jd.a("cmu",O));kd.add(new Jd.a("cmf",Sa));kd.add(new Jd.a("assetid",Hb));kd.add(new Jd.a("expver",hc));kd.add(new Jd.a("corr",wc));this.sX(pg.getEToken,kd,1,ad)}getManifest(O,Sa,Hb,hc){const wc=new m.a;wc.add(new Jd.a("cmu",O));wc.add(new Jd.a("assetid",Sa));wc.add(new Jd.a("corr",Hb));this.sX(pg.getManifest,wc,1,hc)}getAppState(O,Sa,Hb){const hc=new m.a;hc.add(new Jd.a("ma",O));
hc.add(new Jd.a("corr",Sa));this.sX(pg.getAppState,hc,1,Hb)}getKilledApps(O,Sa){const Hb=new m.a;Hb.add(new Jd.a("corr",O));this.sX(pg.getKilledApps,Hb,1,Sa)}getAppDetails(O,Sa,Hb,hc){const wc=new m.a;wc.add(new Jd.a("cmo",O));wc.add(new Jd.a("corr",Hb));this.sendWithBody(pg.getAppDetails,wc,Sa,2,hc,!1)}removeApps(O,Sa,Hb){const hc=new m.a;hc.add(new Jd.a("corr",Sa));this.sendWithBody(pg.removeApps,hc,O,2,Hb,!1)}getLastPrivateCatalogUpdate(O,Sa,Hb,hc,wc,ad){const kd=new m.a;kd.add(new Jd.a("catalog",
"privatecatalog"));kd.add(new Jd.a("clientCode",O));kd.add(new Jd.a("clientVersion",Sa));kd.add(new Jd.a("corr",wc));O=String.format("authorizationCode={0}&refreshToken={1}",Hb?Sf.a.lf(Hb):"",hc?Sf.a.lf(hc):"");this.sendWithBody(pg.getLastPrivateCatalogUpdate,kd,O,2,ad,!0)}getPrivateCatalogAddIns(O,Sa,Hb,hc,wc,ad){const kd=new m.a;kd.add(new Jd.a("catalog","privatecatalog"));kd.add(new Jd.a("clientCode",O));kd.add(new Jd.a("clientVersion",Sa));kd.add(new Jd.a("corr",wc));O=String.format("authorizationCode={0}&refreshToken={1}",
Hb?Sf.a.lf(Hb):"",hc?Sf.a.lf(hc):"");this.sendWithBody(pg.getPrivateCatalogAddIns,kd,O,2,ad,!0)}getPrivateCatalogManifests(O,Sa,Hb,hc,wc){const ad=new m.a;ad.add(new Jd.a("catalog","privatecatalog"));ad.add(new Jd.a("corr",hc));O=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Sf.a.lf(O),Sa?Sf.a.lf(Sa):"",Hb?Sf.a.lf(Hb):"");this.sendWithBody(pg.getPrivateCatalogManifests,ad,O,2,wc,!0)}isStoreDisabled(O,Sa){const Hb=new m.a;Hb.add(new Jd.a("corr",O));this.sX(pg.isStoreDisabled,
Hb,2,Sa)}sX(O,Sa,Hb,hc){this.sendWithBody(O,Sa,null,Hb,hc,!1)}sendWithBody(O,Sa,Hb,hc,wc,ad){const kd=new Wh.QueryStringBuilder("AddinServiceHandler.ashx");kd.oj("action",O);kd.oj("app",Hh.a[Kd.AFrameworkApplication.ta.Pa.Ij]);for(let od of Sa)kd.oj(od.key,od.value);Sa=String.format("{0}{1}&{2}",Kd.AFrameworkApplication.ta.Pa.m0,kd.toString(),Kd.AFrameworkApplication.Hi);Kd.AFrameworkApplication.zd.Om(Sa,hc,Hb,null,!1,2,od=>{let Dd=null,Pd=null;od&&od.data&&(od.data.responseHeaders["X-BlockedForMinor"]&&
"1"===od.data.responseHeaders["X-BlockedForMinor"].toString()&&(od.data.httpStatus=451),Dd=od.data.fe,Pd=od.data.responseHeaders);wc(od.data.httpStatus,Dd,Pd)},od=>{var Dd=null;let Pd=null;ad&&od&&od.data&&od.data.fe&&(Dd=od.data.fe,Pd=od.data.responseHeaders);wc(od.data.httpStatus,Dd,Pd);if(Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Dd={message:"AddinServiceHandler request failed"};Dd.code=od.data.httpStatus;Dd.action=O;
if(od.data.request||od.data.request.get_headers())Dd["X-UserSessionId"]=od.data.request.get_headers()["X-UserSessionId"];408===od.data.httpStatus||503===od.data.httpStatus?n.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Dd)):n.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Dd))}else n.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",od.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+O,void 0,void 0,void 0,["X-UserKey"])}}Object(d.a)(Lh,"S2SWebRequestManager",
null,[]);class vi extends h.a{constructor(O){super();this.fTf=this.ddaFacade=null;this.$=O;O.da.Ga(106,this);this.Fb()}get Xd(){return this.ddaFacade||(this.ddaFacade=new ig.DdaFacade(this.$,this.fTf))}create(){n.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Kd.AFrameworkApplication.disableWholeAppsForOfficeFeature?n.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Kd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
A.EwaSettings.oa(380)?Hc.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(O=>{O.isFeatureEnabled("mso_officeStore",!0).then(Sa=>{ig.DdaFacade.i6b=Sa;this.pJe();return null})}):this.pJe()}pJe(){const O=sg.GetServiceTaskFactory.Na(this.$.da,224,225,this.Ya),Sa=ti.a.nxd(64,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.ka,this.Ya,106),Hb=ci(this.ka,this.Ya);Yf.TaskExtensions.za(Yf.TaskExtensions.Ed([O,Sa,Hb],this.$.ka),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?n.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Vh.a.T3()}`):this.pfi();n.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.fTf=O.result;this.ob(this.Xd);n.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ka,3)}pfi(){A.EwaSettings.oa(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Lh);
this.$.me.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Lh,new wh(Kd.AFrameworkApplication.fa.appSettings.WebServiceBase),A.EwaSettings.oa(70),A.EwaSettings.oa(403));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Lh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Lh)}dispose(){nh.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(O){new vi(O)}}Object(d.a)(vi,"DdaFacadeServiceFactory",
h.a,[]);var di=a(462);class Mh{constructor(O,Sa,Hb,hc,wc,ad){this.$=O;this.agaveCommandManager=ad}Lc(){return!1}nc(){return!1}yc(O,Sa,Hb,hc){let wc=!1;switch(Sa.command){case -684355545:wc=!0;break;case -741808261:wc=!!Hb;break;case -859308420:wc=!!hc&&1===hc.oz;break;case 418618014:wc=1===O&&!!hc&&1===hc.oz;break;case -515602470:Sa=A.EwaSettings.oa(230)&&2===O;wc=(1===O||Sa)&&!!hc&&1===hc.oz;break;case 2086613372:wc=A.EwaSettings.oa(230)&&2===O&&!!hc&&1===hc.oz;break;case -1336341324:wc=A.EwaSettings.oa(448)&&
1===O&&!!hc&&1===hc.oz;break;case 451940422:wc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===O&&!!hc&&1===hc.oz;break;case -1444574190:case -336193495:wc=1===O&&!!hc&&1===hc.oz;break;case 1296389134:wc=1===O&&!!hc&&1===hc.oz;break;case -1473679467:wc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===O&&!!hc&&1===hc.oz;break;case 1221897806:wc=A.EwaSettings.oa(162)&&2===O;break;case 1172793074:case 1930653487:wc=
A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===O;break;case -1753056834:wc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:wc=!0;break;case 301511274:wc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:wc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:wc=this.$.isEditMode&&
this.$.ea.FNb}return wc}executeCommand(O,Sa,Hb){let hc=Yf.TaskExtensions.Vj();const wc=Sa.command;switch(Sa.command){case -1473679467:di.a(this.$,488,489,1,ad=>{hc=ad.nii(Hb.SourceControlId,Sa)});break;case 1296389134:this.agaveCommandManager.Ebg(Hb.SourceControlId,Hb.LabelText);break;case -684355545:this.agaveCommandManager.a2c();break;case -741808261:hc=this.agaveCommandManager.insertAgave(Hb,Sa);di.a(this.$,488,489,1,ad=>{ad.YHg(Hb)});break;case -1336341324:A.EwaSettings.oa(448)&&(hc=this.agaveCommandManager.Nld(Hb,
O,Sa));break;case 1172793074:A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(hc=this.agaveCommandManager.Nld(Hb,O,Sa));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:hc=this.agaveCommandManager.Nld(Hb,O,Sa);break;default:hc=oi.a(wc)}return hc}}Object(d.a)(Mh,"AgaveCommandHandler",null,
[219]);class ei{}Object(d.a)(ei,"Selection",null,[]);var Nh=a(1305),qg=a(1304),Eh=a(1306),Tg=a(1395),zh=a(1307);class Ji{}Object(d.a)(Ji,"SmartLookupApplicationInterface",null,[]);class fi{}Object(d.a)(fi,"ApplicationProperties",null,[]);class Ah{}Object(d.a)(Ah,"EnterpriseUserInfo",null,[]);class gi{}Object(d.a)(gi,"FeatureGates",null,[]);class kf{constructor(O,Sa,Hb=!0){this.kSj=9E5;this.nSj=3E5;this.Ryd=null;this.luf="";this.Oyd=0;this.Stb=Date.now;this.Bya=O;this.g$a=Sa;Hb&&this.ggd()}j3h(){const O=
this.Stb();if(O<this.Oyd+this.kSj)return O>this.Oyd+this.nSj&&this.ggd(),this.luf;this.ggd();return""}ggd(){this.Ryd=this.Ryd||new Promise(O=>{this.k3h().then(Sa=>{this.luf=Sa;this.Oyd=this.Stb();this.Ryd=null;O(Sa)})})}k3h(){return this.g$a&&this.g$a.length?new Promise(O=>{this.Bya.YL("SmartLookup",this.g$a).then(Sa=>{Sa.IsSuccess?Sa.Token||(O(""),n.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(n.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Sa.ErrorCode+": "+Sa.ErrorMessage),O(""));O(Sa.Token)}).catch(Sa=>{Sa=wf.c(Sa);n.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Sa);O("")})}):(n.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(d.a)(kf,"SmartLookupAuthenticationManager",null,[337]);class Bh{static gUh(){switch(Object(U.a)(String,Kd.AFrameworkApplication.Qb.AudienceGroup)||""){case "Dogfood":if(Kd.AFrameworkApplication.fa){let O=
Kd.AFrameworkApplication.fa.Xa("UserPrincipalName");O=Sf.a.wl(O);const Sa=Kd.AFrameworkApplication.fa.cq("SmartLookupINTEnabledForSKITeam")?Kd.AFrameworkApplication.fa.Fw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(Sa,O)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static J2h(){switch(Kd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Kd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":Kd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?
"INT":Bh.gUh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(d.a)(Bh,"Utils",null,[]);var jh=a(557),Ig=a(171);class Jg{constructor(O){n.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Suf=Kd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.eEi=Kd.AFrameworkApplication.fa.Xa("SmartLookupApprovedOriginPattern");this.g$a=Kd.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint");this.JEi=Hg.a.sN(Kd.AFrameworkApplication.fa.Xa("AppCatalogUrl")||"");this.f$a=new gi;this.f$a.EnableAllTabV2=!0;this.f$a.EnableIntentService=!0;this.f$a.EnableInDocumentSearch=Kd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.f$a.EnableLocalSearch=Kd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.f$a.IntentServiceEndpoint=
Bh.J2h();this.EEi=new kf(O,this.g$a)}get approvedOriginPattern(){return this.eEi}MOh(){return Promise.resolve(this.NOh())}NOh(){const O=new fi;O.anid="";O.applicationVersion=Kd.AFrameworkApplication.buildVersion;O.appCorrelationId=Ig.a.create().toString();O.themePlatform=Jg.k4j;O.lcid=Kd.AFrameworkApplication.lcid;O.launchUtcTime=(new Date).toUTCString();O.featureGates=this.f$a;var Sa=jh.a.uK(Kd.AFrameworkApplication.lcid);Sa=Sa?Sa.name:null;O.market=this.Xcc(Sa);O.uiLanguage=Sa;O.sessionId=Kd.AFrameworkApplication.userSessionId;
O.themeId=0;O.parentalControl=Jg.B2i;const Hb=new Ah;Hb.CountryCode=this.Xcc(Sa);Hb.ServiceEndpoint=this.g$a;Hb.IsGoLocal=!1;Hb.IsEnabled=this.Suf;Hb.IsEnterpriseEnabled=this.Suf;Hb.TenantRoot=this.JEi;O.enterpriseUserInfo=Hb;O.accessToken=this.EEi.j3h();return O}Xcc(O){O=O.split("-");return O[O.length-1]}}Jg.k4j="web";Jg.B2i="yes";Object(d.a)(Jg,"SmartLookupManager",null,[320]);class Ch extends Fb.a{constructor(O){super();this.$=O;this.isFirstLaunch=!1}Lc(){return!1}nc(){return!1}yc(O,Sa){O=A.EwaSettings.oa(132);
return-983891024===Sa.command&&O}executeCommand(O,Sa){O=Yf.TaskExtensions.Vj();-983891024===Sa.command&&this.ayi();return O}ayi(){var O=new Jg(null);const Sa={};var Hb=Cg.h(this.$).Ub(null).originalText;Hb=Object(jd.a)(new ei,{neighborhood:Hb,mentionStart:0,mentionLength:Hb?Hb.length:0});const hc=Object(jd.a)(new Ji,{selection:Hb,entryPoint:0});O.MOh().then(ad=>{ad.applicationName=Ch.appName;ad.isFirstLaunch=this.isFirstLaunch;ad.themeId=5;Sa[Ch.smartLookupApplicationInterface]=JSON.stringify(hc);
Sa[Ch.QRg]=JSON.stringify(ad);this.isFirstLaunch=!1});O=new Nh.a("ExcelOnline","Web","en-Us");Hb=new qg.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const wc=new Eh.a;wc.optionalProperties[Tg.a.ij]=vc.a.instance.ga(1801);wc.optionalProperties[Tg.a.taskPaneWidth]=350;wc.optionalProperties[Tg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";wc.Dh=Sa;zh.a.instance.h6(Hb,"Taskpane","SmartLookupSDXTaskpane",O,wc)}}Ch.QRg="AppProperties";Ch.appName="Excel";Ch.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(d.a)(Ch,"SmartLookupCommandHandler",Fb.a,[219]);class Oh extends Bd.a{constructor(O){super(O)}ld(){di.a(this.$,374,375,this.Ya,O=>{this.Zc([new Mh(this.$,null,null,null,null,O),new Ch(this.$)])})}static la(O){Bd.a.Nd(76,new Oh(O))}}Object(d.a)(Oh,"AgaveCommandHandlerFactory",Bd.a,[]);var hi=a(1320),rh=a(106);class oh{constructor(){this.Xd=null;this.gcb=(O,Sa,Hb,hc,wc)=>{if(2===Hb){O=wc?wc:{};Sa=O.callback;Hb=O.refresh?O.refresh:!1;if(!Sa)return 16;Kd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=O.storeType?this.Xd.LQf(Sa,Hb,O.storeType):this.Xd.Fda(Sa,Hb)}return 32};this.$ej=(O,Sa,Hb,hc,wc)=>{2===Hb&&(O=wc?wc.callback:null)&&this.Xd.xMg(O);return 32};this.mii=(O,Sa,Hb,hc,wc)=>{2===Hb&&this.Xd.WEd(null,OSF.AgaveHostAction.InsertAgave,wc);return 32}}initialize(O){oh.initialized||(this.Xd=O,this.Hg(),oh.initialized=!0)}Hg(){Kd.AFrameworkApplication.ub.Me(Od.a.gcb,rh.a.frame,this.gcb,96);Kd.AFrameworkApplication.ub.Nb(Od.a.Tdj,rh.a.frame,this.$ej);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&Kd.AFrameworkApplication.ub.Me(Od.a.vgf,rh.a.frame,this.mii,96)}static get instance(){oh.Ma||(oh.Ma=new oh);return oh.Ma}}oh.Ma=null;oh.initialized=!1;Object(d.a)(oh,"AgaveCommandActor",null,[]);var gh=a(1362),wi=a(1309),Ph=a(111),xi=a(357),Ti=a(354),Ui=a(1240),Kg=a(19),Vi=a(349);class yi{constructor(){this.GZd=this.KCc=null;this.yq=0;this.ICc=null}}Object(d.a)(yi,"FirstPartyAddinTaskpaneOverrides",null,[]);class Xh{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(d.a)(Xh,"IdeasSelectionContext",null,[]);class sh extends Xh{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(d.a)(sh,"IdeasTableSelectionContext",Xh,[]);class zi{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(d.a)(zi,"AutoFilterRange",
null,[]);class Ai{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(d.a)(Ai,"IdeasAutoFilterSource",null,[]);class ii{constructor(O,Sa){this.selection=O;this.tables=Sa}}Object(d.a)(ii,"IdeasXLIMTableBoundaries",null,[]);var Ag=a(60);const Bi=(O,Sa,Hb,hc,wc,ad,kd=null)=>{kd=O.Oa(9,kd);kd.sharedInfo=Sa;return Ag.g(O,"ShowAgaveTaskpane",kd,Hb,hc,wc,ad,0)};var ah=a(860),Fh=a(66),Wi=a(131),eg=a(40),ji=a(374),Qh=a(188),Ki=a(162),Li=a(565),Kf=a(282),Ci=a(104),ki=
a(132),Dh=a(51),Ih=a(146),th=a(181);class Di extends Ih.a{constructor(){super();this.Dfa="calc(100% - 46px)";this.QDa="15px";this.Efa="0";this.KKc="WACDialogPanel";this.mY=695;this.LKc=462;this.tqa="80%";this.AIc=350;this.eib="100%";this.Tb=5;this.Ee="AppsForOfficeInsertionDialog";this.WKc=!!Kd.AFrameworkApplication.fa&&Kd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Zz(){super.Zz();this.Xk.style.width=this.eib;this.Xk.style.height=this.Dfa;this.Xk.style.marginTop=
this.QDa;this.Xk.style.padding=this.Efa}mAa(){this.Xk.style.width=this.eib;this.Xk.style.height=this.Dfa;this.Xk.style.marginTop=this.QDa;this.Xk.style.padding=this.Efa;this.mY>th.a.Xma?(this.wb.style.width=String.format("{0}px",th.a.Xma),this.wb.style.overflowX="scroll",Kd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.mY),this.wb.style.overflowX="hidden");this.wb.offsetHeight>th.a.Wma||this.LKc+50>th.a.Wma?(this.wb.style.height=
String.format("{0}px",th.a.Wma),this.wb.style.overflowY="scroll",this.wb.style.top="0",Kd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.WKc||(this.wb.style.marginTop="-48px"),this.Xk.style.minHeight=String.format("{0}px",this.AIc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.tqa);this.jta()}jta(){if(this.wb){var O=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.mY>th.a.Xma)Kd.AFrameworkApplication.isRtl?this.wb.style.marginRight=
"0":this.wb.style.marginLeft="0";else{const Sa=String.format("{0}px",Math.floor(-this.wb.offsetWidth/2));Kd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Sa:this.wb.style.marginLeft=Sa;Kd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(O)}else n.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}VI(){super.VI();const O=document.getElementById(this.mi(this.KKc));O.style.width=String.format("{0}px",this.mY);
O.style.height=this.tqa}get Uia(){return this.Xk}}Object(d.a)(Di,"AppsForOfficeInsertionDialog",Ih.a,[340]);class li extends Ih.a{constructor(){super();this.Dfa="calc(100% - 46px)";this.QDa="15px";this.Efa="0";this.KKc="WACDialogPanel";this.mY=695;this.LKc=462;this.tqa="80%";this.AIc=350;this.eib="100%";this.Tb=5;this.Ee="SDXDialog"}Zz(){super.Zz();this.Xk.style.width=this.eib;this.Xk.style.height=this.Dfa;this.Xk.style.marginTop=this.QDa;this.Xk.style.padding=this.Efa}mAa(){this.Xk.style.width=this.eib;
this.Xk.style.height=this.Dfa;this.Xk.style.marginTop=this.QDa;this.Xk.style.padding=this.Efa;this.mY>th.a.Xma?(this.wb.style.width=String.format("{0}px",th.a.Xma),this.wb.style.overflowX="scroll",Kd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.mY),this.wb.style.overflowX="hidden");this.wb.offsetHeight>th.a.Wma||this.LKc+50>th.a.Wma?(this.wb.style.height=String.format("{0}px",th.a.Wma),this.wb.style.overflowY="scroll",
this.wb.style.top="0",Kd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.Xk.style.minHeight=String.format("{0}px",this.AIc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.tqa);this.jta()}jta(){if(this.wb){var O=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.mY>th.a.Xma)Kd.AFrameworkApplication.isRtl?this.wb.style.marginRight="0":this.wb.style.marginLeft="0";else{const Sa=String.format("{0}px",Math.floor(-this.wb.offsetWidth/
2));Kd.AFrameworkApplication.isRtl?this.wb.style.marginRight=Sa:this.wb.style.marginLeft=Sa;Kd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(O)}else n.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}VI(){super.VI();const O=document.getElementById(this.mi(this.KKc));O.style.width=String.format("{0}px",this.mY);O.style.height=this.tqa}get Uia(){return this.Xk}}Object(d.a)(li,"SDXDialog",Ih.a,[]);var bh=a(963),
Mi=a(145),Ni=a(574),Rh;(function(O){O[O.Valid=2]="Valid";O[O.Invalid=4]="Invalid";O[O.All=6]="All"})(Rh||(Rh={}));Object(d.b)("MetadataState",Rh);var Ei=a(346);class zf extends Fb.a{constructor(O,Sa,Hb,hc,wc){super();this.tBa={};this.bed={};this.Xza=this.sdxDialog=this.o5=null;this.Kcb=!1;this.eLj=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"]]);this.p9h=(ad,kd,od,Dd,Pd)=>{if(2!==od)return 32;
ad=Pd[bh.a.Cvb];kd=Pd[bh.a.tZ];od=Pd[bh.a.xW];Pd=new gh.a;Pd.uhc=od.optionalProperties.InstanceToken;Pd.sourceLocationOverrideResourceId=od.optionalProperties[Tg.a.sourceLocationOverrideResourceId];Pd.EB=od.Dh;Pd.tZ=kd;kd=null!=Pd.uhc?Pd.uhc:(new wa.a(Ig.a.create(),1)).toString();od=null!=Pd.EB?Pd.EB:{};Dd={};Dd.id=kd;Dd.solutionId=ad.getId();Dd.version=ad.rDa;Dd.storeType=ad.getStoreType();Dd.storeId=ad.getStoreId();Dd.assetId=null;Dd.assetStoreId=null;Dd.settings=od;Dd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;
Dd.osfControlType=OSF.OsfControlType.ContainerLevel;Dd.sourceLocationOverrideResourceId=Pd.sourceLocationOverrideResourceId;Dd.featureGates=Kd.AFrameworkApplication.fa.g4e(ad.getId());this.kmc(Pd,Dd);return 32};this.CDb=(ad,kd,od,Dd,Pd)=>{2===od&&(this.o5=new Di,this.o5.initializeAndShow("",null,null),ad=Pd.CommandValueId,kd=[],kd.push(Pd.SourceControlId),kd.push(ad),kd.push(null),this.Xd.Tqf(this.o5.Uia,kd));return 32};this.kmc=(ad,kd)=>{this.sdxDialog=new li;this.sdxDialog.initializeAndShow("",
null,null);kd.div=this.sdxDialog.Uia;ad={};ad.InstanceId=kd.id;ad.WebExtensionType=2;ad.PrimaryMarketplace={};ad.PrimaryMarketplace.SolutionId=kd.solutionId;ad.PrimaryMarketplace.MarketplaceType=kd.storeType;ad.PrimaryMarketplace.MarketplaceRef=kd.storeId;ad.PrimaryMarketplace.SolutionVersion=kd.version;ad.SrcLocationOverrideResourceId=kd.sourceLocationOverrideResourceId;ad.WebExtensionOsfControlType=6;this.tBa[kd.solutionId]=kd.settings;ad.OsfPropertyBag=this.Snc([],kd.solutionId);this.Xd.TIa(ad);
this.Xd.Ph.insertOsfControl(kd)};this.C$h=(ad,kd,od,Dd,Pd)=>{if(2!==od)return 32;ad=Pd[bh.a.Cvb];od=Pd[bh.a.tZ];Pd=Pd[bh.a.xW];kd=new gh.a;kd.uhc=Pd.optionalProperties.InstanceToken;kd.ij=Pd.optionalProperties[Tg.a.ij];kd.JS=Pd.optionalProperties[Tg.a.JS];Tg.a.taskPaneWidth in Pd.optionalProperties&&(kd.taskPaneWidth=Pd.optionalProperties[Tg.a.taskPaneWidth]);kd.sourceLocationOverrideResourceId=Pd.optionalProperties[Tg.a.sourceLocationOverrideResourceId];kd.EB=Pd.Dh;kd.onTaskPaneClose=Pd.optionalProperties[Tg.a.onTaskPaneClose];
kd.tZ=od;od=new vg.a(-859308420,0,2,0,"");Dd=ad.getStoreType()===OSF.StoreType.Sdx;const Se=new ah.a;Se.q_=Pd.optionalProperties.HeaderCssClass||Kg.a.fKa;Se.NUa=Pd.optionalProperties.TitleCssClass;this.W7(od,ad.getId(),kd,Dd,Se);return 32};this.m$h=(ad,kd,od,Dd,Pd)=>{if(2!==od)return 32;ad=Pd[bh.a.Cvb].getId();Pd=Pd[bh.a.xW].optionalProperties[Tg.a.sourceLocationOverrideResourceId];return ad?(this.Xd.Ph.refreshOsfControl(ad,Pd),32):8};this.a6i=ad=>{ad=ad.Result;if(ad=null===ad?null:ad.SolutionId)this.Xd.dqe(ad),
Ci.a(this.$).Tna(3,ad)};this.tOf=(ad,kd)=>{var od;const Dd=(ad=ad.Result)?ad.AgaveData:null;if(Dd){var Pd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Dd.PrimaryMarketplace.SolutionId,Dd.PrimaryMarketplace.MarketplaceType,null===(od=null===Dd||void 0===Dd?void 0:Dd.AssetMarketplace)||void 0===od?void 0:od.SolutionId,null,null,Dd.PrimaryMarketplace.MarketplaceRef);n.ULS.shipAssertTag(537170434,0,Dd.TaskpaneWidth===zf.Nkh,`Taskpane width is ${Dd.TaskpaneWidth}, assetId is ${Pd}.`);if(od=this.bed[Dd.PrimaryMarketplace.SolutionId])od.KCc&&
(Dd.TaskpaneTitle=od.KCc),od.ICc&&(Dd.TaskpaneIconId=od.ICc),od.GZd&&(Dd.TaskpaneButtonTooltip=od.GZd),0<od.yq&&(Dd.TaskpaneWidth=od.yq);kd&&(Dd.FocusOnIframeWhenLoaded=kd.focusOnIframeWhenLoaded,kd.width&&(Dd.TaskpaneWidth=kd.width),Dd.TaskpaneIconCssClass=kd.Ek,Dd.TaskpaneHeaderCssClass=kd.q_,Dd.TaskpaneTitleCssClass=kd.NUa,Dd.IsFirstPartyOptOutAppContextOptmization=kd.isFirstPartyOptOutAppContextOptmization);this.tBa[Dd.PrimaryMarketplace.SolutionId]&&(Dd.OsfPropertyBag=this.Snc(Dd.OsfPropertyBag,
Dd.PrimaryMarketplace.SolutionId));Li.a(Dd)||(Dd.WebExtensionOsfControlType=1);Dd&&(this.Xd.dqe(ad.SolutionId),this.Xd.TIa(Dd))}else n.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.tFh=ad=>{ad&&(this.ldd.ppf(ad),this.jCe())};this.xOf=ad=>{ad=ad.toDataURL("image/jpeg");const kd=this.Xd.Saa(zf.Scf+"."+zf.$ec),od={};od.screenshot=ad;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(kd,"onScreenshot",od,()=>{})};this.M8h=
(ad,kd,od,Dd,Pd)=>{if(2!==od)return 32;if(Ph.a.sh(Pd)||Pd[bh.a.zGe]!==wi.a.action)return 8;kd=Pd[bh.a.xW];return kd?(ad=(ad=this.a_h(Pd))?this.Xd.Saa(ad):null)?(Pd=this.Xd.Xah(Pd[bh.a.tZ],kd.optionalProperties[Tg.a.s_b]),A.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(od=this.Xd.XZ(ad),od.TaskpaneTitle!==kd.optionalProperties[Tg.a.ij]&&(od.TaskpaneTitle=kd.optionalProperties[Tg.a.ij],od.TaskpaneIconCssClass=kd.optionalProperties.IconCssClass,od.TaskpaneIconUrl=
kd.optionalProperties.TaskPaneIconUrl,od.TaskpaneIconId=kd.optionalProperties.TaskPaneIconId,A.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(kd=this.Xd.Ph,kd.changeIframeTitle(ad,od.TaskpaneTitle),od=kd.getOsfControl(ad),kd.raiseOsfControlStatusChange(od)):(kd=this.Xd.Ph.getOsfControl(ad),this.Xd.Ph.raiseOsfControlStatusChange(kd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ad,Pd,this.yMb),32):8:8};this.yMb=(ad,kd)=>{this.Xd.UHh(ad,kd)};this.dMd=
()=>{Yf.TaskExtensions.WJ(sg.GetServiceTaskFactory.Na(this.$.da,20,404,1),ad=>{ad.result.W5a()},this.$.ka)};this.$=O;this.viewBlockContainerHelpers=Hb;this.Xd=Sa;this.ldd=hc;this.Wh=wc;this.Wh.Nb(Od.a.d$f,rh.a.frame,this.C$h);this.Wh.Nb(Od.a.n_f,rh.a.frame,this.m$h);this.Wh.Nb(Od.a.cXe,rh.a.frame,this.M8h);this.Wh.Nb(Od.a.kmc,rh.a.frame,this.p9h);this.Wh.Nb(Od.a.CDb,rh.a.frame,this.CDb)}pNg(O){this.addHandler(zf.fGd,O)}Vij(O){this.removeHandler(zf.fGd,O)}dispose(){nh.a.Ia(this.o5);this.o5=null;this.Kcb&&
(this.$.ea.Pn(this.dMd),this.Kcb=!1);super.dispose()}a2c(){this.o5.hide()}Ebg(O,Sa){var Hb;if(O){this.raiseEvent(zf.fGd);const hc=O.split("|");this.gCi(O,Sa,hc);this.o5=new Di;this.o5.initializeAndShow("",null,null);this.Xd.Tqf(this.o5.Uia,hc);A.EwaSettings.isChangeGateEnabled("OfficeVSO:7163330_LogAddinInstallOriginEnabledForExcel")&&(window[zf.LPg]=null!==(Hb=this.eLj.get(O))&&void 0!==Hb?Hb:"Unknown")}}Nld(O,Sa,Hb){var hc=Yf.TaskExtensions.Vj();if(-515602470===Hb.command||-336193495===Hb.command||
2086613372===Hb.command||-1444574190===Hb.command||-1336341324===Hb.command||451940422===Hb.command)hc=this.e9h(O,Sa,Hb);418618014===Hb.command&&(Sa=new gh.a,Sa.ij=vc.a.instance.ga(1814),hc=this.W7(Hb,zf.ybi,Sa,!0));if((Hb.tabName===this.$.Eb+Hd.a.L_f||Hb.tabName===Hd.a.C0)&&2===Hb.We||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),O[Rg.a.Kc])||O[Rg.a.Kc]===Hd.a.IV)return this.Kaf(O,Hb);if(7===Hb.We&&O.SourceControlId===this.$.Eb+Hd.a.Zec)return O.MenuItemId=Hd.a.ZKd,
this.Kaf(O,Hb);1221897806===Hb.command&&(hc=this.O9f(Hb,"Format"));if(1930653487===Hb.command||1172793074===Hb.command)hc=this.O9f(Hb,"Data");-1753056834===Hb.command&&(hc=this.VHj(Hb));932597253===Hb.command&&(n.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Mi.c(932597253,!0),Sa=new gh.a,Sa.ij=vc.a.instance.ga(2157),Sa.sourceLocationOverrideResourceId=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?zf.j6i:zf.l6i,Sa.focusOnIframeWhenLoaded=
!0,Sa.taskPaneWidth=zf.Aef,hc={},hc.LaunchSource=Object(U.a)(String,O.SourceControlId),hc.LaunchMode="Default",Sa.EB=hc,hc=this.W7(Hb,zf.k6i,Sa,!0));301511274===Hb.command&&(hc=this.eIj(Hb));if(515196233===Hb.command){Sa=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);hc=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var wc=this.$.da.Aa(465);wc&&(wc.$cf(),Sa||hc)&&
(wc.Ohi(),hc&&wc.syj(10===Hb.We));wc=new gh.a;wc.ij=vc.a.instance.ga(2231);const ad={};ad.SourceUILocation=xi.a[Hb.We];if(Sa||hc)ad.SessionID=this.$.ea.sessionId,Sa&&this.ISd(ad);wc.EB=ad;Sa=new ah.a;Sa.q_=Kg.a.fKa;hc=this.W7(Hb,zf.q1i,wc,!0,Sa,void 0,wc.ij)}1723441034===Hb.command&&(Sa=new gh.a,Sa.ij=vc.a.instance.ga(2243),Sa.focusOnIframeWhenLoaded=!0,Sa.taskPaneWidth=zf.b9i,hc=new ah.a,hc.q_=Kg.a.Dwh,hc=this.W7(Hb,Ni.a,Sa,!0,hc));A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&O.LoadDataFromPictureTaskpane&&(Sa={},hc=new gh.a,hc.ij=vc.a.instance.ga(2270),Sa.SessionID=O.SessionID,hc.EB=Sa,hc.focusOnIframeWhenLoaded=!0,hc=this.W7(Hb,O.DataFromPictureAssetId,hc,!0));return hc}insertAgave(O,Sa){var Hb=Yf.TaskExtensions.Vj();const hc=this.$;let wc;var ad=O[qd.a.ysa];wc=O[Rg.a.ng];let kd=null;ah.a.key in O&&(kd=O[ah.a.key]);this.o5&&this.o5.hide();if(!wc||!ad)return n.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Hb;this.$.P5&&Hd.a.Roa in
O&&(wc.EnabledInViewMode=O[Hd.a.Roa]);O=this.xRh(Sa.command);if(!wc.EnabledInViewMode&&!hc.aq(null,!1,O))return Hb;let od=void 0===wc.IsToBePersisted||null===wc.IsToBePersisted||wc.IsToBePersisted?0:16;if(1===wc.TargetType)Hb=this.Fii(wc,ad,Sa,kd,od);else{ad=Cg.h(hc);Hb=this.viewBlockContainerHelpers.whb(ad);const Dd=hc.ea.isNamedObjectViewMode?hc.na.sheetName:hc.na.name;let Pd,Se,Ue,lf;Hb?(ad=Hb.je,Pd=ad.nf.top,Se=ad.nf.left,Ue=Hb.iJ.x,lf=Hb.iJ.y):(Pd=Se=1,Hb=this.viewBlockContainerHelpers.ULa(ad),
Ue=Hb.x,lf=Hb.y);const zg=this.$.pa.xa.Wb();od|=64;Hb=ji.a(this.$.userOperationManager,(jg,Zf,ag)=>{var mg=hc.pa.xa,Ug=Pd,Ng=Se,Vg=Ue,Jh=lf;jg=Kf.b(jg,this.a6i);const Zh=mg.Oa(9,zg);Zh.sharedInfo=wc;Zh.sheetName=Dd;Zh.positionRow=Ug;Zh.positionCol=Ng;Zh.positionOffsetX=Vg;Zh.positionOffsetY=Jh;return Ag.g(mg,"InsertWebExtension",Zh,jg,Zf,ag,null,0)},jg=>new Qh.a(534,0,jg,od),Sa)}return Hb}s9g(){var O=Hc.a.instance.Rb("Common.App.ICustomerFeedbackUiWrapper");if(!A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var Sa=Hc.a.instance.Rb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.ldd?this.ldd.Tkb?this.jCe():Sa.instance.i$c(this.tFh):n.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}Sa={};Kd.AFrameworkApplication.fa.xqe(Sa);O=O.instance.getContext(Sa);Sa={};"telemetryGroup"in O&&(Sa=O.telemetryGroup);Sa.processSessionId=O.sessionId;Sa.officeBuild=O.build;O.telemetryGroup=Sa;O.feedbackType=-1;O.userVoiceEnabled=!1;"disableIncludeScreenshot"in O||(O.disableIncludeScreenshot=
!1);"screenshot"in O||(O.screenshot=!1);O.disableScreenshotPreview=!1;O.includeScreenshotSelectedDefault=!0;return O}JOf(O){if(!this.Xza&&A.EwaSettings.getBooleanFeatureGate(zf.sdi,!1)){var Sa=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Sa=this.Ize(Sa);const Hb=new ah.a;Hb.Ek=Kg.a.gcd;Hb.q_=Kg.a.PTe;Hb.NUa=Kg.a.Ebd;this.Xza=this.cMb(Sa,null,!1,null,Hb);ki.b(this.$).vd(Wi.a.z6i,{["Location"]:O?xi.a[O.We]:0,["InputMethod"]:O?
Ti.a[O.method]:0},void 0,!0);A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.y0d()}}ISd(O){const Sa=this.$.ea.Mg.get(17);Hc.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Hb=>{Hb.isFeatureEnabled("mso_sendASmile",Sa).then(hc=>{O.FeedbackEnabled=Sa&&hc;return null})})}O9f(O,Sa){const Hb=Cg.h(this.$),hc=new gh.a;var wc={};wc.ActiveTab=Sa;wc.DatapaneFlighting=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);wc.AceFlighting=!0;wc.ChartNewSDXRecording=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);wc.ThemeColorsFlighting=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&A.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");wc.UOMirror=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);wc.FormatTaskPaneAceButtonDark=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);wc.FormatTaskPaneBetterFeedbackButton=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);wc.FormatTaskPaneBetterScrollbar=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);wc.FormatTaskPaneUXImprovePhase2=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);this.ISd(wc);wc.startTimeMs=Date.now();wc.UserSessionId=this.$.ya.UserSessionId;(Sa=Hb.ha.Ta.ro)&&(wc.SubSelection=
Sa);n.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${wc.UserSessionId}, UILocation: ${void 0===O.We||null===O.We?"Null":xi.a[O.We]}, SubSelection: ${Sa||"ChartRoot"}`);hc.EB=wc;hc.ij=vc.a.instance.ga(981);wc=new ah.a;wc.q_=Kg.a.fKa;return this.W7(O,zf.k3g,hc,!0,wc)}VHj(O){const Sa=new gh.a;Sa.EB={};Sa.ij=vc.a.instance.ga(1800);Sa.JS=zf.qrf;const Hb=new ah.a;Hb.q_=Kg.a.fKa;return this.W7(O,zf.qrf,Sa,!0,Hb,void 0,Sa.ij)}eIj(O){const Sa=new gh.a;Sa.EB={};Sa.ij=vc.a.instance.ga(2181);
const Hb=new ah.a;Hb.q_=Kg.a.cyh;Hb.NUa=Kg.a.TTe;return this.W7(O,zf.KJi,Sa,!0,Hb)}Kaf(O,Sa){const Hb=zf.Scf;var hc=O[Rg.a.Kc].toString();const wc={},ad=new gh.a;ad.ij=vc.a.instance.ga(9);switch(hc){case "A0":wc.query=(O[Rg.a.ng]||"").split("|").slice(2,Vi.a.aT).join("|");break;case "A1":wc.query=O.CommandValueId;break;case "Help":wc.gwdropdownflightinfo=A.EwaSettings.oa(235);wc.query="";break;case Hd.a.ZKd:A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(ad.ij=vc.a.instance.ga(1766),ad.sourceLocationOverrideResourceId=zf.$ec,wc.feedback=this.s9g()):wc.query=hc;break;case "HelpArticle":wc.query=O[Rg.a.ng];break;case "ContactSupport":wc.query=hc;A.EwaSettings.isChangeGateEnabled("OfficeVSO:7449497_OverrideContactUsPaneUrl")&&(ad.sourceLocationOverrideResourceId=zf.A9g);break;case "ShowTraining":case "WhatsNew":wc.query=hc;break;default:return mh.Task.Ra(!0)}ad.EB=wc;hc=new ah.a;hc.q_=Kg.a.fKa;return this.W7(Sa,Hb,ad,!1,hc,O[Hd.a.Roa]||!1)}Ize(O){const Sa=
{};A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Sa.SolutionId=zf.Wwa,Sa.Version="0.0.0.0",Sa.StoreType=OSF.StoreType.Sdx,Sa.StoreId=OSF.StoreType.Sdx,Sa.AssetId=null,Sa.AssetStoreId=null,Sa.Height=0,Sa.Width=0):(Sa.Version="0.0.0.0",Sa.AssetId=zf.Wwa,Sa.SolutionId=zf.Wwa,Sa.AssetStoreId="",Sa.StoreType=OSF.StoreType.Sdx,Sa.Height=0,Sa.Width=0,Sa.StoreId=OSF.StoreType.Sdx);Sa.TargetType=OSF.OsfControlTarget.TaskPane;Sa.IsToBePersisted=!1;Sa.SourceLocationOverrideResourceId=
O;Sa.SharedRuntimeId=O;return Sa}e9h(O,Sa,Hb){function hc(){kd.LaunchMode="Default";A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":wc.sourceLocationOverrideResourceId="Insights.Https.Bundle";wc.ij=vc.a.instance.ga(1813);wc.JS=zf.tZc;wc.Ek=Kg.a.gcd;ad.Ek=Kg.a.gcd}const wc=new gh.a,ad=new ah.a,kd={};this.Xza&&this.ISd(kd);kd.LaunchSource="";kd.StartTimeMs=Date.now();kd.CorrelationId=Ig.a.create().toString();
wc.EB=kd;wc.focusOnIframeWhenLoaded=!0;wc.taskPaneWidth=zf.Aef;ad.q_=Kg.a.PTe;ad.NUa=Kg.a.Ebd;switch(Hb.command){case -1444574190:let Pd;kd.LaunchMode="RecommendedPivotTables";kd.SelectionContext="";kd.LaunchSource="PivotTableHandRaise"===Object(U.a)(String,O.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&A.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&O.SourceSelection){var od=O.SourceSelection.split(",")[0];Sa=A.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?
-1:0;if(({sheetName:od,bSf:Pd,range:Dd}=eg.Z(od,this.$.va)).returnValue&&!Cg.h(this.$).Ab.N5(Dd))O=this.$.va.getItemByName(od),kd.SelectionContext=JSON.stringify(Object(jd.a)(new Xh,{address:Pd,addressWithSheet:od+"!"+Dd.Hw(!1),sheetId:Fh.d(O),sheetName:od,isSheetEmpty:!1,columnCount:Dd.width,rowCount:Dd.height,columnIndex:Dd.left+Sa,rowIndex:Dd.top+Sa,selectionType:"Continuous"}));else if((O=this.$.Cb.getItemByName(Object(U.a)(String,O.SourceSelection)))&&Fh.n(O)){var Dd=Ki.a(O,!0);od=this.$.va.getItemByName(O.sheetName);
kd.SelectionContext=JSON.stringify(Object(jd.a)(new sh,{tableName:O.name,hasTableHeaders:Ki.d(O),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Dd.Hw(!1),addressWithSheet:od.name+"!"+Dd.Hw(!1),sheetId:Fh.d(od),sheetName:od.name,isSheetEmpty:!1,columnCount:Dd.width,rowCount:Dd.height,columnIndex:Dd.left+Sa,rowIndex:Dd.top+Sa,selectionType:"Continuous"}))}}A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":
wc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";wc.ij=vc.a.instance.ga(1812);wc.JS=zf.x4i;wc.Ek=Kg.a.kWe;ad.Ek=Kg.a.kWe;break;case -336193495:kd.LaunchMode="RecommendedCharts";A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":wc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";wc.ij=vc.a.instance.ga(1811);wc.JS=zf.ucj;wc.Ek=Kg.a.lWe;ad.Ek=Kg.a.lWe;break;case -1336341324:if(!A.EwaSettings.oa(448))return mh.Task.Ra(!1);
kd.LaunchMode="NL";wc.JS=zf.tZc;A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":wc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(A.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:wc.ij=vc.a.instance.ga(1816);kd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:wc.ij=vc.a.instance.ga(1817);kd.NLLaunchModeBrandingCandidatesIndex=
2;break;default:wc.ij=vc.a.instance.ga(1815),kd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!A.EwaSettings.oa(230))return mh.Task.Ra(!1);kd.LaunchMode="ChartDesigner";kd.LaunchSelectionMode=Sa.toString();A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":wc.sourceLocationOverrideResourceId="Insights.Https.Bundle";wc.ij=vc.a.instance.ga(1818);wc.JS=zf.tZc;break;case 451940422:kd.LaunchSource=
"AutoFilter";Dd=JSON.parse(O.CommandValueId);kd.AutoFilterSource=JSON.stringify(Object.assign(new Ai,{autoFilterRange:{sheetName:Dd.AutoFilterRange.SheetName,firstColumn:Dd.AutoFilterRange.FirstColumn,lastColumn:Dd.AutoFilterRange.LastColumn,firstRow:Dd.AutoFilterRange.FirstRow,lastRow:Dd.AutoFilterRange.LastRow},autoFilterType:Dd.AutoFilterType,itemIndex:Dd.ItemIndex,id:Dd.Id}));hc();break;default:A.EwaSettings.oa(230)&&(kd.LaunchSelectionMode=Sa.toString()),A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&(kd.XlimTableBoundaries=this.k4h()),hc()}A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?wc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":wc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Xza?this.Xza.np(()=>this.Y2f(kd,wc)):this.Pgi(Hb,wc,ad,kd)}Pgi(O,Sa,Hb,hc){const wc=this.Ize(Sa.sourceLocationOverrideResourceId);this.Xza=this.cMb(wc,Sa,!1,O,Hb,!1);return A.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?
(hc.NoActionMsgOnFirstInstance=!0,this.tBa[zf.Wwa]=hc,this.Xza):this.Xza.np(()=>this.Y2f(hc,Sa))}Y2f(O,Sa){const Hb=this.Xd.Saa(this.Xd.N4a(zf.Wwa,Sa.sourceLocationOverrideResourceId));if(Hb){this.tBa[zf.Wwa]=O;const hc=this.Snc(this.Xd.XZ(Hb).OsfPropertyBag,zf.Wwa);this.Xd.XZ(Hb).OsfPropertyBag=hc}this.h6(zf.Wwa,"LaunchIdeasAction",O,Sa);return mh.Task.Ra(!0)}W7(O,Sa,Hb=null,hc=!1,wc=null,ad=!1,kd=null){Yf.TaskExtensions.Vj();Hb||(Hb=new gh.a);const od={};A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?(od.SolutionId=Sa,od.Version="0.0.0.0",od.StoreType=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,od.StoreId=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,od.AssetId=null,od.AssetStoreId=null,od.Height=0,od.Width=0):(od.Version="0.0.0.0",od.AssetId=Sa,od.SolutionId=Sa,od.AssetStoreId="",od.StoreType=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,od.Height=0,od.Width=0,od.StoreId=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty);od.TargetType=OSF.OsfControlTarget.TaskPane;od.IsToBePersisted=!1;od.SourceLocationOverrideResourceId=
Hb.sourceLocationOverrideResourceId;if(Hb.ij||kd)this.bed[Sa]=Object(jd.a)(new yi,{KCc:Hb.ij,GZd:kd,ICc:Hb.JS});A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Hb.EB||(Hb.EB={}),Hb.EB.ShowFeedback=this.$.isFeedbackEnabled,this.tBa[Sa]=Hb.EB):Hb.EB&&(this.tBa[Sa]=Hb.EB);Sa={};Sa[Rg.a.ng]=od;kd={};kd.solutionId=od.SolutionId;kd.version=od.Version;kd.storeType=od.StoreType;kd.storeId=od.StoreId;kd.assetId=od.AssetId;kd.assetStoreId=
od.AssetStoreId;kd.height=od.Height;kd.targetType=od.TargetType;kd.width=od.Width;kd.isAddinCommands=!hc;Sa[qd.a.ysa]=kd;wc||(wc=new ah.a);wc.focusOnIframeWhenLoaded=Hb.focusOnIframeWhenLoaded;wc.width=Hb.taskPaneWidth;Sa[ah.a.key]=wc;Sa[Hd.a.Roa]=ad;return this.insertAgave(Sa,O)}Fii(O,Sa,Hb,hc,wc){const ad=(Pd,Se)=>{var Ue=Pd.SolutionId;var lf=OSF.OsfControl.isFirstPartyStoreString(Pd.StoreType);lf&&Pd.SourceLocationOverrideResourceId&&(Ue=this.Xd.N4a(Ue,Pd.SourceLocationOverrideResourceId));var zg=
this.Xd.eDe(Ue,null,Pd.SharedRuntimeId);lf&&(A.EwaSettings.oa(278)&&zg&&(lf=this.Xd.Saa(Ue))&&(Ue=null,Ue=this.Snc(this.Xd.XZ(lf).OsfPropertyBag,Pd.SolutionId),(lf=this.Xd.Ph.getOsfControl(lf))&&lf.setSettings(Ue)),Pd.SharedRuntimeId&&zg||this.Xd.Ph.refreshOsfControl(Pd.SolutionId,Pd.SourceLocationOverrideResourceId));if(!zg){const jg=this.$.pa.xa.Wb();let Zf=519;zg=(ag,mg,Ug)=>{var Ng=this.$.pa.xa;ag=Kf.b(ag,this.tOf);const Vg=Ng.Oa(9,jg);Vg.sharedInfo=Pd;return Ag.g(Ng,"InsertAgaveTaskpane",Vg,
ag,mg,Ug,hc,0)};void 0===Pd.IsToBePersisted||null===Pd.IsToBePersisted||Pd.IsToBePersisted||(Zf=538,zg=(ag,mg,Ug)=>{const Ng=Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.SolutionId,Pd.StoreType,Pd.AssetId,null,null,Pd.StoreId);n.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Pd.StoreType}, StoreId ${Pd.StoreId}, SolutionId ${Ng}.`);return Bi(this.$.pa.xa,Pd,Kf.b(ag,this.tOf),mg,Ug,hc,jg)});wc|=64;return ji.a(this.$.userOperationManager,zg,ag=>new Qh.a(Zf,
0,ag,wc),Se)}return Yf.TaskExtensions.sba()},kd=Pd=>{var Se=Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.solutionId,Pd.storeType,Pd.assetId,null,null,Pd.storeId);n.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Se} from ${Pd.storeType}.`);Se={};const Ue=new m.a;Ue.add(Pd);Se[qd.a.gpb]=Ue;Se[qd.a.GM]=3;Pd=new vg.a(Od.a.ADb,0,this.$.Hc,0,null);return this.$.Ka.Lb(Pd,Se)};if(!A.EwaSettings.oa(52)||O.StoreId===OSF.StoreType.FirstParty)return ad(O,Hb,hc);if(Sa.isAddinCommands)return kd(Sa);
const od=new dd.a,Dd={};A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Dd.solutionId=O.SolutionId,Dd.version=O.Version):(Dd.marketplaceId=O.SolutionId,Dd.marketplaceVersion=O.Version);Dd.storeType=O.StoreType;Dd.storeId=O.StoreId;Dd.targetData=O;A.EwaSettings.oa(92)&&(Dd.clearCache=!0);this.Xd.Ph.isAddinCommandsAsync(Dd,(Pd,Se,Ue)=>{od.setResult(Se);Pd||(Pd=Ue.targetData,Se=Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.SolutionId,Pd.StoreType,Pd.AssetId,
null,null,Pd.StoreId),n.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Se} from ${Pd.StoreType} during addin inserting`))});return Yf.TaskExtensions.ts(od.task,Pd=>Pd.result?kd(Sa):ad(O,Hb,hc),this.$.ka)}Snc(O,Sa){if(!this.tBa[Sa])return O;const Hb={};if(O)for(const wc of O)Hb[wc[0]]=wc[1];O=this.tBa[Sa];for(var hc of Object.keys(O))hc===zf.vFh&&A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Hb[hc]=Sys.Serialization.JavaScriptSerializer.serialize(O[hc]):
Hb[hc]=Sys.Serialization.JavaScriptSerializer.serialize(O[hc].toString());hc=Object.keys(Hb).length;hc=Array(hc);O=0;for(const wc of Object.keys(Hb))hc[O]=[wc,Hb[wc].toString()],O++;return hc}gCi(O,Sa,Hb){const hc=this.$.ya.UserSessionId,wc=this.$.ya.UICultureTag,ad=this.$.ya.UICultureTagLcid,kd=this.$.ya.WacHostId;let od="",Dd="";5<=Hb.length&&(od=Hb[3],Dd=Hb[4]);this.hCi(od,Dd,O,Sa,wc,ad,hc,kd)}hCi(O,Sa,Hb,hc,wc,ad,kd,od){const Dd={};Dd.a=kd;Dd.b=Hb;Dd.c=hc;Dd.d=O;Dd.e=Sa;Dd.f=wc;Dd.g=ad;Dd.h=od;
Dh.b().Qe(36,Dd)}jCe(){if(Ui.a.Ezf())n.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.xOf);return}catch(O){n.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(O?O.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.xOf)}catch(O){n.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(O?O.toString():null))}}}cMb(O,Sa=null,Hb=!1,hc=null,wc=null,ad=!0){var kd=
O.SolutionId;let od=mh.Task.Ra(!1);O&&kd&&O.SharedRuntimeId&&(hc=hc||new vg.a(-859308420,0,2,0,""),kd={},kd.solutionId=O.SolutionId,kd.version=O.Version,kd.storeType=O.StoreType,kd.storeId=O.StoreId,kd.assetId=O.AssetId,kd.assetStoreId=O.AssetStoreId,kd.height=O.Height,kd.targetType=O.TargetType,kd.width=0,kd.isAddinCommands=!1,kd.sharedRuntimeId=O.SharedRuntimeId,O.Preload=ad,wc=wc?wc:new ah.a,wc.width=0,Sa&&(wc.focusOnIframeWhenLoaded=Sa.focusOnIframeWhenLoaded,ad=new yi,Sa.ij&&(ad.KCc=Sa.ij),0<
Sa.taskPaneWidth&&(ad.yq=Sa.taskPaneWidth),Sa.JS&&(ad.ICc=Sa.JS),this.bed[O.SolutionId]=ad),Sa={},Sa[Rg.a.ng]=O,Sa[qd.a.ysa]=kd,Sa[ah.a.key]=wc,Sa[Hd.a.Roa]=Hb,od=this.insertAgave(Sa,hc));return od}h6(O,Sa,Hb,hc=null){if(O&&Sa){O=new qg.a(O,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const wc=new Nh.a("ExcelOnline","Web",this.$.ya.UICultureTag),ad=new Eh.a;ad.optionalProperties[Tg.a.s_b]=Hb;hc&&(hc.sourceLocationOverrideResourceId&&(ad.optionalProperties[Tg.a.sourceLocationOverrideResourceId]=
hc.sourceLocationOverrideResourceId),hc.ij&&(ad.optionalProperties[Tg.a.ij]=hc.ij),hc.Ek&&(ad.optionalProperties.IconCssClass=hc.Ek),hc.DZd&&(ad.optionalProperties.TaskPaneIconUrl=hc.DZd),hc.JS&&(ad.optionalProperties.TaskPaneIconId=hc.JS));zh.a.instance.h6(O,wi.a.action,Sa,wc,ad)}}a_h(O){if(!Ph.a.sh(O)){var Sa=O[bh.a.Cvb];if(Sa&&(Sa=Sa.getId(),O=O[bh.a.xW],Sa&&O))return this.N4a(Sa,O.optionalProperties[Tg.a.sourceLocationOverrideResourceId])}return null}N4a(O,Sa=null){return O&&Sa?`${O}.${Sa}`:O}xRh(O){switch(O){case 1172793074:case 1221897806:case 1930653487:return 2;
case -515602470:case 2086613372:return A.EwaSettings.oa(230)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}y0d(){this.$.ea.Yf?this.dMd():(this.$.ea.Lk(this.dMd),this.Kcb=!0)}k4h(){var O=this.$.da.Aa(20);if(!O)return this.y0d(),"";O=O.W5a();if(!O)return this.y0d(),"";var Sa=this.$.va.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);Sa=Fh.d(Sa);var Hb=Cg.h(this.$).ha.ra.selectedRanges;const hc=[];for(const ad of Hb){Hb=
new Ei.a(ad,Sa);var wc=O.iec(Hb,Rh.Valid);Hb=[];if(wc)for(const kd of wc)(wc=kd.table.GC)&&(wc=wc.range.toString())&&Hb.push(wc);Hb=new ii(ad.toString(),Hb);hc.push(Hb)}return JSON.stringify(hc)}}zf.sdi="Microsoft.Office.Excel.IdeasXLOPreload";zf.fGd="IDS";zf.Scf="FA000000012";zf.Wwa="FA000000005";zf.ybi="HelloWorld";zf.k3g="FA000000014";zf.$ec="Help.GiveFeedback.Url";zf.A9g="Help.ContactSupport.Url";zf.vFh="feedback";zf.qrf="FA000000066";zf.l6i="PowerBi.Url";zf.j6i="PowerBi.DevUrl";zf.k6i="FA000000054";
zf.KJi="FA000000064";zf.q1i="FA000000075";zf.tZc="AnalyzeDataTaskPane";zf.ucj="RecommendedChartsTaskPane";zf.x4i="PivotTableTaskPane";zf.Nkh=350;zf.Aef=320;zf.b9i=320;zf.LPg="g_InstallOrigin";Object(d.a)(zf,"AgaveCommandManager",Fb.a,[305,306]);class mi extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){const O=this.$.da,Sa=sg.GetServiceTaskFactory.create(O,106,this.ka,this.Ya),Hb=sg.GetServiceTaskFactory.create(O,104,this.ka,this.Ya),hc=ti.a.loadScript(35,0,this.Ya,void 0,void 0,375);
Yf.TaskExtensions.za(Yf.TaskExtensions.Ed([Hb,Sa,hc],this.ka),()=>{let wc=null;A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(wc=Hc.a.instance.Rb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);oh.instance.initialize(Sa.result);const ad=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(vh.a)(this.$.da,374,()=>new zf(this.$,Sa.result,Hb.result,wc,Kd.AFrameworkApplication.ub)):
new zf(this.$,Sa.result,Hb.result,wc,Kd.AFrameworkApplication.ub);O.Ga(206,ad);this.ob(O.Aa(374)||O.Ga(374,ad))},this.ka,3);Hc.a.instance.register(hi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").wc().Ac(()=>new hi.a(this.$.uu))}static la(O){O.da.Ga(375,new mi(O))}}Object(d.a)(mi,"AgaveCommandManagerFactory",h.a,[]);var Oi=a(561);class uh{constructor(){this.initialized=!1;this.agaveCommandManager=this.Xd=this.E1a=null;this.AU={}}initialize(O){A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.Cqj(O)}nii(O,Sa){let Hb=Yf.TaskExtensions.Vj();if(this.initialized&&O&&0<O.length){let hc=this.pOh(O);O in this.AU&&(Hb=this.agaveCommandManager.insertAgave(hc,Sa))}return Hb}YHg(O){this.initialized&&(O=O[Rg.a.ng]||{},!O.SolutionId||O.SolutionId in this.AU||this.Xd.Fda(Sa=>{this.Fda(Sa)},!0))}h$h(O){this.initialized&&(O=O||"")&&0<O.length&&O in this.AU&&(delete this.AU[O],this.Xd.Fda(Sa=>{this.Fda(Sa)},!0))}pOh(O){return O in this.AU?this.AU[O]:{}}Fda(O){var Sa=!1;if(O&&
!O.errorCode){if(O.value)for(const Hb of O.value)O=Hb[1],Hb[3]==OSF.OsfControlTarget.InContent&&O&&0<O.length&&!(O in this.AU)&&(Sa={NoReporting:!1,IsSystemInitiated:!1},Sa.description=Hb[2],Sa.iconUrl=Hb[9],Sa[qd.a.ysa]={solutionId:Hb[1],version:Hb[4],storeType:Hb[12],storeId:Hb[11],assetId:Hb[5],assetStoreId:Hb[6],targetType:Hb[3],width:Hb[7],height:Hb[8],displayName:Hb[0],id:Hb[1]},Sa[Rg.a.ng]={SolutionId:Hb[1],Version:Hb[4],StoreType:Hb[12],StoreId:Hb[11],AssetId:Hb[5],AssetStoreId:Hb[6],TargetType:Hb[3],
Width:Hb[7],Height:Hb[8],Id:Hb[1]},this.AU[O]=Sa,Sa=!0);Sa&&this.sch()}}sch(){let O=[];for(const Sa in this.AU)O.push({id:Sa,controlType:0,title:this.AU[Sa][qd.a.ysa].displayName});if(0<O.length){for(const Sa in this.AU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Sa,this.AU[Sa].iconUrl);this.v4g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:uh.Lzf,isOfficeTab:!0,groups:[{id:uh.Ggf,title:uh.Hgf,controls:O}]}]});for(const Sa in this.AU)this.E1a.addCommandToMaps(Object(jd.a)(new Ye.a(Sa,
"-1473679467"),{legacyControlId:Sa}))}}v4g(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:uh.Lzf,isOfficeTab:!0,groups:[{id:uh.Ggf,title:uh.Hgf,controls:[]}]}]})}Cqj(O){const Sa=sg.GetServiceTaskFactory.Na(O.da,374,375,1),Hb=sg.GetServiceTaskFactory.create(O.da,106,O.ka,1);Yf.TaskExtensions.za(Yf.TaskExtensions.Ed([Sa,Hb],O.ka),()=>{this.agaveCommandManager=Sa.result;this.E1a=Hc.a.instance.yg("Common.IExternalUICommandDefinitionMapping")||new Oi.a(O.Eb,O);Kd.AFrameworkApplication.ub.Nb(Od.a.oVf,
rh.a.frame,(hc,wc,ad,kd,od)=>{this.h$h(od)});this.Xd=Hb.result;this.Xd.Fda(hc=>{this.Fda(hc)},!0);this.initialized=!0},O.ka,3)}}uh.Lzf="tabinsert";uh.Ggf="installedContentAddins";uh.Hgf=vc.a.instance.ga(2278);Object(d.a)(uh,"AgaveCommandRibbon",null,[300]);class Sh extends h.a{constructor(O){super();this.$=O;this.Fb()}create(){if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const O=this.$.da,Sa=new uh;Sa.initialize(this.$);this.ob(O.Aa(488)||
O.Ga(488,Sa))}}static la(O){O.da.Ga(489,new Sh(O))}}Object(d.a)(Sh,"AgaveCommandRibbonFactory",h.a,[]);var ni=a(1303),fg=a(734);class Yh{constructor(){this.U$d=this.o$d=this.Mfa=null;this.vkb=0}get displayName(){return this.Mfa}set displayName(O){this.Mfa=O}get email(){return this.o$d}set email(O){this.o$d=O}get federationProvider(){return this.U$d}set federationProvider(O){this.U$d=O}get identityType(){return this.vkb}set identityType(O){this.vkb=O}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(O){switch(O){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Sa){switch(O){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Sa){O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}static Cdh(O){const Sa=new Yh;Sa.displayName=O.displayName;Sa.email=O.email;switch(O.authority){case ni.a.pLf:Sa.identityType=1;break;default:Sa.identityType=0}Sa.federationProvider="";return Sa}}Object(d.a)(Yh,"OfficeIdentityInfo",null,[]);class kh{static get FRe(){return kh.nwg}static jdc(O){return O in kh.FRe?kh.FRe[O].toString():O}}kh.map=null;kh.nwg={["GeneralException"]:fg.a.generalException,
["AccessDenied"]:fg.a.sWc,["ApiNotAvailable"]:fg.a.apiNotAvailable,["UserNotSignedIn"]:fg.a.userNotSignedIn,["UserAborted"]:fg.a.userAborted,["UnsupportedUserIdentity"]:fg.a.GXj,["InvalidResourceUrl"]:fg.a.invalidResourceUrl,["InvalidGrant"]:fg.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:fg.a.NPg,["ResourceNotAllowed"]:fg.a.voj,["ClientError"]:fg.a.clientError,["ServerError"]:fg.a.serverError};Object(d.a)(kh,"SingleSignOnErrorCodeMap",null,[]);class R{constructor(O,Sa){this.ySb=O;this.vkb=Sa}get accessToken(){return this.ySb}set accessToken(O){this.ySb=
O}get tokenIdenityType(){return this.vkb}set tokenIdenityType(O){this.vkb=O}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(O){switch(O){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Sa){switch(O){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}
Object(d.a)(R,"SingleSignOnToken",null,[]);class Va{constructor(){this.J6d=null;this.Bke=this.hYb=this.tE="";this.Ple=!0;this.options=null}get authChallenge(){return this.J6d}set authChallenge(O){this.J6d=O}get correlationId(){return this.tE}set correlationId(O){this.tE=O}get policy(){return null}set policy(O){}get resource(){return this.hYb}set resource(O){this.hYb=O}get scope(){return this.Bke}set scope(O){this.Bke=O}get silentLogin(){return this.Ple}set silentLogin(O){this.Ple=O}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(O){switch(O){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Sa){switch(O){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(d.a)(Va,"TokenParameters",null,[431]);class tb{constructor(O,Sa){this.Rib=Sa;this.HA=O}get roamingSettings(){return null}getAccessToken(O){const Sa=this.Rib.getOsfControl(this.HA),
Hb=Sa.getManifest(),hc=Hb.getMarketplaceID();this.WOa(O,hc);return OfficeExtension.WacRuntime.Utility.createPromise((wc,ad)=>{Sa.isFirstParty()&&this.Rib._enableFirstPartySSO?this.ili(Hb,O)?Hc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(O,hc).then(kd=>{wc(kd)},kd=>{ad(kd)}):ad(fg.a.sWc):ad(fg.a.apiNotAvailable)}).then(wc=>{let ad;switch(wc.authority){case ni.a.pLf:ad=1;break;default:ad=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new R(wc.accessToken,
ad))},wc=>{this.logErrorResponse(O,hc,wc);return wc?OfficeExtension.WacRuntime.Utility.createPromise((ad,kd)=>{kd(OfficeExtension.WacRuntime.Utility.createRichApiException(wc,kh.jdc(wc)))}):OfficeExtension.WacRuntime.Utility.createPromise((ad,kd)=>{kd(OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.generalException,kh.jdc(fg.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const O=this.Rib.getOsfControl(this.HA);O.getManifest();const Sa=O.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Hb,hc)=>{Hc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Sa).then(wc=>{Hb(wc)},wc=>{hc(wc.toString())})}).then(Hb=>{Hb=Yh.Cdh(Hb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Hb)},Hb=>Hb?OfficeExtension.WacRuntime.Utility.createPromise((hc,wc)=>{wc(OfficeExtension.WacRuntime.Utility.createRichApiException(Hb,kh.jdc(Hb)))}):OfficeExtension.WacRuntime.Utility.createPromise((hc,wc)=>
{wc(OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.generalException,kh.jdc(fg.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(O){switch(O){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 1:return this.KNh(Sa);case 3:return this.ZOh();case 2:return this.f0h()}O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}KNh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,Va);return this.getAccessToken(O)}ZOh(){return this.getAuthContext()}f0h(){return this.getPrimaryIdentityInfo()}ili(O,
Sa){let Hb=!1;const hc=O.getWebApplicationAuthorizations();O=null;for(const wc of hc)if(wc.getResource().toLowerCase()===Sa.resource.toLowerCase()){O=wc;Hb=!0;break}if(!Hb)return!1;Sa=Sa.scope.split(" ,+");for(const wc of Sa)if(wc&&wc.length){Sa=!1;for(const ad of O.getScopes())wc.toLowerCase()===ad.toLowerCase()&&(Sa=!0);if(!Sa)return!1}return!0}WOa(O,Sa){O=this.wzf(O.resource);n.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:Sa,["resource"]:O})}logErrorResponse(O,Sa,Hb){O=this.wzf(O.resource);
n.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:Sa,["resource"]:O,["error"]:Hb})}wzf(O){return O.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(d.a)(tb,"AuthenticationService",null,[]);class Xb{create(O,Sa){return new tb(O,Sa)}}Object(d.a)(Xb,"AuthenticationServiceFactory",null,[]);var mc=a(847),Jc=a(965),Gc=a(948);class Bc{}Bc.generalException="generalException";Bc.invalidArgument="invalidArgument";Bc.notAllowed="notAllowed";Bc.apiNotAvailable="apiNotAvailable";
Bc.unresolvedPendingRequest="unresolvedPendingRequest";Bc.timeout="timeout";Bc.adalTimeout="adalTimeout";Bc.userNotSignedIn="userNotSignedIn";Bc.userAborted="userAborted";Bc.silentSignInFailed="silentSignInFailed";Bc.invalidResourceUrl="invalidResourceUrl";Bc.invalidGrant="invalidGrant";Bc.connectionLost="connectionLost";Bc.clientError="clientError";Bc.serverError="serverError";Object(d.a)(Bc,"WopiHostErrorCodes",null,[]);var lc=a(732);class Qc{}Object(d.a)(Qc,"OAuthCallerMetadata",null,[]);var ed=
a(27);class Yc{constructor(O){this.Bya=O;this.ewg=Kd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}iHg(O,Sa,Hb,hc,wc,ad){if(!this.Bya)return hc=new Jc.a,hc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(hc);const kd=new Qc;kd.AddinName=wc;kd.AddinTrustId=ad;let od=-1;ad=null;if(hc&&this.Fkf())ad=this.Bya.jhg(qd.a.aDc,O,hc,Yc.t7e(wc),kd);else{const Dd=Date.now();ad=this.Bya.YL(qd.a.aDc,O,kd).then(Pd=>{od=Date.now()-
Dd;const Se=(Sa||Hb)&&"login_required"===Pd.ErrorCode;return(Sa&&("interaction_required"===Pd.ErrorCode||"consent_required"===Pd.ErrorCode||"invalid_grant"===Pd.ErrorCode)||Se)&&this.Fkf()?this.Bya.jhg(qd.a.aDc,O,null,Yc.t7e(wc),kd):Promise.resolve(Pd)})}return ad.then(Dd=>{const Pd=new Jc.a;Dd.IsSuccess?(Pd.token=Dd.Token,Dd.Telemetry&&(Pd.TUa=Dd.Telemetry.fromCache,Pd.expiresOn=Dd.Telemetry.expiresOn)):(Pd.errorCode=this.DFi(Dd),Pd.JZd=this.D2i(Dd));return Pd}).catch(()=>{const Dd=new Jc.a;Dd.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Dd)}).then(Dd=>{Dd.Iha="OauthManager";0<=od&&(Dd.pyb=od);return Dd})}Ini(O){const Sa=(Kd.AFrameworkApplication.fa.Xa(Kd.AFrameworkApplication.o8)||"").toLowerCase();return(ed.a.Vxa||"teams"===Sa&&lc.a.Azb)&&!Yc.mni(O)||!this.Bya||!this.Bya.kNa()?!1:!0}Fkf(){return this.ewg||1!==Gc.a.vcc()}DFi(O){switch(O.ErrorCode){case "UserCancelled":case "interaction_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;
case "consent_required":case "invalid_grant":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":O=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:O=
O.ErrorCode===Bc.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:O.ErrorCode===Bc.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:O.ErrorCode===Bc.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:O.ErrorCode===Bc.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:O.ErrorCode===Bc.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return O}D2i(O){let Sa=
"";(O=RegExp("AADSTS(\\d+)").exec(O.ErrorMessage))&&1<O.length&&(Sa=O[1]);return Sa}static t7e(O){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,O)}static mni(O){if(!O)return!1;O=O.toLowerCase();for(const Sa of mc.AppsForOfficeSingleSignOnManager.BZe)if(Sa===O)return!0;return!1}}Object(d.a)(Yc,"AppsforOfficeTokenFromOauthManager",null,[193]);class Id{constructor(O){this.LEi=O}static fpa(){if(Kd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var O=
null;try{O=Hc.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Sa){n.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Sa)}O=new Yc(O);Id.Ma=new Id(O)}}static getInstance(){Id.Pbe||(Id.fpa(),Id.Pbe=!0);return Id.Ma}}Id.Ma=null;Id.Pbe=!1;Object(d.a)(Id,"AppsForOfficeOauthManagerFactory",null,[157]);var Xd=a(1302),te=a(133);class Me{constructor(O,Sa,Hb,hc){this.menuItemId=O;this.vG=Sa;this.CNj=Hb;this.eGh=hc}}Object(d.a)(Me,"NewDocumentParameters",null,[]);const vf=O=>
{var Sa=O.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Hb=Sa.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Hb.addParameter("shortcuts","String[]",1,null,0);Sa.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Hb=Sa.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Hb.addParameter("shortcuts","Object",1,null,0);Sa=O.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Hb=Sa.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Hb.addParameter("pickerCustomizationJsonString","String",1,null,0);Sa=O.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Hb=Sa.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Hb.addParameter("base64File","String",1,null,0);Sa=O.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);Sa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Hb=Sa.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Hb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Sa=O.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Sa.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Hb=Sa.addMethod("Register",1,"Void",0,0,"Register",0);Hb.addParameter("metadata","String",1,null,0);Hb.addParameter("javascript","String",1,null,0);Sa=O.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);Sa.addProperty("Enabled",1,"Boolean",1,!1,null,0);Sa.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Sa.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Sa=O.addEnumType("Microsoft.Authentication.IdentityType");Sa.addEnumField("OrganizationAccount",
0);Sa.addEnumField("MicrosoftAccount",1);Sa=O.addEnumType("Microsoft.Authentication.AuthorityType");Sa.addEnumField("External",0);Sa.addEnumField("Msa",1);Sa.addEnumField("Aad",2);Sa=O.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Sa.addProperty("DisplayName",4,"String",1,!1,null,0);Sa.addProperty("Email",3,"String",1,!1,null,0);Sa.addProperty("FederationProvider",2,"String",1,!1,null,0);Sa.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Sa=O.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Sa.addProperty("AppId",4,"String",1,!1,null,0);Sa.addProperty("Authority",2,"String",1,!1,null,0);Sa.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Sa.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Sa.addProperty("TenantId",6,"String",1,!1,null,0);Sa.addProperty("Upn",
1,"String",1,!1,null,0);Sa=O.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Sa.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Hb=Sa.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Hb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Sa.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);Sa.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Sa=O.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Sa.addProperty("AuthChallenge",3,"String",1,!1,null,0);Sa.addProperty("CorrelationId",7,"String",1,!1,null,0);Sa.addProperty("Policy",4,"String",1,!1,null,0);Sa.addProperty("Resource",2,"String",1,!1,null,0);Sa.addProperty("Scope",
5,"String",1,!1,null,0);Sa.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Sa=O.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Sa.addProperty("AccessToken",2,"String",1,!1,null,0);Sa.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Sa=O.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Sa.addProperty("Id",1,"String",1,
!0,null,0);Sa.addProperty("Value",2,"Object",1,!1,null,0);Sa=O.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Hb=Sa.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Hb.addParameter("id","String",1,null,0);Hb=Sa.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Hb.addParameter("id","String",1,null,0);Sa=O.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);Sa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Hb=Sa.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Hb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Sa=O.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Sa.addEnumField("Inactive",0);Sa.addEnumField("Background",1);Sa.addEnumField("Visible",2);Sa=O.addEnumType("Microsoft.AppRuntime.Visibility");
Sa.addEnumField("Hidden",1);Sa.addEnumField("Visible",2);Sa=O.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Sa.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Hb=Sa.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Hb.addParameter("jsonCreate","String",1,null,0);Hb=Sa.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Hb.addParameter("jsonUpdate",
"String",1,null,0);Hb=Sa.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Hb.addParameter("id","String",1,null,0);Hb=Sa.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Hb.addParameter("id","String",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=O.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Sa.addProperty("Id",2,"String",1,!0,null,0);Hb=Sa.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Hb.addParameter("visibility","Boolean",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa=O.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);Sa.addProperty("Enabled",3,"Boolean",1,!1,null,0);Sa.addProperty("Id",2,"String",1,!0,null,0);Sa.addProperty("Label",4,"String",1,!0,null,0);Hb=Sa.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Hb.addParameter("enabled","Boolean",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);Sa=O.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Sa.addMethod("GetCount",3,"Int32",1,1,"Count",0);Hb=Sa.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Hb.addParameter("key","String",1,null,0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Sa.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Sa=O.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Sa.addEnumField("Unknown",0);Sa.addEnumField("Basic",
1);Sa.addEnumField("Premium",2);Sa=O.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Hb=Sa.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Hb.addParameter("feature","String",1,null,0);Hb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Hb=Sa.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Hb.addParameter("feature","String",1,null,0);Hb=Sa.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Hb.addParameter("feature","String",1,null,0);Hb.addParameter("fallbackValue","Boolean",1,null,0);Sa.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Hb=Sa.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Hb.addParameter("experienceId","String",1,null,0);Hb=Sa.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Hb.addParameter("feature","String",1,null,0);Sa=O.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Sa.addProperty("Id",5,"String",1,!0,null,0);Sa.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);Sa.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Sa=O.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
Sa.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Sa=O.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);Sa.addMethod("Disable",3,"Void",0,1,"Disable",0);Sa.addMethod("Enable",2,"Void",0,1,"Enable",0);Sa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var pf=a(186);class Vf{constructor(O,Sa){this.vAg=O;this.QAg=Sa}createAndOpenWorkbook(O){if(O&&
O.length>this.vAg)throw n.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",O.length),OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.invalidArgument,pf.a.ga(1760));const Sa=new Me("blank","agave",O?"streamBase64":"streamEmpty",O);let Hb=null;return OfficeExtension.WacRuntime.Utility.createPromise((hc,wc)=>{const ad=new te.StandardDialog;ad.Tb=4;ad.$l(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,kd=>{2===kd||0===kd?wc("Cancelled"):
(Hb=window.open(""),this.QAg.create(hc,wc,Sa).g2a())})}).then(hc=>{if(!hc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.generalException,pf.a.ga(1756));try{Hb.top.location.href=hc}catch(wc){n.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",ed.a.Ep,wc),n.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Hb.location.replace(hc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},hc=>{if("Cancelled"===hc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.iGd,pf.a.ga(1759));Hb.close();this.IQj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 1:return this.pbh(Sa)}O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}pbh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.createAndOpenWorkbook(O)}IQj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.generalException,
pf.a.ga(1756));}}Object(d.a)(Vf,"WacWorkbook",null,[]);const hf=(O,Sa)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof O+", objectId="+O+", value="+Sa);return null},Jf=O=>{O.add("InternalTest","PreviewExecutionMethod",hf)};var Wf=a(250),cf=a(733),tg=a(741);class Eg{constructor(O){this.jb=O}get $(){return this.jb}}Object(d.a)(Eg,"RichApiPreviewExecutionContext",null,[]);var Fg=a(24),lh=a(969),hh=a(33),yf=a(207),ff=a(210),Cf=a(86),Pf=a(12);class Tf extends ff.a{constructor(O,
Sa,Hb,hc,wc){super(O,"Select Data");this.htmlSanitizationHelper=this.Gqb=null;this.ALe=Sa;this.Q8c=Hb;this.htmlSanitizationHelper=wc;this.callback=hc}get pc(){return"DdaBindingPrompt"}start(O,Sa){let Hb="<div class='"+Cf.a.rvh+" "+Kg.a.Do+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Cf.a.Bz+"' /></div>";Hb=String.format(Hb,Sf.a.rg(this.Q8c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");A.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
A.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(this.Ib,Hb):this.Ib.innerHTML=Hb;this.Gqb=Pf.DOMElementExtensions.getElementById(this.Ib,"bindingText");O=Sa?O.i4a(Sa,this.Q8c.DdaBindingsMethod.BindingId):null;(null===O||void 0===O?0:O.IsValidRef)?(Sa=new Fg.Range(O.Reference.FirstRow+1,O.Reference.FirstColumn+1,O.Reference.LastRow+1,O.Reference.LastColumn+1,!1,!1),this.Gqb.value=O.Reference.SheetName+
"!"+Sa):(O=Cg.h(this.$).ha,this.Gqb.value=Fh.f(this.$.na)||!O.ra.Pg?"":O.Nia);this.initialize();this.vg()}wq(){this.t3c();this.addButton(0);this.addButton(1);super.wq()}setFocus(){Pf.DOMElementExtensions.setFocus(this.Gqb)}validate(){return!0}commit(){let O=this.Gqb.value.trim();const Sa=O.indexOf("!");-1!==Sa&&(O=this.c3h(O.substring(0,Sa))+O.substr(Sa));this.ALe.addBinding(this.Q8c,O,0,this.callback);return!0}fta(){this.ALe.IQ.qf(cf.a.internalError,this.callback);super.fta()}c3h(O){O=yh.a.trimStart(O.trim(),
"=");return O.length?O.startsWith("'")&&O.endsWith("'")?O:Uh.HelperMethods.x$b(O):""}}Object(d.a)(Tf,"DdaBindingPrompt",ff.a,[]);class gg{constructor(O){this.ea=O}qf(O,Sa){if(Sa){const Hb={};Hb.Error=O;Hb.Version=this.ea.ye;Sa(Hb)}}WKa(O,Sa){this.qf(O,Sa)}LH(O,Sa){this.qf(cf.a.Z_e(O.Errors[0].MessageId),Sa)}Cv(O){O&&O(this.tQ())}tQ(){const O={Error:0};O.Version=this.ea.ye;return O}}Object(d.a)(gg,"DdaErrorGenerator",null,[]);var Df=a(283);class Lf{constructor(O,Sa,Hb){this.$=O;this.IQ=Sa;this.rA=
Hb}kBd(O,Sa){const Hb=O.DdaGoToByIdMethod.GoToType,hc=O.DdaGoToByIdMethod.SelectionMode,wc=O.DdaGoToByIdMethod.Id.toString().trim(),ad=kd=>{const od=this.$.va.getItemByName(kd.SheetName);(null===od||void 0===od?0:od.visible)?(Cg.h(this.$).gg(kd,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.IQ.Cv(Sa)):this.IQ.qf(cf.a.Q1g,Sa)};0===Hb?this.AJi(wc,hc,O.DdaMethod.ControlId,ad,Sa):1===Hb?this.EJi(wc,hc,ad,Sa):this.IQ.qf(cf.a.DXj,Sa)}AJi(O,Sa,Hb,hc,wc){this.rA.ddaGetBinding(Hb,
O,ad=>{if(!Df.a(ad)&&ad.Result&&ad.Result.Reference){ad=ad.Result;var kd={};kd.SheetName=ad.Reference.SheetName;kd.FirstRow=ad.Reference.FirstRow;kd.FirstColumn=ad.Reference.FirstColumn;kd.LastRow=ad.Reference.LastRow;kd.LastColumn=ad.Reference.LastColumn;Lf.cZc(kd,Sa);1!==ad.BindingType?hc(kd):this.rA.ddaGetBindingData(Hb,O,1,0,2,0,0,-1,-1,od=>{Df.a(od)||!od.Result?this.IQ.LH(od,wc):(od=od.Result,2!==Sa&&(kd.FirstRow-=od.Headers.length,0>kd.FirstRow&&(kd.FirstRow=0)),hc(kd))},wc)}else this.IQ.WKa(cf.a.jbg,
wc)},wc)}EJi(O,Sa,Hb,hc){var wc=eg.z(O);wc?(wc=eg.v(wc,this.$),Lf.cZc(wc,Sa),Hb(wc)):this.$.ea.isNamedObjectViewMode&&this.$.Cb.Rk(O)?this.$.Cb.na=this.$.Cb.getItemByName(O):(wc=ad=>{Df.a(ad)||!ad.Result?this.$.va.contains(O)?(ad={},ad.SheetName=O,ad.FirstRow=0,ad.FirstColumn=0,ad.LastRow=0,ad.LastColumn=0,Hb(ad)):this.IQ.WKa(cf.a.jbg,hc):(ad=ad.Result,Lf.cZc(ad,Sa),Hb(ad))},this.$.va.na?this.rA.parseRangeForGoto(O,this.$.va.na.name,wc,hc):this.rA.parseRange(O,wc,hc))}static cZc(O,Sa){O.LastRow=2===
Sa?O.FirstRow:O.LastRow;O.LastColumn=2===Sa?O.FirstColumn:O.LastColumn}}Object(d.a)(Lf,"DdaNavigator",null,[]);const Qf=(O,Sa,Hb,hc,wc,ad)=>{const kd=O.Oa(1);kd.request=Sa;return Ag.g(O,"ExecuteRichApiRequest",kd,Hb,hc,wc,ad,0)};var rg=a(296),Wg;(function(O){O[O.unsupported=0]="unsupported";O[O.surface=1]="surface";O[O.combo=2]="combo";O[O.column=3]="column";O[O.column3D=4]="column3D";O[O.bar=5]="bar";O[O.bar3D=6]="bar3D";O[O.line=7]="line";O[O.line3D=8]="line3D";O[O.pie=9]="pie";O[O.pie3D=10]="pie3D";
O[O.scatter=11]="scatter";O[O.bubble=12]="bubble";O[O.area=13]="area";O[O.area3D=14]="area3D";O[O.doughnut=15]="doughnut";O[O.radar=16]="radar";O[O.stock=17]="stock";O[O.waterfall=18]="waterfall";O[O.funnel=19]="funnel";O[O.treemap=20]="treemap";O[O.sunburst=21]="sunburst";O[O.boxWhisker=22]="boxWhisker";O[O.histogram=23]="histogram";O[O.pareto=24]="pareto";O[O.regionMap=25]="regionMap";O[O.noVisibleSeries=26]="noVisibleSeries";O[O.complexDataSource=27]="complexDataSource";O[O.pivotChart=28]="pivotChart"})(Wg||
(Wg={}));Object(d.b)("ChartCategory",Wg);class Xf{constructor(O,Sa){this.source=O;this.eventId=Sa}}Object(d.a)(Xf,"MacroRecorderEventData",null,[]);class ch{constructor(O,Sa,Hb){this.parentName=O;this.$=Sa;this.request=Hb}u1h(O){var Sa;if(void 0===O||null===O||void 0===O.RequestBody||null===O.RequestBody)return null;const Hb=JSON.parse(O.RequestBody);if(void 0!==O.ActiveChartId&&null!==O.ActiveChartId){Hb.ActiveChartId=O.ActiveChartId;const hc=Cg.h(this.$).ha.Ta.$b;if(null===(Sa=null===hc||void 0===
hc?void 0:hc.floatingObject)||void 0===Sa?0:Sa.Vc)Hb.ActiveChartType=Wg[hc.floatingObject.Vc.ChartCategory]}void 0!==O.SheetMultiRange&&null!==O.SheetMultiRange&&(Hb.SheetName=O.SheetMultiRange.SheetName);return Hb}J1h(O){if(void 0===O||null===O||void 0===O.Result||null===O.Result)return null;O=O.Result;return void 0===O.ResponseBody||null===O.ResponseBody||O.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(O.ResponseBody.join(""))}jsi(O){return!!O&&!(void 0===O.eventId||null===O.eventId)&&
0<O.eventId.length}ik(O){return()=>{if(this.$.Zba){const Sa=this.eZg(this.request);if(this.jsi(Sa)){const Hb=this.u1h(this.request),hc=this.J1h(O);if(Hb&&!Ph.a.isEmpty(Hb)&&hc&&!Ph.a.isEmpty(hc))return n.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Y(Sa,Hb,hc);n.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Hb?"(not null)":"(null)"}; responseInfo: ${hc?"(not null)":"(null)"}`}`)}}return new Y(null,
null,null)}}eZg(O){const Sa=this.ksi(O.SolutionId),Hb=ch.a1h(O);if(Hb&&Sa)return n.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Hb,["request.SolutionId"]:O.SolutionId})}`),new Xf(O.SolutionId,Hb);O=JSON.stringify({["recorderEventId"]:Hb,["isRecorderAwareAddin"]:Sa,["request.SolutionId"]:O.SolutionId});n.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${O}`);return null}ksi(O){if(!O)return!1;O=O.toLowerCase();return ch.Y6h().contains(O)}static Y6h(){ch.tAa||
(ch.tAa=new u.a(P.a.ak()),ch.tAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ch.tAa.add("fa000000005"),ch.tAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ch.tAa.add("fa000000014"),ch.tAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return ch.tAa}static a1h(O){let Sa=null;var Hb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Hb.test(O.RequestBody))Sa=Hb.exec(O.RequestBody)[1];else{O=O.RequestHeaders;if(!O)return Sa;Hb=tf.a.fMi.toLowerCase();for(let hc=0;hc<O.length;hc++)if(O[hc].Name.toLowerCase()===
Hb){Sa=O[hc].Value;break}}return Sa}}ch.tAa=null;Object(d.a)(ch,"DdaRichApiRequestRecorder",null,[]);class Fi extends rg.a{constructor(O,Sa,Hb,hc,wc,ad,kd,od){super(10,0,Sa,od);this.tnb=Hb;this.Ljb=hc;this.d4=wc;this.jGa=ad;this.request=kd;this.$Pd=new ch("10",O,kd)}get BFc(){return this.jGa}get Zt(){return this.tnb}get Naa(){return this.Ljb}r3(O){return super.r3(O)||this.K0g(O)}ik(){return this.$Pd.ik(this.od)}kgb(){const O={OperationType:3};O.RichApiRequest=this.request;return O}K0g(O){return(Sa,
Hb,hc)=>Qf(O,this.request,Kf.b(Sa,this.tnb),Kf.a(Hb,this.Ljb),hc,this.d4)}}Object(d.a)(Fi,"DdaRichApiRequestBatchOperation",rg.a,[]);class Pi extends Qh.a{constructor(O,Sa,Hb,hc){super(576,0,Hb,hc);this.$Pd=new ch("576",O,Sa)}ik(){return this.$Pd.ik(this.od)}}Object(d.a)(Pi,"DdaRichApiRequestOperation",Qh.a,[]);class Gi{constructor(O,Sa){this.BI=(Hb,hc)=>{this.IQ.WKa(cf.a.internalError,hc)};this.$=O;this.IQ=Sa}ddaAddBinding(O,Sa,Hb,hc,wc,ad,kd){this.jK((od,Dd,Pd)=>{var Se=this.$.pa.xa,Ue=this.aka();
od=Kf.b(od,ad);Dd=Kf.a(Dd,this.BI);const lf=Se.Oa(9);lf.controlId=O;lf.bindingId=Sa;lf.bindingType=Hb;lf.currentSheetName=Ue;lf.formula=hc;lf.options=wc;return Ag.g(Se,"DdaAddBinding",lf,od,Dd,Pd,kd,0)},kd,563)}ddaReleaseBinding(O,Sa,Hb,hc){this.jK((wc,ad,kd)=>{var od=this.$.pa.xa;wc=Kf.b(wc,Hb);ad=Kf.a(ad,this.BI);const Dd=od.Oa(9);Dd.controlId=O;Dd.bindingId=Sa;return Ag.g(od,"DdaReleaseBinding",Dd,wc,ad,kd,hc,0)},hc,564)}ddaGetBinding(O,Sa,Hb,hc){this.jK((wc,ad,kd)=>{var od=this.$.pa.xa;wc=Kf.b(wc,
Hb);ad=Kf.a(ad,this.BI);const Dd=od.Oa(1);Dd.controlId=O;Dd.bindingId=Sa;return Ag.g(od,"DdaGetBinding",Dd,wc,ad,kd,hc,0)},hc,565,16)}ddaGetAllBindings(O,Sa,Hb){this.jK((hc,wc,ad)=>{var kd=this.$.pa.xa;hc=Kf.b(hc,Sa);wc=Kf.a(wc,this.BI);const od=kd.Oa(1);od.controlId=O;return Ag.g(kd,"DdaGetAllBindings",od,hc,wc,ad,Hb,0)},Hb,566,16)}ddaGetBindingData(O,Sa,Hb,hc,wc,ad,kd,od,Dd,Pd,Se){this.jK((Ue,lf,zg)=>{var jg=this.$.pa.xa,Zf=this.aka();Ue=Kf.b(Ue,Pd);lf=Kf.a(lf,this.BI);const ag=jg.Oa(1);ag.controlId=
O;ag.bindingId=Sa;ag.coerceType=Hb;ag.valueFormat=hc;ag.filterType=wc;ag.startRow=ad;ag.startCol=kd;ag.rowCount=od;ag.colCount=Dd;ag.currentSheetName=Zf;return Ag.g(jg,"DdaGetBindingData",ag,Ue,lf,zg,Se,0)},Se,567,16)}ddaSetBindingData(O,Sa,Hb,hc,wc,ad,kd){this.jK((od,Dd,Pd)=>{var Se=this.$.pa.xa,Ue=this.aka();od=Kf.b(od,ad);Dd=Kf.a(Dd,this.BI);const lf=Se.Oa(9);lf.controlId=O;lf.bindingId=Sa;lf.startRow=Hb;lf.startCol=hc;lf.currentSheetName=Ue;lf.bindingData=wc;return Ag.g(Se,"DdaSetBindingData",
lf,od,Dd,Pd,kd,0)},kd,568)}ddaGetSelectedData(O,Sa,Hb,hc,wc,ad,kd){this.jK((od,Dd,Pd)=>{var Se=this.$.pa.xa,Ue=this.aka();od=Kf.b(od,ad);Dd=Kf.a(Dd,this.BI);const lf=Se.Oa(1);lf.controlId=O;lf.coerceType=Sa;lf.valueFormat=Hb;lf.filterType=hc;lf.currentSheetName=Ue;lf.formula=wc;return Ag.g(Se,"DdaGetSelectedData",lf,od,Dd,Pd,kd,0)},kd,569,16)}ddaSetSelectedData(O,Sa,Hb,hc,wc){this.jK((ad,kd,od)=>{var Dd=this.$.pa.xa,Pd=this.aka();ad=Kf.b(ad,hc);kd=Kf.a(kd,this.BI);const Se=Dd.Oa(9);Se.controlId=O;
Se.currentSheetName=Pd;Se.formula=Sa;Se.bindingData=Hb;return Ag.g(Dd,"DdaSetSelectedData",Se,ad,kd,od,wc,0)},wc,570)}ddaLoadSettings(O,Sa,Hb){this.jK((hc,wc,ad)=>{var kd=this.$.pa.xa;hc=Kf.b(hc,Sa);wc=Kf.a(wc,this.BI);const od=kd.Oa(1);od.controlId=O;return Ag.g(kd,"DdaLoadSettings",od,hc,wc,ad,Hb,0)},Hb,501,16)}ddaSaveSettings(O,Sa,Hb,hc,wc){this.jK((ad,kd,od)=>{var Dd=this.$.pa.xa;ad=Kf.b(ad,hc);kd=Kf.a(kd,this.BI);const Pd=Dd.Oa(9);Pd.controlId=O;Pd.settings=Sa;Pd.overwriteIfStale=Hb;return Ag.g(Dd,
"DdaSaveSettings",Pd,ad,kd,od,wc,0)},wc,571)}ddaAddRowsColumns(O,Sa,Hb,hc,wc,ad){this.jK((kd,od,Dd)=>{var Pd=this.$.pa.xa,Se=this.aka();kd=Kf.b(kd,wc);od=Kf.a(od,this.BI);const Ue=Pd.Oa(9);Ue.controlId=O;Ue.bindingId=Sa;Ue.isRow=Hb;Ue.currentSheetName=Se;Ue.bindingData=hc;return Ag.g(Pd,"DdaAddRowsColumns",Ue,kd,od,Dd,ad,0)},ad,572)}ddaDeleteAllDataValues(O,Sa,Hb,hc){this.jK((wc,ad,kd)=>{var od=this.$.pa.xa,Dd=this.aka();wc=Kf.b(wc,Hb);ad=Kf.a(ad,this.BI);const Pd=od.Oa(9);Pd.controlId=O;Pd.bindingId=
Sa;Pd.currentSheetName=Dd;return Ag.g(od,"DdaDeleteAllDataValues",Pd,wc,ad,kd,hc,0)},hc,573)}ddaClearBindingFormats(O,Sa,Hb,hc){this.jK((wc,ad,kd)=>{var od=this.$.pa.xa,Dd=this.aka();wc=Kf.b(wc,Hb);ad=Kf.a(ad,this.BI);const Pd=od.Oa(9);Pd.controlId=O;Pd.bindingId=Sa;Pd.currentSheetName=Dd;return Ag.g(od,"DdaClearBindingFormats",Pd,wc,ad,kd,hc,0)},hc,574)}ddaSetBindingFormats(O,Sa,Hb,hc,wc,ad){this.jK((kd,od,Dd)=>{var Pd=this.$.pa.xa,Se=this.aka();kd=Kf.b(kd,wc);od=Kf.a(od,this.BI);const Ue=Pd.Oa(9);
Ue.controlId=O;Ue.bindingId=Sa;Ue.currentSheetName=Se;Ue.bindingData=Hb;Ue.isSetFormats=hc;return Ag.g(Pd,"DdaSetBindingFormats",Ue,kd,od,Dd,ad,0)},ad,575)}parseRange(O,Sa,Hb){this.jK((hc,wc,ad)=>{const kd=this.$.pa.xa.Wb();return Ag.v(this.$.pa.xa,O,-1,Kf.b(hc,Sa),Kf.a(wc,this.BI),ad,Hb,kd)},Hb,162,16)}parseRangeForGoto(O,Sa,Hb,hc){this.jK((wc,ad,kd)=>{const od=this.$.pa.xa.Wb();return Ag.w(this.$.pa.xa,O,Sa,Kf.b(wc,Hb),Kf.a(ad,this.BI),kd,hc,od)},hc,562,16)}executeRichApiRequest(O,Sa,Hb){A.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(O.RequestFlags&=8191);if(A.EwaSettings.oa(247))this.pEh(this.$.pa.xa.Wb(),Sa,()=>{this.IQ.WKa(cf.a.internalError,Hb)},Hb,O);else{let hc=ig.DdaFacade.ajd(O);!A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.Mv||hc&16?(hc|=64,this.$.userOperationManager.oD(new Pi(this.$,O,(wc,ad,kd)=>Qf(this.$.pa.xa,O,Kf.b(wc,Sa),Kf.a(ad,this.BI),kd,Hb),hc))):(this.IQ.WKa(cf.a.AGc,Hb),n.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}aka(){return this.$.ea.isNamedObjectViewMode?
this.$.na.sheetName:this.$.activeItemName}jK(O,Sa,Hb,hc=0){!A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.Mv||hc&16?this.$.userOperationManager.oD(new Qh.a(Hb,0,O,hc|64)):(this.IQ.WKa(cf.a.AGc,Sa),n.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}pEh(O,Sa,Hb,hc,wc){let ad=ig.DdaFacade.ajd(wc);if(!A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.Mv||ad&16){var kd=this.$.Kb.Cc("UserAction",
"Rich Api request");this.$.userOperationManager.Ic(new Fi(this.$,O,Sa,Hb,hc,kd,wc,ad|64),null)}else this.IQ.WKa(cf.a.AGc,hc),n.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(d.a)(Gi,"DdaWebServiceHelper",null,[]);class yg{constructor(O,Sa,Hb,hc){this.TFh=O;this.fileSize=Sa;this.bKj=hc}}Object(d.a)(yg,"DocumentFile",null,[]);class ug{}ug.generalException="GeneralException";ug.ERg="ApiNotFound";ug.iGd="OperationCancelled";ug.invalidArgument="InvalidArgument";Object(d.a)(ug,
"ErrorCodes",null,[]);class Zg{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(d.a)(Zg,"WacApiDelegates",null,[]);var dg=a(616);class Gg extends Zg{constructor(O,Sa){super();this.qnf=(Hb,hc)=>{Hb=Gg.J$g(Hb,hc);if(!dg.a(this.$,Hb))return!0;Hb=this.$.shortcutKeyManager.I8e(Hb);return!!Hb&&
0<Hb.length};this.addinId=O;this.$=Sa}replaceShortcuts(O){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,O,this.qnf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(O){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(O,this.qnf)}static meh(O,Sa){const Hb=document.createEvent("KeyboardEvent");if(ed.a.SF)Hb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(O&8),!!(O&32),!!(O&4),!!(O&256));else{const hc=
[];O&4&&hc.push("Shift");O&8&&hc.push("Control");O&32&&hc.push("Alt");Hb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,hc.join(" "),!1,"en-US")}O=new Sys.UI.DomEvent(Hb);O.keyCode=Sa;return O}static J$g(O,Sa){if(ed.a.Jf)switch(Sa){case 189:Sa=173;break;case 187:Sa=61;break;case 186:Sa=59}return Gg.meh(O,Sa)}}Object(d.a)(Gg,"ExcelWacApiDelegates",Zg,[]);class Bg{constructor(O){this.HJa={};this.uGi=O}UIg(O,Sa){this.Gfc(O)||(this.HJa[O]={});if(this.lni(O))return n.ULS.sendTraceTag(537163157,344,
50,`App ${O} has reach the limit of number of cached files.`),cf.a.dHi;this.HJa[O][Sa.TFh.toString()]=Sa;return cf.a.success}ITh(O,Sa){let Hb=null;this.Gfc(O)&&(Hb=this.HJa[O][Sa.toString()]);Hb||n.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${O}, fileHandler:${Sa}] doesn't exist`);return Hb}Gfc(O){return O in this.HJa}$fj(O,Sa){if(this.Gfc(O)){const Hb=this.HJa[O];delete Hb[Sa.toString()];1>Object.keys(Hb).length&&delete this.HJa[O];return Sa.toString()in Hb?cf.a.internalError:cf.a.success}return cf.a.internalError}lni(O){return this.Gfc(O)?
Object.keys(this.HJa[O]).length>=this.uGi:!1}static getInstance(O){return O.da.Aa(200)||O.da.Ga(200,new Bg(Bg.vGi))}static mKi(){return++Bg.a0g}}Bg.ZFi=4194304;Bg.vGi=1;Bg.a0g=0;Object(d.a)(Bg,"GetFileApiHelper",null,[]);class xh{constructor(O){this.HA=O}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.HA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.SKi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){O=this.invokeMethod(O,
Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}SKi(){this.notifyActionHandlerReady();return null}}Object(d.a)(xh,"AddinInternalService",null,[]);class Gh{constructor(O,Sa){this.qJ=Sa;this.HA=O}getAppRuntimeState(){return this.qJ.getAppRuntimeState(this.HA)?2:1}setAppRuntimeState(O){switch(O){case 2:O=!0;break;case 1:O=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.invalidArgument,pf.a.ga(1760));}this.qJ.setAppRuntimeState(this.HA,O)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,Sa){switch(O){case 2:return this.OOh();case 1:return this.Qvj(Sa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,
Sa){O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}OOh(){return this.getAppRuntimeState()}Qvj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"int");this.setAppRuntimeState(O);return null}}Object(d.a)(Gh,"AppRuntimeService",null,[]);var Th=a(970);class aj{constructor(O,Sa,Hb,hc){this.Ex=O;this.f2=Hb;this.ez=hc.Ph.getOsfControl(Sa)}disable(){try{if(!pf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.rIe();
if(!this.Mmf())return this.sIe();this.f2.IWj(this.Ex)}catch(O){return n.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",O.message||"Unknown"),this.pIe()}return null}enable(){try{if(!pf.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.rIe();if(!this.Mmf())return this.sIe();this.f2.Ydj(this.Ex)}catch(O){return n.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
O.message||"Unknown"),this.pIe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,
Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){switch(O){case 1:return this.lDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 3:return this.wnh();case 2:return this.lsh()}O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}wnh(){return this.disable()}lsh(){return this.enable()}lDa(){this._OnAccess();return null}rIe(){return Th.a(fg.a.notImplemented,
pf.a.ga(1761))}sIe(){return Th.a(fg.a.sharedRuntimeNotAvailable,pf.a.ga(1765))}pIe(){return Th.a(fg.a.generalException,pf.a.ga(1756))}Mmf(){const O=this.ez.getSharedRuntimeId();return!!O&&0<O.length}}Object(d.a)(aj,"BeforeDocumentCloseNotification",null,[]);class bj{constructor(){this.pme=this.xge=this.EA=!1}get enabled(){return this.EA}set enabled(O){this.EA=O}get nativeRuntime(){return this.xge}set nativeRuntime(O){this.xge=O}get streamingEnabled(){return this.pme}set streamingEnabled(O){this.pme=
O}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(O){switch(O){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O,Sa){switch(O){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Sa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Sa){O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}}Object(d.a)(bj,"CustomFunctionEngineStatus",null,[]);class Xi{constructor(O,Sa,Hb){this.Hyg=O;this.Iyg=Sa;this.BCg=Hb}get status(){const O=new bj;O.enabled=this.Hyg;O.streamingEnabled=this.Iyg;O.nativeRuntime=!1;return O}register(O){return OfficeExtension.WacRuntime.Utility.createPromise(this.BCg(O))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(O){switch(O){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 1:return this.Mej(Sa)}O=this.invokeMethod(O,
Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}Mej(O){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"string");return this.register(Sa,O)}}Object(d.a)(Xi,"CustomFunctionManager",null,[]);var jj=a(947);class cj{constructor(O,Sa,Hb,hc){this.v7d="";this.KUb=0;this.AP=O;this._id=Sa;this.HA=Hb;this.qJ=hc}get id(){return this._id}_RegisterStateChange(){this.KUb||this.AP.execute(O=>
{this.v7d=O.qna(this._id,Sa=>{this.qJ.YHh(this.HA,this._id,JSON.stringify(Sa))})});this.KUb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.KUb--;this.KUb||this.AP.execute(O=>{O.zMd(this._id,this.v7d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(O){switch(O){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 6:return this.isg();case 7:return this.ksg()}O=
this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}isg(){return this._RegisterStateChange()}ksg(){return this._UnregisterStateChange()}}Object(d.a)(cj,"LicenseFeature",null,[]);class dj{constructor(O,Sa){this.AP=Hc.a.instance.Rb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.HA=O;this.qJ=Sa;this.sBg=this.qJ.Ph.getOsfControl(this.HA)}getFeatureTier(O,Sa){return OfficeExtension.WacRuntime.Utility.createPromise(Hb=>{const hc=1===Sa?1:2===
Sa?2:0;this.AP.execute(wc=>{wc.getFeatureTier(O,hc).then(ad=>{Hb(this.XXh(ad))},()=>{Hb(Sa)})})})}getLicenseFeature(O){O=new cj(this.AP,O,this.HA,this.qJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}isFeatureEnabled(O,Sa){return OfficeExtension.WacRuntime.Utility.createPromise(Hb=>{this.AP.execute(hc=>{hc.isFeatureEnabled(O,Sa).then(wc=>{Hb(wc)},()=>{Hb(Sa)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(O=>{this.AP.execute(Sa=>{Sa=
Sa.isFreemiumUpsellEnabled();O(Sa)})})}launchUpsellExperience(O){if(this.sBg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.AP.execute(Sa=>{Sa.launchUpsellExperience(O)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.sWc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O,Sa){switch(O){case 6:return this.jsg(Sa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 2:return this.BUh(Sa);case 5:return this.WXh(Sa);
case 1:return this.Yni(Sa);case 3:return this.Ioi();case 4:return this.Byi(Sa)}O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}BUh(O){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"int");return this.getFeatureTier(Sa,O)}WXh(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getLicenseFeature(O)}Yni(O){const Sa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,
0,"string");O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,1,"boolean");return this.isFeatureEnabled(Sa,O)}Ioi(){return this.isFreemiumUpsellEnabled()}Byi(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.launchUpsellExperience(O)}jsg(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");this._TestFireStateChangedEvent(O);return null}XXh(O){switch(O){case 1:return 1;case 2:return 2;default:return 0}}}Object(d.a)(dj,"License",
null,[]);var kj=a(153);const ej=(O,Sa,Hb)=>hc=>(wc,ad)=>{Yf.TaskExtensions.za(sg.GetServiceTaskFactory.create(Sa.da,279,Sa.ka,1),kd=>{kd=kd.result;let od=!1;var Dd=Hb.Ph.getOsfControl(O);let Pd=null;Dd&&(Pd=Dd.getStoreType(),(Dd=Dd.getManifest())&&Dd.getSharedRuntimeForCustomFunctions("Workbook")&&(od=!0));Yf.TaskExtensions.za(kd.Egf(O,Pd,hc,od),Se=>{kj.b(Se)?Se.result?wc(null):ad(OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.invalidArgument,vc.a.instance.ga(1760))):ad(OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.generalException,
vc.a.instance.ga(1756)))},Sa.ka,3)},Sa.ka,3)};class Yi{constructor(O){if(!O)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.ozd=O}areShortcutsInUse(O){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,Hb)=>{this.ozd.checkShortcutsInUse(O).then(hc=>{Sa(hc)}).catch(hc=>{Hb(hc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((O,Sa)=>{this.ozd.getShortcuts().then(Hb=>{O(Hb)}).catch(Hb=>{Sa(Hb)})})}replaceShortcuts(O){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,
Hb)=>{this.ozd.replaceShortcuts(O).then(()=>{Sa(null)}).catch(hc=>{Hb(hc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokeMethodAsync(O,Sa){switch(O){case 3:return this.nTg(Sa);case 1:return this.h3h();case 2:return this.ylj(Sa)}O=this.invokeMethod(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}nTg(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"Array<string>");return this.areShortcutsInUse(O)}h3h(){return this.getShortcuts()}ylj(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"any");return this.replaceShortcuts(O)}}Object(d.a)(Yi,"ActionService",
null,[]);var lj=a(520);class fj{constructor(){this.Rra=null}V2h(){this.Rra||(this.Rra=lj.a.xq(Hc.a.instance.Rb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Rra}getSharedFilePickerResponse(O){return OfficeExtension.WacRuntime.Utility.createPromise((Sa,Hb)=>{try{const hc=this.V2h();mh.Task.WAA.call(null,hc).continueWith(()=>{const wc=hc.result;if(wc){let ad={};({Gt:ad}=wf.d(O)).returnValue?wc.Chd(ad).then(kd=>{kd&&0<kd.length?Sa(kd):Hb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(kd=>{Hb(kd)}):Hb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Hb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(hc){Hb(hc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);
}invokePropertyGetAsync(O){O=this.invokePropertyGet(O);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}invokePropertySet(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokePropertySetAsync(O,Sa){this.invokePropertySet(O,Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(O){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(O);}invokeMethodAsync(O,Sa){switch(O){case 1:return this.U2h(Sa)}O=this.invokeMethod(O,
Sa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(O)}U2h(O){O=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(O,0,"string");return this.getSharedFilePickerResponse(O)}}Object(d.a)(fj,"SharedFilePicker",null,[]);class gj{createInstance(O,Sa){switch(O){case "Microsoft.Office.ActionService":return new Yi(Sa);case "Microsoft.Office.SharedFilePicker":return new fj}return null}}Object(d.a)(gj,"WacApiHost",null,[]);class hj{constructor(O,Sa,Hb,hc,wc){this.YVc=null;this.USb=
O;this.HA=Sa;this.qJ=Hb;this.jb=hc;this.BGg=wc}hostName(){return"ExcelOnline"}appId(){return this.USb}createInstance(O){switch(O){case "Microsoft.Authentication.AuthenticationService":return Hc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.HA,this.qJ.Ph);case "Microsoft.Authentication.TokenParameters":return new Va;case "Microsoft.ExcelServices.CustomFunctionManager":O=this.jb.oa(119);var Sa=this.jb.oa(120);return new Xi(O,Sa,ej(this.USb,
this.jb,this.qJ));case "Microsoft.AppRuntime.AppRuntimeService":return new Gh(this.HA,this.qJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return O=Wf.a(this.jb),new aj(this.USb,this.HA,O,this.qJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return O=Wf.a(this.jb),new jj.DynamicRibbon(this.USb,this.HA,this.qJ,O,O.yn(this.HA).yl);case "Microsoft.Office.Licensing.License":return new dj(this.HA,this.qJ);case "Microsoft.InternalService.AddinInternalService":return new xh(this.HA);
default:if(this.YVc||(this.YVc=new gj),Sa=this.YVc.createInstance(O,this.BGg))return Sa}n.ULS.sendTraceTag(537163155,0,10,`Typename: ${O} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(fg.a.generalException,fg.a.generalException);}}Object(d.a)(hj,"RichApiHost",null,[]);var mj=a(384),ij=a(28),nj=a(118),Zi=a(35),oj=a(100),pj=a(286),qj=a(44),rj=a(251),sj=a(6),tj=a(70),uj=a(201);class Bf{constructor(O,Sa,Hb,hc){this.htmlSanitizationHelper=
this.rangePicker=null;this.$=O;this.Xd=Sa;this.htmlSanitizationHelper=hc;this.xe=new gg(O.ea);this.rA=new Gi(O,this.xe);this.oyf=Hb;this.Gac=new Map}get IQ(){return this.xe}dispose(){this.$=this.Gac=null}nc(){return!1}Lc(){return!1}executeCommand(O,Sa,Hb){O=Sa.command;switch(O){case 451041795:this.xe.qf(Hb[Rg.a.ng],Hb[Rg.a.d4]);break;case 974713501:this.v9h(Hb[Rg.a.ng],Hb[Rg.a.d4]);break;case 1237877382:this.xe.Cv(Hb[Rg.a.d4]);break;default:return oi.a(O)}return mh.Task.Ra(!0)}yc(O,Sa,Hb){if(O=!!Hb)switch(Sa.command){case 974713501:case 1237877382:case 451041795:break;
default:O=!1}return O}v9h(O,Sa){var Hb,hc;const wc=O.DdaMethod;"undefined"===typeof wc.DispatchId?this.xe.qf(cf.a.internalError,Sa):Bf.cni(O)||this.$.qd&1?(wc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Tf(this.$,this,O,Sa,this.htmlSanitizationHelper)).start(this.Xd,O.DdaMethod.ControlId):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.u2h(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.rAj(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(O,this.Xgd(O.DdaMethod.ControlId),0,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.sPh(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.bwj(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.rPh(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Zfj(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.sOh(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.oxd(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(O.DdaAddRowsColumns.IsRow=!0,this.bre(O,Sa)):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(O.DdaAddRowsColumns.IsRow=!1,this.bre(O,Sa)):wc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.ilh(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.J4g(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(O.DdaSetBindingFormats.IsSetFormats=!0,this.l4f(O,Sa)):wc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(O.DdaSetBindingFormats.IsSetFormats=!1,this.l4f(O,Sa)):wc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(O,O.DdaBindingsMethod.ItemName,O.DdaBindingsMethod.FailOnCollision?2:1,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.FUh(Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.kBd(O,Sa):wc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.FTh(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.GTh(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.agj(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(O.DdaMethod.ControlId,O),this.xe.Cv(Sa)):
wc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?A.EwaSettings.oa(23)?this.xe.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sa):this.zHi(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?A.EwaSettings.oa(23)?this.xe.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sa):this.vHi(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(O,Sa):wc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(O,Sa):this.xe.qf(cf.a.mGd,Sa),A.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&wc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(O=this.Xd.XZ(O.DdaMethod.ControlId),Sa="",O&&(Sa=ig.DdaFacade.getSolutionId(O,this.$),A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?Sa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,O.OwnerAddinStoreType||O.PrimaryMarketplace.MarketplaceType,null===
(Hb=O.AssetMarketplace)||void 0===Hb?void 0:Hb.SolutionId,null,null,O.PrimaryMarketplace.MarketplaceRef):(Hb=O.PrimaryMarketplace.MarketplaceType,Hb===OSF.StoreType.InMemory?O.OwnerAddinSolutionId&&O.AssetMarketplace&&(Hb=O.AssetMarketplace.MarketplaceType):Hb===OSF.StoreType.WopiCatalog&&(Hb=OSF.StoreType.OMEX),Sa=Telemetry.PrivacyRules.GetPrivacyCompliantId(Sa,Hb,null===(hc=O.AssetMarketplace)||void 0===hc?void 0:hc.SolutionId,null,null,O.PrimaryMarketplace.MarketplaceRef))),n.ULS.sendTraceTag(537163224,
344,50,`DDA method Id: ${wc.DispatchId}, AppID: ${Sa}`))):this.xe.qf(cf.a.xOe,Sa)}sPh(O,Sa){O.DdaGetBindingData.CoerceType=Bf.k5b(O.DdaGetBindingData.CoerceType);O.DdaGetBindingData.FilterType=Bf.MYe(O.DdaGetBindingData.FilterType);O.DdaGetBindingData.ValueFormat=Bf.xmg(O.DdaGetBindingData.ValueFormat);if(this.alc(O.DdaGetBindingData.CoerceType,Sa)){if(O.DdaGetBindingData){const Hb=O.DdaGetBindingData;0===Hb.FilterType&&(Hb.FilterType=2);Hb.StartCol|=0;Hb.StartRow|=0;Hb.ColCount=void 0===Hb.ColCount?
-1:Hb.ColCount;Hb.RowCount=void 0===Hb.RowCount?-1:Hb.RowCount}this.rA.ddaGetBindingData(O.DdaMethod.ControlId,O.DdaGetBindingData.BindingId,O.DdaGetBindingData.CoerceType,O.DdaGetBindingData.ValueFormat,O.DdaGetBindingData.FilterType,O.DdaGetBindingData.StartRow,O.DdaGetBindingData.StartCol,O.DdaGetBindingData.RowCount,O.DdaGetBindingData.ColCount,Hb=>{if(Df.a(Hb)||!Hb.Result)this.xe.LH(Hb,Sa);else{const hc=this.xe.tQ();hc.Data=Bf.Gze(Hb.Result);Sa(hc)}},Sa)}}bwj(O,Sa){O.DdaSetBindingData.CoerceType=
Bf.k5b(O.DdaSetBindingData.CoerceType);if(this.alc(O.DdaSetBindingData.CoerceType,Sa)){var Hb=Bf.W0c(O.DdaSetBindingData.CoerceType,O.DdaSetBindingData.Data);Bf.Vhc(Hb)?this.xe.qf(cf.a.mEc,Sa):(1===Hb.CoerceType&&(Hb.CellFormat||(Hb.CellFormat=O.DdaSetBindingData.CellFormat),Hb.TableOptions||(Hb.TableOptions=O.DdaSetBindingData.TableOptions)),O.DdaSetBindingData&&(O.DdaSetBindingData.StartCol|=0,O.DdaSetBindingData.StartRow|=0),this.rA.ddaSetBindingData(O.DdaMethod.ControlId,O.DdaSetBindingData.BindingId,
O.DdaSetBindingData.StartRow,O.DdaSetBindingData.StartCol,Hb,hc=>{Df.a(hc)?this.xe.LH(hc,Sa):this.xe.Cv(Sa)},Sa))}}u2h(O,Sa){O.DdaGetBindingData.CoerceType=Bf.k5b(O.DdaGetBindingData.CoerceType);O.DdaGetBindingData.ValueFormat=Bf.xmg(O.DdaGetBindingData.ValueFormat);O.DdaGetBindingData.FilterType=Bf.MYe(O.DdaGetBindingData.FilterType);if(this.alc(O.DdaGetBindingData.CoerceType,Sa)){var Hb=this.Xgd(O.DdaMethod.ControlId);Hb?this.rA.ddaGetSelectedData(O.DdaMethod.ControlId,O.DdaGetBindingData.CoerceType,
O.DdaGetBindingData.ValueFormat,O.DdaGetBindingData.FilterType,Hb,hc=>{if(Df.a(hc))this.xe.LH(hc,Sa);else{const wc=this.xe.tQ();wc.Data=Bf.Gze(hc.Result);Sa(wc)}},Sa):this.xe.qf(cf.a.r8e,Sa)}}FTh(O,Sa){const Hb=O[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],hc=O[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],wc=O.DdaMethod.ControlId,ad=Bg.getInstance(this.$);if(0>=hc)n.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.xe.qf(cf.a.Gji,
Sa);else if(hc>Bg.ZFi)n.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.xe.qf(cf.a.m3e,Sa);else{var kd=null;switch(Hb){case 1:kd="Compressed";break;case 0:kd="Text";break;case 2:kd="Pdf";break;default:n.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Hb} is not supported.`);this.xe.qf(cf.a.zYe,Sa);return}if("Text"===kd)n.ULS.sendTraceTag(537163218,344,15,`Requested file type ${kd} is not supported.`),this.xe.qf(cf.a.zYe,Sa);else{A.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(O=new Sys.StringBuilder,O.append(lh.a(this.$,kd)),"Pdf"===kd&&yf.a.zk(O,tf.a.RQf,"WholeWorkbook"),O=O.toString()):O=lh.a(this.$,kd);var od=null,Dd=new XMLHttpRequest;Dd.onreadystatechange=()=>{if(4===Dd.readyState)if(200===Dd.status){var Pd=Dd.response;if(Pd){od=new Uint8Array(Pd);Pd=this.xe.tQ();var Se=od.length,Ue=Bg.mKi(),lf={},zg=0;for(let jg=0;jg<Se;jg+=hc){const Zf=[],ag=jg+hc<Se?jg+hc:Se;for(let mg=0,Ug=jg;Ug<ag;mg++,Ug++)Zf[mg]=od[Ug];lf[(zg++).toString()]=Zf}lf=new yg(Ue,Se,hc,lf);lf=ad.UIg(wc,
lf);lf!==cf.a.success?this.xe.qf(lf,Sa):(Pd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Ue,Pd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Se,n.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${kd}, the file size is ${Se}`),Sa(Pd))}else n.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${kd}.`),this.xe.qf(cf.a.internalError,Sa)}else 500===Dd.status?this.xe.qf(cf.a.Z_e(parseInt(Dd.statusText,
10)),Sa):(n.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${kd}.`),this.xe.qf(cf.a.UJi,Sa))};Dd.open("GET",O,!0);Dd.responseType="arraybuffer";Dd.setRequestHeader("If-Modified-Since","0");Dd.send(null)}}}GTh(O,Sa){var Hb=O[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],hc=O[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];O=O.DdaMethod.ControlId;(Hb=Bg.getInstance(this.$).ITh(O,Hb))?(Hb=Hb.bKj,0>hc||hc>=Object.keys(Hb).length?this.xe.qf(cf.a.rei,
Sa):(hc=Hb[hc.toString()],Hb=this.xe.tQ(),Hb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=hc,Hb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=hc.length,Sa(Hb))):this.xe.qf(cf.a.internalError,Sa)}agj(O,Sa){var Hb=O[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];O=O.DdaMethod.ControlId;Hb=Bg.getInstance(this.$).$fj(O,Hb);Hb===cf.a.success?this.xe.Cv(Sa):this.xe.qf(Hb,Sa)}rAj(O,Sa){O.DdaSetBindingData.CoerceType=Bf.k5b(O.DdaSetBindingData.CoerceType);if(this.alc(O.DdaSetBindingData.CoerceType,
Sa)){var Hb=this.Xgd(O.DdaMethod.ControlId);if(Hb){var hc=Bf.W0c(O.DdaSetBindingData.CoerceType,O.DdaSetBindingData.Data),wc=Cg.h(this.$).ha;1===hc.CoerceType&&(!hc.Data&&wc.ra.U5&&(hc.Headers||(hc.Headers=[]),hc.Headers.length||hc.Headers.push([]),hc.Headers[0].length||hc.Headers[0].push("")),Bf.Vhc(hc)||(hc.CellFormat||(hc.CellFormat=O.DdaSetBindingData.CellFormat),hc.TableOptions||(hc.TableOptions=O.DdaSetBindingData.TableOptions)));if(Bf.Vhc(hc))this.xe.qf(cf.a.mEc,Sa);else{var ad=wc.ra.ed.clone(),
kd=wc.ra.activeCell.clone();this.rA.ddaSetSelectedData(O.DdaMethod.ControlId,Hb,hc,od=>{var Dd;if(Df.a(od))this.xe.LH(od,Sa);else{od=ad.clone();const Pd=hc.Headers?hc.Headers[0].length:hc.Data[0].length;1!==hc.CoerceType||hc.Data?1===hc.CoerceType&&(null===(Dd=hc.TableOptions)||void 0===Dd?0:Dd.length)&&0==hc.TableOptions[0]?(od.top+=1,od.bottom=od.top+hc.Data.length-1):od.bottom=od.top+hc.Data.length-(1===hc.CoerceType?0:1):od.bottom=od.top+1;od.right=od.left+Pd-1;Dd=od.contains(kd)?kd:od.topLeft;
wc.updateSelection(od,Dd,0);this.xe.Cv(Sa)}},Sa)}}else this.xe.qf(cf.a.fCe,Sa)}}addBinding(O,Sa,Hb,hc){Sa?this.rA.ddaAddBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,O.DdaBindingsMethod.BindingType,Sa,Hb,wc=>{if(Df.a(wc))this.xe.LH(wc,hc);else{const ad=this.xe.tQ();ad.Bindings=Array(1);ad.Bindings[0]=this.Xd.T2b(wc.Result);hc(ad)}},hc):this.xe.qf(cf.a.vtj,hc)}rPh(O,Sa){this.rA.ddaGetBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Hb=>{if(Df.a(Hb)||!Hb.Result)this.xe.LH(Hb,
Sa);else{const hc=this.xe.tQ();hc.Bindings=Array(1);hc.Bindings[0]=this.Xd.T2b(Hb.Result);Sa(hc)}},Sa)}FUh(O){const Sa=this.xe.tQ(),Hb={};Hb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Sa[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Hb;O(Sa)}Zfj(O,Sa){this.rA.ddaReleaseBinding(O.DdaMethod.ControlId,O.DdaBindingsMethod.BindingId,Hb=>{Df.a(Hb)?this.xe.LH(Hb,Sa):this.xe.Cv(Sa)},Sa)}sOh(O,Sa){this.rA.ddaGetAllBindings(O.DdaMethod.ControlId,Hb=>
{if(Df.a(Hb))this.xe.LH(Hb,Sa);else{const hc=this.xe.tQ();if(Hb.Result){Hb=Hb.Result;hc.Bindings=Array(Hb.length);for(let wc=0;wc<Hb.length;wc++)hc.Bindings[wc]=this.Xd.T2b(Hb[wc])}else hc.Bindings=null;Sa(hc)}},Sa)}oxd(O,Sa){this.rA.ddaLoadSettings(O.DdaMethod.ControlId,Hb=>{if(Df.a(Hb))this.xe.LH(Hb,Sa);else{const hc=this.xe.tQ();hc.Properties=Hb.Result;Sa(hc)}},Sa)}saveSettings(O,Sa){const Hb={Settings:[]};for(let hc=0;hc<O.DdaSettingsMethod.Properties.length;hc++){const wc={};wc.Name=O.DdaSettingsMethod.Properties[hc][0];
wc.Value=O.DdaSettingsMethod.Properties[hc][1];Hb.Settings[hc]=wc}this.rA.ddaSaveSettings(O.DdaMethod.ControlId,Hb,O.DdaSettingsMethod.OverwriteIfStale,hc=>{Df.a(hc)?this.xe.LH(hc,Sa):this.xe.Cv(Sa)},Sa)}bre(O,Sa){const Hb=Bf.W0c(1,O.DdaAddRowsColumns.Data);Bf.Vhc(Hb)?this.xe.qf(cf.a.mEc,Sa):this.rA.ddaAddRowsColumns(O.DdaMethod.ControlId,O.DdaAddRowsColumns.BindingId,O.DdaAddRowsColumns.IsRow,Hb,hc=>{Df.a(hc)?this.xe.LH(hc,Sa):this.xe.Cv(Sa)},Sa)}ilh(O,Sa){this.rA.ddaDeleteAllDataValues(O.DdaMethod.ControlId,
O.DdaBindingsMethod.BindingId,Hb=>{Df.a(Hb)?this.xe.LH(Hb,Sa):this.xe.Cv(Sa)},Sa)}J4g(O,Sa){this.rA.ddaClearBindingFormats(O.DdaMethod.ControlId,O.DdaClearBindingFormats.BindingId,Hb=>{Df.a(Hb)?this.xe.LH(Hb,Sa):this.xe.Cv(Sa)},Sa)}l4f(O,Sa){const Hb={},hc=O.DdaSetBindingFormats.IsSetFormats;hc?Hb.CellFormat=O.DdaSetBindingFormats.CellFormat:Hb.TableOptions=O.DdaSetBindingFormats.TableOptions;this.rA.ddaSetBindingFormats(O.DdaMethod.ControlId,O.DdaSetBindingFormats.BindingId,Hb,hc,wc=>{Df.a(wc)?this.xe.LH(wc,
Sa):this.xe.Cv(Sa)},Sa)}executeRichApiRequest(O,Sa){var Hb;const hc=O.ArrayData,wc={},ad=Cg.h(this.$).ha;if(hc){if("WacPartition"===hc[0]){this.UDh(O,Sa);return}const Ue=Object(U.a)(ig.DdaFacade,Wf.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===hc[0]){var kd=Ue.yn(O.DdaMethod.ControlId);kd&&(kd.Ojc=!0,kd.kQf())}wc.HttpMethod=hc[1];wc.PathAndQuery=hc[2];wc.RequestHeaders=Bf.L4e(hc[3]);wc.RequestBody=hc[4];wc.AppPermission=hc[5];kd=hc[6];wc.RequestFlags=kd;var od=0;if(Fh.i(this.$.na))switch(ad.Ne){case 1:od=
2;break;case 2:od=3;break;case 128:od=4;break;default:od=1}var Dd=null;ad.Ta.aB&&(Dd=ad.Ta.aB.Ui);wc.SheetMultiRange=eg.r(ad.ra.selectedRanges,this.$);wc.ActiveCell=eg.v(ad.ra.activeCell,this.$);wc.ActiveChartId=Dd;wc.SelectionState=od;od=this.Xd.XZ(O.DdaMethod.ControlId);wc.InstanceId=od?od.InstanceId:"";if(od&&od.PrimaryMarketplace){let lf;if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1))if(od.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)lf=
od.PrimaryMarketplace.SolutionId,Dd=od.PrimaryMarketplace.MarketplaceType;else{if(!od.OwnerAddinSolutionId){n.ULS.sendTraceTag(512325018,344,15,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.xe.qf(cf.a.ZMa,Sa);return}if(!od.OwnerAddinStoreType){n.ULS.sendTraceTag(512325017,344,15,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.xe.qf(cf.a.ZMa,Sa);return}lf=od.OwnerAddinSolutionId;Dd=od.OwnerAddinStoreType}else if(lf=ig.DdaFacade.getSolutionId(od,this.$),
Dd=od.PrimaryMarketplace.MarketplaceType,Dd===OSF.StoreType.InMemory){if(!od.OwnerAddinSolutionId){this.xe.qf(cf.a.ZMa,Sa);return}if(od.AssetMarketplace)Dd=od.AssetMarketplace.MarketplaceType;else{this.xe.qf(cf.a.ZMa,Sa);return}}else Dd===OSF.StoreType.WopiCatalog&&(Dd=OSF.StoreType.OMEX);let zg=Telemetry.PrivacyRules.GetPrivacyCompliantId(lf,Dd,null===(Hb=od.AssetMarketplace)||void 0===Hb?void 0:Hb.SolutionId,null,null,od.PrimaryMarketplace.MarketplaceRef);wc.CompliantSolutionId=zg;wc.SolutionId=
lf;wc.MarketplaceType=Dd;wc.SolutionVersion=od.PrimaryMarketplace.SolutionVersion;wc.StoreLocation=od.PrimaryMarketplace.MarketplaceRef}else wc.SolutionId=wc.MarketplaceType="",wc.CompliantSolutionId="";wc.IsEventsEnabled=void 0===Ue||null===Ue||Ue.hj.d2b(wc.InstanceId);wc.RequestGuid=Ig.a.create().toString();Hb=wc.RequestBody.length;if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Hb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.xe.qf(cf.a.Smj,Sa);n.ULS.sendTraceTag(537163213,
0,50,`Request payload size:${Hb} exceeded the limit`);return}A.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&kd&4096&&(Hb=new Eg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Hb,Jf,hc),wc.RequestBody=hc[4])}const Pd=Bf.V7e(wc.RequestHeaders);Bf.hHd++;const Se=ij.a.Sa.zb;A.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&wc&&wc.RequestBody&&n.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${wc.RequestBody.length}`);
this.rA.executeRichApiRequest(wc,Ue=>{var lf;this.r3f(Se,!0,Ue.ServerCorrelationId);let zg=null,jg=null;var Zf=Ue.ServerCorrelationId;if(null===(lf=null===Ue||void 0===Ue?void 0:Ue.Errors)||void 0===lf?0:lf[0])zg=Ue.Errors[0].MessageIdName,jg=Ue.Errors[0].Description,A.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&tj.a(this.$).hd.CM(Ue.Errors[0].MessageId);if(Df.a(Ue)||!Ue.Result)this.V9a(Zf,Pd,"Server error",zg,jg),this.xe.LH(Ue,Sa);else{let mg=null;if(A.EwaSettings.oa(247))if((lf=
Ue.Result)&&lf.length){for(let Vg=0;Vg<lf.length;Vg++)if(lf[Vg].RequestGuid===wc.RequestGuid){mg=lf[Vg];break}mg||this.xe.LH(Ue,Sa)}else mg=Ue.Result;else mg=Ue.Result;if(!zg&&mg&&mg.ResponseBody&&mg.ResponseBody[0])if(Ue=mg.ResponseBody[0],Ue.startsWith('{"Error":')){1<mg.ResponseBody.length&&(Ue=Ue.substring(0,Ue.indexOf("}")+1),Ue+="}");try{var ag=x.a.$h(Ue);ag.Error&&this.V9a(Zf,Pd,"Pipeline error",ag.Error.Code,ag.Error.Message)}catch(Vg){this.V9a(Zf,Pd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.V9a(Zf,
Pd);else this.V9a(Zf,Pd,"Server error",zg,jg);const Ug=(Zf=mg.SheetMultiRange)?Zf.SheetName:null;ag=mg.ActiveChartId;const Ng=mg.SelectionState;Ue=5===Ng&&!!Zf||6===Ng||7===Ng||8===Ng;if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.Mv&&Ue)this.xe.qf(cf.a.AGc,Sa),n.ULS.sendTraceTag(537163211,0,50,`${Ng.toString()} is not allowed`);else if(5===Ng&&Zf){if(this.$.va&&Ug)if(this.$.va.Rk(Ug))this.PWc(Ug);else{let Vg=null;Vg=()=>{this.$.va.Rk(Ug)&&
(n.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.PWc(Ug),this.$.va.BKb(Vg))};this.$.va.Vob(Vg);if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Jh=null;Jh=()=>{this.$.va.Rk(Ug)&&(this.PWc(Ug),this.$.va.zna(Jh))};this.$.va.tha(Jh)}}}else if(6===Ng||7===Ng||8===Ng||9===Ng){if(Zf){const Vg=eg.g(Zf.Ranges);if(Ug&&eg.cb(Vg,!0))if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!this.$.va.Rk(Ug)){let Jh=null;Jh=()=>{this.Lkg(ad,Vg,Ug,Ng);this.$.va.zna(Jh)};this.$.va.tha(Jh)}else this.Lkg(ad,Vg,Ug,Ng)}7===Ng?(ag="38.{"+uj.e(ag)+"}",Ci.a(this.$).Tna(0,ag,!0)):8===Ng&&Ci.a(this.$).Tna(2,ag,!0);9===Ng&&(this.$.ya.ApiCallToSetPageLayout=!0)}mg.PostProcessActions?(Zf=x.a.$h(mg.PostProcessActions),this.f6i(Zf).then(()=>{this.beb(mg,Sa);this.Vdd(O.DdaMethod.ControlId,wc);return Promise.resolve(null)},Vg=>{this.beb(mg,Sa,Vg);return Promise.reject(Vg)})):this.beb(mg,Sa)}},Ue=>{this.r3f(Se,
!1,null);this.V9a(null,Pd,"Web service error");Sa(Ue)})}Vdd(O,Sa){const Hb=Object(U.a)(ig.DdaFacade,Wf.a(this.$));(null===Hb||void 0===Hb?0:Hb.ZPd)&&Hb.yn(O)&&Bf.jEj(Sa.RequestHeaders)&&(n.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${O}; SolutionId: ${Sa.SolutionId}.`),Hb.ZPd.tth(O))}UDh(O,Sa){var Hb=this.Xd.XZ(O.DdaMethod.ControlId);const hc=ig.DdaFacade.getSolutionId(Hb,this.$);var wc=null;wc=ig.DdaFacade.Hva(Hb,this.$);
wc=new Gg(wc,this.$);wc=new hj(hc,O.DdaMethod.ControlId,this.Xd,this.$,wc);const ad={ResponseHeaders:[]};ad.ResponseBody=Array(1);Hb=Bf.L4e(O.ArrayData[3]);const kd=Bf.V7e(Hb);Hb=new Vf(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.oyf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(wc,vf,Hb,O.ArrayData).then(od=>{if(!od)return this.dyd(!1,"The rich api executor call failed",kd),n.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),ad.ResponseStatusCode=500,this.beb(ad,
Sa),null;this.dyd(!0,"The rich api executor call succeeded",kd);ad.ResponseStatusCode=od[0];ad.ResponseBody[0]=od[2];this.beb(ad,Sa);return null},od=>{ad.ResponseStatusCode=400;ad.ResponseBody[0]=od.toString();this.dyd(!1,"The rich api executor call failed",kd);n.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${hc}`);this.beb(ad,Sa);return null})}r3f(O,Sa,Hb){Bf.hHd--;O=nj.a(ij.a.Sa,O);n.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${O}, requests pending:${Bf.hHd}, request result:${Sa?
"success":"false"}, server correlationid: ${Hb}.`)}beb(O,Sa,Hb=null){const hc=Array(3);hc[0]=O.ResponseStatusCode;hc[1]=Bf.M3h(O.ResponseHeaders);const wc=[];var ad=!1;if(Hb&&O.ResponseBody){const kd=x.a.$h(O.ResponseBody.join(""));kd.Error||(ad={},ad.Error=Hb,ad.TraceIds=kd.TraceIds,ad.ProcessedResults={},ad.ProcessedResults.Results=kd.Results,wc[0]=x.a.fc(ad),ad=!0)}hc[2]=ad?wc:O.ResponseBody;O=this.xe.tQ();O.Data=hc;Sa(O)}kBd(O,Sa){(new Lf(this.$,this.xe,this.rA)).kBd(O,Sa)}zHi(O,Sa){n.ULS.sendTraceTag(537163206,
0,50,"MessageParent API called!");const Hb=O[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],hc=O[qd.a.QYc],wc=O[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];O=this.$.da.Aa(232).Q2a.AHi(O.DdaMethod.ControlId,Hb,hc,wc);O===cf.a.success?this.xe.Cv(Sa):(n.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.xe.qf(O,Sa))}vHi(O,Sa){n.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Hb=O[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],hc=O[qd.a.QYc],wc=O[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];
this.$.da.Aa(232).Q2a.nuj(O.DdaMethod.ControlId,Hb,hc,wc);this.xe.Cv(Sa)}getAccessToken(O,Sa){n.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Hb=(wc,ad)=>{var kd;if(wc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)wc=this.xe.tQ(),wc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=ad.accessToken,Sa(wc);else{ad=this.Xd.XZ(O.DdaMethod.ControlId);let od=null!==ad.OwnerAddinStoreType?ad.OwnerAddinStoreType:ad.PrimaryMarketplace.MarketplaceType;n.ULS.sendTraceTag(537163202,
0,10,`${({["errorCode"]:wc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ig.DdaFacade.getSolutionId(ad,this.$),od,null===(kd=ad.AssetMarketplace)||void 0===kd?void 0:kd.SolutionId,null,null,ad.PrimaryMarketplace.MarketplaceRef),["storeType"]:od})}.`);this.xe.qf(wc,Sa)}},hc=!A.EwaSettings.oa(23);Yf.TaskExtensions.za(sg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),wc=>{const ad=this.Xd.Ph,kd=Id.getInstance();mc.AppsForOfficeSingleSignOnManager.getInstance(ad,wc.result,
kd).getAccessToken(O.DdaMethod.ControlId,hc,O,Hb)},this.$.ka)}getAuthContext(O,Sa){Yf.TaskExtensions.za(sg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,1),()=>{var Hb=this.Xd.Ph.getOsfControl(O.DdaMethod.ControlId);if(Hb.isFirstParty()){Hb=Hb.getManifest();var hc=Hb.getMarketplaceID(),wc=Hb.getWebApplicationId(),ad=Hb.getWebApplicationMsaId();Hc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(hc).then(kd=>{const od=this.xe.tQ(),Dd={};Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
wc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ad||wc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=kd.upn;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=kd.userId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=kd.authority;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Xd.a.aPh(kd.authorityType);Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=kd.isAnonymous;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
kd.tenantId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=kd.supportsAuthToken;od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Dd;Sa(od)},kd=>{const od=this.xe.tQ(),Dd={},Pd=new Xd.a;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=wc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ad||wc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Pd.upn;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Pd.userId;
Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Pd.authority;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Pd.authorityType;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Pd.isAnonymous;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Pd.tenantId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=kd;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Pd.supportsAuthToken;od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
Dd;od.Error=1;Sa(od)})}},this.$.ka)}Qmi(O){const Sa=Cg.h(this.$).ha;return 16===Sa.Ne&&!!Sa.Ta.$b&&!!Sa.Ta.$b.floatingObject&&yh.a.equals(Sa.Ta.$b.floatingObject.id,O,!0)}Xgd(O){const Sa=Cg.h(this.$).ha;return Sa.ra.Pg?1===Sa.Ne||this.Qmi(O)?Sa.Nia:null:null}alc(O,Sa){return 1!==O&&2!==O&&3!==O?(this.xe.qf(cf.a.uFe,Sa),!1):!0}dyd(O,Sa,Hb){const hc={};hc.a=this.$.ya.UserSessionId;hc.b=O;hc.c=Sa;hc.d=null;hc.e=Hb;Dh.b().Qe(37,hc)}V9a(O,Sa,Hb=null,hc=null,wc=null){const ad={};O&&(ad.ServerCorrelationId=
O);void 0!==Sa&&null!==Sa&&(ad.Source=Sa);Hb&&(ad.ErrorType=Hb);hc&&(ad.MessageId=hc);wc&&(ad.StatusDescription=wc);A.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&hc&&"ExternalDataRefreshFailed"===hc&&(ad.StatusDescription="");n.ULS.sendTraceTag(50688452,0,50,x.a.fc(ad))}f6i(O){let Sa=new Promise(Hb=>{Hb(null)});for(let Hb=0;Hb<O.length;Hb++)Sa=this.e6i(Sa,O[Hb]);return Sa}e6i(O,Sa){if(!Sa)return n.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),O.then(()=>Promise.reject(Bf.P4a(ug.generalException,
vc.a.instance.ga(1756),null)));switch(Sa.actionType){case 1:case 2:O=O.then(()=>{const Hb=Object(U.a)(ig.DdaFacade,Wf.a(this.$));if(Hb.yn(Sa.controlId))switch(Hb.hj.L8h(Sa),Sa.messageType){case 14:case 100:Hb.YPd.z2b(Sa);break;case 11:case 12:Hb.Lpj.mqb(Sa);break;case 51:case 52:Hb.Jpj.mqb(Sa);break;case 2101:case 2102:Hb.Kpj.mqb(Sa);break;case 2E3:Hb.Mpj.z2b(Sa);break;case 2201:this.$.cca&&Hb.ZPd.eUg(Sa);break;case 2203:Hb.Npj.fUg(Sa);break;case 2700:A.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
Hb.XPd.z2b(Sa)}else n.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${Sa.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:O=O.then(()=>{this.w8h(Sa);return Promise.resolve(null)});break;case 15:A.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(O=O.then(()=>{this.c$h(Sa);return Promise.resolve(null)}));break;case 4:O=O.then(()=>{if(A.EwaSettings.oa(102)){var Hb=Cg.h(this.$).ha.ra.activeCell;Hb.top!==Sa.row+1&&Hb.left!==Sa.column+1&&(Hb=eg.v(Fg.Range.Qc(Sa.row+
1,Sa.column+1),this.$),Cg.h(this.$).gg(Hb,null,null,null,3,"DdaMethodHandler.ShowCard"));di.a(this.$,243,242,0,hc=>{hc.efb(Sa.row+1,Sa.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:O=O.then(()=>{Object(U.a)(ig.DdaFacade,Wf.a(this.$)).hj.zQe(Sa.controlId,Sa.isEnableEvents);return Promise.resolve(null)});break;case 5:O=O.then(()=>this.mih(Sa));break;case 6:O=O.then(()=>this.k1i(Sa));break;case 8:O=O.then(()=>{A.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(U.a)(ig.DdaFacade,Wf.a(this.$)).I4g();const Hb=new rj.a(sj.a.Yj,5,null);qj.a(this.$).Ns(Hb);return Promise.resolve(null)});break;case 9:O=O.then(()=>this.fwj(Sa));break;case 10:O=O.then(()=>this.l5j(Sa));break;case 11:O=O.then(()=>this.k5j());break;case 12:O=O.then(()=>this.h5j());break;case 13:O=O.then(()=>this.i5j(Sa));break;case 14:O=O.then(()=>this.j5j(Sa));break;case 16:O=O.then(()=>Promise.resolve(Sa));break;case 17:O=O.then(()=>this.usj(Sa,Object(U.a)(ig.DdaFacade,Wf.a(this.$))));break;
case 18:Cg.h(this.$).focus();break;case 19:this.baf(Sa.entryType,!1,Sa.options);break;case 20:this.baf(Sa.entryType,!0,Sa.options);break;default:O=O.then(()=>Promise.reject(Bf.P4a(ug.ERg,vc.a.instance.ga(1757),null)))}return O}c$h(O){var Sa=Object(U.a)(ig.DdaFacade,Wf.a(this.$)).yn(O.controlId);if(Sa&&!(0===O.operationType^!Sa.gea)){Cg.h(this.$).ykc=!0;switch(O.operationType){case 0:var Hb=new pj.a(document.createElement("input"));Hb.text=O.range;Sa.whi(Cg.h(this.$).yf.Igh(Hb,new mj.a(this.$)));Sa.gea.startEdit(!0);
break;case 1:Sa.dWf();this.rangePicker=null;break;case 2:Sa.gea.blg(O.range);break;case 3:Sa.gea.blg(O.startingRange);Sa=O.expandSelection;Hb=O.getNextDataRegionCell;let hc=0;switch(O.keyboardDirectionValue){case 2:hc=38;O=Sa&&Hb?105288353:Sa?-31900117:Hb?542791952:137938150;break;case 3:hc=40;O=Sa&&Hb?-1297307319:Sa?-1603798598:Hb?1713663844:-798660877;break;case 0:hc=37;O=Sa&&Hb?-403586027:Sa?2039316657:Hb?-2012742350:-1470715894;break;case 1:hc=39;O=Sa&&Hb?784916030:Sa?589730764:Hb?1324884057:
-1231471547;break;default:O=1461300262}Sa=this.U6b("keydown",hc,Sa,Hb);Cg.h(this.$).JLb(Sa,new vg.a(O,1,0,8,null))}Cg.h(this.$).ykc=!1}}U6b(O,Sa,Hb,hc){const wc=document.createEvent("KeyboardEvent");if(ed.a.SF)wc.initKeyboardEvent(O,!1,!1,window.self,"A",0,hc,!1,Hb,!1);else{let ad="";Hb&&(ad+="Shift");hc&&(ad+=0<ad.length?" Control":"Control");wc.initKeyboardEvent(O,!1,!1,window.self,"A",0,ad,!1,"en-US")}O=new Sys.UI.DomEvent(wc);O.keyCode=Sa;return O}w8h(O){switch(O.operationType){case 1:Yf.TaskExtensions.za(sg.GetServiceTaskFactory.create(this.$.da,
153,this.$.ka,1),Sa=>{Sa.result.TOd()},this.$.ka,3);break;case 2:if(O=Object(U.a)(ig.DdaFacade,Wf.a(this.$)).yn(O.controlId))O.Ojc=!0,O.kQf()}}mih(O){const Sa=O.fileBase64;return Sa&&Sa.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(Bf.P4a(ug.invalidArgument,vc.a.instance.ga(1760),"Application.CreateWorkbook")):(new Promise((Hb,hc)=>{const wc=new te.StandardDialog;wc.Tb=4;wc.$l(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,ad=>{2!==
ad&&0!==ad||hc(Bf.P4a(ug.iGd,vc.a.instance.ga(1759),"Application.CreateWorkbook"));ad=new Me("blank","agave",Sa?"streamBase64":"streamEmpty",Sa);this.oyf.create(Hb,hc,ad).g2a()})})).then(Hb=>{this.Gac.set(O.fakeFileId,Hb);return Promise.resolve(null)},Hb=>Hb?Promise.reject(Hb):Promise.reject(Bf.P4a(ug.generalException,vc.a.instance.ga(1756),"Application.CreateWorkbook")))}k1i(O){return new Promise((Sa,Hb)=>{if(this.Gac.has(O.fakeFileId)){const hc=this.Gac.get(O.fakeFileId);Hb=new te.StandardDialog;
Hb.Tb=4;Hb.$l(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,wc=>{1===wc&&Uh.HelperMethods.kf(hc,void 0,void 0,"DdaMethodHandler.fileUrl");Sa(null)})}else Hb(Bf.P4a(ug.generalException,vc.a.instance.ga(1756),"Document.Open"))})}fwj(O){return new Promise(Sa=>{Object(U.a)(ig.DdaFacade,Wf.a(this.$)).S_f=O.runtimeCalculationMode;const Hb=this.$.da.Aa(268);Hb&&Hb.mCd(3===O.runtimeCalculationMode);Sa(null)})}l5j(O){hh.a.ICb(this.$)&&this.$.da.Aa(331).ceb(0,
O.urlStr,!0,!0,null);return Promise.resolve(null)}k5j(){hh.a.ICb(this.$)&&this.$.da.Aa(331).ceb(1,null,!0,!0,null);return Promise.resolve(null)}h5j(){hh.a.ICb(this.$)&&this.$.da.Aa(331).wQe();return Promise.resolve(null)}i5j(O){hh.a.ICb(this.$)&&this.$.da.Aa(331).ceb(5,O.urlStr,!0,!0,null);return Promise.resolve(null)}j5j(O){if(hh.a.ICb(this.$)){const Sa=this.$.da.Aa(331);for(const Hb of Sa.Maa)Hb.IsActive&&Hb.HostEditUrl&&Hb.UrlStr===O.hostEditUrlStr&&Uh.HelperMethods.kf(Hb.HostEditUrl,"_blank")}return Promise.resolve(null)}usj(O,
Sa){const Hb=tg.a.nX;O=x.a.$h(O.payload);const hc={};"eventId"in O&&"payload"in O&&(hc.eventId=O.eventId,hc.payload=O.payload);Sa.mN(2201,Hb,x.a.fc(hc));return Promise.resolve(null)}baf(O,Sa,Hb){const hc=this.$.da.Aa(5);hc&&(O=this.WPh(O))&&(Sa?hc.removeEntry(O):hc.HXc(O,Hb))}WPh(O){switch(O){case 0:return 64;case 1:if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}PWc(O){O=Object(U.a)(oj.a,this.$.va.getItemByName(O));(null===O||void 0===O?0:O.visible)&&O.activate(!0)}Lkg(O,
Sa,Hb,hc){var wc=O.ra.Ds;const ad=wc<Sa.length&&Sa[wc].contains(O.ra.activeCell);O=ad?O.ra.activeCell:Sa[0].topLeft;wc=ad?wc:0;Cg.h(this.$).Y4(Sa,wc,Hb,null,O,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===hc)}static get Ljh(){Bf.pqa||(Bf.pqa={},Bf.pqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,Bf.pqa[Microsoft.Office.WebExtension.CoercionType.Text]=2,Bf.pqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,Bf.pqa[Microsoft.Office.WebExtension.CoercionType.Html]=
4,Bf.pqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Bf.pqa}static get Ojh(){Bf.ejb||(Bf.ejb={},Bf.ejb[Microsoft.Office.WebExtension.FilterType.All]=1,Bf.ejb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return Bf.ejb}static get Pjh(){Bf.fjb||(Bf.fjb={},Bf.fjb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Bf.fjb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return Bf.fjb}static L4e(O){if(!O||!O.length)return null;const Sa=Array(O.length/2);for(let Hb=
0;Hb<O.length/2;Hb++)Sa[Hb]={},Sa[Hb].Name=O[2*Hb],Sa[Hb].Value=O[2*Hb+1];return Sa}static M3h(O){if(!O||!O.length)return null;const Sa=Array(2*O.length);for(let Hb=0;Hb<O.length;Hb++)Sa[2*Hb]=O[Hb].Name,Sa[2*Hb+1]=O[Hb].Value;return Sa}static ied(O){if(!O||!O.length)return null;const Sa=Array(O.length);for(let Hb=0,hc=O.length;Hb<hc;Hb++){const wc=O[Hb].length;if(wc){Sa[Hb]=Array(wc);for(let ad=0;ad<wc;ad++)Sa[Hb][ad]=null==O[Hb][ad]?null:O[Hb][ad].toString()}else return null}return Sa}static k5b(O){return"string"===
typeof O?Zi.a.zq(Bf.Ljh,O,0):O}static MYe(O){return"string"===typeof O?Zi.a.zq(Bf.Ojh,O,0):O}static xmg(O){return"string"===typeof O?Zi.a.zq(Bf.Pjh,O,0):O}static cni(O){switch(O.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static W0c(O,Sa){const Hb={};Hb.CoerceType=O;1===Hb.CoerceType?(Hb.Data=Bf.ied(Sa.Rows),Hb.Headers=Bf.ied(Sa.Headers)):Hb.Data=Bf.ied(Sa);return Hb}static Gze(O){return 1===O.CoerceType?{["Headers"]:O.Headers,["Rows"]:O.Data}:
O.Data}static Vhc(O){return 1===O.CoerceType?!O.Data&&!O.Headers:!O.Data}static V7e(O){let Sa="Unknown";if(!O)return Sa;for(let Hb=0;Hb<O.length;Hb++)if(O[Hb].Name.toLowerCase()===tf.a.Opj){Sa=O[Hb].Value;break}return Sa}static jEj(O){if(!O)return!1;const Sa=tf.a.gMi.toLowerCase();for(let Hb=0;Hb<O.length;Hb++)if(O[Hb].Name.toLowerCase()===Sa)return!0;return!1}static P4a(O,Sa,Hb){const hc={};hc.Code=O;hc.Message=Sa;hc.Location=Hb;hc.ActionIndex=0;return hc}}Bf.pqa=null;Bf.ejb=null;Bf.fjb=null;Bf.hHd=
0;Object(d.a)(Bf,"DdaMethodHandler",null,[219,3]);class $i extends Bd.a{constructor(O){super(O)}ld(){const O=sg.GetServiceTaskFactory.create(this.$.da,106,this.ka,this.Ya),Sa=sg.GetServiceTaskFactory.create(this.$.da,165,this.ka,this.Ya),Hb=ci(this.ka,this.Ya),hc=A.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&A.EwaSettings.isChangeGateEnabled("OfficeVSO:7126095_ReduceInnerHTMLUsageForDdaBindingPrompt")?sg.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):mh.Task.Ra(null);
Yf.TaskExtensions.za(Yf.TaskExtensions.Ed([O,Sa,Hb,hc],this.ka),()=>{const ad=O.result,kd=Hc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Zc([new Bf(this.$,ad,kd,hc.result)])},this.ka,3);const wc=Hc.a.instance;Yf.TaskExtensions.za(sg.GetServiceTaskFactory.create(this.$.da,137,this.$.ka,this.Ya),()=>{wc.register(Xb,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").wc().Ac(()=>new Xb)},this.$.ka)}static la(O){Bd.a.Nd(82,new $i(O))}}
Object(d.a)($i,"DdaCommandHandlerFactory",Bd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Ni("");c.a.Ni(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(b.a)();
Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(e.a)();(()=>{f.a.Fa(O=>{Vb.la(O)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Ac.a)();Object(Wc.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(O=>{A.EwaSettings.oa(52)&&$g.la(O)})})();(()=>{f.a.Fa(O=>{A.EwaSettings.oa(119)&&bi.la(O)})})();f.a.Fa(Fd.la);f.a.Fa(vi.la);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");
(()=>{f.a.Fa(O=>{Oh.la(O);mi.la(O);Sh.la(O)})})();f.a.Fa($i.la)},1466:function(t,E,a){t=a(0);var c=a(187),b=a(97);class e{constructor(){this.uPe=this.displayName=this.Jsb=this.Vo=this.LB=null;this.isUpgraded=!1}Nmf(d,h){return this.LB.getStoreType().toLowerCase()===d.toLowerCase()&&this.LB.getSolutionId().toLowerCase()===h.toLowerCase()}}Object(t.a)(e,"AddinCommandsResourceItem",null,[]);a.d(E,"a",function(){return f});class f{constructor(){this.CHc=null;this.qMc=0;this.XNc=!1;this.Za=new b.a;this.Byg=
new c.a}OLg(d){this.Za.addHandler("AddinCommandsLoadingMessageChanged",d)}Ihj(d){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",d)}get j_a(){return this.CHc}Deb(d){d!==this.CHc&&(this.CHc=d,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))}awj(){this.qMc++;this.j_a||this.Deb(CommonUIStrings.l_LoadingAddInsTitle)}HSd(){this.qMc--;this.rxd()&&(this.XNc?this.j_a!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Deb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Deb(null))}c5f(d=
!1){this.XNc=!0;this.Deb(d?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}JDe(){this.XNc=!1;this.rxd()?this.Deb(null):this.Deb(CommonUIStrings.l_LoadingAddInsTitle)}rxd(){return 0>=this.qMc}get i7a(){return this.Byg}xja(d,h,m=0){for(let l of this.i7a)if(l.Nmf(d,h)&&(!l.Vo||l.Vo.yNh===m))return l;return null}Hqe(d,h,m,l){const w=new e;w.LB=d;w.Vo=h;w.Jsb=m;w.displayName=l;this.i7a.add(w)}PJg(d,h,m,l){const w=new e;w.LB=d;w.Vo=h;w.Jsb=null;w.uPe=
m;w.displayName=l;this.i7a.add(w)}hgj(d,h){let m=0;for(let l of this.i7a)l.LB.getStoreType()===d&&l.LB.getSolutionId()===h?this.i7a.removeAt(m):m++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(t.a)(f,"AddinCommandsResourceManager",null,[])},733:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);var c=a(35);class b{static get xHi(){return b.Vfe||(b.Vfe={["-2002156328"]:b.uFe,["-1954750170"]:b.r8e,["317650254"]:b.x6g,["-1005263101"]:b.zji,["1353664579"]:b.Htj,["159671765"]:b.Aji,
["1446690022"]:b.m3e,["1150069548"]:b.mEc,["-1409306331"]:b.fCe,["338507772"]:b.sLe,["-457159301"]:b.$1i,["-1037701970"]:b.mjh,["-1893322318"]:b.Fji,["965579896"]:b.ojh,["93287890"]:b.njh,["358088857"]:b.Qwj,["-1223650923"]:b.sLe,["2007306190"]:b.t2g,["1549955423"]:b.Lye,["-1275974171"]:b.Eji,["382101082"]:b.n1i,["-898776235"]:b.eJi,["335464256"]:b.WIi,["1677378049"]:b.Dji,["-261992848"]:b.BWj,["-980820954"]:b.Lye,["-931375837"]:b.m1i,["929186550"]:b.Qqh,["-982144310"]:b.a9i,["-785741187"]:b.xji,
["2125217573"]:b.Hji,["299124955"]:b.yji,["1669853884"]:b.aqj,["-1515932330"]:b.y6g,["314621024"]:b.XJh,["-300049690"]:b.x2g,["14766835"]:b.VBj,["-1251992761"]:b.xOe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.yGa,["49173765"]:b.yGa,["-907155566"]:b.yGa,["-1201603824"]:b.yGa,
["1541165282"]:b.yGa,["-1347753427"]:b.yGa,["134912532"]:b.yGa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static Z_e(e){return c.a.zq(b.xHi,e.toString(),b.internalError)}}b.success=0;b.uFe=1E3;b.r8e=1001;b.x6g=1002;b.zji=1003;b.Htj=1004;b.Aji=1005;b.m3e=1008;b.zYe=1009;b.invalidSheetName=1014;b.mEc=2E3;b.fCe=2001;b.sLe=2002;b.$1i=2003;b.mjh=2004;b.Fji=2005;b.ojh=2007;b.njh=2008;b.Qwj=2009;b.t2g=2014;b.vtj=3E3;b.Lye=3002;b.Eji=3004;b.n1i=3005;b.eJi=3006;b.WIi=3007;b.Dji=3008;b.BWj=3009;b.m1i=
3010;b.VBj=4002;b.mGd=5E3;b.internalError=5001;b.xOe=5002;b.ZMa=5004;b.DXj=5007;b.rei=5008;b.invalidOrTimedOutSession=5012;b.AGc=5016;b.yGa=5102;b.Smj=5103;b.responsePayloadSizeLimitExceeded=5104;b.Q1g=7001;b.jbg=7002;b.Qqh=8E3;b.a9i=8001;b.xji=8010;b.Hji=8011;b.yji=8012;b.aqj=8020;b.y6g=8021;b.XJh=8022;b.x2g=8023;b.dHi=11E3;b.UJi=11001;b.Gji=11002;b.Vfe=null;Object(t.a)(b,"DdaErrorIds",null,[])},734:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.generalException="GeneralException";
c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.sWc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.iGd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.GXj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.NPg="AddinIsAlreadyRequestingToken";c.voj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.u$g=
"ControlIdNotFound";c.kpj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(t.a)(c,"ErrorCodes",null,[])},737:function(t,E,a){a.r(E);var c=a(0),b=a(7),e=a(15),f=a(1307),d=a(84),h=a(97);class m{constructor(qa,xa,ob){this._id=qa;this.xsg=xa;this.Fug=ob;this.lhf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get MPg(){return this.xsg}get b7g(){return this.Fug}execute(qa,
xa,ob){ob=ob||{};ob.commandMode=this.lhf;xa.invokeAppCommand(this.MPg,this.b7g,ob,()=>{qa.LVi(this.id)})}}Object(c.a)(m,"AddinNativeActionBase",null,[432]);class l extends m{constructor(qa,xa){super(1,qa,xa);this.lhf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(l,"AddinTakeSnapshotAction",m,[]);class w{abh(qa){return new m(3,qa,this.hOh().getNativeActionName(3))}hOh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(w,"AddinNativeActionManager",null,[422]);var n=
a(146);class x{invokeAppCommand(qa,xa,ob,Ib){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(qa,xa,ob,Ib)}static getInstance(){x.Ma||(x.Ma=new x);return x.Ma}}x.Ma=null;Object(c.a)(x,"OSFAddinCommandsRuntimeManager",null,[423]);var r=a(4),u=a(181),v=a(27);class B extends n.a{constructor(qa,xa,ob){super();this.Q9=null;this.tVc="WACDialogTitleText";this.Efa="0";this.QDa="15px";this.Vug="0px";this.Dfa="calc(100% - 30px)";this.Uug="100%";this.wje=0;this.Za=new h.a;this.zsg=new w;this.Tb=5;this.Ee=
this.YDa=ob;this.GKc=qa;this.E9d=xa;this.WKc=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}aOg(qa){this.Za.addHandler("OnDialogClosedEventKey",qa)}Pyj(){this.hFa=null}Zz(){super.Zz();this.Xk.style.width="100%";this.Xk.style.height=this.Ofc?this.Dfa:this.Uug;this.Xk.style.marginTop=this.Ofc?this.QDa:this.Vug;this.Xk.style.padding=this.Efa}VI(){super.VI();this.wb.style.width=String.format("{0}px",this.GKc*window.innerWidth/100);this.wb.style.height=
String.format("{0}px",this.E9d*window.innerHeight/100);this.wb.style.minWidth="0px";this.WKc&&r.AFrameworkApplication.isRtl&&100===this.GKc&&(this.wb.style.right="0px",this.wb.style.marginRight="0px");this.Q9=document.getElementById(this.mi(this.tVc));this.Q9.style.position="absolute";this.Q9.style.whiteSpace="nowrap";this.Q9.style.textOverflow="ellipsis";r.AFrameworkApplication.isRtl?(this.Q9.style.right="14px",this.Q9.style.left="44px"):(this.Q9.style.right="44px",this.Q9.style.left="14px")}Tv(qa){super.Tv(qa);
this.Q9&&this.Q9.setAttribute("title",qa)}get Uia(){return this.Xk}ZOd(){this.wb.style.width=String.format("{0}px",this.GKc*window.innerWidth/100);this.wb.style.height=String.format("{0}px",this.E9d*window.innerHeight/100);this.wb.style.overflowY="hidden";this.wb.style.overflowX="hidden";this.wb.style.marginTop="";this.wb.style.top="";v.a.D5&&r.AFrameworkApplication.isRtl?(this.wb.style.right="",this.wb.style.marginRight=""):(this.wb.style.left="",this.wb.style.marginLeft="")}hide(){this.zsg.abh(this.YDa).execute(this,
x.getInstance(),{});this.wje=window.setTimeout(()=>{this.Za.raiseEvent("OnDialogClosedEventKey",this.YDa);u.a.prototype.hide.call(this)},500)}LVi(qa){3===qa&&(window.clearTimeout(this.wje),this.Za.raiseEvent("OnDialogClosedEventKey",this.YDa),super.hide())}}Object(c.a)(B,"AppsForOfficeDialog",n.a,[411,412]);class z{constructor(){this.dialog=this.Ee=null}}Object(c.a)(z,"DialogInfo",null,[]);class A{}A.url="url";A.height="height";A.width="width";A.Q9c="displayInIframe";A.ngc="hideTitle";Object(c.a)(A,
"DialogSettings",null,[]);class y{constructor(){this.height=this.width=0;this.Ee=this.controlId=this.pageUrl=null;this.ngc=this.Q9c=!1}}Object(c.a)(y,"DisplayDialogParams",null,[]);class D extends Sys.EventArgs{constructor(qa,xa,ob=null,Ib="",Zb=""){super();this.controlId=qa;this.messageType=xa;this.messageContent=ob;this.messageOrigin=Ib;this.targetOrigin=Zb}}Object(c.a)(D,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(qa,xa,ob=null,Ib="",Zb=""){super();this.controlId=
qa;this.messageType=xa;this.messageContent=ob;this.messageOrigin=Ib;this.targetOrigin=Zb}}Object(c.a)(I,"OnMessageParentEventArgs",Sys.EventArgs,[]);var M=a(41),T=a(30),S=a(171),H=a(99);class C{constructor(qa){this.Za=new h.a;this.Hm=qa}iOg(qa){this.Za.addHandler("OnMessageParentEventKey",qa)}hOg(qa){this.Za.addHandler("OnMessageDialogEventKey",qa)}showDialog(qa,xa,ob,Ib){if(C.B8.kb(xa))e.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const cc=M.b(qa),Rc=cc[A.url];if(this.Hm.getOsfControl(xa).checkAppDomains(Rc)){var Zb=new y;Zb.width=cc[A.width];Zb.height=cc[A.height];Zb.pageUrl=Rc;Zb.Q9c=cc[A.Q9c];Zb.ngc=cc[A.ngc];Zb.controlId=xa;Zb.Ee=S.a.create().toString();var zc=new z;zc.Ee=Zb.Ee;var Mc=this.Hm.getOsfControl(Zb.controlId).getManifest().getDefaultDisplayName(),hd=this.Hm.getOsfControl(Zb.controlId).getStoreType().toLowerCase();qa=null;var id=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);qa=(4===r.AFrameworkApplication.ta.Pa.Ij&&"hardcodedpreinstall"===hd||id&&"sdxcatalog"===hd)&&Zb.ngc?this.createAndShowAppsForOfficeDialog(Zb.width,Zb.height,Zb.Ee,!0,Mc):this.createAndShowAppsForOfficeDialog(Zb.width,Zb.height,Zb.Ee,!1,Mc);var yd=this.Hm.getOsfControl(Zb.controlId),Yd=yd.getManifest();id={};id.id=Zb.Ee;id.solutionId=yd.getSolutionId();id.version=yd.getVersion();id.storeType=hd;id.storeId=yd.getStoreId();id.assetId=yd.getAssetId();id.assetStoreId=yd.getAssetStoreId();id.ownerAddinSolutionId=
yd.getOwnerAddinSolutionId();id.ownerAddinStoreType=yd.getOwnerAddinStoreType();id.appDomains=Yd.getAppDomains();id.dialogUrl=Rc;id.osfControlType=1;id.agaveName=Mc;id.div=qa.Uia;e.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(id.solutionId,id.ownerAddinStoreType||id.storeType,id.assetId,null,null,id.storeId),T.a.sw(Zb.pageUrl));this.Hm.insertDialogControl(id);qa.aOg(Object(d.a)(this,this.UPi,"onDialogClosed"));zc.dialog=
qa;C.B8.ia(Zb.controlId,zc);Ib&&Ib(id);ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else e.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(cc){e.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",cc.message),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}AHi(qa,xa,ob,Ib){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Ib&&(Ib=ob);try{const Zb=this.kLa(qa);Zb&&this.Za.raiseEvent("OnMessageParentEventKey",new I(Zb,OSF.DialogMessageType.DialogMessageReceived,xa,ob,Ib))}catch(Zb){return e.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Zb.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}lIa(qa,xa){if(C.B8.kb(qa))try{const ob=C.B8.ma(qa);ob.dialog&&ob.dialog.hide();this.Hm.purgeDialogControl(ob.Ee);
C.B8.remove(qa);xa(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(ob){e.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",ob.message),xa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else e.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),xa(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}nuj(qa,xa,ob,Ib){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Ib&&(Ib=ob);if(C.B8.kb(qa)&&(qa=C.B8.ma(qa),qa.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new D(qa.Ee,OSF.DialogMessageType.DialogParentMessageReceived,xa,ob,Ib))}catch(Zb){e.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Zb.message)}}kLa(qa){let xa=null;for(let ob of C.B8)if(ob.value.Ee===qa){xa=ob.key;break}return xa}UPi(qa,xa){if(qa=this.kLa(xa))this.Hm.purgeDialogControl(xa),C.B8.remove(qa),this.Za.raiseEvent("OnMessageParentEventKey",
new I(qa,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(qa,xa,ob,Ib,Zb){qa=new B(qa,xa,ob);Zb=Ib?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Zb);Ib&&(qa.Ofc=!1,qa.Lt=!1);qa.initializeAndShow(Zb,null,null);qa.Pyj();return qa}static H6h(){return C.B8}static getInstance(qa){C.Ma||(C.Ma=new C(qa));return C.Ma}}C.Ma=null;C.B8=new H.a;Object(c.a)(C,"AppsForOfficeDialogManager",null,[391]);var G=a(847),J=a(1319),L=a(1396),P=a(937),aa=a(717),U=a(173),
K=a(1320),Y=a(119),na=a(82),W=a(89),X=a(641),Aa=a(554),Q=a(685),fa=a(83),Ca=a(419),ia=a(156),Ra=a(187),Ya=a(38),Ga=a(5),da=a(864),Z=a(1236),ha=a(78);class Wa{constructor(){this.command=0;this.properties=null}}Object(c.a)(Wa,"DdaRequestInfo",null,[]);var ca=a(733),ja=a(76);class ua extends ha.a{constructor(qa,xa){super();this.requests=[];this.disposed=this.h4b=!1;this.jg=()=>{if(!this.disposed){this.grid.Vb.fm(this.jg);this.h4b=!1;const ob=this.requests;this.requests=[];for(let Ib of ob)this.ddaFacade.CK(Ib.command,
Ib.properties)}};this.ddaFacade=qa;this.grid=xa}$kh(qa,xa){this.disposed||(this.h4b||(this.grid.Vb.Qm(this.jg),this.h4b=!0),this.requests.push(Object(b.a)(new Wa,{command:qa,properties:xa})))}dispose(){if(!this.disposed){this.disposed=!0;this.h4b&&this.grid.Vb.fm(this.jg);var qa=this.requests;this.requests=null;for(let xa of qa)(qa=xa.properties?xa.properties[ja.a.d4]:null)&&this.ddaFacade.qf(ca.a.ZMa,qa);this.ddaFacade=this.grid=null;super.dispose()}}static e7g(qa,xa){var ob=!1;974713501===qa&&(xa=
(qa=xa?xa[ja.a.ng]:null)?qa.DdaMethod:null)&&xa.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(ob=qa.ArrayData,ob=!!ob&&64===(ob[6]&64));return ob}}Object(c.a)(ua,"DdaCellEditDelayRequestHandler",ha.a,[]);var Za=a(768);class Pa extends Za.a{constructor(qa,xa,ob,Ib,Zb,zc,Mc){super(qa,xa,ob);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Ib;this.messageContent=Zb;this.messageOrigin=zc;this.targetOrigin=Mc}}Object(c.a)(Pa,"DialogMessageReceivedEventArgs",
Za.a,[]);class ka extends Za.a{constructor(qa,xa,ob,Ib,Zb,zc,Mc){super(qa,xa,ob);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Ib;this.messageContent=Zb;this.messageOrigin=zc;this.targetOrigin=Mc}}Object(c.a)(ka,"DialogParentMessageReceivedEventArgs",Za.a,[]);var ra=a(1),ba=a(21);class Ua{constructor(qa){this.Ph=this.UZc=null;this.BVi=(xa,ob)=>{this.handlers.kb(ob.controlId)&&(xa=new Pa(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,ob.controlId,
null,ob.messageType,ob.messageContent,ob.messageOrigin,ob.targetOrigin),this.handlers.ma(ob.controlId)(xa),ob.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(ob.controlId))};this.AVi=(xa,ob)=>{this.Unc.kb(ob.controlId)&&(xa=new ka(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,ob.controlId,null,ob.messageType,ob.messageContent,ob.messageOrigin,ob.targetOrigin),this.Unc.ma(ob.controlId)(xa))};this.handlers=new H.a;this.Unc=new H.a;this.Lg=qa;this.Q2a.iOg(this.BVi);
this.Q2a.hOg(this.AVi)}get Q2a(){this.UZc||(this.UZc=C.getInstance(this.contextActivationMgr));return this.UZc}get contextActivationMgr(){!this.Ph&&this.Lg&&(this.Ph=this.Lg.Ph);return this.Ph}addHandler(qa,xa,ob,Ib){if(ra.EwaSettings.oa(23))this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob);else{e.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Zb=zc=>{zc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(qa,
xa),this.Lg.Cv(ob)):(e.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Lg.qf(zc,ob))};this.handlers.kb(qa)?Zb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(qa,Ib,Zb)}}HJg(qa,xa,ob){ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob):(e.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.Unc.ia(qa,xa),this.Lg.Cv(ob))}removeHandler(qa,
xa){ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xa):this.handlers.kb(qa)?(e.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Q2a.lIa(qa,ob=>{this.handlers.remove(qa);ob===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Lg.Cv(xa):(e.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Lg.qf(ob,xa))})):this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
xa)}chj(qa,xa){ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,xa):(e.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Unc.remove(qa),this.Lg.Cv(xa))}showDialog(qa,xa,ob){try{ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&ba.h(this.Lg.$).gb&&ba.h(this.Lg.$).Xo(!0),this.Q2a.showDialog(xa,qa,ob,Ib=>{this.Lg.YJg(this.YZg(Ib))})}catch(Ib){e.ULS.sendTraceTag(537170496,0,10,
`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Ib.message}`),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}YZg(qa){const xa={};xa.InstanceId=qa.id;xa.WebExtensionType=qa.osfControlType===OSF.OsfControlTarget.InContent?0:1;xa.PrimaryMarketplace={};xa.PrimaryMarketplace.SolutionId=qa.solutionId;xa.PrimaryMarketplace.SolutionVersion=qa.version;xa.PrimaryMarketplace.MarketplaceRef=qa.storeId;xa.PrimaryMarketplace.MarketplaceType=qa.storeType;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)&&(xa.OwnerAddinSolutionId=qa.ownerAddinSolutionId,xa.OwnerAddinStoreType=qa.ownerAddinStoreType);return xa}static la(qa){if(!qa.$.da.Aa(232)){const xa=new Ua(qa);qa.$.da.Ga(232,xa)}}}Object(c.a)(Ua,"DialogMessageReceivedEventManager",null,[438]);class Ka{constructor(qa,xa){this.bB=null;this.Tfa=qa;this.ZEg=xa}T0b(qa){qa&&(this.bB||(this.bB=[]),this.bB.push(qa))}Lvc(qa){this.bB&&Array.remove(this.bB,qa)}get eventId(){return this.Tfa}get targetId(){return this.ZEg}get Eai(){return 0<this.bB.length}XFi(qa){return this.eventId!==
qa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===qa.ddaBinding.Name:!0}M3b(qa){this.bB&&Array.forEach(this.bB,xa=>{xa(qa)})}tna(){this.bB=[]}}Object(c.a)(Ka,"DdaEventRegistration",null,[]);class Oa{constructor(qa){this.nF=null;this.Swa=!1;this.Pc=()=>{this.nF.forEach(xa=>{xa.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&xa.M3b(new Za.a(xa.eventId,"",null))})};this.Lg=
qa}invokeDdaMethod(qa,xa){const ob={};ob[ja.a.ng]=qa;ob[ja.a.d4]=xa;this.Lg.CK(974713501,ob)}registerDdaEventAsync(qa,xa,ob,Ib,Zb){Oa.bBb(qa)?(Oa.brd(qa)&&this.ynd(),this.nF||(this.nF=[]),xa=this.Nvb(qa,ob),xa||(xa=new Ka(qa,ob),this.nF.push(xa)),xa.T0b(Ib),this.Lg.Cv(Zb)):this.Lg.qf(-1,Zb)}unregisterDdaEventAsync(qa,xa,ob,Ib,Zb){Oa.bBb(qa)?((qa=this.Nvb(qa,ob))&&qa.Lvc(Ib),this.Lg.Cv(Zb)):this.Lg.qf(-1,Zb)}ynd(){this.Swa||(ba.h(this.Lg.$).ha.QE(this.Pc),this.Swa=!0)}Nvb(qa,xa){if(!this.nF)return null;
for(let ob=0;ob<this.nF.length;ob++){const Ib=this.nF[ob];if(Ib.eventId===qa&&Ib.targetId===xa)return Ib}return null}static bBb(qa){return qa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static brd(qa){return qa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(Oa,"EmbeddingPage",null,[399]);var ib=a(179);class La extends Za.a{constructor(qa,xa,ob,Ib,Zb,zc,Mc,hd){super(qa,xa,ob);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=zc-Ib.Reference.FirstColumn;
this.columnCount=hd;qa=Math.max(Zb,Ib.Reference.FirstRow);Zb=Math.min(Zb+Mc-1,Ib.Reference.LastRow);qa>Zb?this.startRow=this.rowCount=void 0:(this.startRow=qa-Ib.Reference.FirstRow,this.rowCount=Zb-qa+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(c.a)(La,"DdaBindingSelectionEventArgs",Za.a,[]);var db=a(200),Ab=a(24),Mb=a(40),pb=a(48),Qb=a(420),xb=a(33),pa=a(37),Ma=a(565),ya=a(109),
Ea=a(52),Na=a(92),kb=a(12),lb=a(11),oa=a(104);class Ba{}Ba.Czh="ewa-wx-disabled-div";Ba.Bzh="ewa-wx-container-div";Ba.STe="ewa-ptp-nov2-flex";Object(c.a)(Ba,"CssClassNames",null,[]);const sa=Ba.Czh,qb=Ba.Bzh;class Jb extends ib.a{constructor(qa,xa,ob,Ib=!1){super();this.feb=0;this.nF=null;this.Swa=!1;this.Dtc=null;this.SU=0;this.R7b=this.NWa=this.jKc=this.I6d=null;this.mde=!1;this.qRc=this.gea=this.U3d=null;this.Pc=()=>{this.enabled&&(this.wuj(),this.Dtc=Mb.d(ba.h(this.$).ha.ra.selectedRanges))};
this.kaf=Zb=>{Zb.controlId===this.Jd.InstanceId&&Array.forEach(this.nF,zc=>{zc.XFi(Zb)&&zc.M3b(Zb)})};this.tAf=Zb=>{if((Zb=Object(fa.a)(276,Zb))&&!Zb.Fs())if(!this.Jd||OSF.OsfControl.isFirstPartyStoreString(this.Jd.PrimaryMarketplace.MarketplaceType)||this.$.ZY){Zb.pf=this.Jd;Zb.vj=this.Lg;this.U3d=Zb;this.qzc(Zb.eHa);const zc=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&xb.a.gd(this.$)&&lb.HelperMethods.Jw(this.Jd)&&this.Jd.Preload&&!this.Jd.TaskpaneVisible;
zc?Zb.yEd():ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Zb.yEd(),(this.Jd.SharedRuntime&&1===this.Jd.SharedRuntime.LifeTime||this.Jd.SharedRuntimeId)&&!this.Jd.TaskpaneVisible&&Zb.wg(!1)):((this.Jd.SharedRuntime&&1===this.Jd.SharedRuntime.LifeTime||this.Jd.SharedRuntimeId)&&!this.Jd.TaskpaneVisible&&Zb.wg(!1),Zb.yEd());this.q7a||(xb.a.gd(this.$)?zc||Zb.a7():Qb.a(this.$).result.oG(Zb,!0));this.$.da.Aa(77).tWf(this.tAf);this.x$=Object(fa.a)(430,
Zb)}else e.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Zb,zc)=>{3===zc.control.floatingObject.type&&zc.control.floatingObject.yl.InstanceId===this.O1.WebExtensionId&&(this.x$=Object(fa.a)(430,zc.control),this.qzc(zc.control.Kd.firstChild),oa.a(this.$).Dvc(this.onFloatingObjectControlAdded))};this.jb=qa.$;this.Lg=qa;this.Jd=ob;this.Jd.InstanceId=ob.SrcLocationOverrideResourceId?qa.N4a(ob.InstanceId,ob.SrcLocationOverrideResourceId):
ob.InstanceId;this.ii=xa;this.O1={};this.O1.WebExtensionId=ob.InstanceId;this.$Lf="osfControl_"+ob.InstanceId;this.G9c="disabled_"+ob.InstanceId;this.O1.BindingData=ob.BindingData;this.q7a=this.Lg.q7a(ob.InstanceId);this.Nhc=this.Lg.Nhc(ob.InstanceId);this.Khe=ob.WebExtensionOsfControlType;this.kPf=Ib}get controlId(){return this.Jd.InstanceId}whi(qa){this.gea||(this.gea=qa)}dWf(){this.gea&&(this.gea.dispose(),this.gea=null)}get controlType(){return this.Jd.WebExtensionType}get ownerAddinSolutionId(){return this.Jd.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.SU}get Iy(){return this.qRc}get DU(){return this.Jd.SrcLocationOverrideResourceId?
this.Lg.N4a(this.Jd.PrimaryMarketplace.SolutionId,this.Jd.SrcLocationOverrideResourceId):this.Jd.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Jd.SrcLocationOverrideResourceId}get yl(){return this.Jd}get x$(){return this.I6d}set x$(qa){this.I6d=qa}get osfControlType(){return this.Khe}get dua(){return this.jKc}set dua(qa){this.jKc=qa}get Q7b(){return this.NWa}set Q7b(qa){this.NWa=qa}get focusOnIframeWhenLoaded(){return this.Jd.FocusOnIframeWhenLoaded}get Ojc(){return this.mde}set Ojc(qa){this.mde=
qa}Sod(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Jd.PrimaryMarketplace.MarketplaceType)&&ra.EwaSettings.oa(182)){const xa=pb.GetServiceTaskFactory.Na(this.$.da,5,4,0);pa.TaskExtensions.za(xa,()=>{xa.result.mh(36,null)},this.ka,3);return this}if(1===this.Jd.WebExtensionType)pa.TaskExtensions.za(Qb.a(this.$),xa=>{xa.result.ctb(this.$.da,77,5,this.tAf,1)},this.ka,3);else{var qa=this.TYe();const xa=oa.a(this.$);qa||(qa={Type:3},qa.Id=this.O1.WebExtensionId,qa.WebExtensionData=this.Jd,qa.ContentHtml=
"<div/>",qa.Version=0,qa.AbsoluteLeft=0,qa.AbsoluteTop=0,qa.AbsoluteRight=0,qa.AbsoluteBottom=0,qa.Width=0,qa.Height=0,qa.ZOrder=0,qa.OriginDeltaX=0,qa.OriginDeltaY=0,qa=new db.a(qa),xa.C6b(qa,null),qa=xa.Gr(qa.Ng()));qa?(this.qzc(qa.Kd.firstChild),this.x$=Object(fa.a)(430,qa)):xa.J0b(this.onFloatingObjectControlAdded)}return this}wff(qa){this.qzc(qa);return this}Npc(){this.kPf||this.Lg.Ph.purgeOsfControl(this.controlId,!1);this.aig(!0);const qa=this.TYe();qa&&oa.a(this.$).deleteFloatingObject(qa);
this.Lg.hj.Mgj(this.controlId);this.Lg.hj.zQe(this.controlId,!0);this.qRc=null}KEd(qa){this.O1=qa}invokeDdaMethod(qa,xa){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var ob={};ob[ja.a.ng]=qa;ob[ja.a.d4]=xa;this.Lg.CK(974713501,ob)}else this.Lg.qf(ca.a.ZMa,xa)}eej(qa,xa,ob,Ib){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Jb.vph(qa)||void 0!==xa&&null!==xa&&void 0!==this.i4a(xa)&&null!==this.i4a(xa))if(e.ULS.sendTraceTag(36444195,
0,50,`eventId: ${qa}, targetId: ${xa}`),Jb.Uif(qa)&&this.Cci(),Jb.brd(qa)&&this.ynd(),Jb.Sif(qa))ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Lg.$.da.Aa(232).addHandler(this.controlId,ob,Ib,xa);else if(Jb.Tif(qa))ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Lg.$.da.Aa(232).HJg(this.controlId,ob,Ib);else{Jb.Rif(qa)&&this.maf(-1777565636,Ib);this.nF||(this.nF=[]);var Zb=this.Nvb(qa,
xa);Zb||(Zb=new Ka(qa,xa),this.nF.push(Zb));Zb.tna();Zb.T0b(ob);this.Lg.Cv(Ib);qa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.NWa&&(this.R7b=ob)}else this.Lg.qf(3002,Ib);else this.Lg.qf(-1,Ib)}LWj(qa,xa,ob,Ib){Jb.Sif(qa)?ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Lg.$.da.Aa(232).removeHandler(this.controlId,Ib):Jb.Tif(qa)?ra.EwaSettings.oa(23)?this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ib):this.Lg.$.da.Aa(232).chj(this.controlId,
Ib):(Jb.Rif(qa)&&this.maf(1592314317,Ib),xa=this.Nvb(qa,xa),this.enabled?(xa&&(xa.Lvc(ob),xa.Eai||Array.remove(this.nF,xa),this.nF.length?Jb.Uif(qa)&&this.cig(!1):this.aig(!1)),this.Lg.Cv(Ib)):this.Lg.qf(-1,Ib))}la(qa){kb.DOMElementExtensions.getElementById(qa,this.$Lf)||qa.appendChild(kb.DOMElementExtensions.tf(this.Iy))}showHide(qa){kb.DOMElementExtensions.setVisible(this.Iy,qa)}resize(qa,xa){kb.DOMElementExtensions.Zv(this.Iy,qa);kb.DOMElementExtensions.gJ(this.Iy,xa)}tNe(qa){if(!this.SU&&!kb.DOMElementExtensions.getElementById(this.Iy,
this.G9c)&&this.Iy){const xa=document.createElement("div");xa.id=this.G9c;xa.className=sa;xa.style.backgroundImage="url("+Ea.a.current.io(103)+")";xa.style.opacity=qa?"1":"0";xa.style.backgroundRepeat="no-repeat";xa.style.backgroundPosition="center";this.Iy.insertBefore(xa,this.Iy.firstChild)}this.SU++}ish(){0<this.SU&&this.SU--;this.SU||(kb.DOMElementExtensions.tf(kb.DOMElementExtensions.getElementById(this.Iy,this.G9c)),this.Swa&&!Mb.Q(this.Dtc,ba.h(this.$).ha.ra.selectedRanges)&&this.Pc(null,null))}i4a(qa){if(!this.O1||
!this.O1.BindingData)return null;for(let xa=0;xa<this.O1.BindingData.length;xa++)if(this.O1.BindingData[xa].Name===qa)return this.O1.BindingData[xa];return null}getDefaultIconUrl(){const qa=this.O6e();return qa?qa.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Jd.TaskpaneTitle)return this.Jd.TaskpaneTitle;const qa=this.O6e();return qa?qa.getDefaultDisplayName():null}kQf(){if(this.NWa&&this.R7b){const qa=new Za.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.NWa);
this.R7b(qa);this.R7b=this.NWa=null}}wg(qa){this.U3d&&this.U3d.wg(qa)}Cwj(){this.$.ea.isNamedObjectViewMode&&this.Hri()&&(this.$.da.Aa(34).Bwj(this.Iy),this.showHide(!1));if(this.Lg.A4j){if(!this.kPf){const qa={};qa.div=this.Iy;qa.id=this.Jd.InstanceId;qa.solutionId=this.Jd.PrimaryMarketplace.SolutionId;qa.version=this.Jd.PrimaryMarketplace.SolutionVersion;qa.storeId=this.Jd.PrimaryMarketplace.MarketplaceRef;qa.storeType=this.Jd.PrimaryMarketplace.MarketplaceType;qa.ownerAddinSolutionId=this.Jd.OwnerAddinSolutionId;
qa.ownerAddinStoreType=this.Jd.OwnerAddinStoreType;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?this.Jd.AssetMarketplace?(qa.assetId=this.Jd.AssetMarketplace.SolutionId,qa.assetStoreId=this.Jd.AssetMarketplace.MarketplaceRef):(qa.assetId=null,qa.assetStoreId=null):this.Jd.AssetMarketplace&&(qa.assetId=this.Jd.AssetMarketplace.SolutionId,qa.assetStoreId=this.Jd.AssetMarketplace.MarketplaceRef);qa.settings=this.Jd.OsfPropertyBag;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
qa.reason=this.q7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Nhc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:qa.reason=this.q7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;qa.osfControlType=0===this.Jd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;qa.isForUILessAction=4===
this.Jd.WebExtensionOsfControlType;qa.sourceLocationOverrideResourceId=this.Jd.SrcLocationOverrideResourceId;qa.focusOnIframeWhenLoaded=this.Jd.FocusOnIframeWhenLoaded;Ma.a(this.Jd)&&(qa.featureGates=r.AFrameworkApplication.fa.g4e(qa.solutionId));qa.hostInfoFlags=0;this.dua&&(qa.hostInfoFlags|=2);lb.HelperMethods.Jw(this.Jd)&&(qa.hostInfoFlags|=1);this.$.ZY||(e.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),qa.hostInfoFlags|=4);ra.EwaSettings.oa(595)&&(qa.hostInfoFlags|=
8);ra.EwaSettings.oa(52)&&ra.EwaSettings.oa(92)&&!this.jKc&&(qa.virtualOsfControlActivationCallback=()=>{this.Lg.QFd(this.Jd)});qa.sharedRuntimeId=this.Jd.SharedRuntime?this.Jd.SharedRuntime.Resid:this.Jd.SharedRuntimeId;!lb.HelperMethods.Jw(this.Jd)||this.Jd.Preload||Ma.a(this.Jd)||this.Lg.Ph.getOsfControl(a(737).DdaFacade.getSolutionId(this.Jd,this.$))||(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Lg.QFd(this.Jd):this.Lg.QFd(this.Jd));
qa.initialDisplayMode=this.Jd.TaskpaneVisible?2:1;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(qa.titleOverride=this.yl.TaskpaneTitle);this.Lg.Ph.insertOsfControl(qa)}this.SU=0}else this.tNe(!0)}aig(qa){this.cig(qa);this.uWj()}Cci(){this.feb||this.ii.T0b(this.kaf);this.feb++}cig(qa){0<this.feb&&(qa?this.feb=0:this.feb--,this.feb||this.ii.Lvc(this.kaf))}ynd(){if(!this.Swa){const qa=ba.h(this.$).ha;this.Dtc=Mb.d(ba.h(this.$).ha.ra.selectedRanges);qa.QE(this.Pc);this.Swa=
!0}}uWj(){this.Swa&&(ba.h(this.$).ha.FI(this.Pc),this.Swa=!1)}wtj(qa){var xa=new Ab.Range(qa.Reference.FirstRow+1,qa.Reference.FirstColumn+1,qa.Reference.LastRow+1,qa.Reference.LastColumn+1,!1,!1);1===qa.BindingType&&(qa.HasHeaders&&--xa.top,qa.HasTotals&&(xa.bottom+=1));var ob=ba.h(this.$).ha.ra.selectedRanges;qa=xa.oAb(this.Dtc);ob=xa.oAb(ob);return(xa=xa.He(ba.h(this.$).ha.ra.activeRange))&&(ya.e(qa)&&!ya.e(ob)||!ya.e(qa)&&!ya.e(ob)&&!Mb.Q(qa,ob))?xa:null}wuj(){Array.forEach(this.nF,qa=>{if(qa.eventId!==
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&qa.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Lg.hj.d2b(this.controlId))if(qa.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)qa.M3b(new Za.a(qa.eventId,this.controlId,null));else if(qa.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const xa=this.i4a(qa.targetId);if((null===xa||void 0===xa?0:xa.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Cb.na.sheetName:this.$.va.na.name)===
xa.Reference.SheetName){const ob=this.wtj(xa);ob&&qa.M3b(new La(qa.eventId,this.controlId,this.Lg.T2b(xa),xa,ob.top-1,ob.left-1,ob.height,ob.width))}}})}Nvb(qa,xa){if(!this.nF)return null;for(let ob=0;ob<this.nF.length;ob++){const Ib=this.nF[ob];if(Ib.eventId===qa&&Ib.targetId===xa)return Ib}return null}TYe(){const qa=oa.a(this.$).nV;for(let xa=qa.length-1;0<=xa;--xa){const ob=qa[xa];if(3===ob.floatingObject.type&&ob.floatingObject.yl.InstanceId===this.O1.WebExtensionId)return ob}return null}Hri(){for(let qa=
0;qa<this.$.Cb.count;qa++)if(this.$.Cb.getItem(qa).imageId===this.O1.WebExtensionId)return!0;return!1}qzc(qa){this.qRc=qa;this.Iy.id=this.$Lf;this.Iy.className=qb;this.Iy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Cwj()}O6e(){if(!this.enabled)return null;const qa=Ma.a(this.yl)?"":this.yl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.yl.PrimaryMarketplace.SolutionId,qa)}maf(qa,xa){if(ra.EwaSettings.oa(23))this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
xa);else try{if(e.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Khe)this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,xa);else{const ob={};ob[aa.a.kpb]=this.controlId;const Ib=new Na.a(qa,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Lb(Ib,ob);this.Lg.Cv(xa)}}catch(ob){e.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${ob.message}.`),this.Lg.qf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
xa)}}static vph(qa){return qa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||qa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Uif(qa){return qa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||qa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||qa===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static brd(qa){return qa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||qa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Sif(qa){return qa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Tif(qa){return qa===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Rif(qa){return qa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Jb,"OsfControl",ib.a,[439]);class Yb{constructor(){this.m_a={}}add(qa){this.m_a[qa]=!0}remove(qa){delete this.m_a[qa]}clear(){for(const qa of Object.keys(this.m_a))delete this.m_a[qa]}Abf(){return 0<Object.keys(this.m_a).length}gOh(){return Object.keys(this.m_a)}}Object(c.a)(Yb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,
[]);var jb=a(58);class ab{constructor(qa,xa,ob){this.UUf=this.TUf=0;this.ENb=this.Vbb=null;this.aOi=()=>{var Ib=ba.h(this.$).ha.Ta.aB;if(this.Lqd(Ib)&&(Ib=this.Zwb(Ib))){var Zb={};Zb.chartId=Ib;Zb.worksheetId=this.bka();Zb=jb.a.fc(Zb);this.Aja(51,Ib,Zb);this.Aja(51,this.bka(),Zb)}};this.bOi=()=>{if(this.Vbb){var Ib={};Ib.chartId=this.Vbb;Ib.worksheetId=this.ENb;Ib=jb.a.fc(Ib);this.Aja(52,this.Vbb,Ib);this.Aja(52,this.ENb,Ib)}Ib=ba.h(this.$).ha.Ta.aB;this.Lqd(Ib)?(this.Vbb=this.Zwb(Ib),this.ENb=this.bka()):
this.ENb=this.Vbb=null};this.$=qa;this.hj=xa;this.ii=ob}mqb(qa){51===qa.messageType?this.TUf=this.tHa(qa.actionType,this.TUf,this.aOi):52===qa.messageType&&(this.UUf=this.tHa(qa.actionType,this.UUf,this.bOi))}tHa(qa,xa,ob){if(1===qa)xa||ba.h(this.$).ha.Ta.dYc(ob),xa++,this.qAj();else if(2===qa){if(1>xa)return xa;1===xa&&ba.h(this.$).ha.Ta.hNd(ob);xa--}return xa}Aja(qa,xa,ob){xa&&this.hj.C_(qa,xa)&&this.ii.mN(qa,xa,ob)}Zwb(qa){return qa&&qa.floatingObject?(qa=qa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===qa.length?qa[0]:null:null}bka(){const qa=this.$.va.na;return qa&&0===qa.uG?qa.sheetId:null}qAj(){const qa=ba.h(this.$).ha.Ta.aB;this.Lqd(qa)&&(this.Vbb=this.Zwb(qa),this.ENb=this.bka())}Lqd(qa){return!!qa&&!!qa.floatingObject&&0===qa.floatingObject.type}}Object(c.a)(ab,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var vb=a(741),Da=a(193),Fa=a(612),nb=a(100),Ta=a(350),V=a(55);class va extends ha.a{constructor(qa,xa,ob){super();this.SU=this.DAa=0;this.Pc=(Ib,Zb)=>{if(this.enabled&&!(this.Kkf()||
null!==Zb&&void 0!==Zb&&Zb.Ynf)&&(Ib=Object(fa.a)(nb.a,this.$.va.na))&&0===Ib.uG){const zc=Ib.sheetId,Mc=this.e3e();let hd=null,id=null;this.hj.Mnf()&&(hd=this.grid.Ab.Cj(this.grid.ha.ra.activeCell),id=zc in this.Jlc?this.Jlc[zc]:null);this.Owe(zc,Mc)&&pa.TaskExtensions.za(V.Task.Ra(!0),()=>{this.Z$h(zc,Mc);this.K$h(zc,Mc,hd,id)},this.ka);this.sOe(zc,Mc,hd)}};this.$=qa;this.hj=xa;this.ii=ob;this.grid=ba.h(qa);this.AOa={};this.Jlc={}}get enabled(){return!this.SU&&0<this.DAa}z2b(qa){Object(fa.a)(Ta.a,
this.$.va);1===qa.actionType?(this.DAa||this.grid.ha.QE(this.Pc),this.DAa++):2!==qa.actionType||1>this.DAa||(1===this.DAa&&this.grid.ha.FI(this.Pc),this.DAa--)}azc(qa){qa?this.SU++:(0<this.SU&&this.SU--,this.SU||this.Pc(null,new Fa.a(!1)))}e3e(){return this.grid.ha.ra.selectedRanges}Owe(qa,xa){return ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!qa&&Da.e(this.AOa)||qa in this.AOa)&&!Mb.Q(this.AOa[qa],xa):qa in this.AOa&&!Mb.Q(this.AOa[qa],
xa)}sOe(qa,xa,ob){this.AOa[qa]=Mb.d(xa);this.Jlc[qa]=ob}Kkf(){return this.grid.gb||this.grid.ji}pZe(qa,xa){this.hj.C_(14,qa)&&this.ii.mN(14,qa,xa);this.hj.C_(14,vb.a.nX)&&this.ii.mN(14,vb.a.nX,xa)}Z$h(qa,xa){const ob={};ob.worksheetId=qa;ob.address=this.Cjd(xa);xa=jb.a.fc(ob);this.pZe(qa,xa)}K$h(qa,xa,ob,Ib){if(this.hj.Mnf()){var Zb="";let zc="";Ib&&(Zb=Ib.Ui);ob&&(zc=ob.Ui);Ib?ob?(xa=ob.usedRange.oAb(xa),Zb!==zc&&this.nbc(Zb,"",qa),this.nbc(zc,this.Cjd(xa),qa)):this.nbc(Zb,"",qa):ob&&(Zb=ob.usedRange.oAb(xa),
this.nbc(zc,this.Cjd(Zb),qa))}}nbc(qa,xa,ob){if(this.hj.C_(100,qa)){const Ib={};Ib.address=xa;Ib.worksheetId=ob;this.ii.mN(100,qa,jb.a.fc(Ib))}}Cjd(qa){return Mb.i(qa,",",this.$,!1)}dispose(){0<this.DAa&&this.grid.ha.FI(this.Pc);this.Jlc=this.AOa=null;this.DAa=0;this.ii=this.hj=this.$=this.grid=null}}Object(c.a)(va,"RichApiEventSelectionChangedHandler",ha.a,[]);var wb=a(346);class fc extends va{constructor(qa,xa,ob){super(qa,xa,ob);this.Zpf=this.$pf=null}e3e(){return wb.a.ntb(this.grid.ha.rangePicker.nL)}Owe(qa,
xa){return this.$pf!==qa||!Mb.Q(this.Zpf,xa)}sOe(qa,xa){this.$pf=qa;this.Zpf=Mb.d(xa)}Kkf(){return!this.grid.gb&&!this.grid.ji}pZe(qa,xa){this.hj.C_(2700,vb.a.nX)&&this.ii.mN(2700,vb.a.nX,xa)}}Object(c.a)(fc,"RichApiEventPickedRangesChangedHandler",va,[]);class Fc{constructor(qa,xa,ob){this.xRa=this.wRa=0;this.SHa=this.Yha=null;this.RDf=()=>{var Ib=ba.h(this.$).ha.Ta.aB;if(0<this.xRa&&this.Yha&&this.SHa){var Zb={};Zb.shapeId=this.Yha;Zb.worksheetId=this.SHa;Zb=jb.a.fc(Zb);this.fireEvent(2102,this.Yha,
Zb)}this.uti(Ib)?(this.Yha=this.WUj(Ib),this.SHa=this.bka(),this.Yha&&this.SHa)?0<this.wRa&&(Ib={},Ib.shapeId=this.Yha,Ib.worksheetId=this.SHa,Ib=jb.a.fc(Ib),this.fireEvent(2101,this.Yha,Ib)):e.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Yha}', or worksheet id: '${this.SHa}' from a Floating object or gridview.`):this.SHa=this.Yha=null};this.$=qa;this.hj=xa;this.ii=ob}mqb(qa){const xa=ba.h(this.$).ha;1===qa.actionType?(this.wRa||this.xRa||xa.Ta.dYc(this.RDf),
2101===qa.messageType?this.wRa++:2102===qa.messageType&&this.xRa++):2===qa.actionType&&(2101===qa.messageType?this.wRa=0<this.wRa?this.wRa-1:0:2102===qa.messageType&&(this.xRa=0<this.xRa?this.xRa-1:0),this.wRa||this.xRa||xa.Ta.hNd(this.RDf))}uti(qa){return!!qa&&!!qa.floatingObject&&(0===qa.floatingObject.type||7===qa.floatingObject.type||1===qa.floatingObject.type||3===qa.floatingObject.type||5===qa.floatingObject.type)}WUj(qa){if(!qa||!qa.floatingObject)return null;qa=qa.floatingObject.id;var xa=
qa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));xa=xa&&1===xa.length?xa[0]:null;return xa?xa:(e.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${qa}', but we failed.`),null)}bka(){const qa=this.$.va.na;return qa&&0===qa.uG?qa.sheetId:null}fireEvent(qa,xa,ob){xa&&this.hj.C_(qa,xa)&&this.ii.mN(qa,xa,ob)}}Object(c.a)(Fc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Qa{constructor(qa,xa,ob){this.XUf=this.WUf=this.YUf=this.VUf=
0;this.v0i=(Ib,Zb)=>{Ib=Object(fa.a)(nb.a,Zb.na);this.$8a(Ib)&&(Zb={},Zb.worksheetId=Ib.sheetId,Zb=jb.a.fc(Zb),this.Aja(11,Ib.sheetId,Zb))};this.y0i=(Ib,Zb)=>{Ib=Object(fa.a)(nb.a,Zb.UD);this.$8a(Ib)&&(Zb={},Zb.worksheetId=Ib.sheetId,Zb=jb.a.fc(Zb),this.Aja(12,Ib.sheetId,Zb))};this.w0i=(Ib,Zb)=>{Ib=Object(fa.a)(nb.a,Zb.na);this.$8a(Ib)&&(Zb={},Zb.worksheetId=Ib.sheetId,Ib=jb.a.fc(Zb),this.Aja(11,null,Ib,!0))};this.x0i=(Ib,Zb)=>{Ib=Object(fa.a)(nb.a,Zb.UD);this.$8a(Ib)&&(Zb={},Zb.worksheetId=Ib.sheetId,
Ib=jb.a.fc(Zb),this.Aja(12,null,Ib,!0))};this.$=qa;this.hj=xa;this.ii=ob}mqb(qa){11===qa.messageType?qa.targetId===vb.a.nX?this.hUg(qa.actionType):this.gUg(qa.actionType):12===qa.messageType&&(qa.targetId===vb.a.nX?this.iUg(qa.actionType):this.jUg(qa.actionType))}gUg(qa){this.VUf=this.tHa(qa,this.VUf,this.v0i)}jUg(qa){this.YUf=this.tHa(qa,this.YUf,this.y0i)}hUg(qa){this.WUf=this.tHa(qa,this.WUf,this.w0i)}iUg(qa){this.XUf=this.tHa(qa,this.XUf,this.x0i)}tHa(qa,xa,ob){1===qa?xa=this.C_c(xa,ob):2===qa&&
(xa=this.u9c(xa,ob));return xa}C_c(qa,xa){qa||this.$.va.Wf(xa);qa++;return qa}u9c(qa,xa){if(1>qa)return qa;1===qa&&this.$.va.Dg(xa);qa--;return qa}$8a(qa){return!!qa&&0===qa.uG}Aja(qa,xa,ob,Ib=!1){xa=Ib?vb.a.nX:xa;this.hj.C_(qa,xa)&&this.ii.mN(qa,xa,ob)}}Object(c.a)(Qa,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var la=a(240),hb=a(14),Kb=a(224);class dc extends Sys.EventArgs{constructor(qa,xa,ob,Ib){super();this.sheet=qa;this.q2g=xa;this.offsetX=ob;this.offsetY=Ib}}Object(c.a)(dc,"ClickInActiveCellEventArgs",
Sys.EventArgs,[]);class sb{constructor(qa,xa,ob){this.b5b=null;this.Kud=!1;this.onPointerDown=Ib=>{let Zb;3===Ib.tb?({p1a:Zb}=this.gridView.Dcc(Ib.clientPoint),this.Kud=!!Zb&&this.gridView.ha.ra.AOe(Zb)):this.Kud=!1;this.b5b=Ib.clientPoint;return!1};this.fd=Ib=>{if(this.gridView.inRangePicker||this.gridView.ji||this.Kud||Ib.shiftKey||Ib.ctrlKey||Ib.Ca.button!==Sys.UI.MouseButton.leftButton||!this.b5b||!Ib.clientPoint||Ib.clientPoint.x!==this.b5b.x||Ib.clientPoint.y!==this.b5b.y)return!1;const Zb=
({p1a:Ib}=this.gridView.Dcc(Ib.clientPoint)).returnValue,zc=Object(fa.a)(nb.a,this.$.va.na);if(Zb&&zc&&0===zc.uG){if(!this.gridView.ha.ra.H4.contains(Ib))return!1;Ib=new dc(zc,Ib,lb.HelperMethods.CHd(Zb.x),lb.HelperMethods.CHd(Zb.y));this.z0i(Ib)}return!1};this.$=qa;this.gridView=ba.h(qa);this.hj=xa;this.ii=ob;this.Dfj()}dispose(){this.hXj()}Dfj(){for(const qa of this.gridView.Ln){const xa=qa.domElement;la.a.instance.sa(hb.a.pointerDown,xa,this.onPointerDown);Kb.a.instance.sa(hb.a.click,xa,this.fd)}}hXj(){for(const qa of this.gridView.Ln){const xa=
qa.domElement;la.a.instance.Ba(hb.a.pointerDown,xa,this.onPointerDown);Kb.a.instance.Ba(hb.a.click,xa,this.fd)}}z0i(qa){var xa=qa.sheet;if(this.$8a(xa)){var ob={};ob.worksheetId=xa.sheetId;ob.address=qa.q2g.toString();ob.offsetX=qa.offsetX;ob.offsetY=qa.offsetY;qa=xa.sheetId;this.hj.C_(21,qa)&&(xa=jb.a.fc(ob),this.ii.mN(21,qa,xa));qa=vb.a.nX;this.hj.C_(21,qa)&&(ob=jb.a.fc(ob),this.ii.mN(21,qa,ob))}}$8a(qa){return!!qa&&0===qa.uG}}Object(c.a)(sb,"RichApiEventSingleClickedHandler",null,[]);class bb{constructor(qa,
xa,ob){this.UJb=0;this.Lbb=this.Sbb=null;this.$Kf=()=>{const Ib=ba.h(this.$).ha.Ta.aB;if(Ib)if(this.Cof(Ib)){const Zb=this.bka();this.Wdd(Zb);this.Sbb=Ib.floatingObject.id;this.Lbb=Zb}else this.Sbb&&(this.Wdd(this.Lbb),this.Lbb=this.Sbb=null);else this.Sbb&&(this.Wdd(this.Lbb),this.Lbb=this.Sbb=null)};this.$=qa;this.hj=xa;this.ii=ob}z2b(qa){2E3===qa.messageType&&(1===qa.actionType?(this.UJb||ba.h(this.$).ha.Ta.dYc(this.$Kf),this.UJb++,this.Jwj()):2===qa.actionType&&this.UJb&&(1===this.UJb&&ba.h(this.$).ha.Ta.hNd(this.$Kf),
this.UJb--))}Wdd(qa){var xa;const ob={};ob.worksheetId=qa;ob.revisionLoad=!1;if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(ra.EwaSettings.oa(666)||ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Ib=ba.h(this.$).ha.Ta.aB;(null===(xa=null===Ib||void 0===Ib?void 0:Ib.floatingObject)||void 0===xa?0:xa.Vc)?ob.selectedVisualId=Ib.floatingObject.Vc.VisualID:ob.selectedVisualId=null}xa=
jb.a.fc(ob);qa&&this.hj.C_(2E3,qa)&&this.ii.mN(2E3,qa,xa)}bka(){const qa=this.$.va.na;return qa&&0===qa.uG?qa.sheetId:null}Jwj(){const qa=ba.h(this.$).ha.Ta.aB;this.Cof(qa)&&(this.Sbb=qa.floatingObject.id,this.Lbb=this.bka())}Cof(qa){return!!qa&&qa.hvd()}}Object(c.a)(bb,"RichApiEventVisualSelectionChangedHandler",null,[]);class Ob{constructor(qa,xa,ob){this.VJb=0;this.$ng=!0;this.Cbc=0;this.Itd=!0;this.mDe=()=>{const Ib=document.hasFocus();if(this.$ng!==Ib){if(Ib){const Zb=jb.a.fc({});this.ii.mN(2203,
vb.a.nX,Zb)}this.$ng=Ib}};this.nDe=Ib=>{(0<Ib.timeRemaining()||Ib.didTimeout)&&this.mDe();window.requestIdleCallback(this.nDe)};this.$=qa;this.hj=xa;this.ii=ob;window.requestIdleCallback||(this.Itd=!1)}fUg(qa){1===qa.actionType?(this.VJb||this.yUg(),this.VJb++):2!==qa.actionType||1>this.VJb||(1===this.VJb&&this.kmh(),this.VJb--)}yUg(){if(this.hj.C_(2203,vb.a.nX))if(this.Itd){const qa={};qa.timeout=this.$.ya.CheckFocusTimeout;this.Cbc=window.requestIdleCallback(this.nDe,qa)}else this.Cbc=window.setInterval(this.mDe,
this.$.ya.CheckFocusTimeInterval)}kmh(){this.Itd?window.cancelIdleCallback(this.Cbc):window.clearInterval(this.Cbc)}}Object(c.a)(Ob,"RichApiEventWorkbookActivatedHandler",null,[]);var gc;(function(qa){qa[qa.none=0]="none";qa[qa.registerEvent=1]="registerEvent";qa[qa.unregisterEvent=2]="unregisterEvent";qa[qa.customFunction=3]="customFunction";qa[qa.showCard=4]="showCard";qa[qa.createWorkbook=5]="createWorkbook";qa[qa.openWorkbook=6]="openWorkbook";qa[qa.enableEvents=7]="enableEvents";qa[qa.closeWorkbook=
8]="closeWorkbook";qa[qa.setCalculationMode=9]="setCalculationMode";qa[qa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";qa[qa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";qa[qa.workbookLinksEnableContent=12]="workbookLinksEnableContent";qa[qa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";qa[qa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";qa[qa.rangePicker=15]="rangePicker";qa[qa.enableRichApiRecording=16]="enableRichApiRecording";qa[qa.recordAction=
17]="recordAction";qa[qa.focus=18]="focus";qa[qa.businessBarShow=19]="businessBarShow";qa[qa.businessBarHide=20]="businessBarHide"})(gc||(gc={}));Object(c.b)("PostProcessActionType",gc);var mb=a(250);class Nb{constructor(qa,xa,ob){this.aMf=null;this.Udd=(Ib,Zb)=>{const zc=vb.a.nX,Mc={};Mc.eventId=Ib;Mc.payload=Zb;this.hj.C_(2201,zc)&&this.ii.mN(2201,zc,jb.a.fc(Mc))};this.$=qa;this.hj=xa;this.ii=ob;this.Ygi()}eUg(qa){1===qa.actionType?(this.$.Zba=!0,Object(fa.a)(a(737).DdaFacade,mb.a(this.$)).Vdd(!0)):
2===qa.actionType&&(this.$.Zba=!1);this.aMf=qa.controlId;e.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${gc[qa.actionType]}; controlId: ${this.aMf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Zba}.`)}tth(qa){Object(fa.a)(a(737).DdaFacade,mb.a(this.$)).sZe(qa,this.$.Zba)}Ygi(){this.$.XV&&pa.TaskExtensions.za(pb.GetServiceTaskFactory.Na(this.$.da,297,298,1),qa=>{(qa=qa.result)&&qa.init(this.Udd)},this.$.ka,3)}}Object(c.a)(Nb,"RichApiMacroRecorderEventHandler",
null,[]);class ic{}Object(c.a)(ic,"SessionRecreationInfo",null,[]);class gb{constructor(qa,xa,ob){this.$=qa;this.hj=xa;this.runtimeCalculationMode=ob}NJi(){return ra.EwaSettings.oa(248)?this.hj.Qai()||0!==this.runtimeCalculationMode:!1}jZg(){var qa={};qa.eventRegistrationInfos=this.hj.rUh();qa.runtimeCalculationMode=this.runtimeCalculationMode;qa=Object(b.a)(new ic,{runtimeState:qa});const xa={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};xa.RequestBody=JSON.stringify(qa);
xa.RequestFlags=1;return xa}}Object(c.a)(gb,"RichApiRuntimeStateHandler",null,[]);class Eb{constructor(qa,xa,ob,Ib,Zb,zc,Mc,hd,id){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=qa;this.processUtcTime=xa;this.dequeueUtcTime=ob;this.inQueueDurationInMS=Ib;this.executionDurationInMS=Zb;this.operationCount=zc;this.ServerCorrelationId=
Mc;this.UserOperationName=hd;this.IsDocumentHidden=id}}Object(c.a)(Eb,"UserOperationQueueItemsStatisticsData",null,[]);var Lc=a(331),Ec=a(31),Cb=a(19),eb=a(295),Sb=a(50),ld=a(595),bd=a(66),ec=a(59),sc=a(71);class Dc extends Lc.a{constructor(qa,xa,ob){super(ob,qa);this.uwa=this.hashCode=null;this.a6b=!1;this.Zm=(Ib,Zb)=>{Zb.Yc.hash===this.hashCode&&this.uwa&&Object(fa.a)(a(737).DdaFacade,this.$.da.Aa(35)).FHj(this.uwa.InstanceId)};this.sf=(Ib,Zb)=>{switch(Zb.Yc.block.state){case 1:case 3:case 5:this.sea(Zb)}};
this.Jj=()=>{this.hJb(!0)};this.Po=(Ib,Zb)=>{this.isVisible&&this.iVa(Zb.UD);this.clearCache()};this.ue=(Ib,Zb)=>{this.lUa(Zb.na,!!Zb.UD)};this.mO=()=>{this.$.ea.Sma()};this.LVa=xa;this.domElement.classList.add(Ec.a.bac);this.domElement.classList.add(Cb.a.Do);ob.tabIndex=0;this.lUa(this.$.na,!1);this.Gc.la("mousedown",this.mO);this.Gc.la("contextmenu",Ib=>{sc.g(Ib)});this.$.va.LJ(this.Po);this.$.Cb.LJ(this.Po);this.$.Cb.Wf(this.ue);this.$.va.Wf(this.ue);this.Da.pt(this.sf);this.Da.gH(this.Zm);this.Da.lw(this.Jj);
this.pv(this.kza)}get Da(){return this.LVa}dispose(){this.$&&(this.$.va.uL(this.Po),this.$.Cb.uL(this.Po),this.$.Cb.Dg(this.ue),this.$.va.Dg(this.ue));this.LVa&&(this.LVa.dr(this.sf),this.LVa.EI(this.Zm),this.LVa.jx(this.Jj));this.Ny(this.kza);this.clearCache();W.a.Ia(this.LVa);this.LVa=null;kb.DOMElementExtensions.tf(this.domElement);super.dispose()}Bwj(qa){kb.DOMElementExtensions.tf(kb.DOMElementExtensions.getElementById(this.domElement,qa.id));this.domElement.appendChild(qa)}fpd(){if(this.uwa&&
!this.a6b){var qa=Object(fa.a)(a(737).DdaFacade,mb.a(this.$)).yn(this.uwa.InstanceId);qa&&(qa.resize(this.uwa.Width,this.uwa.Height),qa.la(this.domElement),qa.showHide(!0),this.a6b=!0)}}b9a(){return!0}sea(qa){this.uwa=qa.Yc.block.pe;this.a6b=!1;this.fpd()}iVa(qa){this.$.ea.t5&&qa&&(qa.dv||(qa.dv=new eb.a),qa.dv.fi=new Sb.a(this.domElement.scrollLeft,this.domElement.scrollTop),qa.dv.AIb=20)}clearCache(){this.Da.DRa(this.hashCode);this.uwa=this.hashCode=null;this.a6b=!1}lUa(qa,xa){if(this.isVisible=
!!qa&&bd.o(qa))this.hashCode=this.Da.psa(qa,ec.a.h8b,this.hashCode),this.Fzc(xa)}static uHa(qa){if(!qa.da.Aa(34)){const xa=qa.vf;qa.da.Ga(34,new Dc(qa,new ld.a(qa,qa.ea,qa.pa.Ok,3,0),xa.appendChild(xa.ownerDocument.createElement("div"))))}}}Object(c.a)(Dc,"WebExtensionView",Lc.a,[433,434,3]);var Ud=a(226),Ed=a(374),$d=a(439),ve=a(188),ze=a(60),We=a(116),md=a(47),$b=a(46),$c=a(153),nd=a(110),Oc=a(62),Gd=a(28),Qd=a(29),Ad=a(283),Sd=a(22),Ce=a(13),we=a(282),Td=a(740),he=a(51),ee=a(147),ge=a(867);const re=
qa=>{ee.a.sendOtelEvent(Object.assign(new ge.a,{otelEvent:qa}))},Be=qa=>{ee.a.sendOtelCustomerContent(Object.assign(new ge.a,{otelEvent:qa}))};var Oe=a(201),gf=a(866),af=a(25),Ze=a(223);a.d(E,"DdaFacade",function(){return Xa});class Xa extends Ya.a{constructor(qa,xa){super();this.ii=this.Hm=this.ea=null;this.Cf=[];this.TJa=null;this.disposed=this.initialized=this.hSb=this.ZKe=!1;this.YCa=null;this.Vrc=[];this.TKe=[];this.CQa=[];this.F2a=null;this.tHd=new X.a(Aa.a.ak());this.n1b=new Q.a(Aa.a.ak());
this.iIb=[];this.tNf=[];this.l8b=350;this.bya=this.zfa=null;this.cWc=!1;this.dke=this.cke=this.bke=this.$je=this.Wje=this.ake=this.Xje=this.Zje=this.Vje=this.Yje=null;this.Bf=()=>{this.YCa=this.ea.Lo.WebExtensions;for(var ob=this.Cf.length-1;0<=ob;--ob){var Ib=this.Cf[ob],Zb;if(Zb=!this.QHh(Ib.controlId))Zb=Ib,Zb=ra.EwaSettings.oa(119)?!Zb.dua:!0;Zb&&(Ib.Npc(),this.Cf.splice(ob,1))}if(this.YCa)for(let zc=0,Mc=this.YCa.length;zc<Mc;zc++)ob=this.YCa[zc],(Ib=this.yn(ob.WebExtensionId))&&Ib.KEd(ob)};
this.Qqc=ob=>{this.raiseEvent("csc",ob.getID())};this.WEd=(ob,Ib,Zb)=>{if(Ib===OSF.AgaveHostAction.KeyboardShortcuts){var zc=Object(fa.a)(Object,Zb);Ib={};Ib.keyCode=zc.keyCode;Ib.type="keydown";Ib.ctrlKey=zc.ctrlKey;Ib.shiftKey=zc.shiftKey;Ib.altKey=zc.altKey;Ib.metaKey=zc.metaKey;zc=this.yn(ob);ob=zc.x$;Ib.srcElement=Object(Ca.a)(276,ob)?ob.eHa:ba.h(this.$).mc;ob=new Sys.UI.DomEvent(Ib);zc=Xa.Hva(zc.yl,this.$);Ib={};Ib.focusedAddinId=zc;zc=new Na.a(1461300262,1,this.$.Hc,6,null);ba.h(this.$).JLb(ob,
zc,Ib)}else if(Ib===OSF.AgaveHostAction.Select)this.Y$e(!0);else if(Ib===OSF.AgaveHostAction.UnSelect)this.Y$e(!1);else if(Ib===OSF.AgaveHostAction.CancelDialog)this.CK(-684355545,null);else if(Ib===OSF.AgaveHostAction.InsertAgave)ob={},Zb&&(ob[aa.a.ysa]=Zb,ob[ja.a.ng]=Xa.rtb(Zb),this.CK(-741808261,ob));else if(Ib===OSF.AgaveHostAction.InsertDevManifest)ob={},Zb&&(ob[aa.a.ysa]=Zb,ob[ja.a.ng]=Xa.rtb(Zb),this.CK(-741808261,ob));else if(Ib===OSF.AgaveHostAction.InsertDevManifestError)ob=Object(fa.a)(Object,
Zb),ob={[aa.a.PYc]:this.Hm.getDevManifestInvalidUrlErrorString(ob.manifestUrl)},this.CK(-2025863019,ob);else if(Ib===OSF.AgaveHostAction.NotifyHostError)ob={[aa.a.PYc]:this.Hm.getManifestInvaildErrorString()},this.CK(-2025863019,ob);else if(Ib===OSF.AgaveHostAction.RefreshAddinCommands)ra.EwaSettings.oa(52)&&this.CK(af.a.refreshAddinCommands,null);else if(Ib===OSF.AgaveHostAction.CtrlF6Exit||Ib===OSF.AgaveHostAction.CtrlF6ExitShift){if(zc=this.$.da.Aa(15)){(ob=this.yn(ob).x$)&&ob.PBc();v.a.Jf&&document.activeElement.blur();
var Mc={keyCode:117,type:"keydown",ctrlKey:!0};Mc.shiftKey=Ib===OSF.AgaveHostAction.CtrlF6ExitShift;Mc.srcElement=Object(Ca.a)(276,ob)?ob.eHa:ba.h(this.$).mc;ob=new Sys.UI.DomEvent(Mc);zc.Lma(ob)}}else if(Ib===OSF.AgaveHostAction.PageIsReady){if((ob=this.yn(ob).x$)&&ob.t_a===OSF.OsfControlTarget.TaskPane&&(ob=this.$.da.Aa(183))&&this.Cf){Ib=xb.a.gd(this.$);for(zc of this.Cf)Xa.rNa(zc.DU)&&(Ib?ob.kg(!0,!1):ob.setFocusOnToolbarFirstElement())}}else if(Ib===OSF.AgaveHostAction.TabExit){Ib=this.yn(ob);
const yd=Ib.x$;if(yd)if(yd.t_a===OSF.OsfControlTarget.InContent)yd.Cpf();else{if(yd.t_a===OSF.OsfControlTarget.TaskPane)if(xb.a.gd(this.$))v.a.Jf&&document.activeElement.blur(),U.UISurfaces.aj().then(Yd=>{const cc=Object(Ca.a)(276,yd)?yd:null;cc?cc.isResizable?Yd.focusResizeHandle():Yd.focusTabbedTaskPaneArea():Yd.focusTabbedTaskPaneArea();return null});else if(Ib=this.$.da.Aa(183))v.a.Jf&&document.activeElement.blur(),(ob=document.getElementById(this.$.Eb+Ga.a.Qoc))&&kb.DOMElementExtensions.isVisible(ob)?
kb.DOMElementExtensions.setFocus(ob):Ib.setFocusOnToolbarFirstElement()}else Ib&&4===Ib.osfControlType&&this.Hm.notifyAgave(ob,OSF.AgaveHostAction.TabIn)}else if(Ib===OSF.AgaveHostAction.TabExitShift)(Ib=this.yn(ob),zc=Ib.x$)?zc.t_a===OSF.OsfControlTarget.InContent?zc.Dpf():zc.t_a===OSF.OsfControlTarget.TaskPane&&(ob=Object(Ca.a)(276,zc)?zc:null)&&(v.a.Jf&&document.activeElement.blur(),ob.j5f()):Ib&&4===Ib.osfControlType&&this.Hm.notifyAgave(ob,OSF.AgaveHostAction.TabIn);else if(Ib===OSF.AgaveHostAction.EscExit||
Ib===OSF.AgaveHostAction.ExitNoFocusable||Ib===OSF.AgaveHostAction.ExitNoFocusableShift)if(zc=this.yn(ob).x$)zc.PBc();else{if(Ib===OSF.AgaveHostAction.EscExit){Ib=null;for(Mc of C.H6h())if(Mc.value.Ee===ob){Mc.value.dialog.hide();Ib=Mc.key;break}Ib&&(ob=this.yn(Ib))&&4!==ob.osfControlType&&this.Ph.notifyAgave(Ib,OSF.AgaveHostAction.TabIn)}}else if(Ib===OSF.AgaveHostAction.InstallCustomFunctions)if(ra.EwaSettings.oa(119)){Oc.a(this.$).y_e(()=>!1);var hd=this.$.da;pa.TaskExtensions.za(pb.GetServiceTaskFactory.Na(hd,
278,279,1),yd=>{yd=yd.result;hd.Aa(278)||hd.Ga(278,yd);const Yd=Zb.osfControl.getStoreType();yd.Cgf(Zb.osfControl.getSolutionId(),Yd,Xa.ISh(Zb.osfControl),Zb).Nna()},this.ka,3)}else e.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Ib===OSF.AgaveHostAction.UninstallCustomFunctions)if(ra.EwaSettings.oa(119)){Oc.a(this.$).y_e(()=>!1);var id=this.$.da;pa.TaskExtensions.za(pb.GetServiceTaskFactory.Na(id,278,279,
1),yd=>{yd=yd.result;id.Aa(278)||id.Ga(278,yd);yd.eig(Zb.solutionId,Zb.storeType).Nna()},this.ka,3)}else e.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Ib===OSF.AgaveHostAction.SendTelemetryEvent?re(Zb):Ib===OSF.AgaveHostAction.SendCustomerContent?Be(Zb):Ib===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.cyi(Zb):Ib===OSF.AgaveHostAction.RefreshRibbonGallery?ra.EwaSettings.getBooleanFeatureGate(Ze.a.cB,
!1)?(ob=this.$.da.Aa(519))&&ob.lMa(Zb):(ob=this.$.da.Aa(352))&&ob.lMa(Zb):Ib===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.ihj(Zb.solutionId),xb.a.gd(this.$)||(ob=this.$.da.Aa(183))&&ob.nA(),ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&r.AFrameworkApplication.ub.$d(af.a.oVf,2,Zb.solutionId)):Ib===OSF.AgaveHostAction.GetOriginalControlId&&(ob=new J.a(this.$.Eb,Zb.ownerAddinSolutionId,new da.a,!0),Zb.originalControlId=ob?ob.lLe(Zb.controlId):
Zb.controlId)};this.xuj=(ob,Ib)=>{const Zb=Array(2);Zb[0]=Ib;Zb[1]=null;this.ii.$Hh(ob,JSON.stringify(Zb))};this.d0i=()=>{this.$.na&&bd.o(this.$.na)&&this.$.da.Aa(34).fpd()};this.$c=()=>{this.Crf()};this.QR=(ob,Ib)=>{var Zb,zc;1===Ib.Kr&&(ob=Ib.Sf)&&(Ib=new Eb(nd.toTimestamp(ob.enqueueUtcTime),nd.toTimestamp(ob.processUtcTime),nd.toTimestamp(ob.dequeueUtcTime),nd.getElapsedMilliseconds(ob.enqueueUtcTime,ob.processUtcTime),nd.getElapsedMilliseconds(ob.processUtcTime,ob.dequeueUtcTime),ob.operationCount,
(null===(zc=null===(Zb=ob.operation)||void 0===Zb?void 0:Zb.od)||void 0===zc?0:zc.ServerCorrelationId)?ob.operation.od.ServerCorrelationId:null,ob.operation?Enum.toString($d.a,ob.operation.operationName):null,Td.a.AD(nd.getElapsedMilliseconds(ob.enqueueUtcTime,Gd.a.Sa.zb))),Zb=Sys.Serialization.JavaScriptSerializer.serialize(Ib),e.ULS.sendTraceTag(50872916,0,50,Zb))};this.Tc=(ob,Ib)=>{!this.ea.Zb&&Ud.a(Ib)?(Array.forEach(this.Cf,this.FCf),this.Cf.length=0,this.hSb=!1):(Ib.XH&&(e.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),this.RZf()),this.yL(),ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.hSb=!1))};this.Ro=()=>{ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(e.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.RZf());this.yL();ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.hSb=
!1)};this.FCf=ob=>{ob.Npc();this.raiseEvent("cd",ob.controlId)};this.jb=qa;this.gZc=xa;this.initialize();Ua.la(this);this.S_f=0;(qa=(qa=!(v.a.Hp||v.a.H5))&&(!ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!v.a.Jf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.Cyg={}}get k2b(){return this.zfa||(this.zfa=new K.a(this.$.uu))}aYc(qa){this.addHandler("cd",qa)}lij(qa){this.removeHandler("cd",qa)}zMg(qa){this.addHandler("csc",qa)}nij(qa){this.removeHandler("csc",
qa)}wMg(qa){this.addHandler("ca",qa)}kij(qa){this.removeHandler("ca",qa)}xMg(qa){this.addHandler("ci",qa)}yMg(qa){this.addHandler("ekros",qa)}mij(qa){this.removeHandler("ekros",qa)}XGd(qa,xa){try{return JSON.parse(qa)[xa].toLowerCase()}catch(ob){return""}}iDj(qa){const xa=this.XGd(qa,"AudienceGroup"),ob=this.XGd(qa,"SessionOrigin");try{const Ib=parseInt(this.XGd(qa,"Ring"),10);if("automation"!==xa&&"bluechicken"!==ob&&-2<=Ib)return!0}catch(Ib){if("automation"!==xa&&"bluechicken"!==ob)return!0}return!1}get Ph(){if(!this.Hm){const qa=
{},xa=!(this.$.qd&1),ob=Ea.a.current.oL,Ib=this.$.workbookContext,Zb=Y.a.PL+Y.a.x5b;qa.pageBaseUrl=ob.LayoutsContentUrlPrefix;qa.appName=OSF.AppName.ExcelWebApp;qa.appVersion="16";qa.appSettings=this.DWh();qa.singleSignOnSettings=G.AppsForOfficeSingleSignOnManager.n3h();qa.clientMode=xa?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;qa.appUILocale=this.$.ya.UICultureTag;qa.dataLocale=this.$.ya.DataCultureTag;qa.docUrl=Ib.ClientUrl;qa.hostControl=this;qa.formFactor=OSF.FormFactor.Default;qa.lcid=
this.$.GG.toString();qa.localizedScriptsUrl=Y.a.PL+Y.a.Z4c;qa.localizedImagesUrl=Zb;qa.localizedStylesUrl=Y.a.PL+Y.a.oGe;qa.localizedResourcesUrl=Zb;qa.osfOmexBaseUrl=ob.OsfOmexBaseUrl;qa.firstPartyManifestCDNUrl=ob.FirstPartyAddInManifestCDN;qa.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Xa("SdxAssetsToPrefetchMapping");qa.sdxCdnUrl=ob.SdxCdnUrl;qa.sdxDmsUrl=ob.SdxDmsUrl;qa.devCatalogUrl=ob.DevCatalogUrl;qa.controlStatusChanged=this.Qqc;qa.notifyHost=this.WEd;qa.allowExternalMarketplace=
this.$.ea.Mg.get(27)&&Xa.i6b;qa.enableAddinCommands=ra.EwaSettings.oa(52);qa.enableBlackForestRedirect=ra.EwaSettings.oa(87);qa.enableMyOrg=this.$.ea.Mg.get(33);qa.enableMyApps=this.$.ea.Mg.get(34);qa.enableDevCatalog=ra.EwaSettings.oa(43);qa.enablePrivateCatalog=this.bEj();qa.enableTaskpaneUpgradeToAppCommand=ra.EwaSettings.oa(92);qa.showSignOutFromPrivateCatalogMessage=this.$.ea.Mg.get(36);qa.enableUploadFileDevCatalog=ra.EwaSettings.oa(52)&&!ra.EwaSettings.oa(268);qa.userNameHashCode=T.a.sw(r.AFrameworkApplication.userName);
qa.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();qa.enableSingleSignOnForAddin=!ra.EwaSettings.oa(23)&&r.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;qa.enableDisplayBlockedMinorError=ra.EwaSettings.oa(179);qa.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;qa.enableAnonymousUseLegacyCatalogService=ra.EwaSettings.oa(169);qa.enableInsertDialogAccessibilityFix=ra.EwaSettings.oa(176);qa.disableAppsForOfficeThirdParty=ra.EwaSettings.oa(182);qa.enableFirstPartySSO=
ra.EwaSettings.oa(194);qa.wacSessionId=this.$.ya.UserSessionId;qa.disableLogging=!this.$.ya.AriaLoggingIsEnabled;qa.enableFirstPartySDXErrorMessages=ra.EwaSettings.oa(207);qa.enableRichApiCellEditDelay=ra.EwaSettings.oa(186);qa.isHostDocumentDomain=ra.EwaSettings.oa(222);qa.loggableUserId=r.AFrameworkApplication.fa.Xa("LoggableUserId");qa.sessionStartInfoJson=r.AFrameworkApplication.fa.Xa("SessionStartInfoJson");qa.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;
qa.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Xa("PostMessageOrigin");qa.wacIsEmbedded=r.AFrameworkApplication.fa.qa("IsEmbedded");qa.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");qa.enableRemoveAppCommandsAddin=r.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");qa.isHostFrameTrustCheckEnabledForAddIns=r.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");qa.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;
qa.agaveAddinUploadEnabled=ra.EwaSettings.oa(45);qa.hostAllowedOfficeStore=r.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");qa.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");qa.hostInstallAddIns=r.AFrameworkApplication.fa.Xa("HostInstallAddIns");qa.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");qa.approvedAddIns=r.AFrameworkApplication.fa.Xa("ApprovedAddIns");qa.addinEnforceHttpsIsEnabled=this.iDj(qa.sessionStartInfoJson);
qa.hostFeatureGateFlag=0;qa.isUpnCheckEnabled=r.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");qa.wacUpn=r.AFrameworkApplication.fa.Xa("UserPrincipalName");qa.isReactRibbonEnabled=xb.a.isReactRibbonEnabled();qa.enableSetFocusOnTaskpaneOnUserAction=ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);qa.isSafariWithIndexedDBDisabled=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&v.a.WNa;qa.isIndexedDBDisabled=
ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&v.a.WNa||ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&v.a.Jf;qa.enableCustomShortcuts=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");qa.changeGetModifierKeyStringOutputOrder=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");qa.officeJsUrl=r.AFrameworkApplication.GL("OfficeJs/excel.js",5);qa.enableOfficeJsUrlParam=ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",
!1);this.Hm=new OSF.ContextActivationManager(qa);this.Hm.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Hm.setWSA(r.AFrameworkApplication.Un);this.Hm&&"undefined"!==typeof this.Hm.hostCheckReadyHandler&&r.AFrameworkApplication.uNg(Object(d.a)(this.Hm,this.Hm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const zc=na.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Hm.setOAuthManager(zc)}catch(zc){}}return this.Hm}get A4j(){return this.cWc}get hj(){return this.Yje}get Ina(){return this.Vje}get YPd(){return this.Zje}get XPd(){return this.Xje}get Lpj(){return this.ake}get Jpj(){return this.Wje}get Kpj(){return this.$je}get Mpj(){return this.bke}get Npj(){return this.cke}get ZPd(){return this.dke}get NV(){return this.Cyg}get $(){return this.jb}T2b(qa){const xa=
{};xa.Name=qa.Name;xa.BindingType=qa.BindingType;xa.HasHeaders=qa.HasHeaders;qa.IsValidRef&&(xa.ColCount=qa.Reference.LastColumn-qa.Reference.FirstColumn+1,xa.RowCount=qa.Reference.LastRow-qa.Reference.FirstRow+1);return xa}Tqf(qa,xa){const ob=this.nYg(xa);if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")){let Ib=null;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==ob.assetId&&
"undefined"!==typeof ob.assetId&&null!==xa&&"LaunchAddinDialogFromTellMe"===xa[0]&&(Ib="{98143890-AC66-440E-A448-ED8771A02D52}");this.Hm.launchInsertDialog(qa,Ib,ob)}else this.Hm.launchInsertDialog(qa,null,ob)}Fda(qa,xa){if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.LQf(qa,xa,OSF.StoreTypeEnum.MarketPlace);else{const ob={};ob.callbackFunc=qa;ob.storeType=OSF.StoreTypeEnum.MarketPlace;ob.fromInsertDialog=!1;ob.refresh=xa;this.Hm.queryEntitlementDetails(ob)}}LQf(qa,
xa,ob){const Ib={};Ib.callbackFunc=qa;Ib.storeType=ob;Ib.fromInsertDialog=!1;Ib.refresh=xa;this.Hm.queryEntitlementDetails(Ib)}invokeDdaMethod(qa,xa){const ob=this.yn(qa.DdaMethod.ControlId);ob?ob.invokeDdaMethod(qa,xa):this.qf(ca.a.internalError,xa)}registerDdaEventAsync(qa,xa,ob,Ib,Zb){(xa=this.yn(xa))?Xa.bBb(qa)?xa.eej(qa,ob,Ib,Zb):this.qf(ca.a.mGd,Zb):this.qf(ca.a.internalError,Zb)}unregisterDdaEventAsync(qa,xa,ob,Ib,Zb){(xa=this.yn(xa))?Xa.bBb(qa)?xa.LWj(qa,ob,Ib,Zb):this.qf(ca.a.mGd,Zb):this.qf(ca.a.internalError,
Zb)}dispose(){this.disposed||(this.$.ul(this.$c),this.ea.tk(this.Tc),this.ea.gS(this.Ro),this.ea.Rv(this.Bf),this.gZc.detach(this),this.$.userOperationManager.oo(this.QR),this.Vrc=this.Cf=this.ii=this.gZc=this.jb=null,this.TJa&&(this.TJa.dispose(),this.TJa=null),W.a.Ia(this.YPd),W.a.Ia(this.XPd),this.F2a&&(this.F2a.dispose(),this.F2a=null),super.dispose(),this.disposed=!0,e.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}$gd(qa){return(qa=this.yn(qa))?qa.getDefaultIconUrl():null}azc(qa){if(this.ZKe!==
qa){this.ZKe=qa;for(let xa=0,ob=this.Cf.length;xa<ob;xa++){const Ib=this.Cf[xa];qa?Ib.tNe(!1):Ib.ish()}this.YPd.azc(qa);this.XPd.azc(qa)}}cTh(qa){return(qa=this.yn(qa))?qa.getDefaultDisplayName():null}qf(qa,xa,ob=!0){const Ib={};Ib[ja.a.ng]=qa;Ib[ja.a.d4]=xa;this.CK(451041795,Ib,ob)}Cv(qa){const xa={};xa[ja.a.d4]=qa;this.CK(1237877382,xa)}CK(qa,xa,ob=!0){const Ib=new Na.a(qa,0,this.$.Hc,0,null),Zb=xa?xa[ja.a.d4]:null;this.F2a&&ba.h(this.$).gb&&ua.e7g(qa,xa)?this.F2a.$kh(qa,xa):(qa=this.$.Ka.Lb(Ib,
xa),ob&&pa.TaskExtensions.za(qa,zc=>{$c.a(zc)?this.qf(ca.a.internalError,Zb,!1):zc.result||(ba.h(this.$).gb?this.qf(ca.a.ZMa,Zb,!1):this.qf(ca.a.internalError,Zb,!1))},this.ka,8))}G9g(qa){return!!this.zja(xa=>Xa.getSolutionId(xa.yl,this.$)===Xa.getSolutionId(qa,this.$)&&xa.yl.PrimaryMarketplace.MarketplaceType===qa.PrimaryMarketplace.MarketplaceType&&xa.yl.PrimaryMarketplace.MarketplaceRef===qa.PrimaryMarketplace.MarketplaceRef&&xa.yl.PrimaryMarketplace.SolutionVersion===qa.PrimaryMarketplace.SolutionVersion)}yn(qa){return this.zja(xa=>
xa.controlId.startsWith(qa))}DHh(qa){return this.zja(xa=>xa.dua===qa)}UYe(qa){return this.zja(xa=>xa.DU===qa&&!!xa.dua)}iZe(qa,xa,ob,Ib){return this.zja(Zb=>Zb.DU===qa&&Zb.yl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===xa.toLowerCase()&&Zb.yl.PrimaryMarketplace.MarketplaceType.toLowerCase()===ob.toLowerCase()&&!!Zb.yl.SharedRuntime&&!!Zb.yl.SharedRuntime.Resid&&!!Ib&&!!Ib.Resid&&Zb.yl.SharedRuntime.Resid.toLowerCase()===Ib.Resid.toLowerCase())}TTg(qa,xa){if(qa=this.yn(qa))qa.la(xa),qa.showHide(!0)}FHj(qa){(qa=
this.yn(qa))&&qa.showHide(!1)}TIa(qa){var xa;if(1!==qa.WebExtensionType||this.$.qd&8388608&&qa.TaskpaneVisible||this.$.qd&8388608&&!qa.TaskpaneVisible&&lb.HelperMethods.Jw(qa)){let ob=null;lb.HelperMethods.Jw(qa)&&(ob=Xa.Hva(qa,this.$),qa.TaskpaneWidth||(qa.TaskpaneWidth=this.l8b));const Ib=(new Jb(this,this.ii,qa)).Sod();e.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(qa.PrimaryMarketplace.SolutionId,ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?qa.OwnerAddinStoreType||qa.PrimaryMarketplace.MarketplaceType:qa.PrimaryMarketplace.MarketplaceType,null===(xa=qa.AssetMarketplace)||void 0===xa?void 0:xa.SolutionId,null,null,qa.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${qa.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${lb.HelperMethods.Jw(qa)}`);ob&&(Ib.dua=ob);this.Cf.push(Ib);this.bya=null;this.q7a(qa.InstanceId)||(qa=String.format("{0}|{1}|{2}|{3}|{4}",qa.PrimaryMarketplace.SolutionId,qa.PrimaryMarketplace.SolutionVersion,
qa.PrimaryMarketplace.MarketplaceRef,qa.PrimaryMarketplace.MarketplaceType,qa.WebExtensionType),this.raiseEvent("ci",qa))}}jJj(qa,xa){qa.TaskpaneWidth=this.l8b;qa.TaskpaneVisible=!0;const ob={};ob.SolutionId=qa.PrimaryMarketplace.SolutionId;ob.TargetType=qa.WebExtensionType;ob.Version=qa.PrimaryMarketplace.SolutionVersion;ob.StoreType=qa.PrimaryMarketplace.MarketplaceType;ob.StoreId=qa.PrimaryMarketplace.MarketplaceRef;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",
!1)?qa.AssetMarketplace?(ob.AssetId=qa.AssetMarketplace.SolutionId,ob.AssetStoreId=qa.AssetMarketplace.MarketplaceRef):(ob.AssetId=null,ob.AssetStoreId=null):(ob.AssetId=qa.PrimaryMarketplace.SolutionId,ob.AssetStoreId=qa.PrimaryMarketplace.MarketplaceRef);ob.Width=qa.TaskpaneWidth;const Ib=new Jb(this,this.ii,qa,!0);Ib.Sod();this.Cf.push(Ib);const Zb=()=>{this.FRa(Ib.controlId);this.Ph.purgeOsfControl(Ib.controlId,!1);xa()};let zc=null;zc=md.a.instance.dD(()=>{Ib.Iy&&(W.a.Ia(zc),zc=null,this.Ph.insertBlankControlWithErrorUX(this.JIb(Ib,
ob),Zb))},100,$b.a.Njh)}Fch(qa){if(qa&&qa.length){var xa=[];qa.forEach(ob=>{if(ob.ContainsCustomFunctions){const Ib=Xa.Hva(ob,this.$);this.tHd.contains(Ib)||(this.tHd.add(Ib),this.tNf.push(ob));this.G9g(ob)||xa.push(ob)}});xa.length&&this.hIe(xa)}}gKe(qa,xa){this.yn(qa.InstanceId)||(xa=xa(),qa=(new Jb(this,this.ii,qa)).wff(xa),this.Cf.push(qa),this.bya=null)}ZGj(qa){Xa.y2a.kb(qa)&&Xa.y2a.ma(qa).initializeAndShowWithTitle()}Nbi(qa){Xa.y2a.kb(qa)&&Xa.y2a.ma(qa).hide()}XZh(qa){var xa=null;let ob,Ib,
Zb=null;ob=Xa.bld(qa,!0);if(!ob)return e.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),V.Task.Ra(null);(Ib=this.Hm.getOsfControl(Xa.getSolutionId(ob,this.$)))&&(xa=Ib.getManifest())&&(Zb=xa.getSharedRuntimeForCustomFunctions("Workbook"));if(xa=Zb&&1===Zb.LifeTime?this.iZe(ob.PrimaryMarketplace.SolutionId,ob.PrimaryMarketplace.MarketplaceRef,ob.PrimaryMarketplace.MarketplaceType,Zb):this.DHh(qa))return V.Task.Ra(xa.controlId);const zc=
new ia.a;lb.HelperMethods.dlc(Zb)&&(ob.SharedRuntime=Zb);qa=Ib?Ib.getNotificationParams():[];if(!qa.length)return this.LIe(ob);this.I9f(qa,()=>{pa.TaskExtensions.za(zc.task,()=>{this.LIe(ob)},this.ka,3)},()=>{});return zc.task}eOh(qa){qa=Xa.bld(qa,!1);if(!qa)return e.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let xa=null;var ob=this.Hm.getOsfControl(Xa.getSolutionId(qa,this.$));ob&&(ob=ob.getManifest())&&(xa=ob.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
return lb.HelperMethods.dlc(xa)&&(qa=this.iZe(qa.PrimaryMarketplace.SolutionId,qa.PrimaryMarketplace.MarketplaceRef,qa.PrimaryMarketplace.MarketplaceType,xa))?qa.controlId:null}$ah(qa,xa){var ob=Xa.bld(qa,!1);if(ob){var Ib=null,Zb=this.Hm.getOsfControl(Xa.getSolutionId(ob,this.$));Zb&&(Zb=Zb.getManifest())&&(Ib=Zb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(lb.HelperMethods.dlc(Ib)){ob.SharedRuntime=Ib;var zc=ob.PrimaryMarketplace.SolutionId;Zb=ob.PrimaryMarketplace.SolutionVersion;
var Mc=OSF.OsfManifestManager.getCachedManifest(zc,Zb);if(Mc)if(this.n1b.kb(qa))Ib=this.n1b.ma(qa),pa.TaskExtensions.za(Ib,yd=>{(yd=yd.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(yd,xa,this.ii.yMb)},this.ka,3);else{var hd={};hd.solutionId=zc;hd.version=Zb;hd.storeType=ob.PrimaryMarketplace.MarketplaceType;hd.storeId=ob.PrimaryMarketplace.MarketplaceRef;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?ob.AssetMarketplace?(hd.assetId=
ob.AssetMarketplace.SolutionId,hd.assetStoreId=ob.AssetMarketplace.MarketplaceRef):(hd.assetId=null,hd.assetStoreId=null):(hd.assetId=zc,hd.assetStoreId=null);hd.targetType=OSF.OsfControlTarget.TaskPane;var id=new ia.a;ob=pa.TaskExtensions.Vj();ob=new Z.a(this.$,this,hd,ob);Ib=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(zc,Ib.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Mc,Ib,Zb);ob.createUILessSandbox(hd,Mc,(yd,Yd)=>{yd&&!Yd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(yd,
xa,this.ii.yMb),id.setResult(yd)):id.setResult(null);this.n1b.remove(qa)});this.n1b.ia(qa,id.task)}}}else e.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}bDe(qa){(qa=this.UYe(qa))&&(qa.yl.SharedRuntime||this.fKb(qa.controlId))}fKb(qa){(qa=this.UYe(qa))&&this.FRa(qa.controlId)}Soh(qa,xa){if(!this.Cf||!qa||!xa)return!1;if(qa.toLowerCase()===xa.toLowerCase())return!0;let ob=null,Ib=null;for(let Zb=0,zc=this.Cf.length;Zb<zc;Zb++){const Mc=this.Cf[Zb];
if(Mc.ownerAddinSolutionId&&(Mc.controlId===qa&&(ob=Mc.ownerAddinSolutionId.toLowerCase()),Mc.controlId===xa&&(Ib=Mc.ownerAddinSolutionId.toLowerCase()),ob&&Ib))break}return ob&&ob===Ib?!0:!1}YJg(qa){this.yn(qa.InstanceId)||(qa=new Jb(this,this.ii,qa),this.Cf.push(qa),this.bya=null)}UVf(qa){if(this.Cf&&0<=qa&&qa<this.Cf.length){const xa=this.Cf[qa],ob=xa.Iy;this.Cf.splice(qa,1);this.FCf(xa);kb.DOMElementExtensions.tf(ob)}}FRa(qa){if(this.Cf)for(let xa=0,ob=this.Cf.length;xa<ob;xa++)if(this.Cf[xa].controlId===
qa){this.UVf(xa);break}}ihj(qa){if(this.Cf){qa=qa.toLowerCase();for(let xa=0,ob=this.Cf.length;xa<ob;xa++)if(qa===this.Cf[xa].ownerAddinSolutionId.toLowerCase()){this.UVf(xa);break}}}xUg(qa){qa.Oi&&(this.yn(qa.floatingObject.yl.InstanceId)||(this.Nhc(qa.floatingObject.yl.InstanceId)||this.Vrc.push(qa.floatingObject.yl.InstanceId),this.TIa(qa.floatingObject.yl)),this.ea.isNamedObjectViewMode&&this.TTg(qa.floatingObject.yl.InstanceId,qa.Kd))}Saa(qa){if(this.Cf)for(let xa=0,ob=this.Cf.length;xa<ob;xa++)if(1===
this.Cf[xa].controlType&&Sd.a.equals(this.Cf[xa].DU,qa,!0))return this.Cf[xa].controlId;return null}eHh(qa){const xa=[];if(this.Cf)for(let ob=0,Ib=this.Cf.length;ob<Ib;ob++)Sd.a.equals(this.Cf[ob].DU,qa,!0)&&xa.push(this.Cf[ob].controlId);return xa}KHh(qa,xa){if(!xa||!qa)return null;if(this.Cf)for(let ob=0,Ib=this.Cf.length;ob<Ib;ob++)if(1===this.Cf[ob].controlType&&Sd.a.equals(this.Cf[ob].DU,qa,!0)&&this.Cf[ob].yl.SharedRuntime&&Sd.a.equals(this.Cf[ob].yl.SharedRuntime.Resid,xa.Resid,!0))return this.Cf[ob].controlId;
return null}N4a(qa,xa=null){return qa?xa?`${qa}.${xa}`:qa:""}eDe(qa,xa,ob){if(this.bya===qa)return!0;this.bya=qa;let Ib=null,Zb=!1;if(!Ib&&this.Cf)for(let zc=0,Mc=this.Cf.length;zc<Mc;zc++)if(1===this.Cf[zc].controlType&&Sd.a.equals(this.Cf[zc].DU,qa,!0)){let hd=!1,id=!1;xa?(hd=!0,id=!!this.Cf[zc].yl.SharedRuntime&&Sd.a.equals(this.Cf[zc].yl.SharedRuntime.Resid,xa.Resid,!0)):ob&&(hd=!0,id=Sd.a.equals(this.Cf[zc].yl.SharedRuntimeId,ob,!0));if(!hd||id){id&&this.Cf[zc].wg(!0);Ib=this.Cf[zc].controlId;
Zb=!0;this.bya=null;break}}Ib&&this.raiseEvent("ca",Ib);return Zb}setAppRuntimeState(qa,xa){var ob;if(qa){const Ib=this.yn(qa);if(Ib&&lb.HelperMethods.Jw(Ib.yl))Ib.wg(xa),xa&&(this.raiseEvent("ca",qa),(null===(ob=Ib.Iy)||void 0===ob?0:ob.firstChild)&&(qa=Ib.Iy.firstChild.title)&&0<qa.length&&this.k2b.puj(qa));else throw e.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ce.a.instance.ga(2244));}else throw e.ULS.sendTraceTag(537170564,0,15,
"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ce.a.instance.ga(2245));}getAppRuntimeState(qa){if(qa)if((qa=this.yn(qa))&&lb.HelperMethods.Jw(qa.yl))qa=qa.yl.TaskpaneVisible;else throw e.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ce.a.instance.ga(2244));else throw e.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ce.a.instance.ga(2245));return qa}i4a(qa,xa){return(qa=
this.yn(qa))?qa.i4a(xa):null}q7a(qa){return this.gDe(this.Vrc,qa)}Nhc(qa){return this.gDe(this.TKe,qa)}dqe(qa){this.TKe.push(qa)}XZ(qa){return(qa=this.yn(qa))?qa.yl:null}oCd(qa){this.raiseEvent("ekros",qa,this)}QFd(qa){if(qa){var xa=this.yn(qa.InstanceId);xa&&(qa.SharedRuntime||qa.SharedRuntimeId||(this.FRa(xa.controlId),this.Ph.purgeOsfControl(xa.controlId,!1)),xa={},xa.SolutionId=qa.PrimaryMarketplace.SolutionId,xa.TargetType=qa.WebExtensionType,xa.Version=qa.PrimaryMarketplace.SolutionVersion,
xa.StoreType=qa.PrimaryMarketplace.MarketplaceType,xa.StoreId=qa.PrimaryMarketplace.MarketplaceRef,ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?qa.AssetMarketplace?(xa.AssetId=qa.AssetMarketplace.SolutionId,xa.AssetStoreId=qa.AssetMarketplace.MarketplaceRef):(xa.AssetId=null,xa.AssetStoreId=null):(xa.AssetId=qa.PrimaryMarketplace.SolutionId,xa.AssetStoreId=qa.PrimaryMarketplace.MarketplaceRef),xa.Width=qa.TaskpaneWidth,xa.SharedRuntimeId=qa.SharedRuntimeId,
this.Cgg(xa))}}hja(){this.ii.hja()}mN(qa,xa,ob){this.ii.mN(qa,xa,ob)}sZe(qa,xa){xa=Xa.qgh(xa);qa=this.XZ(qa);this.ii.mbc(qa.InstanceId,2202,vb.a.nX,xa)}Vdd(qa){for(let xa=0,ob=this.Cf.length;xa<ob;xa++)this.sZe(this.Cf[xa].controlId,qa)}VHh(qa,xa){xa=Xa.Fbh(xa);this.ii.mbc(qa,65539,"",xa)}YHh(qa,xa,ob){this.ii.mbc(qa,1,xa,ob)}UHh(qa,xa){this.ii.ZHh(qa,xa)}Xah(qa,xa){return[[2,1E3,"",JSON.stringify([qa,xa]),0,!1]]}pli(){return!!this.Ina&&this.Ina.Abf()}I4g(){this.Ina&&this.Ina.clear()}WHh(){if(this.Ina&&
this.Ina.Abf()){var qa=this.Ina.gOh();for(const xa of qa){qa=this.eHh(xa);for(const ob of qa)this.ii.mbc(ob,65540,"","{}")}}}Ydj(qa){this.Ina.add(qa)}IWj(qa){this.Ina.remove(qa)}zja(qa){if(!this.Cf)return null;for(const xa of this.Cf)if(qa(xa))return xa;return null}LIe(qa){const xa=new ia.a,ob=Xa.Hva(qa,this.$);if(lb.HelperMethods.Jw(qa))e.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.qNf(qa,Ib=>{Ib?(qa.InstanceId=Ib.InstanceId,qa.WebExtensionOsfControlType=
3,qa.TaskpaneVisible=!1,this.TIa(qa),xa.setResult(qa.InstanceId)):(e.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(qa.PrimaryMarketplace.SolutionId,qa.PrimaryMarketplace.MarketplaceType,null,null,null,qa.PrimaryMarketplace.MarketplaceRef)} failed`),xa.setException(Error.create("Null insert data")))});else{Xa.y2a.ia(qa.InstanceId,new L.a);const Ib=Xa.y2a.ma(qa.InstanceId).Uia;this.Ech(qa,Ib,ob);this.qNf(qa,null);xa.setResult(qa.InstanceId)}return xa.task}Ech(qa,
xa,ob){this.yn(qa.InstanceId)||(qa=new Jb(this,this.ii,qa),qa.dua=ob,qa.wff(xa),this.Cf.push(qa),this.bya=null)}qNf(qa,xa){const ob=Xa.Hva(qa,this.$);if(!this.tHd.contains(ob))this.iIb.push(qa),1<=this.iIb.length&&this.rNf(qa,xa);else if(xa)for(const Ib of this.tNf)if(Xa.Hva(Ib,this.$)===ob){xa(Ib,0);break}}rNf(qa,xa){let ob=null;const Ib={};Ib.SolutionId=Xa.getSolutionId(qa,this.$);Ib.TargetType=qa.WebExtensionType;Ib.Version=qa.PrimaryMarketplace.SolutionVersion;Ib.StoreType=qa.PrimaryMarketplace.MarketplaceType;
Ib.StoreId=qa.PrimaryMarketplace.MarketplaceRef;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?qa.AssetMarketplace?(Ib.AssetId=qa.AssetMarketplace.SolutionId,Ib.AssetStoreId=qa.AssetMarketplace.MarketplaceRef):(Ib.AssetId=null,Ib.AssetStoreId=null):(Ib.AssetId=qa.PrimaryMarketplace.SolutionId,Ib.AssetStoreId=qa.PrimaryMarketplace.MarketplaceRef);Ib.Width=qa.TaskpaneWidth;Ib.ContainsCustomFunctions=!0;lb.HelperMethods.Jw(qa)&&(Ib.SharedRuntimeId=qa.SharedRuntime.Resid);
const Zb=this.$.pa.xa;qa=this.$.pa.xa.Wb();const zc=Zb.Oa(9,qa);zc.sharedInfo=Ib;const Mc=id=>{id=We.a.Oe(id.data);e.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Qd.a.sc(id)}`)},hd=id=>{id&&!Ad.a(id)||e.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.SolutionId,Ib.StoreType,Ib.AssetId,null,null,Ib.StoreId)} finish with errors: ${Qd.a.sc(id.Errors)}`);
this.iIb.shift();0<this.iIb.length&&this.rNf(this.iIb[0],xa)};if(xa){const id=yd=>{const Yd=yd.Result;(ob=Yd?Yd.AgaveData:null)||xa(null,yd.Errors?yd.Errors[0].ErrorCause:5001);xa(ob,0)};qa=(yd,Yd,cc)=>ze.g(Zb,"InsertAgaveTaskpane",zc,we.b(yd,hd,id),we.a(Yd,Mc),cc,null,0)}else qa=(id,yd,Yd)=>ze.g(Zb,"InsertAgaveTaskpane",zc,we.b(id,hd),we.a(yd,Mc),Yd,null,0);Ed.a(this.$.userOperationManager,qa,id=>new ve.a(519,0,id,64),null)}bEj(){return this.$.me.get(35)}RMd(qa){qa=this.yn(qa);(null===qa||void 0===
qa?0:qa.gea)&&qa.dWf()}XKi(qa){var xa=this.zja(ob=>Xa.rNa(ob.DU));xa&&(xa=this.Ph.getOsfControl(xa.controlId))&&xa.notifyAgave(OSF.AgaveHostAction.SendMessage,qa)}dmi(){return!!this.zja(qa=>1===qa.controlType&&Xa.rNa(qa.DU))}cmi(){const qa=this.zja(xa=>Xa.rNa(xa.DU));return qa?qa.Iy?kb.DOMElementExtensions.isVisible(qa.Iy):!1:!1}Bxj(){const qa=this.zja(xa=>Xa.rNa(xa.DU));qa&&(qa.wg(!0),this.raiseEvent("ca",qa.controlId))}initialize(){const {DdaEventDispatch:qa}=a(1366),xa=void 0===this.$||null===
this.$||ra.EwaSettings.oa(248);void 0!==this.$&&null!==this.$||e.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");xa&&e.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(Dc.uHa(this.$),this.ea=this.$.ea,this.ii=new qa(this.$),this.$.$k(this.$c),this.ea.Xj(this.Tc),this.ea.EM(this.Ro),this.ea.pu(this.Bf),this.$.userOperationManager.tr(this.QR),this.Crf(),this.kVi(),this.mgi(),this.$.da.Ga(35,
this),this.gZc.la(this),xa&&e.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Yje=new vb.a,xa&&e.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.ake=new Qa(this.$,this.hj,this.ii),new sb(this.$,this.hj,this.ii),this.Zje=new va(this.$,this.hj,this.ii),this.Xje=new fc(this.$,this.hj,this.ii),this.Wje=new ab(this.$,this.hj,this.ii),this.$je=new Fc(this.$,this.hj,this.ii),this.bke=new bb(this.$,this.hj,this.ii),this.cke=
new Ob(this.$,this.hj,this.ii),this.$.XV&&(this.dke=new Nb(this.$,this.hj,this.ii)),ra.EwaSettings.oa(186)&&(this.F2a=new ua(this,ba.h(this.$))),ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Vje=new Yb),this.initialized=!0,e.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}QHh(qa){if(!this.YCa)return null;for(let xa=0,ob=this.YCa.length;xa<ob;xa++)if(qa.startsWith(this.YCa[xa].WebExtensionId))return this.YCa[xa];return null}Crf(){var qa,
xa=this.ea;if(xa.Zb&&!this.hSb){if(xa.workbookContext){if(this.cWc=this.$.ea.Mg.get(22),null===(qa=xa.workbookContext.WebExtensions)||void 0===qa?0:qa.length){qa=xa.workbookContext.WebExtensions;xa=!1;for(let ob=qa.length-1;0<=ob;ob--){if(!this.ea.isNamedObjectViewMode){this.Vrc.push(qa[ob].InstanceId);if(1!==qa[ob].WebExtensionType){qa.splice(ob,1);continue}if(lb.HelperMethods.Jw(qa[ob])&&0!==qa[ob].SharedRuntime.State)1===qa[ob].SharedRuntime.State?qa[ob].TaskpaneVisible=!1:2===qa[ob].SharedRuntime.State?
qa[ob].TaskpaneVisible=!0:e.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!qa[ob].ContainsCustomFunctions&&!qa[ob].TaskpaneVisible&&!Ma.a(qa[ob])){qa.splice(ob,1);continue}}const Ib=OSF.OsfControl.isFirstPartyStoreString(qa[ob].PrimaryMarketplace.MarketplaceType);if(ra.EwaSettings.oa(182)&&!Ib&&(qa.splice(ob,1),!xa)){xa=!0;const Zb=pb.GetServiceTaskFactory.Na(this.$.da,5,4,3);pa.TaskExtensions.za(Zb,()=>{Zb.result.mh(36,null)},this.ka,3)}ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&
qa[ob].PrimaryMarketplace&&Xa.rNa(qa[ob].PrimaryMarketplace.SolutionId)&&(e.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),qa.splice(ob,1))}this.hIe(qa)}}else this.cWc=!1;this.hSb=!0}}Y$e(qa){const xa=ba.h(this.$),ob=xa.ha.Ta.$b;if(ob&&qa){qa=!1;if(this.Cf)for(const Ib of this.Cf)if(Xa.rNa(Ib.DU)||Xa.ppi(Ib.DU)){qa=!0;break}qa||xa.ha.Ta.yH(ob)}}kVi(){this.Ph&&this.ea.isNamedObjectViewMode&&this.$.na&&bd.o(this.$.na)&&(this.$.da.Aa(34).kR?this.$.da.Aa(34).fpd():
this.$.da.Aa(34).pv(this.d0i))}hIe(qa){let xa=null;xa=ob=>{const Ib=ob.WebExtensionData,Zb=ob.IsTaskPane,zc=ob.RecordHandler,Mc=()=>{this.CQa.shift();0<this.CQa.length&&xa(this.CQa[0])};if(this.Saa(Ib.PrimaryMarketplace.SolutionId))Mc();else{Zb&&(Ib.WebExtensionOsfControlType=1);var hd=Ma.a(Ib);if(!Zb||Ib.TaskpaneVisible||hd||Ib.SharedRuntime&&0!==Ib.SharedRuntime.State||Ib.ContainsCustomFunctions){var id=new Jb(this,this.ii,Ib,!Zb);e.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ib.PrimaryMarketplace.SolutionId,
Ib.PrimaryMarketplace.MarketplaceType,null,null,null,Ib.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Ib.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${lb.HelperMethods.Jw(Ib)}`);id.Sod();lb.HelperMethods.Jw(Ib)&&(id.dua=Xa.Hva(Ib,this.$),Ib.TaskpaneWidth=this.l8b);hd&&(Ib.WebExtensionToolTip="");Zb&&Ib.TaskpaneVisible&&!hd&&(Ib.TaskpaneWidth=this.l8b);this.Cf.push(id);var yd=this.bya=null;yd=md.a.instance.dD(()=>{id.Iy&&(W.a.Ia(yd),yd=null,zc&&zc(ob,id),Mc())},100,$b.a.Mjh)}else Mc()}};
for(let ob=0;ob<qa.length;ob++)if(!this.yn(qa[ob].InstanceId))if(1!==qa[ob].WebExtensionType)this.TIa(qa[ob]);else if(!ra.EwaSettings.oa(52))this.dob(qa[ob],xa);else if(this.$.qd&8388608||qa[ob].TaskpaneVisible){const Ib={};ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)&&(Ib.solutionId=qa[ob].PrimaryMarketplace.SolutionId,Ib.version=qa[ob].PrimaryMarketplace.SolutionVersion);Ib.marketplaceId=qa[ob].PrimaryMarketplace.SolutionId;Ib.marketplaceVersion=qa[ob].PrimaryMarketplace.SolutionVersion;
Ib.storeType=qa[ob].PrimaryMarketplace.MarketplaceType;Ib.storeId=qa[ob].PrimaryMarketplace.MarketplaceRef;Ib.targetData=qa[ob];this.Ph.isAddinCommandsAsync(Ib,(Zb,zc,Mc)=>{if(Zb){var hd=Mc.targetData;if(zc){if(ra.EwaSettings.oa(86))if(Ib.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Zb=Ib.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),zc=Ib.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Zb||zc)&&lb.HelperMethods.Jw(hd)&&this.dob(hd,
xa);else if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.H9h(Mc,xa);else{let id=!1;this.Fda(yd=>{if(!yd.errorCode){if(yd.value)for(const Yd of yd.value){if(id)break;id=Oe.e(Yd[1])===Oe.e(hd.PrimaryMarketplace.SolutionId)}id?lb.HelperMethods.Jw(hd)&&this.dob(hd,xa):(yd={},ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(yd.SolutionId=Mc.solutionId,yd.Version=Mc.version):(yd.SolutionId=Mc.marketplaceId,
yd.Version=Mc.marketplaceVersion),yd.StoreType=hd.PrimaryMarketplace.MarketplaceType,yd.StoreId=Mc.storeId,ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(yd.AssetId=null,yd.AssetStoreId=null):(yd.AssetId=Mc.marketplaceId,yd.AssetStoreId=Mc.storeId),yd.Width=hd.TaskpaneWidth,yd.TargetType=hd.WebExtensionType,hd.TaskpaneVisible=!0,this.Poe(yd,hd,xa))}},!0)}}else this.dob(hd,xa)}else Zb=Mc.targetData,e.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Zb.PrimaryMarketplace.SolutionId,
Zb.PrimaryMarketplace.MarketplaceType,null,null,null,Zb.PrimaryMarketplace.MarketplaceRef)} from ${Zb.PrimaryMarketplace.MarketplaceType} during document loading`)})}}H9h(qa,xa){let ob=!1;this.Fda(Ib=>{const Zb=qa.targetData;if(!Ib.errorCode){if(Ib.value)for(const zc of Ib.value){if(ob)break;ob=Oe.e(zc[1])===Oe.e(Zb.PrimaryMarketplace.SolutionId)}ob?lb.HelperMethods.Jw(Zb)&&this.dob(Zb,xa):(Ib={},ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ib.SolutionId=
qa.solutionId,Ib.Version=qa.version):(Ib.SolutionId=qa.marketplaceId,Ib.Version=qa.marketplaceVersion),Ib.StoreType=Zb.PrimaryMarketplace.MarketplaceType,Ib.StoreId=qa.storeId,ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?(Ib.AssetId=null,Ib.AssetStoreId=null):(Ib.AssetId=qa.marketplaceId,Ib.AssetStoreId=qa.storeId),Ib.TargetType=Zb.WebExtensionType,Ib.Width=Zb.TaskpaneWidth,Zb.TaskpaneVisible=!0,this.Poe(Ib,Zb,xa))}},!0)}dob(qa,xa){const ob={};ob.WebExtensionData=
qa;ob.IsTaskPane=!0;this.CQa.push(ob);1===this.CQa.length&&xa(ob)}Poe(qa,xa,ob){const Ib={};Ib.ActivationInfo=qa;Ib.WebExtensionData=xa;Ib.IsTaskPane=!1;Ib.RecordHandler=(Zb,zc)=>{const Mc=Zb.ActivationInfo;this.Ph.insertBlankControlWithErrorUX(this.JIb(zc,Mc),()=>{this.FRa(zc.controlId);this.Ph.purgeOsfControl(zc.controlId,!1);this.Cgg(Mc)})};this.CQa.push(Ib);1===this.CQa.length&&ob(Ib)}Cgg(qa){var xa={};xa.solutionId=qa.SolutionId;xa.version=qa.Version;xa.storeType=qa.StoreType;xa.storeId=qa.StoreId;
xa.assetId=qa.AssetId;xa.assetStoreId=qa.AssetStoreId;xa.targetType=qa.TargetType;xa.sharedRuntimeId=qa.SharedRuntimeId;qa=new Ra.a;qa.add(xa);xa={};xa[aa.a.gpb]=qa;xa[aa.a.GM]=3;qa=new Na.a(af.a.ADb,0,this.$.Hc,0,null);this.$.Ka.Lb(qa,xa)}JIb(qa,xa){const ob={};ob.div=qa.Iy;ob.id=qa.controlId;ob.solutionId=xa.SolutionId;ob.version=xa.Version;ob.storeId=xa.StoreId;ob.storeType=xa.StoreType;ob.osfControlType=OSF.OsfControlTarget.TaskPane;return ob}RZf(){if(ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const ob=
[];for(var qa=0;qa<this.Cf.length;qa++){var xa=this.Cf[qa];0!==xa.osfControlType&&3!==xa.osfControlType&&4!==xa.osfControlType||ob.push(xa)}qa=!1;for(xa=0;xa<ob.length;xa++){const Ib=ob[xa];this.FRa(Ib.controlId);!qa&&Ib&&Ib.yl&&(qa=lb.HelperMethods.Jw(Ib.yl))}qa&&this.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}ra.EwaSettings.oa(376)&&pa.TaskExtensions.za(pb.GetServiceTaskFactory.Na(this.$.da,278,279,3),ob=>{ob&&(ob=ob.result)&&(this.$.da.Aa(278)||this.$.da.Ga(278,ob),ob.Fgf().Nna())},
this.ka,3)}yL(){var qa=new gb(this.$,this.hj,this.S_f);void 0===this.$||null===this.$?e.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ra.EwaSettings.oa(248)&&e.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.hj||null===this.hj));if(qa.NJi()){const xa=()=>{},ob=Zb=>{Zb=We.a.Oe(Zb.data);e.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Qd.a.sc(Zb)}.`)},
Ib=qa.jZg();qa=Xa.ajd(Ib);qa|=64;this.$.userOperationManager.oD(new ve.a(507,0,(Zb,zc,Mc)=>ze.g(this.$.pa.xa,"ExecuteRichApiRequest",this.kZg(Ib),we.b(Zb,xa),we.a(zc,ob),Mc,null,0),qa))}}kZg(qa){const xa=this.$.pa.xa.Oa(1);xa.request=qa;return xa}gDe(qa,xa){if(qa)for(let ob=0;ob<qa.length;ob++)if(Sd.a.equals(qa[ob],xa,!0))return!0;return!1}nYg(qa){const xa={};xa.navigationMode=OSF.OsfNavigationMode.DefaultMode;xa.assetId=null;xa.category=null;if(!qa||3>qa.length)return xa;if(qa[0]){const ob=parseInt(qa[0],
10);isNaN(parseInt(ob,10))||(xa.navigationMode=ob)}qa[1]&&(xa.assetId=qa[1]);qa[2]&&(xa.category=qa[2]);return xa}mgi(){if(ra.EwaSettings.oa(60)){var qa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(qa&&"*"!==qa.trim()){this.TJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Oa(this),qa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.me.get(2));try{this.TJa.init()}catch(xa){try{this.TJa.dispose()}catch(ob){}this.TJa=null;e.ULS.sendTraceTag(537170510,
0,10,"EmbeddingEnpoint failed to initialize. Error message: "+xa.message)}qa={};qa.a=this.$.ya.UserSessionId;he.b().Qe(39,qa)}}}I9f(qa,xa,ob){const Ib=Xa.AXg(qa[0]),Zb=Ib.Vha,zc=Ib.Wia;Ib.Vha=()=>{Zb&&Zb();const Mc=Ib.TMa!==OSF.InfoType.Error?xa:null;qa.shift();qa.length?this.I9f(qa,Mc,ob):Mc&&Mc()};Ib.Wia=()=>{zc&&zc();ob&&Ib.TMa!==OSF.InfoType.Error&&ob()};P.a.RVd(Ib)}DWh(){const qa={};qa.AddinRibbonControlsOverriddenByApi=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
qa.AddinActionDefinitionHybridMode=ra.EwaSettings.oa(598).toString();qa.UseActionIdForUILessCommand=ra.EwaSettings.oa(601).toString();qa.AllowStorageAccessByUserActivationOnIFrame=ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();qa.RequirementSetRibbonApiOnePointTwo=ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();qa.flightingTreatmentVariables=r.AFrameworkApplication.fa.ubc;
qa.ShortcutInfoArrayInUserPreferenceData=ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return qa}static get i6b(){return Xa.J8d}static set i6b(qa){Xa.J8d=qa}static getSolutionId(qa){let xa=qa.PrimaryMarketplace.SolutionId;ra.EwaSettings.oa(276)&&qa.OwnerAddinSolutionId&&(xa=qa.OwnerAddinSolutionId);return xa}static ajd(qa){let xa=0;ra.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?qa.RequestFlags&1&&256!==
(qa.RequestFlags&256)||(xa=16):xa=qa.RequestFlags&1?0:16;return xa}static Hva(qa,xa){xa=Xa.getSolutionId(qa,xa);return Xa.i3e(xa,qa.PrimaryMarketplace.SolutionVersion,qa.PrimaryMarketplace.MarketplaceType,qa.PrimaryMarketplace.MarketplaceRef)}static qgh(qa){return JSON.stringify({["recording"]:qa})}static Fbh(qa){const xa={};xa.visibility=qa?"Visible":"Hidden";return JSON.stringify(xa)}static ISh(qa){let xa=qa.getSolutionId(),ob=qa.getVersion(),Ib=qa.getStoreType();qa=qa.getStoreId();return Xa.i3e(xa,
ob,Ib,qa)}static i3e(qa,xa,ob,Ib){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",qa,xa,Xa.K3h(ob).toString(),Ib)}static bld(qa,xa){var ob=qa.split("|");if(7>ob.length)return e.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==ob[0])return e.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${ob[0]}'.`),null;let Ib=ob[1];const Zb=ob[2],zc=Xa.L3h(ob[3]),Mc=ob[4];ob=
ob[5];Ib&&Ib.length||(Ib=ob);ob={};ob.InstanceId=String.format("{{{0}}}",S.a.create().toString());ob.WebExtensionOsfControlType=4;ob.WebExtensionType=1;ob.PrimaryMarketplace={};ob.PrimaryMarketplace.SolutionId=Ib;ob.PrimaryMarketplace.SolutionVersion=Zb;ob.PrimaryMarketplace.MarketplaceRef=Mc;ob.PrimaryMarketplace.MarketplaceType=zc;ob.ContainsCustomFunctions=xa?!0:!1;xa&&(ob.OsfPropertyBag=[["customFunctionAddinId",qa]]);return ob}static L3h(qa){qa=parseInt(qa,10);return qa===OSF.StoreTypeEnum.MarketPlace?
OSF.StoreType.OMEX:qa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:qa===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:qa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:qa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:qa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:qa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:qa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:qa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:qa===OSF.StoreTypeEnum.UploadFileDevCatalog?
OSF.StoreType.UploadFileDevCatalog:qa===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static K3h(qa){return qa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:qa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:qa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:qa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:qa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:qa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:qa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:
qa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:qa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:qa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:qa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static rtb(qa){const xa={};xa.Version=qa.version;xa.AssetId=qa.assetId;ra.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OSFSolutionIdRefactor",!1)?xa.AssetStoreId=qa.assetStoreId:xa.AssetStoreId=null!==qa.assetStoreId?
qa.assetStoreId.toString():null;xa.StoreType=qa.storeType;xa.Height=qa.height;xa.SolutionId=qa.solutionId;xa.StoreId=qa.storeId;xa.TargetType=qa.targetType;xa.Width=1===xa.TargetType?0:qa.width;xa.SharedRuntimeId=qa.sharedRuntimeId;return xa}static bBb(qa){return qa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||qa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||qa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||qa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||qa===
OSF.DDA.EventDispId.dispidRichApiMessageEvent||qa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||qa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||qa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static AXg(qa){return Object(b.a)(new gf.a,{TMa:qa.infoType,id:qa.id,title:qa.title,description:qa.description,buttonText:qa.buttonTxt,Vha:qa.buttonCallback,ogc:qa.highPriority,Wia:qa.dismissCallback,errorCode:qa.errorCode,Eef:qa.iframeNotificationUrl})}static rNa(qa){let xa=
"FA000000014"===qa;xa||(xa="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===qa);return xa}static ppi(qa){return"FA000000005"===qa}}Xa.y2a=new H.a;Xa.J8d=!0;Object(c.a)(Xa,"DdaFacade",Ya.a,[247,397,302,398,399,3])},741:function(t,E,a){a.d(E,"a",function(){return e});t=a(0);var c=a(15),b=a(111);class e{constructor(){this.nMd=0;this.bX={};this.Fta={}}b_h(f,d){return this.bX[e.Z0c(f,d)]}zQe(f,d){d||void 0!==this.Fta[f]&&null!==this.Fta[f]?d&&void 0!==this.Fta[f]&&null!==this.Fta[f]&&delete this.Fta[f]:
this.Fta[f]=1}d2b(f){return void 0===this.Fta[f]||null===this.Fta[f]}L8h(f){const d=e.Z0c(f.messageType,f.targetId);1===f.actionType?this.g$h(f.controlId,f.messageType,d):2===f.actionType&&this.S$h(f.controlId,f.messageType,d)}Mgj(f){if(f){var d=Object.keys(this.bX);if(!(void 0===d||null===d||0>=d.length))for(const h of d)d=this.bX[h],d[f]&&(delete d[f],Object.keys(d).length||delete this.bX[h])}}C_(f,d){f=e.Z0c(f,d);f=this.bX[f];return!!f&&0<Object.keys(f).length}Qai(){return!b.a.isEmpty(this.bX)}Mnf(){return 0<
this.nMd}rUh(){const f=[],d=this.bX;for(let l in d){var h=l,m=d[l];for(let w in m){m=w;const n={};n.eventType=parseInt(h.split("#")[0],10);n.targetId=h.split("#")[1];n.addinId=m;f.push(n)}}return f}g$h(f,d,h){if(this.bX[h])h=this.bX[h],h[f]=h[f]?h[f]+1:1;else{let m={};m[f]=1;this.bX[h]=m}100===d&&this.nMd++}S$h(f,d,h){if(this.bX[h]){const m=this.bX[h];if(f){const l=m[f];1===l?(delete m[f],Object.keys(m).length||delete this.bX[h]):m[f]=l-1;100===d&&this.nMd--}else c.ULS.sendTraceTag(537170459,0,50,
`The OsfControl[${f}] doesn't register event with key[${h}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${h}] that will be unregistered doesn't exist.`)}static Z0c(f,d){return String.format("{0}#{1}",f,d)}}e.nX="Workbook";Object(t.a)(e,"RichApiEventRegistration",null,[])},768:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{constructor(b,e,f,d=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=e;this.ddaBinding=
f;this.ArrayData=d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(t.a)(c,"DdaEventArgs",null,[])},816:function(t,E,a){t=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(t.a)(c,"AddInDataTransferObject",null,[]);a.d(E,"a",function(){return b});class b{constructor(e,f,d){this.HSb=e;this.tsg=f;this.usg=d}get ot(){return this.HSb}get tJg(){return this.tsg}get uJg(){return this.usg}static K4a(e){return(e=e.uW)?Object.assign(new c,{tabs:e.ot.toArray(),
id:e.tJg,title:e.uJg}):null}}Object(t.a)(b,"OneLineRibbonExtensibility",null,[])},847:function(t,E,a){a.r(E);t=a(0);var c=a(187),b=a(15),e=a(99);class f{constructor(){this.startTime=0;this.callback=null}}Object(t.a)(f,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(t.a)(d,"AccessTokenInformation",null,[902]);var h=a(965);class m{constructor(){this.token=null;this.expiresOn=0;this.Iha=this.authChallenge=null}}Object(t.a)(m,"CachedTokenInfo",null,[]);class l{constructor(){this.jTb=
new c.a;this.q$=this.p$=!1;this.Xoa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Cte=null}get callbacks(){return this.jTb}}Object(t.a)(l,"SSORequestInfo",null,[]);class w extends l{constructor(){super();this.errorCode=0}}Object(t.a)(w,"SSOFailedRequestInfo",l,[]);var n=a(4);class x{constructor(M,T,S,H){this.DT=new c.a;this.VG=new c.a;this.$pa=null;this.Amb=new c.a;this.Eee=Promise.resolve(null);this.Lle=!1;this.hYb=T;this.gvg=M;this.ome=S;this.ysg=H}bFj(M){if(this.$pa&&this.$pa.authChallenge===
M.authChallenge){if(Date.now()/1E3+x.kGi>this.$pa.expiresOn)return this.$pa=null,!1;M=new h.a;M.token=this.$pa.token;M.expiresOn=this.$pa.expiresOn;M.Iha=this.$pa.Iha;M.TUa=!0;M.pyb=0;this.Iyb(M);return!0}return!1}GDj(M){for(let T=0;T<this.VG.count;T++)if(this.VG.ma(T).authChallenge===M.authChallenge&&this.VG.ma(T).Xoa===M.Xoa){let S;(S=this.VG.ma(T)).retryCount=S.retryCount+1;M.retryCount=this.VG.ma(T).retryCount;if(this.VG.ma(T).retryCount<x.JGi||!this.VG.ma(T).p$&&M.p$||!this.VG.ma(T).q$&&M.q$){if(!this.VG.ma(T).p$&&
M.p$||!this.VG.ma(T).q$&&M.q$)M.retryCount=0;this.VG.removeAt(T);break}M=new h.a;M.errorCode=this.VG.ma(T).errorCode;this.Iyb(M);return!0}return!1}mLg(M,T){for(let S=0;S<this.VG.count;S++)if(this.VG.ma(S).Xoa===M.Xoa&&this.VG.ma(S).authChallenge===M.authChallenge)return;this.VG.add(Object.assign(new w,{p$:M.p$,q$:M.q$,authChallenge:M.authChallenge,Xoa:M.Xoa,errorCode:T,retryCount:M.retryCount}))}get resource(){return this.hYb}Sfd(M,T,S,H,C,G){const {AppsForOfficeSingleSignOnManager:J}=a(847);""===
S&&(S=null);if(this.Lle)J.n6(G,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var L=null;for(let P of this.DT)if(P.p$===M&&P.q$===T&&P.authChallenge===S&&P.Xoa===C){L=P;break}L||(L=Object.assign(new l,{p$:M,q$:T,authChallenge:S,Cte:H,Xoa:C,retryCount:0,startTime:J.Ew()}),this.DT.add(L));L.retryCount=0;L.callbacks.add(G);this.Eee=this.Eee.then(()=>{var {AppsForOfficeSingleSignOnManager:P}=a(847);if(0<this.DT.count){var aa=this.DT.ma(0);if(this.bFj(aa)||this.GDj(aa))return null;
for(let K=0;K<this.Amb.count;)this.Amb.ma(K)+x.AQj<P.Ew()?this.Amb.removeAt(K):K++;if(this.Amb.count>=x.FGi||this.DT.count>=x.gGi)return aa=new h.a,aa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.Iyb(aa),null;let U=null;n.AFrameworkApplication.ta&&(P=n.AFrameworkApplication.ta.kE)&&(U=P.Cc("ComponentAttach",this.gvg+x.FEg));return aa.Xoa.iHg(this.resource,aa.p$,aa.q$,aa.authChallenge,this.ysg,aa.Cte).then(K=>{U&&U.stop();this.Iyb(K)},()=>{U&&U.stop();const K=new h.a;K.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.Iyb(K)})}return null})}}Iyb(M){const {AppsForOfficeSingleSignOnManager:T}=a(847);try{if(this.DT.count){var S=this.DT.ma(0);this.DT.removeAt(0);var H=null;M.errorCode||(H=new d,H.accessToken=M.token);M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.mLg(S,M.errorCode);var C={};null!=M.pyb&&(C.getTokenSilentTime=M.pyb.toString());null!=M.Gkd&&(C.getTokenPopupTime=M.Gkd.toString());null!=M.fid&&(C.getIDTokenTime=M.fid.toString());null!=M.TUa&&(C.tokenCached=M.TUa.toString());M.JZd&&(C.detailedError=M.JZd);M.Iha&&(C.authLibrary=M.Iha);S.retryCount&&(C.retryCount=S.retryCount);for(var G of S.callbacks)T.n6(G,M.errorCode,H,C);null!=M.TUa&&M.TUa||this.Amb.add(S.startTime);if(!M.errorCode)for(null!=M.expiresOn&&(this.$pa=Object.assign(new m,{token:M.token,
expiresOn:M.expiresOn,authChallenge:S.authChallenge,Iha:M.Iha})),this.VG.clear(),G=0;G<this.DT.count;)if(this.DT.ma(G).authChallenge===S.authChallenge){for(let J of this.DT.ma(G).callbacks)T.n6(J,M.errorCode,H,C);this.DT.removeAt(G)}else G++}}catch(J){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",J.message)}}shutdown(){this.Lle=!0;this.DT.clear()}}x.AQj=6E4;x.FGi=6;x.gGi=6;x.JGi=3;x.kGi=300;x.FEg="GetAccessToken";Object(t.a)(x,"SSOCallbackManager",null,[]);
var r=a(717),u=a(732),v=a(120),B=a(80),z=a(27),A=a(30),y=a(147),D=a(347);a.d(E,"AppsForOfficeSingleSignOnManager",function(){return I});class I{constructor(M,T,S=null){this.AHc=new e.a;const H=new c.a;T&&H.add(T.LEi);S&&H.addRange(S);this.Hm=M;this.KFg=H}Tfd(M,T,S,H,C,G,J,L,P,aa){aa=Object.assign(new f,{startTime:I.Ew(),callback:aa});try{const Y=!!S&&""!==S;var U=aa.startTime;const na=this.getOsfControl(M);let W=na.getStoreType()||"",X=na.getOwnerAddinStoreType()||"",Aa=na.getSolutionId()||"";const Q=
na.getVersion()||"";W=W.toLowerCase();X=X.toLowerCase();Aa=Aa.toLowerCase();var K=B.a.eid(T)||"";const fa=B.a.eid(na.getIframeUrl())||"",Ca=K.toLowerCase()===fa.toLowerCase();K=W;"inmemory"===W&&(K=X);const ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(Aa,K,na.getAssetId(),null,null,na.getStoreId()),Ra={["callInstanceId"]:U.toString(),["controlSolutionId"]:ia,["controlVersion"]:Q,["storeType"]:W,["ownerStoreType"]:X,["allowConsentPrompt"]:H.toString(),["forMSGraphAccess"]:C.toString(),["allowSignInPrompt"]:G.toString(),
["hasAddinAuthChallenge"]:Y.toString(),["securityOriginEqualsSourceLocation"]:Ca.toString(),["singleSignOnEnabled"]:J.toString(),["accountTypeFilter"]:L||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",Ra);y.a.sendTelemetryEvent(Object.assign(new D.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:v.a.Aj(Ra)}));U=!0;const Ya=n.AFrameworkApplication.fa.Xa("HostAuthType");switch(L){case "aad":U="aad"===Ya;break;case "msa":U="msa"===Ya;break;default:U=!L||"noFilter"===L}if(U){L=
null;if(J)for(let Ga of this.KFg)if(Ga.Ini(Aa)){L=Ga;break}L?this.isSSOAddin(M)?(J=!0,"omex"===K&&(J=!1),"spapp"===K||"spcatalog"===K?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),I.n6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):C&&!J?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),I.n6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)):(C&&"exchange"===K&&(H=!1),this.Sfd(M,T,S,K,H,G,P,L,aa))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),I.n6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):I.n6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else I.n6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Y){this.Jmc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
Y.message),I.n6(aa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(M,T,S,H){this.Tfd(M,S[r.a.QYc]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,T,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,S[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,H)}Sfd(M,T,S,H,C,G,J,L,P){this.AHc.kb(M)?H=this.AHc.ma(M):(H=new x(M,this.getWebApplicationResource(M).split(",")[0],H,this.getDefaultDisplayName(M)),this.AHc.add(M,H));const aa=H.resource;M=I.H1h(aa,this.getWebApplicationId(M));const U=OfficeExt.WACUtils.getHostSecure(T);M&&U?M.toLowerCase()===U.toLowerCase()?H.Sfd(C,G,S,J,L,P):(I.XOa('SSO Resource "'+aa+'" cannot be used from "'+T+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,
344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),I.n6(P,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(M||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),U||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),I.n6(P,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}Jmc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(M){return this.Hm.getOsfControl(M)}isSSOAddin(M){return this.getOsfControl(M).getManifest().isSSOAddin()}getWebApplicationId(M){return this.getOsfControl(M).getManifest().getWebApplicationId()}getWebApplicationResource(M){return this.getOsfControl(M).getManifest().getWebApplicationResource()}getDefaultDisplayName(M){return this.getOsfControl(M).getManifest().getDefaultDisplayName()}static n3h(){try{const M=
{};z.a.Vxa&&u.a.Azb&&(M.UiHostSupportsAuthTokenAddinList=I.BZe);M.UiHostSupportsAuthToken=u.a.Azb;return M}catch(M){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",M.message)}return null}static getInstance(M,T,S=null){I.Ma||(I.Ma=new I(M,S));return I.Ma}static XOa(M){window.console.warn&&window.console.warn(M)}static H1h(M,T){if(!M)return"";T||(T="");let S=M.toLowerCase();var H=T.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(H)||
(I.XOa('SSO App Id "'+T+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));S.endsWith(H)||(I.XOa('SSO Resource "'+M+'" does not end with App Id "'+T+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!S.startsWith("https://")&&!S.startsWith("api://"))return I.XOa('SSO Resource "'+M+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(T=0;T<M.length;T++){H=M.charAt(T);const C=A.a.charCodeAt(M,T);if(33>C||126<C||"&"===H||"?"===H||"#"===H||"%"===H||"\\"===H)return I.XOa('SSO Resource "'+M+'" contains an invalid character "'+H+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+H+"' in resource URI."),""}if(0<=M.indexOf("::"))return I.XOa('SSO Resource "'+M+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
M.length)return I.XOa('SSO Resource "'+M+'" is '+M.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+M.length+"."),"";S.startsWith("api://")&&(S="https://"+S.substring(6,S.length));return 8===S.length?"":OfficeExt.WACUtils.getHostSecure(S)||""}static n6(M,T,S,H){var C=M.startTime;let G=0;0<C&&(G=I.Ew()-C);C={["callInstanceId"]:C.toString(),["callDuration"]:G.toString(),["errorCode"]:T.toString()};if(H)for(let J in H)C[J]=
H[J];b.ULS.sendTraceTag(51401116,344,50,"{0}",C);y.a.sendTelemetryEvent(Object.assign(new D.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:v.a.Aj(C)}));M.callback(T,S)}static Ew(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(M){}return Date.now()}}I.BZe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");I.Ma=null;Object(t.a)(I,
"AppsForOfficeSingleSignOnManager",null,[231])},864:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);var c=a(13);class b{constructor(){this.XWe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.VWe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1628),c.a.instance.ga(1632)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1629),c.a.instance.ga(1633)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1630),c.a.instance.ga(1634)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1631),c.a.instance.ga(1635)]};this.kac=null}get Aia(){return"SourceControlId"}get EN(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}BYh(){if(!this.kac){this.kac={};for(const e of Object.keys(this.XWe))this.kac[e]=this.XWe[e];for(const e of Object.keys(this.VWe))this.kac[e]=this.VWe[e][0]}}}Object(t.a)(b,"AddinCommandsStringProvider",null,[339])},866:function(t,E,a){a.d(E,"a",function(){return c});
t=a(0);class c{constructor(){this.TMa=0;this.Vha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.ogc=!1;this.Eef=this.Wia=null}}Object(t.a)(c,"AddInCommandsNotificationParameters",null,[])},937:function(t,E,a){t=a(0);var c=a(15),b=a(84),e=a(152),f=a(14),d=a(87);class h extends Sys.UI.Control{constructor(H,C,G,J){super(document.createElement("div"));this.iT=this.gT=this.aw=this.PG=this.XG=this.Vpa=this.ura=null;this.lkb=this.Jqa=!1;this.content=this.Zp=null;this.P1=0;
this.vye=null;this.kU=0;this.JJf=null;this.Kme=H;this.Xhe=C;this.MP=G;this.sH=J;this.mg=C.ownerDocument;this.Nfc=this.Lt=this.Ekb=!1}get yW(){this.ura||(this.ura=this.mg.createElement("div"),this.ura.id=this.mi("WACCalloutOuter"),this.ura.className="WACCalloutOuter",this.ura.setAttribute(d.a.Ad,d.a.P_a),this.ura.style.width=this.P1+"px");return this.ura}get Bqb(){if(!this.Vpa){this.Vpa=this.mg.createElement("div");this.Vpa.id=this.mi("WACCalloutBeakContainer");this.Vpa.className="WACCalloutBeakContainer";
var H="CalloutBeakTopFilled_32x16x32";if(5===this.kU||6===this.kU||4===this.kU)H="CalloutBeakBottomFilled_32x16x32";H=e.createClusteredImage(32,16,H,"WACCalloutBeak",!0,"");this.Vpa.appendChild(H)}return this.Vpa}set Bqb(H){this.Vpa=H}get yNa(){return this.Ekb}get title(){return this.Zp}set title(H){this.Zp!==H&&(this.Zp=H,this.gT&&(this.gT.innerText=this.Zp))}get Lt(){return this.Jqa}set Lt(H){this.Jqa!==H&&(this.Jqa=H,this.XG&&(this.XG.contains(this.aw)&&!this.Jqa?this.XG.removeChild(this.aw):!this.XG.contains(this.aw)&&
this.Jqa&&this.Ype()))}get Nfc(){return this.lkb}set Nfc(H){this.lkb!==H&&(this.lkb=H,this.XG&&(this.XG.contains(this.gT)&&!this.lkb?this.XG.removeChild(this.gT):!this.XG.contains(this.gT)&&this.lkb&&this.rre()))}show(){this.Ekb||(this.Wch(),this.xo(),this.Xhe.appendChild(this.yW),this.yW.style.display="Block",this.CAj(),this.Ekb=!0,this.JJf&&this.JJf())}dismiss(){this.Ekb&&(this.N2a(),this.Xhe.removeChild(this.yW),this.Ekb=!1,this.sH&&this.sH())}dispose(){this.dismiss();this.gT=this.aw=this.PG=this.Vpa=
this.XG=this.ura=null;Sys.Component.prototype.dispose.call(this)}mi(H){return this.get_element().id+H}Wch(){this.XG=this.mg.createElement("div");this.XG.id=this.mi("WACCalloutHeader");this.XG.className="WACCalloutHeader";this.Lt&&this.Ype();this.Nfc&&this.rre();this.PG=this.mg.createElement("div");this.PG.id=this.mi("WACCalloutContent");this.PG.className="WACCalloutContent";this.PG.style.width=190<this.P1?this.P1-26+"px":"164px";this.PG.appendChild(this.content);this.yW.appendChild(this.Bqb);this.yW.appendChild(this.XG);
this.yW.appendChild(this.PG)}Ype(){this.aw=this.mg.createElement("a");this.aw.className="WACCalloutCloseAnchor";this.aw.id=this.mi("WACCalloutCloseAnchor");this.aw.href="#";this.XG.appendChild(this.aw);const H=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.aw.appendChild(H)}rre(){this.gT=this.mg.createElement("div");this.gT.className="WACCalloutTitle UIFontBold";this.gT.style.width=190<this.P1?this.P1-30+"px":"160px";this.gT.id=
this.mi("WACCalloutTitle");this.gT.innerText=this.title;this.XG.contains(this.aw)?this.XG.insertBefore(this.gT,this.aw):this.XG.appendChild(this.gT)}CAj(){var H=this.Kme;let C;if(1===this.kU){var G=this.vye.y+16;C=-16}else 2===this.kU||3===this.kU||0===this.kU?(G=H.y+H.height+15,C=-15):(G=H.y-this.yW.clientHeight-15-2,C=this.yW.clientHeight-1);this.yW.style.top=G+"px";this.Bqb.style.top=C+"px";1===this.kU?(H=this.vye.x-16,this.yW.style.left="50%",this.yW.style.marginLeft=-this.P1/2+"px",G=Sys.UI.DomElement.getBounds(this.yW),
this.Bqb.style.left=H-G.x+"px"):(G=H.x+this.Kme.width/2,2===this.kU||5===this.kU?(H=20,G-=36):0===this.kU||4===this.kU?(H=this.P1/2-16,G-=this.P1/2):(H=this.P1-20-32,G=G-this.P1+36),this.yW.style.left=G+"px",this.Bqb.style.left=H+"px")}xo(){this.Lt&&!this.iT&&(this.iT=Object(b.a)(this,this.U$,"closeHandler"),this.MP.sa(f.a.click,this.aw,this.iT,null))}N2a(){this.Lt&&this.iT&&(this.MP.Ba(f.a.click,this.aw,this.iT),this.iT=null)}U$(){this.dismiss();return!0}}Object(t.a)(h,"Callout",Sys.UI.Control,[372]);
class m extends h{constructor(H,C,G,J,L,P=null){super(H,G,L.IX,P);this.dge=0;this.P1=this.GYh(J);this.nZa=C;this.df=L;this.BRj=7;this.Bl=this.nZa.ownerDocument.createElement("div");this.Bl.className="ModalCalloutControlOverlay";this.Bl.tabIndex=0;this.nZa.insertBefore(this.Bl,this.nZa.firstChild)}show(){this.yNa||(this.df.ptc(),this.df.eQ(!1),this.Bl.style.zIndex=String(this.df.S2),super.show(),this.Oj(),this.dge=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.BRj))}dismiss(){this.yNa&&
(this.df.hN(!1),this.gk(),this.nZa&&this.nZa.contains(this.Bl)&&this.nZa.removeChild(this.Bl),super.dismiss(),window.clearTimeout(this.dge))}Oj(){this.df.wsa(Object(b.a)(this,this.dismiss,"dismiss"));this.df.Wy.sa(f.a.click,this.Bl,Object(b.a)(this,this.fd,"onClick"))}gk(){this.df.edb(Object(b.a)(this,this.dismiss,"dismiss"));this.df.Wy.Ba(f.a.click,this.Bl,Object(b.a)(this,this.fd,"onClick"))}fd(){this.dismiss();return!0}GYh(H){let C=0;switch(H){case 0:C=190;break;case 1:C=250;break;case 2:C=300;
break;case 3:C=360}return C}}Object(t.a)(m,"ModalCallout",h,[]);var l=a(463),w=a(173);class n extends m{constructor(H,C,G,J,L,P=null){super(H,C,G,J,L,P);this.VWb=null}show(){if(!this.yNa){const H=Object.assign(new l.a,{onShow:()=>{m.prototype.show.call(this)}});w.UISurfaces.QH().then(C=>{const G=C.externalNotification();this.VWb=C.addNotification(G,H);return null},C=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",C);return null})}}dismiss(){this.yNa&&this.VWb&&(w.UISurfaces.QH().then(H=>
{H.removeNotification(this.VWb);return this.VWb=null},H=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(t.a)(n,"ReactManagedModalCallout",m,[]);var x=a(4);class r{static Keh(H,C,G){return x.AFrameworkApplication.ta.Pa.pR?new n(H,C,G,3,x.AFrameworkApplication.ta,null):new m(H,C,G,3,x.AFrameworkApplication.ta,null)}}Object(t.a)(r,"ModalCalloutControlFactory",null,[]);var u=a(54),v=a(862),B=a(582),z=a(863),A=a(133),y=a(56),D=a(39),
I=a(82),M=a(816),T=a(696);a.d(E,"a",function(){return S});class S{static get k2b(){return S.zfa||(S.zfa=I.a.instance.yg("Common.Utils.IAriaNotifier"))}static oIe(H,C,G,J){S.yJ&&S.yJ.yNa&&S.yJ.dismiss();S.yJ=r.Keh(C,H,H);S.yJ.content=G;T.b(J)||(S.yJ.title=J,S.yJ.Nfc=!0);H=new Sys.UI.Bounds(0,0,y.a.Mec(),y.a.Lec());S.yJ.kU=S.tQh(H,C,S.yJ.P1);S.yJ.show();S.k2b&&S.k2b.sendNotification(G.innerText,!0)}static v6c(H,C,G,J=null){w.UISurfaces.QH().then(L=>{let P=null;S.xmb&&(L.removeNotification(S.xmb),S.xmb=
null);const aa=L.callout(Object.assign(new v.a,{target:H,title:C,content:G,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new z.a,{onDismiss:()=>{L.removeNotification(P)},directionalHint:null!=J?J:null})})),U=Object.assign(new l.a,{expirationOptions:Object.assign(new B.a,{displayTimeoutSeconds:7,onExpire:()=>{L.removeNotification(S.xmb)}})});P=S.xmb=L.addNotification(aa,U);return null},L=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
L);return null})}static PVd(H,C=null){S.yJ&&S.yJ.yNa&&S.yJ.dismiss();const G=new A.StandardDialog;G.QTa=!1;G.Tb=0;G.iA(u.a.Oxi,CommonUIStrings.l_DialogError,T.b(H)?S.r3e():H,C)}static RVd(H){S.yJ&&S.yJ.yNa&&S.yJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",H.errorCode));const C=T.b(H.description)?S.r3e():H.description,G=new A.StandardDialog;let J=null;H.Vha?(G.Tb=1,G.qc(1,H.buttonText),G.a1(1)):G.Tb=0;J=L=>{1===L?H.Vha():H.Wia&&H.Wia()};
G.QTa=!1;0===H.TMa?G.iA(H.errorCode,H.title?H.title:CommonUIStrings.l_DialogError,C,J):1===H.TMa?G.CX(H.title?H.title:CommonUIStrings.l_DialogWarning,C,J):G.FBa(H.title?H.title:CommonUIStrings.l_DialogInfo,C,J)}static tQh(H,C,G){let J=4;const L=H.x+H.width-C.x-C.width;C.x-H.x+C.width/2<=G/2?J=5:L+C.width/2<=G/2&&(J=6);return J}static JGj(H,C,G,J=!1){(C=M.a.K4a(C))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(C,L=>{L&&(J||S.v6c(L,
G,H,5))})}static KGj(H,C,G=!1){S.JGj(C.startedNode?C.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,H),C,C.startedNode?C.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,H),G)}static IGj(H,C,G,J){if(S.Blg)H=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,G,J,CommonUIStrings.l_InsertionDialogRefresh)),S.v6c(C,H,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{C=
D.a.zp(C);var L=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),P=document.createElement("span");P.innerText=L[0];var aa=document.createElement("span");aa.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,G,J,CommonUIStrings.l_InsertionDialogRefresh);aa.className="UIFontBold";G=document.createElement("span");G.innerText=L[1];J=document.createElement("div");Sys.UI.DomElement.addCssClass(J,"ModalCalloutControl");J.appendChild(P);J.appendChild(aa);J.appendChild(G);
S.oIe(H,C,J,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static bIj(H,C){var G=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,J=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;S.Blg?S.v6c(C,G,J):(C=D.a.zp(C),S.oIe(H,C,S.QZg(J),G))}static QZg(H){const C=document.createElement("div");Sys.UI.DomElement.addCssClass(C,"ModalCalloutControl");C.innerText=H;return C}static r3e(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get Blg(){return x.AFrameworkApplication.ta.Pa.Pi&&
x.AFrameworkApplication.ta.Pa.pR}}S.yJ=null;S.xmb=null;S.zfa=null;Object(t.a)(S,"AddInCommandsNotificationFactory",null,[])},947:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(1466),e=a(147),f=a(120),d=a(717),h=a(734),m=a(347);class l{constructor(u,v,B,z){this.EA=!1;this._id=u;this.Ex=v;this.f2=B;this.Jd=z}get enabled(){return this.EA}set enabled(u){const {DynamicRibbon:v}=a(947);var B=this.Jd.OwnerAddinStoreType;const z=this.Jd.PrimaryMarketplace.MarketplaceRef,A=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:
null,y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ex,B,null,null,null,z);B={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,B,A,null,null,z),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Button",["toggle"]:u};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:v.OCc+"ControlUpdate",dataFields:f.a.Aj(B)}));this.EA=u;this.f2.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.Ex,["PrivacyCompliantSolutionId"]:y,
["SourceControlId"]:this.id,["MethodData"]:this.EA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u,
v){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertySetAsync(u,v){this.invokePropertySet(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,v){switch(u){case 5:return this.ixj(v);case 1:return this.lDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,v){u=this.invokeMethod(u,
v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}ixj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null}lDa(){this._OnAccess();return null}}Object(t.a)(l,"RibbonButton",null,[]);class w{constructor(u,v,B,z){this._id=u;this.Ex=v;this.f2=B;this.Jd=z}get id(){return this._id}setVisibility(u){const {DynamicRibbon:v}=a(947),B=this.Jd.OwnerAddinStoreType;var z=this.Jd.PrimaryMarketplace.MarketplaceRef;const A=this.Jd.AssetMarketplace?
this.Jd.AssetMarketplace.SolutionId:null,y=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ex,B,A,null,null,z);z={["addinSolutionId"]:y,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,B,A,null,null,z),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Tab",["toggle"]:u};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:v.OCc+"ControlUpdate",dataFields:f.a.Aj(z)}));this.f2.CK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.Ex,
["PrivacyCompliantSolutionId"]:y,["StoreType"]:B,["SourceControlId"]:this.id,["MethodData"]:u})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,v){this.invokePropertySet(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u,v){switch(u){case 3:return this.fBj(v);case 1:return this.lDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,v){u=this.invokeMethod(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}fBj(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);
return null}lDa(){this._OnAccess();return null}}Object(t.a)(w,"RibbonTab",null,[]);var n=a(970),x=a(186);a.d(E,"DynamicRibbon",function(){return r});class r{constructor(u,v,B,z,A){this.Ex=u;this.qJ=B;this.f2=z;this.Jd=A;this.Rib=this.qJ.Ph;this.ez=this.Rib.getOsfControl(v);this.uAg=this.ez.getManifest()}get buttons(){return null}executeRequestCreate(u){try{var v=this.Jd.OwnerAddinStoreType;const z=this.Jd.PrimaryMarketplace.MarketplaceRef,A=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:
null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ex,v,A,null,null,z);const y={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,v,A,null,null,z),["ownerAddinStoreType"]:this.Jd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:r.OCc+"ExecuteRequestCreate",dataFields:f.a.Aj(y)}));const D=x.a.$h(u);u={};v={};v[d.a.NJa]=this.ez;v[d.a.OJa]=D;v[d.a.A$c]=this.Jd;u[d.a.Jub]=
3;u[d.a.l4]=this.Ex;u[d.a.M9b]=B;u[d.a.k4]=v;this.f2.CK(-1014260128,u);let I=r.icc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,I)}catch(z){B=r.icc("ExecuteRequestCreate",!1,z.toString()),c.ULS.sendTraceTag(538572825,0,50,B)}return null}executeRequestUpdate(u){try{var v=this.Jd.OwnerAddinStoreType;const z=this.Jd.PrimaryMarketplace.MarketplaceRef,A=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ex,v,A,null,
null,z);const y={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,v,A,null,null,z),["ownerAddinStoreType"]:this.Jd.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};e.a.sendTelemetryEvent(Object.assign(new m.a,{name:r.OCc+"ExecuteRequestUpdate",dataFields:f.a.Aj(y)}));const D=x.a.$h(u);u={};v={};v[d.a.NJa]=this.ez;v[d.a.OJa]=D;v[d.a.A$c]=this.Jd;u[d.a.Jub]=3;u[d.a.l4]=this.Ex;u[d.a.M9b]=B;u[d.a.k4]=v;this.f2.CK(-1014260128,
u);let I=r.icc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,I)}catch(z){B=r.icc("ExecuteRequestUpdate",!1,z.toString()),c.ULS.sendTraceTag(538572823,0,50,B)}return null}getButton(u){let v=null;if(!this.ejf())return this.qIe();if(u&&0<u.length){if(!this.tDe(u))return this.JIe(u);v=new l(u,this.Ex,this.f2,this.Jd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}getTab(u){let v=null;if(!this.ejf())return this.qIe();if(this.ez.getOwnerAddinControlRecreated())return this.Xdh();
if(u&&0<u.length){if(!this.tDe(u))return this.JIe(u);v=new w(u,this.Ex,this.f2,this.Jd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokePropertyGetAsync(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}invokePropertySet(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
}invokePropertySetAsync(u,v){this.invokePropertySet(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(u){switch(u){case 1:return this.lDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);}invokeMethodAsync(u,v){switch(u){case 7:return this.kEh(v);case 6:return this.lEh(v);case 3:return this.ZPh(v);case 5:return this.j4h(v)}u=this.invokeMethod(u,v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)}kEh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,
0,"string");return this.executeRequestCreate(u)}lEh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)}ZPh(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)}j4h(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getTab(u)}lDa(){this._OnAccess();return null}JIe(u){return n.a(h.a.u$g,x.a.ga(1762)+u)}qIe(){return n.a(h.a.kpj,x.a.ga(1758))}Xdh(){return n.a(h.a.hostRestartNeeded,
x.a.ga(1763))}ejf(){var u=this.ez.getSharedRuntimeId();u=!!u&&0<u.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u}tDe(u){const v=this.uAg.getRibbonExtensionControlMap();return u in v||this.D3g(u)}D3g(u){var v=this.GHh();if(v){v=v.uPe;for(const B of v.tabs){if(B.id===u)return!0;for(const z of B.groups)for(const A of z.controls){if(A.id===u)return!0;if("Menu"===A.type){v=A;for(const y of v.items)if(y.id===u)return!0}}}}return!1}GHh(){return b.a.getInstance().xja(this.Jd.PrimaryMarketplace.MarketplaceType,
this.Jd.PrimaryMarketplace.SolutionId,1)}static icc(u,v,B){const z={};z.methodName="DynamicRibbon."+u;z.result=v?"Succeeded":"Failed";z.message=B;return x.a.fc(z)}}r.OCc="Office.Online.Extensibility.Ribbon.";Object(t.a)(r,"DynamicRibbon",null,[])},957:function(t,E,a){a.d(E,"a",function(){return b});var c=a(958);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},964:function(t,E,a){a.d(E,"a",function(){return c});
const c=(b,e)=>{let f=!1;b&&(b=e.osfControl,(e=b.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},965:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Iha=this.TUa=this.fid=this.Gkd=this.pyb=this.JZd=null}}Object(t.a)(c,"AppsForOfficeOauthResult",null,[])},970:function(t,E,a){a.d(E,"a",function(){return c});const c=(b,e)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,e))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/78063e7c4198242a2b90a425b2ff9bf2/EwaDSEsNext.agave.js.map