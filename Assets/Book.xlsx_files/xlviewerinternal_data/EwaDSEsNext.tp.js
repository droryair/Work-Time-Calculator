'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[62],{1448:function(t,E,a){a.r(E);var c=a(0),b=a(513),e=a(49),f=a(9),d=a(52),h=a(89),m=a(55),l=a(83),w=a(222),n=a(420),x=a(37),r=a(7),u=a(15),v=a(85),B=a(82),z=a(224),A=a(14),y=a(108),D=a(4),I=a(87),M=a(147),T=a(120),S=a(574),H=a(95),C=a(735),G=a(5),J=a(724),L=a(131),P=a(374),aa=a(188),U=a(284),K=a(33),Y=a(248),na=a(565),W=a(12),X=a(1),Aa=a(11),Q=a(13),fa=a(21),Ca=a(132),ia=a(152),Ra=a(347),Ya=a(685),Ga=a(554),da=
a(19);const Z=da.a.Dbd;class ha extends H.a{constructor(ec,sc,Dc,Ud){super(ec);this.fue='<div id="AgaveTaskPaneHeaderId"><span class="{0}" id="{1}"></span></div><div id="{2}"></div>';this.A1b=null;this.bod=this.ufg=!1;this.Cbe=this.vj=this.pf=null;this.yq=0;this.button=null;this.DQf=!1;this.$ec="Help.GiveFeedback.Url";this.onCloseButtonTabKeyDown=Ed=>{if(void 0!==Ed.Ca&&null!==Ed.Ca&&Ed.Ca.keyCode===v.a.$y)if(Ed.Ca.shiftKey){if(!K.a.gd(this.$)){Ed=this.$.da.Aa(183);if(!Ed)return!1;Ed.RSd()}}else this.kg(!0,
!1),Ed.Ca.preventDefault(),Ed.Ca.stopPropagation();return!0};this.Qqc=(Ed,$d)=>{Object.getType($d)===String&&$d.toString()===this.pf.InstanceId&&(Ed=!!this.title,$d=!this.bod,Ed&&this.tQe(),this.Ehg(),K.a.gd(this.$)&&(Ed&&this.ufg||$d&&this.bod)&&this.e8.updateTaskPane(this.q1,this.$B))};this.Ema=()=>{var Ed;X.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")&&this.vj.RMd(this.pf.InstanceId);const $d=na.a(this.pf);if($d)if(this.pf.TaskpaneTitle===Q.a.instance.ga(981))u.ULS.sendTraceTag(537151139,
9,50,"Chart task pane closed");else if(this.pf.PrimaryMarketplace)if("FA000000005"===this.pf.PrimaryMarketplace.SolutionId){u.ULS.sendTraceTag(537151138,397,50,"Ideas task pane closed");let ve="Unknown",ze="Unknown",We="Unknown";null===(Ed=this.pf.OsfPropertyBag)||void 0===Ed?void 0:Ed.forEach(md=>{2===md.length&&("LaunchMode"===md[0]?ve=md[1]:"CorrelationId"===md[0]?ze=md[1]:"LaunchSelectionMode"===md[0]&&(We=md[1]))});Ed={["LaunchMode"]:ve,["CorrelationId"]:ze,["LaunchSelectionMode"]:We,["Location"]:"taskPane"};
Ca.b(this.$).vd(L.a.d6g,Ed,void 0,!0);'"Default"'===ve?B.a.instance.Rb("Common.ISystemInitiatedFeedback").execute(md=>{md.logActivity("Office_Excel_Ideas_InitializeClosePaneFloodgate",null)}):'"RecommendedCharts"'===ve?B.a.instance.Rb("Common.ISystemInitiatedFeedback").execute(md=>{md.logActivity("Office_Excel_RecommendedCharts_InitializeClosePaneFloodgate",null)}):'"RecommendedPivotTables"'===ve&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:4724516_AddSurveyForRecommendedPivotTables")?B.a.instance.Rb("Common.ISystemInitiatedFeedback").execute(md=>
{md.logActivity("Office_Excel_RecommendedPivotTable_InitializeClosePaneFloodgate",null)}):'"ChartDesigner"'===ve&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:5202022_AddSurveyForChartDesigner")&&B.a.instance.Rb("Common.ISystemInitiatedFeedback").execute(md=>{md.logActivity("Office_Excel_ChartDesigner_InitializeClosePaneFloodgate",null)})}else K.a.uki()&&"FA000000043"===this.pf.PrimaryMarketplace.SolutionId?"Record Actions"===this.pf.TaskpaneTitle&&(this.$.Zba=!1,u.ULS.sendTraceTag(537151137,0,50,
"OnCloseButtonClick: set recording state to false since the recorder task pane is closed.")):this.pf.PrimaryMarketplace.SolutionId===S.a?this.ctf(!1):"FA000000075"===this.pf.PrimaryMarketplace.SolutionId&&(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1)||X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1))&&(Ed=this.$.da.Aa(465))&&(Ed.Xhi(),Ed.hOe());Aa.HelperMethods.Jw(this.pf)?
this.wg(!1):(K.a.gd(this.$)?this.e8.hideTaskPane(this.q1):this.raiseEvent("AgavePaneRemovedEventKey"),this.vj.FRa(this.pf.InstanceId),K.a.gd(this.$)||this.e8.nA());fa.h(this.$).setFocus();if(1===this.pf.WebExtensionOsfControlType&&!$d){this.pf.TaskpaneVisible=!1;const ve=this.$.pa.xa.Wb();P.a(this.$.userOperationManager,(ze,We,md)=>U.c(this.$.pa.xa,this.pf.InstanceId,!1,ze,We,md,ve),ze=>new aa.a(547,0,ze,64),null)}return!0};this.cHf=(Ed,$d)=>{Object.getType($d)===String&&$d.toString()===this.pf.InstanceId&&
(K.a.gd(this.$)?this.e8.hideTaskPane(this.q1):this.raiseEvent("AgavePaneRemovedEventKey"))};this.bHf=(Ed,$d)=>{Object.getType($d)===String&&$d.toString()===this.pf.InstanceId&&(this.x0d(),K.a.gd(this.$)?this.a7():this.e8.oG(this,!0))};this.onResize=()=>{this.Gad()};this.$=sc;this.e8=Dc;X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")&&Ud?Ud.ni(this.domElement,String.format(this.fue,
Z,this.$.Eb+G.a.iZc,this.$.Eb+G.a.hZc)):this.domElement.innerHTML=String.format(this.fue,Z,this.$.Eb+G.a.iZc,this.$.Eb+G.a.hZc);this.Gsg=W.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+G.a.hZc);this.Asa=W.DOMElementExtensions.getElementById(this.domElement,this.$.Eb+G.a.iZc);X.EwaSettings.oa(395)&&(this.A1b=W.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId"));ec=W.DOMElementExtensions.getElementById(this.domElement,"AgaveTaskPaneHeaderId");this.Soa=this.cch();
ec.appendChild(this.Soa);z.a.instance.sa(A.a.click,this.Soa,this.Ema);this.rlc=y.KeyInputManager.instance.Qs(this.Soa,this.Ema,v.a.Kh);K.a.gd(this.$)||y.KeyInputManager.instance.sa(A.a.Pb,this.Soa,this.onCloseButtonTabKeyDown);W.DOMElementExtensions.setVisible(this.Asa,!1);this.domElement.style.height="100%";this.domElement.style.width="100%";this.domElement.style.overflowY="hidden";this.Gad();this.$&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&this.domElement.classList.add(C.a.STe);
this.$.DC(this.onResize)}WP(ec){this.addHandler("AgavePaneRemovedEventKey",ec)}hS(ec){this.removeHandler("AgavePaneRemovedEventKey",ec)}PLg(ec){this.addHandler("AgavePaneReadyKey",ec)}Jhj(ec){this.removeHandler("AgavePaneReadyKey",ec)}get eHa(){return this.Gsg}get kh(){return 6}get Ek(){return this.pf.TaskpaneIconCssClass||""}get FN(){return this.pf.TaskpaneButtonTooltip||this.pf.WebExtensionToolTip+" "+this.title}get iconUrl(){return this.Cbe}get Lp(){return this.pf.TaskpaneWidth}get isResizable(){const ec=
sc=>{var Dc,Ud;return(null===(Ud=null===(Dc=this.pf)||void 0===Dc?void 0:Dc.PrimaryMarketplace)||void 0===Ud?void 0:Ud.SolutionId)===sc};return!OSF.OsfControl.isFirstPartyStoreString(this.pf.PrimaryMarketplace.MarketplaceType)&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:4470694_LegacyTaskpaneResizeForThirdParty")||ec("FA000000043")||ec("FA000000054")||X.EwaSettings.isChangeGateEnabled("OfficeVSO:6545419_ExcelIdeasResize")&&ec("FA000000005")||X.EwaSettings.isChangeGateEnabled("OfficeVSO:6197879_DataFromPictureResize")&&
ec("FA000000050")?!0:!1}get he(){return Y.a.AQg}get mc(){return this.domElement}get Hf(){return!!this.pf}get title(){return this.vj.cTh(this.pf.InstanceId)}get titleText(){return this.title}get t_a(){return OSF.OsfControlTarget.TaskPane}get instanceId(){return this.pf.InstanceId}get q1(){return"AgaveTaskPane-"+this.instanceId.replace(RegExp("[{}]","g"),"")}get $B(){const ec=this.e8.Eva(this.mc,this.titleText,this.Lp,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=
!0},()=>{this.isVisible=!1},this.Lp,void 0,this.iconUrl,this.pf.TaskpaneIconId,Aa.HelperMethods.Jw(this.pf));if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)&&this.pf.SrcLocationOverrideResourceId===this.$ec){ec.contentProps.type="OcvFeedbackTaskPaneProps";ec.hideHeader=!1;let sc=JSON.parse(this.pf.OsfPropertyBag[0][1]);sc.IsProd=!0;ec.contentProps.feedbackTaskPaneProps={customerUiWrapperFeedbackData:sc,taskPaneLocation:ec.location,taskPaneIdToClose:this.q1}}return ec}startEdit(){return!0}PBc(){return!0}Cpf(){this.vj.Ph.notifyAgave(this.pf.InstanceId,
OSF.AgaveHostAction.TabIn)}Dpf(){this.vj.Ph.notifyAgave(this.pf.InstanceId,OSF.AgaveHostAction.TabInShift)}yEd(){this.vj.aYc(this.cHf);this.vj.wMg(this.bHf);let ec=this.vj.$gd(this.pf.InstanceId);this.title&&ec||this.vj.zMg(this.Qqc);this.title&&this.tQe();this.raiseEvent("AgavePaneReadyKey");K.a.gd(this.$)&&(""!==this.Ek?d.a.de(10):d.a.current.io(102),this.Ajg(),X.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&K.a.gd(this.$)&&Aa.HelperMethods.Jw(this.pf)&&this.pf.Preload&&
!this.pf.TaskpaneVisible?this.c7b():this.a7())}c7b(){this.e8.c7b(this.q1,this.$B)}a7(){this.e8.a7(this.q1,this.$B)}dispose(){var ec,sc;this.DQf||(null===(sc=null===(ec=this.pf)||void 0===ec?void 0:ec.PrimaryMarketplace)||void 0===sc?void 0:sc.SolutionId)!==S.a||this.ctf(!0);z.a.instance.Ba(A.a.click,this.Soa,this.Ema);y.KeyInputManager.instance.Xv(this.Soa,this.rlc);K.a.gd(this.$)||y.KeyInputManager.instance.Ba(A.a.Pb,this.Soa,this.onCloseButtonTabKeyDown);this.vj&&(this.vj.nij(this.Qqc),this.vj.lij(this.cHf),
this.vj.kij(this.bHf),this.$&&(this.$.jG(this.onResize),this.$=null));this.$=this.pf=null;super.dispose()}Ajg(){this.pf&&this.Ehg()}VR(ec){ec||this.x0d()}wg(ec){if(this.pf){const sc=this.pf.TaskpaneVisible!==ec;this.pf.TaskpaneVisible=ec;K.a.gd(this.$)?ec||this.e8.hideTaskPane(this.q1):this.e8.nA();Aa.HelperMethods.Jw(this.pf)&&sc&&this.vj.VHh(this.instanceId,ec)}}pq(){let ec=!1;this.pf&&this.$.qd&8388608&&(ec=this.pf.TaskpaneVisible);return ec}Fs(){return!this.pf||OSF.OsfControl.isFirstPartyStoreString(this.pf.PrimaryMarketplace.MarketplaceType)||
this.$.ZY?Aa.HelperMethods.Jw(this.pf)?this.pf.TaskpaneVisible:!!this.pf:!1}kg(ec,sc){return sc?!1:(this.x0d(),this.vj.Ph.notifyAgave(this.pf.InstanceId,ec?OSF.AgaveHostAction.TabIn:OSF.AgaveHostAction.TabInShift),!0)}nh(ec){return W.DOMElementExtensions.Af(this.mc,ec)}qj(){}dk(){}bR(ec,sc){var Dc=sc.querySelectorAll(W.DOMElementExtensions.Fr);sc=W.DOMElementExtensions.um(Dc);Dc=W.DOMElementExtensions.mB(Dc);let Ud=!1;sc===ec.Gb&&ec.Ca.shiftKey?((ec=document.getElementById(this.$.Eb+G.a.Qoc))&&W.DOMElementExtensions.isVisible(ec)?
W.DOMElementExtensions.setFocus(ec):this.kg(!1,!1),Ud=!0):Dc!==ec.Gb||ec.Ca.shiftKey||(this.j5f(),Ud=!0);return Ud}j5f(){this.Soa&&W.DOMElementExtensions.setFocus(this.Soa)}cch(){const ec=document.createElement("a");ec.tabIndex=0;ec.id="AgaveTaskpaneCloseButtonId";ec.className=G.a.Tfb+(D.AFrameworkApplication.isRtl?G.a.Vaa:G.a.Waa);ec.title=Q.a.instance.ga(10);ec.setAttribute(I.a.Ad,I.a.rt);ec.style.borderColor="transparent";X.EwaSettings.isChangeGateEnabled("OfficeVSO:4186654_RemoveAgaveTaskpaneCloseBottomMargin")?
ec.style.margin="6px 6px 0px 6px":ec.style.margin="6px";ec.style.zIndex="2";ec.style.position="relative";const sc=document.createElement("span");sc.className="StandardButtonImage clip16x16 StandardButtonImageNoText";sc.id=ec.id+"-close";const Dc=ia.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,Q.a.instance.ga(793));sc.appendChild(Dc);ec.appendChild(sc);return ec}tQe(){this.Asa.innerText=this.title;this.Asa.style.textOverflow="ellipsis";this.Asa.style.whiteSpace="nowrap";this.Asa.style.overflowX=
"hidden";this.pf.TaskpaneTitleCssClass&&(this.Asa.className=this.Asa.className+" "+this.pf.TaskpaneTitleCssClass);X.EwaSettings.oa(395)&&(this.A1b.className=this.A1b.className+" "+this.pf.TaskpaneHeaderCssClass);W.DOMElementExtensions.setVisible(this.Asa,!0);this.button&&(this.button.J0a.title=this.title);this.Gad();this.ufg=!0}Ehg(){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")){if(this.Ek&&!K.a.gd(this.$)){if(this.button){var ec=d.a.de(10),sc=this.button.Il;
sc.setAttribute("src",ec);sc.setAttribute("class",this.Ek)}return}}else if(this.Ek){this.button&&(ec=d.a.de(10),sc=this.button.Il,sc.setAttribute("src",ec),sc.setAttribute("class",this.Ek));return}if(sc=X.EwaSettings.isChangeGateEnabled("OfficeVSO:5617870_SdxTaskpaneIconUrlOverride")?this.pf.TaskpaneIconUrl?this.pf.TaskpaneIconUrl:this.vj.$gd(this.pf.InstanceId):this.vj.$gd(this.pf.InstanceId))this.$.cca&&this.pf.PrimaryMarketplace&&this.pf.PrimaryMarketplace.SolutionId===J.a.solutionId&&(sc=this.JWh(sc)),
K.a.gd(this.$)?this.Cbe=sc:(ec=this.button.Il,ec.setAttribute("src",sc),sc=d.a.current.io(102),ec.setAttribute("onerror","this.onerror = null;this.src = '"+sc+"';")),this.bod=!0}JWh(ec){const sc=J.a.jec(this.$),Dc=J.a.K4(this.$),Ud=J.a.pba(this.$),Ed=J.a.Vxb(this.$),$d=this.pf.SrcLocationOverrideResourceId,ve=K.a.gd(this.$);return $d===sc?ve?ec.replace("/icon-32.png","/record-tp-20.png"):ec.replace("/icon-32.png","/record-tp-32.png"):$d===Dc?ve?ec.replace("/icon-32.png","/code-tp-20.png"):ec.replace("/icon-32.png",
"/code-tp-32.png"):$d===Ud?ve?ec.replace("/icon-32.png","/rfb-tp-20.png"):ec.replace("/icon-32.png","/rfb-tp-32.png"):$d===Ed?ve?ec.replace("/icon-32.png","/flowconnector-tp-20.png"):ec.replace("/icon-32.png","/flowconnector-tp-32.png"):ec}Gad(){this.$&&!X.EwaSettings.isChangeGateEnabled("OfficeVSO:4658493_AgaveTaskPaneFlexLayoutMac")&&(this.eHa.style.height=Aa.HelperMethods.uc(this.e8.iP.offsetHeight-this.A1b.offsetHeight))}x0d(){this.vj.oCd(this)}ctf(ec){ec={["PaneClosedTime"]:Date.now(),["IsSessionEnded"]:ec.toString()};
const sc=new Ya.a(Ga.a.ak());sc.add("PaneClosedTime",3);sc.add("IsSessionEnded",1);M.a.sendTelemetryEvent(Object(r.a)(new Ra.a,{name:"Office.Excel.Online.Protection.TaskPaneClosed",dataFields:T.a.Aj(ec,sc)}));this.DQf=!0}}Object(c.a)(ha,"AgaveTaskPane",H.a,[66,276,280,430]);var Wa=a(48);class ca extends w.a{constructor(ec){super();this.PGd=[];this.qLf=null;this.uAf=sc=>{this.ob(Object(l.a)(276,sc))};this.$=ec;this.Fb()}create(){const ec=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
X.EwaSettings.isChangeGateEnabled("OfficeVSO:7117293_ReduceInnerHTMLUsageForAgaveTaskPane")?Wa.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):m.Task.Ra(null),sc=n.a(this.$);x.TaskExtensions.za(x.TaskExtensions.Ed([sc,ec],this.$.ka),()=>{const Dc=new ha(document.createElement("div"),this.$,sc.result,ec.result);this.PGd.push(Dc);Dc.PLg(this.uAf);this.Qa.raiseEvent(w.a.l0c,null,Dc)},this.ka,3)}dispose(){for(const ec of this.PGd)ec.Jhj(this.uAf);h.a.rc(this.PGd);h.a.Ia(this.qLf);this.$=this.qLf=
null;super.dispose()}}Object(c.a)(ca,"AgaveTaskPaneFactory",w.a,[]);var ja=a(30),ua=a(238),Za=a(209),Pa=a(260),ka=a(60),ra=a(47),ba=a(46),Ua=a(326),Ka=a(71),Oa=a(22),ib=a(286),La=a(282);const db=da.a.XAh,Ab=`<div class="${da.a.Dbd}"><div title="{0}" class="${da.a.gyh}">{0}</div></div><div><div class="${da.a.byh}">{1}</div><div class="${da.a.dyh} ${da.a.Do}" id="parametersSection">&nbsp;</div><div align="bottom" class="${da.a.ayh}"><button class="${da.a.OTe} ${da.a.$xh}" id="applyButton" type="submit">{2}</button><button class="${da.a.OTe}" id="resetButton" type="button">{3}</button></div></div>`,
Mb=`<div><div class="${da.a.eyh}"><label for="{2}" title="{1}">{0}</label></div><div class="${da.a.fyh}"><input type="text" maxlength="255" id="{2}"/></div></div>`;class pb extends ua.a{constructor(ec,sc,Dc,Ud){super(ec);this.pTd=this.RWa=this.s1=null;this.yq=0;this.htmlSanitizationHelper=null;this.pJf=()=>{this.RWa=null};this.jzj=()=>{h.a.Ia(this.pTd);this.pTd=null;this.isVisible!==this.$Ud&&this.raiseEvent("parameterTaskPaneVilibilityChanged")};this.Z7g=(Ed,$d)=>Oa.a.compare(Ed.Name,$d.Name,!0);
this.CAf=Ed=>{Ka.g(Ed);if(!this.Ksa.domElement.classList.contains(da.a.N$b)){fa.h(this.$).Xo(!0);var $d=[];for(Ed=0;Ed<this.s1.length;Ed++){const ze=this.RWa[Ed],We=this.s1[Ed].text;ze.Values=[We];We&&$d.push(ze)}if($d.length){var ve=this.$.pa.xa.Wb();this.Ksa.addCssClass(da.a.N$b);this.$.userOperationManager.Ic(new aa.a(142,0,(ze,We,md)=>ka.F(this.$.pa.xa,$d,!1,0,!1,La.b(ze,this.LYi),La.a(We,this.KYi),md,null,ve)),null)}}};this.xXi=Ed=>{Ka.g(Ed);Ed=this.s1;for(let $d=0,ve=Ed.length;$d<ve;$d++)Ed[$d].text=
""};this.LYi=()=>{this.Ksa.removeCssClass(da.a.N$b)};this.KYi=()=>{this.Ksa.removeCssClass(da.a.N$b)};this.oHb=(Ed,$d)=>{13===$d.charCode&&this.CAf($d)};this.$=sc;this.taskPaneManager=Dc;this.htmlSanitizationHelper=Ud;sc=String.format(Ab,this.titleText,Q.a.instance.ga(1325),Q.a.instance.ga(1326),Q.a.instance.ga(1327));this.htmlSanitizationHelper&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
this.htmlSanitizationHelper.ni(ec,sc):ec.innerHTML=sc;this.obb=this.getElementById("parametersSection");this.Ksa=new Ua.a(this.getElementById("applyButton"));this.Ksa.Gc.la("click",this.CAf);this.VOd=new Ua.a(this.getElementById("resetButton"));this.VOd.Gc.la("click",this.xXi);this.$.ea.Xj(this.pJf);Pa.a(this.$).di(this)}WP(ec){this.get_events().addHandler("RemoveParamTpEventKey",ec)}hS(ec){this.get_events().removeHandler("RemoveParamTpEventKey",ec)}RE(ec){this.addHandler("parameterTaskPaneVilibilityChanged",
ec)}lG(ec){this.removeHandler("parameterTaskPaneVilibilityChanged",ec)}get c9b(){this.Qff();return this.RWa}get mc(){return this.domElement}get Lp(){return 250}get isResizable(){return!1}get Hf(){return this.isVisible}get he(){return Y.a.t2i}get kh(){return 2}get Ek(){return db}get FN(){return Q.a.instance.ga(1066)}get $Ud(){return!!this.c9b&&0<this.c9b.length&&!this.$.isEditMode}get titleText(){return Q.a.instance.ga(1324)}get $B(){return this.taskPaneManager.Eva(this.mc,this.titleText,this.Lp,this.isResizable,
()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1})}wg(ec){K.a.gd(this.$)&&(ec?(this.Qff(),this.taskPaneManager.a7("ParametersTaskPane",this.$B)):this.taskPaneManager.hideTaskPane("ParametersTaskPane"))}pq(){return this.$Ud}Fs(){return this.$Ud}VR(){}dispose(){this.$&&this.$.ea.tk(this.pJf);this.hWf();h.a.rc([this.Ksa,this.VOd]);this.RWa=this.obb=this.$=this.Ksa=this.VOd=null;super.dispose()}kg(ec,sc){sc||(this.s1&&0<this.s1.length?this.s1[0]:this.Ksa).focus();
return!sc}nh(ec){return W.DOMElementExtensions.Af(this.mc,ec)}qj(){}dk(){}bR(){return!1}Qff(){!this.RWa&&this.$.qd&2048&&this.kUg(this.$.workbookContext.TaskPaneParameters,this.$.ya.SlicerParameters)}kUg(ec,sc){var Dc=[];this.hWf();if(!this.$.isEditMode&&ec&&0<ec.length){var Ud=this.Z7g;if(sc&&0<sc.length){var Ed=new Za.a([...sc]);Ed.w$.sort(Ud)}else Ed=null;for(let ve=0,ze=ec.length;ve<ze;ve++){var $d=ec[ve];sc&&!(0>Aa.HelperMethods.ow(Ed,0,Ed.jka(),$d,Ud))||$d.IsPivotPageField||$d.IsSlicer||Dc.push($d)}}this.RWa=
Dc;if(this.obb&&(this.isVisible!==0<Dc.length&&(this.pTd=ra.a.instance.create(this.jzj,500,ba.a.u2i,!0,!0)),this.htmlSanitizationHelper&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.RJ(this.obb):this.obb.innerHTML="",Dc.length)){sc="";ec=[];for(let ve=0,ze=Dc.length;ve<ze;ve++)Ud=this.$.Eb+"param"+ve,ec.push(Ud),$d=Dc[ve],Ed=$d.Name?ja.a.rg($d.Name):
"",$d=$d.Comment?ja.a.EK($d.Comment):"",sc+=String.format(Mb,Ed,$d,Ud);this.htmlSanitizationHelper&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?this.htmlSanitizationHelper.ni(this.obb,sc):this.obb.innerHTML=sc;sc=[];for(let ve=0,ze=Dc.length;ve<ze;ve++)Dc=new ib.a(document.getElementById(ec[ve])),sc.push(Dc),Dc.ANg(this.oHb);this.s1=sc}}hWf(){if(this.s1){for(let ec=0,sc=
this.s1.length;ec<sc;ec++)this.s1[ec].ajj(this.oHb);h.a.rc(this.s1);this.s1=null}}static lUg(ec,sc,Dc){const Ud=ec.da;let Ed=Ud.Aa(17);if(!Ed){const $d=document.getElementById(ec.Eb+G.a.v2i);$d&&(Ed=Ud.Ga(17,new pb($d,ec,sc,Dc)))}return Ed}}Object(c.a)(pb,"ParametersTaskPane",ua.a,[164,280,66,3]);class Qb extends w.a{constructor(ec){super();this.$=ec;this.Fb()}create(){const ec=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153383_ReduceInnerHTMLUsageForParametersTaskPane")?
Wa.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):m.Task.Ra(null),sc=n.a(this.$);x.TaskExtensions.za(x.TaskExtensions.Ed([sc,ec],this.$.ka),()=>{this.ob(pb.lUg(this.$,sc.result,ec.result))},this.ka,3)}}Object(c.a)(Qb,"ParametersTaskPaneFactory",w.a,[]);var xb=a(695),pa=a(184);class Ma{nc(){return!1}executeCommand(ec,sc){ec=sc.command;switch(ec){case 329273335:case 1962240939:case 296943390:case -625072140:return m.Task.Ra(!0);default:return pa.a(ec)}}yc(ec,sc,Dc,Ud){if(ec=!!Ud&&2===Ud.oz)switch(sc.command){case 329273335:case 1962240939:case 296943390:case -625072140:break;
default:ec=!1}return ec}Lc(){return!1}}Object(c.a)(Ma,"TaskPaneCommandHandler",null,[219]);class ya extends xb.a{constructor(ec){super(ec)}ld(){this.Zc([new Ma])}static la(ec){xb.a.Nd(115,new ya(ec))}}Object(c.a)(ya,"TaskPaneCommandHandlerFactory",xb.a,[]);var Ea=a(1322),Na=a(173);class kb{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=
this.middleContainer=null}}Object(c.a)(kb,"TaskPaneGroupAppProps",null,[]);var lb=a(27),oa=a(38),Ba=a(212);class sa{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(c.a)(sa,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var qb=a(294),Jb=a(18),Yb=a(16),jb=a(128);class ab{constructor(ec){this.width=ec}}Object(c.a)(ab,"ActiveTaskPaneData",null,[]);class vb extends oa.a{constructor(ec,sc){super();this.isVisible=!1;
this.EZd=this.Lea=-1;this.rMe=40;this.ph=this.SL=this.animationManager=this.fKc=null;this.eEd=()=>{this.KZf()};this.HCc=new Set;this.HCc.add("FieldListTaskPane");this.HCc.add("PivotTableSettingsTaskPane");this.HCc.add("SlicerSettingsTaskPane");this.jb=sc;Pa.a(this.$).di(this);this.lA=ec;this.u$a=this.LYg();K.a.fj(sc)||D.AFrameworkApplication.ta.Pa.Pe||(this.lA.style.bottom=this.$.qd&4?Aa.HelperMethods.uc(this.$.Gea):"0");this.Eac={};this.CPb={};this.X5d={};this.BZd=jb.a.instance.oe(this.mc);this.BZd.la("focusin",
this.eEd);this.Nhi()}get $(){return this.jb}get hha(){return this.X5d}get dN(){return this.fKc}get isCollapsed(){return!this.dN}dispose(){Pa.a(this.$).aA(this);const ec=this.Eac;for(let sc in ec)({key:sc,value:ec[sc]}).value();this.CPb=this.X5d=this.Eac=null;this.BZd.iD();this.u$a=this.lA=this.BZd=null;super.dispose()}Eva(ec,sc,Dc,Ud,Ed,$d,ve,ze,We=vb.Vyi,md=vb.Uyi,$b=null,$c=null,nd=!1){const Oc=Object(r.a)(new sa,{getContent:()=>ec});Oc.isSharedRuntime=nd;return Object(r.a)(new Ea.a,{hideHeader:!0,
contentProps:Oc,title:sc,width:Dc,location:2,onOpen:Ed,onClose:$d,onShow:ve,onHide:ze,iconUrl:$b,iconId:$c,enableResize:Ud,minResizeWidth:We,maxResizeWidth:md})}a7(ec,sc){Na.UISurfaces.aj().then(Dc=>{ec in this.hha?Dc.setSelectedTaskPane(ec):Dc.showTaskPane(ec,sc);return null})}c7b(ec,sc){Na.UISurfaces.aj().then(Dc=>{Dc.initializeHiddenSharedRuntimeTaskPane(ec,sc);const Ud=this.$.domElement;Ud.addEventListener("scroll",function $d(){0!=Ud.scrollLeft&&(Ud.scrollLeft=0,Ud.removeEventListener("scroll",
$d))})})}updateTaskPane(ec,sc){Na.UISurfaces.aj().then(Dc=>{Dc.updateTaskPane(ec,sc);return null})}setSelectedTaskPane(ec){Na.UISurfaces.aj().then(sc=>{sc.setSelectedTaskPane(ec);return null})}hideTaskPane(ec){Na.UISurfaces.aj().then(sc=>{sc.hideTaskPane(ec,vb.EPj);return null})}get mc(){return this.lA}get Hf(){return this.isVisible}get he(){return Y.a.ECc}kg(ec,sc){return sc?!1:(this.K2f(),!0)}nh(ec){return W.DOMElementExtensions.Af(this.mc,ec)}qj(){this.$.frame.Le.vk(this.he)}dk(){}LYg(){const ec=
document.createElement(Ba.a.div);ec.style.height="0px";ec.style.width="0px";ec.tabIndex=-1;return ec}SNh(){var ec=W.DOMElementExtensions.getElementById(this.lA,"tabStripFocusZone");if(ec){ec=ec.getElementsByTagName("button");for(let sc=0;sc<ec.length;sc++)if(Boolean.parse(ec[sc].getAttribute("aria-selected")))return ec[sc].getAttribute("aria-controls")}return null}B8g(ec){return(ec=window.getComputedStyle(ec,null).getPropertyValue("transition-duration"))?parseInt(ec.endsWith("ms")?parseFloat(ec):
1E3*parseFloat(ec),10):0}uej(){const ec=document.getElementById("tabbedTaskPaneContainer");ec&&ec.addEventListener("transitionend",()=>this.THa(-1))}Nhi(){Na.UISurfaces.aj().then(ec=>{let sc;ec.renderTaskPaneGroups(null,this.lA,(sc=new kb,sc.middleContainer=this.u$a,sc.onOpen=(Dc,Ud)=>{this.isVisible=!0;-1===this.Lea&&(this.Lea=this.B8g(Ud));K.a.fj(this.$)||(this.hha[Dc]=new ab(W.DOMElementExtensions.lQ(W.DOMElementExtensions.getElementById(Ud,vb.heg))))},sc.onClose=Dc=>{this.isVisible=0<ec.selectors.getTabbedTaskPaneCount();
u.ULS.sendTraceTag(537014371,0,50,`Closing of ${Dc} TaskPane`);if(!this.isVisible)this.m_e(),K.a.fj(this.$)||D.AFrameworkApplication.ta.Pa.Pe||window.requestAnimationFrame(()=>{this.t1b(this.u$a)});else if(!K.a.fj(this.$)&&this.dN&&this.dN!==Dc){const Ud=1<ec.selectors.getTabbedTaskPaneCount()?this.Bec():0,Ed=1===ec.selectors.getTabbedTaskPaneCount()?-1*this.Bec():0;this.Kte(Dc,this.dN,Ud,Ed)}K.a.fj(this.$)?this.THa(this.Lea):(D.AFrameworkApplication.ta.Pa.Pe&&0>=this.Lea&&this.THa(this.Lea),delete this.hha[Dc]);
delete this.CPb[Dc]},sc.onShow=(Dc,Ud)=>{null!=this.ei&&(this.ei.stop(),this.ei=null);this.fKc=Dc;this.KZf();1!==Ud&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.zqj()},0)});K.a.fj(this.$)?window.requestAnimationFrame(()=>{this.THa(this.Lea)}):D.AFrameworkApplication.ta.Pa.Pe&&0>=this.Lea?window.requestAnimationFrame(()=>{this.THa(this.Lea)}):window.requestAnimationFrame(()=>{this.Trj(this.u$a,this.Lea)})},sc.onHide=(Dc,Ud,Ed)=>{const $d=this.SNh();$d!==Dc&&(this.ei=this.$.Kb.Cc("UserAction",
"TaskPaneToggle"),u.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${Dc} to ${$d}`));Ed?K.a.fj(this.$)||this.t1b(this.u$a):!K.a.fj(this.$)&&$d&&(Dc=1===Object.keys(this.hha).length?this.Bec():0,this.Kte(this.dN,$d,this.Bec(),Dc));this.fKc=null;Ed&&1!==Ud&&this.m_e();K.a.fj(this.$)&&window.requestAnimationFrame(()=>{this.THa(this.Lea)})},sc.setFocusCallback=(Dc,Ud)=>{Ud&&(this.CPb[Dc]=Ud)},sc.onResizeStart=()=>{K.a.fj(this.$)||this.YYc(Aa.HelperMethods.uc(0))},sc.onResizeEnd=()=>{K.a.fj(this.$)?
this.THa():(this.t1b(this.u$a),this.hha[this.dN]=this.xkd(this.dN));u.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.dN} TaskPane`)},sc));D.AFrameworkApplication.ta.Pa.Pe&&!K.a.fj(this.$)&&this.uej();return null})}t1b(ec){this.YYc(this.$.isChromeRtl?ec.style.left:ec.style.right)}YYc(ec){u.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.dN}`);this.$.nnj(ec)}THa(ec=0){-1<ec?m.Task.delay(ec+this.rMe).continueWith(()=>{this.$.jAa(qb.a.h_("ResetContentAreaMargin"))}):
this.$.jAa(qb.a.h_("ResetContentAreaMargin"))}Kte(ec,sc,Dc,Ud){sc=sc.endsWith(vb.CZd)?sc.substring(0,sc.length-vb.CZd.length):sc;sc=this.g$e(sc);Ud=sc+Ud;ec=this.g$e(ec);Ud<ec&&this.YYc(Aa.HelperMethods.uc(sc+Dc))}Trj(ec,sc){window.setTimeout(()=>{this.t1b(ec)},sc+this.rMe)}Bec(){return-1!==this.EZd?this.EZd:this.EZd=W.DOMElementExtensions.lQ(W.DOMElementExtensions.getElementById(this.lA,"tabStripFocusZone"))}xkd(ec){return W.DOMElementExtensions.lQ(W.DOMElementExtensions.getElementById(W.DOMElementExtensions.getElementById(this.lA,
ec+vb.CZd),vb.heg))}g$e(ec){if(ec in this.hha){const sc=this.hha[ec].width;return 0<sc?sc:this.xkd(ec)}return ec?this.xkd(ec):0}m_e(){fa.h(this.$).setFocus()}zqj(){if(this.CPb[this.dN]){const ec=this.CPb[this.dN];ec&&ec(null,null)}else this.HCc.has(this.dN)||this.K2f()}K2f(){Na.UISurfaces.aj().then(ec=>{1<ec.selectors.getTabbedTaskPaneCount()?ec.focusTabbedTaskPaneArea():(ec=W.DOMElementExtensions.getElementById(this.mc,"AgaveTaskpaneCloseButtonId"))?ec.focus():(ec=W.DOMElementExtensions.um(this.mc.querySelectorAll("button")))&&
ec.focus();return null})}KZf(){this.$.domElement.scrollLeft=0;lb.a.WNa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}RE(ec){this.addHandler(vb.zhb,ec)}lG(ec){this.removeHandler(vb.zhb,ec)}get iP(){return this.lA}get ZB(){u.ULS.shipAssertTag(537151112,11,!1,"ReactTaskPaneManager.TaskPaneButtons should not be used with the WAC infra");return null}ctb(ec,sc,Dc,Ud,Ed){let $d=ec.Aa(sc);$d||($d=Yb.a(Jb.a,Dc,ec,sc),$d.SetScriptLoadFlavor(Ed));
Ud&&$d.XXc(Ud);const ve=""+sc;let ze=null;const We=()=>{$d.create();ze()};this.Eac[ve]=ze=()=>{$d.Bvc(We);delete this.Eac[ve]};$d.H0b(We)}initialize(){u.ULS.shipAssertTag(537151111,11,!1,"ReactTaskPaneManager.Initialize should not be used with the WAC infra")}n$f(){}IN(){u.ULS.shipAssertTag(537151110,11,!1,"ReactTaskPaneManager.InsertPane should not be used with the WAC infra")}oG(){u.ULS.shipAssertTag(537151109,11,!1,"ReactTaskPaneManager.SelectPane should not be used with the WAC infra")}qre(){u.ULS.shipAssertTag(537151108,
11,!1,"ReactTaskPaneManager.AddTaskPane should not be used with the WAC infra")}iZf(){u.ULS.shipAssertTag(537151107,11,!1,"ReactTaskPaneManager.RepositionTaskpaneForCurrentMode should not be used with the WAC infra")}oyb(){u.ULS.shipAssertTag(537151106,11,!1,"ReactTaskPaneManager.GetTaskPane should not be used with the WAC infra");return null}rgd(){u.ULS.shipAssertTag(537151105,11,!1,"ReactTaskPaneManager.GetButtonsByTaskPaneType should not be used with the WAC infra");return null}pja(){u.ULS.shipAssertTag(537151104,
11,!1,"ReactTaskPaneManager.ExpandOrCollapsePane should not be used with the WAC infra")}nA(){u.ULS.shipAssertTag(537151075,11,!1,"ReactTaskPaneManager.UpdateAvailablePanes should not be used with the WAC infra")}setFocusOnToolbarFirstElement(){u.ULS.shipAssertTag(537151070,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarFirstElement should not be used with the WAC infra")}RSd(){u.ULS.shipAssertTag(537151069,11,!1,"ReactTaskPaneManager.SetFocusOnToolbarLastElement should not be used with the WAC infra")}static la(ec){const sc=
vb.HZg(ec.Eb,ec.isChromeRtl,ec);vb.qUg(ec,sc);return new vb(sc,ec)}static HZg(ec,sc,Dc){const Ud=document.createElement("div");Ud.id=ec+G.a.FCc;K.a.fj(Dc)?Ud.classList.add(da.a.f4j):(Ud.classList.add(sc?da.a.h4j:da.a.g4j),D.AFrameworkApplication.ta.Pa.Pe&&Ud.classList.add(da.a.wAa));return Ud}static qUg(ec,sc){ec.isMobileMode&&sc.setAttribute("aria-hidden","true");D.AFrameworkApplication.ta.Pa.Pe?document.getElementById("FarPaneRegion").appendChild(sc):(K.a.fj(ec)&&sc.classList.add(da.a.Tuh),document.getElementById(ec.Eb+
G.a.q1a).insertBefore(sc,ec.OBa))}}vb.Vyi=300;vb.Uyi=950;vb.EPj=2;vb.CZd="-panel";vb.heg="ExcelTaskPaneContentWrapper";vb.Fag="rtpSizeChanged";vb.AFe="rtpCollapsed";vb.uMf="rtpAdded";vb.zhb="rtpVisibility";Object(c.a)(vb,"ReactTaskPaneManager",oa.a,[278,66,3]);var Da=a(96),Fa=a(155),nb=a(240),Ta=a(419),V=a(84),va=a(556);class wb extends Sys.EventArgs{constructor(){super()}}Object(c.a)(wb,"TaskPaneVisibilityChangedEventArgs",Sys.EventArgs,[]);var fc=a(45);const Fc=C.a.Cxh,Qa=C.a.Exh,la=`<span class='${da.a.Zrb} ${C.a.Fxh} {3}'><img class='{1}' alt='{0}' src='{2}' {4}/></span>`;
class hb extends ua.a{constructor(ec){super(document.createElement("a"));this.Qa=new oa.a;this.htmlSanitizationHelper=this.Ome=null;this.fd=()=>{this.enabled&&this.Qa.raiseEvent("tpButtonClicked",null,this);return!0};this.htmlSanitizationHelper=ec}cMg(ec){this.Qa.addHandler("tpButtonClicked",ec)}xWf(ec){this.Qa.removeHandler("tpButtonClicked",ec)}get J0a(){return this.domElement}get taskPane(){return this.Ome}get enabled(){return super.enabled}set enabled(ec){ec!==super.enabled&&(this.domElement.classList.toggle(C.a.FU),
this.domElement.classList.toggle(Qa),this.domElement.tabIndex=ec?0:-1,super.enabled=ec)}get Il(){return this.domElement.firstChild.firstChild}dispose(){h.a.rc([this.Qa]);this.Qa=null;this.domElement&&fc.a.tna(this.domElement);super.dispose()}Mhi(ec){const sc=6===ec.kh;var Dc=sc&&!ec.Ek;Dc=String.format(la,ec.FN,ec.Ek,Dc?d.a.current.io(102):d.a.de(10),C.a.Kia,Dc?String.format('style="width:24px;{0}:0px"',"left"):"");X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.ni(this.domElement,Dc):this.domElement.innerHTML=Dc;this.domElement.classList.add(Fc);this.domElement.classList.add(Qa);this.domElement.title=ec.FN;this.domElement.tabIndex=0;W.DOMElementExtensions.Yt(this.domElement,G.a.rt,null,null);this.Ome=ec;sc&&(ec=this.taskPane,null===ec||void 0===ec?void 0:ec.Ajg());z.a.instance.sa(A.a.click,this.domElement,this.fd);y.KeyInputManager.instance.Qs(this.domElement,this.fd,v.a.Kh)}}Object(c.a)(hb,"TaskPaneButton",ua.a,[410]);class Kb extends H.a{constructor(ec,
sc,Dc,Ud){super(ec);this.animationManager=this.g6=this.De=null;this.vJ=this.tWa=!1;this.$8d=0;this.jb=null;this.fOc=!1;this.htmlSanitizationHelper=null;this.Uz=()=>{this.cpi||(this.nA(),this.$.af())};this.rDd=(Ed,$d)=>{this.onButtonClick(Ed,$d)};this.H6=()=>{this.xEc()};this.$=sc;this.htmlSanitizationHelper=Ud;Pa.a(this.$).di(this);this.$.Cb.Wf(this.H6);this.configuration=Dc;this.baseName=Aa.HelperMethods.ewa(this.domElement,this.configuration.keg||this.configuration.q1);this.Dac={};this.Vfb=[];this.mu=
[];this.brb={};this.Pme=document.getElementById(this.baseName+this.configuration.AZd);this.iP||u.ULS.sendTraceTag(512291722,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.AZd} not found`);this.cFg=document.getElementById(this.baseName+this.configuration.q1);this.lA||u.ULS.sendTraceTag(512291721,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.q1} not found`);this.dFg=document.getElementById(this.baseName+this.configuration.H_d);
this.SL||u.ULS.sendTraceTag(512291720,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+this.configuration.H_d} not found`);ec=String.format(Kb.FPj,this.baseName+this.configuration.Vfg,this.baseName+Kb.BPb);X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?this.htmlSanitizationHelper.ni(this.SL,ec):this.SL.innerHTML=ec;this.n7d=document.getElementById(this.baseName+Kb.BPb);
this.kAe||u.ULS.sendTraceTag(512291719,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Kb.BPb} not found`);(this.arb=document.getElementById(this.baseName+Kb.BPb))||u.ULS.sendTraceTag(512291718,0,15,`TaskPaneControl.TaskPaneControl: Element id=${this.baseName+Kb.BPb} not found`);this.yug=this.nJe(this.configuration.yFe,this.vFe);this.xug=this.FIe(this.configuration.wFe,Q.a.instance.ga(1293),this.o7h,this.y1a,!0);this.uwg=this.nJe(this.configuration.BXe,this.wEh);this.twg=this.FIe(this.configuration.zXe,
Q.a.instance.ga(1292),this.p7h,this.qKa,!1);W.DOMElementExtensions.setVisible(this.qKa,!1);z.a.instance.sa(A.a.click,this.x1a,Object(V.a)(this,this.Ipc,"onCollapseIconClicked"));z.a.instance.sa(A.a.click,this.pKa,Object(V.a)(this,this.Zpc,"onExpandIconClicked"));z.a.instance.sa(A.a.click,this.y1a,Object(V.a)(this,this.Ipc,"onCollapseIconClicked"));z.a.instance.sa(A.a.click,this.qKa,Object(V.a)(this,this.Zpc,"onExpandIconClicked"));y.KeyInputManager.instance.sa(A.a.Pb,this.x1a,Object(V.a)(this,this.TBf,
"onCollapseIconKeyDown"));y.KeyInputManager.instance.sa(A.a.Pb,this.pKa,Object(V.a)(this,this.xDf,"onExpandIconKeyDown"))}RE(ec){this.addHandler(Kb.zhb,ec);ec(this,new wb(this.isVisible,W.DOMElementExtensions.isVisible(this.SL)))}lG(ec){this.removeHandler(Kb.zhb,ec)}get SL(){return this.dFg}get mc(){return this.SL}get Hf(){return this.tWa}set Hf(ec){this.tWa=ec}get lA(){return this.cFg}get he(){return Y.a.vLi}get iP(){return this.Pme}get ZB(){return this.mu}get ph(){return this.De}get dN(){return null}get hha(){return null}get isCollapsed(){return this.vJ}get i8c(){return this.$8d}get $(){return this.jb}set $(ec){this.jb=
ec}get kAe(){return this.n7d}get x1a(){return this.xug}get pKa(){return this.twg}get y1a(){return this.yug}get qKa(){return this.uwg}get cpi(){return this.fOc}get p7h(){return this.configuration.xFe}get o7h(){return this.configuration.AXe}ctb(ec,sc,Dc,Ud,Ed){let $d=ec.Aa(sc);$d||($d=Yb.a(Jb.a,Dc,ec,sc),$d.SetScriptLoadFlavor(Ed));Ud&&$d.XXc(Ud);const ve=""+sc;ve in this.Dac||$d.e1b((md,$b)=>{this.Q6($b)});let ze=null;const We=()=>{$d.create();ze()};this.Dac[ve]=ze=()=>{$d.Bvc(We);delete this.Dac[ve]};
$d.H0b(We)}dispose(){if(this.mu)for(let sc=0,Dc=this.mu.length;sc<Dc;sc++)this.mu[sc].xWf(this.rDd),this.mu[sc].dispose();const ec=this.Dac;for(let sc in ec)({key:sc,value:ec[sc]}).value();this.$.ea&&this.$.Cb&&this.$.Cb.Dg(this.H6);this.arb=this.n7d=this.Pme=this.De=this.brb=this.Vfb=this.mu=null;z.a.instance.Ba(A.a.click,this.x1a,Object(V.a)(this,this.Ipc,"onCollapseIconClicked"));z.a.instance.Ba(A.a.click,this.pKa,Object(V.a)(this,this.Zpc,"onExpandIconClicked"));z.a.instance.Ba(A.a.click,this.y1a,
Object(V.a)(this,this.Ipc,"onCollapseIconClicked"));z.a.instance.Ba(A.a.click,this.qKa,Object(V.a)(this,this.Zpc,"onExpandIconClicked"));y.KeyInputManager.instance.Ba(A.a.Pb,this.x1a,Object(V.a)(this,this.TBf,"onCollapseIconKeyDown"));y.KeyInputManager.instance.Ba(A.a.Pb,this.pKa,Object(V.a)(this,this.xDf,"onExpandIconKeyDown"));super.dispose()}kg(ec,sc){if(sc)return!1;this.De&&!this.isCollapsed?(ec=this.ph.taskPane,ec.Hf&&ec.kg(!0,!1)||W.DOMElementExtensions.setFocus(this.ph.J0a)):W.DOMElementExtensions.setFocus(this.pKa);
return!0}nh(ec){return this.isVisible?W.DOMElementExtensions.Af(this.domElement,ec)||W.DOMElementExtensions.Af(this.domElement,W.DOMElementExtensions.Axb(ec)):!1}qj(){}dk(){this.De&&this.De.taskPane.dk()}setFocusOnToolbarFirstElement(){this.isCollapsed?W.DOMElementExtensions.setFocus(this.pKa):W.DOMElementExtensions.setFocus(this.x1a)}RSd(){for(let ec=this.mu.length-1;0<=ec;ec--)if(this.mu[ec].isVisible){W.DOMElementExtensions.setFocus(this.mu[ec].J0a);return}this.setFocusOnToolbarFirstElement()}oyb(ec){const sc=
[];for(let Dc=this.mu.length-1;0<=Dc;Dc--)this.mu[Dc].taskPane.kh===ec&&sc.push(this.mu[Dc].taskPane);return sc}rgd(ec){const sc=[];for(let Dc=0;Dc<this.mu.length;Dc++)this.mu[Dc].taskPane.kh===ec&&sc.push(this.mu[Dc]);return sc}qre(ec){if(ec){let sc;const Dc=Object(l.a)(276,ec);Dc?(sc=new hb(this.htmlSanitizationHelper),sc.domElement.id=this.baseName+"bt_"+ec.kh.toString()+"_"+ec.pf.InstanceId,this.arb.appendChild(sc.domElement),this.brb["6"]=sc,Dc.button=sc):sc=this.brb[ec.kh.toString()];sc.Mhi(ec);
sc.cMg(this.rDd);sc.isVisible=ec.pq();sc.enabled=ec.Fs();this.Vfb.push(ec);this.mu.push(sc);Kb.IIi(ec,this.iP);this.dth(sc);this.xEc()}}oG(ec,sc){let Dc;for(const Ud of this.mu)Dc=Ud.taskPane,Dc.kh===ec.kh&&Dc==ec&&this.u4b(Ud,sc)}Eva(){u.ULS.shipAssertTag(512291714,11,!1,"TaskPaneControl.GenerateTaskPaneData: should only be used with WAC infra.");return null}a7(){u.ULS.shipAssertTag(512291713,11,!1,"TaskPaneControl.ShowTaskPane: should only be used with WAC infra.")}c7b(){u.ULS.shipAssertTag(512291712,
11,!1,"TaskPaneControl.createTaskPaneInHidden: should only be used with WAC infra.")}updateTaskPane(){u.ULS.shipAssertTag(512291683,11,!1,"TaskPaneControl.UpdateTaskPane: should only be used with WAC infra.")}setSelectedTaskPane(){u.ULS.shipAssertTag(512291682,11,!1,"TaskPaneControl.SetSelectedTaskPane: should only be used with WAC infra.")}hideTaskPane(){u.ULS.shipAssertTag(512291681,11,!1,"TaskPaneControl.HideTaskPane: should only be used with WAC infra.")}n$f(ec,sc){ec?(this.fOc=!0,this.ITd(!1)):
(this.fOc=!1,this.ITd(!0),sc&&(this.nA(),this.$.af()))}IN(ec){if(!this.Vfb.includes(ec)){let Dc=null;Dc=()=>{this.thj(ec);ec.hS(Dc)};ec.WP(Dc);this.qre(ec);var sc=Object(l.a)(389,ec);sc&&(sc.RE(this.Uz),this.Uz(sc,Sys.EventArgs.Empty));if(sc=Object(l.a)(165,ec))sc.RE(this.Uz),this.Uz(sc,Sys.EventArgs.Empty);if(sc=Object(l.a)(390,ec))sc.RE(this.Uz),this.Uz(sc,Sys.EventArgs.Empty);this.raiseEvent(Kb.uMf,null,ec);this.nA()}}u4b(ec,sc){if(ec.taskPane.Fs()&&ec.taskPane.pq()){if(this.De){this.De.domElement.classList.remove(Kb.eob);
this.De.taskPane.isVisible=!1;if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Dc=Object(l.a)(276,this.De.taskPane);Dc&&Dc.vj.RMd(Dc.pf.InstanceId)}this.g6=this.De}this.De=ec;this.De.taskPane.isVisible=!0;this.De.domElement.classList.add(Kb.eob);sc&&this.pja(!1,!1);this.hhb()}}onButtonClick(ec){let sc=!1;if(this.De!==ec){sc=!0;const Dc=ec.taskPane.mc;this.animationManager.b7i(Dc);if(this.De){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4961099_RangePickerOnOSF")){const Ud=
Object(l.a)(276,this.De.taskPane);Ud&&Ud.vj.RMd(Ud.pf.InstanceId)}this.De.taskPane.isVisible=!1;this.De.domElement.classList.remove(Kb.eob)}this.g6=this.De;this.De=ec;this.De.domElement.classList.add(Kb.eob);this.De.taskPane.isVisible=!0;this.hhb();this.animationManager.nEh(Dc)}this.pja(!(this.isCollapsed||sc),!1)}hhb(){const ec=this.i8c;let sc=0;this.De&&(sc=this.De.taskPane.yq?this.De.taskPane.yq:this.De.taskPane.Lp);sc!==ec&&(this.$8d=sc,this.isCollapsed||(this.animationManager&&this.De?this.animationManager.L1b(this.lA,
ec,sc,this.ph.taskPane):this.lA.style.width=Aa.HelperMethods.uc(sc)),this.WRa(),this.raiseEvent(Kb.Fag,null,this))}bN(ec){const sc=new hb(this.htmlSanitizationHelper);sc.isVisible=!1;sc.domElement.id=this.baseName+"bt_"+ec.toString();this.arb.appendChild(sc.domElement);this.brb[ec.toString()]=sc}xEc(){if(void 0!==this.mu&&null!==this.mu){void 0===this.De||null===this.De||this.De.taskPane.Fs()||(this.De.domElement.classList.remove(Kb.eob),this.De.taskPane.isVisible=!1,this.De.taskPane.pq()&&(this.g6=
this.De),this.De=null);var ec=null;for(let sc=0;sc<this.mu.length;sc++)if(this.Vfb[sc].pq()){const Dc=this.Vfb[sc].Fs();(this.mu[sc].enabled=Dc)&&!ec&&(ec=this.mu[sc])}void 0!==this.De&&null!==this.De||!ec||(void 0!==this.g6&&null!==this.g6&&this.g6.taskPane.Fs()&&this.g6.taskPane.pq()?this.u4b(this.g6,!1):this.u4b(ec,!1));void 0!==va.a(this.$)&&null!==va.a(this.$)&&va.a(this.$).isVisible&&void 0!==this.De&&null!==this.De&&1!==this.De.taskPane.kh&&(va.a(this.$).isVisible=!1);void 0!==this.De&&null!==
this.De&&7!==this.De.taskPane.kh&&(ec=this.$.da.Aa(52),null===ec||void 0===ec?0:ec.isVisible)&&(ec.isVisible=!1);void 0!==this.De&&null!==this.De&&8!==this.De.taskPane.kh&&(ec=this.$.da.Aa(233))&&(ec.isVisible=!1);void 0!==this.De&&null!==this.De&&9!==this.De.taskPane.kh&&(ec=this.$.da.Aa(248))&&(ec.isVisible=!1);X.EwaSettings.oa(279)&&void 0!==this.De&&null!==this.De&&12!==this.De.taskPane.kh&&(ec=this.$.da.Aa(302))&&(ec.isVisible=!1);X.EwaSettings.oa(449)&&void 0!==this.De&&null!==this.De&&15!==
this.De.taskPane.kh&&(ec=this.$.da.Aa(365))&&(ec.isVisible=!1);K.a.ivd(this.$)&&void 0!==this.De&&null!==this.De&&13!==this.De.taskPane.kh&&(ec=this.$.da.Aa(334))&&(ec.isVisible=!1);void 0!==this.De&&null!==this.De&&14!==this.De.taskPane.kh&&(ec=this.$.da.Aa(346))&&(ec.isVisible=!1);void 0!==this.De&&null!==this.De&&16!==this.De.taskPane.kh&&(ec=this.$.da.Aa(371))&&(ec.isVisible=!1);X.EwaSettings.ckc()&&void 0!==this.De&&null!==this.De&&17!==this.De.taskPane.kh&&(ec=this.$.da.Aa(408))&&(ec.isVisible=
!1);X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&void 0!==this.De&&null!==this.De&&18!==this.De.taskPane.kh&&(ec=this.$.da.Aa(415))&&(ec.isVisible=!1);this.hhb()}}PGh(ec,sc){W.DOMElementExtensions.setVisible(this.y1a,!ec);W.DOMElementExtensions.setVisible(this.qKa,ec);ec&&this.raiseEvent(Kb.AFe,null,this);this.hhb();sc&&W.DOMElementExtensions.setFocus(ec?this.pKa:this.x1a)}ufc(ec,sc){this.$.Xc(ec,sc,26,null)}Q6(ec){ec.VO&&this.IN(ec.VO)}thj(ec){if(ec){const sc=
this.mu.length;let Dc=!1;for(let Ud=0;Ud<sc;Ud++){const Ed=this.mu[Ud];if(Ed.taskPane===ec){this.arb.removeChild(Ed.J0a);delete this.brb[ec.kh.toString()];Array.remove(this.Vfb,ec);Array.remove(this.mu,Ed);Ed.xWf(this.rDd);Ed.taskPane.mc.parentNode.removeChild(Ed.taskPane.mc);this.De&&this.De.taskPane===Ed.taskPane&&(this.De=null);this.g6&&this.g6.taskPane===Ed.taskPane&&(this.g6=null);Dc=!0;break}}Dc&&this.xEc()}}dth(ec){const sc=ec.taskPane.kh,Dc=!!this.De&&1===this.De.taskPane.kh;(1===sc||!Dc&&
2===sc)&&this.u4b(ec,!1)}static IIi(ec,sc){const Dc=ec.mc;Dc.parentNode&&Dc.parentNode.removeChild(Dc);sc.appendChild(Dc);ec.isVisible=!1}FIe(ec,sc,Dc,Ud,Ed){const $d=document.createElement("a");$d.setAttribute(G.a.hU,Ed?G.a.Ak:G.a.vr);$d.setAttribute(G.a.Ad,G.a.rt);$d.tabIndex=0;$d.classList.add(da.a.fs);$d.classList.add(ec);$d.classList.add(C.a.Bxh);ec=String.format(Kb.l4g,sc,Dc,d.a.de(10));X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?
this.htmlSanitizationHelper.ni($d,ec):$d.innerHTML=ec;Ud.appendChild($d);return $d}}Kb.zhb="tpVisibility";Kb.FPj=`<div id='{0}' class='${C.a.Hxh}'><div id='{1}' class='${C.a.Gxh}'></div></div>`;Kb.l4g="<img title='{0}' class='{1}' alt='{0}' src='{2}'/>";Kb.BPb="novTaskpaneButtonGroup";Kb.eob=C.a.Dxh;Kb.Fag="tpSizeChanged";Kb.AFe="tpCollapsed";Kb.uMf="tpAdded";Object(c.a)(Kb,"TaskPaneControl",H.a,[278,66,3]);var dc=a(50),sb=a(370),bb=a(709);class Ob{constructor(){this.AXe=this.xFe=this.zXe=this.wFe=
this.BXe=this.yFe=this.Vfg=this.H_d=this.AZd=this.q1=this.keg=null}}Object(c.a)(Ob,"Configuration",null,[]);a(433);var gc=a(297);class mb extends gc.a{constructor(ec){super(5,ec)}}Object(c.a)(mb,"ResizeAnimationEvent",gc.a,[]);var Nb=a(475),ic=a(586),gb=a(101);class Eb{constructor(ec,sc){this.leg=null;this.$=sc;this.taskPane=ec}fEh(){this.leg=W.DOMElementExtensions.getElementById(this.taskPane.parentNode,this.$.Eb+G.a.xCd);const ec=Eb.H7c(this.taskPane),sc=Eb.H7c(this.leg),Dc=ic.a(gb.a.Ul);Dc.animate(ec,
G.a.Pzc);Dc.animate(sc,G.a.Pzc)}b7i(ec){ec.style.opacity="0"}nEh(ec){ic.a(gb.a.Ul).animate(Eb.H7c(ec),G.a.Pzc)}L1b(ec,sc,Dc,Ud){sc||(Ud.isVisible=!0);this.$.WRa(Dc);ic.a(gb.a.Ul).animate(Eb.zgh(ec,sc,Dc),G.a.Pzc,null,null,()=>{this.$.NAa();Dc||1===Ud.kh||(Ud.isVisible=!1);Ud.VR(Dc<sc)})}static zgh(ec,sc,Dc){ec=new mb(ec);ec.vRg(sc,Dc);return ec}static H7c(ec){ec=new Nb.a(ec);ec.MJ(0,1);return ec}}Object(c.a)(Eb,"TaskPaneAnimationManager",null,[310]);const Lc=`<div id="{0}" class="${C.a.Lxh}" runat="server"></div></div><div id="{1}" class="${C.a.Kxh} ${C.a.Do}" runat="server"></div>`,
Ec=`<button type="button" id="{0}" class="${C.a.Ixh}"></button><span><div id="{1}" class="${C.a.Jxh}"></div></span>`,Cb=C.a.vxh;class eb extends Kb{constructor(ec,sc,Dc,Ud){super(ec,Dc,eb.och(),Ud);this.nsc=null;this.Eud=!1;this.IS=null;this.zWi=Ed=>{var $d=!1;if(9===Ed.Ca.keyCode){$d=this.ph.taskPane.bR(Ed,this.SL);if(!$d){$d=this.$.da.Aa(52);var ve=this.domElement.querySelectorAll(this.ph.taskPane===$d?$d.Fr:sb.a.l2i);$d=W.DOMElementExtensions.um(ve);ve=W.DOMElementExtensions.mB(ve);$d=W.DOMElementExtensions.nBa(Ed.Ca,
$d,ve)}return $d}ve=Da.FocusManager.instance().hi;if(null===ve||void 0===ve?0:ve.WN)return $d;27===Ed.Ca.keyCode&&this.ph.taskPane.wg(!1);return $d};this.$c=()=>{this.SL.style.bottom=this.lA.style.bottom=this.$.qd&4&&!D.AFrameworkApplication.ta.Pa.Pe?Aa.HelperMethods.uc(this.$.Gea):"0";this.nA()};this.kIf=Ed=>{Object(Ta.a)(276,this.ph.taskPane)&&(this.ph.taskPane.eHa.firstChild.style[G.a.pointerEvents]="none");this.Eud=!0;this.IS=this.Kxb(Ed.clientPoint);Fa.a.instance.sa(A.a.$f,this.domElement.ownerDocument.body,
this.erc);Fa.a.instance.sa(A.a.we,this.domElement.ownerDocument.body,this.frc);nb.a.instance.sa(A.a.Mj,this.domElement.ownerDocument.body,this.erc);nb.a.instance.sa(A.a.Rf,this.domElement.ownerDocument.body,this.frc);return!0};this.frc=()=>{Object(Ta.a)(276,this.ph.taskPane)&&(this.ph.taskPane.eHa.firstChild.style[G.a.pointerEvents]="");this.Eud=!1;Fa.a.instance.Ba(A.a.$f,this.domElement.ownerDocument.body,this.erc);Fa.a.instance.Ba(A.a.we,this.domElement.ownerDocument.body,this.frc);nb.a.instance.Ba(A.a.Mj,
this.domElement.ownerDocument.body,this.erc);nb.a.instance.Ba(A.a.Rf,this.domElement.ownerDocument.body,this.frc);return!0};this.erc=Ed=>{this.Eud&&(Ed=this.Kxb(Ed.clientPoint),Ed=bb.a.iE(Ed,this.IS),this.Jue(Ed.x));return!0};this.yXi=Ed=>{void 0!==Ed.Ca&&null!==Ed.Ca&&(9===Ed.Ca.keyCode?Ed.Ca.shiftKey?(Ed=Object(Ta.a)(66,this.ph.taskPane)?this.ph.taskPane:null)&&Ed.kg(!1,!1):this.setFocusOnToolbarFirstElement():37!==Ed.Ca.keyCode&&39!==Ed.Ca.keyCode||this.Jue(37===Ed.Ca.keyCode?-20:20));return!0};
this.$.domElement.classList.add(Cb);this.ieg=sc;this.initialize();y.KeyInputManager.instance.sa(A.a.Pb,this.domElement,this.zWi);this.DPb=W.DOMElementExtensions.getElementById(sc.parentNode,this.$.Eb+G.a.Qoc);this.JCc=W.DOMElementExtensions.getElementById(sc.parentNode,this.$.Eb+G.a.dzf);this.DPb.title=Q.a.instance.ga(2227);Fa.a.instance.sa(A.a.uf,this.JCc,this.kIf);nb.a.instance.sa(A.a.pointerDown,this.JCc,this.kIf);y.KeyInputManager.instance.sa(A.a.Pb,this.DPb,this.yXi)}get he(){return Y.a.ECc}get vFe(){return this.SL}get wEh(){return this.vFe}hhb(){super.hhb();
this.DPb&&(this.ph&&this.ph.taskPane.isResizable?(this.DPb.style.display="block",this.JCc.style.display="block"):(this.DPb.style.display="none",this.JCc.style.display="none"))}get tDc(){const ec=this.SL;return ec&&W.DOMElementExtensions.isVisible(ec)?sb.a.tDc:0}iZf(ec){ec&&(this.animationManager=ec);this.Hmj();this.animationManager=ec||new Eb(this.lA,this.$);this.animationManager.fEh()}dispose(){this.nsc&&this.nsc.lG(this.Uz);va.a(this.$)&&va.a(this.$).lG(this.Uz);const ec=this.$.da.Aa(52);ec&&ec.lG(this.Uz);
this.$.ul(this.$c);h.a.rc([this.nsc]);this.nsc=null;super.dispose()}initialize(){this.iZf(null);this.bN(0);this.bN(1);this.bN(2);this.bN(7);this.bN(8);this.bN(9);this.bN(10);X.EwaSettings.oa(279)&&this.bN(12);X.EwaSettings.oa(449)&&this.bN(15);X.EwaSettings.isChangeGateEnabled("OfficeVSO:4458651_ExternalLinksEnableDisableRibbonButtonDuringSession")?this.bN(13):K.a.ivd(this.$)&&this.bN(13);this.bN(14);this.bN(16);X.EwaSettings.ckc()&&this.bN(17);X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",
!1)&&this.bN(18);this.nA()}nA(){var ec=0;let sc=0;for(let Dc=this.ZB.length-1;0<=Dc;Dc--){const Ud=this.ZB[Dc].taskPane.pq(),Ed=this.ZB[Dc].taskPane;if(this.ZB[Dc].isVisible=Ud)sc++,(1!==Ed.kh&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4465901_HideCommentsTaskPaneButtonOnClosePane")||7!==Ed.kh)&&14!==Ed.kh&&16!==Ed.kh||Ed.Fs())&&ec++}ec=0<ec;W.DOMElementExtensions.setVisible(this.SL,ec);this.ITd(ec);W.DOMElementExtensions.setVisible(this.qKa,ec&&this.isCollapsed);W.DOMElementExtensions.setVisible(this.y1a,
ec&&!this.isCollapsed);W.DOMElementExtensions.setVisible(this.kAe,1<sc);this.xEc()}pja(ec,sc){if(this.isCollapsed!==ec){ec||(this.ieg.style.display=D.AFrameworkApplication.ta.Pa.Pe?"flex":"block");var Dc=this.i8c;this.vJ=!this.isCollapsed;var Ud=ec?Dc:0;Dc=ec?0:Dc;this.ph&&(this.animationManager.L1b(this.lA,Ud,Dc,this.ph.taskPane),this.WRa());ec&&(this.ieg.style.display="none");this.PGh(ec,sc)}}ITd(ec){const sc=this.isVisible!==ec;this.Hf=ec;W.DOMElementExtensions.setVisible(this.domElement,ec);sc&&
(D.AFrameworkApplication.ta.Pa.Pe&&W.DOMElementExtensions.toggleCssClass(this.domElement,C.a.kxh,ec),this.WRa(),this.raiseEvent(Kb.zhb,new wb(ec,ec),this))}Ipc(ec){if(ec.Gb===this.y1a&&3!==ec.tb)return!1;this.ufc(296943390,ec.tb);this.pja(!0,!0);return!0}Zpc(ec){if(ec.Gb===this.qKa&&3!==ec.tb)return!1;this.ufc(-625072140,ec.tb);this.pja(!1,!0);return!0}TBf(ec){return 13===ec.Ca.keyCode?(this.ufc(296943390,ec.tb),this.pja(!0,!0),!0):!1}xDf(ec){return 13===ec.Ca.keyCode?(this.ufc(-625072140,ec.tb),
this.pja(!1,!0),!0):!1}WRa(){let ec=0;this.$.qd&262144&&(ec+=this.tDc,W.DOMElementExtensions.isVisible(this.lA)&&!this.isCollapsed&&(ec+=this.i8c));this.$.WRa(ec)}nJe(ec,sc){const Dc=document.createElement("div");Dc.classList.add(ec);sc.insertBefore(Dc,sc.firstChild);return Dc}Hmj(){const ec=this.domElement;let sc=document.getElementById(this.$.Eb+G.a.q1a);D.AFrameworkApplication.ta.Pa.Pe&&(sc=document.getElementById("FarPaneRegion"));ec.parentNode&&ec.parentNode!==sc&&ec.parentNode.removeChild(ec);
sc.appendChild(ec);this.M$h()}M$h(){const ec=this.lA,sc=this.SL,Dc=this.$.ea;ec.style.right="0";D.AFrameworkApplication.ta.Pa.Pe||(ec.style.marginRight=Aa.HelperMethods.uc(sb.a.tDc));ec.style.bottom=this.$.qd&4&&!D.AFrameworkApplication.ta.Pa.Pe?Aa.HelperMethods.uc(this.$.Gea):"0";this.iP.style.bottom="0";sc.style.right="0";this.$.$k(this.$c);Dc.gI&&this.$c(null,null)}Kxb(ec){const sc=new dc.a(0,0);return bb.a.Xs(sc,this.lA,ec,!1)}Jue(ec){const sc=this.lA.offsetWidth;ec=sc-ec;ec<this.ph.taskPane.Lp?
ec=this.ph.taskPane.Lp:950<ec&&(ec=950);this.ph.taskPane.yq=ec;const Dc=new Eb(this.lA,this.$);Dc.L1b(this.lA,sc,ec,this.ph.taskPane);Object(Ta.a)(276,this.ph.taskPane)||Dc.L1b(this.ph.taskPane.mc,sc,ec,this.ph.taskPane);this.$.WRa(this.SL.offsetWidth+ec);this.$.jAa(qb.a.h_("AnimateTaskpaneResize"))}static la(ec,sc){let Dc=null;ec.Kb&&(Dc=ec.Kb.Qg("ComponentAttach","AttachTaskPanePickerControl"),Dc.start());const Ud=eb.JZg(ec.Eb),Ed=eb.IZg(ec.Eb,sc),$d=eb.KZg(ec.Eb);Ud.appendChild($d);Ud.appendChild(Ed);
eb.rUg(ec,Ud);ec=new eb(Ud,Ed,ec,sc);Dc&&Dc.stop();return ec}static JZg(ec){const sc=document.createElement("div");sc.id=ec+G.a.FCc;return sc}static IZg(ec,sc){const Dc=document.createElement("div");Dc.id=ec+G.a.czf;Dc.className=C.a.wxh;let Ud=String.format(Lc,ec+G.a.tLi,ec+G.a.IR);Ud+=String.format(Ec,ec+G.a.Qoc,ec+G.a.dzf);X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")?sc.ni(Dc,Ud):
Dc.innerHTML=Ud;D.AFrameworkApplication.ta.Pa.Pe&&W.DOMElementExtensions.toggleCssClass(Dc,C.a.wAa,!0);return Dc}static KZg(ec){const sc=document.createElement("div");sc.id=ec+G.a.xCd;sc.className=C.a.szh;sc.style.zIndex="100";D.AFrameworkApplication.ta.Pa.Pe&&W.DOMElementExtensions.toggleCssClass(sc,C.a.wAa,!0);return sc}static rUg(ec,sc){(D.AFrameworkApplication.ta.Pa.Pe?document.getElementById("FarPaneRegion"):document.getElementById(ec.Eb+G.a.q1a)).appendChild(sc)}static och(){const ec=new Ob;
ec.keg=G.a.FCc;ec.q1=G.a.czf;ec.AZd=G.a.IR;ec.H_d=G.a.xCd;ec.Vfg=G.a.uLi;ec.yFe=C.a.yxh;ec.BXe=C.a.Axh;ec.wFe=C.a.xxh;ec.zXe=C.a.zxh;ec.xFe=C.a.fWe;ec.AXe=C.a.gWe;return ec}}Object(c.a)(eb,"TaskPanePickerControl",Kb,[]);var Sb=a(698);class ld extends w.a{constructor(ec){super();this.$=ec;this.Fb()}create(){if(K.a.gd(this.$))this.NLd(()=>vb.la(this.$));else if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:7153231_ReduceInnerHTMLUsageTaskPane")){const ec=
Wa.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya);x.TaskExtensions.za(ec,()=>{this.NLd(()=>eb.la(this.$,ec.result))},this.ka,3)}else this.NLd(()=>eb.la(this.$,null))}static la(ec){ec.da.Ga(50,new ld(ec))}NLd(ec){X.EwaSettings.isChangeGateEnabled("OfficeVSO:7377510_InitializingTPSlicePI")?(ec=Object(Sb.a)(this.$.da,183,ec),this.ob(ec)):this.ob(ec())}}Object(c.a)(ld,"TaskPaneManagerFactory",w.a,[]);class bd extends e.a{constructor(ec){super(ec);this.St=()=>{this.$.ea.fS(this.St);this.wKe()};this.$=
ec}wKe(){const ec=this.$.da;ec.Ga(72,new Qb(this.$));ec.Ga(77,new ca(this.$));ld.la(this.$);ya.la(this.$)}static main(){f.a.Fa(ec=>{b.a.Tef(ec.domElement.ownerDocument,d.a.current.io(97),()=>{ec.GI()});const sc=new bd(ec);ec.ea.Iv?sc.wKe():ec.ea.aU(sc.St)})}}Object(c.a)(bd,"TaskPaneSliceBootstrapper",e.a,[]);Type.registerNamespace("_Ewa");bd.main();Type.registerNamespace("CommandUI.TaskPane")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.tp.js.map/87b3f3c3e852a621fe220740a83eb466/EwaDSEsNext.tp.js.map