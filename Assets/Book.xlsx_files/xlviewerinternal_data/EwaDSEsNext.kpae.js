'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1080:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1081:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{constructor(b,e){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=e}vs(){return this.command}}Object(t.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[145])},1082:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1083:function(t,E,a){a.d(E,"a",function(){return"FieldInfoListContextLoaded"});a.d(E,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(E,"d",function(){return"Days from Today"});a.d(E,"g",function(){return"Years from Today"});a.d(E,"c",function(){return"Day of the Week"});a.d(E,"f",function(){return"Month of the Year"});a.d(E,"e",function(){return"End of Month"});a.d(E,"b",function(){return"Next Day"})},1084:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>
{c.a.Ni(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1085:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}.DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1086:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);var c;(function(b){b[b.anyValue=0]="anyValue";b[b.wholeNumber=1]="wholeNumber";b[b.decimal=2]="decimal";b[b.list=3]="list";b[b.date=4]="date";b[b.time=5]="time";b[b.textLength=6]="textLength";b[b.custom=7]="custom"})(c||(c={}));Object(t.b)("DataValidationRuleType",c)},1088:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni(".ewa-facp-text-box{position:absolute}")}},1089:function(t,E,a){a.d(E,"b",function(){return"MinorThemeFont"});
a.d(E,"a",function(){return"MajorThemeFont"})},1091:function(t,E,a){a.d(E,"a",function(){return b});var c=a(513);const b=()=>{c.a.Ni('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1092:function(t,E,a){a.d(E,"a",function(){return m});t=a(0);E=a(238);var c=a(5),b=a(33),e=a(11),f=a(21),d=a(34),h=a(4);class m extends E.a{constructor(l){super(document.createElement("div"));this.zR=this.zJa=this.yJa=this.AJa=this.CJa=this.BJa=!1;this.oJ=null;this.visible=void 0;this.iqc=(w,n)=>{this.Tt(w,n)};this.OMa=()=>{this.eb.textBox.HF=!0};this.yza=()=>{this.mz(!0)};this.QAf=()=>{this.eb.textBox.focus()};this.Sh=()=>{f.h(this.$).inRangePicker||(this.te=!1)};this.$=l;f.h(l)&&f.h(l).ha&&f.h(this.$).ha.fH(this.Sh);
this.Mk=b.a.q5(l)}get rI(){return this.qu.rI}get te(){return this.qu.te}set te(l){this.qu.te=l}get eb(){return this.oJ}set eb(l){(this.oJ=l)&&this.oJ.L3d.add(this)}get nKh(){return b.a.ON(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(l){if(this.visible===l)return l;this.visible=l;return super.set_visible(l)}Tt(){this.DCa(!1);this.qu.Tt()}dispose(){this.$&&f.h(this.$)&&f.h(this.$).ha&&f.h(this.$).ha.tL(this.Sh);this.$=null;super.dispose()}Yh(l,
w,n=!1){l=!1;if((this.p2a||n)&&!this.Exa()&&this.get_visible()&&this.te)switch(this.Mk&&this.wEc(w),w){case 1872288872:this.te=!1;l=!0;break;case -798660877:this.qu.BB(1);l=!0;break;case 137938150:this.qu.BB(-1);l=!0;break;case 2091832999:this.qu.BB(this.rI-1);l=!0;break;case 742457698:this.qu.BB(-(this.rI-1));l=!0;break;case 125627505:l=this.mz(!1);break;case 267796030:b.a.q5(this.$)&&(l=this.mz(!1))}return l}DCa(l){if(this.te||l){var w=f.h(this.$);l=w.domElement;var n=this.oJ.textBox.domElement,
x=d.a(this.$).zi(n.offsetHeight),r=d.a(this.$).zi(n.offsetTop),u=d.a(this.$).zi(n.offsetWidth);n=d.a(this.$).zi(n.offsetLeft);w=w.Vl;var v=h.AFrameworkApplication.ta&&h.AFrameworkApplication.ta.Pa.Pe,B=$get(this.$.Eb+c.a.q1a,this.$.domElement);v&&(B=document.getElementById("EditorContainer"));var z=new Sys.UI.Point(w?this.qu.Qbc:0,w?this.nKh:m.X7h);x=B.offsetTop+z.y+(b.a.ON(this.$)&&w?0:x+r);this.$.F_||(r=$get(c.a.Isa,this.$.domElement),x+=r&&!v?r.offsetHeight:0);r=this.domElement;r.style.top=e.HelperMethods.uc(x);
n=B.offsetLeft+n+z.x;!b.a.ON(this.$)&&this.$.isChromeRtl?r.style.right=e.HelperMethods.uc(w?this.qu.Qbc:l.offsetLeft+l.offsetWidth-n-u):r.style.left=e.HelperMethods.uc(n)}}sUa(l){this.qu&&(l&&!this.zR?(this.qu.f$(this.QAf),this.qu.M0b(this.OMa),this.qu.dpb(this.yza),this.zR=!0):this.zR&&(this.qu.Wda(this.QAf),this.qu.Hvc(this.OMa),this.qu.KKb(this.yza),this.zR=!1))}wEc(l){switch(l){case -798660877:case 137938150:case 2091832999:case 742457698:this.BJa=!0;break;case 125627505:this.AJa=!0;break;case 267796030:b.a.q5(this.$)&&
(this.yJa=!0)}}}m.Qbc=0;m.X7h=1;Object(t.a)(m,"AutoCompleteControl",E.a,[632])},1093:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c extends Sys.EventArgs{constructor(b,e=0,f="",d=""){super();this.length=b;this.selectedIndex=e;this.rG=f;this.description=d}}Object(t.a)(c,"ListEventArgs",Sys.EventArgs,[])},1094:function(t,E,a){a.d(E,"a",function(){return r});t=a(0);var c=a(15),b=a(27);E=a(840);var e=a(778),f=a(5),d=a(76),h=a(33),m=a(12),l=a(1),w=a(117),n=a(21),x=a(913);class r extends E.a{constructor(u,
v){super(u,v,new x.a(e.a.listItem,e.a.PDb,e.a.SDb,e.a.TDb));this.ifc=!1;this.Zmb=this.xp=null;this.S_e=!1;this.visible=void 0;this.RBa(!0);this.S_e=l.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get Qbc(){if(h.a.ON(this.$)){var u=document.getElementById(this.$.Eb+f.a.R_e);return!this.S_e||u?m.DOMElementExtensions.getBoundingClientRect(u).x:0}u=l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.dBd):document.getElementById(this.$.Eb+
f.a.dBd+"-"+f.a.Lxf);c.ULS.shipAssertTag(537170323,0,!!u||this.$.MK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return u?u.offsetWidth:0}get ie(){return this.Zmb}set ie(u){this.Zmb=u}get te(){return void 0!==this.visible?this.visible&&0<this.xp.length:(this.visible=m.DOMElementExtensions.isVisible(this.Lf))&&0<this.xp.length}set te(u){this.visible!==u&&(m.DOMElementExtensions.setVisible(this.Lf,u),m.DOMElementExtensions.setVisible(this.UUa,u),this.visible=
u);const v=n.h(this.$).view;u?this.ifc||(v.qt(this.wHa.iqc),this.ifc=!0):(this.xp.length=0,this.ifc&&(v.fr(this.wHa.iqc),this.ifc=!1))}Rya(){var u=460;const v=n.h(this.$);var B=v.domElement,z=this.UUa.style;const A=this.Lf.offsetTop+this.Rj.offsetHeight*this.Rj.sectionRowIndex-this.Lf.scrollTop;z.width="auto";z.whiteSpace="nowrap";z.position="absolute";const y=B.offsetLeft+B.offsetWidth-(this.domElement.offsetLeft+this.Lf.offsetLeft+this.Lf.offsetWidth+3);B=this.domElement.offsetLeft-3-(B.offsetLeft+
this.Qbc);u=Math.min(this.UUa.offsetWidth,u,Math.max(y,B));m.DOMElementExtensions.Zv(this.UUa,u);z.whiteSpace="";z.position="absolute";A+3>this.Lf.offsetTop+this.Lf.offsetHeight||A<this.Lf.offsetTop||(u=this.Lf.offsetLeft-3-this.UUa.offsetWidth,z=this.Lf.offsetLeft+this.Lf.offsetWidth+3,m.DOMElementExtensions.updatePosition(this.UUa,B>y!==v.rtl?u:z,A,!1))}BB(u){super.BB(u);this.Rya()}Tt(){this.Rya()}zsa(){const u=this.Hn,v=this.Lf,B=3===d.a.Db||b.a.Hp,z=B?this.KEb:this.rI;this.te=!0;v.style.height=
"auto";this.wHa.set_visible(!0);this.Iob(u,B);this.xp.length>z&&(m.DOMElementExtensions.gJ(v,Math.floor(v.offsetHeight*z/this.xp.length)),v.style.overflowY="auto");m.DOMElementExtensions.Zv(v,u.offsetWidth+(this.xp.length>z?w.a.Tu:0))}}Object(t.a)(r,"AutoCompleteListBox",E.a,[])},1095:function(t,E,a){a.d(E,"a",function(){return n});t=a(0);var c=a(224),b=a(14),e=a(108),f=a(240);E=a(238);var d=a(735),h=a(5),m=a(52),l=a(12),w=a(71);class n extends E.a{constructor(x,r,u,v,B,z,A,y,D,I){super(document.createElement("a"));
this.ln=!1;this.fd=M=>{this.raiseEvent("ClickButton",M);return!0};this.onKeyDown=M=>{this.raiseEvent("KeyDown",M);return!1};this.Xw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.rO=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=M=>{w.g(M);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=M=>{w.g(M);this.focused=!0;this.raiseEvent("Focus")};this.psh=y;this.Fnh=D;this.uJ=n.pb(this.domElement,r,u,v,B,z,A,I);this.Gc.la("contextmenu",M=>{w.g(M)});this.enable();
this.focused=this.hovered=!1;x.appendChild(this.domElement)}$Xc(x){this.get_events().addHandler("ClickButton",x)}cNd(x){this.get_events().removeHandler("ClickButton",x)}lYc(x){this.get_events().addHandler("KeyDown",x)}oNd(x){this.get_events().removeHandler("KeyDown",x)}$0b(x){this.get_events().addHandler("PointerOver",x)}zNd(x){this.get_events().removeHandler("PointerOver",x)}Z0b(x){this.get_events().addHandler("PointerOut",x)}yNd(x){this.get_events().removeHandler("PointerOut",x)}Pob(x){this.get_events().addHandler("Blur",
x)}vKb(x){this.get_events().removeHandler("Blur",x)}f$(x){this.get_events().addHandler("Focus",x)}Wda(x){this.get_events().removeHandler("Focus",x)}get Il(){return this.uJ}get isEnabled(){return this.ln}enable(){this.domElement&&(this.domElement.classList.remove(d.a.FU),this.domElement.style.cursor="",c.a.instance.sa(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.sa(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.sa(b.a.pointerOver,this.domElement,this.Xw),f.a.instance.sa(b.a.pointerOut,
this.domElement,this.rO),this.Gc.Oi("blur")||this.Gc.la("blur",this.onBlur),this.Gc.Oi("focus")||this.Gc.la("focus",this.onFocus),this.domElement.title=this.psh,this.ln=!0)}disable(){this.domElement&&(this.domElement.classList.add(d.a.FU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.Ba(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Xw),f.a.instance.Ba(b.a.pointerOut,this.domElement,
this.rO)),this.domElement.title=this.Fnh,this.ln=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.fd),e.KeyInputManager.instance.Ba(b.a.Pb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Xw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.rO),this.ln=!1);l.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static pb(x,r,u,v,B,z,A,y){x.removeAttribute("Href");x.setAttribute(h.a.Ad,h.a.rt);x.className=r;x.tabIndex=
y;r=document.createElement("span");r.className=A;r.classList.add(u);r.tabIndex=-1;x.appendChild(r);x=document.createElement("img");x.src=m.a.de(v);x.className=B;x.alt=z;x.tabIndex=-1;r.appendChild(x);return x}}Object(t.a)(n,"ListButton",E.a,[656,3])},1096:function(t,E,a){a.d(E,"a",function(){return d});t=a(0);var c=a(109),b=a(28),e=a(1),f=a(728);class d{constructor(l){this.Uwf=l;this.EW=Object.assign({},m);this.Hub=[];this.Jnc=-1;(this.Twf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&
l&&(this.EW.countAboveThresholds={},l.forEach(w=>this.EW.countAboveThresholds[w]=0))}static get $Zd(){return b.a.Sa.ve.m}jUa(){this.Jnc=d.$Zd}q4(l,w=null){if(-1!==this.Jnc||Object(f.b)(w))l?(this.Fob(d.$Zd-(w||this.Jnc)),this.Jnc=-1):this.EW.failedCount++}QYe(){this.EW.excludingFirstAction=d.PYe(this.Hub);this.Hub.push(this.EW.firstAction);this.EW.includingFirstAction=d.PYe(this.Hub)}Fob(l){this.EW.count?1E3>this.EW.count&&this.Hub.push(l):this.EW.firstAction=l;this.Twf&&this.Uwf&&this.Uwf.forEach(w=>
{l>w&&this.EW.countAboveThresholds[w]++});this.EW.count++}static PYe(l){const w=Object.assign({},h);0<l.length&&(c.i(l),w.median=l[Math.floor(.5*l.length)],w.P75=l[Math.floor(.75*l.length)],w.P95=l[Math.floor(.95*l.length)],w.max=l[l.length-1],w.average=c.g(l,n=>n)/l.length);return w}}Object(t.a)(d,"PerformanceMeasurement",null,[]);const h={average:0,max:0,median:0,P75:0,P95:0},m={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},h),excludingFirstAction:Object.assign({},
h)}},1138:function(t,E,a){function c(Ha){Ha.da.Aa(491)?this.formulaAssistanceTelemetryManager.IJ("lm"):n.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager")}function b(Ha){var Bb=Object(M.h)(Ha),bc=Object(S.a)(Ha);const tc=Bb.Ai;var Zc=Bb.jc.Elf;Zc=Bb.Vl||Zc&&bc;bc=e((Zc?bc:tc).textBox.domElement);if(Zc)Bb={top:0,left:0,right:innerWidth,bottom:innerHeight};else if(Bb=e(Bb.domElement),{zoom:Ha}=Object(H.a)(Ha),1!==Ha)for(const wd of[bc,
Bb])for(const Ld in wd)wd[Ld]*=Ha;return{target:bc,bounds:Bb}}function e(Ha){const {top:Bb,left:bc,right:tc,bottom:Zc}=Ha.getBoundingClientRect();return{top:Bb,left:bc,right:tc,bottom:Zc}}function f(Ha){var Bb;if(Ha){var bc=new rb(0===Ha.kind);Ha=null===(Bb=null===Ha||void 0===Ha?void 0:Ha.rangeInfo)||void 0===Bb?void 0:Bb.positionKindInfo;if(!Ha)return bc;bc.OF=0===Ha.firstRow;bc.NF=0===Ha.firstColumn;bc.HK=0===Ha.secondRow;bc.GK=0===Ha.secondColumn;return bc}}var d=a(9),h=a(0),m=a(695),l=a(48),
w=a(37),n=a(15),x=a(19),r=a(385),u=a(76);class v{}v.Acd="!";v.VLf="[";v.ULf="]";v.openParen="(";v.closeParen=")";v.Vng=" /.(*\\".split("");v.V9b="...";v.XHb="param_help_link";v.QGd="param_help_udf";v.ufd="function_list_box";v.hLh="function_param_box";v.wfd="function_reader_description";v.pfd="function_description_box";v.i0e="function_param_table";v.q2i="param_row_";v.msc="param_set";v.DMf="param_row_0";v.EMf="param_row_1";v.iLh="<div id='{0}' class='{1}'></div>";v.gLh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";
v.FMf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";v.eLh="<div id='{0}' class='{1} {2} {3}'></div>";v.cLh="<div id='{0}' class='{1} {2} {3} {4}'></div>";v.Wqf="[@";v.Nah=1;v.Mah=3;v.Zkh=500;v.pwf=50;Object(h.a)(v,"FormulaAssistanceConstants",null,[]);var B=a(13),z=a(285),A=a(8),y=a(5),D=a(92),I=a(11),M=a(21),T=a(358),S=a(113),H=a(34),C=a(440),G=a(229);const J=(Ha,Bb,
bc)=>{Ha&&(c(Ha),bc?P(Ha,Bb,bc):(bc=new D.a(-859308420,u.a.Db,Ha.Hc,0,null),Ha.Ka.Lb(bc,{[u.a.Kc]:y.a.IV,[u.a.ng]:"HelpID="+Bb})))},L=(Ha,Bb,bc)=>{const tc={};tc[y.a.LQ]=Bb;Bb={};Bb.FunctionName=bc;tc[y.a.fdd]=Bb;Ha.Xc(802602464,0,8,tc)},P=(Ha,Bb,bc)=>{if(bc){if(Bb&&(!Bb||Bb.startsWith("http://")||Bb.startsWith("https://"))){if(Ha.oa(154)&&(Ha=Object(C.a)({aGb:269,new:G.c,registry:Ha.da}))&&Ha.xCa(Bb))return;I.HelperMethods.kf(Bb,"_blank",T.a)}}else I.HelperMethods.vW(Ha.GG,"XLWAEndUser_"+Bb,Ha.WS)},
aa=Ha=>{let Bb=A.a.o0;const bc=Ha.da.Aa(368);bc&&!Object(M.h)(Ha).Vl&&(Bb=bc.zoom);return Bb};var U;(function(Ha){Ha.CategoryList="categoryList";Ha.FunctionsMap="functionsMap";Ha.FunctionIdsToDisplay="functionIdsToDisplay";Ha.RefreshListCallback="refreshListCallback";Ha.HelpCallback="helpCallback";Ha.feedbackCallback="giveFeedbackCallback";Ha.InitialCategory="initialCategory";Ha.AllCategoryName="allFunctionsCategoryName"})(U||(U={}));Object(h.b)("PropsKeys",U);class K extends z.a{constructor(Ha){super(Ha);
this.c0e=(Bb,bc)=>{1===Bb&&(this.hide(),bc=bc.functionName,Bb=0<this.functionInfoManager.w4e(bc).Params.length,bc={[u.a.Kc]:bc,["ibdk"]:!0},Bb=new D.a(Bb?1117706454:-433697611,0,this.$.Hc,8,null),this.$.Ka.Lb(Bb,bc))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.$cb(this.onFunctionInfoLoaded);this.Cff()};this.zbi=Bb=>{P(this.$,Bb,!1)};this.SQi=Bb=>{this.hide();L(this.$,"InsertFunctionDialog",Bb)};this.Blf=Bb=>!this.functionInfoManager.Yic(Bb);this.Ql=B.a.instance.ga(1031);this.functionInfoManager=
Ha.da.Aa(19);this.hg()}get pc(){return"FunctionDialog"}hg(){this.functionInfoManager.XJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Tb=1;this.functionInfoManager.UV?this.Cff():this.functionInfoManager.OGa(this.onFunctionInfoLoaded)}Cff(){var Ha;this.F1b=this.functionInfoManager.Zbc.filter(this.Blf);const Bb=null!==(Ha=K.Lpf)&&void 0!==Ha?Ha:K.T7g;Ha=this.functionInfoManager.nfd;const bc=this.functionInfoManager.sdc(Bb).map(tc=>tc.FunctionIndex);this.Pq={[K.yu]:this.pc,[U.CategoryList]:Ha,
[U.FunctionsMap]:this.Ddh(),[U.FunctionIdsToDisplay]:bc,[U.RefreshListCallback]:this.gUi.bind(this),[U.feedbackCallback]:this.SQi.bind(this),[U.HelpCallback]:this.zbi,[U.InitialCategory]:Bb,[U.AllCategoryName]:K.AllCategoryName};this.initializeAndShow(this.Ql,this.c0e,this.Pq)}Ddh(){let Ha={};this.F1b.forEach(Bb=>{Ha[Bb.FunctionIndex]=Bb});return Ha}VYj(Ha){Ha=Ha.map(Bb=>Bb.FunctionIndex);this.Pq[U.FunctionIdsToDisplay]=Ha;this.kVa(this.Ql,this.Q5a(this.c0e),this.Pq)}gUi(Ha,Bb){Bb?Bb=this.HGh(Bb):
(Bb=this.functionInfoManager.sdc(Ha).filter(this.Blf),K.Lpf=Ha);this.VYj(Bb)}HGh(Ha=""){Ha=Ha.toLocaleLowerCase();const Bb=this.F1b.filter(({NameUI:bc})=>bc.toLocaleLowerCase().startsWith(Ha));3<=Ha.length&&(Bb.push(...this.F1b.filter(bc=>bc.NameUI.toLocaleLowerCase().includes(Ha)&&!Bb.includes(bc))),Bb.push(...this.F1b.filter(bc=>bc.Help.toLocaleLowerCase().includes(Ha)&&!Bb.includes(bc))));return Bb}}K.AllCategoryName=B.a.instance.ga(1030);K.T7g=B.a.instance.ga(1029);K.Lpf=void 0;Object(h.a)(K,
"FunctionDialog",z.a,[]);var Y=a(55),na=a(68),W=a(33),X=a(89),Aa=a(27),Q=a(210),fa=a(69),Ca=a(86),ia=a(226),Ra=a(52),Ya=a(738),Ga=a(12),da=a(71),Z=a(1);const ha=fa.a.Cvh,Wa=fa.a.Jvh,ca=fa.a.Kvh,ja=fa.a.bTe,ua=fa.a.Evh,Za=fa.a.Gvh,Pa=fa.a.WSe,ka=fa.a.fTe,ra=fa.a.Fvh,ba=fa.a.ZSe;class Ua extends Q.a{constructor(Ha,Bb){super(Ha,B.a.instance.ga(1031),void 0,void 0,void 0,Z.EwaSettings.oa(371));this.Cwb=this.asf=this.k0e=this.h0e=this.Sja=this.g0e=this.Ewb=this.RKa=this.Tja=this.SKa=null;this.Pmd=!1;this.mzb=
this.pFb=this.d4b=null;this.onFunctionInfoLoaded=()=>{if(!this.RKa.count){const bc=this.functionInfoManager.nfd;for(let tc=0,Zc=bc.length;tc<Zc;++tc)this.RKa.SY(bc[tc],bc[tc],!1).className=fa.a.Dvh;this.RKa.selectedIndex=0;X.a.rc([this.d4b,this.pFb,this.mzb]);this.d4b=this.Be.oe(this.SKa);this.pFb=this.Be.oe(this.Tja);this.mzb=this.Be.oe(this.Cwb);this.d4b.la("change",this.hEf);this.pFb.la("change",this.FRi);this.pFb.la("dblclick",this.GRi);this.mzb.la("click",this.dda);this.mzb.la("keyup",this.NTi);
Ga.DOMElementExtensions.setVisible(this.Tja,!0);Ga.DOMElementExtensions.setVisible(this.g0e,!1);this.$.C8c&&Ga.DOMElementExtensions.setVisible(this.asf,!0)}this.hEf(null);this.getButton(0).get_element().disabled=!1;this.SKa.disabled=!1;this.cTa();this.Pmd=!0};this.dda=()=>{this.naa&&J(this.$,this.naa.HelpId,this.naa.IsDynamicUdf)};this.NTi=bc=>{13!==bc.keyCode&&32!==bc.keyCode||this.dda(bc)};this.hEf=()=>{const bc=this.functionInfoManager.sdc(this.RKa.ie.value);this.O4a(bc);this.Tja.scrollTop=0;this.K4f()};
this.FRi=()=>{this.K4f()};this.GRi=bc=>{this.naa&&(da.g(bc),this.close(0))};this.Tc=(bc,tc)=>{ia.b(tc)&&this.wv()};this.functionInfoManager=Ha.da.Aa(19);this.formulaAssistanceControl=Ha.da.Aa(221);if(this.uwb=W.a.SV(this.$))this.formulaAssistanceManager=Ha.da.Aa(464);this.ZU=Bb}get pc(){return"FunctionDeprecatedDialog"}get naa(){if(!this.Tja||!this.Tja.firstChild)return null;const Ha=Number.parseInvariant(this.Tja.children[this.Tja.selectedIndex].value);return this.functionInfoManager.OVh(Ha)}initialize(){this.Ib.classList.add(fa.a.Bvh);
if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7262176_FunctionDeprecatedDialogReduceInnerHtml")){var Ha=document.createElement("div");Ha.classList.add(fa.a.VSe);var Bb=document.createElement("label");Bb.setAttribute("for",Ua.ofd);Bb.innerText=B.a.instance.ga(1034)+" ";Ha.appendChild(Bb);Bb=document.createElement("select");Bb.id=Ua.ofd;Bb.classList.add(ha);Bb.setAttribute("disabled","true");Ha.appendChild(Bb);this.Ib.appendChild(Ha);Ha=document.createElement("div");Ha.classList.add(Ca.a.Tm);Ha.innerText=
B.a.instance.ga(1035);this.Ib.appendChild(Ha);Ha=document.createElement("div");Ha.classList.add(fa.a.USe);Bb=document.createElement("select");Bb.id=Ua.f0e;Bb.classList.add(Wa,Aa.a.Lw?ca:null,x.a.Co,x.a.Do);Bb.size=7;Ha.appendChild(Bb);Bb=document.createElement("div");Bb.classList.add(Za);Bb.innerText=B.a.instance.ga(736);Ha.appendChild(Bb);this.Ib.appendChild(Ha);Ha=document.createElement("div");Ha.classList.add(fa.a.XSe);Bb=document.createElement("div");Bb.classList.add(ba);Bb.style.direction="ltr";
var bc=document.createElement("span");bc.classList.add(ra,x.a.Co);const tc=document.createElement("span");tc.classList.add(x.a.fs,fa.a.YSe);const Zc=document.createElement("img");Zc.title=B.a.instance.mb(3);Zc.classList.add(x.a.VVe);Zc.src=Ra.a.de(13);tc.appendChild(Zc);bc.appendChild(tc);Bb.appendChild(bc);bc=document.createElement("span");bc.id=Ua.rfd;bc.classList.add(ka);Bb.appendChild(bc);bc=document.createElement("a");bc.tabIndex=0;bc.title=B.a.instance.ga(1036);bc.classList.add(ua);Bb.appendChild(bc);
bc=document.createElement("span");bc.id=Ua.Ybc;Bb.appendChild(bc);Ha.appendChild(Bb);Bb=document.createElement("div");Bb.classList.add(Pa);Bb.id=Ua.qfd;Ha.appendChild(Bb);this.Ib.appendChild(Ha)}else this.Ib.innerHTML=Ua.uH();this.Pf||(this.Pt(),this.rsa());super.initialize();Ha=Ga.DOMElementExtensions.nk(this.Ib,ba);this.rtl&&(Ha.align="right",this.Cwb.style.marginLeft="5px");this.Pf&&(Ha.style.padding="1px");this.functionInfoManager.XJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&
(this.functionInfoManager.$cb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.tk(this.Tc));X.a.rc([this.d4b,this.pFb,this.mzb,this.RKa,this.Ewb]);super.dispose()}Pt(){this.SKa=Ga.DOMElementExtensions.nk(this.Ib,ha);this.Tja=Ga.DOMElementExtensions.nk(this.Ib,Wa);this.SKa.setAttribute(y.a.Ad,y.a.g2b);this.RKa=new Ya.a(this.SKa,!0);this.Ewb=new Ya.a(this.Tja,!0);this.g0e=Ga.DOMElementExtensions.nk(this.Ib,Za);this.Cwb=Ga.DOMElementExtensions.nk(this.Ib,ua);this.k0e=Ga.DOMElementExtensions.nk(this.Ib,
ka);this.asf=Ga.DOMElementExtensions.nk(this.Ib,ra);this.h0e=$get(Ua.Ybc,this.Ib);this.Sja=Ga.DOMElementExtensions.nk(this.Ib,Pa);this.Pf&&(this.Sja.style.paddingLeft="1px");this.functionInfoManager.OGa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Xj(this.Tc)}hR(Ha){this.$.da.fb(40,()=>{this.RKa.hR(Ha)})}wq(){this.uwb?this.formulaAssistanceManager.W8b():this.formulaAssistanceControl.set_visible(!1);super.wq();this.Pmd||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.SKa.disabled&&
this.Pmd&&Ga.DOMElementExtensions.setFocus(this.SKa)}commit(){return!0}osb(){let Ha=this.naa.NameDataStrings;const Bb=new D.a(-433697611,0,this.$.Hc,8,null);this.$.Ka.Lb(Bb,{[u.a.Kc]:Ha,["ibdk"]:!0})}fta(){this.uwb?this.formulaAssistanceManager.bea():this.formulaAssistanceControl.bqb()}O4a(Ha){this.Ewb.clear();const Bb=Ua.Ybc+" "+Ua.qfd;for(let bc=0,tc=Ha.length;bc<tc;++bc){const Zc=this.Ewb.SY(Ha[bc].NameUI,Ha[bc].FunctionIndex.toString(),!1);Aa.a.Lw&&Zc.classList.add(ja);Zc.setAttribute(y.a.MM,
Ua.rfd);Zc.setAttribute(y.a.kH,Bb)}this.Ewb.selectedIndex=0}K4f(){if(this.naa){this.Cwb.parentNode.className=fa.a.ZSe+(this.functionInfoManager.Yic(this.naa)?"-udf":"");var Ha=this.naa.NameDataStrings;this.k0e.innerText=Ha;this.Cwb.innerText=Ha;this.Sja.innerText=this.naa.Help;Ha=this.naa.Params.split(v.Acd);this.h0e.innerText=v.openParen+(1<Ha.length?v.V9b:Ha[0])+v.closeParen}}static uH(){return String.format("<div class='"+fa.a.VSe+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+
Ca.a.Tm+"'>{1}</div>\r\n<div class='"+fa.a.USe+"'>\r\n\t<select id='{16}' class='{17} "+x.a.Co+" "+x.a.Do+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+fa.a.XSe+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+x.a.Co+"'>\r\n\t\t\t<span class='"+x.a.fs+" "+fa.a.YSe+"'>\r\n\t\t\t\t<img title='{3}' class='"+x.a.VVe+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
B.a.instance.ga(1034),B.a.instance.ga(1035),B.a.instance.ga(736),B.a.instance.mb(3),Ra.a.de(13),B.a.instance.ga(1036),Ua.ofd,Ua.Ybc,7,ha,ua,Za,Pa,ka,ra,ba,Ua.f0e,Wa+(Aa.a.Lw?" "+ca:""),Ua.qfd,Ua.rfd)}}Ua.Ybc="function_dialog_param_string";Ua.qfd="function_dialog_function_description";Ua.rfd="function_dialog_function_name";Ua.f0e="function_list";Ua.ofd="function_category";Object(h.a)(Ua,"FunctionDeprecatedDialog",Q.a,[]);var Ka=a(262),Oa=a(22);class ib extends z.a{constructor(Ha,Bb,bc,tc){super(Ha);
this.G4a=Bb;this.formulaAuthoringHelper=bc;this.qag=tc;this.$Kh=(Zc,wd)=>{var Ld;if(1===Zc){this.hide();Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7428201_supportStopRangePickerWithoutSupplyingTextboxId")&&this.rangePickerController.disposeRangePicker(void 0);Zc=this.G4a.NameUI;for(wd=null!==(Ld=wd.functionArgs)&&void 0!==Ld?Ld:[];1<wd.length&&Oa.a.sh(wd[wd.length-1]);)wd.pop();Ld={[u.a.Kc]:Zc,["functionArgs"]:wd,["ibdk"]:!0};wd=new D.a(-433697611,0,this.$.Hc,8,null);this.$.Ka.Lb(wd,Ld)}else 2===
Zc&&(this.hide(),Ld=new D.a(753860909,0,this.$.Hc,8,null),this.$.Ka.Lb(Ld))};this.vW=()=>P(this.$,this.G4a.HelpId,!1);this.VVh=()=>this.formulaAuthoringHelper.hasRepeatingParams(this.G4a)?Zc=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.qag,this.G4a,Zc):void 0;this.feedbackCallback=Zc=>L(this.$,"functionArgumentsDialog",Zc);this.Ql=B.a.instance.ga(1032);this.rangePickerController=Object(M.h)(this.$).yf.cyb();this.hg()}get pc(){return"FunctionArgumentsDialog"}hg(){this.Tb=1;this.Pq={[Ka.a.yu]:this.pc,
["functionInfo"]:this.G4a,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.qag,this.G4a),["generateArgByIndex"]:this.VVh(),["helpCallback"]:this.vW,["giveFeedbackCallback"]:this.feedbackCallback,["isModal"]:!1,["rangePickerController"]:this.rangePickerController};this.initializeAndShow(this.Ql,this.$Kh,this.Pq)}}Object(h.a)(ib,"FunctionArgumentsDialog",z.a,[]);var La=a(7),db=a(263);class Ab{constructor(Ha,Bb,bc){this.$=Ha;this.Va=Bb;this.functionInfoManager=bc;this.dLh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");
this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.dLh.includes(this.menuId)&&this.frame.ux(this.menuId)};this.SV=W.a.SV(this.$);this.EBb=W.a.vlf();this.SV&&(this.formulaAssistanceManager=this.$.da.Aa(464));this.fZ={};this.frame=this.$.frame;this.functionInfoManager.OGa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=Ha.da.Aa(491)}nc(Ha,Bb){switch(Bb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return Ha=
M.h(this.$).Ai,Ha.Y6a||!Ha.gb||0>=Ha.text.length?!1:!0;default:return!1}}executeCommand(Ha,Bb,bc){var tc,Zc;Bb=Bb.command;Ha=M.h(this.$);const wd=Ha.Ai;switch(Bb){case 753860909:case -2060563418:null===(tc=this.formulaAssistanceManager)||void 0===tc?void 0:tc.W8b();Ha.inRangePicker&&wd.XE(!1);this.EBb?new K(this.$):(new Ua(this.$,wd)).vg();this.formulaAssistanceTelemetryManager.F4a.dialogShownCounter++;break;case 1117706454:null===(Zc=this.formulaAssistanceManager)||void 0===Zc?void 0:Zc.W8b();Ha.inRangePicker&&
wd.XE(!1);const Ld=this.functionInfoManager.w4e(bc[u.a.Kc]);Ha=Oa.a.nVf(Ld.Params).split("!")[0];const ae=""!==Ha?Ha.split(this.$.listSeparator).filter(Fe=>"..."!==Fe):[];w.TaskExtensions.WJ(l.GetServiceTaskFactory.Na(this.$.da,520,521,0),Fe=>{new ib(this.$,Ld,Fe.result,ae)},this.$.ka,3);bc.ibdk?this.formulaAssistanceTelemetryManager.F4a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.F4a.argsDialogOpenedByRibbonCounter++;break;case -433697611:tc=bc.functionArgs;bc.ibdk&&
(void 0!==tc?this.formulaAssistanceTelemetryManager.F4a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.F4a.dialogCommitedCounter++);let ne=bc[u.a.Kc]+v.openParen;this.EBb&&(void 0!==tc&&(ne+=tc.join(this.$.listSeparator)),ne+=v.closeParen);bc.UILocation&&this.$.Xc(-1075437823,-1,0,null);Ha.view.visibleArea.contains(Ha.fg(null))||Ha.Eu(Ha.ha.ra.activeCell,3,"FormulaAssistanceCommandHandler.ExecuteCommand");const xe=wd.textBox;bc=wd.textBox.caretPosition;wd.gb?(tc=wd.text,Zc=bc?
tc.substring(0,bc):"=",wd.text=Zc+ne+tc.substring(bc+(xe.Ry?xe.Ry.length:0),tc.length),xe.caretPosition=Zc.length+ne.length):this.EBb?Ha.setCell(Object(La.a)(new db.a,{Text:`=${ne}`}),Ha.ha.ra.activeCell,0,127,null):w.TaskExtensions.za(Ha.startEdit(!0,1),()=>{wd.text="="+ne;const Fe=ne.length+1;xe.oeb(Fe);xe.caretPosition=Fe},this.$.ka,11,na.a.current);Ha.Vl&&(bc=Ha.Vb,bc.text=xe.text,bc.setCaretPosition(xe.caretPosition));this.SV?this.formulaAssistanceManager.bea():(bc=wd.k3.get(r.a.Dwb),null===
bc||void 0===bc?void 0:bc.nZ(!1));break;case -1334919469:J(this.$,"154468",!1)}return Y.Task.Ra(!0)}yc(Ha,Bb){switch(Bb.command){case 753860909:case -2060563418:case -433697611:case -1334919469:return!0;case 1117706454:return this.EBb;default:return!1}}ZLh(Ha,Bb){Bb=this.Va.gq(Bb);const bc=this.Va.Fc();var tc=this.functionInfoManager.sdc(Ha);if(!tc)return n.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Bb.NC();const Zc=this.EBb?1117706454:
-433697611;for(let wd=0;wd<tc.length;++wd){const Ld=tc[wd].NameUI,ae=this.Va.sQ(280,"Formulas."+Ha+"MenuItem_"+tc[wd].FunctionIndex.toString(),Zc,null,1,"None",0,0,Ld,!1,0);ae.label=Ld;const ne=tc[wd].Params.split(v.Acd);ae.yS(Ld+" "+(v.openParen+(1<ne.length?v.V9b:ne[0])+v.closeParen)+"\n"+tc[wd].Help);bc.buttons.push(ae)}Ha=this.Va.Fc();tc=this.Va.sQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,x.a.mWe,3,"Image16by16",1033,0,"Formulas.MoreFunctionsMenuItem",!1,0);Ha.buttons.push(tc);Bb.tc.push(bc);
Bb.tc.push(Ha);return Bb.NC()}Lc(Ha,Bb,bc){Ha=this.NVh(Bb);if(-1===Ha)return!1;this.menuId=bc.MenuId;if(!this.functionInfoManager.UV)return this.functionInfoManager.XJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;Ha=this.functionInfoManager.nfd[Ha];this.fZ[Ha]=this.fZ[Ha]||this.ZLh(Ha,bc.MenuId);bc.MenuItems=this.fZ[Ha];return!0}NVh(Ha){switch(Ha){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;
case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}}}Object(h.a)(Ab,"FormulaAssistanceCommandHandler",null,[219]);class Mb extends m.a{constructor(Ha){super(Ha)}ld(){const Ha=l.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya),Bb=l.GetServiceTaskFactory.create(this.$.da,
153,this.ka,this.Ya);w.TaskExtensions.za(w.TaskExtensions.Ed([Ha,Bb],this.ka),()=>{this.Zc([new Ab(this.$,Ha.result,Bb.result)])},this.ka,3)}static la(Ha){m.a.Nd(92,new Mb(Ha))}}Object(h.a)(Mb,"FormulaAssistanceCommandHandlerFactory",m.a,[]);var pb=a(222);class Qb{constructor(Ha,Bb){this.TKa=this.xva=this.Nja=null;this.SHf=(bc,tc)=>{this.Vbj(tc.functionName,tc.vfd)};this.UHf=(bc,tc)=>{this.Ubj(tc.vfd,tc.uRd,tc.r2i)};this.THf=(bc,tc)=>{bc=[];for(var Zc of tc.uRd)(!this.ixa||void 0!==Zc&&null!==Zc)&&
(tc=Zc.trim())&&bc.push(tc);if(!this.ixa||bc.length){Zc="";for(tc=0;tc<bc.length;tc++){const wd=this.d1c(bc[tc]),Ld=Qb.VHd(tc,bc.length);Zc+=wd+Ld;Ld&&(Zc+=this.ariaLiveNotifier.wya)}this.ariaLiveNotifier.readText(Zc)}};this.VHf=(bc,tc)=>{this.ariaLiveNotifier.Xbj(tc.rG,tc.description,tc.selectedIndex.toString(),tc.length.toString())};this.OHf=(bc,tc)=>{this.ariaLiveNotifier.JSf(tc.description,tc.length)};this.bEf=()=>{this.ariaLiveNotifier.xcb(B.a.instance.ga(883),y.a.sHa)};this.UDf=()=>{this.ariaLiveNotifier.readText(B.a.instance.ga(884))};
this.XDf=()=>{this.ariaLiveNotifier.readText(B.a.instance.ga(885))};this.$=Bb;this.ariaLiveNotifier=Ha;this.$.da.Ga(219,this);this.ixa=W.a.q5(Bb)}dispose(){this.o1d();this.TKa=this.xva=this.Nja=null}z_c(Ha){Ha&&(this.Nja=Ha,this.Nja.lse(this.SHf),this.Nja.ete(this.UHf),this.ixa&&this.Nja.dte(this.THf))}A_c(Ha){Ha&&(this.xva=Ha,this.ixa&&(this.xva.jse(this.bEf),this.xva.hse(this.UDf)),this.xva.ise(this.XDf))}B_c(Ha){Ha&&(this.TKa=Ha,this.TKa.CYc(this.VHf),this.TKa.R0b(this.OHf))}o1d(){var Ha,Bb,bc;
this.Nja&&(this.Nja.VWf(this.SHf),this.Nja.sXf(this.UHf),this.ixa&&this.Nja.rXf(this.THf));this.TKa&&(this.TKa.FNd(this.VHf),this.TKa.Kvc(this.OHf));this.ixa&&(null===(Ha=this.xva)||void 0===Ha?void 0:Ha.UWf(this.bEf),null===(Bb=this.xva)||void 0===Bb?void 0:Bb.SWf(this.UDf));null===(bc=this.xva)||void 0===bc?void 0:bc.TWf(this.XDf)}Vbj(Ha,Bb){if(Bb){let bc="";this.ixa||(bc+=B.a.instance.mb(57)+this.ariaLiveNotifier.wya);for(let tc=0;tc<Bb.length;tc++)bc+=Ha+this.ariaLiveNotifier.wya+this.d1c(Bb[tc])+
Qb.VHd(tc,Bb.length);this.ixa&&(bc+=B.a.instance.ga(882)+this.ariaLiveNotifier.wya);this.ariaLiveNotifier.readText(bc)}}Ubj(Ha,Bb,bc){if(Ha){let Zc="",wd=0;if(Bb){for(let Ld=0;Ld<Bb.length;Ld++){if(bc>=Ha[Ld].split(this.$.listSeparator).length){wd++;continue}var tc=Bb[Ld].trim();if(!tc)return;tc=this.d1c(tc);const ae=Qb.VHd(Ld-wd,Bb.length-wd);Zc+=tc+ae;ae&&(Zc+=this.ariaLiveNotifier.wya)}this.ariaLiveNotifier.readText(Zc)}}}d1c(Ha){if(!Ha)return"";var Bb=Ha.split(this.$.listSeparator);Ha="";for(const bc of Bb){if(Qb.yrd(bc))Ha+=
bc;else{const tc=(Bb=Qb.$qi(bc))?bc.replace("[","").replace("]",""):bc;Ha+=String.format(Bb?B.a.instance.mb(59):B.a.instance.mb(58),tc)}Ha+=this.ariaLiveNotifier.wya}return Ha}static VHd(Ha,Bb){return Ha>=Bb||1===Bb?(n.ULS.shipAssertTag(537161997,0,Ha<Bb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(B.a.instance.mb(55),Ha+1,Bb)+"\r\n"}static yrd(Ha){return Oa.a.contains(Ha,v.V9b,!0)}static $qi(Ha){return Ha.trimStart().startsWith(v.VLf)||Ha.trimEnd().endsWith(v.ULf)}}
Object(h.a)(Qb,"FormulaAssistanceReadoutHandler",null,[640,3]);class xb extends pb.a{constructor(Ha){super();this.$=Ha;this.Fb()}create(){const Ha=this.$.da;w.TaskExtensions.za(l.GetServiceTaskFactory.Na(Ha,211,212,this.Ya),Bb=>{Bb=Ha.Aa(219)||new Qb(Bb.result,this.$);this.ob(Bb)},this.ka,3)}static la(Ha){Ha.da.Ga(220,new xb(Ha))}}Object(h.a)(xb,"FormulaAssistanceReadoutHandlerFactory",pb.a,[]);var pa=a(642),Ma=a(111),ya=a(982),Ea=a(58),Na=a(40),kb=a(116);class lb{constructor(){this.eSa={}}pkd(Ha){return this.eSa&&
Ha in this.eSa?this.eSa[Ha]:null}Ccg(Ha,Bb){this.eSa||(this.eSa={});this.eSa[Ha]=Bb}w_(){this.eSa=null}}Object(h.a)(lb,"FormulaAssistanceContextualPreviewCache",null,[]);var oa=a(60);const Ba=(Ha,Bb,bc,tc,Zc,wd,Ld=null)=>{Ld=Ha.Oa(1,Ld);Ld.getPartialCalcResultsParameters=Bb;return oa.g(Ha,"GetPartialCalcResults",Ld,bc,tc,Zc,wd,4)};class sa{constructor(Ha){this.rGi=30;this.calcManager=null;this.Dd=!1;this.oQa=this.lIb=this.ybb=null;this.Fy=()=>{this.Zha.w_()};this.$=Ha;this.Zha=new lb;this.sZf=-1;
this.$.ea.PE(this.Fy)}dispose(){this.Dd||(this.$&&(this.$.ea.bE(this.Fy),this.$=null),this.Zha=this.lIb=null,this.Dd=!0)}Pgd(Ha,Bb,bc,tc){if(Bb&&0>=Bb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!Ha)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
let Zc="="+Bb.substring(bc.start,bc.end);Z.EwaSettings.oa(552)&&(Zc=this.calcManager.V3h(M.h(this.$).ha.ra.activeCell,Ha,bc));const wd=this.XRh(Zc,bc);if(Z.EwaSettings.oa(552)){if(wd&&!this.calcManager.isFormulaSubExpressionVolatile(Ha))return Promise.resolve(wd)}else if(wd)return Promise.resolve(wd);return this.ZRh(Zc,bc).then(Ld=>{if(this.h3c(tc))throw Error.create("OperationCanceledException");if(!Ld||Ld.Toj||Ld.Gna.startsWith("##UNSUPPORTED:"))return this.R2e(Bb,Zc,bc,tc);this.Zha.Ccg(Zc,Ld.Gna);
return Promise.resolve(Ld)})}XRh(Ha,Bb){return(Ha=this.Zha.pkd(Ha))?new ya.a(Ha,Bb.start,Bb.end,0):null}ZRh(Ha,Bb){if(!Ha||0>=Ha.length||!Bb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.d0g(M.h(this.$).ha.ra.activeCell,Ha,this.rGi,Bb)}R2e(Ha,Bb,bc,tc){if(!Ha||0>=Ha.length||!Bb||0>=Bb.length||!bc)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.oQa)return this.YRh(Ha,Bb,bc,tc);const Zc={};Zc.PartialFormula=Bb;Zc.Formula=Ha;Zc.SourceRange=Na.v(M.h(this.$).ha.ra.activeCell,this.$);return this.oQa=new Promise((wd,Ld)=>{this.lIb=new pa.a;this.sZf=this.$.ea.ye;this.ybb=Ba(this.$.pa.xa,Zc,ae=>{this.h0i(Bb,bc,tc,ae,wd,Ld)},ae=>{this.ybb=this.oQa=null;Ld(ae)},null,null,null);this.lIb.token.register(()=>{this.K1g(Ld)})})}h0i(Ha,Bb,bc,tc,Zc,wd){this.ybb=this.oQa=null;if(this.sZf!==this.$.ea.ye)wd(Error.create("OperationCanceledException"));
else if(tc.Result)if(tc=Ea.a.$h(tc.Result),!tc||Ma.a.isEmpty(tc))Zc(null);else{for(let Ld in tc)this.Zha.Ccg(Ld,tc[Ld]);this.h3c(bc)?wd(Error.create("OperationCanceledException")):(Ha=this.Zha.pkd(Ha))?(""===Ha&&(Ha=" "),Zc(new ya.a(Ha,Bb.start,Bb.end,0))):wd(Error.create("SubexpressionNotFoundException"))}else Zc(null)}YRh(Ha,Bb,bc,tc){return new Promise((Zc,wd)=>{this.oQa.then(()=>{this.e_f(Ha,Bb,bc,tc,Zc,wd)}).catch(()=>{this.e_f(Ha,Bb,bc,tc,Zc,wd)})})}e_f(Ha,Bb,bc,tc,Zc,wd){if(this.h3c(tc))wd(Error.create("OperationCanceledException"));
else{const Ld=this.Zha.pkd(Bb);Ld?Zc(new ya.a(Ld,bc.start,bc.end,0)):this.R2e(Ha,Bb,bc,tc).then(ae=>{Zc(ae)}).catch(ae=>{wd(ae)})}}K1g(Ha){this.ybb&&(kb.a.cu(this.ybb.tt)?(this.oQa=this.ybb=null,Ha(Error.create("PendingWebReqeuestCancelled"))):n.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}w_(){this.L1g();this.Zha&&this.Zha.w_()}L1g(){this.lIb&&this.lIb.cancel()}h3c(Ha){return this.Dd||Ha.JK}}Object(h.a)(sa,"FormulaAssistanceContextualPreviewCalculator",null,[3]);
var qb=a(156),Jb=a(212);class Yb{}Yb.mwh="ewa-facp-text-box";Object(h.a)(Yb,"CssClassNames",null,[]);class jb{constructor(Ha){this.cra=this.uUa=this.I3a=this.rQ=this.daa=this.eb=null;this.Bmd=!1;this.Mc=Ha}dispose(){(this.daa||this.rQ)&&this.cdf();this.eb=this.cra=null}HYj(Ha,Bb,bc,tc){Ha&&Bb&&tc&&Bb.Gna&&!(1>Bb.Gna.length)&&(this.eb=Ha,this.VVf(),this.I3a=Bb,this.uUa=tc,this.VGj(Bb,bc,tc))}cdf(){this.Mbi();this.VVf();this.uUa=this.I3a=null}VGj(Ha,Bb,bc){if(Ha.Gna&&!(1>Ha.Gna.length)){var tc=this.Mc.da.Aa(266);
if(tc){var Zc=tc.cYh();Zc&&w.TaskExtensions.za(this.YDb,()=>{if(Bb)if(Z.EwaSettings.oa(552)&&this.eb.gb&&0<bc.length){this.xzb(Ha.PKa,bc[0].start,null);var wd=this.c9e(bc[0],Zc),Ld=this.eb.text.substring(bc[0].start,bc[0].end).trim();Ld=this.eb.text.indexOf(Ld);Ld=this.eb.text.substring(0,Ld).lastIndexOf("\n");this.xzb(0>Ld||1>=bc.length?bc[0].start:Ld+1,bc[0].end,wd?String.format(wd,.3):null);for(var ae=1;ae<bc.length;ae++)wd=this.c9e(bc[ae],Zc),Ld=this.eb.text.substring(bc[ae].start,bc[ae].end).trim(),
Ld=this.eb.text.indexOf(Ld),Ld=this.eb.text.substring(bc[ae-1].end,Ld).lastIndexOf("\n"),this.xzb(0>Ld?bc[ae-1].end:Ld+1+bc[ae-1].end,bc[ae].end,wd?String.format(wd,.3):null);Ld=this.eb.text.substring(bc[bc.length-1].end,Ha.zva).indexOf("\n");this.xzb(0>Ld?bc[bc.length-1].end:Ld+1+bc[bc.length-1].end,Ha.zva,null);n.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.xzb(Ha.PKa,
Ha.zva,null),n.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.daa||(this.daa=document.createElement(Jb.a.div),this.eb.textBox.domElement.appendChild(this.daa));this.rQ||(this.rQ=document.createElement(Jb.a.div),this.rQ.className=Yb.mwh,this.Mc.domElement.appendChild(this.rQ));wd=Ha.zva;Z.EwaSettings.oa(552)&&this.eb.gb&&bc&&0<bc.length&&bc[0].start<wd&&bc[0].start!==Ha.PKa&&
!this.eb.textBox.Ry.length&&(wd=bc[0].start);ae=Oa.a.contains(this.eb.textBox.Ke.id,"FormulaBar",!0)&&Oa.a.contains(this.eb.text.substring(Ha.PKa,Ha.zva),"\n",!0);Ld=this.eb.gb?this.eb.textBox.caretPosition:0;wd=excelOnline.utils.getBoundingRectForText(this.eb.textBox.Ke,ae?Ld:Ha.PKa,ae?Ld:wd,Z.EwaSettings.oa(552));this.rQ.style.left=I.HelperMethods.uc(wd.left);this.rQ.style.top=I.HelperMethods.uc(wd.top);this.rQ.style.width=I.HelperMethods.uc(wd.width);this.rQ.style.height=I.HelperMethods.uc(wd.height);
dialogControls.renderToolTip(this.daa,`FormulaAssistancePreviewToolTip_${Ha.zva}_${Ha.zva}`,Ha.Gna,this.rQ,0,!1,!1,1)},this.Mc.ka,3)}}}c9e(Ha,Bb){const bc=this.eb.text;var tc=bc.substring(Ha.start,Ha.end);tc=tc.trim();Ha=bc.indexOf(tc,Ha.start);Bb=bc.indexOf(Bb,Ha);tc=bc.substring(Ha,Bb);tc=tc.trim();return this.eb.colors.getItem(Ha+"-"+(Ha+tc.length))}Mbi(){this.eb&&this.daa&&this.rQ&&w.TaskExtensions.za(this.YDb,()=>{this.eb.textBox.domElement.contains(this.daa)&&(dialogControls.clearToolTip(this.daa),
this.eb.textBox.domElement.removeChild(this.daa),this.daa=null);this.Mc.domElement.contains(this.rQ)&&(this.Mc.domElement.removeChild(this.rQ),this.rQ=null)},this.Mc.ka,3)}xzb(Ha,Bb,bc){!this.eb||Ha>=Bb||(this.eb.textBox.formatText(Ha,Bb-Ha,{["background"]:bc||"#E3DDCC"}),this.Bmd=!0)}VVf(){if(this.eb&&this.I3a&&this.Bmd){var Ha=this.I3a.zva;Z.EwaSettings.oa(552)&&0<this.uUa.length&&this.uUa[this.uUa.length-1].end>Ha&&(Ha=this.uUa[this.uUa.length-1].end);this.eb.textBox.formatText(this.I3a.PKa,Ha-
this.I3a.PKa,{["background"]:!1});this.Bmd=!1}}get YDb(){if(this.cra)return this.cra;const Ha=new qb.a;this.Mc.qy(Bb=>{w.TaskExtensions.za(Bb.gxd(),()=>{Ha.setResult(!0)},this.Mc.ka,3)});return this.cra=Ha.task}}Object(h.a)(jb,"FormulaAssistanceContextualPreviewControl",null,[3]);var ab=a(83),vb=a(47),Da=a(46);class Fa{constructor(Ha){this.i8=0;this.Ued=Ha}U9f(Ha,Bb,bc){bc?this.Mch(Ha,Bb,bc):this.iaf(Ha,Bb,bc,!0)}unj(){this.i8=0}Mch(Ha,Bb,bc){this.i8++;const tc=this.i8;vb.a.instance.create(()=>{this.iaf(Ha,
Bb,bc,tc===this.i8)},500,Da.a.dKh,!0,!0)}iaf(Ha,Bb,bc,tc){const Zc=this.Ued.Pgd(Ha,Bb);Zc&&Zc.then(wd=>{tc&&this.Ued.hsd(Bb)&&this.Ued.GYj(Ha,wd,bc)}).catch(wd=>{wd=Object(ab.a)(Error,wd);"OperationCanceledException"===wd.message?n.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${wd}`):n.ULS.sendTraceTag(537162058,0,10,`GetContextualFormulaPreviewResults - caught exception: ${wd}`)})}}Object(h.a)(Fa,"FormulaAssistanceContextualPreviewHoverManager",null,[]);
var nb=a(175);class Ta{constructor(Ha){this.utb=this.Xha=this.calcManager=this.eb=null;this.oab=()=>{this.B6a(!1,!1)};this.$=Ha;this.twb=new jb(Ha);this.Nbc=new sa(Ha);this.Obc=new Fa(this);M.h(Ha).Vb.Qm(this.oab);this.$.da.Ga(317,this)}dispose(){this.g2c();X.a.rc([this.twb,this.Nbc]);this.Obc=this.Nbc=this.twb=null;this.$&&M.h(this.$).Vb.fm(this.oab);this.Xha=this.eb=this.$=null}WGj(Ha,Bb){Bb&&nb.f(Bb.text)&&!(Bb.uxa||Bb.textBox.Ry||this.eb&&this.eb.textBox.Ry)&&(this.eb=Bb,this.calcManager=this.$.da.Aa(266))&&
(n.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),Ha=I.HelperMethods.axb(Ha),Ha=this.calcManager.S3h(M.h(this.$).ha.ra.activeCell,this.eb.text,Ha.x,Ha.y),Bb=this.calcManager.getSubExpressionSpan(Ha),!Bb||Bb.end<=Bb.start||this.hsd(Bb)||(this.Xha=Bb,this.Obc.U9f(Ha,Bb,!0)))}gWd(Ha){if(Ha&&nb.f(Ha.text))if(Ha.textBox.Ry&&Ha.textBox.Ry.trim()){if(this.eb=Ha,this.calcManager=this.$.da.Aa(266)){n.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");Ha={};var Bb=this.eb.textBox.Ry.trim();Ha.start=this.eb.text.indexOf(Bb,this.eb.textBox.caretPosition);Ha.end=Ha.start+Bb.length;(Bb=this.calcManager.getFormulaSubExpressionObject(M.h(this.$).ha.ra.activeCell,this.eb.text,this.eb.textBox.Ry))&&!this.hsd(Ha)&&(this.Xha=Ha,this.Obc.U9f(Bb,Ha,!1))}}else this.B6a(!1,!0)}B6a(Ha,Bb){!this.eb||Bb&&this.eb.textBox.Ry||(this.Xha=
null,Ha&&(this.g2c(),this.Nbc.w_(),this.Obc.unj()),this.twb&&this.twb.cdf(),this.eb.uxa||(this.eb.uxa=!1,this.eb=null))}Pgd(Ha,Bb){if(!this.eb||this.eb.uxa)return null;this.g2c();this.utb=new pa.a;return this.Nbc.Pgd(Ha,this.eb.text,Bb,this.utb.token)}GYj(Ha,Bb,bc){this.utb=null;!Ha||!Bb||!Bb.Gna||0>=Bb.Gna.length?this.B6a(!1,!1):(Ha=this.calcManager.T3h(M.h(this.$).ha.ra.activeCell,Ha,this.eb.text),this.twb.HYj(this.eb,Bb,bc,Ha))}hsd(Ha){return this.Xha?Ha.start===this.Xha.start&&Ha.end===this.Xha.end&&
Ha.pre===this.Xha.pre&&Ha.post===this.Xha.post:!1}g2c(){this.utb&&this.utb.cancel()}}Object(h.a)(Ta,"FormulaAssistanceContextualPreviewManager",null,[703,3,704]);var V=a(4),va=a(224),wb=a(14),fc=a(187),Fc=a(1092),Qa=a(65),la=a(778),hb=a(31),Kb=a(24),dc=a(66),sb=a(284),bb=a(248),Ob=a(162);class gc{constructor(Ha=!1){this.uT=0;this.zce=!1;this.mXa=this.$de=null;this.xzg=Ha;this.textEdit=null}v5f(Ha){this.uT=0;this.zce=Ha.IsCompatibility;this.set_name(Ha.NameDataStrings);this.mXa=Ha.Help}rxj(Ha){this.uT=
1;this.set_name(Ha.Name)}Uwj(Ha){this.uT=2;this.set_name(Ha.name);this.mXa=Ha.tooltip}xyj(Ha){this.uT=3;this.set_name(Ha.name);this.mXa=Ha.toolTip}T6f(Ha){this.uT=4;this.set_name(Ha.name)}QAj(Ha){this.uT=5;this.set_name(Ha.name);this.mXa=Ha.toolTip}PAj(Ha){this.uT=7;this.set_name(Ha.name)}ozj(){this.uT=6;this.set_name(B.a.instance.mb(192));this.mXa=B.a.instance.mb(193)}get itemType(){return this.uT}get zmi(){return this.zce}get name(){return this.label}set_name(Ha){return this.$de=Ha}get label(){return this.$de}get Sja(){return this.mXa}get nCb(){return this.xzg}static ihh(){return Object(La.a)(new gc(!0),
{})}}Object(h.a)(gc,"AutoCompleteItem",null,[722]);class mb{constructor(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(h.a)(mb,"DefinedNameInfo",null,[]);var Nb=a(165);class ic{constructor(Ha){this.nMe={};this.$=Ha}get mMe(){const Ha=[];if(!this.$.Cb||!this.$.Cb.items)return Ha;let Bb=0;const bc=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&W.a.SV(this.$);for(const tc of this.$.Cb.items)if(tc&&(3===tc.type&&tc.usedRange||
bc&&2===tc.type)){const Zc=new mb;Zc.tooltip=tc.sheetName+Qa.a.exclamation+tc.usedRange.toString();Zc.name=tc.name;Zc.namedRange=this.S$g(tc.usedRange);Zc.sheetName=tc.sheetName;Zc.type=this.K$g(tc.type);Ha.push(Zc);this.nMe[tc.name.toUpperCase()]=Zc;++Bb;if(!Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7395300_FixTableAutoCompleteMissingInfo")&&Bb===v.pwf){n.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${v.pwf}`);break}}return Ha}XUj(Ha){var Bb=
this.nMe[Ha.toUpperCase()];if(!Bb)return{returnValue:!1,sheetName:"",range:null};Ha=Bb.sheetName;Bb=this.B$g(Bb.namedRange);return{returnValue:!0,sheetName:Ha,range:Bb}}S$g(Ha){if(null!=Ha&&void 0!=Ha)return{top:Ha.top,left:Ha.left,bottom:Ha.bottom,right:Ha.right,maxRows:Ha.maxRows,maxColumns:Ha.maxColumns,sheetName:void 0}}B$g(Ha){if(null!=Ha&&void 0!=Ha)return new Nb.a(Ha.top,Ha.left,Ha.bottom,Ha.right,Ha.maxRows,Ha.maxColumns)}K$g(Ha){switch(Ha){case 2:return 0;case 3:return 1;default:return-1}}}
Object(h.a)(ic,"DefinedNameInfoManager",null,[]);var gb=a(129),Eb=a(264),Lc=a(261),Ec=a(238);class Cb extends Sys.EventArgs{constructor(Ha,Bb){super();this.functionName=Ha;this.vfd=Bb}}Object(h.a)(Cb,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class eb extends Sys.EventArgs{constructor(Ha){super();this.uRd=Ha}}Object(h.a)(eb,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class Sb extends Sys.EventArgs{constructor(Ha,Bb,bc){super();this.vfd=Ha;this.uRd=Bb;
this.r2i=bc}}Object(h.a)(Sb,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var ld=a(260);class bd{constructor(Ha,Bb,bc,tc,Zc=null){this.gla=this.U1c=!1;this.$=Ha;this.formulaAssistanceUIControl=Bb;this.N_e=bc;this.$sj=tc;this.Aaf=Zc;this.gla=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Hf(){return this.U1c}set Hf(Ha){this.U1c!==Ha&&(Ha?ld.a(this.$).di(this):ld.a(this.$).aA(this),this.U1c=Ha)}get he(){return this.$sj}get mc(){return this.formulaAssistanceUIControl.getRootElement(this.N_e)}kg(Ha,
Bb){Ha=!1;Bb||(M.h(this.$).Ai.textBox.HF=!0,Ha=this.formulaAssistanceUIControl.focus(this.N_e));return Ha}nh(Ha){const Bb=this.mc;return!(void 0===Bb||null===Bb)&&Ga.DOMElementExtensions.Af(Bb,Ha)}qj(){this.Aaf&&this.Aaf();if(this.gla){const Ha=M.h(this.$).Ai.textBox;this.selection=Ha.selection;Ha.removeSelection()}}dk(){this.gla&&(M.h(this.$).Ai.textBox.selection=this.selection)}dispose(){ld.a(this.$).aA(this)}}Object(h.a)(bd,"FormulaAssistanceFocusManager",null,[66,3]);var ec=a(38),sc=a(374),Dc=
a(188),Ud=a(35),Ed=a(283),$d=a(282),ve=a(915);class ze extends ec.a{constructor(Ha,Bb){super();this.gxg=[];this.yfd={};this.zfd={};this.qT=null;this.g9=[];this.UKa={};this.yEf=(bc,tc)=>{n.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.jEf(bc,!!tc&&1!==tc.FilterType,!0)};this.xEf=()=>{n.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.qT=null};this.gEf=
bc=>{n.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.ALd(bc.Uja,!0,!1)};this.wEf=bc=>{n.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.jEf(bc,!0,!1)};this.bOc=this.dOc=!1;this.jb=Ha;this.pluginScheduler=Bb;this.$.da.Ga(19,this)}OGa(Ha){this.addHandler("FunctionInfoLoaded",Ha)}$cb(Ha){this.removeHandler("FunctionInfoLoaded",Ha)}$Mg(Ha){this.addHandler("FunctionInfoReset",Ha)}Iij(Ha){this.removeHandler("FunctionInfoReset",
Ha)}get UV(){return this.dOc}get woi(){return this.bOc}get Zbc(){var Ha=this.qT,Bb=ve.a(this.$);if(!Bb)return Ha;Bb=Bb.dVh();const bc=Bb.length;if(0>=bc)return Ha;const tc=[];tc.push(...Ha);for(Ha=0;Ha<bc;Ha++){const Zc=Bb[Ha],wd={};wd.FunctionIndex=tc.length;wd.HelpId=wd.GroupUI=null;wd.Help=Zc.description;wd.IsCommonlyUsed=wd.IsCompatibility=!1;wd.NameDataStrings=Zc.name;wd.NameUI=Zc.name;wd.Params=null;wd.ParamsHelp=null;tc.push(wd)}return tc}get nfd(){return this.g9}get $(){return this.jb}dispose(){const Ha=
this.$.da.Aa(268);Ha&&Ha.iNd(this.gEf);this.jb=null;super.dispose()}LZf(){this.raiseEvent("FunctionInfoReset")}TOd(){this.LZf();this.dOc=!1;this.qT=null;this.bOc=!0}XJa(Ha,Bb=!1){if(this.UV)this.pRf();else{n.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let tc=null;(tc=this.$.da.Aa(268))||n.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===tc||void 0===tc?0:tc.Uja)&&0<tc.Uja.length)Z.EwaSettings.oa(119)?
tc.HJh(this.wEf):this.ALd(tc.Uja,!0,!1);else{var bc=this.$.pa.xa.Wb();Ha&&(this.$.ea.Zb||Bb)&&!this.woi&&(Bb?sc.a(this.$.userOperationManager,(Zc,wd,Ld)=>oa.o(this.$.pa.xa,Ha,$d.b(Zc,this.yEf),$d.a(wd,this.xEf),Ld,Ha,bc),Zc=>new Dc.a(130,0,Zc,16),null):oa.o(this.$.pa.xa,Ha,this.yEf,this.xEf,null,Ha,bc));!this.UV&&this.$.ea.Zb&&(tc?(n.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.UV}, IsSessionActive=${this.$.ea.Zb}`),
tc.kse(this.gEf)):(n.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),oa.o(this.$.pa.xa,{FilterType:0},this.wEf,null,null,null,bc),this.bOc=!1))}}}OVh(Ha){return 0>Ha||Ha>=this.qT.length?null:this.qT[Ha]}Uhd(Ha){return Ud.a.Ec(this.yfd,Ha.toUpperCase())}w4e(Ha){return Ud.a.Ec(this.zfd,Ha.toUpperCase())}sdc(Ha){return Ud.a.Ec(this.UKa,Ha)}Yic(Ha){return!Ha.GroupUI}jEf(Ha,Bb,bc){const tc=Ed.a(Ha);n.ULS.sendTraceTag(537161955,
0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${tc}`);tc?(M.h(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.To(Ha.Errors)):(this.ALd(Ha.Result,Bb,bc),W.a.TV(this.$)&&!W.a.SV(this.$)&&this.Z_j())}ALd(Ha,Bb,bc){n.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${Ha.length}, isCategorized = ${Bb}, partialResult = ${bc} IsFullyLoaded = ${this.UV}`);this.UV||(this.qT=Ha,this.TXg(Bb),this.dOc=
!bc,this.pRf())}pRf(){this.raiseEvent("FunctionInfoLoaded")}Z_j(){const Ha=this.Zbc;this.pluginScheduler.notifier().setFunctionsInfo(Ha);n.ULS.sendTraceTag(512278604,0,50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===Ha||void 0===Ha?void 0:Ha.length} functions}`)}TXg(Ha){var Bb=B.a.instance.ga(1029),bc=[];this.UKa={};this.g9=[];this.UKa[Bb]=bc;const tc=B.a.instance.ga(1030),Zc=[];this.g9.push(Bb);this.g9.push(tc);for(let Ld=0,ae=this.qT.length;Ld<
ae;Ld++){Bb=this.qT[Ld];Bb.IsCompatibility||Zc.push(Bb);var wd=Bb.NameUI;const ne=Bb.NameDataStrings;this.yfd[ne.toUpperCase()]||(this.yfd[ne.toUpperCase()]=Bb);this.zfd[wd.toUpperCase()]||(this.zfd[wd.toUpperCase()]=Bb);if(!this.Yic(Bb)){if(Ha){wd=Bb.GroupUI;let xe=Ud.a.Ec(this.UKa,wd);xe||(xe=[],this.UKa[wd]=xe,this.g9.push(wd));xe.push(Bb)}Bb.IsCommonlyUsed&&bc.push(Bb);Bb.IsCompatibility||this.gxg.push(ne)}}this.UKa[tc]=Zc;Ha&&(ze.hVf(bc,[2,3,0,5,4,9,1,7,8,6]),bc=Array(14),bc[0]=0,bc[1]=1,bc[2]=
7,bc[3]=11,bc[4]=5,bc[5]=2,bc[6]=6,bc[7]=10,bc[8]=9,bc[9]=3,bc[10]=4,bc[11]=13,bc[12]=12,bc[13]=8,ze.hVf(this.g9,bc),bc=[],bc.push(...this.g9),bc.splice(13,1),this.g9=bc);bc=(Ld,ae)=>Ld.NameUI.localeCompare(ae.NameUI);this.qT=[...this.qT];this.qT.sort((Ld,ae)=>Ld.NameDataStrings.localeCompare(ae.NameDataStrings));for(let Ld=1,ae=this.g9.length;Ld<ae&&Ha;Ld++)this.UKa[this.g9[Ld]].sort(bc);for(let Ld=0,ae=this.qT.length;Ld<ae;Ld++)this.qT[Ld].FunctionIndex=Ld}static hVf(Ha,Bb){const bc=[...Ha];for(let tc=
0;tc<bc.length&&tc<Bb.length;tc++)Ha[tc]=bc[Bb[tc]]}}Object(h.a)(ze,"FunctionInfoManager",ec.a,[629,630,3]);var We=a(240),md=a(95),$b=a(50),$c=a(709);class nd extends md.a{constructor(Ha,Bb,bc,tc=null){super(Ha,tc);this.i4=null;this.gPb=this.QYd=!1;this.offsetParent=this.a8=this.e3a=null;this.zMc=!1;this.RDd=Zc=>this.L6(Zc);this.QDd=Zc=>this.iO(Zc);this.ZCf=Zc=>{const wd=I.HelperMethods.Go(Zc);wd.button===Sys.UI.MouseButton.leftButton&&2===Zc.tb&&(this.Hrd(wd.target)||this.hUa(wd));return!1};this.b$d=
Bb;bc&&(this.QYd=!0,We.a.instance.sa(wb.a.pointerDown,this.ZOe,this.ZCf));this.Pfa=!1}get G9b(){return this.Pfa}get ZOe(){return this.b$d}get Gai(){return this.zMc}dispose(){this.QYd&&(We.a.instance.Ba(wb.a.Mj,this.ZOe,this.ZCf),this.QYd=!1);this.gPb&&(this.gPb=!1,We.a.instance.Ba(wb.a.Rf,this.domElement.ownerDocument.body,this.RDd),We.a.instance.Ba(wb.a.Mj,this.domElement.ownerDocument.body,this.QDd));this.i4=this.b$d=null;super.dispose()}iqe(Ha){this.i4?this.i4.push(Ha):this.i4=[Ha]}Hrd(Ha){if(this.i4)for(let Bb=
0,bc=this.i4.length;Bb<bc;++Bb)if(Ga.DOMElementExtensions.Af(this.i4[Bb],Ha))return!0;return!1}hUa(Ha){this.G9b||(this.Pfa=!0,Oa.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.qth(),We.a.instance.sa(wb.a.Rf,this.domElement.ownerDocument.body,this.RDd),We.a.instance.sa(wb.a.Mj,this.domElement.ownerDocument.body,this.QDd),this.gPb=!0,this.drag(!0,Ha))}drag(Ha,Bb){da.g(Bb);var bc=new $b.a(0,0),tc=new Sys.UI.Point(Bb.clientX,Bb.clientY);
Bb=this.domElement.parentNode;tc=$c.a.Xs(bc,Bb,tc,this.isRtl());Ha?(bc=$c.a.yF(bc,Bb,this.domElement,this.isRtl()),this.e3a=$c.a.iE(tc,bc),this.a8=tc,this.zMc=!1):!this.Gai&&this.Cai(tc,this.a8)&&(this.zMc=!0);bc=$c.a.iE(tc,this.e3a);$c.a.reb(Bb,this.domElement,bc,this.isRtl(),Ha)}Bw(Ha){this.gPb&&(this.gPb=!1,We.a.instance.Ba(wb.a.Rf,this.domElement.ownerDocument.body,this.RDd),We.a.instance.Ba(wb.a.Mj,this.domElement.ownerDocument.body,this.QDd));da.g(Ha);this.Pfa=!1;this.a8=this.e3a=null}L6(Ha){const Bb=
I.HelperMethods.Go(Ha);Bb.button===Sys.UI.MouseButton.leftButton&&2===Ha.tb&&this.Bw(Bb);return!1}iO(Ha){2===Ha.tb&&this.drag(!1,I.HelperMethods.Go(Ha));return!1}Cai(Ha,Bb){return Bb.x<Ha.x-2||Bb.x>Ha.x+2||Bb.y<Ha.y-2||Bb.y>Ha.y+2}qth(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;Ga.DOMElementExtensions.getLocation(this.offsetParent)}}Object(h.a)(nd,"BaseDraggableBehavior",md.a,[]);class Oc extends nd{constructor(Ha,Bb,bc=null,tc=!1){super(Ha,Bb,!1,bc);this.kTa(tc);
this.mj=Oa.a.equals("rtl",Ha.dir,!0)}setVisible(Ha){Ga.DOMElementExtensions.setVisible(this.domElement,Ha);Ha||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.mj}kTa(Ha){const Bb=this.domElement.style;Bb.cursor="move";Bb.position=Ha?"relative":"absolute"}}Object(h.a)(Oc,"FunctionParamBoxDraggableItem",nd,[]);class Gd{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onIsExpandedChange=this.onCardModeChange=null}}Object(h.a)(Gd,"FormulaArgumentAssistanceCallbacks",
null,[]);class Qd{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0;this.showCollapseText=this.isExpanded=!1}}Object(h.a)(Qd,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Ad=a(85),Sd=a(108),Ce=a(152);class we{constructor(Ha){this.Ht=Ha;this.tB=this.wTa=this.Oi=!1;this.onKeyDown=Bb=>!this.tB&&Bb.keyCode===Ad.a.nfa&&Bb.altKey&&Bb.ctrlKey?(this.B3a(),Bb.stopPropagation(),Bb.preventDefault(),!0):!1;this.Nla=Bb=>{if(!this.tB)return!1;if(Bb.eventName===wb.a.Pb){const bc=
Bb.Ca.ctrlKey?1:Bb.Ca.shiftKey?50:10;switch(Bb.Ca.keyCode){case Ad.a.tpa:this.aL(0,-bc);break;case Ad.a.v8:this.aL(0,bc);break;case Ad.a.w8:this.aL(-bc,0);break;case Ad.a.QCa:this.aL(bc,0);break;case Ad.a.JG:case Ad.a.Kh:this.wTa=!0;break;default:return!1}}Bb.eventName===wb.a.Gd&&this.wTa&&this.iN(!0);Bb.Ca.preventDefault();return!0};this.Sza=Bb=>{if(!this.tB)return!1;Bb.Ca.preventDefault();this.iN();return!0};this.onBlur=()=>{if(!this.tB)return!1;this.iN();return!0};this.Ko=Sd.KeyInputManager.instance;
this.pointerInputManager=We.a.instance}la(Ha){(this.root=Ha)&&!this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!0)}detach(){this.root&&this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!1)}B3a(){this.root&&(this.target=this.Ht.lHb("move",!0),this.hYd=this.target.getBoundingClientRect(),this.tB=!0,this.wTa=!1,this.Ss(),this.Tya||this.htb(),this.target.appendChild(this.Tya))}iN(Ha=!1){this.Ht.Xpc(Ha);this.tB=!1;this.jKb();this.YJb();this.hYd=this.target=
void 0}Ss(){this.Ko.capture(this.Nla,null);this.pointerInputManager.Rs(wb.a.pointerDown,this.target,this.Sza,!0);this.target.addEventListener("blur",this.onBlur)}YJb(){this.Ko.releaseCapture();this.pointerInputManager.Ys(wb.a.pointerDown,this.target,this.Sza,!0);this.target.removeEventListener("blur",this.onBlur)}jKb(){var Ha;this.target&&(null===(Ha=this.Tya)||void 0===Ha?void 0:Ha.parentNode)===this.target&&this.target.removeChild(this.Tya)}aL(Ha,Bb){const bc=this.target.getBoundingClientRect();
this.Ht.onMove(Ha+bc.left-this.hYd.left,Bb+bc.top-this.hYd.top)}htb(){this.Tya=Ce.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(h.a)(we,"FormulaAssistanceMoveAdapter",null,[]);var Td=a(277);class he{constructor(Ha){this.Ht=Ha;this.Oi=!1}v5(){return this.Oi&&!!this.uD}nza(Ha){this.uD.style.cursor="grabbing";this.KMj=Ha.clientPoint.x;this.LMj=Ha.clientPoint.y;this.Ht.lHb("drag");return!0}bda(Ha){this.Ht.onMove(Ha.clientPoint.x-this.KMj,Ha.clientPoint.y-this.LMj);
return!0}ada(){this.Bw()}$ca(){this.Bw()}la(Ha){if(this.uD=Ha)this.uD.style.cursor="grab",Td.a.instance.aX(this.uD,this),this.Oi=!0}detach(){this.Oi&&this.uD&&(this.uD.style.cursor="",Td.a.instance.C1(this.uD,this),this.Oi=!1)}Bw(){this.uD.style.cursor="grab";this.Ht.Xpc()}}Object(h.a)(he,"FormulaAssistanceDragAdapter",null,[757]);class ee{constructor(Ha,Bb){this.LKa=Ha;this.formulaAssistanceTelemetryManager=Bb;this.Oi=!1;this.qHa=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");
this.aM={[ge.Drag]:0,[ge.Move]:0};this.oGc=this.LKa.getWindowEdgeBuffer()+1;this.cFb=new we(this);this.Dub=new he(this)}la(Ha,Bb,bc,tc){this.root=Ha;this.render=bc;this.dismiss=tc;this.detach();Bb&&(this.Dub.la(Bb),this.cFb.la(Ha.firstChild),this.Oi=!0)}detach(){this.Oi&&(this.Dub.detach(),this.cFb.detach(),this.Oi=!1);Ga.DOMElementExtensions.tf(this.placeholder)}clear(){this.LKa.setOverrideTarget(void 0);this.detach();this.dLb()}lHb(Ha,Bb=!1){this.aM[Ha]+=1;this.GBc=this.root.firstChild.getBoundingClientRect();
this.placeholder=this.root.cloneNode(!0);Ha=this.placeholder.firstChild;Ha.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Bb&&(this.VQa=document.activeElement,Ha.tabIndex=0,Ha.focus());this.dismiss();return Ha}onMove(Ha,Bb){this.placeholder.firstChild.style.transform=`translate(${Math.min(Math.max(Ha,this.oGc-this.GBc.left),window.innerWidth-this.GBc.right-this.oGc)}px, ${Math.min(Math.max(Bb,this.oGc-this.GBc.top),window.innerHeight-this.GBc.bottom-this.oGc)}px)`}Xpc(Ha=
!0){const Bb=this.placeholder.firstChild.getBoundingClientRect(),bc=this.LKa.getDirectionalHint({top:Bb.top,left:Bb.left});this.LKa.setOverrideTarget({top:1===bc?Bb.bottom:Bb.top,left:Bb.left});this.render();window.requestAnimationFrame(()=>{Ga.DOMElementExtensions.tf(this.placeholder);this.VQa&&(Ha&&this.VQa.focus(),this.VQa=void 0)})}dLb(){const Ha=this.aM[ge.Drag],Bb=this.aM[ge.Move];0<Ha&&(this.formulaAssistanceTelemetryManager.IJ("d"),this.qHa||(this.formulaAssistanceTelemetryManager.$P.argumentAssistanceDragTotalCounter+=
Ha),this.aM[ge.Drag]=0);0<Bb&&(this.formulaAssistanceTelemetryManager.IJ("m"),this.qHa||(this.formulaAssistanceTelemetryManager.$P.argumentAssistanceMoveTotalCounter+=Bb),this.aM[ge.Move]=0)}}Object(h.a)(ee,"FormulaAssistanceDragControl",null,[]);var ge;(function(Ha){Ha.Drag="drag";Ha.Move="move"})(ge||(ge={}));Object(h.b)("FormulaAssistanceDragMode",ge);class re extends Ec.a{constructor(Ha,Bb,bc,tc,Zc,wd,Ld){super(re.XKa(W.a.q5(Ha),W.a.Lhf(),Ld));this.$=Ha;this.zj=Bb;this.functionInfoManager=bc;
this.formulaAssistanceUIControl=tc;this.formulaAssistanceTelemetryManager=Zc;this.pluginScheduler=wd;this.htmlSanitizationHelper=Ld;this.g3a=null;this.$Y=0;this.Rq=null;this.b_c=!1;this.Rla=this.Uo=null;this.zTa=!0;this.KK=!1;this.Vba=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.flf=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=ae=>{this.OQb(ae);1===ae?this.formulaAssistanceTelemetryManager.IJ("c"):
this.formulaAssistanceTelemetryManager.IJ("e")};this.NSa=ae=>{const ne={};ne[y.a.LQ]="ArgumentAssistanceCard";const xe={};xe.FunctionName=ae.functionName;ne[y.a.fdd]=xe;this.$.Xc(802602464,0,8,ne)};this.onDismissClick=()=>{this.zTa=!1;this.mub();this.KK&&this.Ht.clear();0===this.$Y&&this.OQb(1)};this.jg=()=>{this.zTa=!0;this.KK&&this.Ht.clear()};this.ERi=ae=>{ae.button===Sys.UI.MouseButton.leftButton&&ae.target&&(da.g(ae),this.g3a&&this.g3a.hUa(ae))};this.Tt=()=>{void 0!==this.Uo&&null!==this.Uo&&
this.Uo()};this.Mk=W.a.q5(Ha);this.bwi=W.a.Lhf();this.p5=this.Mk&&Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.Mk){this.$Sd();this.Rq=new bd(this.$,this.formulaAssistanceUIControl,0,bb.a.Ted);this.p5&&M.h(this.$).jc.Qm(this.jg);if(this.KK=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!this.formulaAssistanceUIControl)this.Ht=
new ee(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.g3a=new Oc(this.domElement,this.$.dF,void 0,W.a.ON(this.$)),this.Gc.la("mousedown",this.ERi),Ha=$get(v.ufd,this.zj),this.zj.insertBefore(this.domElement,Ha);M.h(this.$).view.qt(this.Tt)}lse(Ha){this.addHandler("FAFunctionNameUpdated",Ha)}VWf(Ha){this.removeHandler("FAFunctionNameUpdated",
Ha)}ete(Ha){this.addHandler("FAParameterSelectionChangedOld",Ha)}sXf(Ha){this.removeHandler("FAParameterSelectionChangedOld",Ha)}dte(Ha){this.addHandler("FAParameterSelectionChanged",Ha)}rXf(Ha){this.removeHandler("FAParameterSelectionChanged",Ha)}set_visible(Ha){this.Mk?Ha||this.mub():Sys.UI.Control.prototype.set_visible.call(this,Ha);return Ha}mub(){this.formulaAssistanceUIControl&&(this.Uo=null,this.KK&&this.Ht.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Rla=null,this.Rq.Hf=
!1)}show(Ha){this.Mk||(this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceRender"]),this.g3a.setVisible(!!Ha),this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceRender"]),this.b_c&&(this.b_c=!1,this.formulaAssistanceTelemetryManager.Rua("argumentAssistanceOverall")))}GOd(){if(!this.p5||this.zTa){this.p5||this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceComputation"]);var Ha=M.h(this.$).Ai,Bb=
{content:Ha.text,caretPosition:Ha.textBox.caretPosition};(this.Vba?this.pluginScheduler.getRequester().argumentAssistance(Bb,0):this.pluginScheduler.requester().argumentAssistance(Bb)).then(bc=>{0===bc.kind?bc.payload?(this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceComputation"]),this.AGj(this.qtc(bc.payload),Ha.textBox.domElement)):this.mub():this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceComputation"],!1);return null})}}update(Ha,Bb,bc,tc){if(!this.Mk&&Ha){this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.b_c=!0;var Zc=this.$.listSeparator;try{var wd=$get(v.wfd,this.zj);const Ld=$get(v.pfd,this.zj);wd.innerText="";Ld.innerText="";const ae=$get(v.i0e,this.zj),ne=Ha.Params.split(v.Acd);wd=[];for(let xe=0,Fe=ae.rows.length;xe<Fe;xe++){const Ke=ae.rows[xe];Ga.DOMElementExtensions.setVisible(Ke,xe<ne.length);let Ja=ne[xe];const Gb=v.q2i+xe+"_",xc=Ha.NameDataStrings;$get(Gb+v.XHb,Ke).innerText=xc;$get(Gb+v.QGd,Ke).innerText=xc;if(Ja){const Tc=ne[xe].split(Zc),td=re.yrd(Tc[Tc.length-
1]),Nd=re.eri(Ha);td&&(Nd&&(2<Tc.length?(Tc[Tc.length-2]+="1",Tc[Tc.length-3]+="1"):n.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",xc,Tc.length.toString(),Bb)),re.iSg(Tc,Nd,Bb,Ha));Ja=Tc.join(Zc.toString()+" ");ne[xe]=Ja;bc<Tc.length?(wd[xe]=Tc[bc],n.ULS.shipAssertTag(537162072,0,!!Tc[bc]&&1<=Tc[bc].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
bc,Tc.length,xc,xe),Tc[bc]=`${"<b>"}${Tc[bc]}${"</b>"}`,Ja=Tc.join(Zc.toString()+" ")):n.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+bc+"currRowParamsArray.Length = "+Tc.length+", current row = "+xe);tc&&n.ULS.sendTraceTag(558474578,0,50,`formula '${xc}', ${Tc.length} params, isElipsis = ${td}, isPairsParamsFormula = ${Nd}, currentParameterIndex = ${Bb}`)}this.bwi?this.htmlSanitizationHelper.ni($get(Gb+v.msc,Ke),"("+(Ja||
"")+")"):$get(Gb+v.msc,Ke).innerHTML="("+(Ja||"")+")"}tc?this.raiseEvent("FAFunctionNameUpdated",new Cb(Ha.NameDataStrings,ne)):this.raiseEvent("FAParameterSelectionChangedOld",new Sb(ne,wd,bc));ae.className=la.a.Swh+(this.functionInfoManager.Yic(Ha)?"-udf":"")}catch(Ld){throw n.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",Ha.NameDataStrings,Bb,Ld),Ld;}this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceComputation"])}}dispose(){this.Mk||
(this.Gc.iD(),X.a.Ia(this.Gc),M.h(this.$).view.fr(this.Tt),X.a.Ia(this.g3a),this.g3a=null);this.Mk&&X.a.Ia(this.Rq);this.p5&&M.h(this.$).jc.fm(this.jg);this.functionInfoManager=this.$=null;super.dispose()}qtc(Ha){const Bb=new Qd;Bb.functionRenderingInfo=Ha;Bb.cardMode=this.$Y;this.gMd(Bb);return Bb}gMd(Ha){Ha.callbacks=new Gd;Ha.callbacks.onHelpLink=this.bid(Ha.functionRenderingInfo);Ha.callbacks.onCardModeChange=this.onCardModeChange;Ha.callbacks.onFeedback=this.NSa;this.p5&&(Ha.callbacks.onDismissClick=
this.onDismissClick)}AGj(Ha,Bb){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceRender"]);const bc={};bc.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(bc);this.Uo=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Bb,Ha,()=>{})};this.Uo();this.xwc();this.Ksc(Ha);this.KK&&this.Ht.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Uo,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Rq.Hf=!0;this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Rua("argumentAssistanceOverall")}}bid(Ha){return()=>{J(this.$,Ha.helpID,Ha.isUDF)}}$Sd(){const Ha=gb.a.get(y.a.Qpb);this.$Y=Ha?parseInt(Ha,10):re.b9c;this.formulaAssistanceTelemetryManager.c4f(this.$Y)}Ksc(Ha){var Bb=Ha.functionRenderingInfo.functionName;this.Rla&&Oa.a.equals(this.Rla,Bb,!0)?(Bb=Eb.a.map(Ha.functionRenderingInfo.signatures,
bc=>{let tc="";0<=bc.signatureParams.activeParam&&bc.signatureParams.activeParam<bc.signatureParams.params.length&&(tc=bc.signatureParams.params[bc.signatureParams.activeParam]);return tc}),this.raiseEvent("FAParameterSelectionChanged",new eb(Bb))):(this.Rla=Bb,Ha=Eb.a.map(Ha.functionRenderingInfo.signatures,bc=>bc.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Cb(Bb,Ha)))}OQb(Ha){this.$Y=Ha;try{gb.a.Uu(y.a.Qpb,Ha.toString(),Lc.AFrame.z1)}catch(Bb){n.ULS.sendTraceTag(537162070,
0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Bb.message}`)}}xwc(){const Ha=this.formulaAssistanceUIControl.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.IJ(Ha)}static yrd(Ha){return Oa.a.contains(Ha,v.V9b,!0)}static eri(Ha){return!!Ha&&Oa.a.u3a(Ha.NameDataStrings,"IFS")}static iSg(Ha,Bb,bc,tc){try{if(!Ha||2>Ha.length)n.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${tc.NameDataStrings}', ${Ha?Ha.length.toString():
"currRowParamsArray == null"} params, isPairsParamsFormula = ${Bb}, currentParameterIndex = ${bc}.`);else{var Zc=Ha.pop().toString();for(let wd=Ha.length-1;wd<bc;wd++){const Ld=Ha[wd].trim();if(Bb){const ae=Ha[wd-1].trim();Ha.push(re.QMh(ae,Ld))}else{const ae=re.eff(Ld);Ha.push(re.K0e(ae))}}Ha.push(Zc)}}catch(wd){throw n.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${tc.NameDataStrings}', ${Ha?Ha.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${Bb}, currentParameterIndex = ${bc}.
Exception: ${wd}`),wd;}}static QMh(Ha,Bb){Ha=re.eff(Ha);const bc=re.V6e(Ha);Bb=re.V6e(Bb);return re.K0e(Ha,!0,!!bc&&!!Bb&&bc!==Bb)}static eff(Ha){var Bb=Ha.match(re.LCd);Ha=Oa.a.trimEnd(Oa.a.trimStart(Ha,v.VLf),v.ULf);if(Bb&&Bb.length){Bb=Bb[Bb.length-1];const bc=Number.parseLocale(Bb)+1;Ha=Ha.replace(Bb,bc.toString())}else Ha=`${Ha}${1}`;return Ha}static K0e(Ha,Bb=!1,bc=!1){let tc="[{0}]";Bb&&(tc=bc?"[{0}":"{0}]");return String.format(tc,Ha)}static V6e(Ha){return(Ha=Ha.match(re.LCd))&&Ha.length?
Ha[0]:null}static XKa(Ha,Bb,bc){if(Ha)return document.createElement("div");Ha=String.format(v.FMf,v.DMf,v.QGd,la.a.uTe,v.XHb,la.a.tTe,v.msc);var tc=String.format(v.FMf,v.EMf,v.QGd,la.a.uTe,v.XHb,la.a.tTe,v.msc);Ha=String.format(v.gLh,v.hLh,la.a.qUe,la.a.suh,x.a.Co,v.i0e,Ha,tc);tc=document.createElement("div");Bb?bc.ni(tc,Ha):tc.innerHTML=Ha;return tc.firstChild}}re.LCd=RegExp("\\d+");re.b9c=0;Object(h.a)(re,"FormulaArgumentAssistanceControlDeprecated",Ec.a,[721]);class Be{constructor(){this.ria=this.uta=
this.vta=!1;this.JLf=40;this.VEe=41;this.t1a=this.tGd=this.uGd=this.YHb=0;this.yCf=!0;this.XEd=!1;this.zZe=this.iRd=-1}}Object(h.a)(Be,"ParseContext",null,[]);var Oe=a(419),gf=a(914),af=a(327);class Ze extends gf.a{constructor(Ha,Bb,bc,tc){super(Ha,Bb);this.formulaAssistanceControl=bc;this.formulaAssistanceTelemetryManager=tc;this.sLf=!1;this.CTa=null;this.Aod=0;this.jJa=this.YIc=null;this.AQ=0;this.oqb=Bb.textBox;this.Mk=W.a.q5(Ha);this.Tgj=Z.EwaSettings.xb()}get TAb(){return Object(Oe.a)(Ua,this.$.rb.dh)}get LK(){return this.formulaAssistanceControl.te}set LK(Ha){this.formulaAssistanceControl.te=
Ha}get Y6a(){return this.eb.Y6a}get Xdi(){var Ha=this.oqb.text;let Bb=!1;if(0>=Ha.length)return Bb;const bc=this.$.Kb.Cc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),tc=M.h(this.$).ha.ra.activeCell.clone();var Zc=Ha.charCodeAt(0);this.jJa="";this.AQ=this.b2g(Ha,this.oqb.caretPosition);Zc=61===Zc&&-1!==this.AQ;if(!Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Zc&&(Bb=!0);else if(Zc){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Zc=
0;for(var wd=this.AQ-1;1<=wd&&!(this.AQ-wd>Ze.mwf);wd--)if(Ze.rze.includes(Ha.charAt(wd))){Zc=wd;break}Zc=Ha.substring(Zc+1,this.AQ);Ha=""!==Zc?this.$.Cb.getItemByName(Zc):null;wd=this.AQ;for(var Ld=this.AQ+1;Ld<=this.eb.textBox.caretPosition;Ld++)if("["===this.eb.text.charAt(Ld))wd=Ld;else break;this.AQ=wd}else{Zc=Ha.lastIndexOf("[");wd=0;for(Ld=Zc-1;1<=Ld&&!(Zc-Ld>Ze.mwf);Ld--)if(Ze.rze.includes(Ha.charAt(Ld))){wd=Ld;break}Zc=Ha.substring(wd+1,Zc);Ha=""!==Zc?this.$.Cb.getItemByName(Zc):null}Ha&&
2===Ha.type?(Bb=!0,this.jJa=Zc):M.h(this.$).Ab.Cj(tc)&&(Bb=!0,this.jJa="")}bc.stop();this.Aod=bc.Bc;n.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.Aod} milliseconds`);return Bb}get key(){return r.a.Dwb}get calcManager(){this.YIc||(this.YIc=this.$.da.Aa(266,!1));return this.YIc}get FVd(){if(null!=this.CTa)return this.CTa;if(!Z.EwaSettings.oa(133))return this.CTa=!1;const Ha=M.h(this.$).ha.ra.activeCell.clone();
if(1!==Ha.Rvf||!Ha.left||M.h(this.$).ha.ra.yjc())return!1;let Bb=this.formulaAssistanceControl.tableManager.Bn(Ha);if(Bb)return this.CTa=!1;--Ha.left;--Ha.right;if(!Ha.Mz)return!1;Bb=this.formulaAssistanceControl.tableManager.Bn(Ha);return this.CTa=!!Bb&&Ha.top===Bb.top&&this.formulaAssistanceControl.tableManager.Kah(Bb,M.h(this.$))}Yh(Ha,Bb){this.formulaAssistanceControl.eb=this.eb;-1470715894!==Bb&&-1231471547!==Bb||!this.mNe()||(this.LK=!1);return super.Yh(Ha,Bb)}gDd(){var Ha=this.Y6a;if(Ha||this.FVd)if(this.formulaAssistanceControl.eb=
this.eb,this.formulaAssistanceTelemetryManager.uqb.formulaAssistanceRequestAttemptedCounter++,this.mNe())if(!Ha&&this.FVd)this.formulaAssistanceControl.oxe();else if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.Xdi){if(Ha=this.$.Kb.Cc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.qxe(),Ha.stop(),this.oqb.text.endsWith("[")&&"["!==this.oqb.text.charAt(this.oqb.text.length-2)){const Bb=""===this.jJa?
this.formulaAssistanceControl.tableManager.Kg:Object(ab.a)(af.a,this.$.Cb.getItemByName(this.jJa));n.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${Bb.Ui} in ${Ha.Bc} ms with cell edit regression time of ${this.Aod} ms and popup visibility - ${this.LK}`)}}else this.formulaAssistanceControl.bqb(),this.sLf&&(this.sLf=this.LK=!1);else this.formulaAssistanceTelemetryManager.uqb.formulaAssistanceRequestOptimizedCounter++;
else this.LK=!1}Th(){this.Tgj||(this.CTa=null,this.FVd&&this.formulaAssistanceControl.f_())}jg(){this.LK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Gwc();this.Mk&&this.NBi()}KJd(Ha,Bb){return this.formulaAssistanceControl.Yh(Ha,Bb)}NBi(){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.saa&&!this.formulaAssistanceControl.Via&&!this.formulaAssistanceControl.Coa&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionImplicitlyCounter++,
this.formulaAssistanceControl.saa=!1);this.formulaAssistanceControl.XI&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter++,this.formulaAssistanceControl.XI=!1);this.formulaAssistanceControl.Coa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.Coa=!1);this.formulaAssistanceControl.bUa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.bUa=!1);this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&
(this.formulaAssistanceTelemetryManager.qK.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1);this.formulaAssistanceControl.oNa&&(this.formulaAssistanceTelemetryManager.qK.isCellContentFormulaCounter++,this.formulaAssistanceControl.oNa=!1)}b2g(Ha,Bb){let bc=0,tc;for(;-1!==bc;)if(bc=Ha.indexOf("[",bc+1),-1!==bc&&bc<Bb&&(tc=Ha.indexOf("]",bc+1),-1===tc||tc>=Bb))return bc;return-1}mNe(){const Ha=this.eb.text,Bb=this.eb.textBox.caretPosition,bc=
this.formulaAssistanceControl.f6,tc=this.formulaAssistanceControl.sca;if(this.LK&&Oa.a.equals(Ha,bc,!0)&&Bb===tc)return!1;this.formulaAssistanceControl.f6=Ha;this.formulaAssistanceControl.sca=Bb;return!0}}Ze.rze=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Ze.mwf=255;Object(h.a)(Ze,"FormulaAutoCompleteListAutoCompleteBehavior",gf.a,[]);var Xa=a(30),qa;(function(Ha){Ha[Ha.function=0]="function";Ha[Ha.field=1]="field";Ha[Ha.definedName=2]="definedName";Ha[Ha.letVariable=3]="letVariable";Ha[Ha.tableColHeaderName=
4]="tableColHeaderName";Ha[Ha.tableSpecialStructRef=5]="tableSpecialStructRef";Ha[Ha.pendingData=6]="pendingData";Ha[Ha.tableNamedObject=7]="tableNamedObject"})(qa||(qa={}));Object(h.b)("ItemType",qa);var xa=a(1094),ob=a(1093);class Ib{constructor(Ha){this.index=Ha}execute(Ha){Ha.push(this.index)}}Object(h.a)(Ib,"AppendIndexOperation",null,[756]);class Zb{execute(){}}Object(h.a)(Zb,"NopIndexOperation",null,[756]);class zc{constructor(Ha,Bb){this.s7i=Ha;this.pyf=Bb}execute(Ha){for(let Bb=0;Bb<Ha.length;Bb++)Ha[Bb]===
this.s7i&&(Ha[Bb]=this.pyf)}}Object(h.a)(zc,"ReplaceIndexOperation",null,[756]);var Mc=a(79);class hd{constructor(Ha,Bb){this.$=Ha;this.items=Bb;this.DNa=W.a.DNa(this.$)}HJe(Ha,Bb){const bc=new Ib(Bb);if(!this.DNa)return bc;Ha=this.gwi(Ha,Bb);return null!=Ha?this.items[Ha].nCb?new zc(Ha,Bb):new Zb:bc}gwi(Ha,Bb){const bc=this.items[Bb];n.ULS.shipAssertTag(537162075,0,!!bc,"Internal error: invalid item index");Ha=Mc.where(Mc.asEnumerable(Ha),tc=>this.items[tc].name===bc.name);return Mc.Ct(Ha)?Mc.first(Ha):
null}}Object(h.a)(hd,"FilterItemOperationFactory",null,[]);var id=a(117),yd=a(840);class Yd{constructor(){this.evaluation=this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(h.a)(Yd,"CompletionItem",null,[]);const cc=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${x.a.Co}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${x.a.Co}'>{5}</td>\r\n</tr>`,Rc=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${x.a.Co}'></td>\r\n\t<td id='${"item_type_cell"}' class='${x.a.Co}'>{2}</td>\r\n</tr>`,
vd=`<td>\r\n\t<div class='${x.a.fs}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,Zd=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${x.a.Co}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${x.a.Co}'>{2}</td>\r\n</tr>`;class pe extends xa.a{constructor(Ha,Bb,bc,tc,Zc,wd){super(Ha,Bb);this.htmlSanitizationHelper=Zc;this.Pra=null;this.vfb=this.eyc=0;this.usb=null;this.j0e=bc;this.Bwb=tc;this.formulaAssistanceControl=
wd;this.xp=[];this.KW=[];this.Mk=W.a.q5(Ha);this.mpi=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7253303_ReduceInnerHTMLUsageFormulaAutoCompleteListBox")}CYc(Ha){this.addHandler("FLBSelectedRowChanged",Ha)}FNd(Ha){this.removeHandler("FLBSelectedRowChanged",Ha)}R0b(Ha){this.addHandler("ACLBUpdated",Ha)}Kvc(Ha){this.removeHandler("ACLBUpdated",Ha)}get Kkc(){return 0<this.vfb&&this.vfb===this.xp.length}get Dti(){return 0<this.vfb}get te(){return super.te}set te(Ha){super.te=
Ha;Ha||(this.eyc=0,this.ie=null);0===this.eyc?Ga.DOMElementExtensions.setVisible(this.Bwb,Ha&&!this.Mk):Ga.DOMElementExtensions.setVisible(this.Bwb,!1)}get Rj(){return this.Pra}set Rj(Ha){this.kCa(this.Rj);if(Ha){this.j0e.innerText="";this.Pra=Ha;var Bb=this.kCa(this.Rj);const bc=Ha.rowIndex+1,tc=$get("description_cell"+bc,Ha);this.Bwb.innerText=tc.innerText;const Zc=$get("item_type_cell",Ha);this.ie=Bb=Bb.innerText;this.eyc="field"===Zc.innerText?1:"definedName"===Zc.innerText?2:"letVariable"===
Zc.innerText?3:"tableColHeaderName"===Zc.innerText?4:"tableSpecialStructRef"===Zc.innerText?5:"pendingData"===Zc.innerText?6:"tableNamedObject"===Zc.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new ob.a(this.xp.length,bc,Bb,tc.innerText));this.Rxc(Ha)}}get UUa(){return this.Bwb}get wHa(){return this.formulaAssistanceControl}get W0(){return this.eyc}dispose(){super.dispose();this.Pra=this.j0e=this.Bwb=null}rCc(Ha,Bb,bc,tc=0){this.Mk||this.d8(!1);let Zc="";bc&&(Zc+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${la.a.Q6g}'>${bc}</td></tr></table>`);
Zc+=`<table class='${this.k6}' aria-live='off'><tbody>`;const wd=new fc.a;for(let ae=0,ne=this.KW.length;ae<ne;ae++)Zc+=this.j9e(Ha[this.KW[ae]],ae+1,Bb,tc),this.Mk&&wd.add(this.L2e(Ha[this.KW[ae]]));let Ld=this.KW.length;for(let ae=0,ne=this.xp.length;ae<ne;ae++)this.KW.includes(this.xp[ae])||(Ld++,Zc+=this.j9e(Ha[this.xp[ae]],Ld,Bb,tc),this.Mk&&wd.add(this.L2e(Ha[this.xp[ae]])));Zc+="</tbody></table>";this.mpi?this.htmlSanitizationHelper.ni(this.Lf,Zc):this.Lf.innerHTML=Zc;this.Hn=Ga.DOMElementExtensions.nk(this.domElement,
this.k6);this.Mk&&(this.usb=wd.toArray());this.Mk?(this.te=!0,this.wHa.set_visible(!0)):(this.d8(!0),this.fQg(!!bc))}AKa(Ha,Bb,bc,tc="",Zc=0,wd=!1){if(Ha){var Ld=[],ae=[];this.vfb=0;var ne=new hd(this.$,Ha);if(Bb){var xe=!!Bb&&0<Zc,Fe=xe&&91===Bb.charCodeAt(Zc+1)?Zc+2:Zc+1;wd=xe?Bb.length===Fe:!1;xe&&Bb.length===Zc&&Z.EwaSettings.oa(133)&&(wd=!0);var Ke=null;!wd&&xe&&Bb.length>Zc+1&&(Ke=Bb.substring(Fe,Bb.length));if(Bb)for(let Ja=0,Gb=Ha.length;Ja<Gb;Ja++)if(xe=Ha[Ja].name,!Ha[Ja].zmi){Fe=ne.HJe(Ld,
Ja);Ha[Ja].nCb&&this.vfb++;if(!Ke&&!wd||0===Ha[Ja].itemType)({kff:Ld,IOf:ae}=this.IYe(Bb,xe,bc,Fe,Ld,ae));Ke&&1===Ha[Ja].itemType&&({kff:Ld,IOf:ae}=this.IYe(Ke,xe,!0,Fe,Ld,ae));wd&&1===Ha[Ja].itemType&&Fe.execute(Ld)}}else for(bc=0;bc<Ha.length;++bc)if(Ha[bc].nCb||wd)Ke=ne.HJe(Ld,bc),Ke.execute(Ld),Ke.execute(ae),Ha[bc].nCb&&this.vfb++;this.KW=ae;this.xp=Ld;this.rCc(Ha,Bb,tc,Zc)}}a_j(Ha){if(Ha&&!(1<Ha.length)){var Bb=[],bc=[];Bb.push(0);bc.push(0);this.KW=Bb;this.xp=bc;this.rCc(Ha,"","",0)}}Rya(){this.Rj&&
super.Rya()}V$i(Ha,Bb){this.raiseEvent("ACLBUpdated",new ob.a(Ha,void 0,void 0,Bb))}Kkg(Ha){const Bb=this.Hn.rows[Ha];return(!this.Rj||this.Rj!==Bb)&&Ha<this.Hn.rows.length?(this.Rj=Bb,!0):!1}static M2e(Ha){switch(Ha){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(Ha){da.g(Ha.Ca);0===this.W0||2===this.W0||3===this.W0||4===this.W0||5===this.W0||7===this.W0?(this.raiseEvent(yd.a.c6a),this.Rya()):
1===this.W0?this.wHa.mz(!1):(this.wHa.mz(!1),Ha=M.h(this.$),Ha.Xo(!1),Ha.focus());return!0}fQg(Ha){this.zsa();if(Ha){var Bb=this.Hn.offsetWidth+(this.xp.length>this.rI?id.a.Tu:0);Ha=$get("list_column_header");Ha.offsetWidth>Bb&&Ga.DOMElementExtensions.Zv(this.Lf,Ha.offsetWidth);Bb=this.Lf.getElementsByClassName(this.iW);for(let bc=0;bc<Bb.length;bc++)Bb[bc].style.width=I.HelperMethods.uc(Ha.offsetWidth)}}j9e(Ha,Bb,bc,tc){if(1===Ha.itemType){const Zc=Xa.a.rg(Ha.name),wd=Xa.a.rg(tc?bc.substring(tc+
1,bc.length):bc);let Ld=0;Zc.substring(0,wd.length).toLowerCase()!==wd.toLowerCase()&&(Ld=pe.qMj(Zc,v.Vng,wd));bc="";bc=0<=Ld?bc+(Zc.substring(0,Ld)+"<b>"+Zc.substring(Ld,Ld+wd.length)+"</b>"+Zc.substring(Ld+wd.length,Zc.length)):bc+Zc;tc=tc?String.format(vd,x.a.RUe,Xa.a.EK(Ra.a.de(0)),B.a.instance.ga(712)):"";return String.format(Rc,tc,Bb,qa[Ha.itemType],this.iW,bc)}if(5===Ha.itemType)return String.format(Zd,"",Bb,qa[Ha.itemType],this.iW,Xa.a.rg(Ha.name),Xa.a.rg(Ha.Sja));if(4===Ha.itemType)return String.format(Zd,
"(...)",Bb,qa[Ha.itemType],this.iW,Xa.a.rg(Ha.name));if(6===Ha.itemType)return tc=tc?String.format(vd,x.a.RUe,Xa.a.EK(Ra.a.de(0)),B.a.instance.ga(712)):"",String.format(cc,tc,this.iW,Xa.a.rg(Ha.name),Xa.a.rg(Ha.Sja),Bb,qa[Ha.itemType]);tc=String.format(vd,2===Ha.itemType||3===Ha.itemType?x.a.Xzh:x.a.Vzh,Xa.a.EK(Ra.a.de(0)),B.a.instance.ga(709));return String.format(cc,tc,this.iW,Xa.a.rg(Ha.name),Xa.a.rg(Ha.Sja),Bb,qa[Ha.itemType])}L2e(Ha){const Bb=new Yd;Bb.label=Ha.label;Bb.textEdit=Ha.textEdit;
Bb.kind=pe.M2e(Ha.itemType);Bb.type=Ha.nCb?1:0;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===Bb.kind){const bc=this.formulaAssistanceControl.PVh(Ha.label);Bb.detail=bc?bc:Ha.Sja}else Bb.detail=Ha.Sja;return Bb}IYe(Ha,Bb,bc,tc,Zc,wd){Oa.a.equals(Bb,"Pretend this is the line.",!1)&&0<Zc.length||Oa.a.$I(Bb,Ha)?(tc.execute(Zc),tc.execute(wd)):bc&&Ha.length>=v.Nah&&pe.Dlh(Bb,v.Vng,Ha)?tc.execute(Zc):!bc&&Ha.length>=v.Mah&&Oa.a.contains(Bb,Ha,!0)&&tc.execute(Zc);
return{kff:Zc,IOf:wd}}static Dlh(Ha,Bb,bc){for(const tc of Bb)if(Bb=Ha.split(tc),!(2>Bb.length))for(const Zc of Bb)if(Oa.a.$I(Zc,bc))return!0;return!1}static qMj(Ha,Bb,bc){for(const tc of Bb)if(Bb=Ha.toLowerCase().indexOf((tc+bc).toLowerCase()),0<Bb)return Bb+1;return-1}}Object(h.a)(pe,"FormulaAutoCompleteListBox",xa.a,[720]);class Qe{constructor(){this.R9=this._name=null}get name(){return this._name}get toolTip(){return this.R9}}Object(h.a)(Qe,"LETVariableInfo",null,[]);class bf{constructor(){this._name=
null}get name(){return this._name}}Object(h.a)(bf,"TableColHeaderNameInfo",null,[]);class $e{constructor(){this._name=null}get name(){return this._name}}Object(h.a)($e,"TableNamedObjectInfo",null,[]);class tf{constructor(){this.R9=this._name=null}get name(){return this._name}get toolTip(){return this.R9}}Object(h.a)(tf,"TableSpecialStructRefInfo",null,[]);var oe=a(172),jf=a(29),Hf=a(100),Ne=a(911),Xe=a(252),Mf=a(51),Te=a(145);class cb{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=
this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(h.a)(cb,"FormulaAutoCompleteCallbacks",null,[]);class Rb{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(h.a)(Rb,"FormulaAutoCompleteRenderingInfo",null,[]);class uc{}Object(h.a)(uc,"RunExperimentRequest",null,[]);class Kc extends Fc.a{constructor(Ha,Bb,bc,tc,Zc,wd,Ld,ae,ne,xe){super(Ha);this.functionInfoManager=Bb;this.calcManager=tc;this.instantaneousSupportInformationManager=Zc;this.formulaAssistanceUIControl=
Ld;this.formulaAssistanceTelemetryManager=ae;this.pluginScheduler=ne;this.Zfc=!1;this.Y5=this.svd=this.dW=this.Kg=this.xHa=this.Rq=null;this.B7b=this.xPb=this.Bub=this.IOe=this.h4=this.$bc=this.H4a=0;this.rAc=!1;this.ssc=this.uja=null;this.columnName="";this.PBe=this.l9c=!1;this.MKa=[];this.zQ=null;this.JOb=[];this.E8=this.xfd=this.Uo=null;this.Via=this.saa=this.oNa=this.isCellContentOnlyEqualDuringEdit=this.bUa=this.Coa=this.XI=this.ega=!1;this.f6=null;this.sca=0;this.F6d=null;this.YEb=0;this.oqd=
!1;this.onRestoreFocus=()=>{};this.Ahb=void 0;this.Vba=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.flf=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.HBb=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.zld=()=>{this.Mk&&this.raiseEvent(Kc.Aed,null)};this.EYe=()=>{this.uja=!1;this.dW=this.eb.text;this.Yg.AKa(this.xr,this.dW,!0,this.columnName,
void 0,!1);1===this.Yg.xp.length&&1===this.Yg.KW.length?(this.set_visible(!1),this.PBe||this.uod()):this.show()};this.oEd=Fe=>{if(Ed.a(Fe))-315732528!==Fe.Errors[0].MessageId&&n.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${jf.a.sc(Fe.Errors)}`);else if((Fe=Fe.Result)&&Fe.length){this.Kg.gP||(this.Kg.gP={},this.Kg.gP.HeadersList=[]);this.Kg.gP.IsFullTableHeaders=!0;for(let Ke=0;Ke<Fe.length;++Ke)this.Kg.gP.HeadersList[Ke]=
{},this.Kg.gP.HeadersList[Ke].Index=Ke,this.Kg.gP.HeadersList[Ke].Name=Fe[Ke];this.jOf(!0);this.dW=this.i9e();this.Yg.AKa(this.xr,this.dW,!0,void 0,void 0,!0);this.show()}else n.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.nEd=Fe=>{Fe=kb.a.Oe(Fe.data);n.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${jf.a.sc(Fe)}`)};this.gAf=(Fe,Ke)=>
{this.gridView.gb||this.gridView.ji||this.BPa(null===Ke||void 0===Ke?void 0:Ke.cell)};this.Th=(Fe,Ke)=>{this.BPa(null===Ke||void 0===Ke?void 0:Ke.Lja)};this.J6=(Fe,Ke)=>{this.nQd(Ke.newValue)};this.Pc=()=>{(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Mk)&&this.set_visible(!1)};this.iEf=()=>{this.E8=this.xHa=null};this.Gh=()=>{this.Mk&&this.W2a()};this.onFunctionInfoLoaded=()=>{this.bqb()};this.oza=()=>{this.Rka?(this.xHa=this.E8=null,this.bqb()):
this.Wg.al&&this.oxe()};this.dda=()=>{this.zQ&&J(this.$,this.zQ.HelpId,this.zQ.IsDynamicUdf);return!0};this.gda=(Fe,Ke)=>{0==Ke.Kr&&(170==Ke.Sf.operation.operationName&&this.formulaAssistanceTelemetryManager.fmc++,this.$.userOperationManager.oo(this.gda))};this.bQa=(Fe,Ke)=>{0==Ke.Kr&&(12==Ke.Sf.operation.operationName&&this.$.userOperationManager.tr(this.gda),this.$.userOperationManager.oo(this.bQa))};this.W2a=()=>{this.Mk&&this.zxd();Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.XI&&(this.saa=!0);this.PF&&this.eb.gb&&this.vna();this.Uo=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.F2b),this.Rq.Hf=!1);this.oqd=!1};this.eJf=()=>{this.PF&&this.vna();this.P$f();1===this.M2f.type&&Z.EwaSettings.xb()&&!this.eb.text.includes("\n")&&this.EId(this.M2f)};this.onDismiss=()=>{this.te=!1;this.gridView.Ai.textBox.focus()};this.NSa=()=>{const Fe={};Fe[y.a.LQ]=this.Yg.Kkc?"SmartSuggestionsCard":this.Yg.Dti?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";
this.$.Xc(802602464,0,8,Fe)};this.GDd=(Fe,Ke)=>{this.Yg.Kkg(Ke);this.Mk&&(this.CJa=!0)};this.FDd=Fe=>{this.Mk&&(this.zJa=!0);this.PF?(this.iGe(),this.o1f(),this.gridView.Daa.S3f(),this.gridView.Ai.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Fe.textEdit?this.psb(Fe.textEdit):this.mz(!0)};this.Bq=M.h(Ha);this.domElement.className=la.a.dSe;this.Wg=wd.M6c(Ha,bc);this.o8b=new ic(Ha);this.YEg=bc;Kc.Dgc||(Kc.Dgc=Kc.XKa());Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7252767_ReduceInnerHTMLUsageFormulaAssistanceControl")?xe.ni(this.domElement,Kc.Dgc):this.domElement.innerHTML=Kc.Dgc;this.LCd=RegExp("\\d+");Xe.d(this.style,this.$.isChromeRtl);this.Mja=new re(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler,xe);Bb=$get(v.ufd,this.domElement);bc=$get(v.pfd,this.domElement);tc=$get(v.wfd,this.domElement);this.bxg=new pe(this.$,Bb,
tc,bc,xe,this);this.Wg.I0b(this.oza);this.functionInfoManager.OGa(this.onFunctionInfoLoaded);this.functionInfoManager.$Mg(this.iEf);this.F2b=this.domElement;this.Mk&&(this.$.va.Wf(this.Gh),this.Yg.CYc(this.eJf),Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.F2b=document.createElement("div")));this.sUa(!0);this.fdg(!0);this.$.domElement.appendChild(this.F2b);this.FTc=0;(xe=S.a(Ha))&&this.MKa.push(new Ze(Ha,xe,this,this.formulaAssistanceTelemetryManager));
this.MKa.push(new Ze(Ha,this.Bq.Vb,this,this.formulaAssistanceTelemetryManager));this.vwb=this.MKa[0];this.Brb=this.MKa[this.MKa.length-1];Ha.da.Ga(221,this);this.instantaneousSupportInformationManager||this.$.da.fb(268,Fe=>{this.instantaneousSupportInformationManager=Fe});this.YXe=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Z.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.vX.anyPluginInitialized?
n.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):this.formulaAssistanceTelemetryManager.vX.anyPluginInitialized||(this.YEb=Z.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.aUa=W.a.DNa(this.$);this.eFj=W.a.nqb(this.$);this.lCd=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.v0c=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");
W.a.TV(this.$)&&this.ppd();W.a.ON(this.$)&&Bb.classList.add("ewa-fb-refactor");this.Mk?this.gridView.ha.hH(this.Pc):this.gridView.ha.bU(this.Pc);this.Rq=new bd(this.$,this.formulaAssistanceUIControl,1,bb.a.Ved,this.zld);this.Vqd=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.Toi=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1)}jse(Ha){this.addHandler(Kc.afd,Ha)}UWf(Ha){this.removeHandler(Kc.afd,Ha)}hse(Ha){this.addHandler(Kc.Aed,
Ha)}SWf(Ha){this.removeHandler(Kc.Aed,Ha)}ise(Ha){this.addHandler("FormulaAutoCompleteShown",Ha)}TWf(Ha){this.removeHandler("FormulaAutoCompleteShown",Ha)}get qu(){return this.Yg}get xr(){return this.E8}get vMb(){return this.Yg.ie}get e0e(){return this.Yg}get M_e(){return this.Mja}get Yg(){return this.bxg}get p2a(){return this.aUa?this.eb?this.eb.text:null:this.dW}get Alf(){var Ha;return 0===(null===(Ha=this.yZe)||void 0===Ha?void 0:Ha.type)}get Mti(){var Ha;return 1===(null===(Ha=this.yZe)||void 0===
Ha?void 0:Ha.type)}get_visible(){return void 0!==this.Ahb?this.Ahb:this.Ahb=super.get_visible()}set_visible(Ha){if(this.Ahb===Ha)return this.Mk&&!Ha&&this.W2a(),Ha;this.Mja.set_visible(Ha);this.Mk&&!Ha&&this.W2a();Sys.UI.Control.prototype.set_visible.call(this,Ha);return this.Ahb=Ha}get te(){return this.qu.te}set te(Ha){this.Mk&&!Ha&&this.W2a();this.qu.te=Ha}get tableManager(){return this.YEg}get Rka(){return 0<this.KZ}get PF(){return this.ega}get gridView(){return this.Toi?this.Bq:M.h(this.$)}get Ab(){return this.gridView.Ab}k1g(Ha,
Bb){this.te&&(Ha+=v.openParen,Bb++,this.UGd(Ha,Bb));var bc=Bb===Ha.length||Ha.charAt(Bb)===v.closeParen;if(!(0<Bb&&Ha.charAt(Bb-1)===v.openParen&&bc))return n.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${Bb} is invalid. Is cell empty: ${!Ha.length}. Function exists in cell: ${!!this.zQ}`),!1;bc=Ha.substring(0,Bb).lastIndexOf(this.$.listSeparator);const tc=Ha.substring(0,Bb-1).lastIndexOf(v.openParen);Ha=Ha.substring(-1===bc&&-1===tc?1:Math.max(bc,
tc)+1,Bb-1).trim();return this.functionInfoManager.Uhd(Ha)?!0:(n.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.zQ}`),!1)}sii(Ha,Bb){var bc=this.k1g(Ha,Bb);if(!bc||!this.zQ)return n.ULS.shipAssertTag(537162051,0,!bc||bc&&!!this.zQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,lyf:0,AZe:0};bc=this.zQ.Params;bc=bc.replace(RegExp("[\\[\\]]",
"g"),"");const tc=Ha.charAt(Bb-1)===v.openParen,Zc=tc?"":"(",wd=Bb===Ha.length?")":"";var Ld=this.$.listSeparator;Ld=bc.includes(Ld)?bc.indexOf(Ld):bc.length;return{returnValue:Ha.substring(0,Bb)+Zc+bc+wd+Ha.substring(Bb,Ha.length),lyf:tc?Bb:Bb+1,AZe:Ld}}Tt(Ha,Bb){this.Mk&&void 0!==this.Uo&&null!==this.Uo&&this.Uo();this.Mk||super.Tt(Ha,Bb)}get q2b(){return this.F6d}get KZ(){return this.IOe}set KZ(Ha){this.IOe=Ha;Ha||(this.h4=0)}get KEj(){if(null==this.ssc){const Ha=this.$.dc;this.ssc=!!Ha&&!Ha.inEmbedView}return this.ssc}get M2f(){return this.Yg.usb[this.Yg.Rj.rowIndex]}get yZe(){var Ha,
Bb;return null===(Bb=null===(Ha=this.Yg)||void 0===Ha?void 0:Ha.usb)||void 0===Bb?void 0:Bb[0]}get m0e(){!this.xfd&&this.pluginScheduler&&(this.xfd=this.pluginScheduler.getFunctionsShortDescriptions());return this.xfd}dispose(){if(this.$){this.sUa(!1);const Ha=this.gridView;this.$.userOperationManager.oo(this.gda);this.$.userOperationManager.oo(this.bQa);Ha&&(Ha.ha&&(this.Mk?Ha.ha.kG(this.Pc):Ha.ha.iS(this.Pc),W.a.TV(this.$)&&4!==this.YEb&&(this.HBb?Ha.jc.Uk(this.Th):Ha.ha.wna(this.gAf))),Ha.view.fr(this.iqc));
this.Mk&&this.$.va&&this.$.va.Dg(this.Gh)}this.functionInfoManager&&(this.functionInfoManager.$cb(this.onFunctionInfoLoaded),this.functionInfoManager.Iij(this.iEf));this.Wg&&this.Wg.Cvc(this.oza);this.Mk&&this.Yg&&this.Yg.FNd(this.eJf);W.a.Uhc&&this.eb&&this.eb.wKb(this.J6);this.fdg(!1);X.a.Ia(this.Yg);X.a.Ia(this.q2b);X.a.Ia(this.Mja);X.a.Ia(this.Rq);this.eb=this.functionInfoManager=this.Wg=null;X.a.rc(this.MKa);this.Kg=this.E8=this.Mja=this.MKa=null;super.dispose()}Exa(){return!this.xr}Mpi(){return!this.xHa}KXj(Ha){this.Mti&&
1872288872===Ha&&(this.formulaAssistanceTelemetryManager.Cw(["autoCompleteSmartSuggestionActiveDismissing"]),this.Via=!0)}Yh(Ha,Bb){if(!this.Exa()){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.KXj(Bb);if(this.Mk&&this.PF){if(125627505===Bb||267796030===Bb)return this.Mk&&this.wEc(Bb),this.iGe(),this.o1f(),!1;if(1872288872===Bb)return this.vna(),this.te=!1,!0;if(this.Yg.Kkc&&(-798660877===Bb||137938150===Bb))return!1}if(1!==this.Yg.W0||125627505!==Bb&&
267796030!==Bb)if(6===this.Yg.W0){var bc=Ha.keyCode;13!==bc&&9!==bc||this.mz(!1)}else{if(4===this.Yg.W0||5===this.Yg.W0)return super.Yh(Ha,Bb,!0);1===this.Yg.KW.length&&(bc=Ha.keyCode,this.PBe=8===bc||127===bc||46===bc?!0:!1)}else{if(this.mz(!1)&&!this.Rka)return this.gridView.ha.Yh(Ha,Bb);if(125627505===Bb&&this.Rka)return!0}}return super.Yh(Ha,Bb)}Gwc(){this.Wg.wdb();this.E8=null;null==this.uja||this.uja||this.Hmc("NoFieldChosen",1,2,1);this.uja=null;this.KZ=0;this.Y5=this.svd=this.ssc=null}bqb(){this.flf&&
this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceOverall"]);const Ha=!!this.eb&&!dc.f(this.$.na);let Bb=null;Ha&&(Bb=this.eb.text,Bb.startsWith("=")&&(this.oNa=!0,1===Bb.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.eFj&&Ha){const bc={content:Bb,caretPosition:null};(this.Vba?this.pluginScheduler.getRequester().functionSuggestion(bc,0):this.pluginScheduler.requester().functionSuggestion(bc)).then(tc=>{if(0===tc.kind){n.ULS.shipAssertTag(537162050,0,!!tc&&!!tc.payload.items,
"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const Zc=Mc.toArray(Mc.select(Mc.asEnumerable(tc.payload.items),wd=>Kc.y$g(wd)));this.gridView.Daa.eTd(tc.payload,Bb);this.aUa&&(this.JOb=Zc,V.AFrameworkApplication.Og||(this.v0c&&this.Ab.N5(this.gridView.ha.ra.activeCell)?this.formulaAssistanceTelemetryManager.qK.smartSuggestionWouldSuggestInsidePivotCounter++:this.pxe(Ha,!0)))}return null})}this.aUa&&Ha||this.pxe(Ha,!1)}i9e(){if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var Ha=
this.gridView.Vl?this.vwb.AQ:this.Brb.AQ;this.xPb="@"===this.eb.text.charAt(Ha+1)&&this.eb.textBox.caretPosition>Ha+1?Ha+2:Ha+1}else{Ha=this.eb.text.lastIndexOf(v.Wqf);const Bb=this.eb.text.lastIndexOf("[");this.xPb=Ha+1>=Bb?Ha+2:Bb+1}return this.eb.text.substring(this.xPb,this.eb.textBox.caretPosition)}qxe(){this.bag()&&(this.zhh(),this.xr&&(this.uja=!1,this.dW=this.i9e(),this.Yg.AKa(this.xr,this.dW,!0,void 0,void 0,!0),this.show(),Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&
this.Mja.mub()))}oxe(){this.bag()&&(this.q2b&&this.q2b.cancel(),this.Wg.O7a?(this.Exa()&&this.uIe(!0),this.get_visible()?this.EYe():this.F6d=oe.AsyncMethodContext.Dr(this.EYe,v.Zkh,Da.a.eKh,this.q2b)):this.f_())}bag(){return this.eb?0<this.$.rb.WR||!this.eb.text||!this.eb.gb?(this.set_visible(!1),!1):dc.f(this.$.na)?!1:!0:!1}psb(Ha){this.eb&&this.te&&(this.Fpd(this.eb.text,Ha),this.eb.textBox.caretPosition=Ha.range.start.character+Ha.newText.length,this.set_visible(!1))}mz(){var Ha;if(!this.eb||!this.te)return!1;
const Bb=this.Yg.W0;this.formulaAssistanceTelemetryManager.bff(pe.M2e(Bb));let bc="";var tc=0;const Zc=this.gridView;var wd=this.eb.text,Ld=0,ae=this.Yg.ie,ne=!1;if(0===Bb||2===Bb||3===Bb||7===Bb)bc+=wd.substr(0,this.H4a)+this.Yg.ie,0!==Bb||this.Yg.ie.endsWith(")")||(bc+="("),tc=bc.toString().length,bc+=wd.substr(this.$bc),2===Bb&&(Ld=4,ae="DefinedName",ne=!0,this.set_visible(!1));else if(1===Bb)if(this.uja=!0,this.Rka){bc+=wd.substr(0,this.KZ+2);!bc.toString().endsWith(Qa.a.VU)&&Z.EwaSettings.oa(133)&&
(bc+=Qa.a.VU);Ld=this.Yg.ie;Ld=Ld.replace("'","''");Ld=Ld.replace("[","'[");Ld=Ld.replace("]","']");if(this.l9c||this.KFh(Ld))Ld=Qa.a.Kyi+Ld+Qa.a.Rpj,ne=!0;bc+=Ld;tc=bc.length;Ld=3;Te.a("PulloutFieldAccepted")}else return this.eb.text=this.Yg.ie,this.set_visible(!1),Zc.Xo(!1),Zc.focus(),this.Hmc("FieldName",1,1,1),Te.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Bb)n.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),
bc+=wd.substr(0,this.xPb),Oa.a.equals(this.Yg.ie,"@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString,!1)?bc+="@":(bc+=this.Yg.ie,ne=!0,this.set_visible(!1)),tc=bc.length;else if(4===Bb){n.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");bc+=wd.substr(0,this.xPb);ne="";tc=!1;var xe=[39,91,93,64,35];for(let Fe=0;Fe<this.Yg.ie.length;Fe++){const Ke=this.Yg.ie.charCodeAt(Fe);xe.includes(Ke)&&(ne+="'");ne+=
this.Yg.ie.charAt(Fe).toString();tc||Oa.a.isNumeral(Ke)||Oa.a.Tkf(Ke)||(tc=!0)}xe=this.gridView.Vl?this.vwb.AQ:this.Brb.AQ;wd=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===wd.charAt(xe+1)&&tc:wd.lastIndexOf(v.Wqf)+1>=wd.lastIndexOf("[")&&tc;bc+=wd?"["+ne+"]":ne;ne=!0;this.set_visible(!1);tc=bc.toString().length}else if(6===Bb)bc+=wd.substr(0,this.Bub);else return n.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),
!1;this.eb.text=bc;this.eb.textBox.caretPosition=tc;this.eb.Txa()&&(null===(Ha=Zc.hs)||void 0===Ha?0:Ha.yva)&&Zc.hs.EMb(this.eb.text,this.eb.textBox.caretPosition,this.eb.textBox.caretPosition,this.eb.textBox.Ry.length);Zc.Vl&&(Ha=Zc.Vb,Ha.text=this.eb.text,Ha.setCaretPosition(this.eb.textBox.caretPosition));ae=(null==this.uja?0:this.uja)?"FieldName":ae;this.Yg.Rj.sectionRowIndex>=this.Yg.KW.length?this.Hmc(ae,4,Ld,0):this.Hmc(ae,1,Ld,0);ne||(5===Bb||4===Bb?this.qxe():Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7386867_dontShowAutocompleteAfterCommitingTableName")&&
7===Bb?this.set_visible(!1):this.bqb());return!0}f_(Ha=null,Bb=null){Ha?(this.Wg.wdb(),this.Wg.f_(Ha,!1,!1,Bb)):(Ha=this.gridView,Ha.ha.ra.Pg&&(Ha=Na.v(Ha.ha.ra.ed,this.$),this.Wg.f_(Ha,!0,!0,Bb)))}vna(){this.ega=!1;this.eb.NNe()}PVh(Ha){Ha=this.calcManager.getWorksheetFuncId(Ha);return this.m0e?this.m0e.descriptionsMap.get(Ha):null}uIe(Ha){if(this.Mpi()){if(this.Wg.O7a&&this.Wg.al&&(!this.Wg.al.length||!this.Wg.al[0].FieldInfoDataList))return;this.WXj(Ha)}Ha=Mc.asEnumerable(this.xHa);Ha=Mc.concat(Ha,
this.VXh(this.eb.text));Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Mk&&(Ha=Mc.concat(Ha,this.cZh()));Mc.OBc(Ha,Bb=>Bb.name,new Ne.a);this.aUa&&(Ha=Mc.concat(Mc.asEnumerable(this.JOb),Ha),Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.JOb.length?(this.XI||this.formulaAssistanceTelemetryManager.XB(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.XI=!0):this.XI&&
this.Alf&&(this.saa=!0):0<this.JOb.length&&(this.XI=!0),this.JOb=[]);this.E8=Mc.toArray(Ha)}zhh(){var Ha=this.eb.text;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var Bb=this.gridView.Vl?this.vwb.jJa:this.Brb.jJa,bc=!0;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==Bb&&(this.Kg=Object(ab.a)(af.a,this.$.Cb.getItemByName(Bb))),this.Kg||(this.Kg=this.tableManager.Kg,bc=!1),!this.Kg){n.ULS.sendTraceTag(527234895,
0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");return}}else this.Kg=Object(ab.a)(af.a,this.$.Cb.getItemByName(Bb)),this.Kg||(this.Kg=this.tableManager.Kg,bc=!1);this.Kg.gP&&this.Kg.gP.IsFullTableHeaders?this.jOf(bc):Ob.d(this.Kg)?(n.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),
sb.q(this.$.pa.xa,this.Kg.Ui,this.oEd,this.nEd,null,null)):n.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&this.tableManager.Kg)if(Bb=this.calcManager.V5a(this.tableManager.Kg))if(this.calcManager.iue(this.tableManager.Kg,Bb)){Ha=Mc.empty();if(91===this.eb.text.charCodeAt(this.eb.text.length-1)){const tc=this.k2a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);
Ha=Mc.concat(Ha,(bc=new fc.a,bc.add(tc),bc))}Ha=Mc.concat(Ha,Mc.select(Mc.asEnumerable(Bb.toArray()),tc=>{const Zc=new gc,wd=new bf;wd._name=tc.toString();Zc.T6f(wd);return Zc}));this.E8=Mc.toArray(Ha)}else Ha.endsWith("[")&&"["!==Ha.charAt(Ha.length-2)&&n.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${Bb.count} columns for a table with id ${this.tableManager.Kg.Ui} of size ${this.tableManager.Kg.usedRange.right-
this.tableManager.Kg.usedRange.left+1}`);else Ha.endsWith("[")&&"["!==Ha.charAt(Ha.length-2)&&n.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}KFh(Ha){if(!Ha)return!1;let Bb=Ha.charCodeAt(0);if(46===Bb||48<=Bb&&57>=Bb||63===Bb)return!0;for(let bc=0;bc<Ha.length;bc++,Bb=Ha.charCodeAt(bc))if(!((Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
Oa.a.isLetter(Bb):Oa.a.wsd(Bb))||92===Bb||95===Bb||63===Bb||48<=Bb&&57>=Bb))return!0;return!1}UGd(Ha,Bb){let bc=!1,tc=!1;var Zc=!1,wd=0;let Ld=0;this.H4a=0;this.$bc=Bb;this.B7b=1;for(let ae=Bb-1;0<=ae;--ae)switch(Ha.charCodeAt(ae)){case 39:tc=!tc;break;case 34:bc=!bc;break;case 91:++wd;Zc=wd>Ld;break;case 93:++Ld}Zc=Object(La.a)(new Be,{uta:!bc,vta:!tc,ria:!Zc,YHb:1});wd=this.M2i(Ha,Bb,Zc);Bb=this.N2i(Ha,Bb,Zc.uta,Zc.vta,Zc.ria);this.B7b=wd+Bb;if(this.FTc=wd-1)this.rAc=!1;this.zGh(Ha,bc,tc,Zc.tGd,
Zc.uGd)}ppd(){4!==this.YEb&&(this.HBb?this.gridView.jc.Zk(this.Th):this.gridView.ha.sha(this.gAf));const Ha=W.a.vAb()?this.Bq.Ub(null):void 0;this.BPa(Ha);W.a.Uhc&&this.gridView.Ai.XZa(this.J6);Kc.sQd(this.pluginScheduler);this.aUa&&this.G3g()}cFh(){return this.aUa||this.YXe}O2i(){var Ha=this.Y5;if(!this.KEj||!Ha)return this.KZ=0,this.xHa=this.E8=null,!1;Ha=Ha.endsWith(Qa.a.VU);let Bb;if(Z.EwaSettings.oa(133)&&({sheetRange:Bb}=this.nVj(this.Y5.substring(0,this.h4))).returnValue){const bc=this.Y5.substring(0,
this.KZ);if(Ha&&bc!==this.svd)return this.svd=bc,this.KZ=this.Y5.length-(Ha?1:0),this.f_(Bb,this.Y5),this.uja=!1,n.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}VXh(Ha){const Bb=new fc.a;this.calcManager&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&n.ULS.shipAssertTag(537162014,0,!!this.calcManager.Kta(Kb.Range.Qc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.YXe&&
(Ha=this.calcManager.extractLetVariables(Ha,this.eb.textBox.caretPosition)))for(const bc of Ha){Ha=new Qe;Ha._name=bc;Ha.R9=B.a.instance.ga(2213);const tc=new gc;tc.xyj(Ha);Bb.add(tc)}return Bb}cZh(){const Ha=new fc.a,Bb=this.$.Cb.items;for(let tc=0,Zc=Bb.length;tc<Zc;tc++){var bc=Bb[tc];if(!dc.n(bc))continue;const wd=new $e;wd._name=bc.name;bc=new gc;bc.PAj(wd);Ha.add(bc)}return Ha}k2a(Ha){const Bb=new gc,bc=new tf;bc._name=Ha;Bb.QAj(bc);return Bb}jOf(Ha){const Bb=new fc.a,bc=this.eb.text.charCodeAt(this.eb.text.length-
1),tc=this.eb.textBox.caretPosition-1;if(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.eb.text.charCodeAt(tc):91===bc){var Zc=this.k2a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);Bb.add(Zc)}for(var wd of this.Kg.gP.HeadersList){Zc=new gc;const Ld=new bf;Ld._name=wd.Name;Zc.T6f(Ld);Bb.add(Zc)}wd=this.gridView.Vl?this.vwb.AQ:this.Brb.AQ;Zc=this.eb.text.charCodeAt(wd+1);(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
!Ha||tc!==wd&&35!==Zc:!Ha||91!==bc&&35!==bc)||(Ha=this.k2a("#"+this.instantaneousSupportInformationManager.Je.AllStructRefString),Bb.add(Ha),Ha=this.k2a("#"+this.instantaneousSupportInformationManager.Je.DataStructRefString),Bb.add(Ha),Ha=this.k2a("#"+this.instantaneousSupportInformationManager.Je.HeadersStructRefString),Bb.add(Ha),Ha=this.k2a("#"+this.instantaneousSupportInformationManager.Je.TotalsStructRefString),Bb.add(Ha));Bb&&(this.E8=Bb.toArray())}WXj(Ha){let Bb=Mc.empty();!Ha&&this.functionInfoManager.UV&&
(Bb=Mc.concat(Bb,Mc.select(Mc.asEnumerable(this.functionInfoManager.Zbc),bc=>{const tc=new gc;tc.v5f(bc);return tc})),Ha=this.o8b.mMe,0<Ha.length&&(Bb=Mc.OBc(Mc.concat(Bb,Mc.select(Mc.asEnumerable(Ha),bc=>{const tc=new gc;tc.Uwj(bc);return tc})),bc=>bc.name,new Ne.a)));if(this.Wg.O7a&&this.Wg.al){if(!this.Wg.al.length||!this.Wg.al[0].FieldInfoDataList)return;Bb=Mc.OBc(Mc.concat(Bb,Mc.select(Mc.asEnumerable(this.Wg.al[0].FieldInfoDataList),bc=>{const tc=new gc;tc.rxj(bc);return tc})),bc=>bc.name,new Ne.a);
this.columnName=this.Wg.al[0].ColumnName}this.xHa=Mc.toArray(Bb)}BPa(Ha){var Bb;if(1!==this.YEb){var bc=this.gridView.ha.ra.activeCell;if(bc){var tc=this.calcManager.Kta(bc,!this.Vqd);if(tc){var Zc=this.$.va,wd=tc.sheet.index;0>=Zc.count||0>wd||wd>=Zc.count?n.ULS.sendTraceTag(512278611,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Zc.count}, currentSheetIndex = ${wd}.`):(wd=Zc=null,this.lCd&&void 0!==this.calcManager&&null!==this.calcManager&&(Ha=null!==
(Bb=null===Ha||void 0===Ha?void 0:Ha.cell)&&void 0!==Bb?Bb:this.gridView.Da.rs(bc))&&(Bb=this.calcManager.Wdc(Ha.Hj),void 0!==Bb&&null!==Bb&&(Zc=Bb.FormatString,wd=Bb.Builtin)),2!==this.YEb&&(this.pluginScheduler.notifier().setActiveCell({colIndex:tc.range.col,rowIndex:tc.range.row,sheetIndex:this.$.va.getItem(tc.sheet.index).sheetId,docName:tc.sheet.document.name,docPath:tc.sheet.document.path,formatString:Zc,builtIn:wd}),n.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${tc.range.col}, row: ${tc.range.row}, format: ${Zc}`)))}else n.ULS.sendTraceTag(512278612,
0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else n.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}}o1f(){this.formulaAssistanceTelemetryManager.lI={lk:this.gridView.ha.ra.activeCell,m4b:this.gridView.Vb.text,rsb:!0};this.formulaAssistanceTelemetryManager.yDb=this.$.ea.ye;this.formulaAssistanceTelemetryManager.dmc=this.$.va.na.sheetId;this.$.userOperationManager.tr(this.bQa)}G3g(){this.gridView.Vl?
this.vwb.nZ(!1):this.Brb.nZ(!1)}xof(Ha){let Bb;Bb=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Oa.a.isLetter(Ha):Oa.a.wsd(Ha);return 48<=Ha&&57>=Ha||46===Ha||95===Ha||Bb}show(){if(this.xr){var Ha=this.Yg.Kkg(0);this.Mk?0<this.Yg.xp.length?(this.formulaAssistanceTelemetryManager.cff(this.Yg.usb),Ha||this.P$f()):this.W2a():((Ha=0<this.Yg.xp.length)&&this.formulaAssistanceTelemetryManager.XB(["autoCompleteRender"]),!this.te&&this.columnName&&
Ha&&this.Yg.V$i(this.Yg.xp.length,this.columnName),this.te=Ha,this.Mja.show(this.zQ),this.DCa(!0),this.Yg.Rya(),Ha&&this.formulaAssistanceTelemetryManager.Cw(["autoCompleteRender"]))}}N2i(Ha,Bb,bc,tc,Zc){for(bc=Object(La.a)(new Be,{JLf:41,VEe:40,uta:bc,vta:tc,ria:Zc});Bb<Ha.length&&!this.JMf(Ha,Bb,bc);++Bb);return bc.YHb}M2i(Ha,Bb,bc){for(--Bb;0<=Bb&&!this.JMf(Ha,Bb,bc);--Bb);return bc.YHb}JMf(Ha,Bb,bc){const tc=Ha.charCodeAt(Bb);0>=this.h4&&(this.h4=Ha.substring(0,Bb).lastIndexOf(Qa.a.VU));46===
tc&&(Bb<this.h4?this.h4=Bb:Bb>this.Bub&&(this.KZ=this.Bub=Bb));if(!this.xof(tc)&&!Kc.Avi(tc)&&(!this.Rka||Bb<=this.h4||!Kc.xdi(tc,bc))){bc.yCf&&(bc.yCf=!1,this.H4a=Bb+1);if(bc.XEd){bc.uGd=Bb+1;if(this.functionInfoManager.Uhd(Ha.substring(bc.uGd,bc.tGd)))return!0;bc.XEd=!1}switch(tc){case 39:bc.vta=!bc.vta;break;case 34:bc.uta=!bc.uta;break;case 91:bc.ria=!1;break;case 93:bc.ria=!0}tc===this.$.listSeparator.toString().charCodeAt(0)&&bc.vta&&bc.uta&&!bc.t1a&&(!this.Rka||bc.ria)&&(Bb<bc.iRd||-1===bc.iRd)&&
(bc.YHb+=1,this.B7b++);tc===bc.VEe&&bc.uta&&bc.vta&&(!this.Rka||bc.ria)?bc.t1a+=1:tc===bc.JLf&&bc.uta&&bc.vta&&(!this.Rka||bc.ria)?0<bc.t1a?--bc.t1a:(bc.iRd=bc.zZe,bc.zZe=Bb,0<Bb&&this.xof(Ha.charCodeAt(Bb-1))&&(bc.XEd=!0,bc.tGd=Bb)):this.Rka&&46===tc&&Bb>this.h4&&(Bb<this.h4?this.h4=Bb:Bb>this.Bub&&(this.KZ=this.Bub=Bb))}return!1}zGh(Ha,Bb,bc,tc,Zc){this.$bc>this.H4a&&0<=this.H4a?Bb||bc||(this.dW=Ha.substring(this.H4a,this.$bc)):this.dW=null;tc!==Zc?(Ha=Ha.substring(Zc,tc),this.zQ&&Oa.a.equals(this.zQ.NameDataStrings,
Ha,!0)||(this.rAc=!0),this.zQ=this.functionInfoManager.Uhd(Ha)):(this.rAc=!1,this.zQ=null)}fdg(Ha){const Bb=$get(v.DMf+"_"+v.XHb,this.domElement),bc=$get(v.EMf+"_"+v.XHb,this.domElement);Ha&&!this.Zfc?(Bb&&va.a.instance.sa(wb.a.click,Bb,this.dda),bc&&va.a.instance.sa(wb.a.click,bc,this.dda),this.Zfc=!0):this.Zfc&&(Bb&&va.a.instance.Ba(wb.a.click,Bb,this.dda),bc&&va.a.instance.Ba(wb.a.click,bc,this.dda),this.Zfc=!1)}nVj(Ha){let Bb;Bb=null;var bc;if(({sheetName:tc,range:bc}=Na.Z(Ha,this.$.ea.va)).returnValue&&
bc){if(!tc){var tc=Object(ab.a)(Hf.a,this.$.na);if(!tc)return{returnValue:!1,sheetRange:Bb};tc=tc.name}Bb=Na.v(bc,this.$);Bb.SheetName=tc;this.l9c=!1;return{returnValue:!0,sheetRange:Bb}}return({sheetName:tc,range:bc}=this.o8b.XUj(Ha)).returnValue?(Bb=Na.v(bc,this.$),Bb.SheetName=tc,this.l9c=!0,{returnValue:!0,sheetRange:Bb}):{returnValue:!1,sheetRange:Bb}}nQd(Ha){Ha={content:Ha,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Vba?this.pluginScheduler.getRequester().runAuthoringExperiment(Ha,
0):this.pluginScheduler.requester().runAuthoringExperiment(Ha)}uod(){if(1===this.Yg.KW.length&&this.xr.length){var Ha=this.xr[this.Yg.KW[0]];if(1===Ha.itemType){var Bb=Ha.name;Ha=this.eb.text;Bb=Bb.substring(Ha.length,Bb.length);Bb.length&&(this.eb.text=Ha+Bb,this.eb.textBox.selectRange(Ha.length,this.eb.text.length))}}else n.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.Yg.KW.length})`)}Hmc(Ha,Bb,bc,tc){const Zc={};Zc.a=Ha;
Zc.b=Bb;Zc.c=bc;Zc.d=tc;Mf.b().Qe(38,Zc,!0)}pxe(Ha,Bb){if(!this.functionInfoManager.UV){if(Ha)if(this.UGd(this.eb.text,this.eb.textBox.caretPosition),this.aUa||this.dW){const bc={};bc.Filter=this.dW?this.dW.charAt(0).toString():"";bc.FilterType=1;bc.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.XJa(bc)}else Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!Bb)return}0<this.$.rb.WR||this.eb&&!this.eb.gb?
this.set_visible(!1):Ha&&(this.UGd(this.eb.text,this.eb.textBox.caretPosition),this.Mja.update(this.zQ,this.B7b,this.FTc,this.rAc),this.Y5=this.eb.text.substring(1,this.eb.textBox.caretPosition),this.h4=this.Y5.indexOf(Qa.a.VU),this.KZ=this.Y5.lastIndexOf(Qa.a.VU),this.O2i()?(Ha=new gc,Ha.ozj(),this.xHa=this.E8=Ha=[Ha],this.Yg.a_j(Ha),this.show()):((this.cFh()||this.Exa())&&this.uIe(!1),0<this.KZ?this.Yg.AKa(this.xr,this.Y5,!1,void 0,this.Y5.lastIndexOf(Qa.a.VU),!1):this.Yg.AKa(this.xr,this.dW,!1,
void 0,this.KZ,!1),this.show(),this.Mk&&(this.Yg.xp.length||this.gridView.Ai.qL?this.Mja.mub():(this.Mja.GOd(),this.Mk&&this.W2a()))))}P$f(){if(0<this.Yg.xp.length){this.formulaAssistanceTelemetryManager.XB(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const Ha={};Ha.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(Ha);this.Uo=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.F2b,this.gridView.Ai.textBox.domElement,this.qdc(),()=>{})};this.Uo();this.Mk&&
this.Yg.Kkc&&this.raiseEvent(Kc.afd,null);this.oqd||this.Yg.Kkc||this.raiseEvent("FormulaAutoCompleteShown");this.oqd=this.Rq.Hf=!0}this.formulaAssistanceTelemetryManager.Cw(["autoCompleteRender"]);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.XI&&this.Alf&&(this.saa=!0)}}zxd(){this.BJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByArrowKeyCounter++,this.BJa=!1);this.CJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByMouseHoverCounter++,this.CJa=
!1);this.AJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByTabKeyCounter++,this.AJa=!1);this.yJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByEnterKeyCounter++,this.yJa=!1);this.zJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByMouseClickCounter++,this.zJa=!1);Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.Via&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionExplicitlyCounter++,this.Via=!1)}qdc(){const Ha=new Rb;Ha.completionItems=
this.Yg.usb;Ha.activeItemIndex=this.Yg.Rj?this.Yg.Rj.rowIndex:-1;this.bMd(Ha);return Ha}bMd(Ha){Ha.callbacks=new cb;Ha.callbacks.onCompletionItemSelected=this.GDd;Ha.callbacks.onCompletionItemCommitted=this.FDd;Ha.callbacks.onFeedback=this.NSa;Ha.callbacks.onDismiss=this.onDismiss;Ha.callbacks.onRestoreFocus=this.onRestoreFocus}EId(Ha){this.ega=!0;const Bb=Ha.textEdit.newText;this.eb.jfb(Bb.substring(this.eb.text.length-Ha.textEdit.range.start.character,Bb.length))}iGe(){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.Cw(["autoCompleteSmartSuggestionAccepted"]);this.mz(!0);this.ega=this.te=!1;this.bUa=this.Coa=!0}Fpd(Ha,Bb){this.eb.text=Ha.substring(0,Bb.range.start.character)+Bb.newText+Ha.substring(Bb.range.end.character,Ha.length);this.gridView.Vl&&(this.gridView.Vb.text=this.eb.text)}static sQd(Ha){Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?Ha.getRequester().runExperiment(new uc,0):Ha.requester().runExperiment(new uc)}static y$g(Ha){const Bb=
gc.ihh(),bc={IsCompatibility:!1};bc.NameDataStrings=Ha.label;bc.Help=Ha.detail;Bb.v5f(bc);Bb.textEdit=Ha.textEdit;return Bb}static XKa(){const Ha=String.format(v.iLh,v.wfd,hb.a.xTe),Bb=String.format(v.eLh,v.ufd,la.a.L$b,x.a.Do,x.a.Co),bc=String.format(v.cLh,v.pfd,la.a.L$b,x.a.Do,la.a.qUe,x.a.Co);return`${Ha}
${Bb}
${bc}`}static Avi(Ha){return 36===Ha||58===Ha||33===Ha||39===Ha||32===Ha}static xdi(Ha,Bb){return 32===Ha||91===Ha||!Bb.ria}}Kc.afd="FACardOpened";Kc.Aed="FAFocusOnSmartSuggestionsCard";Kc.Dgc=null;Object(h.a)(Kc,"FormulaAssistanceControl",Fc.a,[700,632,3,701,702]);class pd{constructor(Ha){this.Ht=Ha;this.tB=this.wTa=this.Oi=!1;this.onKeyDown=Bb=>this.tB||"Space"!==Bb.code&&" "!==Bb.key||!Bb.altKey||!Bb.ctrlKey?!1:(this.B3a(),Bb.stopPropagation(),Bb.preventDefault(),!0);this.Nla=Bb=>{if(!this.tB)return!1;
if(Bb.eventName===wb.a.Pb){const bc=Bb.Ca.ctrlKey?1:Bb.Ca.shiftKey?50:10;switch(Bb.Ca.keyCode){case Ad.a.tpa:this.aL(0,-bc);break;case Ad.a.v8:this.aL(0,bc);break;case Ad.a.w8:this.aL(-bc,0);break;case Ad.a.QCa:this.aL(bc,0);break;case Ad.a.JG:case Ad.a.Kh:this.wTa=!0;break;default:return!1}}Bb.eventName===wb.a.Gd&&this.wTa&&this.iN(!0);Bb.Ca.preventDefault();return!0};this.Sza=Bb=>{if(!this.tB)return!1;Bb.Ca.preventDefault();this.iN();return!0};this.onBlur=()=>{if(!this.tB)return!1;this.iN();return!0};
this.Ko=Sd.KeyInputManager.instance;this.pointerInputManager=We.a.instance}la(Ha){(this.root=Ha)&&!this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!0)}detach(){this.root&&this.Oi&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Oi=!1)}B3a(){this.root&&(this.Ht.lHb("move",!0),this.root.focus(),this.tB=!0,this.wTa=!1,this.Ss(),this.Tya||this.htb(),this.root.appendChild(this.Tya))}iN(Ha=!1){this.tB&&(this.tB=!1,this.Ht.Xpc(Ha),this.jKb(),this.YJb())}Ss(){this.Ko.capture(this.Nla,
null);this.pointerInputManager.Rs(wb.a.pointerDown,this.root,this.Sza,!0);this.root.addEventListener("blur",this.onBlur)}YJb(){this.Ko.releaseCapture();this.pointerInputManager.Ys(wb.a.pointerDown,this.root,this.Sza,!0);this.root.removeEventListener("blur",this.onBlur)}jKb(){var Ha;null===(Ha=this.Tya)||void 0===Ha?void 0:Ha.remove()}aL(Ha,Bb){const bc=this.Ht.getPosition();bc.x+=Ha;bc.y+=Bb;this.Ht.setPosition(bc)}htb(){this.Tya=Ce.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",
!0,"")}}Object(h.a)(pd,"FormulaAssistanceMoveAdapter",null,[]);class xd{constructor(Ha){this.Ht=Ha;this.startOffset={x:0,y:0};this.Lbg=!0;this.Oi=!1;this.a_c=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeArgumentAssistanceDragCursorToMove",!1)}v5(){return this.Oi&&!!this.uD}nza(Ha){this.a_c||(this.uD.style.cursor="grabbing");const Bb=this.Ht.getPosition();this.Lbg=Bb.renderDown;this.startOffset.x=Bb.x-Ha.clientPoint.x;this.startOffset.y=Bb.y-Ha.clientPoint.y;this.Ht.lHb("drag");
return!0}bda(Ha){this.Ht.setPosition({x:Ha.clientPoint.x+this.startOffset.x,y:Ha.clientPoint.y+this.startOffset.y,renderDown:this.Lbg});return!0}ada(){this.Bw()}$ca(){this.Bw()}la(Ha,Bb){this.uD=Bb;this.root=Ha;this.uD&&(this.uD.style.cursor=this.a_c?"move":"grab",Td.a.instance.aX(this.uD,this,!1),this.Oi=!0)}detach(){this.Oi&&this.uD&&(this.uD.style.cursor="",Td.a.instance.C1(this.uD,this),this.Oi=!1)}Bw(){this.a_c||(this.uD.style.cursor="grab")}}Object(h.a)(xd,"FormulaAssistanceDragAdapter",null,
[757]);class Rd{constructor(Ha){this.formulaAssistanceTelemetryManager=Ha;this.Oi=!1;this.qHa=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");this.aM={[ke.Drag]:0,[ke.Move]:0};this.cFb=new pd(this);this.Dub=new xd(this)}get getPosition(){return this.uxg}get setPosition(){return this.ile}la(Ha,Bb,bc,tc){this.uxg=bc;this.ile=tc;this.cFb.la(Ha);this.Dub.la(Ha,Bb);this.Oi=!0}detach(){this.Oi&&(this.Dub.detach(),this.cFb.detach(),this.Oi=!1)}clear(){var Ha;
null===(Ha=this.ile)||void 0===Ha?void 0:Ha.call(this,null);this.detach();this.dLb()}lHb(Ha,Bb=!1){this.aM[Ha]++;Bb&&(this.VQa=document.activeElement)}Xpc(Ha=!0){this.VQa&&(Ha&&this.VQa.focus(),this.VQa=null)}dLb(){const Ha=this.formulaAssistanceTelemetryManager.$P,Bb=this.aM[ke.Drag],bc=this.aM[ke.Move];0<Bb&&(this.formulaAssistanceTelemetryManager.IJ("d"),this.qHa||(Ha.argumentAssistanceDragTotalCounter+=Bb),this.aM[ke.Drag]=0);0<bc&&(this.formulaAssistanceTelemetryManager.IJ("m"),this.qHa||(Ha.argumentAssistanceMoveTotalCounter+=
bc),this.aM[ke.Move]=0)}}Object(h.a)(Rd,"FormulaAssistanceDragControl",null,[]);var ke;(function(Ha){Ha.Drag="drag";Ha.Move="move"})(ke||(ke={}));Object(h.b)("FormulaAssistanceDragMode",ke);class fe extends Ec.a{constructor(Ha,Bb,bc){super(fe.XKa());this.$=Ha;this.formulaAssistanceUIControl=Bb;this.formulaAssistanceTelemetryManager=bc;this.showCollapseText=this.isExpanded=!0;this.$Y=0;this.Rla=this.Uo=this.Rq=null;this.KK=this.mv=!1;this.setPosition=tc=>{this.formulaAssistanceUIControl.setFixedPosition(tc);
this.formulaAssistanceUIControl.updatePosition(0)};this.getPosition=()=>this.formulaAssistanceUIControl.getPosition();this.Pc=()=>{this.visible=!1};this.onCardModeChange=tc=>{this.OQb(tc);this.showCollapseText=!1;1===tc?this.formulaAssistanceTelemetryManager.IJ("c"):this.formulaAssistanceTelemetryManager.IJ("e")};this.onIsExpandedChange=tc=>{this.dkg(tc);this.showCollapseText=!1;tc?this.formulaAssistanceTelemetryManager.IJ("e"):this.formulaAssistanceTelemetryManager.IJ("c")};this.NSa=tc=>{L(this.$,
"ArgumentAssistanceCard",tc.functionName);this.formulaAssistanceTelemetryManager.IJ("gf")};this.Tt=()=>{this.D_?this.formulaAssistanceUIControl.updatePosition(0):void 0!==this.Uo&&null!==this.Uo&&this.Uo()};this.onDismissClick=()=>{this.dismiss();this.raiseEvent("DC");this.D_?(this.KK&&this.Ht.clear(),this.isExpanded&&this.dkg(!1)):(this.KK&&this.z9b.clear(),0===this.$Y&&this.OQb(1))};this.jg=()=>{this.KK&&(this.D_?this.Ht.clear():this.z9b.clear())};this.D_=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",
!1);this.p5=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.$Sd();this.Rq=new bd(this.$,this.formulaAssistanceUIControl,0,bb.a.Ted);this.grid=Object(M.h)(Ha);this.grid.view.qt(this.Tt);this.grid.ha.hH(this.Pc);if(this.KK=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1))this.D_?this.Ht=new Rd(this.formulaAssistanceTelemetryManager):
this.z9b=new ee(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),this.grid.jc.Qm(this.jg);Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}lse(Ha){this.addHandler("FAFunctionNameUpdated",Ha)}VWf(Ha){this.removeHandler("FAFunctionNameUpdated",Ha)}ete(Ha){this.addHandler("FAParameterSelectionChangedOld",Ha)}sXf(Ha){this.removeHandler("FAParameterSelectionChangedOld",Ha)}dte(Ha){this.addHandler("FAParameterSelectionChanged",
Ha)}rXf(Ha){this.removeHandler("FAParameterSelectionChanged",Ha)}EMg(Ha){this.addHandler("DC",Ha)}sij(Ha){this.removeHandler("DC",Ha)}get visible(){return this.mv}set visible(Ha){Ha||this.dismiss();this.mv=Ha}dismiss(){this.mv=!1;this.formulaAssistanceUIControl&&(this.Uo=null,this.KK&&(this.D_?this.Ht.detach():this.z9b.detach()),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Rla=null,this.Rq.Hf=!1)}sJj(Ha,Bb){this.mv=!0;const bc=this.qtc(Ha);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceRender"]);
Ha={};Ha.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(Ha);const tc=()=>{};Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Uo=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Bb,bc,tc)},this.Uo()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Bb,bc,tc);this.xwc();this.Ksc(bc);this.KK&&this.z9b.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Uo,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Rq.Hf=!0;this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Rua("argumentAssistanceOverall")}}show(Ha,Bb){this.D_?this.tJj(Ha):this.sJj(Ha,Bb)}tJj(Ha){this.mv=!0;const Bb=this.qtc(Ha);if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceRender"]);const bc=()=>b(this.$);this.Uo=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
void 0,Bb,bc)};this.Uo();this.xwc();this.Ksc(Bb);this.KK&&this.Ht.la(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.getPosition,this.setPosition);this.Rq.Hf=!0;this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.Rua("argumentAssistanceOverall")}}dispose(){this.$&&this.grid&&(this.grid.ha&&this.grid.ha.kG(this.Pc),this.grid.view.fr(this.Tt),this.KK&&this.grid.jc.fm(this.jg));
X.a.Ia(this.Rq);this.$=null}qtc(Ha){const Bb=new Qd;Bb.functionRenderingInfo=Ha;Bb.showCollapseText=this.showCollapseText;this.D_?Bb.isExpanded=this.isExpanded:Bb.cardMode=this.$Y;this.gMd(Bb);return Bb}gMd(Ha){Ha.callbacks=new Gd;Ha.callbacks.onHelpLink=this.bid(Ha.functionRenderingInfo);this.D_?Ha.callbacks.onIsExpandedChange=this.onIsExpandedChange:Ha.callbacks.onCardModeChange=this.onCardModeChange;Ha.callbacks.onFeedback=this.NSa;this.p5&&(Ha.callbacks.onDismissClick=this.onDismissClick)}bid(Ha){return()=>
{J(this.$,Ha.helpID,Ha.isUDF)}}$Sd(){const Ha=gb.a.get(y.a.Qpb);this.D_?(Ha?(this.isExpanded="false"!==Ha,this.showCollapseText=!1):(this.isExpanded=fe.qkh,this.formulaAssistanceTelemetryManager.b4f()),this.formulaAssistanceTelemetryManager.Tvj(this.isExpanded)):(Ha?(this.$Y=parseInt(Ha,10),this.showCollapseText=!1):(this.$Y=fe.b9c,this.formulaAssistanceTelemetryManager.b4f()),this.formulaAssistanceTelemetryManager.c4f(this.$Y))}Ksc(Ha){var Bb=Ha.functionRenderingInfo.functionName;this.Rla&&Oa.a.equals(this.Rla,
Bb,!0)?(Bb=Eb.a.map(Ha.functionRenderingInfo.signatures,bc=>{let tc="";0<=bc.signatureParams.activeParam&&bc.signatureParams.activeParam<bc.signatureParams.params.length&&(tc=bc.signatureParams.params[bc.signatureParams.activeParam]);return tc}),this.raiseEvent("FAParameterSelectionChanged",new eb(Bb))):(this.Rla=Bb,Ha=Eb.a.map(Ha.functionRenderingInfo.signatures,bc=>bc.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new Cb(Bb,Ha)))}OQb(Ha){this.$Y=Ha;try{gb.a.Uu(y.a.Qpb,
Ha.toString(),Lc.AFrame.z1)}catch(Bb){n.ULS.sendTraceTag(537162074,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Bb.message}`)}}dkg(Ha){this.isExpanded=Ha;try{gb.a.Uu(y.a.Qpb,Ha.toString(),Lc.AFrame.z1)}catch(Bb){n.ULS.sendTraceTag(512267714,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Bb.message}`)}}static XKa(){return document.createElement("div")}xwc(){const Ha=this.getPosition().renderDown?"rd":"ru";this.formulaAssistanceTelemetryManager.IJ(Ha)}}
fe.b9c=0;fe.qkh=!0;Object(h.a)(fe,"FormulaArgumentAssistanceControl",Ec.a,[729]);var Ee;(function(Ha){Ha[Ha.Dismissed=0]="Dismissed";Ha[Ha.Smart=1]="Smart";Ha[Ha.Simple=2]="Simple";Ha[Ha.Mixed=3]="Mixed"})(Ee||(Ee={}));Object(h.b)("UIState",Ee);class nc extends Ec.a{constructor(Ha,Bb,bc){super(nc.XKa());this.$=Ha;this.formulaAssistanceUIControl=Bb;this.formulaAssistanceTelemetryManager=bc;this.Rq=this.eb=this.gridView=null;this.saa=this.Via=this.zJa=this.yJa=this.AJa=this.CJa=this.BJa=!1;this.xr=
null;this.qX=0;this.Uo=null;this.bUa=this.Coa=this.XI=this.ega=this.mv=!1;this.EQb=Ee.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.mv=!1;this.b8a&&this.XI&&this.CNa&&(this.saa=!0);this.zxd();this.PF&&this.eb.gb&&this.vna();this.Uo=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Rq.Hf=!1,this.EQb=Ee.Dismissed)};this.zld=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.gda=(tc,Zc)=>{0==Zc.Kr&&(170==Zc.Sf.operation.operationName&&
this.formulaAssistanceTelemetryManager.fmc++,this.$.userOperationManager.oo(this.gda))};this.bQa=(tc,Zc)=>{0==Zc.Kr&&(12==Zc.Sf.operation.operationName&&this.$.userOperationManager.tr(this.gda),this.$.userOperationManager.oo(this.bQa))};this.aQi=()=>{this.dismiss();this.gridView.Ai.textBox.focus()};this.NSa=()=>{const tc={};tc[y.a.LQ]=this.tLf?"SmartSuggestionsCard":this.xXd?"FunctionAndSmartSuggestionsCard":"SimpleAutoCompleteCard";this.$.Xc(802602464,0,8,tc)};this.jg=()=>{Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartSuggestionSurvey",
!1)&&1===this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter&&this.XI&&this.$.Xc(1073817162,-1,0,null);this.CNa&&this.EQg()};this.GDd=(tc,Zc)=>{this.fhb(Zc);this.CJa=!0};this.Pc=()=>{this.visible=!1};this.FDd=tc=>{this.zJa=!0;this.psb(tc)};this.Gh=()=>{this.dismiss()};this.Tt=()=>{this.D_?this.formulaAssistanceUIControl.updatePosition(1):void 0!==this.Uo&&null!==this.Uo&&this.Uo()};this.gridView=M.h(this.$);this.Rq=new bd(this.$,this.formulaAssistanceUIControl,1,bb.a.Ved,this.zld);
this.gridView.view.qt(this.Tt);this.gridView.ha.hH(this.Pc);this.$.va.Wf(this.Gh);this.CNa=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.D_=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceRedesign",!1)&&Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceUiPosition",!1);this.b8a=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.CNa&&this.gridView.jc.Qm(this.jg);
Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}jse(Ha){this.addHandler("FACardOpened",Ha)}UWf(Ha){this.removeHandler("FACardOpened",Ha)}hse(Ha){this.addHandler("FAFocusOnSmartSuggestionsCard",Ha)}SWf(Ha){this.removeHandler("FAFocusOnSmartSuggestionsCard",Ha)}ise(Ha){this.addHandler("FormulaAutoCompleteShown",Ha)}TWf(Ha){this.removeHandler("FormulaAutoCompleteShown",Ha)}CYc(Ha){this.addHandler("SelectedRowChanged",
Ha)}FNd(Ha){this.removeHandler("SelectedRowChanged",Ha)}R0b(Ha){this.addHandler("ListBoxUpdated",Ha)}Kvc(Ha){this.removeHandler("ListBoxUpdated",Ha)}dispose(){this.$&&(this.$.userOperationManager.oo(this.gda),this.$.userOperationManager.oo(this.bQa),this.gridView&&(this.gridView.ha&&this.gridView.ha.kG(this.Pc),this.gridView.jc&&this.CNa&&this.gridView.jc.fm(this.jg),this.gridView.view.fr(this.Tt)),this.$.va&&this.$.va.Dg(this.Gh));X.a.Ia(this.Rq);this.$=null}rMg(Ha){this.addHandler("CVIC",Ha)}eij(Ha){this.removeHandler("CVIC",
Ha)}get visible(){return this.mv}set visible(Ha){Ha||this.dismiss();this.mv=Ha}get PF(){return this.ega}get xXd(){var Ha,Bb;return 1===(null===(Bb=null===(Ha=this.xr)||void 0===Ha?void 0:Ha.items[0])||void 0===Bb?void 0:Bb.type)}get tLf(){return 1===this.xr.items.length&&this.xXd}Yh(Ha,Bb){if(!this.visible)return!1;this.wEc(Bb);let bc;return(bc=this.R9h(Bb)).Dfc?bc.result:this.oEj(Bb)}Dyb(Ha){if(!this.visible)return!1;let Bb=!1;switch(Ha){case 1872288872:this.PF&&this.vna();this.b8a&&this.xXd&&(this.formulaAssistanceTelemetryManager.Cw(["autoCompleteSmartSuggestionActiveDismissing"]),
this.Via=!0);this.visible=!1;Bb=!0;break;case -798660877:this.fhb(this.iyb(this.qX+1));Bb=!0;break;case 137938150:this.fhb(this.iyb(this.qX-1));Bb=!0;break;case 2091832999:this.fhb(this.iyb(this.qX+8));Bb=!0;break;case 742457698:this.fhb(this.iyb(this.qX-8));Bb=!0;break;case 125627505:case 267796030:this.psb(this.xr.items[this.qX]),Bb=!0}return Bb}show(Ha){this.eb=this.gridView.Ai;this.mv=!0;this.qX=0;this.xr=Ha;0<this.xr.items.length&&(this.render(),this.fhb(this.iyb(this.qX)),this.b8a?this.CNa&&
(1===this.xr.items[0].type?(this.XI||this.formulaAssistanceTelemetryManager.XB(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.XI=!0):this.XI&&(this.saa=!0)):1===this.xr.items[0].type&&this.CNa&&(this.XI=!0));this.formulaAssistanceTelemetryManager.cff(Ha.items)}vna(){this.ega=!1;this.eb.NNe()}oEj(Ha){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(Ha)}R9h(Ha){return this.PF?125627505===Ha||267796030===Ha?(this.psb(this.xr.items[this.qX]),
{Dfc:!0,result:!1}):!this.tLf||-798660877!==Ha&&137938150!==Ha?{Dfc:!1}:{Dfc:!0,result:!1}:{Dfc:!1}}render(){this.formulaAssistanceTelemetryManager.XB(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){if(this.D_){const Ha=()=>b(this.$);this.Uo=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,void 0,this.qdc(),Ha)}}else{const Ha={};Ha.zoomLevel=aa(this.$);this.formulaAssistanceUIControl.updateContext(Ha);this.Uo=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,
this.eb.textBox.domElement,this.qdc(),()=>{})}}this.Uo();this.K$i();this.Rq.Hf=!0;this.vsh()}}vsh(){this.formulaAssistanceTelemetryManager.Cw(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.Rua("autoCompleteOverall");const Ha=this.xr.items.some(bc=>1===bc.type),Bb=this.xr.items.some(bc=>0===bc.type);Ha&&Bb?this.formulaAssistanceTelemetryManager.Rua("autoCompleteOverallSimpleAndSmart"):Ha?this.formulaAssistanceTelemetryManager.Rua("autoCompleteOverallSmartOnly"):Bb&&this.formulaAssistanceTelemetryManager.Rua("autoCompleteOverallSimpleOnly")}K$i(){const Ha=
this.EQb;this.EQb=this.t5h(this.xr.items);Ha!==Ee.Dismissed&&Ha!==Ee.Smart||this.EQb!==Ee.Simple&&this.EQb!==Ee.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}saj(){var Ha;if(0!==this.xr.items.length){var Bb=0<=this.qX?this.qX:0,bc=this.xr.items[Bb];bc={rG:bc.label,description:null!==(Ha=bc.detail)&&void 0!==Ha?Ha:"",selectedIndex:Bb+1,length:this.xr.items.length};this.raiseEvent("SelectedRowChanged",bc)}}psb(Ha){if(this.eb&&this.visible){var Bb=Ha.textEdit;this.Fpd(this.eb.text,Bb);this.eb.textBox.caretPosition=
Bb.range.start.character+Bb.newText.length;this.PF&&(this.ega=!1,this.CNa&&(this.b8a&&this.formulaAssistanceTelemetryManager.Cw(["autoCompleteSmartSuggestionAccepted"]),this.bUa=this.Coa=!0),this.Byj(),this.gridView.Daa.S3f(),this.eb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:Ha.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.bff(Ha.kind)}}Byj(){this.formulaAssistanceTelemetryManager.lI=
{lk:this.gridView.ha.ra.activeCell,m4b:this.gridView.Vb.text,rsb:!0};this.formulaAssistanceTelemetryManager.dmc=this.$.va.na.sheetId;this.formulaAssistanceTelemetryManager.yDb=this.$.ea.ye;this.$.userOperationManager.tr(this.bQa)}EQg(){this.b8a&&this.saa&&!this.Via&&!this.Coa&&(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionImplicitlyCounter++,this.saa=!1);this.XI&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionShownCounter++,this.XI=!1);this.Coa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionSelectedCounter++,
this.Coa=!1);this.bUa&&(this.formulaAssistanceTelemetryManager.qK.smartSuggestionCommittedCounter++,this.bUa=!1)}qdc(){const Ha=new Rb;Ha.completionItems=this.xr.items;Ha.activeItemIndex=this.qX;this.bMd(Ha);return Ha}bMd(Ha){Ha.callbacks=new cb;Ha.callbacks.onCompletionItemSelected=this.GDd;Ha.callbacks.onCompletionItemCommitted=this.FDd;Ha.callbacks.onFeedback=this.NSa;Ha.callbacks.onDismiss=this.aQi;Ha.callbacks.onRestoreFocus=this.onRestoreFocus}EId(Ha){this.ega=!0;const Bb=Ha.textEdit.newText;
this.eb.jfb(Bb.substring(this.eb.text.length-Ha.textEdit.range.start.character,Bb.length))}fhb(Ha){const Bb=this.qX;this.qX=Ha;const bc=this.xr.items[Ha];this.PF&&this.vna();Bb!==Ha&&this.render();1===bc.type&&Z.EwaSettings.xb()&&!this.gridView.Ai.text.includes("\n")&&this.EId(bc);this.saj()}iyb(Ha){return 0>Ha?0:Math.min(Ha,this.xr.items.length-1)}Fpd(Ha,Bb){this.eb.text=Ha.substring(0,Bb.range.start.character)+Bb.newText+Ha.substring(Bb.range.end.character,Ha.length);this.gridView.Vl&&(this.gridView.Vb.text=
this.eb.text)}zxd(){this.BJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByArrowKeyCounter++,this.BJa=!1);this.CJa&&(this.formulaAssistanceTelemetryManager.OJ.selectByMouseHoverCounter++,this.CJa=!1);this.AJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByTabKeyCounter++,this.AJa=!1);this.yJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByEnterKeyCounter++,this.yJa=!1);this.zJa&&(this.formulaAssistanceTelemetryManager.OJ.commitByMouseClickCounter++,this.zJa=!1);this.b8a&&this.Via&&
(this.formulaAssistanceTelemetryManager.OJ.dismissSmartSuggestionExplicitlyCounter++,this.Via=!1)}wEc(Ha){switch(Ha){case -798660877:case 137938150:case 2091832999:case 742457698:this.BJa=!0;break;case 125627505:this.AJa=!0;break;case 267796030:this.yJa=!0}}static XKa(){return document.createElement("div")}t5h(Ha){return Ha.reduce((Bb,bc)=>Bb|=0===bc.type?Ee.Simple:Ee.Smart,Ee.Dismissed)}}Object(h.a)(nc,"FormulaAutoCompleteControl",Ec.a,[728,3,701]);var Sc=a(728);class zb{constructor(Ha,Bb){var bc,
tc;this.Wg=Ha;this.$=Bb;this.vCc=new Map;this.Rfb=null;this.oza=()=>{this.Nac.resolve(this.Wg.al);this.Thg()};this.qEf=()=>{this.Nac.reject(null);this.Thg()};this.jg=()=>{this.Wg.wdb();this.Xvd=null;this.vCc.clear();this.Doe()};this.oEd=(Zc,wd)=>{if(wd!==this.Eqf)n.ULS.sendTraceTag(509678923,0,15,"onGetTableColHeadersSuccess called with a tableName different than the one saved for last request"),this.XBa.reject();else if(Object(Ed.a)(Zc))this.XBa.reject();else{var Ld=Zc.Result;Object(Sc.b)(Ld)&&0!==
Ld.length?(this.vCc.set(wd,Ld),void this.XBa.resolve(Zc.Result)):this.XBa.reject()}};this.nEd=()=>{this.XBa.reject()};null===(tc=null===(bc=M.h(this.$))||void 0===bc?void 0:bc.jc)||void 0===tc?void 0:tc.Qm(this.jg);this.NJj=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(Ha,Bb,bc,tc){const Zc={N$:Ha,JOe:Bb};var wd;if(wd=Object(Sc.b)(this.Xvd))wd=this.Xvd,wd=!(Zc.N$.FirstRow===wd.N$.FirstRow&&Zc.N$.FirstColumn===wd.N$.FirstColumn&&
Zc.N$.LastRow===wd.N$.LastRow&&Zc.N$.LastColumn===wd.N$.LastColumn&&Zc.N$.SheetName===wd.N$.SheetName&&Zc.JOe===wd.JOe);wd&&this.Wg.wdb();this.Xvd=Zc;this.NJj&&this.Wg.O7a||this.Wg.f_(Ha,bc,tc,Bb);this.Nac=new Sc.a;this.Wg.O7a?this.Nac.resolve(this.Wg.al):this.rej();return this.Nac.promise}getTableColHeaders(Ha){if(this.Rfb&&3>=this.Rfb.status&&Ha===this.Eqf)return this.XBa.promise;this.XBa=new Sc.a;if(this.vCc.has(Ha))this.XBa.resolve(this.vCc.get(Ha));else{this.Doe();this.Eqf=Ha;const Bb=this.$.Cb.getItemByName(Ha).Ui;
this.Rfb=Object(sb.q)(this.$.pa.xa,Bb,bc=>this.oEd(bc,Ha),this.nEd,null,null)}return this.XBa.promise}dispose(){var Ha,Bb;null===(Bb=null===(Ha=M.h(this.$))||void 0===Ha?void 0:Ha.jc)||void 0===Bb?void 0:Bb.fm(this.jg)}rej(){this.Wg.I0b(this.oza);this.Wg.bNg(this.qEf)}Thg(){this.Wg.Cvc(this.oza);this.Wg.Kij(this.qEf)}Doe(){Object(Sc.b)(this.Rfb)&&(V.AFrameworkApplication.zd.cu(this.Rfb.tt),this.Rfb=null)}}Object(h.a)(zb,"ServerDataProvider",null,[719]);var Wb=a(324),yc=a(580),Uc=a(346),fd=a(875);
class rb{constructor(Ha){this.GK=this.HK=this.NF=this.OF=!1;this.L_=Ha}}Object(h.a)(rb,"MarqueeRangeData",null,[]);class Ub{constructor(Ha,Bb,bc,tc=!1){this.TZd=Ha;this.OPb=Bb;this.v8a=tc;bc?(this.L_=bc.L_,this.OF=bc.OF,this.NF=bc.NF,this.HK=bc.HK,this.GK=bc.GK):n.ULS.shipAssertTag(510255180,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(h.a)(Ub,"MarqueeMetadata",null,[]);const oc="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class Nc{constructor(Ha,Bb,bc){this.$=Ha;this.pluginScheduler=Bb;this.formulaAssistanceTelemetryManager=bc;this.oof=this.FK=this.Qfb=!1;this.kS=null;this.hza=()=>{this.FK=!1;this.kS=null};this.gridView=M.h(Ha);this.gridView.Vb.Qm(this.hza);this.oof=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7094505_updateFormulaHighlightsTelemetry");this.W8a=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ParenthesesCoupling",!1)}get coloredReferencesManager(){this.zWa||(this.zWa=this.$.da.Aa(281));
return this.zWa}KVj(Ha,Bb,bc){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.Igb(Ha,Bb,bc)}Igb(Ha,Bb,bc){var tc;this.oof&&Ha.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.Qfb||Ha.PF)return!1;const Zc=isNullOrUndefined(Bb)?Ha.text:Bb;if(1>=Zc.length)return this.wkg(Ha,Zc,Object(Sc.b)(Bb));bc=this.E5h(Ha,Bb,bc);bc=null===(tc=this.u5a(Zc,bc))||void 0===tc?void 0:tc.formulaHighlights;if(!bc)return n.ULS.sendTraceTag(512349465,
0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.wkg(Ha,Zc,Object(Sc.b)(Bb));const {hQj:wd,Yaj:Ld,Waj:ae,TFi:ne}=this.BWh(bc,Zc);this.Bzc(Ha,wd,!!Bb);Bb=Ha.textBox.text;if(!Oa.a.equals(Bb,Zc,!1))return n.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Bb.length}], updatedTextLength [${Zc.length}]`),
Bb=Ha.textBox.caretPosition,Ha.textBox.text=Zc,Ha.textBox.caretPosition=Bb,!0;this.Ez(Ld,ae,ne);return this.FK=!0}eFb(Ha,Bb,bc){if(!Ha||!Bb||!bc)return n.ULS.shipAssertTag(512349463,0,!!Ha,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),n.ULS.shipAssertTag(512349462,0,!!Bb,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),n.ULS.shipAssertTag(512349461,0,!!bc,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const tc=Object(ab.a)(Ub,Bb.metadata);
if(!tc)return n.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var Zc=tc.TZd,wd=tc.OPb,Ld=this.gridView.Ab.vrd(bc)?bc.mxb(tc.NF,tc.OF):bc.GLa(tc.NF,tc.OF,tc.GK,tc.HK);if(!Ld)return n.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),!1;const ae=wd.indexOf("!");-1!==ae&&(Ld=wd.substring(0,ae+1)+Ld);if(!Ha.textBox.changeTextInExistingTextPart(Zc,wd,Ld))return n.ULS.shipAssertTag(38926105,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),
!1;tc.OPb=Ld;Zc=!0;for(wd=1;4>=wd;wd++)(Ld=M.h(this.$).qb.Gv(3,wd,Bb.xU))?(Ld.range=bc,Ld.metadata=tc):(n.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),Zc=!1);this.gridView.qb.update(!1,!1);this.gridView.Vl&&(this.gridView.jc.textBox.text=Ha.text);this.gridView.jc.aRa(new Wb.a({XAb:!0}));return Zc}hqi(Ha){if(3!==Ha.Sq)return n.ULS.shipAssertTag(512349457,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),
!1;Ha=Object(ab.a)(Ub,Ha.metadata);return Ha?Ha.L_&&!Ha.v8a:(n.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}UBa(Ha,Bb){n.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+(Bb?"suspending":"resuming")+" colored references");Bb&&this.FK&&(this.FK=!1,this.Ez(null,null),Ha.textBox.$De());this.Qfb=Bb}dispose(){this.gridView&&this.gridView.Vb&&this.gridView.Vb.fm(this.hza)}yzb(Ha){this.formulaAssistanceTelemetryManager.XB(["highlightPreviewRanges"]);
var Bb=this.u5a(Ha,fd.a);if(isNullOrUndefined(Bb))this.gla&&this.Ez(null,null);else{var bc=this.nka(),tc=[],Zc=new Ud.a(!1),wd=[];Bb=Bb.formulaHighlights;for(const Ld of Bb)if(Bb=Ld.kind,0===Bb||2===Bb||1===Bb)Bb=Na.B(Ld.rangeInfo.sharedRange),Object(Sc.b)(Bb)&&(tc.push(new Uc.a(Bb,bc)),this.e_(Bb,Zc,1),wd.push(new Ub(Ld.span.start,Ha.substring(Ld.span.start,Ld.span.end),f(Ld),!0)));this.Ez(tc,Zc,wd);this.formulaAssistanceTelemetryManager.Cw(["highlightPreviewRanges"],!0)}}KZj(Ha,Bb){Ha&&this.formulaAssistanceTelemetryManager.Rbc.formulaHighlightsCounter++;
Bb&&this.formulaAssistanceTelemetryManager.Rbc.parenthesesCouplingCounter++}wkg(Ha,Bb,bc){this.Ez(null,null);if(this.FK){this.FK=!1;const tc=Ha.textBox.caretPosition;Ha.textBox.setPlainText(Bb);Ha.textBox.caretPosition=Math.min(tc,Bb.length);if(bc)return!0}return!1}E5h(Ha,Bb,bc){let tc=bc;Object(Sc.b)(Bb)?Object(Sc.b)(bc)||(tc={index:Bb.length,length:0}):tc=Ha.textBox.selection;return tc}u5a(Ha,Bb){if(this.W8a&&this.psi({content:Ha,selection:Bb}))return this.kS.result;this.formulaAssistanceTelemetryManager.XB(["formulaHighlightsRequest"]);
const bc=this.pluginScheduler.syncRequester().formulaHighlighting({content:Ha,caretPosition:Bb.index,selectionLength:Bb.length});this.W8a&&(this.kS={content:Ha,selection:Bb,result:bc});this.formulaAssistanceTelemetryManager.Cw(["formulaHighlightsRequest"]);return bc}e_(Ha,Bb,bc){let tc=Bb.getItem(Ha.toString());tc||(tc=oc[Bb.count%oc.length],Bb.add(Ha.toString(),tc));return String.format(tc,bc)}ME(Ha,Bb,bc,tc,Zc=null,wd=null){n.ULS.shipAssertTag(512349453,0,bc<=tc,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");
bc<tc&&(Bb=Bb.substring(bc,tc),Ha.push(Object(La.a)(new yc.a,{text:Bb,color:Zc,backgroundColor:wd})))}Ez(Ha,Bb,bc=null){Ha&&Ha.length?(n.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+Ha.length),Ha.reverse(),bc.reverse(),this.gridView.qb.qx(Ha,[3],!0,(tc,Zc)=>{if(tc&&tc.range&&Zc){n.ULS.shipAssertTag(512349448,0,Bb.kb(tc.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${tc.range.toString()}' doesn't exist in the range to color dictionary`);
var wd=this.e_(tc.range,Bb,.1),Ld=this.e_(tc.range,Bb,1);this.$.frame&&this.$.frame.wD&&this.$.frame.wD.MN||(Zc.style.background=wd);Zc.style.borderColor=Ld;bc&&(Zc.setAttribute(y.a.$6a,tc.xU.toString()),tc.metadata=bc[tc.xU])}else n.ULS.shipAssertTag(512349451,0,!!tc,"FormulaHighlightsControl.HighlightRanges: state is null"),n.ULS.shipAssertTag(512349450,0,!!tc.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),n.ULS.shipAssertTag(512349449,0,!!Zc,"FormulaHighlightsControl.HighlightRanges: div is null")})):
(Ha=this.$.Kb.Cc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.qb.Zg([3]),this.gridView.qb.fTa(new Uc.a(null,this.nka()),[3]),Ha.stop())}Bzc(Ha,Bb,bc){const tc=Ha.textBox;tc.HF=!0;var Zc=tc.selection;const wd=Zc.index;Zc=wd+Zc.length;tc.setTextFromTextParts(Bb);Bb=tc.text.length;tc.selectRange(Math.min(wd,Bb),Math.min(Zc,Bb));bc&&Ha.aRa(new Wb.a);tc.HF=!1}aec(){return this.gridView.cr&&this.gridView.cr.dG?this.gridView.cr.dG:this.$.na}nka(){return this.aec().sheetId}BWh(Ha,Bb){const bc=
[],tc=new Ud.a(!1),Zc=[],wd=[],Ld=[];let ae=!1;var ne=!1;let xe=0;const Fe=this.nka();for(const Ke of Ha){this.ME(Zc,Bb,xe,Ke.span.start,null);switch(Ke.kind){case 0:case 1:case 2:Ha=Na.B(Ke.rangeInfo.sharedRange);if(isNullOrUndefined(Ha)){n.ULS.sendTraceTag(512349464,0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${Ke.kind.toString()}`);this.ME(Zc,Bb,Ke.span.start,Ke.span.end,null);break}ne=this.e_(Ha,tc,1);this.ME(Zc,Bb,
Ke.span.start,Ke.span.end,ne);bc.push(new Uc.a(Ha,Fe));wd.push({Start:Ke.span.start,End:Ke.span.end});ne=Zc.length-1;Ld.push(new Ub(ne,Zc[ne].text,f(Ke)));ne=!0;break;case 3:this.ME(Zc,Bb,Ke.span.start,Ke.span.end,null,"rgba(229, 229, 229, 1)"),ae=!0}xe=Ke.span.end}this.ME(Zc,Bb,xe,Bb.length);this.KZj(ne,ae);return{hQj:Zc,Yaj:bc,Waj:tc,TFi:Ld}}psi(Ha){return Object(Sc.b)(this.kS)&&this.kS.content===Ha.content&&this.kS.selection.index===Ha.selection.index&&this.kS.selection.length===Ha.selection.length}}
Object(h.a)(Nc,"FormulaHighlightsControl",null,[718,3]);class ud{constructor(Ha,Bb,bc,tc,Zc,wd,Ld){this.$=Ha;this.functionInfoManager=Bb;this.calcManager=bc;this.pluginScheduler=tc;this.formulaAssistanceUIControl=Zc;this.formulaAssistanceTelemetryManager=wd;this.Wg=Ld;this.zTa=!0;this.oNa=this.isCellContentOnlyEqualDuringEdit=!1;this.f6=null;this.sca=-1;this.DW=0;this.Vba=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.HBb=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",
!1);this.ged=Z.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",!1);this.jFc=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7262196_updateRequestCacheOnAutoCompleteCommit");this.bnf=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7395449_isSendingSchedulerWorkbookClosingNotificationEnabled");this.xc=(ae,ne)=>{ne.If||ne.rrd||this.pluginScheduler.notifier().notifyWorkbookClosing()};this.Sh=(ae,ne)=>{this.gridView.gb||this.gridView.ji||this.BPa(null===ne||void 0===ne?
void 0:ne.cell)};this.Th=(ae,ne)=>{this.BPa(null===ne||void 0===ne?void 0:ne.Lja)};this.onFunctionInfoLoaded=()=>{this.ged||this.functionInfoManager.$cb(this.onFunctionInfoLoaded);this.Hkg();this.bea()};this.HAf=()=>{this.zTa=!1};this.PAf=(ae,ne)=>{var xe=this.eb;ae=xe.text;xe=xe.textBox.caretPosition;0<this.DW&&this.formulaAssistanceTelemetryManager.OJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.XB(["argumentAssistanceComputation","argumentAssistanceOverall"]);ne.shouldRequestAutocompleteOnCommit?
this.$2f(ae,xe):this.GOd(ae,xe)};this.jg=()=>{this.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.qK.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1);this.oNa&&(this.formulaAssistanceTelemetryManager.qK.isCellContentFormulaCounter++,this.oNa=!1);this.zTa=!0;Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.W8b()};this.J6=(ae,ne)=>{this.nQd(ne.newValue)};this.Jj=()=>{this.Bjg()};this.Bjg=()=>{const ae=
this.o8b.mMe;this.pluginScheduler.notifier().setDefinedNamesInfo(ae);n.ULS.sendTraceTag(512278605,0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===ae||void 0===ae?void 0:ae.length} names}`)};this.u5a=(ae,ne)=>{ae=this.pluginScheduler.syncRequester().formulaHighlighting({content:ae,caretPosition:null===ne||void 0===ne?void 0:ne.index,selectionLength:null===ne||void 0===ne?void 0:ne.length});if(isNullOrUndefined(ae)||isNullOrUndefined(ae.formulaHighlights))n.ULS.sendTraceTag(521211933,
0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined(ae)}`);else return ae};this.functionInfoManager=Bb;this.formulaAssistanceUIControl=Zc;this.pluginScheduler=tc;this.gridView=M.h(this.$);this.ulf=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.p5=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.lCd=
Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.v0c=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.ioi=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.ulf&&(this.o8b=new ic(Ha),this.gridView.Da.lw(this.Jj),this.Bjg());this.Hqa=new fe(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.f9=new nc(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);
this.Foi=W.a.oR(Ha);this.EKj=W.a.nqb(Ha);this.hli=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AuthoringPerCharExp",!1);this.Nti=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.x10AutocompleteWrapperPluginIsEnabled",!1);this.Foi&&(this.Iqa=new Nc(this.$,this.pluginScheduler,this.formulaAssistanceTelemetryManager));Ha.da.Ga(464,this);this.calcManager=bc;W.a.TV(this.$)&&this.ppd();this.gridView.jc.Qm(this.jg);this.p5&&this.Hqa.EMg(this.HAf);this.Vqd=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",
!1);this.ged&&(this.functionInfoManager.OGa(this.onFunctionInfoLoaded),this.functionInfoManager.UV?this.Hkg():this.functionInfoManager.XJa({}))}get Oja(){return this.f9}get L_e(){return this.Hqa}get jB(){return this.Iqa}get Hbb(){return this.eb.Kri?1:0}get eb(){return this.gridView.Ai}get Ab(){return this.gridView.Ab}dispose(){if(this.$){const Ha=this.gridView;Ha&&(Ha.ha&&W.a.TV(this.$)&&(this.HBb?Ha.jc.Uk(this.Th):Ha.ha.wna(this.Sh)),this.ulf&&Ha.Da&&Ha.Da.jx(this.Jj));this.bnf&&this.$.tl(this.xc)}this.gridView.jc.fm(this.jg);
this.p5&&this.Hqa.sij(this.HAf);this.f9.eij(this.PAf);this.functionInfoManager&&this.functionInfoManager.$cb(this.onFunctionInfoLoaded);W.a.Uhc&&this.eb&&this.eb.wKb(this.J6);X.a.Ia(this.Hqa);X.a.Ia(this.f9);this.f9=this.Hqa=this.functionInfoManager=this.$=null}gnj(){this.sca=-1;this.f6=null}W8b(){this.f9.visible=!1;this.Hqa.visible=!1}Yh(){this.bea();return!1}bea(){if(!this.eb.qL)if(this.formulaAssistanceTelemetryManager.uqb.formulaAssistanceRequestAttemptedCounter++,this.ZEj()){this.ged||this.functionInfoManager.UV||
(this.functionInfoManager.OGa(this.onFunctionInfoLoaded),this.functionInfoManager.XJa({}));var Ha=this.eb,Bb=Ha.text;Ha=Ha.textBox.caretPosition;Bb.startsWith("=")&&(this.oNa=!0,1===Bb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.p5||this.zTa?(this.formulaAssistanceTelemetryManager.XB("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),
this.$2f(Bb,Ha)):(this.formulaAssistanceTelemetryManager.XB(["autoCompleteComputation","autoCompleteOverall"]),this.Omj(Bb,Ha));this.hli&&this.Tmj(Bb,Ha)}else this.formulaAssistanceTelemetryManager.uqb.formulaAssistanceRequestOptimizedCounter++}$2f(Ha,Bb){const bc=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:Ha,caretPosition:Bb},argumentAssistance:{content:Ha,caretPosition:Bb}});this.DW+=1;this.jFc&&(this.f6=Ha,this.sca=Bb);bc.then(tc=>
{--this.DW;0===tc.kind&&(this.$$e(tc.payload.argumentAssistance),this.Faf(tc.payload.functionSuggestion,Ha));return null})}Omj(Ha,Bb){const bc={content:Ha,caretPosition:Bb};this.jFc&&(this.f6=Ha,this.sca=Bb);Bb=this.Vba?this.pluginScheduler.getRequester().functionSuggestion(bc,this.Hbb):this.pluginScheduler.requester().functionSuggestion(bc);this.DW+=1;Bb.then(tc=>{--this.DW;0===tc.kind&&this.Faf(tc.payload,Ha);return null})}Tmj(Ha,Bb){Bb={content:Ha,caretPosition:Bb,enableAutocompleteWrapperPlugin:this.Nti&&
!this.EKj};this.Vba&&(Bb=this.pluginScheduler.getRequester().runPerCharacterExperiment(Bb,this.Hbb),this.DW+=1,Bb.then(bc=>{--this.DW;if(0===bc.kind)for(const tc of bc.payload.results)0===tc.kind&&this.gridView.Daa.eTd(tc.value,Ha);return null}))}GOd(Ha,Bb){const bc={content:Ha,caretPosition:Bb};this.jFc&&(this.f6=Ha,this.sca=Bb);Ha=this.Vba?this.pluginScheduler.getRequester().argumentAssistance(bc,this.Hbb):this.pluginScheduler.requester().argumentAssistance(bc);this.DW+=1;Ha.then(tc=>{--this.DW;
0===tc.kind&&this.$$e(tc.payload)})}ZEj(){var Ha=this.eb;const Bb=Ha.text;Ha=Ha.textBox.caretPosition;if(this.f9.visible&&Oa.a.equals(Bb,this.f6,!0)&&(!this.ioi||!nb.e(Bb))&&Ha===this.sca)return!1;this.jFc||(this.f6=Bb,this.sca=Ha);return!0}sQd(){this.Vba?this.pluginScheduler.getRequester().runExperiment(new uc,this.Hbb):this.pluginScheduler.requester().runExperiment(new uc)}$$e(Ha){Ha&&this.eb.gb?(this.formulaAssistanceTelemetryManager.Cw(["argumentAssistanceComputation"]),this.Hqa.show(Ha,this.eb.textBox.domElement)):
this.Hqa.dismiss()}Faf(Ha,Bb){Ha&&0<Ha.items.length&&this.eb.gb&&this.eb.text===this.f6?this.v0c&&this.Ab.N5(this.gridView.ha.ra.activeCell)?(this.formulaAssistanceTelemetryManager.qK.smartSuggestionWouldSuggestInsidePivotCounter++,this.f9.dismiss()):(this.formulaAssistanceTelemetryManager.Cw(["autoCompleteComputation"]),this.f9.show(Ha)):this.f9.dismiss();this.gridView.Daa.eTd(Ha,Bb)}nQd(Ha){Ha={content:Ha,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.Vba?this.pluginScheduler.getRequester().runAuthoringExperiment(Ha,
this.Hbb):this.pluginScheduler.requester().runAuthoringExperiment(Ha)}BPa(Ha){var Bb;const bc=this.gridView.ha.ra.activeCell;if(bc){var tc=this.calcManager.Kta(bc,!this.Vqd);if(tc){var Zc=this.$.va,wd=tc.sheet.index;0>=Zc.count||0>wd||wd>=Zc.count?n.ULS.sendTraceTag(512278608,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index. ewaSheetsCount = ${Zc.count}, currentSheetIndex = ${wd}.`):(wd=Zc=null,this.lCd&&void 0!==this.calcManager&&null!==this.calcManager&&(Ha=null!==(Bb=
null===Ha||void 0===Ha?void 0:Ha.cell)&&void 0!==Bb?Bb:this.gridView.Da.rs(bc))&&(Bb=this.calcManager.Wdc(Ha.Hj),void 0!==Bb&&null!==Bb&&(Zc=Bb.FormatString,wd=Bb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:tc.range.col,rowIndex:tc.range.row,sheetIndex:this.$.va.getItem(tc.sheet.index).sheetId,docName:tc.sheet.document.name,docPath:tc.sheet.document.path,formatString:Zc,builtIn:wd}),n.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${tc.range.col}, row: ${tc.range.row}, format: ${Zc}`))}else n.ULS.sendTraceTag(537162002,
0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else n.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}Hkg(){const Ha=this.functionInfoManager.Zbc;this.pluginScheduler.notifier().setFunctionsInfo(Ha);n.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===Ha||void 0===Ha?void 0:Ha.length} functions}`)}ppd(){this.HBb?this.gridView.jc.Zk(this.Th):
this.gridView.ha.sha(this.Sh);const Ha=W.a.vAb()?this.gridView.Ub(null):void 0;this.BPa(Ha);W.a.Uhc&&this.eb.XZa(this.J6);this.sQd();this.f9.rMg(this.PAf);this.pluginScheduler.setServerDataProvider(new zb(this.Wg,this.$));this.bea();this.bnf&&this.$.xj(this.xc)}Igb(Ha,Bb,bc){bc=Object(Sc.b)(Bb)?this.u5a(Bb,Object(Sc.b)(bc)?bc:fd.a):this.u5a(Ha.text,Ha.textBox.selection);return this.Iqa.KVj(Ha,Bb,bc)}}Object(h.a)(ud,"FormulaAssistanceManager",null,[699,3]);a(185);class Lb extends pb.a{constructor(Ha){super();
this.$=Ha;this.Fb()}create(){var Ha=W.a.TV(this.$);const Bb=Z.EwaSettings.oa(349),bc=Z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),tc=W.a.SV(this.$),Zc=this.$.da,wd=l.GetServiceTaskFactory.create(Zc,134,this.ka,this.Ya),Ld=l.GetServiceTaskFactory.Na(this.$.da,12,477,this.Ya);let ae;ae=W.a.q5(this.$)?l.GetServiceTaskFactory.create(this.$.da,449,this.$.ka,1):Y.Task.Ra(null);let ne;ne=W.a.TV(this.$)?l.GetServiceTaskFactory.create(this.$.da,414,this.$.ka,1):Y.Task.Ra(null);
let xe;xe=Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&!tc?l.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):Y.Task.Ra(null);if(bc||Ha){const Fe=l.GetServiceTaskFactory.Na(Zc,266,265,this.Ya),Ke=l.GetServiceTaskFactory.Na(Zc,219,220,this.Ya),Ja=l.GetServiceTaskFactory.Na(Zc,491,492,this.Ya);Ha=[Fe,ne,ae,Ke,Ja,xe];Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&Ha.push(wd,Ld);w.TaskExtensions.za(w.TaskExtensions.Ed(Ha,
this.ka),()=>{const Gb=Zc.Aa(19)||new ze(this.$,ne.result),xc=Ke.result;if(tc){var Tc=Zc.Aa(464);Tc||(Tc=new ud(this.$,Gb,Fe.result,ne.result,ae.result,Ja.result,Ld.result.M6c(this.$,wd.result)),xc.z_c(Tc.L_e),xc.A_c(Tc.Oja),xc.B_c(Tc.Oja))}else Tc=Zc.Aa(221),Tc||(Tc=new Kc(this.$,Gb,wd.result,Fe.result,null,Ld.result,ae.result,Ja.result,ne.result,xe.result),xc.z_c(Tc.M_e),xc.B_c(Tc.e0e),xc.A_c(Tc)),Bb&&(Zc.Aa(317)||new Ta(this.$));this.ob(Gb)},this.ka,3)}else{const Fe=l.GetServiceTaskFactory.Na(Zc,
219,220,this.Ya),Ke=l.GetServiceTaskFactory.Na(Zc,491,492,this.Ya);Ha=[Fe,ae,ne,xe];Z.EwaSettings.isChangeGateEnabled("OfficeVSO:7252917_FunctionInfoManagerFactoryInvalidOperationFix")&&Ha.push(wd,Ld,Ke);w.TaskExtensions.za(w.TaskExtensions.Ed(Ha,this.ka),()=>{const Ja=Zc.Aa(19)||new ze(this.$,ne.result),Gb=Fe.result;let xc=Zc.Aa(221);xc||(xc=new Kc(this.$,Ja,wd.result,null,null,Ld.result,ae.result,Ke.result,ne.result,xe.result),Gb.z_c(xc.M_e),Gb.B_c(xc.e0e),Gb.A_c(xc));Bb&&(Zc.Aa(317)||new Ta(this.$));
this.ob(Ja)},this.ka,3)}}static la(Ha){Ha.da.Ga(153,new Lb(Ha))}}Object(h.a)(Lb,"FunctionInfoManagerFactory",pb.a,[]);a.d(E,"a",function(){return pc});const pc=()=>{d.a.Fa(Ha=>{Mb.la(Ha);xb.la(Ha);Lb.la(Ha)})}},1140:function(t,E,a){var c=a(0),b=a(695),e=a(149),f=a(7),d=a(15),h=a(82),m=a(4),l=a(156),w=a(1075),n=a(1073),x=a(720),r=a(5),u=a(464),v=a(561),B=a(76),z=a(58),A=a(910),y=a(131),D=a(40),I=a(188),M=a(60),T=a(48),S=a(752),H=a(138),C=a(37),G=a(116),J=a(208),L=a(92),P=a(71),aa=a(35),U=a(29),K=a(283),
Y=a(1),na=a(184),W=a(13),X=a(63),Aa=a(282),Q=a(21),fa=a(132),Ca=a(774),ia=a(775),Ra=a(124),Ya=a(112),Ga=a(51),da=a(34),Z=a(426);class ha{constructor(){this.Sections=this.Id=null}}Object(c.a)(ha,"AutoFilterMenu",null,[]);class Wa{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(Wa,"MenuItem",null,[]);class ca{constructor(){this.Title=this.MenuItems=this.Id=
null;this.DisplayType=0}}Object(c.a)(ca,"MenuSection",null,[]);class ja{constructor(){this.isSuccess=!1}}Object(c.a)(ja,"ApplyFilterByValueResponse",null,[]);class ua{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(ua,"FilterByValueItem",null,[]);class Za{constructor(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}}Object(c.a)(Za,"GetColorsAndIconsResponse",null,[]);class Pa{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(Pa,"GetFilterByValueItemsResponse",null,[]);class ka{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(ka,"ShowSortFilterMenuParams",null,[]);class ra{constructor(){this.focusShiftOnMenuDismiss=this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=
null}}Object(c.a)(ra,"SortFilterControllerFactoryParams",null,[]);class ba{constructor(){this.top=this.left=0}}Object(c.a)(ba,"TargetPoint",null,[]);var Ua=a(55),Ka=a(185),Oa=a(33),ib=a(157),La=a(227),db=a(8);const Ab=r.a.W9g;class Mb extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateAutoFilterContextMenu",1675506831,1651433993,Ab,!0,!1,"AutoFilterContextMenuRoot",Ub,oc,!1,Nc);this.OZc=this.XUa=this.sheetName=this.ytb=null;this.f4a=this.Wrf=!1;this.X7c=this.ubb=this.$Ke=this.DQa=this.$dc=this.ycd=
this.yfb=this.DIb=null;this.pW=()=>{this.qBc();this.$.ea.Pn(this.pW)};this.rEf=ud=>{this.f4a||fa.b(this.$).vd(y.a.sEf,this.vm(),void 0,!0);var Lb={};this.$.pk(Lb);var pc=this.$.ea.isNamedObjectViewMode;const Ha=z.a.$h(this.OZc);Ha.SheetName=pc?Lb.NamedObjectName:Lb.SheetName;Ha.NamedObjectView=pc;Lb=!!ud.searchText;pc=586;this.f4a&&(Lb&&(Ha.ItemListOptions=this.Obh(ud.searchText),pc=597),fa.b(this.$).vd(y.a.sEf,{["UserOperation"]:pc.toString()},void 0,!0));const Bb=this.hEd(Lb),bc=this.mSi(),tc=this.$.pa.xa.Wb();
this.$Ke=tc.RequestId;this.f4a&&this.$dc&&!this.$dc.dequeueUtcTime&&(this.$.userOperationManager.oua(this.$dc),this.F1g());ud=new I.a(pc,0,(Zc,wd,Ld)=>this.X7c=M.n(this.$.pa.xa,Ha,Aa.b(Zc,Bb),this.f4a?Aa.a(wd,bc):wd,Ld,null,tc),80);this.$dc=this.$.userOperationManager.Ic(ud,null);this.ubb=this.X7c;this.DQa=this.$Ke};this.onMenuItemClick=(ud,Lb,pc)=>{fa.b(this.$).vd(y.a.fXi,this.vm(),void 0,!0);Lb={["CommandValueId"]:Lb,["MenuItemId"]:Lb,["InputMethod"]:pc,["TopCellAddress"]:this.XUa};const Ha=new L.a(ud,
pc,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb(Ha,Lb);d.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${ud}, ${pc}`)};this.focusShiftOnMenuDismiss=()=>{Q.h(this.$).focus()};this.EAf=ud=>{if(ud.checkedItems&&ud.checkedItems.length){fa.b(this.$).vd(y.a.FAf,this.vm(),void 0,!0);var Lb=z.a.$h(this.OZc),pc={};this.$.pk(pc);pc.FirstRow=0;pc.FirstColumn=Lb.Column;var Ha=this.$.ea.isNamedObjectViewMode;Lb.NamedObjectView=Ha;Lb.SheetName=Ha?pc.NamedObjectName:pc.SheetName;var Bb=
Zc=>{if(Ca.a.tAc(Zc)){const wd=Ca.a.wcc(Zc);this.QNa?Ca.a.RRa(ia.a.applyItemFilter,wd.MessageIdName,Ya.a.yHa,!0,Ca.a.isSessionEndingError(wd.MessageId)):d.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${wd.MessageIdName}`)}K.a(Zc)||(d.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),fa.b(this.$).vd(y.a.lEf,this.vm(),void 0,!0),Zc=Object(f.a)(new ja,{isSuccess:!0}),this.yfb.onApplyFilterByValueFinish(Zc),
this.PS(this.XUa))},bc=this.y6c(Lb,pc),tc=new I.a(208,0,(Zc,wd,Ld)=>M.a(this.$.pa.xa,bc,ud.checkedItems,Aa.b(Zc,Bb),wd,Ld,null,null),6,()=>new A.a(ud.checkedItems,bc));this.dIj(()=>{this.$.userOperationManager.Ic(tc,null)})}else d.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.Bwe=ud=>{const Lb=D.o(this.XUa,this.$),pc=D.v(this.XUa,this.$);var Ha=Object(f.a)(new w.a,{SortConditionType:ud.type,RowColOffset:Lb.FirstColumn-
pc.FirstColumn,SortColor:ud.color,SortIconSet:ud.icon.IconSet,SortIcon:ud.icon.Icon,IsAscending:!0});Ha=Object(f.a)(new n.a,{OperationType:1,ActiveCell:Lb,SelectedRange:pc,SortConditions:[Ha],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const Bb={};Bb.SortOptions=Ha;Bb.SelectedRange=pc;Bb.OriginalActiveCell=Lb;Bb.ShouldRestoreSelection=!1;Bb.ShouldPromptNamedSheetViewTeachingDialog=!0;d.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${ud.type}`);
this.$.Xc(-1089513346,B.a.Db,19,{["CustomSortCommandData"]:Bb})};this.QNa=Ca.a.pqd();this.Fz=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get ax(){return"PopulateAutoFilterContextMenu"}get PB(){return r.a.iSf}executeCommand(rb,Ub,oc){rb=Ub.command;switch(rb){case 1701016594:return x.a.XDh(oc),Ua.Task.Ra(!0);case 966232027:if(Y.EwaSettings.ll()){const Nc=new l.a;C.TaskExtensions.za(T.GetServiceTaskFactory.Na(this.$.da,8,9,0),ud=>{this.mbf(Ub,oc,ud.result);Nc.setResult(!0)},
this.ka,3).continueWith(()=>{Nc.setResult(!1)},5,this.ka,La.a.instance);return Nc.task}this.mbf(Ub,oc);return Ua.Task.Ra(!0);default:return na.a(rb)}}mbf(rb,Ub,oc){const Nc=Ub.domEvent;if(P.e(Nc.rawEvent)&&(P.g(Nc),Nc.target)){var ud=new H.a(this.$.va);if(ud.Qd(4096)||ud.Qd(2048)){var Lb=z.a.$h(Ub[B.a.ng]);this.Z8f(Lb)&&(this.Wrf?this.gwc(Nc,Nc.target,Lb,rb,oc):(this.DIb=()=>{this.Z8f(Lb)&&(this.Dhi(),this.gwc(Nc,Nc.target,Lb,rb,oc),this.f4a=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",
!1),this.Wrf=!0)},this.qBc()))}}}yc(rb,Ub,oc){if(rb=!!oc)switch(Ub.command){case 1701016594:case 966232027:Y.EwaSettings.ll()||u.a(this.$)||(rb=!1,Ub=Ga.b().tj(Ub.command),d.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${Ub}`));break;default:rb=!1}return rb}MHd(rb){rb.MenuSectionList.push(...this.ytb)}Dhi(){Z.a(()=>{Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.yfb=
sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new ra,{getFilterByValueItemsRequest:this.rEf,applyFilterByValueRequest:this.EAf,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,autoFilterMenuWidth:Mb.N_c,applySortByColorOrIconRequest:this.Bwe})):this.yfb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new ra,{getFilterByValueItemsRequest:this.rEf,applyFilterByValueRequest:this.EAf,onMenuItemClick:this.onMenuItemClick,
autoFilterMenuWidth:Mb.N_c,applySortByColorOrIconRequest:this.Bwe}))});this.ycd=h.a.instance.yg("Common.IExternalUICommandDefinitionMapping")||new v.a(this.$.Eb,this.$)}gwc(rb,Ub,oc,Nc,ud){fa.b(this.$).vd(y.a.gwc,this.vm(),void 0,!0);if(oc){rb=this.ePh(oc,ud);Nc=Sys.UI.DomElement.getBounds(Ub);Ub=Nc.x+Nc.width;Nc=Nc.y;if(this.Fz&&!oc.IsHeaderSnapped){if(!x.a.Tqd(this.$,oc.Cell))return;oc=x.a.Ogd(this.$,oc.Cell,!0);Ub=oc.x;Nc=oc.y}oc=Q.h(this.$).rtl?new Sys.UI.Point(Ub-da.a(this.$).dHa(Mb.N_c),Nc):
new Sys.UI.Point(Ub,Nc);oc=da.a(this.$).qka(oc);oc=Object(f.a)(new ka,{targetPoint:Object(f.a)(new ba,{left:oc.x,top:oc.y}),autoFilterMenu:rb});this.yfb.showSortFilterMenu(oc);this.$.Xc(-544117314,-1,0,null)}else d.ULS.shipAssertTag(537167135,0,!!oc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}Z8f(rb){return(null===rb||void 0===rb?0:rb.Cell.SheetName)?Q.h(this.$).I5?rb.Cell.SheetName===this.$.na.name:rb.Cell.SheetName===this.$.na.sheetName:!0}ePh(rb,Ub){return(rb=this.fPh(rb,
Ub))?this.ZPf(rb):null}ZPf(rb){const Ub=[];for(const oc of rb.Sections){if(Object(ib.g)(this.$)&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&oc.Title===W.a.instance.ga(1942))continue;const Nc=this.b8i(oc);Ub.push(Nc)}return Object(f.a)(new ha,{Id:rb.Id,Sections:Ub})}b8i(rb){const Ub=[];for(const oc of rb.MenuItems)if(2===oc.Identifier)this.OZc=oc.CommandData;else switch(oc.Type){case 3:case 2:Ub.push(this.$7i(oc,2===oc.Type));break;case 1:Ub.push(this.a8i(oc))}return Object(f.a)(new ca,
{MenuItems:Ub,DisplayType:rb.DisplayType,Id:this.DMh(rb)})}a8i(rb){({label:ud,KMa:Nc}=this.N0e(rb));const Ub=this.ZPf(rb.SubMenu),oc=this.D0e(rb);var Nc=this.ycd.ldc(Nc);var ud=ud||rb.Label;return Object(f.a)(new Wa,{Disabled:rb.Disabled,Type:rb.Type,Identifier:rb.Identifier,Id:oc,CommandData:rb.CommandData,Label:ud,SubMenu:Ub,IsChecked:rb.IsChecked,IconName:"MissingIcon_20"===Nc?null:Nc})}$7i(rb,Ub){let oc;({label:Ub,KMa:ud,Mr:oc}=this.fcc(rb,Ub&&rb.IsChecked));const Nc=this.Ifd(rb,Ub);var ud=this.ycd.ldc(ud);
return Object(f.a)(new Wa,{Disabled:rb.Disabled,Type:rb.Type,Identifier:rb.Identifier,Id:Nc,RibbonCommand:oc,CommandData:rb.CommandData,Label:Ub||rb.Label,SubMenu:null,IsChecked:rb.IsChecked,IconName:"MissingIcon_20"===ud?null:ud})}fPh(rb,Ub){var oc;this.XUa=oc=D.C(rb.Cell);this.sheetName=this.$.na.sheetName;Ub=Ub||u.a(this.$);if(rb.IsHeaderSnapped)oc=Ub.Xac.vWh(oc);else{Ub=Q.h(this.$).Da.CLa(oc);if(!Ub)return this.QNa?Ca.a.RRa(ia.a.kSf,Ra.a.N7h,Ya.a.tqb,!0,!1):(rb=Q.h(this.$).view.visibleArea,d.ULS.sendTraceTag(537167134,
0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${oc}, visible range: ${rb}`)),null;oc=Ub.autoFilterMenu}if(!oc)return this.QNa?Ca.a.RRa(ia.a.kSf,Ra.a.gHi,Ya.a.tqb,!0,!1):d.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.rub=rb.Cell.FirstRow+"_"+rb.Cell.FirstColumn;return oc}qBc(){if(this.$.ea.Yf){const rb=
T.GetServiceTaskFactory.Na(this.$.da,283,284,1);C.TaskExtensions.za(rb,()=>{this.QNa?rb.result.kn.loadScript("sortFilter").then(()=>{this.DIb()},Ub=>{X.a.Wk(Ub,"AutoFilterContextMenu.SortFilterScriptLoad");Ca.a.RRa(ia.a.qBc,Ra.a.VKj,Ya.a.tqb,!1,!1)}):C.TaskExtensions.za(Ka.c(rb.result.kn.loadScript("sortFilter")),()=>{this.DIb()},this.$.ka,3)},this.$.ka,3)}else this.$.ea.Lk(this.pW)}Obh(rb){const Ub={};Ub.SearchText=rb;Ub.Page=1;Ub.DateNodeType=-1;return Ub}F1g(){this.DQa&&(d.ULS.sendTraceTag(537167132,
0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.DQa}`),M.h(this.$.pa.xa,this.DQa,null,null,null),this.DQa=null);this.ubb&&(m.AFrameworkApplication.zd.cu(this.ubb.tt),this.ubb=null)}hEd(rb){return Ub=>{this.ubb=this.DQa=null;if(Ca.a.tAc(Ub)){var oc=Ca.a.wcc(Ub);this.QNa?Ca.a.RRa(rb?ia.a.searchAutoFilterItemList:ia.a.getAutoFilterItemList,oc.MessageIdName,Ya.a.tqb,!0,!0):d.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${oc.MessageIdName}`)}if(!K.a(Ub)){d.ULS.sendTraceTag(537167126,
0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");Ub=Ub.Result;oc=new aa.a(!0);const Nc=Ub.AutoFilterDateNodes?!0:!1;Ub.AutoFilterItems&&oc.add("AutoFilterItemsCount",Ub.AutoFilterItems.length);Nc&&oc.add("AutoFilterDateItemsCount",Ub.AutoFilterDateNodes.length);oc.add("Location","contextMenu");fa.b(this.$).vd(y.a.hEd,oc.Lu,void 0,!0);oc=this.f4a?Object(f.a)(new Pa,{filterByValueItems:this.xHe(Ub),hasMoreRecords:Ub.ItemListMaxExceeded,searchText:Ub.SearchText}):Object(f.a)(new Pa,
{filterByValueItems:this.xHe(Ub),hasMoreRecords:Ub.ItemListMaxExceeded});this.yfb.onGetFilterByValueItemsFinish(oc);rb||(d.ULS.shipAssertTag(529063959,0,null!==Ub.FontColors&&null!==Ub.CellColors&&null!==Ub.Icons&&null!==Ub.SelectedSortFontColors&&null!==Ub.SelectedSortCellColors&&null!==Ub.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),Ub=Object(f.a)(new Za,{fontColors:Ub.FontColors,cellColors:Ub.CellColors,icons:Ub.Icons,selectedSortFontColor:0<
Ub.SelectedSortFontColors.length?Ub.SelectedSortFontColors[0]:null,selectedSortCellColor:0<Ub.SelectedSortCellColors.length?Ub.SelectedSortCellColors[0]:null,selectedSortIcon:0<Ub.SelectedSortIcons.length?Ub.SelectedSortIcons[0]:null,getColorName:this.getColorName}),this.yfb.onGetColorsAndIconsFinish(Ub))}}}mSi(){return rb=>{this.ubb=this.DQa=null;rb=G.a.Oe(rb.data);rb=U.a.sc(rb);d.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${rb}].`)}}xHe(rb){const Ub=
this.x$g(rb),oc=this.F$g(rb.AutoFilterItems),Nc=[],ud=[];let Lb=0,pc=0;rb.HasBlanks&&(rb=Mb.N6c(W.a.instance.ga(782),rb.IsBlanksSelected?1:0,r.a.cye),Nc[Lb++]=rb);for(const Ha of Ub)Nc[Lb++]=Ha;if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const Ha of oc)-1!==Array.indexOf(db.a.$ad,Ha.displayText)?ud[pc++]=Ha:Nc[Lb++]=Ha;else for(const Ha of oc)Nc[Lb++]=Ha;return Array.prototype.concat(ud,Nc)}x$g(rb){const Ub=[];if(!rb.AutoFilterDateNodes||!rb.AutoFilterDateNodes.length)return Ub;
const oc=[this.z5a(rb.YearKeys,rb.YearValues),this.z5a(rb.MonthKeys,rb.MonthValues),this.z5a(rb.DayKeys,rb.DayValues),this.z5a(rb.HourKeys,rb.HourValues),this.z5a(rb.MinuteKeys,rb.MinuteValues),this.z5a(rb.SecondKeys,rb.SecondValues)];let Nc=!1,ud=!1,Lb=0;var pc=null;const Ha=Array(6);var Bb=null;for(const bc of rb.AutoFilterDateNodes){Ha[0]&&(Bb.Year!==bc.Year?(Nc=!0,Lb=0,pc=null):Bb.Month!==bc.Month?(ud=!0,Lb=1,pc=Ha[0]):Bb.Day!==bc.Day?(Lb=2,pc=Ha[1]):rb.ShowTime&&(Bb.Hour!==bc.Hour?(Lb=3,pc=Ha[2]):
Bb.Minute!==bc.Minute?(Lb=4,pc=Ha[3]):(Lb=5,pc=Ha[4])));for(;6>Lb;){let tc;switch(Lb){case 0:tc=bc.Year;Bb=oc[0].getItem(tc.toString());break;case 1:tc=bc.Month;Bb=oc[1].getItem(tc.toString());break;case 2:tc=bc.Day;Bb=oc[2].getItem(tc.toString());break;case 3:tc=bc.Hour;Bb=oc[3].getItem(tc.toString());break;case 4:tc=bc.Minute;Bb=oc[4].getItem(tc.toString());break;case 5:tc=bc.Second;Bb=oc[5].getItem(tc.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Bb=
Mb.N6c(Bb,-1!==bc.NodeType&&Lb>=bc.NodeType?1:0,pc?pc.key+";"+tc:r.a.O_c+tc,!1,[]);pc=pc?pc.children:Ub;pc=pc[pc.length]=Bb;Ha[Lb]=Bb;switch(Lb){case 5:Lb=6;break;case 2:Lb=rb.ShowTime?Lb+1:6;break;default:Lb++}}Bb=bc}Nc||(Ha[0].expanded=!0,ud||(Ha[1].expanded=!0));return Ub}F$g(rb){const Ub=[];if(!rb)return Ub;let oc=0;for(const Nc of rb)Ub[oc++]=Mb.N6c(Nc.DisplayString,Nc.Selected?1:0,r.a.P_c+Nc.DisplayString);return Ub}z5a(rb,Ub){const oc=new aa.a(!0);if(!rb||!Ub)return oc;const Nc=rb.length<Ub.length?
rb.length:Ub.length;for(let ud=0;ud<Nc;ud++)oc.add(rb[ud].toString(),Ub[ud]);return oc}y6c(rb,Ub){const oc={};oc.Location=Ub;oc.FieldId=rb.Id.toString();oc.DataSourceIndex=-1;oc.FilterType=rb.AutoFilterType;oc.AnchorType=0;oc.ChartId=null;oc.AnchorValue1=-1;oc.AnchorValue2=-1;oc.Property=rb.RichProperty;return oc}PS(rb){Oa.a.Cla(this.$)&&C.TaskExtensions.za(T.GetServiceTaskFactory.Na(this.$.da,430,431,1),Ub=>{Ub.result.Zea(rb);d.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.ka,3)}vm(){return{["Location"]:"contextMenu"}}getColorName(rb){return S.a.ALa(J.a.IH(rb))}dIj(rb){C.TaskExtensions.za(T.GetServiceTaskFactory.Na(this.$.da,309,310,3),Ub=>{Ub.result.MTa().continueWith(oc=>{oc.result&&rb()})},this.$.ka,3)}static N6c(rb=null,Ub=0,oc=null,Nc=!1,ud=null){return Object(f.a)(new ua,{displayText:rb?x.a.xf(rb):rb,state:Ub,key:oc,parent:null,children:ud,indentationLevel:0,expanded:Nc})}}Mb.N_c=268;Object(c.a)(Mb,"AutoFilterContextMenu",x.a,[]);var pb=a(726),Qb=a(83),
xb=a(187),pa=a(65),Ma=a(19);class ya{}ya.FYe=26;ya.Add=[228,229,0,99,0,95,94];Object(c.a)(ya,"Constants",null,[]);class Ea{constructor(rb,Ub,oc,Nc){this.EAg=rb;this.nvg=Ub;this.rvg=oc;this.PEg=Nc}get lqi(){return 3===this.i7b}get eui(){return 4===this.i7b&&!!this.subMenu}get subMenu(){return this.PEg}get Cwf(){return this.EAg}get i7b(){return this.nvg}get l8c(){return this.rvg}}Object(c.a)(Ea,"FiltersMenuData",null,[]);class Na extends Ea{constructor(rb,Ub){super(rb,2,0,null);this.dye=Ub}}Object(c.a)(Na,
"AutoFilterFiltersMenuData",Ea,[]);class kb{}kb.$Pj=[new Ea(100,2,0,null),new Ea(101,2,1,null),new Ea(0,3,0,null),new Ea(170,2,2,null),new Ea(172,2,4,null),new Ea(0,3,0,null),new Ea(174,2,6,null),new Ea(175,2,7,null),new Ea(0,3,0,null),new Ea(108,0,0,null)];kb.ELi=[new Ea(100,2,0,null),new Ea(101,2,1,null),new Ea(0,3,0,null),new Ea(102,2,8,null),new Ea(103,2,10,null),new Ea(104,2,12,null),new Ea(0,3,0,null),new Ea(105,1,0,null),new Na(106,1),new Na(107,2),new Ea(0,3,0,null),new Ea(108,0,0,null)];
kb.Ejh=[new Ea(100,2,0,null),new Ea(0,3,0,null),new Ea(112,2,10,null),new Ea(113,2,8,null),new Ea(104,2,12,null),new Ea(0,3,0,null),new Na(110,8),new Na(109,9),new Na(111,10),new Ea(0,3,0,null),new Na(115,11),new Na(114,12),new Na(116,13),new Ea(0,3,0,null),new Na(117,14),new Na(118,15),new Na(119,16),new Ea(0,3,0,null),new Na(120,17),new Na(121,18),new Na(122,19),new Ea(0,3,0,null),new Na(123,20),new Na(124,21),new Na(125,22),new Ea(0,3,0,null),new Na(126,23),new Ea(127,2,12,[new Na(128,24),new Na(129,
25),new Na(130,26),new Na(131,27),new Ea(0,3,0,null),new Na(132,28),new Na(133,29),new Na(134,30),new Na(135,31),new Na(136,32),new Na(137,33),new Na(138,34),new Na(139,35),new Na(140,36),new Na(141,37),new Na(142,38),new Na(143,39)]),new Ea(0,3,0,null),new Ea(108,0,0,null)];Object(c.a)(kb,"Constants",null,[]);var lb=a(911),oa=a(79);class Ba extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Ba.GFh,!0,!1,Ba.ILb,Ub,oc,!1,Nc);this.tm=null}get ax(){return"PopulateAutoFilterFieldListContextMenu"}get PB(){return r.a.jSf}executeCommand(rb,
Ub,oc){rb=Ub.command;switch(rb){case -699941697:this.applyAutoFilterFieldList(Ub,oc);break;case 216058793:break;case -1494291901:break;default:return na.a(rb)}return Ua.Task.Ra(!0)}Fgd(rb,Ub){return!rb||rb.length<=Ub?(d.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(rb[Ub],10)}sJd(rb,Ub,oc,Nc,ud,Lb){const pc=this.Fgd(ud,Lb);0>pc&&d.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(ya.Add[pc]){case 99:rb=new L.a(-2058042992,Ub.method,Ub.mode,Ub.We,Ub.tabName);this.tm.mH.zvb(this.$,Nc,0,rb);break;case 228:rb=new L.a(504133448,Ub.method,Ub.mode,Ub.We,Ub.tabName);this.tm.mH.zvb(this.$,Nc,0,rb);break;case 229:rb=new L.a(-798968736,Ub.method,Ub.mode,Ub.We,Ub.tabName);this.tm.mH.zvb(this.$,Nc,0,rb);break;case 233:rb=new L.a(-1677817820,Ub.method,Ub.mode,Ub.We,Ub.tabName);this.tm.mH.zvb(this.$,Nc,0,rb);break;case 95:this.qQf(rb,Ub,Nc,oc,ud,Lb+1);break;case 94:this.tm.mH.eyi(this.$,
Nc)}}qQf(rb,Ub,oc,Nc,ud,Lb){const pc=this.Fgd(ud,Lb);0>pc&&d.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Nc||pc>=Nc.length)d.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(Nc=Nc[pc],Nc.i7b){case 1:this.tm.mH.yyi(this.$,oc);break;case 2:(ud=Object(Qb.a)(Na,Nc))?(rb=new L.a(-2058042992,Ub.method,Ub.mode,Ub.We,Ub.tabName),this.tm.mH.zvb(this.$,oc,ud.dye,rb)):this.tm.mH.Kqf(this.$,
rb,oc,Nc.l8c);break;case 0:this.tm.mH.Kqf(this.$,rb,oc,Nc.l8c);break;case 4:this.qQf(rb,Ub,oc,Nc.subMenu,ud,Lb+1)}}applyAutoFilterFieldList(rb,Ub){var oc=Ub[pb.a.vG];if(oc)if(oc=oc.split(pa.a.VU),3>oc.length)d.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var Nc=this.Fgd(oc,1),ud=this.oLa(Nc),Lb=this.xwf(Nc).returnValue;Lb?this.sJd(Ub,rb,Lb,ud,oc,2):d.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
Nc.toString()+pa.a.VU)}else d.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}yc(rb,Ub){if(rb=this.$.isEditMode)switch(Ub.command){case 216058793:break;case -699941697:break;case -1494291901:rb=!0;break;default:rb=!1}return rb}i1(rb,Ub,oc){this.$.isEditMode&&((this.tm=Object(Qb.a)(413,oc))||d.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.xZ(),super.i1(rb,
Ub,null,null,!0))}G6c(){if(!this.tm||!this.tm.al||1!==this.tm.al.length)return d.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const rb=this.tm.al[0];let Ub=new xb.a;Ub.add(W.a.instance.ga(249));Ub=oa.OBc(oa.concat(Ub,oa.select(oa.asEnumerable(rb.FieldInfoDataList),oc=>oc.Name)),oc=>oc,new lb.a);return oa.toArray(Ub)}fieldIndex(rb){if(!this.tm||!this.tm.al||1!==this.tm.al.length||!this.tm.al[0].FieldInfoDataList)return-1;
for(let Ub=0;Ub<this.tm.al[0].FieldInfoDataList.length;++Ub)if(this.tm.al[0].FieldInfoDataList[Ub].Name===rb)return Ub;return-1}oLa(rb){return 0>rb||!this.tm||!this.tm.al||1!==this.tm.al.length||!this.tm.al[0].FieldInfoDataList||this.tm.al[0].FieldInfoDataList.length<rb?null:this.tm.al[0].FieldInfoDataList[rb].Name}xZ(){var rb=this.G6c();if(!rb||!rb.length)return null;const Ub=this.Va,oc=Ub.Fc();for(let pc=0;pc<rb.length;++pc){const Ha=rb[pc],Bb=0<pc?this.fieldIndex(Ha):-1,bc=Ba.dbg+Bb.toString()+
pa.a.VU;let tc=null;const Zc=this.tm.mH.tai(0<pc?Ha:null),wd=this.R6c(Ub,Zc,Ba.dbg+Bb.toString(),Ha);for(let Ld=0;Ld<ya.Add.length;++Ld){var Nc=ya.Add[Ld],ud=bc+Ld.toString();tc||(tc=Ub.Fc());switch(Nc){case 228:tc.buttons.push(Ub.Nc(223,ud,-699941697,this.tm.mH.Pti(0<pc?Ha:null)?Ma.a.$$b:Ma.a.gKa,8,228,!1,null));break;case 229:tc.buttons.push(Ub.Nc(224,ud,-699941697,this.tm.mH.Qti(0<pc?Ha:null)?Ma.a.aac:Ma.a.hKa,8,229,!1,null));break;case 233:tc.buttons.push(Ub.Nc(225,ud,-699941697,Ma.a.Y$b,1,233,
!1,null));break;case 99:Nc=this.fZg(Ha);ud=Ub.MIa(ud+(Zc?".enabled":".disabled"),Nc,-699941697,null,"None",null,!Zc,void 0,!0);ud.AS("Image16by16",8,Ma.a.R3a);tc.buttons.push(ud);break;case 95:var Lb=void 0;const ae=({OYe:Lb,isChecked:Nc}=this.xwf(Bb)).returnValue;if(!ae)return null;Lb=this.R6c(Ub,Nc&&Zc,ud,Lb);ud=this.S0e(Lb.menu,Ub,ud+pa.a.VU,ae,Nc&&Zc);Lb.menu.tc.push(ud);tc.buttons.push(Lb);break;case 0:tc&&(wd.menu.tc.push(tc),tc=null);break;default:ud=Ub.MIa(ud,W.a.instance.ga(Nc),-699941697,
null,"None",null,!1,void 0,!0),this.v4f(ud,Zc&&94===Nc&&this.tm.mH.filter(),W.a.instance.ga(Nc)),tc.buttons.push(ud)}}wd.menu.tc.push(tc);oc.buttons.push(wd)}rb=Ub.gq(this.menuId);rb.tc.push(oc);return rb}S0e(rb,Ub,oc,Nc,ud){let Lb=null;for(let tc=0;tc<Nc.length;++tc){var pc=Nc[tc],Ha=oc+tc.toString(),Bb=!1;switch(pc.i7b){case 1:Bb=ud&&this.tm.mH.Xh.IsTop10;break;case 2:Bb=Object(Qb.a)(Na,pc);Bb=ud&&this.tm.mH.Mmi(Bb?Bb.dye:0,pc.l8c);break;case 0:Bb=ud&&this.tm.mH.Xh.IsCustomSupportedAndNotPresent}Lb||
(Lb=Ub.Fc());if(pc.lqi)Lb&&(rb.tc.push(Lb),Lb=null);else if(pc.eui){var bc=W.a.instance.ga(pc.Cwf);bc=this.R6c(Ub,Bb,Ha,bc);bc.menu.tc.push(this.S0e(bc.menu,Ub,Ha+pa.a.VU,pc.subMenu,Bb));Lb.buttons.push(bc)}else pc=W.a.instance.ga(pc.Cwf),Ha=Ub.MIa(Ha,pc,-699941697,null,"None",null,!1,void 0,!0),this.v4f(Ha,Bb,pc),Lb.buttons.push(Ha)}return Lb}v4f(rb,Ub,oc){Ub?rb.AS("Image16by16",8,Ma.a.bva):rb.AS("None",0,null);rb.yS(oc);rb.label=oc}R6c(rb,Ub,oc,Nc){return Ub?rb.H6c(oc,this.menuId,Nc,798637440,8,
Ma.a.bva):rb.xw(oc,this.menuId,Nc,798637440)}sh(rb){return!rb||!rb.length}xwf(rb){var Ub=0>rb?0:this.tm.al[0].FieldInfoDataList[rb].MajorityDataTypeForField;var oc=null;rb=this.tm.mH.sai(Ub);switch(Ub){case 0:oc=96;Ub=kb.$Pj;break;case 1:oc=95;Ub=kb.ELi;break;case 2:oc=97;Ub=kb.Ejh;break;default:return d.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,OYe:oc,isChecked:rb}}oc=W.a.instance.ga(oc);return{returnValue:Ub,OYe:oc,
isChecked:rb}}fZg(rb){return!rb||this.sh(rb.trim())?W.a.instance.ga(98):rb.length>ya.FYe?String.format(W.a.instance.mb(155),rb.substring(0,ya.FYe)):String.format(W.a.instance.mb(156),rb)}}Ba.GFh=r.a.V9g;Ba.ILb="AutoFilterFieldListContextMenuRoot";Ba.dbg="ApplyAutoFilterFieldList.";Object(c.a)(Ba,"AutoFilterFieldListContextMenu",x.a,[]);var sa=a(549),qb=a(839),Jb=a(11),Yb=a(122),jb=a(375),ab=a(776);class vb extends x.a{constructor(rb,Ub,oc,Nc,ud="PopulateFloatingObjectContextMenu",Lb=-2017893763,pc=
1350204367,Ha=r.a.b$g,Bb=!0,bc=!1){super(rb,ud,Lb,pc,Ha,Bb,bc,Ha,Ub,oc,!0,Nc);this.floatingObject=null;this.tb=0;this.Lnc=!0}get ax(){return"PopulateFloatingObjectContextMenu"}get PB(){return r.a.rSf}executeCommand(rb,Ub,oc){rb=Object(Qb.a)(sa.a,oc.eventArgs);switch(Ub.command){case -1372040782:oc=Q.h(this.$).ha.Ta.$b;d.ULS.shipAssertTag(537167048,0,!!oc);oc&&(this.floatingObject=oc.floatingObject,this.tb=Ub.method,Ub=this.Ucc(rb),this.Tp(Ub,!0,rb.tb));break;case 848910589:rb&&(Ub=[qb.a.K7f],rb=new Sys.UI.Point(rb.Ca.clientX,
rb.Ca.clientY),this.showFloatie(Ub,new Sys.UI.Bounds(rb.x,rb.y,0,0),2))}return Ua.Task.Ra(!0)}yc(rb,Ub,oc){switch(Ub.command){case -1372040782:return!!oc&&this.Fnf(rb);case 848910589:return rb=Q.h(this.$).ha.Ta.$b,!!oc&&!!rb&&rb.gb;default:return!1}}Fnf(rb){switch(rb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}lXc(rb,Ub,oc){jb.a(this.$)?Q.h(this.$).ib.rj||(da.a(this.$).HVd()?oc.buttons.push(rb.pb(265)):oc.buttons.push(rb.pb(264))):(this.$.isEditMode&&3===this.tb&&!this.ybc()&&
oc.buttons.push(rb.pb(101)),5!==this.floatingObject.type||Yb.a.ZH(this.floatingObject.Bb)||this.floatingObject.Bb.IsGroup||(this.Vtd()?oc.buttons.push(rb.pb(186)):oc.buttons.push(rb.pb(147))),this.ybc()||this.Vtd()||oc.buttons.push(rb.pb(146)),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7439032_ChangeFOZOrder")&&(this.ELh(oc),this.dNh(oc)),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&oc.buttons.push(rb.pb(287)),Y.EwaSettings.oa(162)&&
0===this.floatingObject.type&&oc.buttons.push(rb.pb(249)),5===this.floatingObject.type&&Q.h(this.$).ha.Ta.$b.Q5()&&this.$.cca&&this.$.ZY&&oc.buttons.push(rb.pb(273)))}rLa(rb){const Ub=[];if(jb.a(this.$))return Ub;3===rb?(rb=!!this.$.me.get(5)&&this.floatingObject.YYd(),this.ybc()||(this.$.isEditMode?(rb&&Ub.push(qb.a.IIh),5===Q.h(this.$).ha.Ta.aB.floatingObject.type&&Ub.push(qb.a.kCj)):rb&&Ub.push(qb.a.copy)),Ub.push(qb.a.JIh)):2===rb&&(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
Q.h(this.$).ha.Ta.$b&&this.W5e(Q.h(this.$).ha.Ta.$b,Ub):this.W5e(Q.h(this.$).ha.Ta.aB,Ub));return Ub}xZ(){const rb=this.Va,Ub=rb.gq(this.menuId);var oc=jb.a(this.$);if(this.$.isEditMode){var Nc=rb.Fc();this.lXc(rb,Ub,Nc);Ub.tc.push(Nc)}this.$.me.get(5)&&this.floatingObject.YYd()&&!this.ybc()&&!oc&&(Nc=rb.Fc(),this.OIg(rb,Nc),Ub.tc.push(Nc));(Nc=this.$.va.na)&&Nc.Hd&&(Nc=Nc.Hd.Kv||Nc.Hd.hI,!Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||
!ab.g(this.$)||this.$.ea.isNamedObjectViewMode||oc||this.$.isMobileMode||Nc||(oc=rb.Fc(),this.LKg(rb,oc),Ub.tc.push(oc)));return Ub}Ucc(rb){var Ub=Q.h(this.$).ha.Ta.$b;rb=rb&&1!==rb.tb&&rb.clientPoint?rb.clientPoint:Sys.UI.DomElement.getLocation(Ub.domElement);const oc=this.$.domElement,Nc=Q.h(this.$).rtl;(Ub=Jb.HelperMethods.sD(Ub.Fg.domElement,oc,Nc))?(rb.y=Math.max(rb.y,Ub.y),rb.x=Math.max(rb.x,Ub.x)):d.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${m.AFrameworkApplication.Og}`);
return rb}Vtd(){const rb=Q.h(this.$).ha.Ta.$b;return!!rb&&rb.gb}OIg(rb,Ub){if(this.$.isEditMode){Ub.buttons.push(rb.pb(42));Ub.buttons.push(rb.pb(43));const oc=this.$.da.Aa(254,!0);(oc&&2===oc.oDb()||this.Vtd())&&Ub.buttons.push(rb.pb(44))}else Ub.buttons.push(rb.pb(43))}LKg(rb,Ub){Ub.buttons.push(rb.pb(274))}ybc(){return Y.EwaSettings.oa(437)&&!!Q.h(this.$).ha.Ta.ro}W5e(rb,Ub){5===rb.floatingObject.type?rb.gb?Ub.push(qb.a.K7f):Ub.push(qb.a.gCj):Ub.push(x.a.QZe)}ELh(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(282));
Ub.buttons.push(this.Va.pb(281));const oc=this.Va.xw("BringToFront","BringToFrontMenuId",W.a.instance.ga(822),-1777747317);oc.menu.tc.push(Ub);rb.buttons.push(oc)}dNh(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(284));Ub.buttons.push(this.Va.pb(283));const oc=this.Va.xw("SendToBack","SendToBackMenuId",W.a.instance.ga(823),-1777747317);oc.menu.tc.push(Ub);rb.buttons.push(oc)}}Object(c.a)(vb,"FloatingObjectContextMenu",x.a,[]);var Da=a(790),Fa=a(102),nb=a(556),Ta=a(518);const V=r.a.Y9g;class va extends vb{constructor(rb,
Ub,oc,Nc){super(rb,Ub,oc,Nc,"PopulateChartContextMenu",-498523270,1640762262,V);this.isPivotChart=this.refresh=this.TZ=this.Owa=this.EBa=!1}get ax(){return"PopulateChartContextMenu"}get PB(){return r.a.lSf}executeCommand(rb,Ub,oc){const Nc=this.$;this.tb=Ub.method;Ub=oc[va.V2c];if(!(rb&68)){if(!Ub){if(8===rb)Ub=Ta.a(Nc).Vc;else{var ud=Q.h(Nc).ha.Ta.$b;if(null===ud||void 0===ud?0:ud.floatingObject)Ub=ud.floatingObject.Vc}if(!Ub)return Ua.Task.Ra(!0)}this.isPivotChart=!!(Ub.Attributes&4)}if(this.isPivotChart||
Nc.isEditMode)if(this.refresh=this.TZ=this.Owa=this.EBa=!1,ud=Q.h(this.$).ha.Ta.$b,d.ULS.shipAssertTag(537167107,0,!!ud),ud){this.floatingObject=ud.floatingObject;ud=nb.a(Nc);if(null===ud||void 0===ud?0:ud.dVd)this.EBa=ud=Fa.f(Nc.lg),this.Owa=!ud;ud=Nc.dc;this.TZ=!!Da.a(Nc)&&!!Ub&&!!(Ub.Attributes&512)&&!(rb&8)&&ud.h3(32768);ud.allowManualDataRefresh&&ud.allowInteractivity&&(this.refresh=!0);rb=this.Ucc(Object(Qb.a)(sa.a,oc.eventArgs));this.Tp(rb,!0)}return Ua.Task.Ra(!0)}yc(rb,Ub,oc){return-149612405===
Ub.command&&!!oc&&this.Fnf(rb)}lXc(rb,Ub,oc){this.isPivotChart&&(this.refresh&&oc.buttons.push(rb.pb(100)),this.TZ&&oc.buttons.push(rb.pb(99)),this.EBa?oc.buttons.push(rb.pb(59)):this.Owa&&oc.buttons.push(rb.pb(58)));super.lXc(rb,Ub,oc)}static get V2c(){return"chartMetaData"}}Object(c.a)(va,"ChartContextMenu",vb,[]);var wb=a(12);const fc=r.a.$9g;class Fc extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateFieldListContextMenu",-1045020714,-170383950,fc,!0,!1,fc,Ub,oc,!1,Nc);this.bM=this.Fo=null;
this.$Yd=this.isOlap=this.YV=this.z_=!1}get ax(){return"PopulateFieldListContextMenu"}get PB(){return r.a.DKd}executeCommand(rb,Ub,oc){rb=Ub.command;switch(rb){case 330754562:Ub=oc.domElement;this.isOlap=oc.isOlap;this.bM=oc.versionkey;this.Fo=oc.fieldItem;this.z_=oc.isChart;this.YV=oc.isPpm;this.$Yd="supportsImplicitMeasures"in oc?oc.supportsImplicitMeasures:!1;Q.h(this.$).Xo(!0);Ub=wb.DOMElementExtensions.getBounds(Ub);Ub=new Sys.UI.Point(Ub.x+Ub.width,Ub.y+Ub.height/2);"isKeyboardInput"in oc&&
oc.isKeyboardInput?this.Tp(Ub,!1,1):this.Tp(Ub,!1);break;case 926905850:this.$Yd&&this.Fo&&5===this.Fo.TypeTag&&!this.Fo.IsCollapsible&&d.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");nb.a(this.$).gK(this.Fo,8,-1,this.bM,Ub);break;case -67292059:nb.a(this.$).gK(this.Fo,1,-1,this.bM,Ub);break;case 745182485:nb.a(this.$).gK(this.Fo,2,-1,this.bM,Ub);break;case 359279088:nb.a(this.$).gK(this.Fo,4,-1,this.bM,Ub);break;case 547535945:nb.a(this.$).lbj(this.Fo);break;default:return na.a(rb)}return Ua.Task.Ra(!0)}yc(rb,
Ub,oc){rb=!1;switch(Ub.command){case 330754562:rb=!!oc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:rb=!0}return rb}xZ(){const rb=this.Va.gq(this.menuId);this.A5i(rb);this.z_||this.isOlap||this.z5i(rb);return rb}A5i(rb){const Ub=this.Va,oc=Ub.Fc();let Nc=!1;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Nc=this.isOlap&&!this.YV&&this.$Yd&&5===this.Fo.TypeTag&&!this.Fo.IsCollapsible);3!==this.Fo.TypeTag&&37!==this.Fo.TypeTag||
this.Fo.IsSet?17===this.Fo.TypeTag||this.YV?(oc.buttons.push(Ub.pb(79)),oc.buttons.push(Ub.pb(this.z_?91:80)),oc.buttons.push(Ub.pb(this.z_?92:81)),oc.buttons.push(Ub.pb(82))):13===this.Fo.TypeTag||this.Fo.IsSet?(oc.buttons.push(Ub.pb(83)),oc.buttons.push(Ub.pb(this.z_?91:80)),oc.buttons.push(Ub.pb(this.z_?92:81)),oc.buttons.push(Ub.pb(86))):(oc.buttons.push(Ub.pb(79)),oc.buttons.push(Ub.pb(this.z_?91:80)),oc.buttons.push(Ub.pb(this.z_?92:81)),oc.buttons.push(Ub.pb(Nc?82:86))):(oc.buttons.push(Ub.pb(83)),
oc.buttons.push(Ub.pb(this.z_?93:84)),oc.buttons.push(Ub.pb(this.z_?94:85)),oc.buttons.push(Ub.pb(82)));rb.tc.push(oc)}z5i(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(78));rb.tc.push(Ub)}}Object(c.a)(Fc,"FieldListContextMenu",x.a,[]);var Qa=a(419),la=a(66);class hb{constructor(rb){this.$=rb;this.bO={}}get(rb,Ub,oc){const Nc=this.bhg(rb,"PivotFilterContextMenuCache.Get");return Nc&&this.bO[Nc]?this.bO[Nc][hb.Jid(Ub,this.$,rb,oc)]:null}set(rb,Ub,oc,Nc){const ud=this.bhg(rb,"PivotFilterContextMenuCache.Set");
ud&&(this.bO[ud]||(this.bO[ud]={}),this.bO[ud][hb.Jid(Ub,this.$,rb,Nc)]=oc)}J9b(rb){rb in this.bO&&this.bO[rb]&&(this.bO[rb]=null)}bhg(rb,Ub){return la.f(this.$.na)?this.$.activeItemName:(rb=this.LUj(rb,Ub))?rb.Bd:null}LUj(rb,Ub){rb=D.C(rb);rb=Q.h(this.$).Da.awa(rb,this.$.activeItemName);d.ULS.shipAssertTag(537167008,0,!!rb,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${Ub}`);return rb}static Jid(rb,
Ub,oc,Nc){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Nc?Ub.na.index+"_"+rb.id+"_"+oc.FirstRow.toString()+"_"+oc.FirstColumn.toString():Ub.na.index+"_"+rb.id}}Object(c.a)(hb,"PivotFilterContextMenuCache",null,[]);class Kb{constructor(){this.cell=null;this.dataSourceIndex=0;this.So=this.pivotName=null}}Object(c.a)(Kb,"ShowPivotFilterData",null,[]);var dc=a(461),sb=a(1295),bb=a(52);const Ob=r.a.lHe;class gc extends x.a{constructor(rb,Ub,oc,Nc,ud,Lb,pc,Ha=Ob){super(rb,
Ub,oc,Nc,Ha,!0,!1,"PivotFilterMenuRootName",ud,Lb,!1,pc);this.cpc=this.MCd=this.pivotData=this.Vnb=this.Spf=this.t7b=null;this.YY=this.w4b=this.TFb=0;this.ytb=null;this.HSi=(Bb,bc)=>{if(bc)if(K.a(Bb))this.Gzd(bc,!1);else if(Bb=Bb.Result){this.rub=hb.Jid(bc,this.$,this.pivotData.cell,this.YY);var tc=this.ywf(Bb.MenuModel.Sections);this.ytb=tc;gc.bO.set(this.pivotData.cell,bc,tc,this.YY);sb.a(this.$).uNj(Bb);this.Gzd(bc,!0)}};this.GSi=(Bb,bc)=>{this.Gzd(bc,!1)};this.sf=(Bb,bc)=>{gc.bO.J9b(bc.Yc.hash)};
this.Zm=(Bb,bc)=>{gc.bO.J9b(bc.Yc.hash)};this.qAa=null;this.VCe=this.w4b=this.NCd=this.TFb=-1;this.Hue=this.YY=0;this.Fz=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");gc.bO||(gc.bO=new hb(this.$),Q.h(this.$).Da.pt(this.sf),Q.h(this.$).Da.gH(this.Zm),Q.h(this.$).Da.d$(this.sf))}Ecd(rb,Ub){const oc=rb.rawEvent,Nc=rb.cell,ud=rb.requiresConfirmation;dc.a(this.$).Vx(ud,Lb=>{if(Lb){Lb=oc?new Sys.UI.DomEvent(oc):null;this.pivotData=new Kb;this.pivotData.pivotName=rb.pivotName;this.pivotData.dataSourceIndex=
rb.dataSourceIndex;this.pivotData.cell=Nc;this.pivotData.So=rb.optionalPivotMenuAnchorParameter;if(this.pivotData.So&&0<this.pivotData.So.AnchorType){this.cpc=rb.objectId;this.TFb=rb.objectVersion;const pc=this.pivotData.So.AnchorType;if(4===pc||5===pc||6===pc||11===pc||9===pc||10===pc||8===pc)this.Vnb=rb.location}else this.MCd=this.cpc=null,this.NCd=this.TFb=-1;Q.h(this.$).Xo(!0);this.$.pk(Nc);this.i1(Lb,Lb?Lb.target:rb.domElement,this.pivotData,Ub,this.uNa())}});return!0}i1(rb,Ub,oc,Nc){if(Object(Qa.a)(Kb,
oc)){this.pivotData=oc;this.t7b=Ub;this.Spf=rb;this.w4b=this.pivotData.So?this.pivotData.So.AnchorValue1:-1;this.YY=this.pivotData.So?this.pivotData.So.AnchorType:0;var ud=!1,Lb=null;Lb=gc.bO.get(this.pivotData.cell,Ub,this.YY);ud=!!Lb;var pc=!0;switch(this.YY){case 4:case 5:case 6:this.qAa=new Sys.UI.Point(this.Vnb.x,this.Vnb.y);pc=!1;break;case 7:var Ha=Sys.UI.DomElement.getBounds(Ub);pc=Ha.x+(0<=Ha.x?0:Ha.width);Ha=Ha.y+(0<=Ha.y?0:Ha.height);this.qAa=new Sys.UI.Point(0<=pc?pc:0,0<=Ha?Ha:0);pc=
!1;break;case 8:case 10:case 9:case 11:this.qAa=new Sys.UI.Point(this.Vnb.x,this.Vnb.y);break;default:this.qAa=null}ud&&this.cpc===this.MCd&&this.TFb===this.NCd&&this.w4b===this.VCe&&this.YY===this.Hue?(d.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.ytb=Lb,this.qAa?this.Tp(this.qAa,this.uNa()):this.Fz?x.a.Tqd(this.$,this.pivotData.cell)&&this.Tp(x.a.Ogd(this.$,this.pivotData.cell,!1),this.uNa()):super.i1(rb,Ub,
oc,Nc,this.uNa())):1!==gc.DUh(Ub)&&(pc&&(Ub.parentNode.menuFetchStates=1,this.Hwj(Ub),this.e4f(!0)),this.$.userOperationManager.Ic(new I.a(126,0,(Bb,bc,tc)=>{const Zc=this.$;return M.p(Zc.pa.xa,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,Zc.domElement.id,Zc.isChromeRtl,Zc.workbookContext.NovMode,Aa.b(Bb,this.HSi),Aa.a(bc,this.GSi),tc,Ub,this.pivotData.So)},16),Nc))}}MHd(rb){rb.MenuSectionList.push(...this.ytb)}Gzd(rb,Ub){rb.parentNode.menuFetchStates=2;this.e4f(!1);
if(Ub){if(this.t7b!==rb||this.hHi())this.Tp(this.qAa,this.uNa());else if(this.Fz&&!this.qAa){if(!x.a.Tqd(this.$,this.pivotData.cell))return;this.Tp(x.a.Ogd(this.$,this.pivotData.cell,!1),this.uNa())}else super.i1(this.Spf,rb,null,null,this.uNa());this.MCd=this.cpc;this.NCd=this.TFb;this.Hue=this.YY;this.VCe=this.w4b}}uNa(){return 8!==this.YY&&9!==this.YY&&10!==this.YY&&11!==this.YY}hHi(){switch(this.pivotData.So?this.pivotData.So.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;
default:return!1}}e4f(rb){const Ub=this.t7b;if(Ub){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var oc=wb.DOMElementExtensions.c_(Ub,"ewaprevsrc","");oc=!!oc&&"null"!==oc}else oc=!!wb.DOMElementExtensions.c_(Ub,"ewaprevsrc","");rb&&oc||!rb&&!oc||(rb?(Ub.setAttribute("ewaprevsrc",Ub.src),Ub.src=bb.a.current.io(99)):(rb=wb.DOMElementExtensions.c_(Ub,"ewaprevsrc",""),Ub.src=rb,Ub.setAttribute("ewaprevsrc",null)))}}Hwj(rb){this.t7b=rb}static DUh(rb){const Ub=
rb.parentNode.menuFetchStates;void 0===Ub&&(rb.parentNode.menuFetchStates=0);return Ub}}gc.bO=null;Object(c.a)(gc,"PivotFilterContextMenuBase",x.a,[]);const mb="FieldList"+r.a.lHe;class Nb extends gc{constructor(rb,Ub,oc,Nc){super(rb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Ub,oc,Nc,mb)}get ax(){return"PopulateFieldListPivotMenu"}get PB(){return r.a.pSf}executeCommand(rb,Ub,oc){return this.Ecd(oc,Ub)?Ua.Task.Ra(!0):na.a(Ub.command)}yc(rb,Ub,oc){return-1065117584===Ub.command&&!!oc}}Object(c.a)(Nb,
"FieldListPivotContextMenu",gc,[]);var ic=a(264),gb=a(30),Eb=a(89),Lc=a(755);class Ec{}Object(c.a)(Ec,"PivotValueFieldSettingsApplyData",null,[]);class Cb{}Cb.wmg="valueFieldSettingTabs";Cb.jjh="dataFieldCustomLabel";Cb.oLe="dataFieldSourceLabel";Cb.TWd="showValueAsSelect";Cb.RWd="showValueAsBaseFieldSelect";Cb.SWd="showValueAsBaseItemSelect";Cb.m3d="valueFieldsSettingsFieldName";Object(c.a)(Cb,"CssElementIds",null,[]);var eb=a(86);class Sb{constructor(rb,Ub,oc){this.baseItemIndex=this.baseFieldIndex=
this.dataFormat=0;this.dataFormat=rb;this.baseFieldIndex=Ub;this.baseItemIndex=oc}}Object(c.a)(Sb,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class ld{constructor(rb,Ub,oc,Nc,ud){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=rb;this.activeCell=Ub;this.pivotFieldTitle=oc;this.summarizeBy=Nc;this.showAsValueParameters=ud}getActiveCell(){return this.activeCell}}Object(c.a)(ld,"MacroRecorderPivotValueFieldSettingAppliedPayload",
null,[145]);var bd=a(238);class ec{}Object(c.a)(ec,"PivotValueFieldShowValueAsApplyData",null,[]);var sc=a(738),Dc=a(44);const Ud=`<div id='showValueAsControlBody'><label for='${Cb.TWd}' class='${eb.a.Tm} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Cb.TWd}' class='${eb.a.Bz}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Cb.RWd}'>{1}</label><div><select size=6 id='${Cb.RWd}' class='${eb.a.Bz}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Cb.SWd}'>{2}</label><div><select size=6 id='${Cb.SWd}' class='${eb.a.Bz}'></select></div></div></div>`;
class Ed extends bd.a{constructor(rb,Ub,oc,Nc,ud,Lb,pc,Ha,Bb){super(rb);this.htmlSanitizationHelper=this.i9d=this.S6d=this.R6d=this.O2b=this.Y7b=this.ED=null;this.BCf=()=>{var bc=parseInt(this.c4.ie.value,10);this.t1g(bc)?(this.bQ.Rp.disabled=!0,this.cQ.Rp.disabled=!0,this.cQ.clear(),Ed.Uhf(bc)?(this.bQ.Rp.disabled=!1,this.NQb(!Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):Ed.Vhf(bc)?(this.bQ.Rp.disabled=!1,this.cQ.Rp.disabled=!1,this.NQb(!0),this.zrf()):this.NQb(!1)):
(bc=U.a.dd(1,0,0,1127,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Dc.a(this.$).Qr([bc]),this.c4.Noj())};this.pNi=()=>{0>this.bQ.selectedIndex||this.cQ.Rp.disabled||(this.NQb(!0),this.zrf())};this.CTi=bc=>{this.ED.oUa();this.cQ.Rp.style.overflowY="scroll";if(bc&&!K.a(bc)){bc=bc.Result;this.cQ.clear();for(const tc of bc.BaseItems)this.cQ.SY(tc.DisplayString,tc.Id.toString(),tc.Id===bc.SelectedBaseItem);this.NQb(!1)}};this.get_visible=this.yka;this.set_visible=this.koa;this.$=Ub;this.cell=oc;this.So=
Nc;this.externalSourceIndex=ud;this.Wd=Lb;this.Gta=pc;this.Iqi=Ha;this.htmlSanitizationHelper=Bb;this.n_j=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.Tka()}yka(){return this.isVisible}koa(rb){return this.isVisible=rb}get title(){return W.a.instance.ga(1115)}get Txb(){const rb=this.c4.ie?parseInt(this.c4.ie.value,10):-1,Ub=this.bQ.ie?parseInt(this.bQ.ie.value,10):-1,oc=this.cQ.ie?parseInt(this.cQ.ie.value,10):-1;return Object(f.a)(new ec,{SelectedDataFormat:0<=
rb?rb:-1,SelectedBaseField:Ub,SelectedBaseItem:oc})}get bQ(){return this.R6d}get cQ(){return this.S6d}get c4(){return this.i9d}setFocus(){wb.DOMElementExtensions.setFocus(this.c4.Rp)}render(rb){rb.appendChild(this.domElement)}dispose(){Eb.a.rc([this.c4,this.bQ,this.cQ,this.Y7b,this.O2b]);super.dispose()}tzj(rb){Eb.a.rc([this.Y7b,this.O2b]);this.c4.clear();for(const Ub of rb.DataFormatTypes)this.c4.SY(Ed.PSh(Ub),Ub.toString(),Ub===rb.SelectedDataFormat);this.Y7b=this.Be.oe(this.c4.domElement);this.Y7b.la("change",
this.BCf);this.bQ.clear();for(const Ub of rb.BaseFieldList)this.bQ.SY(Ub.DisplayString,Ub.Id.toString(),Ub.Id===rb.SelectedBaseField);this.O2b=this.Be.oe(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?this.bQ.domElement:this.c4.domElement);this.O2b.la("change",this.pNi);this.ED=this.Gta.stb(this.cQ.Rp.parentNode,1E3,null,"",736);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.ED.oUa();this.BCf(null)}hR(rb){this.c4.hR(rb);
this.bQ.hR(rb);this.cQ.hR(rb)}Tka(){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.ni(this.domElement,String.format(Ud,W.a.instance.ga(1116),W.a.instance.ga(1117),W.a.instance.ga(1118))):this.domElement.innerHTML=String.format(Ud,W.a.instance.ga(1116),W.a.instance.ga(1117),W.a.instance.ga(1118));this.i9d=new sc.a(wb.DOMElementExtensions.getElementById(this.domElement,
Cb.TWd),!1);this.R6d=new sc.a(wb.DOMElementExtensions.getElementById(this.domElement,Cb.RWd),!1);this.S6d=new sc.a(wb.DOMElementExtensions.getElementById(this.domElement,Cb.SWd),!1)}t1g(rb){return this.Iqi||!Ed.Uhf(rb)&&!Ed.Vhf(rb)?!0:!!this.bQ.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Ic(new I.a(108,0,(rb,Ub,oc)=>{var Nc=this.$.pa.xa,ud=parseInt(this.bQ.ie.value,10);rb=Aa.b.call(null,rb,this.CTi);const Lb=M.L(Nc,this.cell,this.externalSourceIndex,this.So);
Lb.selectedBaseField=ud;return M.g(Nc,"GetPivotValueFieldSettingsShowValueAsBaseItems",Lb,rb,Ub,oc,null,4)},16),this.Wd)}zrf(){this.cQ.clear();this.bQ.ie&&(this.ED.iUa(),this.cQ.Rp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}NQb(rb){const Ub=document.getElementById("WACDialogActionButton");this.n_j&&Ub&&(Ub.disabled=rb)}static PSh(rb){switch(rb){case 0:return W.a.instance.ga(1119);case 1:return W.a.instance.ga(1120);case 2:return W.a.instance.ga(1121);case 3:return W.a.instance.ga(1122);
case 4:return W.a.instance.ga(1123);case 5:return W.a.instance.ga(1124);case 6:return W.a.instance.ga(1125);case 7:return W.a.instance.ga(1126);case 8:return W.a.instance.ga(1128);case 9:return W.a.instance.ga(1129);case 10:return W.a.instance.ga(1130);case 11:return W.a.instance.ga(1131);case 12:return W.a.instance.ga(1132);case 13:return W.a.instance.ga(1133);case 14:return W.a.instance.ga(1134);default:return""}}static Uhf(rb){return 11===rb||12===rb||14===rb||13===rb||4===rb}static Vhf(rb){return 1===
rb||3===rb||2===rb}}Object(c.a)(Ed,"ShowValueAsControl",bd.a,[325,3]);class $d{}Object(c.a)($d,"PivotValueFieldSummarizeValueByApplyData",null,[]);const ve="<div id='summarizeValuesByControlBody'>"+`<label class='${eb.a.Tm} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${eb.a.Tm} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${eb.a.Bz}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${r.a.kH}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class ze extends bd.a{constructor(rb,Ub){super(rb);this.htmlSanitizationHelper=this.uie=null;this.get_visible=this.yka;this.set_visible=this.koa;this.htmlSanitizationHelper=Ub;this.Tka()}get Txb(){const rb=this.sl.ie?parseInt(this.sl.ie.value,10):-1;return Object(f.a)(new $d,{Aggregation:0<=rb?rb:-1})}yka(){return this.isVisible}koa(rb){return this.isVisible=rb}get title(){return W.a.instance.ga(1114)}get enabled(){return!this.sl.Rp.disabled}set enabled(rb){this.sl.Rp.disabled=!rb}get sl(){return this.uie}setFocus(){wb.DOMElementExtensions.setFocus(this.sl.Rp)}render(rb){rb.appendChild(this.domElement)}dispose(){Eb.a.Ia(this.sl);
super.dispose()}focus(){wb.DOMElementExtensions.setFocus(this.sl.Rp)}szj(rb){this.sl.QXd();for(const Ub of rb.AggregationTypes){const oc=Ub===rb.SelectedAggregation;this.sl.iXc(ze.qOh(Ub),Ub.toString(),oc,"")}this.sl.jad();this.sl.Rp.disabled=rb.AggregationsDisabled}Joj(){this.sl.Koj()}Tka(){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.ni(this.domElement,
String.format(ve,W.a.instance.ga(1099),W.a.instance.ga(1100))):this.domElement.innerHTML=String.format(ve,W.a.instance.ga(1099),W.a.instance.ga(1100));this.uie=new sc.a(wb.DOMElementExtensions.getElementById(this.domElement,ze.ANf),!1)}static qOh(rb){switch(rb){case 0:return W.a.instance.ga(1102);case 1:return W.a.instance.ga(1103);case 2:return W.a.instance.ga(1104);case 3:return W.a.instance.ga(1105);case 4:return W.a.instance.ga(1106);case 5:return W.a.instance.ga(1107);case 6:return W.a.instance.ga(1108);
case 7:return W.a.instance.ga(1109);case 8:return W.a.instance.ga(1110);case 9:return W.a.instance.ga(1111);case 10:return W.a.instance.ga(1112);case 11:return W.a.instance.ga(1113);default:return""}}}ze.ANf="pivotDataFieldSelect";Object(c.a)(ze,"SummarizeValuesByControl",bd.a,[325,3]);var We=a(210),md=a(469),$b=a(1239);class $c extends Lc.a{constructor(rb,Ub,oc,Nc,ud,Lb,pc,Ha,Bb,bc){super(ud,W.a.instance.mb(61),!0,2,!0);this.E9f=!0;this.htmlSanitizationHelper=this.PUc=this.X7b=this.Ntb=this.pga=
this.STa=this.Yne=null;this.cNi=tc=>{ic.a.any(tc.Errors,Zc=>-103190598===Zc.MessageId)&&this.wUa.Joj()};this.BTi=tc=>{tc&&!K.a(tc)&&(tc=tc.Result,Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.$4f(this.X7b,W.a.instance.ga(1097)+gb.a.rg(tc.ValueFieldSourceName)):this.X7b.innerHTML=W.a.instance.ga(1097)+gb.a.rg(tc.ValueFieldSourceName),this.isOlap&&
!this.YV?(this.wUa.enabled=!1,this.pga.activeTab=this.pga.uCc-1):(this.wUa.enabled=!0,this.pga.activeTab=0),this.wUa.szj(tc.PivotValueFieldSettingsSummarizeValueByInfo),this.STa.tzj(tc.PivotValueFieldShowValueAsInitialInfo),this.vg())};this.cell=rb;this.So=Ub;this.externalSourceIndex=oc;this.vmg=Nc;this.Wd=Lb;this.Gta=pc;this.isOlap=Ha;this.YV=Bb;this.htmlSanitizationHelper=bc}get pc(){return"ValueFieldSettingsDialog"}get SCa(){return this.Yne}get oFb(){return this.pga}get wUa(){return this.PUc}get dC(){return 560}dispose(){this.X7b=
this.Ntb=this.STa=this.PUc=null;Eb.a.Ia(this.pga);this.pga=null;super.dispose()}initialize(){let rb="<div id='"+Cb.oLe+"' class='"+eb.a.Tm+"'></div><div id='"+Cb.jjh+"' class='"+eb.a.Tm+"'><label for='"+Cb.m3d+"'>{0}</label><input type='text' id='"+Cb.m3d+"' value='{1}' class='"+eb.a.Bz+" UIFont' /></div><div id='"+Cb.wmg+"'></div>";rb=String.format(rb,W.a.instance.ga(1098),gb.a.rg(this.vmg));Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
this.htmlSanitizationHelper.ni(this.Ib,rb):this.Ib.innerHTML=rb;this.Pf||(this.rsa(),this.Pt());this.Yne=[-103190598];this.c6h();super.initialize()}close(rb){1===rb&&(this.E9f=!1);super.close(rb)}vNe(rb){this.isDisabled=rb;this.domElement.disabled=rb;const Ub=["input","option","select"];for(let oc=0,Nc=Ub.length;oc<Nc;++oc){const ud=this.domElement.getElementsByTagName(Ub[oc]);for(let Lb=0;Lb<ud.length;++Lb)ud[Lb].disabled=rb}}Pt(){this.Ntb=document.getElementById(Cb.m3d);this.X7b=wb.DOMElementExtensions.getElementById(this.Ib,
Cb.oLe);const rb=wb.DOMElementExtensions.getElementById(this.Ib,Cb.wmg);this.PUc=new ze(document.createElement("div"),this.htmlSanitizationHelper);this.STa=new Ed(document.createElement("div"),this.$,this.cell,this.So,this.externalSourceIndex,this.Wd,this.Gta,!this.isOlap,this.htmlSanitizationHelper);let Ub;this.pga=new $b.a(rb,(Ub=new xb.a,Ub.add(this.wUa),Ub.add(this.STa),Ub));this.pga.MXf()}XHd(){const rb=new $c(this.cell,this.So,this.externalSourceIndex,this.vmg,this.$,this.Wd,this.Gta,this.isOlap,
this.YV,this.htmlSanitizationHelper);rb.initialize();rb.vg()}GRb(){const rb=new md.a;if(!this.E9f)return rb.isValid=!0,rb;this.Ntb.value.length?rb.isValid=!0:(this.vNe(!0),rb.error=U.a.dd(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.isDisabled=!0,this.Pf||(this.qz.disabled=!0),rb.isValid=!1);return rb}paf(){this.isDisabled=!1;this.Pf||(this.qz.disabled=!1);this.vNe(!1)}lza(rb){const Ub=new L.a(2105621672,0,this.$.Hc,30,null);this.$.Ka.Lb(Ub);this.eX(5,rb.tb,"Number Format");return!0}wq(){this.Voa=
String.format(W.a.instance.mb(61),null);super.wq()}setFocus(){if(this.Pf){const rb=wb.DOMElementExtensions.getElementById(this.Ib,ze.ANf);We.a.Z0d(rb)}else this.pga.setFocus()}ik(){const rb=this.STa.Txb,Ub=new Sb(rb.SelectedDataFormat,rb.SelectedBaseField,rb.SelectedBaseItem);return()=>new ld(this.externalSourceIndex,this.cell,this.Ntb.value,this.wUa.Txb.Aggregation,Ub)}nH(){const rb=Object(f.a)(new Ec,{PivotValueFieldSummarizeValueByApplyData:this.wUa.Txb,PivotValueFieldShowValueAsApplyData:this.STa.Txb,
PivotValueFieldTitle:this.Ntb.value});return(Ub,oc,Nc)=>{var ud=this.$.pa.xa;Ub=Aa.b(Ub,this.cNi);const Lb=M.L(ud,this.cell,this.externalSourceIndex,this.So);Lb.pivotValueFieldSettingsApplyData=rb;return M.g(ud,"ApplyPivotValueFieldSettings",Lb,Ub,oc,Nc,null,0)}}hR(rb){this.$.da.fb(40,()=>{this.STa.hR(rb)})}c6h(){this.$.userOperationManager.Ic(new I.a(123,0,(rb,Ub,oc)=>{var Nc=this.$.pa.xa;rb=Aa.b.call(null,rb,this.BTi);const ud=M.L(Nc,this.cell,this.externalSourceIndex,this.So);return M.g(Nc,"GetPivotValueFieldSettingsInitial",
ud,rb,Ub,oc,null,4)},16),this.Wd)}}Object(c.a)($c,"ValueFieldSettingsDialog",Lc.a,[]);const nd=r.a.a$g;class Oc extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateFieldWellContextMenu",1374696078,495005930,nd,!0,!1,nd,Ub,oc,!1,Nc);this.So=this.Fo=this.cell=null;this.x4d=this.externalSourceIndex=-1;this.dUa=0;this.rBc=-1;this.bM=null;this.e4a=this.YV=this.isOlap=!1}get ax(){return"PopulateFieldWellContextMenu"}get PB(){return r.a.EKd}executeCommand(rb,Ub,oc,Nc){rb=Ub.command;switch(rb){case -1453503574:Nc=
oc.domElement;this.Fo=oc.fieldItem;this.x4d=oc.zoneCount;this.dUa=oc.sourceAxis;this.rBc=oc.sourceAxisPos;this.So=oc.optionalPivotMenuAnchorParameter;this.bM=oc.versionkey;this.isOlap=oc.isOlap;this.YV=oc.isPpm;this.e4a="fieldItemsupportsImplicitMeasures"in oc?oc.fieldItemsupportsImplicitMeasures:!1;this.cell=oc.cell;this.externalSourceIndex=oc.externalSourceIndex;Q.h(this.$).Xo(!0);Nc=wb.DOMElementExtensions.getBounds(Nc);rb=new Sys.UI.Point(Nc.x,Nc.y+Nc.height);this.$.isChromeRtl&&(rb.x+=Nc.width);
"isKeyboardInput"in oc&&oc.isKeyboardInput?this.Tp(rb,!1,1):this.Tp(rb,!1);break;case 495005930:break;case -1170196828:nb.a(this.$).gK(this.Fo,this.dUa,this.rBc-1,this.bM,Ub);break;case -889576107:nb.a(this.$).gK(this.Fo,this.dUa,this.rBc+2,this.bM,Ub);break;case 2033235475:nb.a(this.$).gK(this.Fo,this.dUa,this.x4d,this.bM,Ub);break;case 389774337:nb.a(this.$).gK(this.Fo,this.dUa,0,this.bM,Ub);break;case -96230454:nb.a(this.$).gK(this.Fo,4,-1,this.bM,Ub);break;case 74086617:nb.a(this.$).gK(this.Fo,
1,-1,this.bM,Ub);break;case 1529312473:nb.a(this.$).gK(this.Fo,2,-1,this.bM,Ub);break;case 563292088:this.e4a&&d.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");nb.a(this.$).gK(this.Fo,8,-1,this.bM,Ub);break;case -1092351914:nb.a(this.$).gK(this.Fo,0,-1,this.bM,Ub);break;case -2141589616:const ud=T.GetServiceTaskFactory.Na(this.$.da,12,477,Nc.S4()),Lb=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
T.GetServiceTaskFactory.Na(this.$.da,498,499,Nc.S4()):Ua.Task.Ra(null);return C.TaskExtensions.za(C.TaskExtensions.Ed([ud,Lb],this.$.ka),()=>{(new $c(this.cell,this.So,this.externalSourceIndex,this.Fo.Name,this.$,Ub,ud.result,this.isOlap,this.YV,Lb.result)).initialize()},this.ka);default:return na.a(rb)}return Ua.Task.Ra(!0)}yc(rb,Ub,oc){rb=!1;switch(Ub.command){case -1453503574:rb=!!oc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:rb=
!0}return rb}xZ(){const rb=this.Va.gq(this.menuId);this.H5i(rb,this.rBc,this.x4d);this.I5i(rb,this.dUa);this.J5i(rb);8===this.dUa&&this.F5i(rb);return rb}H5i(rb,Ub,oc){const Nc=this.Va,ud=Nc.Fc();Ub||Ub!==oc-1?!Ub&&Ub<oc-1?(ud.buttons.push(Nc.pb(64)),ud.buttons.push(Nc.pb(61)),ud.buttons.push(Nc.pb(66)),ud.buttons.push(Nc.pb(63))):0<Ub&&Ub<oc-1?(ud.buttons.push(Nc.pb(60)),ud.buttons.push(Nc.pb(61)),ud.buttons.push(Nc.pb(62)),ud.buttons.push(Nc.pb(63))):0<Ub&&Ub===oc-1&&(ud.buttons.push(Nc.pb(60)),
ud.buttons.push(Nc.pb(65)),ud.buttons.push(Nc.pb(62)),ud.buttons.push(Nc.pb(67))):(ud.buttons.push(Nc.pb(64)),ud.buttons.push(Nc.pb(65)),ud.buttons.push(Nc.pb(66)),ud.buttons.push(Nc.pb(67)));rb.tc.push(ud)}I5i(rb,Ub){const oc=this.Va,Nc=oc.Fc(),ud=1!==Ub&&(!this.isOlap||this.YV||8!==Ub||this.e4a),Lb=2!==Ub&&(!this.isOlap||this.YV||8!==Ub||this.e4a),pc=8!==Ub&&-2!==this.Fo.PivotTableIndex&&(!this.isOlap||this.YV||this.e4a);Nc.buttons.push(oc.pb(4===Ub||this.Fo.IsSet||-2===this.Fo.PivotTableIndex||
this.isOlap&&!this.YV&&8===Ub&&!this.e4a?72:68));8===this.So.AnchorType||10===this.So.AnchorType?(Nc.buttons.push(oc.pb(ud?95:97)),Nc.buttons.push(oc.pb(Lb?96:98))):(Nc.buttons.push(oc.pb(ud?69:73)),Nc.buttons.push(oc.pb(Lb?70:74)));Nc.buttons.push(oc.pb(pc?71:75));rb.tc.push(Nc)}J5i(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(76));rb.tc.push(Ub)}F5i(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(77));rb.tc.push(Ub)}}Object(c.a)(Oc,"FieldWellContextMenu",x.a,[]);var Gd=a(1221);class Qd extends gc{constructor(rb,
Ub,oc,Nc){super(rb,"PopulatePivotContextMenu",2123758504,912277356,Ub,oc,Nc)}get ax(){return"PopulatePivotContextMenu"}get PB(){return r.a.vSf}executeCommand(rb,Ub,oc){let Nc=!1;const ud=Ub.command;switch(ud){case 37023044:Nc=this.Ecd(oc,Ub);break;case 541421805:case -569786022:Nc=this.hmd(rb,Ub)}return Nc?Ua.Task.Ra(!0):na.a(ud)}yc(rb,Ub,oc){rb=!1;switch(Ub.command){case 37023044:rb=!!oc;break;case 541421805:case -569786022:rb=!0}return rb}hmd(rb,Ub){var oc=8===rb,Nc=this.$,ud=Ta.a(Nc),Lb=Q.h(Nc).ha.Ta.$b;
let pc=rb=null;oc&&ud?(rb=ud.chartId,pc=ud.Vc):!oc&&Lb&&(rb=Lb.floatingObject.id,pc=Lb.floatingObject.Vc);return Qd.Jwe(pc,260)?(oc={},Nc.pk(oc),oc.FirstColumn=oc.FirstRow=-1,Nc={["rawEvent"]:null,["pivotName"]:null,["cell"]:oc,["requiresConfirmation"]:Qd.Jwe(pc,64),["dataSourceIndex"]:pc.ExternalSourceIndex},Lb?(ud=Lb.floatingObject,Nc.domElement=Lb.domElement,Nc.objectId=ud.id,Nc.objectVersion=ud.version):ud&&(Nc.domElement=ud.Il,Nc.objectId=ud.chartId,Nc.objectVersion=ud.YCe),Lb={AnchorType:7},
Lb.ChartId=rb,Lb.AnchorValue1=-1,Lb.AnchorValue2=-1,Nc.optionalPivotMenuAnchorParameter=Lb,this.Ecd(Nc,Ub)):!1}static Jwe(rb,Ub){return(rb.Attributes&Ub)===Ub}}Object(c.a)(Qd,"PivotFilterContextMenu",gc,[]);var Ad=a(1294);const Sd=(rb,Ub,oc,Nc,ud,Lb,pc,Ha,Bb,bc=null)=>{bc=rb.Oa(41,bc);bc.activeCell=Ub;bc.operationType=oc;bc.fieldCaption=Nc;bc.prevFieldCaption=ud;return M.g(rb,"ExecutePivotTableOperation",bc,Lb,pc,Ha,Bb,0)},Ce=(rb,Ub,oc,Nc,ud,Lb,pc,Ha=null)=>{Ha=rb.Oa(41,Ha);Ha.activeCell=Ub;Ha.pivotValueFieldSettingsApplyData=
oc;return M.g(rb,"ApplyValueFieldSettingsToPivotTable",Ha,Nc,ud,Lb,pc,0)};var we=a(148),Td=a(374),he=a(284),ee=a(28),ge=a(22);const re=r.a.e$g,Be=re+".RemoveField",Oe=re+".Subtotal",gf=re+".ClearFilter",af=re+".LayoutSameColumn",Ze=re+".LayoutNextColumn";class Xa extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulatePivotTableContextMenu",-1475408662,1114549926,re,!0,!1,"PivotTableContextMenuRootName",Ub,oc,!0,Nc);this.a4d=this.activeCell=this.kc=null;this.TZ=this.refresh=this.expandCollapse=this.Lrd=
this.Vkc=!1;this.Qbb=this.vb=this.V1a=this.pA=this.Ae=null;this.$ba=!1;this.TSi=ud=>{ud&&!U.a.dg(ud.Errors)&&this.kc&&(this.kc.kp=ud.Result,this.WMb());this.showPivotTableContextMenu()};this.SSi=()=>{};this.CWi=()=>{this.vdb()};this.BWi=()=>{this.vdb()};this.iNi=()=>{this.vdb()};this.hNi=()=>{this.vdb()};this.Dy=()=>{this.w1d();this.$ba=!1};this.$q=()=>{if(this.$ba){d.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const ud=this.kc;this.grid.Ab.Ap(this.grid.ha.ra.activeCell)!==ud&&(this.vdb(),this.Xbi())}};this.Dph=new DOMParser;this.FDj=!0;this.grid=Q.h(rb);this.Lnc=!0}get ax(){return"PopulatePivotTableContextMenu"}get PB(){return r.a.wSf}executeCommand(rb,Ub,oc){Ub=Ub.command;rb=null;this.grid=Q.h(this.$);this.activeCell=D.o(this.grid.ha.ra.activeCell,this.$);if(this.$.isEditMode&&(this.kc=this.grid.Ab.Ap(this.grid.ha.ra.activeCell),!this.kc))return d.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
C.TaskExtensions.sba();this.a4d=this.$.pa.xa;this.V1a=Object(Qb.a)(sa.a,oc.eventArgs);switch(Ub){case 671488277:this.tFj()?this.D_h():(this.vdb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.nTa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.nTa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.nTa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.nTa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.nTa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.nTa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:oc=Number.parseInvariant(oc.MenuItemId.split(".")[2]);this.nTa(11,oc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Xc(-1556797033,B.a.Db,8,null);break;case 1514686611:this.myi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:oc=Number.parseInvariant(oc.MenuItemId);this.i5g(oc);break;case 1778578888:oc=Number.parseInvariant(oc.MenuItemId);this.ASg(oc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:rb=na.a(Ub)}return rb||C.TaskExtensions.sba()}yc(rb,Ub){rb=!1;switch(Ub.command){case 671488277:rb=
ab.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:rb=!0;break;case 1600778266:rb=!0;break;case -556893687:rb=!0;break;case -1966978671:rb=!0;break;case -1951357930:rb=!0;break;case -1390365353:case -1457478532:rb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:rb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:rb=
!0;break;case -1007663920:case 234234584:case 1194992911:rb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:rb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:rb=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return rb}tFj(){if(!this.$.isEditMode||this.kc.Hic)return!1;let rb=this.A8f(!1);return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.kc.isOlap||rb:!this.kc.Ijc()||rb}nc(rb,Ub){let oc=!1;switch(Ub){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:oc=this.DS();break;case -1007663920:case 234234584:oc=this.XDj()||this.DS();break;case 1194992911:oc=this.YDj()||this.DS();break;
case 1217404289:oc=!Ad.j(this.vb.LabelOrDateFilterType)||this.DS();break;case -743135194:oc=!Ad.m(this.vb.ValueFilterType)&&!Ad.l(this.vb.ValueFilterType)||this.DS();break;case 771421327:oc=0===this.vb.LabelOrDateFilterType&&0===this.vb.ValueFilterType&&!this.vb.HasManualFilter||this.DS();break;case 1015867427:oc=!Ad.i(this.vb.LabelOrDateFilterType)||this.DS();break;case 1105960559:oc=!Ad.k(this.vb.LabelOrDateFilterType)||this.DS()}return oc||super.nc(rb,Ub)}vdb(){this.Qbb=this.vb=this.Ae=null}LYd(){this.grid.$T(this.$q);
this.$.Ka.b_a(this.Dy)}w1d(){this.grid.IO(this.$q);this.$.Ka.CKb(this.Dy)}WMb(){if(this.kc&&this.kc.kp){this.Ae=this.kc.kp;this.vb=this.kc.Ycc();if(this.o9f()){const rb=this.kc.BL[4===this.Ae.CellType?this.kc.B8c-1:this.Ae.CurrentFieldIndex-1];rb&&(this.Qbb=-2===rb.Index?this.kc.tLe:rb.Caption)}this.Ifi();this.vb&&8===this.Ae.CellArea&&(this.pA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.vb.DataFieldAggregationType,this.pA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.vb.DataFieldFormatType,
this.pA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.vb.BaseFieldIndex,this.pA.PivotValueFieldTitle=this.vb.Caption)}}A8f(rb){return this.kc?this.kc.isOlap&&!this.kc.lOa(!rb):!1}eEj(){const rb=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.vb.MeasureType&&(!this.kc.umf||rb&&2===this.vb.MeasureType)}xZ(){const rb=this.Va.gq(this.menuId),Ub=this.Va.Fc(),oc=Q.h(this.$).Ub(null);if(this.kc)this.Ae&&this.kc.kp&&this.Ae!==this.kc.kp&&
d.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.vb&&this.vb!==this.kc.Ycc()&&d.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return rb;this.ILh(rb);if(this.$.isEditMode){this.refresh&&this.YMh(rb);if(this.Ae&&this.vb){var Nc=this.Va.Fc();this.lNh(Nc);this.XLh(Nc);rb.tc.push(Nc)}this.TZ&&Ub.buttons.push(this.Va.pb(99));this.Ae&&this.vb&&this.vMh(rb);if(this.expandCollapse){Nc=this.Va.xw("ContextMenu.PivotExpandCollapse",
null,W.a.instance.ga(1163),589118293);const ud=this.Va.Fc();ud.buttons.push(this.Va.pb(243));ud.buttons.push(this.Va.pb(244));ud.buttons.push(this.Va.pb(245));ud.buttons.push(this.Va.pb(246));Nc.menu.tc.push(ud);Nc&&0<ud.buttons.length&&Ub.buttons.push(Nc)}this.Ae&&(Nc=this.Va.Fc(),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.GMh(Nc),this.ZMh(Nc),0<Nc.buttons.length&&rb.tc.push(Nc));this.Ae&&this.vb&&8===this.Ae.CellArea&&8!==this.Ae.CellType&&
(Nc=this.Va.Fc(),this.eEj()&&this.nNh(Nc),3!==this.Ae.CellType&&this.iNh(Nc),rb.tc.push(Nc));!this.kc.Ijc()&&""!==(null===oc||void 0===oc?void 0:oc.text)&&this.Ae&&0===this.Ae.CellType&&Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.hNh(rb);this.tri()?Ub.buttons.push(this.Va.pb(257)):Ub.buttons.push(this.Va.pb(258));this.Lrd?Ub.buttons.push(this.Va.pb(59)):Ub.buttons.push(this.Va.pb(58))}rb.tc.push(Ub);return rb}ETa(){return this.vb&&this.vb.Caption?20<
this.vb.Caption.length:!1}pLa(rb){return this.vb&&this.vb.Caption?rb?this.vb.Caption.substring(0,20)+"...":this.vb.Caption:""}bwa(rb){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?ge.a.hashCode(rb).toString():rb}lNh(rb){if(this.Ae&&this.vb&&4!==this.Ae.CellArea){var Ub=this.Vja(this.MH("PivotTableContextMenu.Sort",this.bwa(this.vb.Caption)),-1777747317,0,0!==this.vb.SortInfo,W.a.instance.ga(227)),oc=this.Va.Fc();oc.buttons.push(this.Td("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.vb.SortInfo,W.a.instance.ga(228)));oc.buttons.push(this.Td("PivotTableContextMenu.SortDescending",234234584,0,2===this.vb.SortInfo,W.a.instance.ga(229)));1!==this.Ae.CellArea&&2!==this.Ae.CellArea||oc.buttons.push(this.Td("PivotTableContextMenu.SortByValue",1194992911,0,3===this.vb.SortInfo||4===this.vb.SortInfo,W.a.instance.ga(154)));Ub.menu.tc.push(oc);Ub&&0<oc.buttons.length&&rb.buttons.push(Ub)}}XLh(rb){if(this.Ae&&this.vb&&(1===this.Ae.CellArea||2===this.Ae.CellArea)){var Ub=
this.sFj();const Lb=this.Vja(this.MH("PivotTableContextMenu.Filter",this.bwa(this.vb.Caption)),-1777747317,0,Ub,W.a.instance.ga(651)),pc=this.Va.Fc();var oc="",Nc=this.ETa(),ud=String.format(W.a.instance.mb(156),this.pLa(Nc));Nc&&(oc=String.format(W.a.instance.mb(156),this.vb.Caption));Ub=this.bwa(this.vb.Caption)+"."+(Ub?"enabled":"disabled");oc=this.Td(this.MH(gf,Ub),771421327,0,!1,ud,"0",oc,8,Ma.a.R3a);Ub=this.bwa(this.vb.Caption)+"."+this.vb.LabelOrDateFilterType.toString();this.vb.IsDateField?
(ud=this.Vja(this.MH("PivotTableContextMenu.DateFilter",Ub),-1777747317,0,0!==this.vb.LabelOrDateFilterType,W.a.instance.ga(97)),this.LLh(ud.menu)):(ud=this.Vja(this.MH("PivotTableContextMenu.LabelFilter",Ub),-1777747317,0,0!==this.vb.LabelOrDateFilterType,W.a.instance.ga(649)),this.uMh(ud.menu));Ub=this.bwa(this.vb.Caption)+"."+this.vb.ValueFilterType.toString();Ub=this.Vja(this.MH("PivotTableContextMenu.ValueFilter",Ub),-1777747317,0,0!==this.vb.ValueFilterType,W.a.instance.ga(650));this.zNh(Ub.menu);
Nc=this.Va.Fc();Nc.buttons.push(this.Td("PivotTableContextMenu.ManualFilter",1514686611,0,this.vb.HasManualFilter,W.a.instance.ga(94)));pc.buttons.push(oc);pc.buttons.push(ud);pc.buttons.push(Ub);Lb.menu.tc.push(pc);Lb.menu.tc.push(Nc);Lb&&0<pc.buttons.length&&rb.buttons.push(Lb)}}LLh(rb){rb.tc.push(this.tdc(!0,!1));rb.tc.push(this.TSh());rb.tc.push(this.SSh());rb.tc.push(this.IUh());rb.tc.push(this.LUh());rb.tc.push(this.JUh());rb.tc.push(this.KUh());rb.tc.push(this.MUh());rb.tc.push(this.NUh());
rb.tc.push(this.GSh())}ALh(rb){rb.tc.push(this.tdc(!0,!0));rb.tc.push(this.z0h());rb.tc.push(this.NYh())}uMh(rb){rb.tc.push(this.tdc(!0,!1));rb.tc.push(this.M3e(!0));rb.tc.push(this.kPh());rb.tc.push(this.RRh());rb.tc.push(this.K2e(!0));rb.tc.push(this.P1e(!0))}zNh(rb){rb.tc.push(this.tdc(!1,!1));rb.tc.push(this.M3e(!1));rb.tc.push(this.K2e(!1));rb.tc.push(this.P1e(!1));rb.tc.push(this.X4h())}X4h(){const rb=this.Va.Fc();rb.buttons.push(this.Td("PivotTableContextMenu.Top10",-1611233597,0,Ad.l(this.vb.ValueFilterType),
W.a.instance.ga(105)));return rb}RRh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.Contains",786260386,0,10===this.vb.LabelOrDateFilterType,W.a.instance.ga(652),"10")),rb.buttons.push(this.Td("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.vb.LabelOrDateFilterType,W.a.instance.ga(653),"11")));return rb}kPh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.BeginsWith",786260386,0,6===this.vb.LabelOrDateFilterType,W.a.instance.ga(654),
"6")),rb.buttons.push(this.Td("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.vb.LabelOrDateFilterType,W.a.instance.ga(655),"7")),rb.buttons.push(this.Td("PivotTableContextMenu.EndsWith",786260386,0,8===this.vb.LabelOrDateFilterType,W.a.instance.ga(656),"8")),rb.buttons.push(this.Td("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.vb.LabelOrDateFilterType,W.a.instance.ga(657),"9")));return rb}M3e(rb){const Ub=this.Va.Fc();if(this.vb){const oc=rb?Ad.c:Ad.f;Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.Equals",
oc),786260386,0,rb?4===this.vb.LabelOrDateFilterType:18===this.vb.ValueFilterType,W.a.instance.ga(100),rb?"4":"18"));Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.DoesNotEqual",oc),786260386,0,rb?5===this.vb.LabelOrDateFilterType:19===this.vb.ValueFilterType,W.a.instance.ga(101),rb?"5":"19"))}return Ub}K2e(rb){const Ub=this.Va.Fc();if(this.vb){const oc=rb?Ad.c:Ad.f;Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.GreaterThan",oc),786260386,0,rb?12===this.vb.LabelOrDateFilterType:20===
this.vb.ValueFilterType,W.a.instance.ga(102),rb?"12":"20"));Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.GreaterThanOrEqualTo",oc),786260386,0,rb?13===this.vb.LabelOrDateFilterType:21===this.vb.ValueFilterType,W.a.instance.ga(658),rb?"13":"21"));Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.LessThan",oc),786260386,0,rb?14===this.vb.LabelOrDateFilterType:22===this.vb.ValueFilterType,W.a.instance.ga(103),rb?"14":"22"));Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.LessThanOrEqualTo",
oc),786260386,0,rb?15===this.vb.LabelOrDateFilterType:23===this.vb.ValueFilterType,W.a.instance.ga(659),rb?"15":"23"))}return Ub}P1e(rb){const Ub=this.Va.Fc();if(this.vb){const oc=rb?Ad.c:Ad.f;Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.Between",oc),786260386,0,rb?16===this.vb.LabelOrDateFilterType:24===this.vb.ValueFilterType,W.a.instance.ga(104),rb?"16":"24"));Ub.buttons.push(this.Td(this.MH("PivotTableContextMenu.NotBetween",oc),786260386,0,rb?17===this.vb.LabelOrDateFilterType:25===
this.vb.ValueFilterType,W.a.instance.ga(660),rb?"17":"25"))}return Ub}tdc(rb,Ub){const oc=this.Va.Fc();if(this.vb){var Nc=W.a.instance.ga(98);const Lb=rb?this.vb.LabelOrDateFilterType.toString():this.vb.ValueFilterType.toString();var ud=["PivotTableContextMenu.ClearFilter",this.bwa(this.vb.Caption),Lb];rb=rb?this.vb.IsDateField?Ub?1015867427:1105960559:1217404289:-743135194;ud.push(rb.toString());ud=ud.join(".");Nc=this.Td(ud,rb,0,!1,Nc,Lb,Nc,8,Ma.a.R3a);oc.buttons.push(Nc)}return oc}TSh(){const rb=
this.Va.Fc();this.vb&&rb.buttons.push(this.Td(this.MH("PivotTableContextMenu.Equals",Ad.d),786260386,0,26===this.vb.LabelOrDateFilterType,W.a.instance.ga(100),"26"));return rb}SSh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.Before",786260386,0,27===this.vb.LabelOrDateFilterType,W.a.instance.ga(112),"27")),rb.buttons.push(this.Td("PivotTableContextMenu.After",786260386,0,28===this.vb.LabelOrDateFilterType,W.a.instance.ga(113),"28")),rb.buttons.push(this.Td("PivotTableContextMenu.Between",
786260386,0,29===this.vb.LabelOrDateFilterType,W.a.instance.ga(104),"29")));return rb}IUh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.vb.LabelOrDateFilterType,W.a.instance.ga(110),"30")),rb.buttons.push(this.Td("PivotTableContextMenu.Today",1778578888,0,31===this.vb.LabelOrDateFilterType,W.a.instance.ga(109),"31")),rb.buttons.push(this.Td("PivotTableContextMenu.Yesterday",1778578888,0,32===this.vb.LabelOrDateFilterType,W.a.instance.ga(111),
"32")));return rb}LUh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.NextWeek",1778578888,0,33===this.vb.LabelOrDateFilterType,W.a.instance.ga(115),"33")),rb.buttons.push(this.Td("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.vb.LabelOrDateFilterType,W.a.instance.ga(114),"34")),rb.buttons.push(this.Td("PivotTableContextMenu.LastWeek",1778578888,0,35===this.vb.LabelOrDateFilterType,W.a.instance.ga(116),"35")));return rb}JUh(){const rb=this.Va.Fc();this.vb&&
(rb.buttons.push(this.Td("PivotTableContextMenu.NextMonth",1778578888,0,36===this.vb.LabelOrDateFilterType,W.a.instance.ga(117),"36")),rb.buttons.push(this.Td("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.vb.LabelOrDateFilterType,W.a.instance.ga(118),"37")),rb.buttons.push(this.Td("PivotTableContextMenu.LastMonth",1778578888,0,38===this.vb.LabelOrDateFilterType,W.a.instance.ga(119),"38")));return rb}KUh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.vb.LabelOrDateFilterType,W.a.instance.ga(120),"39")),rb.buttons.push(this.Td("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.vb.LabelOrDateFilterType,W.a.instance.ga(121),"40")),rb.buttons.push(this.Td("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.vb.LabelOrDateFilterType,W.a.instance.ga(122),"41")));return rb}MUh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.NextYear",1778578888,0,42===this.vb.LabelOrDateFilterType,
W.a.instance.ga(123),"42")),rb.buttons.push(this.Td("PivotTableContextMenu.ThisYear",1778578888,0,43===this.vb.LabelOrDateFilterType,W.a.instance.ga(124),"43")),rb.buttons.push(this.Td("PivotTableContextMenu.LastYear",1778578888,0,44===this.vb.LabelOrDateFilterType,W.a.instance.ga(125),"44")));return rb}NUh(){const rb=this.Va.Fc();if(this.vb){rb.buttons.push(this.Td("PivotTableContextMenu.YearToDate",1778578888,0,45===this.vb.LabelOrDateFilterType,W.a.instance.ga(126),"45"));const Ub=this.Vja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Ad.i(this.vb.LabelOrDateFilterType),W.a.instance.ga(127));this.ALh(Ub.menu);rb.buttons.push(Ub)}return rb}GSh(){const rb=this.Va.Fc();this.vb&&rb.buttons.push(this.Td("PivotTableContextMenu.CustomFilter",786260386,0,this.pFj(this.vb.LabelOrDateFilterType),W.a.instance.ga(108),"26"));return rb}z0h(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.Quarter1",1778578888,0,46===this.vb.LabelOrDateFilterType,W.a.instance.ga(128),"46")),rb.buttons.push(this.Td("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.vb.LabelOrDateFilterType,W.a.instance.ga(129),"47")),rb.buttons.push(this.Td("PivotTableContextMenu.Quarter3",1778578888,0,48===this.vb.LabelOrDateFilterType,W.a.instance.ga(130),"48")),rb.buttons.push(this.Td("PivotTableContextMenu.Quarter4",1778578888,0,49===this.vb.LabelOrDateFilterType,W.a.instance.ga(131),"49")));return rb}NYh(){const rb=this.Va.Fc();this.vb&&(rb.buttons.push(this.Td("PivotTableContextMenu.January",1778578888,0,50===this.vb.LabelOrDateFilterType,W.a.instance.ga(132),
"50")),rb.buttons.push(this.Td("PivotTableContextMenu.February",1778578888,0,51===this.vb.LabelOrDateFilterType,W.a.instance.ga(133),"51")),rb.buttons.push(this.Td("PivotTableContextMenu.March",1778578888,0,52===this.vb.LabelOrDateFilterType,W.a.instance.ga(134),"52")),rb.buttons.push(this.Td("PivotTableContextMenu.April",1778578888,0,53===this.vb.LabelOrDateFilterType,W.a.instance.ga(135),"53")),rb.buttons.push(this.Td("PivotTableContextMenu.May",1778578888,0,54===this.vb.LabelOrDateFilterType,W.a.instance.ga(136),
"54")),rb.buttons.push(this.Td("PivotTableContextMenu.June",1778578888,0,55===this.vb.LabelOrDateFilterType,W.a.instance.ga(137),"55")),rb.buttons.push(this.Td("PivotTableContextMenu.July",1778578888,0,56===this.vb.LabelOrDateFilterType,W.a.instance.ga(138),"56")),rb.buttons.push(this.Td("PivotTableContextMenu.August",1778578888,0,57===this.vb.LabelOrDateFilterType,W.a.instance.ga(139),"57")),rb.buttons.push(this.Td("PivotTableContextMenu.September",1778578888,0,58===this.vb.LabelOrDateFilterType,
W.a.instance.ga(140),"58")),rb.buttons.push(this.Td("PivotTableContextMenu.October",1778578888,0,59===this.vb.LabelOrDateFilterType,W.a.instance.ga(141),"59")),rb.buttons.push(this.Td("PivotTableContextMenu.November",1778578888,0,60===this.vb.LabelOrDateFilterType,W.a.instance.ga(142),"60")),rb.buttons.push(this.Td("PivotTableContextMenu.December",1778578888,0,61===this.vb.LabelOrDateFilterType,W.a.instance.ga(143),"61")));return rb}vMh(rb){const Ub=this.Va.Fc();if(this.o9f()){var oc=this.kc.BL[4===
this.Ae.CellType?this.kc.B8c-1:this.Ae.CurrentFieldIndex-1];if(oc&&this.Qbb){var Nc=this.Va.xw("ContextMenu.PivotTableLayout",null,W.a.instance.ga(647),-1777747317);var ud=this.Va.Fc();const Lb=String.format(W.a.instance.mb(169),this.Qbb),pc=String.format(W.a.instance.mb(170),this.Qbb);ud.buttons.push(this.Td(Ze,-1457478532,0,!oc.IsCompactLayout,Lb));ud.buttons.push(this.Td(af,-1390365353,0,oc.IsCompactLayout,pc));Nc.menu.tc.push(ud);Nc&&Ub.buttons.push(Nc)}}if(1===this.Ae.CellArea||2===this.Ae.CellArea)this.vb.Caption&&
(oc="",ud=this.ETa(),Nc=String.format(W.a.instance.mb(159),this.pLa(ud)),ud&&(oc=String.format(W.a.instance.mb(159),this.vb.Caption)),1===this.Ae.CellArea?(oc=this.Vja("ContextMenu.PivotTableSubtotal",1801458190,0,this.vb.ShowSubtotal,Nc),Nc=this.Va.Fc(),Nc.buttons.push(this.Va.pb(259)),Nc.buttons.push(this.Td("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.vb.ShowSubtotal&&this.vb.ShowSubtotalAtTop)),Nc.buttons.push(this.Td("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.vb.ShowSubtotal&&
!this.vb.ShowSubtotalAtTop)),oc.menu.tc.push(Nc),oc&&0<Nc.buttons.length&&Ub.buttons.push(oc)):(ud=ud?this.MH(Oe,this.bwa(Nc)):Oe,Ub.buttons.push(this.Td(ud,1801458190,0,this.vb.ShowSubtotal,Nc,null,oc)))),Ub.buttons.push(this.Td("ContextMenu.RepeatItemLabels",-556893687,642,this.vb.RepeatItemLabels));1===this.Ae.CellArea&&Ub.buttons.push(this.Td("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.vb.ShowBlankLineAfterEachItem));rb.tc.push(Ub)}hNh(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(247));
rb.tc.push(Ub)}GMh(rb){if(this.$.isEditMode&&this.grid){var Ub=this.grid.ha.ra.activeRange;if(Ub.top===Ub.bottom&&Ub.left===Ub.right&&0!==this.Ae.MoveItemsMenuState){Ub=this.Vja("PivotTableContextMenu.Move",-1777747317,0,!1,W.a.instance.ga(73));var oc=this.Va.Fc();this.Dva(oc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(W.a.instance.mb(162),this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&1));this.Dva(oc,"PivotTableContextMenu.MoveUp",713270357,String.format(W.a.instance.mb(163),
this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&2));this.Dva(oc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(W.a.instance.mb(160),this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&4));this.Dva(oc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(W.a.instance.mb(161),this.Ae.MoveItemName),0===(this.Ae.MoveItemsMenuState&8));Ub.menu.tc.push(oc);oc=this.Va.Fc();this.Dva(oc,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(W.a.instance.mb(167),this.pLa(this.ETa())),
0===(this.Ae.MoveItemsMenuState&16));this.Dva(oc,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(W.a.instance.mb(164),this.pLa(this.ETa())),0===(this.Ae.MoveItemsMenuState&32));this.Dva(oc,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(W.a.instance.mb(165),this.pLa(this.ETa())),0===(this.Ae.MoveItemsMenuState&64));this.Dva(oc,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(W.a.instance.mb(166),this.pLa(this.ETa())),0===(this.Ae.MoveItemsMenuState&
128));Ub.menu.tc.push(oc);rb.buttons.push(Ub)}}}ZMh(rb){var Ub="";let oc="";var Nc=!1;3===this.Ae.CellType?Ub=W.a.instance.ga(644):8===this.Ae.CellType?this.kc&&(Ub=String.format(W.a.instance.mb(168),this.kc.tLe)):this.vb&&((Nc=this.ETa())&&(oc=String.format(W.a.instance.mb(168),this.vb.Caption)),Ub=String.format(W.a.instance.mb(168),this.pLa(Nc)));Ub&&(Nc=Nc?this.MH(Be,this.bwa(Ub)):Be,Ub=this.Td(Nc,-1951357930,0,!1,Ub,null,oc,8,Ma.a.acd),rb.buttons.push(Ub))}ILh(rb){const Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(43));
this.vb&&this.Ae&&this.$.isEditMode&&(0===this.Ae.CellType||4===this.Ae.CellType)&&Ub.buttons.push(this.Va.pb(136));if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&Y.EwaSettings.oa(102)&&this.grid&&this.grid.ha){const oc=this.grid.ha.ra.selectedRanges;oc&&1===oc.length&&(oc[0].isSingle||this.grid.Ab.bOa(oc[0]))&&this.grid.Ab.Sxa(oc[0])&&!this.grid.Ab.xAb(oc[0])&&Ub.buttons.push(this.Va.pb(this.grid.Ab.hif(oc[0])?217:216))}rb.tc.push(Ub)}YMh(rb){const Ub=
this.Va.Fc();Ub.buttons.push(this.Va.pb(100));rb.tc.push(Ub)}nNh(rb){const Ub=2===this.vb.MeasureType&&!this.vb.IsNumeric,oc=this.Va.xw("ContextMenu.SummarizeValuesBy",null,W.a.instance.ga(645),-249874296),Nc=this.Va.Fc();Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesBySum",-1255320719,1102,0===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Ub));Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByCount",1746132849,1103,1===this.vb.DataFieldAggregationType));Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByAverage",
-771066011,1104,2===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Ub));Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByMax",835007294,1105,3===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Ub));Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByMin",929115636,1106,4===this.vb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Ub));Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByProduct",1935475057,1107,5===this.vb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.A8f(!0)||Ub));2!==this.vb.MeasureType&&(Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1108,6===this.vb.DataFieldAggregationType)),Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByStdDeviation",588680636,1109,7===this.vb.DataFieldAggregationType)),Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1110,8===this.vb.DataFieldAggregationType)),Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByVariant",
1668427539,1111,9===this.vb.DataFieldAggregationType)),Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1112,10===this.vb.DataFieldAggregationType)));this.kc&&this.kc.Ijc()&&Nc.buttons.push(this.Td("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1113,11===this.vb.DataFieldAggregationType));oc.menu.tc.push(Nc);rb.buttons.push(oc)}iNh(rb){const Ub=this.Va.xw("ContextMenu.ShowValuesAs",null,W.a.instance.ga(646),-1128612833),oc=this.Va.Fc();oc.buttons.push(this.Td("ContextMenu.ShowValuesAsNoCalculation",
-841863025,1119,0===this.vb.DataFieldFormatType));oc.buttons.push(this.Td("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1126,7===this.vb.DataFieldFormatType));oc.buttons.push(this.Td("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1125,6===this.vb.DataFieldFormatType));oc.buttons.push(this.Td("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1124,5===this.vb.DataFieldFormatType));oc.buttons.push(this.Td("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1129,9===this.vb.DataFieldFormatType));
oc.buttons.push(this.Td("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1130,10===this.vb.DataFieldFormatType));if(this.kc&&this.kc.BL&&0<this.kc.BL.length||this.kc.X$&&0<this.kc.X$.length){const Nc=this.Vja("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1131,11===this.vb.DataFieldFormatType),ud=this.Va.Fc(),Lb=this.mNh();for(let pc=0;pc<Lb.length;pc++){const Ha=Lb[pc];ud.buttons.push(this.Td("ContextMenu.ShowValuesAsPercentOfParentTotal."+Ha.Caption,-2031744961,1131,11===this.vb.DataFieldFormatType&&
this.vb.BaseFieldIndex===Ha.Index,Ha.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Ha.Index))}Nc.menu.tc.push(ud);oc.buttons.push(Nc)}Ub.menu.tc.push(oc);rb.buttons.push(Ub)}showPivotTableContextMenu(){this.Lrd=!0;this.expandCollapse=this.TZ=this.refresh=!1;var rb=this.$,Ub=Q.h(rb),oc=dc.a(rb).HLa();if(oc){var Nc=nb.a(rb);if(null===Nc||void 0===Nc?0:Nc.dVd)this.Lrd=Fa.f(rb.lg);Nc=rb.dc;this.TZ=oc.supportsBIExplore&&!!Da.a(rb)&&Nc.h3(32768);Nc.allowInteractivity&&(rb=Ub.Ub(null),(null===
rb||void 0===rb?0:rb.cell)&&(rb.cell.R1c||rb.cell.l9f)&&(this.expandCollapse=!0),Nc.allowManualDataRefresh&&(this.refresh=!0))}rb=null;oc=1;this.V1a&&1!==this.V1a.tb?(rb=new Sys.UI.Point(this.V1a.clientPoint.x,this.V1a.clientPoint.y),oc=this.V1a.tb):(Ub=ab.e(Ub,this.$))&&(rb=new Sys.UI.Point(Ub.x+(this.$.isChromeRtl?0:Ub.width),Ub.y+Ub.height));B.a.Db=oc;this.Vkc=3===oc;this.Tp(rb,!0,oc);this.$ba=!0;this.LYd()}Xbi(){const rb=new L.a(1114549926,0,this.$.Hc,19,null);this.$.Ka.Lb(rb)}D_h(){if(this.kc&&
this.kc.kp){var rb=this.kc.kp.CurrentCol;if(this.kc.kp.CurrentRow===this.activeCell.FirstRow&&rb===this.activeCell.FirstColumn){this.WMb();this.showPivotTableContextMenu();return}}rb=new I.a(228,0,(Ub,oc,Nc)=>he.l(this.$.pa.xa,this.activeCell,Aa.b(Ub,this.TSi),Aa.a(oc,this.SSi),Nc,null),16);this.$.userOperationManager.Ic(rb,null)}tri(){if(Oa.a.gd(this.$)){var rb=this.$.da.Aa(441);if(rb)return rb.ns}else if(rb=this.$.da.Aa(346))return rb.ns;return!1}MH(rb,Ub){return rb+"."+Ub}performPivotTableOperation(rb,
Ub){const oc=ee.a.Sa.zb;if(!this.kc||!this.vb&&this.Ae&&3!==this.Ae.CellType)this.uj();else{var Nc=this.kc.isOlap;dc.a(this.$).Vx(Nc,ud=>{ud&&this.$.Ic(rb,(Lb,pc,Ha)=>Sd(this.a4d,this.activeCell,Ub,this.vb?this.vb.Caption:null,this.Qbb,Aa.b(Lb,this.CWi),Aa.a(pc,this.BWi),Ha,null,this.$.pa.xa.Wb()),oc,0,4,229)})}}applyValueFieldSettingsToPivotTable(rb,Ub=!1){const oc=ee.a.Sa.zb;this.kc&&this.vb?(Ub&&2===this.vb.MeasureType&&d.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),
Ub=this.kc.isOlap,dc.a(this.$).Vx(Ub,Nc=>{Nc&&this.$.Ic(rb,(ud,Lb,pc)=>Ce(this.a4d,this.activeCell,this.pA,Aa.b(ud,this.iNi),Aa.a(Lb,this.hNi),pc,null,this.$.pa.xa.Wb()),oc,0,4,231)})):this.uj()}Td(rb,Ub,oc,Nc,ud=null,Lb=null,pc=null,Ha=8,Bb=null,bc=!1){Nc&&(rb+=".Checked");bc&&(rb+=".Disabled");this.Va.yqd(rb)&&this.Va.wMd(rb);oc=ud||W.a.instance.ga(oc);rb=this.Va.MIa(rb,oc,Ub,null,"None",Lb,bc,null);rb.Xyc(null);pc&&rb.yS(pc);Nc?rb.AS("Image16by16",3,Ma.a.Iaa):Bb?rb.AS("Image16by16",Ha,Bb):rb.Q4b();
return rb}Vja(rb,Ub,oc,Nc,ud=null){oc=ud||W.a.instance.ga(oc);this.Va.yqd(rb)?this.Va.wMd(rb):this.Va.wMd(rb+".Checked");Nc&&(rb+=".Checked");this.FDj&&(oc=this.Dph.parseFromString(oc,"text/html").body.innerText);rb=this.Va.H6c(rb,null,oc,Ub,3,Ma.a.Iaa);rb.Oef=Nc;!Nc&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&rb.Q4b();return rb}Ifi(){this.pA=Object(f.a)(new Ec,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new $d,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new ec,
{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}nTa(rb,Ub){this.pA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=rb;this.pA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Ub;this.pA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}mNh(){const rb=[];if(this.kc&&this.kc.X$&&0<this.kc.X$.length)for(const Ub of this.kc.X$)Ub&&rb.push(Ub);if(this.kc&&this.kc.BL&&0<this.kc.BL.length)for(const Ub of this.kc.BL)Ub&&rb.push(Ub);rb.sort((Ub,
oc)=>Ub.Index-oc.Index);return rb}o9f(){if(!this.Ae||!this.kc||!this.kc.BL)return!1;const rb=1===this.Ae.CellArea||4===this.Ae.CellType&&this.Ae.IsRowAxis,Ub=4===this.Ae.CellType?0<this.kc.B8c:0<this.Ae.CurrentFieldIndex;return 1<this.kc.BL.length&&rb&&Ub}rLa(rb){const Ub=[];3===rb?this.$.isEditMode?Ub.push(...[qb.a.CNf,qb.a.ENf,qb.a.p4i]):Ub.push(...[qb.a.copy]):2===rb&&Ub.push(qb.a.yCe);return Ub}uj(){const rb=U.a.dd(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Dc.a(this.$).uj(rb)}sFj(){return this.vb?
0!==this.vb.LabelOrDateFilterType||0!==this.vb.ValueFilterType||this.vb.HasManualFilter:!1}pFj(rb){return 62<=rb&&65>=rb}myi(){if(this.activeCell&&this.vb&&this.kc){var rb={};rb.cell=this.activeCell;rb.dataSourceIndex=this.kc.externalSourceIndex;rb.fieldId=this.vb.Index.toString();rb.isOlap=this.kc.isOlap;rb.confirmationRequired=this.kc.confirmationRequiredForDataOps;var Ub={};Ub.showPivotFilterDialogCommandData=rb;this.$.Xc(492140419,B.a.Db,19,Ub)}}i5g(rb){this.activeCell&&this.vb&&this.kc&&this.$.userOperationManager.Ic(new I.a(153,
0,(Ub,oc,Nc)=>M.A(this.$.pa.xa,this.activeCell,this.kc.externalSourceIndex,this.vb.Index.toString(),rb,Ub,oc,Nc,null,null)),null)}ASg(rb){!(30>rb||61<rb)&&this.activeCell&&this.vb&&this.kc&&this.$.userOperationManager.Ic(new I.a(152,0,(Ub,oc,Nc)=>M.e(this.$.pa.xa,this.activeCell,this.kc.externalSourceIndex,this.vb.Index.toString(),rb,Ub,oc,Nc,null,null)),null)}applyPivotSort(rb){if(this.kc&&this.vb&&this.activeCell&&this.Ae){var Ub=1===this.Ae.CellArea||2===this.Ae.CellArea;8===this.Ae.CellArea?Td.a(this.$.userOperationManager,
(oc,Nc,ud)=>he.b(this.$.pa.xa,this.activeCell,rb,this.vb.Caption,oc,Nc,ud,null),oc=>new I.a(1015,0,oc,void 0,null),null):Ub&&(Ub=1===this.Ae.CellArea?1:2,this.$.oa(647)?we.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),this.vb.Caption,this.kc.isOlap?"":this.vb.Caption,Ub,1===rb):we.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.kc.externalSourceIndex,this.vb.Index.toString(),1===
rb))}}DS(){return!this.kc||!this.kc.isActionable}XDj(){return(this.Ae||this.kc)&&4!==this.Ae.CellType&&(0!==this.Ae.CellType||8!==this.Ae.CellArea||this.kc.X$&&this.kc.X$.length||this.kc.BL&&this.kc.BL.length)?!1:!0}YDj(){return this.Ae&&this.kc&&(1===this.Ae.CellArea||2===this.Ae.CellArea)&&this.kc.JRb&&this.kc.JRb.length?!1:!0}Dva(rb,Ub,oc,Nc,ud){rb.buttons.push(this.Td(Ub,oc,0,!1,Nc,null,null,8,null,ud))}}Object(c.a)(Xa,"PivotTableContextMenu",x.a,[]);class qa{compare(rb,Ub){return(rb||"").localeCompare(Ub||
"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)(qa,"DigitsAsNumberComparer",null,[421]);var xa=a(1083),ob=a(154),Ib=a(348),Zb=a(263),zc=a(24),Mc=a(145);const hd=r.a.g$g;class id extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateTableFieldListContextMenu",-751848458,-1085236154,hd,!0,!1,"TableFieldListContextMenuRoot",Ub,oc,!1,Nc);this.y7b=null;this.BCd=0;this.BFa=null;this.grid=Q.h(rb)}get ax(){return"PopulateTableFieldListContextMenu"}get PB(){return r.a.ySf}get pL(){this.BFa||(this.BFa=
this.$.da.Aa(261));return this.BFa}executeCommand(rb,Ub,oc){rb=Ub.command;switch(rb){case 639960842:this.applyTableFieldList(oc);this.pL.dea();break;case -1085236154:d.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.BCd}`);this.pL.dea();break;case 1833782813:this.pL.showCallout();break;default:return na.a(rb)}return Ua.Task.Ra(!0)}applyTableFieldList(rb){var Ub=rb.MenuItemId.toString();Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Ub=Ub.replace("'","''"),Ub=Ub.replace("[","'["),Ub=Ub.replace("]","']"));var oc=Object(Qb.a)(String,rb.SourceControlId);const Nc={};Nc.PulloutField=Ub;Nc.PulloutCardPath=rb.SourceCardKeyPath;Nc.PulloutCardSourceRow=rb.SourceCardRow;Nc.PulloutCardSourceColumn=rb.SourceCardColumn;if(this.pL.UN){d.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Nc.ParameterType=2;rb=rb.ColumnIndex;if(void 0===rb||null===rb){if(void 0===oc||null===oc){d.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}rb=0<=this.pL.GQf?this.pL.GQf:parseInt(oc.substring(20+Ub.length+1,oc.length),10);if(isNaN(rb)){d.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${oc}`);return}}Nc.PulloutRichColumnSourceIndex=rb;if(this.BFa.$Pg){this.MQg(Ub,Nc);return}}else d.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Nc.ParameterType=4,oc=this.pL.selectedRange.right,Oa.a.RAb()&&this.BFa.qxa&&(Nc.ParameterType=8,rb=this.pL.sma.top,rb=
zc.Range.nQ(oc)+rb,Ub==xa.d?(Ub="=DAYS("+rb+", TODAY())",Mc.a("DateFormulaPulledOut_DaysFromToday")):Ub==xa.g?(Ub="=IF(TODAY() < "+rb+", DATEDIF(TODAY(), "+rb+', "Y"), DATEDIF('+rb+', TODAY(), "Y"))',Mc.a("DateFormulaPulledOut_YearsFromToday")):Ub==xa.c?(Ub="=TEXT("+rb+', "dddd")',Mc.a("DateFormulaPulledOut_DayOfWeek")):Ub==xa.f?(Ub="=TEXT("+rb+', "mmmm")',Mc.a("DateFormulaPulledOut_MonthOfYear")):Ub==xa.e?(Ub="EOMONTH("+rb+", 0)",Ub="=DATE(YEAR("+Ub+"), MONTH("+Ub+"), DAY("+Ub+"))",Mc.a("DateFormulaPulledOut_EndOfMonth")):
Ub==xa.b&&(Ub="="+rb+" + 1",Mc.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Nc.PulloutCardSourceColumn&&null!==Nc.PulloutCardSourceColumn&&(oc=Nc.PulloutCardSourceColumn+1),Nc.PulloutRichColumnSourceIndex=oc;this.LSd(Ub,Nc)}LSd(rb,Ub,oc=0){d.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.BCd}, SelectedColumnIndex, ${Ub.PulloutRichColumnSourceIndex}`);rb=Object(f.a)(new Zb.a,{Text:rb});this.grid.setCell(rb,this.pL.sma,0,127,Ub,oc);this.grid.focus();
this.y7b=null;this.pL.dea();this.pL.Inj()}yc(rb,Ub,oc){if(rb=this.$.isEditMode&&Y.EwaSettings.oa(133)&&!!this.pL)switch(Ub.command){case -1085236154:break;case 639960842:rb=!!oc;break;case 1833782813:rb=this.pL.hxa&&this.pL.DDb;break;default:rb=!1}return rb}i1(rb,Ub,oc){this.$.isEditMode&&(this.y7b=this.BMh(Object(Qb.a)(409,oc)),super.i1(rb,Ub,null,null,!1))}xZ(){return this.y7b}G6c(rb){if(!this.pL||!rb||!rb.al)return d.ULS.shipAssertTag(537166994,0,!!this.pL,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
d.ULS.shipAssertTag(537166993,0,!!rb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),rb&&d.ULS.shipAssertTag(537166992,0,!!rb.al,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let Ub=new xb.a;for(const Nc of rb.al){rb=new xb.a;rb.add(Nc.ColumnName);rb.add(Nc.ColumnIndex.toString());let ud=new xb.a;var oc=null;Oa.a.RAb()&&this.BFa.qxa?ud=oa.toList(oa.select(oa.asEnumerable(Nc.FieldInfoDataList),Lb=>Lb.Name)):(oc=
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new qa:new lb.a,ud=oa.OBc(oa.concat(ud,oa.select(oa.asEnumerable(Nc.FieldInfoDataList),Lb=>Lb.Name)),Lb=>Lb,oc));oc=new xb.a;oc.add(oa.toArray(oa.concat(rb,ud)));Ub=oa.toList(oa.concat(Ub,oc))}return oa.toArray(Ub)}BMh(rb){var Ub=this.G6c(rb);if(!Ub||!Ub.length)return this.y7b=null;rb=this.Va;const oc=rb.gq(this.menuId);let Nc=rb.Fc();const ud=1<Ub.length,Lb=Oa.a.RAb()&&this.BFa.qxa;this.BCd=Ub.length;for(const pc of Ub){Lb?
Nc.title="Calculate Date Information":ud||(Nc.title=pc[0]);Ub=rb.Fc();for(let Ha=2,Bb=pc.length;Ha<Bb;++Ha)!Lb||pc[Ha]!=xa.d&&pc[Ha]!=xa.e||(oc.tc.push(Nc),Nc=rb.Fc()),(ud?Ub.buttons:Nc.buttons).push(rb.MIa("ApplyTableFieldList."+pc[Ha]+"."+pc[1],pc[Ha],639960842,null,"None",pc[Ha],!1,void 0,!0));if(ud){const Ha=rb.xw("ApplyTableFieldList."+pc[0],this.menuId,pc[0],798637440);Ha.menu.tc.push(Ub);Nc.buttons.push(Ha)}}oc.tc.push(Nc);return oc}MQg(rb,Ub){const oc=U.a.dd(12,1,0,899,0,2007340793,"RichValuePulloutIntoNonEmptyRange");
if(Y.EwaSettings.Lz()){const Nc=new Ib.a(this.$,oc);Nc.VP(()=>{2===Nc.returnValue&&this.LSd(rb,Ub,8)})}else{const Nc=new ob.ErrorDialog(this.$,oc);Nc.VP(()=>{2===Nc.returnValue&&this.LSd(rb,Ub,8)});Nc.vg()}}}Object(c.a)(id,"PulloutFieldListContextMenu",x.a,[]);const yd=r.a.ASf;class Yd extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateRichTextContextMenu",679816325,1151222423,yd,!0,!1,yd,Ub,oc,!0,Nc);this.grid=Q.h(rb)}get ax(){return"PopulateRichTextContextMenu"}get PB(){return r.a.ASf}yc(rb,
Ub,oc){return-1687037502===Ub.command&&!!oc&&this.grid.gb}executeCommand(rb,Ub,oc){this.showRichTextFloatie(oc);return Ua.Task.Ra(!0)}rLa(){return[qb.a.G2g]}showRichTextFloatie(rb){var Ub=Object(Qb.a)(sa.a,rb.eventArgs);Ub&&(rb=this.rLa(Ub.tb),Ub=new Sys.UI.Point(Ub.Ca.clientX,Ub.Ca.clientY),this.showFloatie(rb,new Sys.UI.Bounds(Ub.x,Ub.y,0,0),2))}}Object(c.a)(Yd,"RichTextContextMenu",x.a,[]);var cc=a(100),Rc=a(574);const vd=r.a.f$g;class Zd extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateSheetOpsContextMenu",
274207288,-1497523576,vd,!0,!1,"SheetTabContextMenuRootName",Ub,oc,!1,Nc);this.Mkc=this.fjc=!1}get ax(){return"PopulateSheetOpsContextMenu"}get PB(){return r.a.BSf}executeCommand(rb,Ub,oc){if(jb.a(this.$))return Ua.Task.Ra(!0);this.$.isEditMode&&(rb=oc[r.a.e8f],rb=rb.x&&rb.y?new Sys.UI.Point(rb.x+(this.$.isChromeRtl?10:-10),rb.y):wb.DOMElementExtensions.getLocation(oc[r.a.f8f]),this.Tp(rb,!1));return Ua.Task.Ra(!0)}yc(rb,Ub,oc){return-1075099431===Ub.command&&!!oc}xZ(){const rb=this.Va.gq(this.menuId),
Ub=this.$.isEditMode;this.j0j();this.pMh(rb,Ub);this.eMh(rb);this.gNh(rb);return rb}p0b(rb,Ub,oc,Nc){rb.push(this.Va.pb(Ub?oc:Nc))}pMh(rb,Ub){var oc=this.Va;const Nc=oc.Fc();Nc.buttons.push(oc.pb(54));this.p0b(Nc.buttons,this.Mkc,127,56);Nc.buttons.push(oc.pb(55));Ub&&this.p0b(Nc.buttons,this.Mkc,126,125);Nc.buttons.push(oc.pb(158));Ub=this.$.va.na;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.MK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
Ub&&Ub.Hd&&(Ub.Hd.Kv||Ub.Hd.hI||Nc.buttons.push(oc.pb(299)));this.$.ea.FNb&&(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?m.AFrameworkApplication.Utd(Rc.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(Ub=Object(Qb.a)(cc.a,this.$.na))&&la.p(Ub)&&this.$.isEditMode&&(Nc.buttons.push(oc.pb(277)),Ub.isLockPausedInSession?Nc.buttons.push(oc.pb(279)):Ub.li&&Nc.buttons.push(oc.pb(278)));Ub=oc.xw("ContextMenu.TabColor",null,W.a.instance.ga(518),1841703919);
oc=oc.E6c(467002767,1549407384,541,-221093529,this.PB);Ub.menu.tc.push(oc);Nc.buttons.push(Ub);rb.tc.push(Nc)}eMh(rb){const Ub=this.Va.Fc();this.p0b(Ub.buttons,this.Mkc,114,112);this.p0b(Ub.buttons,!this.fjc,115,113);rb.tc.push(Ub)}gNh(rb){if(Y.EwaSettings.oa(449)&&!la.e(this.$.va.na)){var Ub=this.Va,oc=Ub.Fc();oc.buttons.push(Ub.pb(263));rb.tc.push(oc)}}j0j(){let rb,Ub;({p6c:rb,aIe:Ub}=this.$.o6c());this.Mkc=1===rb;this.fjc=0<Ub}}Object(c.a)(Zd,"SheetOpsContextMenu",x.a,[]);var pe=a(519);class Qe extends x.a{constructor(rb,
Ub,oc,Nc){super(rb,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Ub,oc,!0,Nc)}get ax(){return"PopulateSlicerContextMenu"}get PB(){return r.a.CSf}nc(rb,Ub){var oc=!0;switch(Ub){case -231711729:oc=!1;break;case -1909381757:oc=this.vec();oc=!!oc&&oc.doi;break;case 1312363469:oc=!0}return!oc||super.nc(rb,Ub)}executeCommand(rb,Ub,oc){if(!this.$.isEditMode)return C.TaskExtensions.sba();rb=Ub.command;Ub=this.vec();let Nc=null;switch(rb){case 2108047455:Ub&&
Ub.wEe();break;case -231711729:d.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Ub&&Ub.Z4b();break;case 1312363469:this.showSlicerContextMenu(oc);break;default:Nc=na.a(rb)}return Nc||C.TaskExtensions.sba()}yc(rb,Ub,oc){rb=!1;switch(Ub.command){case -231711729:case 2108047455:case -1909381757:rb=!0;break;case 1312363469:rb=!!oc}return rb}xZ(){const rb=this.Va.gq(this.menuId);var Ub=this.Va.Fc();Ub.buttons.push(this.Va.pb(252));Ub.buttons.push(this.Va.pb(253));
Ub.buttons.push(this.Va.pb(254));rb.tc.push(Ub);Ub=this.Va.Fc();this.Jti()?Ub.buttons.push(this.Va.pb(266)):Ub.buttons.push(this.Va.pb(267));rb.tc.push(Ub);return rb}Jti(){if(Oa.a.gd(this.$)){var rb=this.$.da.Aa(439);if(rb)return rb.ns}else if(rb=this.$.da.Aa(371))return rb.ns;return!1}showSlicerContextMenu(rb){var Ub=Object(Qb.a)(sa.a,rb.eventArgs);rb=this.Ucc(Object(Qb.a)(sa.a,rb.eventArgs));Ub=Ub.tb;B.a.Db=Ub;this.Tp(rb,!1,Ub)}R0e(rb){const Ub=this.Va.Fc(),oc=this.Va.Fc();oc.buttons.push(this.Va.pb(255));
oc.buttons.push(this.Va.pb(256));const Nc=this.Va.H6c("ContextMenu.SlicerSort",null,W.a.instance.ga(2173),-814639094,0,Ma.a.UUe);Nc.menu.tc.push(oc);Ub.buttons.push(Nc);rb.tc.push(Ub)}JFj(rb){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&rb.Gb.className===Ma.a.Mbd||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===rb.tb}Ucc(rb){var Ub=Q.h(this.$).ha.Ta.$b;let oc=rb&&1!==rb.tb&&rb.clientPoint?
rb.clientPoint:Sys.UI.DomElement.getLocation(Ub.domElement);if(this.JFj(rb)){var Nc=this.vec();Nc&&(rb.Gb.className===Ma.a.Mbd&&(oc=Jb.HelperMethods.axb(rb.Ca)),1===rb.tb&&(oc=da.a(this.$).qka(wb.DOMElementExtensions.getLocation(Nc.frame))))}else if(rb=this.vec())rb=this.HVh(rb.frame),(Nc=Jb.HelperMethods.sD(this.$.vf,this.$.domElement,Q.h(this.$).rtl,!1))?(rb.x=da.a(this.$).zi(rb.x-Nc.x)+Nc.x,rb.y=da.a(this.$).zi(rb.y-Nc.y)+Nc.y):d.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),
oc.y+=rb.y,oc.x+=rb.x;rb=this.$.domElement;Nc=Q.h(this.$).rtl;Ub=Jb.HelperMethods.sD(Ub.Fg.domElement,rb,Nc);oc.y=Math.max(oc.y,Ub.y);oc.x=Math.max(oc.x,Ub.x);return oc}vec(){const rb=Q.h(this.$).ha.Ta.$b;d.ULS.shipAssertTag(537166988,0,!!rb);return pe.a(this.$).SH(rb.floatingObject.id)}HVh(rb){let Ub=new Sys.UI.Point(rb.offsetParent.offsetLeft,rb.offsetParent.offsetTop);var oc=Q.h(this.$);if(!oc)return Ub;const Nc=Q.h(this.$).rtl;Ub=Jb.HelperMethods.sD(rb,this.$.ur.ownerDocument.body,Nc);oc.UHe(Ub);
Ub.x=Nc?this.$.ur.clientWidth-Ub.x-rb.clientWidth:Ub.x;rb=oc.view.Nqb;oc=Nc?-oc.uS.Qca(rb.x):rb.x;Ub.x-=oc;Ub.y-=rb.y;return Ub}}Object(c.a)(Qe,"SlicerContextMenu",x.a,[]);class bf{constructor(rb,Ub,oc){this.type=rb;this.d$g=Ub;this.Mr=oc}}Object(c.a)(bf,"TimeSlicerRibbonButtonParameter",null,[]);class $e extends x.a{constructor(rb,Ub,oc,Nc){super(rb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,$e.$Qj,!0,!1,$e.ILb,Ub,oc,!1,Nc);this.s2a=0;this.IPe=this.dwa=this.lta=null}get ax(){return"PopulateTimeSlicerLevelMenu"}get PB(){return r.a.FSf}executeCommand(rb,
Ub,oc){rb=Ub.command;switch(rb){case 2000085697:rb=oc.DOMElement;this.lta=oc.ChangeLevelCallback;this.dwa=oc.GetLevelLabelCallback;this.s2a=oc.CurrentLevel;const Nc=oc.DomEvent;P.g(Nc);const ud=oc.location;oc=oc.levelLabelText;this.IPe=wb.DOMElementExtensions.Iz(document.activeElement,"iframe")&&oc?oc.parentNode:null;oc=Sys.UI.DomElement.getBounds(oc);oc.x=ud.x;oc.y=ud.y;this.i1(Nc,rb,oc,Ub,!0);break;case -649826274:this.lta(0);break;case 149600865:this.lta(1);break;case -2012435159:this.lta(2);break;
case -1979934975:this.lta(3);break;case 1634477200:wb.DOMElementExtensions.setFocus(this.IPe);break;default:return na.a(rb)}return Ua.Task.Ra(!0)}yc(rb,Ub,oc){rb=!1;switch(Ub.command){case 2000085697:rb=!!oc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:rb=!0}return rb}i1(rb,Ub,oc){rb=Sys.UI.DomElement.getBounds(Ub);oc.x=da.a(this.$).zi(oc.x);oc.y=da.a(this.$).zi(oc.y);rb.x=da.a(this.$).zi(rb.x);rb.y=da.a(this.$).zi(rb.y);rb=new Sys.UI.Point(rb.x+oc.x,rb.y+
oc.y);this.showContextMenu(new Sys.UI.Bounds(rb.x,rb.y-oc.height,oc.width,oc.height))}xZ(){const rb=this.Va,Ub=rb.gq(this.menuId),oc=rb.Fc();for(let ud=0;3>=ud;ud++){const Lb=this.dwa(ud);var Nc=$e.$Ph(ud);Nc=rb.kbh(Nc.d$g,Nc.Mr,this.s2a===ud,$e.wDe);Nc.label=Lb;Nc.yS(Lb);this.s2a===ud?Nc.AS("Image16by16",8,$e.wDe):Nc.Q4b();oc.buttons.push(Nc)}Ub.tc.push(oc);return Ub}static $Ph(rb){let Ub=null;switch(rb){case 0:Ub=new bf(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Ub=new bf(88,
"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Ub=new bf(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:Ub=new bf(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Ub}}$e.$Qj=r.a.h$g;$e.ILb="TimeSlicerLevelMenuRootName";$e.wDe=Ma.a.bva;Object(c.a)($e,"TimeSlicerLevelMenu",x.a,[]);var tf=a(319),oe=a(3);class jf extends b.a{constructor(rb){super(rb)}ld(){const rb=this.$,Ub=La.a.l2a(Ga.b(),this.ka,"Task","IRootUser"),oc=e.a(rb);let Nc=null;Nc=(pc,Ha)=>{oc.nXf(Nc);
Ub.setResult(Ha.h6b)};oc.Lse(Nc);oc.K6e();const ud=T.GetServiceTaskFactory.create(rb.da,102,rb.ka,this.Ya),Lb=T.GetServiceTaskFactory.Na(rb.da,342,338,this.Ya);C.TaskExtensions.za(C.TaskExtensions.Ed([Ub.task,ud,Lb],this.ka),()=>{const pc=ud.result,Ha=Ub.task.result,Bb=Lb.result;this.Zc([new Mb(rb,Ha,pc,Bb),new va(rb,Ha,pc,Bb),new Fc(rb,Ha,pc,Bb),new Nb(rb,Ha,pc,Bb),new Oc(rb,Ha,pc,Bb),new vb(rb,Ha,pc,Bb),new Gd.GridContextMenu(rb,Ha,pc,Bb),new Qd(rb,Ha,pc,Bb),new Zd(rb,Ha,pc,Bb),new $e(rb,Ha,pc,
Bb),new id(rb,Ha,pc,Bb),new Ba(rb,Ha,pc,Bb),new Xa(rb,Ha,pc,Bb),new Qe(rb,Ha,pc,Bb),new Yd(rb,Ha,pc,Bb)])},rb.ka,3)}static initData(){const rb=tf.a.Z9;rb(2000085697,20479,0,0);rb(-227942804,oe.a.ic|24576,0,0);rb(1634477200,oe.a.ic|131072,0,0);rb(-649826274,4095,0,0);rb(149600865,4095,0,0);rb(-2012435159,4095,0,0);rb(-1979934975,4095,0,0);rb(1247109494,oe.a.ic|24576,0,0);rb(-2064931494,oe.a.ic|131072,0,0);rb(-1396319072,oe.a.Ha,128,0);rb(-425234874,oe.a.Ha,128,0);rb(-1253126584,oe.a.Ha,0,0);rb(274207288,
oe.a.ic|24576,0,0);rb(-1497523576,oe.a.ic|131072,0,0);rb(-498523270,oe.a.ic|24576,64,0);rb(1640762262,oe.a.ic|131072,64,0);rb(-2017893763,oe.a.ic|24576,0,0);rb(1350204367,oe.a.ic|131072,0,0);rb(-889576107,oe.a.uw,128,0);rb(-1170196828,oe.a.uw,128,0);rb(389774337,oe.a.uw,128,0);rb(1529312473,oe.a.uw,128,0);rb(2033235475,oe.a.uw,128,0);rb(-96230454,oe.a.uw,128,0);rb(74086617,oe.a.uw,128,0);rb(563292088,oe.a.uw,128,0);rb(-1092351914,oe.a.uw,128,0);rb(-2141589616,oe.a.uw|16384,128,0);rb(745182485,oe.a.uw,
0,0);rb(359279088,oe.a.uw,128,0);rb(-67292059,oe.a.uw,128,0);rb(926905850,oe.a.uw,128,0);rb(547535945,oe.a.uw,128,0);rb(1374696078,oe.a.ic|24576,0,0);rb(495005930,oe.a.ic|212992,0,0);rb(-1045020714,oe.a.ic|24576,0,0);rb(-170383950,oe.a.ic|212992,0,0);rb(324156914,oe.a.Ha,0,0);rb(-1085236154,oe.a.uv,0,0);rb(-751848458,oe.a.Dl|16384,0,0);rb(216058793,oe.a.uv,0,0);rb(474690375,oe.a.Dl|16384,0,0);rb(-1920954846,oe.a.ic|24576,0,0);rb(723126814,oe.a.ic|131072,0,0);rb(2108047455,128,128,0);rb(-231711729,
128,128,0);rb(-1909381757,128,128,0);rb(-814639094,128,128,0);rb(1701016594,oe.a.ic|3072,128,0);rb(-1475408662,oe.a.ic|24576,0,0);rb(1114549926,oe.a.ic|131072,32,0)}static la(rb){b.a.Nd(10,new jf(rb))}}Object(c.a)(jf,"ContextMenuCommandHandlerFactory",b.a,[]);var Hf=a(222),Ne=a(1401),Xe=a(93),Mf=a(190);class Te{constructor(rb,Ub){this.Ksb=Ub;this.$=rb}dispose(){}vaa(){this.Ksb.e4()}kD(){this.Ksb.kD()}eWd(rb,Ub,oc){ab.i(this.$,ab.b);this.Ksb.showContextMenu(Object(f.a)(new Ne.a,{x:Ub.x,y:Ub.y}),oc,
rb);Xe.EventHandlerManager.instance.Led()}LAc(rb,Ub,oc){ab.i(this.$,ab.b);this.Ksb.showFloatie(Object(f.a)(new Ne.a,{x:Ub.x,y:Ub.y}),rb,oc);Mf.a(()=>{Xe.EventHandlerManager.instance.Led()},this.$.ka)}dWd(rb,Ub,oc,Nc){ab.i(this.$,ab.b);this.Ksb.dWd(Object(f.a)(new Ne.a,{x:Ub.x,y:Ub.y}),rb,oc,Nc)}}Object(c.a)(Te,"ReactContextMenuController",null,[275,3]);class cb extends Hf.a{constructor(rb){super();this.Bff=!1;this.Tod=()=>{let Ub;(Ub=this.$.da.Aa(342))?this.ob(Ub):this.$.qy(oc=>{oc.Ygc().then(Nc=>
{(Ub=this.$.da.Aa(342))?this.ob(Ub):(Ub=new Te(this.$,Nc),this.ob(this.$.da.Ga(342,Ub)))})})};this.$=rb;this.Fb()}dispose(){this.Bff&&this.$&&this.$.ea.Pn(this.Tod);super.dispose()}create(){this.$.ea.Yf?(d.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Yf}`),this.Tod(null,null)):(this.Bff=!0,this.$.ea.Lk(this.Tod))}static la(rb){rb.da.Ga(338,new cb(rb))}}Object(c.a)(cb,"ContextMenuControllerFactory",Hf.a,[]);var Rb=
a(155);class uc{constructor(){this.dictionary=this.Wd=null}}Object(c.a)(uc,"RibbonCommandParams",null,[]);class Kc{constructor(){this.menuModel=null;this.LKe=0}}Object(c.a)(Kc,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class pd{constructor(){this.Ufc={}}mQh(rb){return(rb=this.Ufc[rb.toString()])?rb.menuModel:null}R_g(rb,Ub){this.Ufc[Ub.toString()]=Object(f.a)(new Kc,{menuModel:rb,LKe:Jb.HelperMethods.Sb()})}J9b(rb){this.Ufc[rb.toString()]=null}P4h(rb){return(rb=this.Ufc[rb.toString()])?rb.LKe:
-1}}Object(c.a)(pd,"FilterMenuCache",null,[]);var xd=a(14),Rd=a(178),ke=a(224);class fe{constructor(){this.Bd=this.eye=this.cell=null}}Object(c.a)(fe,"AutoFilterEventRegistrationArgs",null,[]);class Ee{constructor(rb){this.d0a=null;this.vVd=!1;this.FDb=0;this.lbd=1;this.XRe=0;this.FGb=Ub=>{this.YQf(Ub.domElement,Ub.hashCode)};this.NUf=Ub=>{let oc=0;for(;window.performance.now()-Ub<this.nuh&&0<this.d0a.length;)this.Sqe(this.d0a.shift()),oc++;d.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.lbd}, Events Registered in this frame: ${oc}, Events in queue: ${this.d0a.length}`);
0<this.d0a.length?this.FDb=window.requestAnimationFrame(this.NUf):(Ub=window.performance.now()-this.XRe,d.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.lbd}, Total time in MS: ${Ub}`),this.lbd++,this.FDb=0)};this.onPointerDown=Ub=>{we.a.slim(Ub.Ca.rawEvent);return!1};this.$=rb;this.gridView=Q.h(this.$);this.Oei();this.nuh=this.$.ya.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.FDb);this.gridView&&
this.gridView.Fvc(this.FGb);this.gridView=null}Oei(){if(this.vVd=Jb.HelperMethods.s8a)this.d0a=[];this.jKg();this.gridView.K0b(this.FGb)}jKg(){for(const rb of this.gridView.Ln){const Ub=rb.VCa;for(let oc in Ub){const Nc=Ub[oc];this.YQf(Nc.domElement,Nc.hashCode)}}}YQf(rb,Ub){if(Q.h(this.$).Da.Dm.$2a(Ub))if(rb){rb=rb.querySelectorAll('[id^="'+r.a.zdd+'"]');for(let ud=0;ud<rb.length;ud++){var oc=rb[ud],Nc=oc.getAttribute(r.a.JGh);const Lb=oc.getAttribute(r.a.CGh);d.ULS.shipAssertTag(537167053,0,!!Nc&&
!!Lb,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${oc.id}, BlockHash: ${Ub}`);Nc=zc.Range.Qc(parseInt(Nc,10),parseInt(Lb,10));oc=Object(f.a)(new fe,{cell:Nc,eye:oc,Bd:Ub});this.vVd?(this.d0a.push(oc),this.FDb||(this.XRe=window.performance.now(),this.FDb=window.requestAnimationFrame(this.NUf))):this.Sqe(oc)}}else d.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${Ub}`);
else d.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${Ub}`)}Sqe(rb){const Ub=this.gridView.Da.CLa(rb.cell,rb.Bd);Ub?this.iKg(rb.eye,Ub):d.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${rb.Bd}, AutoFilter Cell: ${rb.cell}`)}iKg(rb,Ub){Ub.hasAutoFilter?this.gIg(rb,
Ub.Lvb):Ub.d5?this.gKg(rb,Ub.Lvb,Ub.gtd):d.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Rb.a.instance.sa(xd.a.uf,rb,this.onPointerDown);Rd.a.instance.sa(xd.a.Vya,rb,this.onPointerDown)}gIg(rb,Ub){ke.a.instance.sa(xd.a.click,rb,oc=>{Ub&&we.a.hrc(oc.Ca.rawEvent,966232027,Ub,null);return!0})}gKg(rb,Ub,oc){const Nc=z.a.$h(Ub);ke.a.instance.sa(xd.a.click,rb,ud=>{oc?we.a.spf(document.getElementById(Nc.EwaElementId),
Nc.Cell,Nc.DataSourceIndex,Nc.FieldId,Nc.IsOlap,Nc.RequiresConfirmation,ud.Ca.rawEvent,Nc.OptionalPivotMenuAnchor):we.a.spfm(ud.Ca.rawEvent,Nc.RequiresConfirmation,Nc.Cell,Nc.DataSourceIndex,Nc.PivotName,Nc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(Ee,"FilterMenuPointerEventsManager",null,[3]);class nc{constructor(rb){this.JYe=null;this.$=rb;this.p$a=new pd;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.JYe=new Ee(this.$))}dispose(){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.JYe.dispose();this.$=null}vWh(rb){const Ub=Q.h(this.$).Da.E$(rb,this.$.activeItemName);return Ub&&Ub.blockPresentInViewportTimeStamp>this.p$a.P4h(rb.left)?Ub.us(rb).autoFilterMenu:this.p$a.mQh(rb.left)}LTi(rb,Ub,oc){this.p$a&&this.p$a.R_g(rb.menuModel[Ub],oc)}MTi(rb){this.p$a&&this.p$a.J9b(rb)}}Object(c.a)(nc,"FilterMenuManager",
null,[271,3]);var Sc=a(204),zb=a(168);class Wb{constructor(rb,Ub,oc){this.hBc={};this.Dd=!1;this.am=(Nc,ud=null)=>{this.showContextMenu(ud)};this.tCf=(Nc,ud)=>{ud.kHi===Wb.E7h&&Q.h(this.$).focus()};this.KR=(Nc,ud)=>{Nc=this.$.Ka.eba(ud.Wd.command);(null===Nc||void 0===Nc?0:Nc.dismissesContextualUI)&&this.e4()};this.JR=()=>{this.$.da.QU(342);C.TaskExtensions.za(T.GetServiceTaskFactory.create(this.$.da,338,this.$.ka,3),Nc=>{Nc=Nc.result;for(let ud of this.hBc)ud.vUf(Nc)},this.$.ka)};this.$=rb;this.contextMenuController=
oc;this.$$d=new nc(this.$);rb.da.Ga(8,this);for(oc=0;oc<Ub.length;oc++)this.hBc[Wb.i$g[oc]]=Ub[oc];this.ha=Q.h(rb).ha;this.ha.E0b(this.am);this.$.Ka.b_a(this.tCf);Rb.a.instance.zAj();Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.LGa(this.KR);Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.UY(this.JR)}get Xac(){return this.$$d}Ngd(rb){return aa.a.Ec(this.hBc,rb)}dispose(){this.Dd?
d.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Dd=!0,this.$&&(this.$.ul(Wb.$c),this.$.da.QU(8),this.ha&&this.ha.yvc(this.am),this.$.Ka.CKb(this.tCf),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.GAa(this.KR),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.J0(this.JR)),this.$=this.ha=null,this.Xac.dispose(),
this.hBc=this.$$d=null)}showContextMenu(rb,Ub=null,oc=null){this.oFj(rb)&&(ab.i(this.$,ab.j),rb=this.xch(rb,Ub,oc),this.$.Ka.Lb(rb.Wd,rb.dictionary))}e4(){this.contextMenuController?this.contextMenuController.vaa():d.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}oFj(rb){return Dc.a(this.$).Gp()?(d.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Dc.a(this.$).RW(zb.a.grid,Sc.a.showContextMenu),!1):!this.$.Ka.qEh&&(!rb||rb.Gb!==Q.h(this.$).domElement&&!ge.a.equals(rb.Gb.tagName,"INPUT",!0))}xch(rb,Ub=null,oc=null){oc={["eventArgs"]:rb,["creationParams"]:oc};rb=rb?rb.tb:-1;const Nc=this.ha.Ta.$b;let ud=1441131127;Nc?(Ub=Nc.floatingObject,d.ULS.shipAssertTag(537167059,0,!!Ub,"floatingObj shouldn't be null."),Wb.oud(Ub)?ud=1312363469:Wb.isPivotChart(Ub)?(oc[va.V2c]=Ub?Ub.Vc:null,ud=-149612405):ud=-1372040782):Wb.Xlf(Ub)?(oc[va.V2c]=Ub,ud=-149612405):
!ab.h(this.$)&&ab.f(Q.h(this.$))&&(ud=671488277);Ub=new L.a(ud,rb,this.$.Hc,30,null);return Object(f.a)(new uc,{Wd:Ub,dictionary:oc})}static la(rb){rb.$k(Wb.$c)}static isPivotChart(rb){return!!rb&&0===rb.type&&Wb.Xlf(rb.Vc)}static oud(rb){return!!rb&&2===rb.type}static Xlf(rb){return!!rb&&!!(rb.Attributes&4)}}Wb.i$g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Wb.E7h="GridContextMenu";Wb.$c=rb=>{(rb=Object(Qb.a)(7,rb))&&T.GetServiceTaskFactory.create(rb.da,9,rb.ka,0)};Object(c.a)(Wb,"ContextMenuManager",null,[257,3]);class yc extends Hf.a{constructor(rb){super();this.$=rb;this.Fb()}create(){const rb=this.$,Ub=rb.dc;if(Ub.allowSelection||Ub.allowEdits||Ub.allowFiltering||Ub.allowSorting||Ub.allowPivotSpecificOperations){const oc=T.GetServiceTaskFactory.create(rb.da,10,rb.ka,this.Ya),Nc=T.GetServiceTaskFactory.Na(rb.da,342,338,this.Ya);C.TaskExtensions.za(C.TaskExtensions.Ed([oc,
Nc],this.ka),()=>{this.ob(u.a(rb)||new Wb(rb,oc.result,Nc.result))},this.$.ka,3)}else d.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),rb.da.QU(8),this.ob(null)}static la(rb){rb.da.Ga(9,new yc(rb))}}Object(c.a)(yc,"ContextMenuManagerFactory",Hf.a,[]);var Uc=a(9);a.d(E,"a",function(){return fd});const fd=()=>{jf.initData();Uc.a.Fa(rb=>{cb.la(rb);yc.la(rb);jf.la(rb);Wb.la(rb)})}},1152:function(t,E,a){var c=
a(9);t=a(0);var b=a(695),e=a(15);const f=ka=>{switch(ka){case 0:ka="Between";break;case 1:ka="NotBetween";break;case 2:ka="Equal";break;case 3:ka="NotEqual";break;case 4:ka="GreaterThan";break;case 5:ka="LessThan";break;case 6:ka="GreaterThanOrEqual";break;case 7:ka="LessThanOrEqual";break;default:ka="Unknown"}return ka},d=ka=>{switch(ka){case 0:ka="AnyValue";break;case 1:ka="WholeNumber";break;case 2:ka="Decimal";break;case 3:ka="List";break;case 4:ka="Date";break;case 5:ka="Time";break;case 6:ka=
"TextLength";break;case 7:ka="Custom";break;default:ka="Unknown"}return ka};var h=a(131),m=a(40),l=a(374),w=a(188),n=a(284);class x{constructor(ka=null){this.y5=ka?ka.IsIgnoreBlank:!0;this.z5=ka?ka.IsInCellDropDown:!0;this.uO=ka?ka.LowerBoundary:"";this.vO=ka?ka.UpperBoundary:"";this.RB=ka?ka.ConditionType:0;this.ruleType=ka?ka.RuleType:0;this.y_=ka?ka.IsAlertBlocking:!0;this.eU=ka?ka.AlertTitle:"";this.dU=ka?ka.AlertMessage:"";this.MV=ka?ka.InputMessage:"";this.KF=ka?ka.InputTitle:"";this.S5=ka?
ka.IsShowErrorAlert:!0;this.T5=ka?ka.IsShowInputMessage:!0}isEqual(ka){return ka?this.y5===ka.y5&&this.z5===ka.z5&&this.uO===ka.uO&&this.vO===ka.vO&&this.RB===ka.RB&&this.ruleType===ka.ruleType&&this.y_===ka.y_&&this.eU===ka.eU&&this.dU===ka.dU&&this.MV===ka.MV&&this.KF===ka.KF&&this.S5===ka.S5&&this.T5===ka.T5:(e.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(t.a)(x,"DataValidationEditDialogState",null,[]);var r=a(283),u=a(184),v=a(282),
B=a(21),z=a(132),A=a(51),y=a(55);class D{constructor(ka,ra){this.cC=this.C2a=this.selectedRanges=null;this.nPe=!1;this.ei=null;this.YRi=ba=>{e.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ba||r.a(ba)?e.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.C2a=ba.Result,this.e7i())};this.yEh=ba=>{this.eX("DataValidationEdit.ExpandExisitngDialog",
ba);this.cC.c=D.Tia(ba);1===ba?this.NIa(new x(this.C2a)):2===ba?this.NIa(new x):this.Atf()};this.W1i=ba=>{this.eX("DataValidationEdit.OverrideExisitngDialog",ba);this.cC.c=D.Tia(ba);1===ba?this.NIa(new x):this.Atf()};this.$=ka;this.E8c=ra}nc(){return!1}executeCommand(ka,ra){-1728432249!==ra.command&&u.a(ra.command);this.selectedRanges=m.r(B.h(this.$).ha.ra.selectedRanges,this.$);B.h(this.$).OTa(!0);this.getDataValidationInitialState();this.ei=this.$.Kb.Cc("UserAction","DataValidationEditTimeToDialogOpen");
this.nPe?e.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(e.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.nPe=!0);return y.Task.Ra(!0)}yc(ka,ra){return-1728432249===ra.command}Lc(){return!1}getDataValidationInitialState(){const ka=this.$.pa.xa.Wb();l.a(this.$.userOperationManager,(ra,ba,Ua)=>n.g(this.$.pa.xa,this.selectedRanges,v.b(ra,this.YRi),v.a(ba),Ua,ka),ra=>new w.a(120,0,ra,16),null)}e7i(){var ka=
this.cC={};let ra;switch(this.C2a.Command){case 0:ra="CreateNew";break;case 1:ra="CreateNewFromRule";break;case 2:ra="ExpandExisitng";break;case 3:ra="OverrideExisitng";break;default:ra="Unknown"}ka.a=ra;this.ei&&(this.ei.stop(),this.cC.r=this.ei.id);switch(this.C2a.Command){case 0:this.cC.b=!1;this.cC.c="None";this.NIa(new x);break;case 1:this.cC.b=!1;this.cC.c="None";this.NIa(new x(this.C2a));break;case 2:this.cC.b=!0;this.E8c.tbh(this.$,this.yEh);break;case 3:this.cC.b=!0;this.E8c.vbh(this.$,this.W1i);
break;default:e.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}NIa(ka){this.E8c.NIa(this.$,this.selectedRanges,ka,this.C2a.Command);this.ODi(ka)}ODi(ka){D.gub(ka,this.cC);this.cC.d=!0;A.b().Qe(48,this.cC,!0)}Atf(){this.cC.d=!1;A.b().Qe(48,this.cC,!0)}eX(ka,ra){ka={["ButtonType"]:D.Tia(ra),["DialogName"]:ka,["Location"]:"dialog",["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.YF};z.b(this.$).vd(h.a.D8b,ka)}static gub(ka,ra){ra.e=d(ka.ruleType);
ra.f=f(ka.RB);ra.g=!!ka.uO;ra.h=!!ka.vO;ra.i=ka.y5;ra.j=ka.z5;ra.k=ka.T5;ra.l=!!ka.KF;ra.m=!!ka.MV;ra.n=ka.S5;ra.o=ka.y_;ra.p=!!ka.eU;ra.q=!!ka.dU}static Tia(ka){switch(ka){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return e.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(t.a)(D,"DataValidationEditCommandHandler",null,[219]);var I=a(133),M=a(803),T;(function(ka){ka[ka.between=0]="between";ka[ka.notBetween=
1]="notBetween";ka[ka.equal=2]="equal";ka[ka.notEqual=3]="notEqual";ka[ka.greaterThan=4]="greaterThan";ka[ka.lessThan=5]="lessThan";ka[ka.greaterThanOrEqual=6]="greaterThanOrEqual";ka[ka.lessThanOrEqual=7]="lessThanOrEqual"})(T||(T={}));Object(t.b)("DataValidationRuleConditionType",T);var S=a(1086),H=a(146),C=a(186);class G{static get og(){return H.a.jq(G.nl,"")}static get aNe(){return H.a.jq(G.Rmh,C.a.ga(1665),C.a.ga(1680),C.a.ga(1681),C.a.ga(1682),C.a.ga(1683),C.a.ga(1684),C.a.ga(1685),C.a.ga(1686),
C.a.ga(1687),C.a.ga(1666),C.a.ga(1690),C.a.ga(1691),C.a.ga(1692),C.a.ga(1693),C.a.ga(1694),C.a.ga(1695),C.a.ga(1696),C.a.ga(1697),C.a.ga(1667),C.a.ga(1668),C.a.ga(1688),C.a.ga(1689),C.a.ga(1679),"255")}static get eNe(){return H.a.jq(G.Smh,C.a.ga(1702),C.a.ga(1706),C.a.ga(1707),"255","32")}static get hNe(){return H.a.jq(G.Tmh,C.a.ga(1701),C.a.ga(1704),C.a.ga(1703),C.a.ga(1705),C.a.ga(1706),C.a.ga(1707),"255","32")}}G.Ieg=255;G.nl="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";
G.Rmh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
G.Smh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
G.Tmh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(t.a)(G,"DataValidationEditDialogHtml",null,[]);var J=a(85),L=a(555),P=a(14),aa=a(187),U=a(238),K=a(12),Y=a(13),na=a(1);class W extends U.a{constructor(ka,ra,ba,Ua){super(ra);this.nGd=this.Rrc=this.uQa=this.$ab=this.MOa=this.X6a=this.Hza=this.Gza=this.kL=this.fU=this.Qgc=this.Ywa=null;this.jIh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Psj=[[12,12],[1,1],[1,1],[12,12],[6,6],
[9,9],[1,1],[12,12]];this.nqc=Ka=>{let Oa=!1;(null===Ka||void 0===Ka?0:Ka.Ca)&&(Ka.Ca.keyCode===J.a.nfa||Ka.Ca.keyCode===J.a.Kh)&&(Oa=this.eda(Ka),this.fU.blur(),this.kL.blur());return Oa};this.eda=()=>{const Ka=this.fU.selectedIndex,Oa=this.kL.selectedIndex;this.Rrc.innerText=this.rxb(Ka,Oa);this.nGd.innerText=this.Tjd(Ka,Oa);switch(Ka){case 0:return this.kL.disabled=!0,K.DOMElementExtensions.setVisible(this.$ab,!1),K.DOMElementExtensions.setVisible(this.uQa,!1),K.DOMElementExtensions.setVisible(this.X6a,
!1),K.DOMElementExtensions.setVisible(this.MOa,!1),this.Ywa.disabled=!0,!1;case 3:return this.kL.disabled=!0,K.DOMElementExtensions.setVisible(this.$ab,!0),K.DOMElementExtensions.setVisible(this.uQa,!1),K.DOMElementExtensions.setVisible(this.X6a,!0),K.DOMElementExtensions.setVisible(this.MOa,!0),this.Ywa.disabled=!1;case 7:return this.kL.disabled=!0,K.DOMElementExtensions.setVisible(this.$ab,!0),K.DOMElementExtensions.setVisible(this.uQa,!1),K.DOMElementExtensions.setVisible(this.X6a,!1),K.DOMElementExtensions.setVisible(this.MOa,
!1),this.Ywa.disabled=!1;default:this.Ywa.disabled=!1,K.DOMElementExtensions.setVisible(this.$ab,!0),K.DOMElementExtensions.setVisible(this.MOa,!1)}switch(Oa){case 0:case 1:K.DOMElementExtensions.setVisible(this.uQa,!0);break;default:K.DOMElementExtensions.setVisible(this.uQa,!1)}this.kL.disabled=!1;this.Rrc.disabled=!1;K.DOMElementExtensions.setVisible(this.X6a,!1);K.DOMElementExtensions.setVisible(this.MOa,!1);return!1};this.get_visible=this.yka;this.set_visible=this.koa;this.wR=new aa.a;this.wR.add(Y.a.instance.ga(1667));
this.wR.add(Y.a.instance.ga(1668));this.wR.add(Y.a.instance.ga(1671));this.wR.add(Y.a.instance.ga(1669));this.wR.add(Y.a.instance.ga(1670));this.wR.add(Y.a.instance.ga(1672));this.wR.add(Y.a.instance.ga(1673));this.wR.add(Y.a.instance.ga(1674));this.wR.add(Y.a.instance.ga(1675));this.wR.add(Y.a.instance.ga(1676));this.wR.add(Y.a.instance.ga(1677));this.wR.add(Y.a.instance.ga(1678));this.wR.add("");this.$=ka;this.Tk=ba;this.Tka(Ua)}get title(){return Y.a.instance.ga(1698)}get D8g(){return this.fU.selectedIndex}kBa(ka){this.fU.selectedIndex=
ka.ruleType;this.kL.selectedIndex=ka.RB;this.Qgc.checked=ka.z5;this.Ywa.checked=ka.y5;this.Gza.value=ka.uO;this.Hza.value=ka.vO;this.eda(null)}erb(ka){ka.y5=this.Ywa.checked;ka.z5=this.Qgc.checked;ka.RB=this.kL.selectedIndex;ka.ruleType=this.fU.selectedIndex;ka.uO=this.Gza.value;ka.vO=this.Hza.value}dispose(){this.gk();this.Tk=this.nGd=this.Rrc=this.uQa=this.$ab=this.MOa=this.X6a=this.Qgc=this.Hza=this.Gza=this.kL=this.fU=this.Ywa=null;super.dispose()}render(ka){ka.appendChild(this.domElement)}yka(){return this.isVisible}koa(ka){return this.isVisible=
ka}setFocus(){}rxb(ka,ra){return this.F6e(ka,ra,this.jIh)}Tjd(ka,ra){return 0!==ra&&1!==ra?"":this.F6e(ka,ra,this.Psj)}Tka(ka){na.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&na.EwaSettings.isChangeGateEnabled("OfficeVSO:7126092_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")?ka.ni(this.domElement,G.aNe):this.domElement.innerHTML=G.aNe;this.Ywa=K.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.fU=K.DOMElementExtensions.getElementById(this.domElement,
"allowConditionSelectionId");this.kL=K.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Gza=K.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Hza=K.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Rrc=K.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.nGd=K.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.X6a=K.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownDivId");this.MOa=K.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.$ab=K.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.uQa=K.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Qgc=K.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Oj()}F6e(ka,ra,ba){return ba.length<ka||ba[ka].length<ra?(e.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${ka} operatorOption=${ra}, cannot get label.`),
""):this.wR.ma(ba[ka][ra])}Oj(){L.a.instance.sa(P.a.Pb,this.fU,this.nqc);L.a.instance.sa(P.a.Pb,this.kL,this.nqc);L.a.instance.sa(P.a.change,this.fU,this.eda);L.a.instance.sa(P.a.change,this.kL,this.eda);L.a.instance.sa(P.a.change,this.kL,this.Tk);L.a.instance.sa(P.a.change,this.fU,this.Tk);L.a.instance.sa(P.a.change,this.Gza,this.Tk);L.a.instance.sa(P.a.Pb,this.Gza,this.Tk);L.a.instance.sa(P.a.change,this.Hza,this.Tk);L.a.instance.sa(P.a.Pb,this.Hza,this.Tk)}gk(){L.a.instance.Ba(P.a.Pb,this.fU,this.nqc);
L.a.instance.Ba(P.a.Pb,this.kL,this.nqc);L.a.instance.Ba(P.a.change,this.fU,this.eda);L.a.instance.Ba(P.a.change,this.kL,this.eda);L.a.instance.Ba(P.a.change,this.kL,this.Tk);L.a.instance.Ba(P.a.change,this.fU,this.Tk);L.a.instance.Ba(P.a.change,this.Gza,this.Tk);L.a.instance.Ba(P.a.Pb,this.Gza,this.Tk);L.a.instance.Ba(P.a.change,this.Hza,this.Tk);L.a.instance.Ba(P.a.Pb,this.Hza,this.Tk)}static Xja(){let ka;return ka=new aa.a,ka.add("operatorInputId1"),ka.add("operatorInputId2"),ka}}Object(t.a)(W,
"DataValidationEditConditionsControl",U.a,[325,3,328]);var X=a(60);const Aa=(ka,ra,ba,Ua,Ka,Oa,ib,La=null)=>{La=ka.Oa(9,La);La.selectedRanges=ra;La.ruleOptions=ba;return X.g(ka,"CreateOrEditDataValidation",La,Ua,Ka,Oa,ib,0)};var Q=a(29),fa=a(22),Ca=a(175);class ia extends M.a{constructor(ka,ra,ba,Ua){super(ka);this.jRd=this.Wvb=null;this.pOa=this.disposed=this.jla=!1;this.ei=null;this.V2j=(Ka,Oa)=>{let ib;this.bdc(Ka);if(({errorString:Ka,Qq:ib}=this.i3d()).returnValue)return this.$Ma(121,this.QSh(this.$,
Oa),0,this.aca,!1),"";this.Xla("OkInvalidByClient",ib);return Ka};this.D8c=Ka=>{this.eX(Ka);this.ei=this.$.Kb.Cc("UserAction","DataValidationEditTimeToDialogTryClose");0===Ka&&this.Dma()};this.selectedRanges=ra;this.kUb=ba;this.command=Ua;3===Ua&&(this.jla=!0);this.Tb=2;this.ew=!1}get yd(){return this.kUb}get pc(){return"DataValidationEditDialog"}QWd(){var ka={["RuleType"]:this.yd.ruleType,["RuleOperatorType"]:this.yd.RB,["OperatorInput1"]:this.yd.uO,["OperatorInput2"]:this.yd.vO,["IsIgnoreBlank"]:this.yd.y5,
["IsInCellDropDown"]:this.yd.z5,["IsAlertBlocking"]:this.yd.y_,["AlertTitle"]:this.yd.eU,["AlertMessage"]:this.yd.dU,["InputTitle"]:this.yd.KF,["InputMessage"]:this.yd.MV,["IsShowErrorAlert"]:this.yd.S5,["IsShowInputMessage"]:this.yd.T5};this.qc(2,Y.a.instance.ga(1664));ka={[ia.yu]:this.pc,["validateDialogValues"]:this.V2j,["RangePickerController"]:B.h(this.$).yf.cyb(),["isModal"]:!1,["bodyProps"]:ka};this.initializeAndShow(Y.a.instance.ga(1663),this.D8c,ka);e.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||
(super.dispose(),this.disposed=!0)}get j4b(){return 3===this.yd.ruleType}Xja(){return W.Xja()}QSh(ka,ra){return(ba,Ua,Ka)=>{const Oa=ka.pa.xa.Wb();return Aa(this.$.pa.xa,this.selectedRanges,this.XYg(),this.e1a(ba,this.KDd(ra)),v.a(Ua),Ka,Oa)}}KDd(ka){return ra=>{e.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let ba;r.a(ra)?(e.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${ra?
Q.a.sc(ra.Errors):null}.`),ra.Errors&&1===ra.Errors.length&&((ba=this.Zgd(ra.Errors[0].MessageId))?this.Xla("OkInvalidByServer",ra.Errors[0].MessageIdName):(this.Xla("OkValid","None"),this.hide()),ka(ba)),e.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${Q.a.sc(ra.Errors)}`)):this.hide()}}XYg(){const ka={};ka.Command=this.command;ka.RuleType=this.yd.ruleType;ka.ConditionType=this.yd.RB;ka.IsIgnoreBlank=this.yd.y5;ka.IsInCellDropDown=
this.yd.z5;ka.LowerBoundary=this.yd.uO;ka.UpperBoundary=this.yd.vO;ka.IsAlertBlocking=this.yd.y_;ka.IsShowErrorAlert=this.yd.S5;ka.IsShowInputMessage=this.yd.T5;ka.AlertTitle=this.yd.eU;ka.AlertMessage=this.yd.dU;ka.InputTitle=this.yd.KF;ka.InputMessage=this.yd.MV;ka.ShouldIgnoreFormulaError=this.pOa;return ka}Zgd(ka){switch(ka){case 1173235830:return Y.a.instance.ga(1713);case 43935303:return Y.a.instance.ga(1714);case -1323438439:return Y.a.instance.ga(1716);case 2112020473:return Y.a.instance.ga(1710);
case -219503282:return Y.a.instance.ga(1711);case 1689335445:return Y.a.instance.ga(1712);case 2146493810:return Y.a.instance.ga(1715);case -2104909922:return String.format(Y.a.instance.mb(105),this.Wvb,this.jRd);case -869372599:return String.format(Y.a.instance.mb(104),this.Wvb);case -1181828368:return Y.a.instance.ga(1718);case -758480861:return Y.a.instance.ga(1719);case -13729088:return Y.a.instance.ga(1720);case -846654055:return Y.a.instance.ga(1721);case 751854001:return Y.a.instance.ga(1722);
case -453846397:return Y.a.instance.ga(1723);case 1102013489:return Y.a.instance.ga(1724);case 835813260:return Y.a.instance.ga(1725);case 1577787509:return Y.a.instance.ga(1726);case 2083564019:return Y.a.instance.ga(1717);default:e.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${ka.toString()}.`)}return null}Dma(){this.Xla("Cancel","None")}eX(ka){e.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===ka?"Ok":"Cancel"} was clicked.`);
ka={["ButtonType"]:ia.Tia(ka),["DialogName"]:this.pc,["Location"]:"dialog",["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.YF};z.b(this.$).vd(h.a.D8b,ka)}Xla(ka,ra){const ba={};ia.gub(this.yd,ba);ba.o=ka;ba.p=ra;ba.n=this.jla;this.ei&&(this.ei.stop(),ba.q=this.ei.id);A.b().Qe(49,ba,!0)}bdc(ka){this.yd.ruleType=ka.RuleType;this.yd.RB=ka.RuleOperatorType;this.yd.uO=ka.OperatorInput1;this.yd.vO=ka.OperatorInput2;this.yd.y_=ka.IsAlertBlocking;this.yd.S5=ka.IsShowErrorAlert;this.yd.eU=ka.AlertTitle;this.yd.dU=
ka.AlertMessage;this.yd.T5=ka.IsShowInputMessage;this.yd.KF=ka.InputTitle;this.yd.MV=ka.InputMessage;this.yd.y5=ka.IsIgnoreBlank;this.yd.z5=ka.IsInCellDropDown;this.Wvb=ka.firstOperatorLabel;this.jRd=ka.secondOperatorLabel}FRb(ka,ra,ba){let Ua,Ka;Ka=Ua=null;if(!ka)return ba?(Ua=String.format(Y.a.instance.mb(105),this.Wvb,this.jRd),Ka="DataValidationEditNoMinMaxError"):(Ua=String.format(Y.a.instance.mb(104),this.Wvb),Ka="DataValidationEditNoValueError"),{returnValue:!1,errorString:Ua,Qq:Ka};if(ka.length>
G.Ieg)return Ua=Y.a.instance.ga(1717),{returnValue:!1,errorString:Ua,Qq:Ka};if(Ca.d(ka))return{returnValue:!0,errorString:Ua,Qq:Ka};if(1===ra||2===ra||6===ra){if(!fa.a.J5(ka))return Ua=Y.a.instance.ga(1710),{returnValue:!1,errorString:Ua,Qq:Ka};if(1===ra&&!fa.a.isInteger(ka))return Ua=Y.a.instance.ga(1711),{returnValue:!1,errorString:Ua,Qq:Ka};if(6===ra){if(!fa.a.isInteger(ka))return Ua=Y.a.instance.ga(1711),{returnValue:!1,errorString:Ua,Qq:Ka};if(0>parseInt(ka,10))return Ua=Y.a.instance.ga(1712),
{returnValue:!1,errorString:Ua,Qq:Ka}}}return{returnValue:!0,errorString:Ua,Qq:Ka}}i3d(){let ka,ra;ra=ka=null;const ba=this.yd.uO,Ua=this.yd.vO,Ka=S.a[this.yd.ruleType];var Oa=T[this.yd.RB];if(0===Ka)return{returnValue:!0,errorString:ka,Qq:ra};Oa=(0===Oa||1===Oa)&&3!==Ka&&7!==Ka;return!({errorString:ka,Qq:ra}=this.FRb(ba,Ka,Oa)).returnValue||Oa&&!({errorString:ka,Qq:ra}=this.FRb(Ua,Ka,Oa)).returnValue?{returnValue:!1,errorString:ka,Qq:ra}:Oa&&(1===Ka||2===Ka||6===Ka)&&!Ca.d(ba)&&!Ca.d(Ua)&&parseFloat(ba)>
parseFloat(Ua)?(ka=Y.a.instance.ga(1715),{returnValue:!1,errorString:ka,Qq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:ka,Qq:ra}}static Tia(ka){switch(ka){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static gub(ka,ra){ra.a=d(ka.ruleType);ra.b=f(ka.RB);ra.c=!!ka.uO;ra.d=!!ka.vO;ra.e=ka.y5;ra.f=ka.z5;ra.g=ka.T5;ra.h=!!ka.KF;
ra.i=!!ka.MV;ra.j=ka.S5;ra.k=ka.y_;ra.l=!!ka.eU;ra.m=!!ka.dU}}Object(t.a)(ia,"DataValidationEditDialog",M.a,[]);var Ra=a(89);M=a(262);class Ya{}Ya.yjh="DataValidationDialogPanel";Ya.xjh="DataValidationButtonPanel";Ya.wjh="DataValidationButtonClearAll";Object(t.a)(Ya,"CssClassNames",null,[]);class Ga extends U.a{constructor(ka,ra,ba){super(ka);this.Hba=this.Iba=this.Gba=null;this.pqc=()=>{this.Gba.checked?(this.Iba.disabled=!1,this.Hba.disabled=!1):(this.Iba.disabled=!0,this.Hba.disabled=!0);return!1};
this.get_visible=this.yka;this.set_visible=this.koa;this.Tk=ra;this.Tka(ba)}get title(){return Y.a.instance.ga(1700)}render(ka){ka.appendChild(this.domElement)}yka(){return this.isVisible}koa(ka){return this.isVisible=ka}setFocus(){}dispose(){this.gk();this.Tk=this.Iba=this.Hba=this.Gba=null;super.dispose()}Tka(ka){na.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&na.EwaSettings.isChangeGateEnabled("OfficeVSO:7126093_ReduceInnerHTMLUsageForDataValidationEditInputControl")?
ka.ni(this.domElement,G.eNe):this.domElement.innerHTML=G.eNe;this.Gba=K.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");K.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Iba=K.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Hba=K.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Gba.checked=!0;this.Oj();this.pqc(null)}kBa(ka){this.Iba.value=void 0===ka.KF||null===ka.KF?"":ka.KF;
this.Hba.value=void 0===ka.MV||null===ka.MV?"":ka.MV;this.Gba.checked=ka.T5;this.pqc(null)}erb(ka){ka.KF=this.Iba.value;ka.MV=this.Hba.value;ka.T5=this.Gba.checked}Oj(){L.a.instance.sa(P.a.change,this.Gba,this.pqc);L.a.instance.sa(P.a.change,this.Gba,this.Tk);L.a.instance.sa(P.a.change,this.Iba,this.Tk);L.a.instance.sa(P.a.Pb,this.Iba,this.Tk);L.a.instance.sa(P.a.change,this.Hba,this.Tk);L.a.instance.sa(P.a.Pb,this.Hba,this.Tk)}gk(){L.a.instance.Ba(P.a.change,this.Gba,this.pqc);L.a.instance.Ba(P.a.change,
this.Gba,this.Tk);L.a.instance.Ba(P.a.change,this.Iba,this.Tk);L.a.instance.Ba(P.a.Pb,this.Iba,this.Tk);L.a.instance.Ba(P.a.change,this.Hba,this.Tk);L.a.instance.Ba(P.a.Pb,this.Hba,this.Tk)}}Object(t.a)(Ga,"DataValidationEditInputControl",U.a,[325,3,327]);class da extends U.a{constructor(ka,ra,ba){super(ka);this.m$=this.n$=this.JVa=this.Nha=this.l$=null;this.oqc=()=>{this.l$.checked?(this.Nha.disabled=!1,this.JVa.disabled=!1,this.n$.disabled=!1,this.m$.disabled=!1):(this.Nha.disabled=!0,this.JVa.disabled=
!0,this.n$.disabled=!0,this.m$.disabled=!0);return!1};this.get_visible=this.yka;this.set_visible=this.koa;this.Tk=ra;this.Tka(ba)}get title(){return Y.a.instance.ga(1699)}render(ka){ka.appendChild(this.domElement)}yka(){return this.isVisible}koa(ka){return this.isVisible=ka}setFocus(){}dispose(){this.gk();this.Tk=this.n$=this.m$=this.JVa=this.Nha=this.l$=null;super.dispose()}Tka(ka){na.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&na.EwaSettings.isChangeGateEnabled("OfficeVSO:7126094_ReduceInnerHTMLUsageForDataValidationEditMessagesControl")?
ka.ni(this.domElement,G.hNe):this.domElement.innerHTML=G.hNe;this.l$=K.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.Nha=K.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.JVa=K.DOMElementExtensions.getElementById(this.domElement,"warningId");this.n$=K.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.m$=K.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.l$.checked=!0;this.Nha.checked=
!0;this.Oj();this.oqc(null)}kBa(ka){this.Nha.checked=ka.y_;this.JVa.checked=!ka.y_;this.n$.value=void 0===ka.eU||null===ka.eU?"":ka.eU;this.m$.value=void 0===ka.dU||null===ka.dU?"":ka.dU;this.l$.checked=ka.S5;this.oqc(null)}erb(ka){ka.eU=this.n$.value;ka.dU=this.m$.value;ka.y_=this.Nha.checked;ka.S5=this.l$.checked}Oj(){L.a.instance.sa(P.a.change,this.l$,this.oqc);L.a.instance.sa(P.a.change,this.l$,this.Tk);L.a.instance.sa(P.a.change,this.Nha,this.Tk);L.a.instance.sa(P.a.change,this.JVa,this.Tk);
L.a.instance.sa(P.a.change,this.n$,this.Tk);L.a.instance.sa(P.a.Pb,this.n$,this.Tk);L.a.instance.sa(P.a.change,this.m$,this.Tk);L.a.instance.sa(P.a.Pb,this.m$,this.Tk)}gk(){L.a.instance.Ba(P.a.change,this.l$,this.oqc);L.a.instance.Ba(P.a.change,this.l$,this.Tk);L.a.instance.sa(P.a.change,this.Nha,this.Tk);L.a.instance.sa(P.a.change,this.JVa,this.Tk);L.a.instance.Ba(P.a.change,this.n$,this.Tk);L.a.instance.Ba(P.a.Pb,this.n$,this.Tk);L.a.instance.Ba(P.a.change,this.m$,this.Tk);L.a.instance.Ba(P.a.Pb,
this.m$,this.Tk)}}Object(t.a)(da,"DataValidationEditMessagesControl",U.a,[325,3,326]);class Z{constructor(ka,ra){this.options=this.cellRange=null;this.cellRange=ka;this.options=ra}}Object(t.a)(Z,"MacroRecorderRangeDataValidationChangedPayload",null,[145]);var ha=a(1239);class Wa extends M.a{constructor(ka,ra,ba,Ua,Ka){super(ka);this.O3=this.ohc=this.Vnc=this.oFb=null;this.pOa=this.disposed=this.jla=!1;this.htmlSanitizationHelper=this.ei=null;this.KDd=Oa=>{e.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(this.disposed)e.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(r.a(Oa)){e.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${Oa?Q.a.sc(Oa.Errors):null}.`);if(Oa.Errors&&1===Oa.Errors.length){const ib=Oa.Errors[0].MessageId,La=this.Zgd(ib);if(La){this.ZFj(ib)?this.iBj(La):this.Qr(La);this.Xla("OkInvalidByServer",
Oa.Errors[0].MessageIdName);return}}e.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${Q.a.sc(Oa.Errors)}`)}this.Xla("OkValid","None");this.hide()}};this.D8c=Oa=>{this.eX(Oa);2!==Oa&&(this.ei=this.$.Kb.Cc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Oa?this.Gab():2===Oa?this.lza():this.Dma()};this.eda=()=>{this.vYj();this.pOa?this.qEe():this.YDe();return this.jla=!1};this.selectedRanges=ra;this.kUb=
ba;this.command=Ua;this.htmlSanitizationHelper=Ka;3===Ua&&(this.jla=!0);this.Tb=2;this.ew=!1;this.og=G.og}get yd(){return this.kUb}get pc(){return"DataValidationEditDialog"}QWd(){const ka={["key"]:this.yd};this.initializeAndShow(Y.a.instance.ga(1663),this.D8c,ka);e.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.ohc=this.Vnc=this.O3=null,Ra.a.Ia(this.oFb),this.oFb=null,z.b(this.$)&&z.b(this.$).qYd("DataValidationDialogCorellation"),
super.dispose(),this.disposed=!0)}get Cy(){return()=>{this.eX(1);this.Gab()}}Tv(ka){super.Tv(ka);this.qc(2,Y.a.instance.ga(1664));ka=this.rK(2);var ra=this.rK(1),ba=this.rK(0),Ua=ra.parentNode;Ua.appendChild(ka);Ua.appendChild(ra);Ua.appendChild(ba);ka.parentNode.classList.add(Ya.xjh);ka.classList.add(Ya.wjh);ka=document.getElementById("dataValidationTabsId");ra=new W(this.$,document.createElement("div"),this.eda,this.htmlSanitizationHelper);ba=new Ga(document.createElement("div"),this.eda,this.htmlSanitizationHelper);
Ua=new da(document.createElement("div"),this.eda,this.htmlSanitizationHelper);this.Lhi(ra,ba,Ua);let Ka;this.oFb=new ha.a(ka,(Ka=new aa.a,Ka.add(ra),Ka.add(ba),Ka.add(Ua),Ka));this.oFb.MXf();this.HQ=document.getElementById("validationErrorMessageId");this.kBa();z.b(this.$)&&z.b(this.$).ZXd("DataValidationDialogCorellation")}VI(){super.VI();document.getElementById(this.mi("WACDialogPanel")).classList.add(Ya.yjh)}get hZ(){return!1}get j4b(){return 3===this.O3.D8g}Xja(){return W.Xja()}phd(){return"validationErrorMessageId"}Lhi(ka,
ra,ba){this.O3=ka;this.ohc=ra;this.Vnc=ba}Ptj(){const ka={};ka.IsClearAll=this.jla;ka.Command=this.command;ka.RuleType=this.yd.ruleType;ka.ConditionType=this.yd.RB;ka.IsIgnoreBlank=this.yd.y5;ka.IsInCellDropDown=this.yd.z5;ka.LowerBoundary=this.yd.uO;ka.UpperBoundary=this.yd.vO;ka.IsAlertBlocking=this.yd.y_;ka.IsShowErrorAlert=this.yd.S5;ka.IsShowInputMessage=this.yd.T5;ka.AlertTitle=this.yd.eU;ka.AlertMessage=this.yd.dU;ka.InputTitle=this.yd.KF;ka.InputMessage=this.yd.MV;ka.ShouldIgnoreFormulaError=
this.pOa;const ra=this.$.pa.xa.Wb(),ba=()=>new Z(this.selectedRanges,ka);l.a(this.$.userOperationManager,(Ua,Ka,Oa)=>Aa(this.$.pa.xa,this.selectedRanges,ka,v.b(Ua,this.KDd),v.a(Ka),Oa,ra),Ua=>new w.a(121,0,Ua,void 0,ba),null)}ZFj(ka){return 1577787509===ka}iBj(ka){this.HQ.innerText=ka;this.RI(this.rK(0));this.pOa=!0}qEe(){this.pOa=!1;this.HQ.innerText=""}Zgd(ka){switch(ka){case 1173235830:return Y.a.instance.ga(1713);case 43935303:return Y.a.instance.ga(1714);case -1323438439:return Y.a.instance.ga(1716);
case 2112020473:return Y.a.instance.ga(1710);case -219503282:return Y.a.instance.ga(1711);case 1689335445:return Y.a.instance.ga(1712);case 2146493810:return Y.a.instance.ga(1715);case -2104909922:return String.format(Y.a.instance.mb(105),this.O3.rxb(this.yd.ruleType,this.yd.RB),this.O3.Tjd(this.yd.ruleType,this.yd.RB));case -869372599:return String.format(Y.a.instance.mb(104),this.O3.rxb(this.yd.ruleType,this.yd.RB));case -1181828368:return Y.a.instance.ga(1718);case -758480861:return Y.a.instance.ga(1719);
case -13729088:return Y.a.instance.ga(1720);case -846654055:return Y.a.instance.ga(1721);case 751854001:return Y.a.instance.ga(1722);case -453846397:return Y.a.instance.ga(1723);case 1102013489:return Y.a.instance.ga(1724);case 835813260:return Y.a.instance.ga(1725);case 1577787509:return Y.a.instance.ga(1726);case 2083564019:return Y.a.instance.ga(1717);default:e.ULS.sendTraceTag(537163265,0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${ka.toString()}.`)}return null}Gab(){e.ULS.sendTraceTag(537163264,
0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.bdc();let ka,ra;if(!({errorString:ka,Qq:ra}=this.i3d()).returnValue)return this.Qr(ka),this.Xla("OkInvalidByClient",ra),!1;this.Ptj();return!0}Dma(){this.bdc();this.Xla("Cancel","None");this.hide()}lza(){e.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.pOa?this.qEe():this.YDe();this.onj();this.jla=!0}eX(ka){ka={["ButtonType"]:Wa.Tia(ka),["DialogName"]:this.pc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:B.h(this.$).ha.ra.YF};z.b(this.$).vd(h.a.D8b,ka)}onj(){this.kUb=new x;this.kBa()}kBa(){this.Vnc.kBa(this.yd);this.ohc.kBa(this.yd);this.O3.kBa(this.yd)}bdc(){this.O3.erb(this.yd);this.Vnc.erb(this.yd);this.ohc.erb(this.yd)}Xla(ka,ra){const ba={};Wa.gub(this.yd,ba);ba.o=ka;ba.p=ra;ba.n=this.jla;this.ei&&(this.ei.stop(),ba.q=this.ei.id);A.b().Qe(49,ba,!0)}FRb(ka,ra){let ba,Ua;Ua=ba=null;if(!ka)return ra?(ba=String.format(Y.a.instance.mb(105),this.O3.rxb(this.yd.ruleType,this.yd.RB),
this.O3.Tjd(this.yd.ruleType,this.yd.RB)),Ua="DataValidationEditNoMinMaxError"):(ba=String.format(Y.a.instance.mb(104),this.O3.rxb(this.yd.ruleType,this.yd.RB)),Ua="DataValidationEditNoValueError"),{returnValue:!1,errorString:ba,Qq:Ua};if(ka.length>G.Ieg)return ba=Y.a.instance.ga(1717),{returnValue:!1,errorString:ba,Qq:Ua};if(Ca.d(ka))return{returnValue:!0,errorString:ba,Qq:Ua};if(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType){if(!fa.a.J5(ka))return ba=Y.a.instance.ga(1710),{returnValue:!1,
errorString:ba,Qq:Ua};if(1===this.yd.ruleType&&!fa.a.isInteger(ka))return ba=Y.a.instance.ga(1711),{returnValue:!1,errorString:ba,Qq:Ua};if(6===this.yd.ruleType){if(!fa.a.isInteger(ka))return ba=Y.a.instance.ga(1711),{returnValue:!1,errorString:ba,Qq:Ua};if(0>parseInt(ka,10))return ba=Y.a.instance.ga(1712),{returnValue:!1,errorString:ba,Qq:Ua}}}return{returnValue:!0,errorString:ba,Qq:Ua}}i3d(){let ka,ra;ra=ka=null;if(this.jla||0===this.yd.ruleType)return{returnValue:!0,errorString:ka,Qq:ra};const ba=
(0===this.yd.RB||1===this.yd.RB)&&3!==this.yd.ruleType&&7!==this.yd.ruleType;return!({errorString:ka,Qq:ra}=this.FRb(this.yd.uO,ba)).returnValue||ba&&!({errorString:ka,Qq:ra}=this.FRb(this.yd.vO,ba)).returnValue?{returnValue:!1,errorString:ka,Qq:ra}:ba&&(1===this.yd.ruleType||2===this.yd.ruleType||6===this.yd.ruleType)&&!Ca.d(this.yd.uO)&&!Ca.d(this.yd.vO)&&parseFloat(this.yd.uO)>parseFloat(this.yd.vO)?(ka=Y.a.instance.ga(1715),{returnValue:!1,errorString:ka,Qq:"DataValidationEditMaximumLessMinimumError"}):
{returnValue:!0,errorString:ka,Qq:ra}}set Cy(ka){super.Cy=ka}static Tia(ka){switch(ka){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return e.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static gub(ka,ra){ra.a=d(ka.ruleType);ra.b=f(ka.RB);ra.c=!!ka.uO;ra.d=!!ka.vO;ra.e=ka.y5;ra.f=ka.z5;ra.g=ka.T5;ra.h=!!ka.KF;ra.i=!!ka.MV;ra.j=ka.S5;ra.k=ka.y_;ra.l=!!ka.eU;ra.m=!!ka.dU}}Object(t.a)(Wa,"DataValidationEditDialogDeprecated",
M.a,[]);class ca{constructor(ka){this.htmlSanitizationHelper=null;this.htmlSanitizationHelper=ka}NIa(ka,ra,ba,Ua){na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new ia(ka,ra,ba,Ua)).QWd():(new Wa(ka,ra,ba,Ua,this.htmlSanitizationHelper)).QWd()}tbh(ka,ra){const ba=new I.StandardDialog;ba.Tb=3;ba.FBa(ka.rb.Fva,Y.a.instance.ga(1708),ra)}vbh(ka,ra){const ba=new I.StandardDialog;ba.Tb=1;ba.CX(ka.rb.Fva,Y.a.instance.ga(1709),ra)}}Object(t.a)(ca,"DataValidationEditDialogFactory",
null,[272]);var ja=a(48),ua=a(37);class Za extends b.a{constructor(ka){super(ka)}ld(){const ka=na.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&na.EwaSettings.isChangeGateEnabled("OfficeVSO:7126077_ReduceInnerHTMLUsageForDataValidationEditConditionsControl")&&!na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?ja.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):y.Task.Ra(null);ua.TaskExtensions.za(ka,()=>{this.Zc([new D(this.$,
new ca(ka.result))])},this.$.ka,3)}static la(ka){b.a.Nd(245,new Za(ka))}}Object(t.a)(Za,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(E,"a",function(){return Pa});const Pa=()=>{c.a.Fa(Za.la)}},1155:function(t,E,a){function c(oa,Ba,sa,qb,Jb,Yb){if(0===qb)return Object(Z.a)(ya.UnsupportedZeroResize);if(0>qb||0===sa.length)return Object(Z.a)(ya.InvalidInput);if(oa.Vai())return Object(Z.a)(ya.UnsupportedSkeletonInView);const jb=oa.$j("ResizeCSE");if(!jb)return Object(Z.a)(ya.NullSPD);var ab=jb.R4e(sa);
if(ab&&0<ab.length)return Object(Z.a)(ab.length.toString()+" "+ya.UnsupportedHiddenInRange);a:{for(const Da of sa)Jb?Da.right=X.a.uh:Da.bottom=X.a.gh;ab=oa.kaa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",sa);try{for(ab.$$rst();ab.$$mn();)if(ab.ao.jLj){var vb=!0;break a}}finally{ab&&ab.dispose()}vb=!1}if(vb)return Object(Z.a)(ya.UnsupportedMergeCell);if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Jb&&"undefined"!==typeof gridRenderer)for(const Da of sa)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Da.left);
oa=oa.Da;vb=Ma.a.create().toString();jb.Gkg(sa,qb,Jb);Yb=oa.dYj(Jb,Yb);Ba.qdj(sa,Jb);oa.o$i(Yb,vb,Jb?"row":"column");return Object(Z.d)(qb)}var b=a(9);t=a(0);var e=a(222),f=a(7),d=a(15),h=a(89);a(264);var m=a(187),l=a(419),w=a(83),n=a(777),x=a(165),r=a(266),u=a(24),v=a(874),B=a(40);class z{}z.pLh="GalleryGeneral";z.rLh="GalleryNumber";z.nLh="GalleryCurrency";z.lLh="GalleryAccounting";z.uLh="GalleryShortDate";z.qLh="GalleryLongDate";z.wLh="GalleryTime";z.sLh="GalleryPercentage";z.oLh="GalleryFraction";
z.tLh="GalleryScientific";z.vLh="GalleryText";z.i_g="ButtonComma";z.buttonPercentage="ButtonPercentage";z.keyboardNumber="KeyboardNumber";z.keyboardCurrency="KeyboardCurrency";z.keyboardDate="KeyboardDate";z.keyboardTime="KeyboardTime";z.keyboardPercentage="KeyboardPercentage";Object(t.a)(z,"RibbonFormatKind",null,[]);var A=a(60),y=a(296),D=a(620),I=a(619),M=a(618);class T extends y.a{constructor(oa,Ba,sa,qb,Jb,Yb,jb,ab,vb,Da,Fa,nb=null,Ta=null){super(11,0,ab,Fa);this.NJh=oa;this.Qed=Ba;this.format=
qb;this.activeCell=sa;this.swe=Jb;this.INf=Yb;this.DNf=jb;this.jGa=vb;this.clientCorrelationId=Da;this.tnb=nb;this.Ljb=Ta}get Zt(){return this.tnb}get Naa(){return this.Ljb}get BFc(){return this.jGa}r3(oa){return super.r3(oa)||this.NJh.r3(this.Qed,this.activeCell,this.format,this.swe,this.INf,this.DNf,this.D1b,this.jGa,this.clientCorrelationId,this.tnb,this.Ljb)}ik(){const oa=[];if(this.gfc)for(const Ba of this.gfc)oa.push(M.a(Ba));else oa.push(new I.a(this.format,this.Qed,this.activeCell));return()=>
new D.a(oa)}kgb(){const oa={OperationType:0};oa.FormatCellsMultiRange=this.Qed;oa.ActiveCell=this.activeCell;oa.Format=this.format;oa.ApplyFormatOnPivotTableValueField=this.swe;oa.PivotTableXluid=this.INf;oa.PivotTableFieldCaption=this.DNf;return oa}}Object(t.a)(T,"FormatCellsBatchOperation",y.a,[]);var S=a(33),H=a(207);class C{}C.editCell="Edited";C.dependentCell="Dependents";Object(t.a)(C,"RecalcPriorityGroupType",null,[]);var G=a(199),J=a(1);const L=oa=>{switch(oa.alignment){case "Center":return 2;
case "Left":return 1;case "Right":return 3;default:return d.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},P=oa=>{if(oa=oa.color){if("String"===Object.getType(oa).getName())return G.a.yp(oa);if("Number"===Object.getType(oa).getName())return null}else return null;d.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},aa=(oa,Ba)=>{oa=excelOnlineCalc.calc.getCellValueKind(oa.rangeDelta.data.value);
switch(oa){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7317053_CalcErrorValueTypeSupported"))return!0;Ba.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return Ba.numberOfUnsupportedRichCellTypes++,!1;default:return d.ULS.shipAssertTag(537162192,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${oa}`),!1}},U=oa=>{oa=excelOnlineCalc.calc.getCellValueKind(oa.rangeDelta.data.value);
let Ba=0;switch(oa){case "number":Ba=1;break;case "string":Ba=2;break;case "boolean":Ba=3;break;case "Error":Ba=4;break;case "Blank":Ba=0;break;default:d.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${oa}`)}return Ba},K=oa=>{const Ba=oa.value;switch(oa.type){case 2:return void 0===Ba||null===Ba?"":Ba;case 1:return oa=parseFloat(Ba),isNaN(oa)?null:oa;case 3:return oa=parseFloat(Ba),isNaN(oa)?null:1===oa;case 4:return oa=parseFloat(Ba),isNaN(oa)?
null:excelOnlineCalc.calc.errorValue(oa);default:return excelOnlineCalc.calc.blankValue}},Y=(oa,Ba)=>{const sa=na(Ba);var qb=!(void 0===Ba.rangeDelta.data.format||null===Ba.rangeDelta.data.format);d.ULS.shipAssertTag(537162187,0,0===sa||!qb,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${Ba.priorityGroup}`);oa=Math.max(oa.cell.Hj,0);qb&&(qb=excelOnlineCalc.calc.getCellFormatKind(Ba.rangeDelta.data.format.format),"number"===qb?oa=Ba.rangeDelta.data.format.format:
"string"===qb?d.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===qb?d.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):d.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return oa},na=oa=>{if(oa.priorityGroup===C.editCell)return 0;if(oa.priorityGroup===C.dependentCell)return 1;d.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2},W=oa=>{oa=na(oa);if(0===oa)return 1;if(1===oa)return 2;d.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0};var X=a(8);class Aa{constructor(oa=0,Ba="",sa=0,qb="",Jb=""){this.ZE=oa;this.cellValue=Ba;this.ifmt=sa;this.priorityGroup=qb;this.ly=Jb}}Object(t.a)(Aa,"RecalcAccuracyObject",null,[]);class Q{}Q.string="String";Q.blank="Blank";Q.general="General";Q.AIh="Flexible";Object(t.a)(Q,"FormattedUnitKind",null,[]);class fa{constructor(oa=
0,Ba=0,sa=0,qb=0,Jb=0,Yb=0,jb=0,ab=0,vb=0,Da=0,Fa=0,nb=0,Ta=0,V=0,va=0,wb=!1,fc="",Fc=0,Qa=null,la=null,hb=null,Kb=null,dc=null,sb=null,bb=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=
this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;
this.totalNumberOfCellsInBatch=oa;this.numberOfNonUpdatedCells=Ba;this.numberOfUpdatedCells=sa;this.numberOfCellsUpdatedAlreadyByServer=qb;this.numberOfCellsSkippedDueToTimeout=Jb;this.numberOfCellsWithNoFormattedCell=Yb;this.numberOfUnsupportedErrorCellTypes=jb;this.numberOfUnsupportedBlankCellTypes=ab;this.numberOfUnsupportedRichCellTypes=vb;this.numberOfSkippedCellsDueToMissingLocaleInfo=Da;this.totalExecutionTime=Fa;this.originalProcessingTimeLimit=nb;this.newProcessingTimeLimit=Ta;this.numberOfEditedRecalcedCellsInBatch=
V;this.numberOfDependentRecalcedCellsInBatch=va;this.isNewTask=wb;this.lastSetCellInstantaneousOperation=fc;this.taskId=Fc;this.isNewNumberFormatter=Qa;this.numberOfRecalcedCellsWithFormattedValue=la;this.numberOfRecalcedCellsWithoutFormattedValue=hb;this.totalNumberFormatterTime=Kb;this.newNumberFormatterFinalizeFailures=dc;this.numberOfMeasureTextWidthCalls=sb;this.numberOfHashFormattedValues=bb}}Object(t.a)(fa,"RecalcResultProcessingStatistics",null,[]);class Ca{constructor(oa,Ba,sa,qb){this.rangeDelta=
oa;this.stateId=Ba;this.isFinished=sa;this.priorityGroup=qb}}Object(t.a)(Ca,"RecalcedCellInfo",null,[]);var ia=a(109),Ra=a(11),Ya=a(22),Ga=a(55),da=a(68),Z=a(291);class ha{constructor(oa,Ba,sa){this.Jda=[];this.calcManager=this.iCc=this.lastSetCellInstantaneousOperation=null;this.nQf=qb=>{var Jb;if(qb&&qb.rangeDeltas){var Yb=this.Jda.length;for(let jb=0;jb<qb.rangeDeltas.length;jb++)(null===(Jb=qb.rangeDeltas[jb])||void 0===Jb?0:Jb.data)&&void 0!==qb.rangeDeltas[jb].data.value&&null!==qb.rangeDeltas[jb].data.value&&
void 0!==qb.rangeDeltas[jb].range&&null!==qb.rangeDeltas[jb].range&&this.Jda.push(new Ca(qb.rangeDeltas[jb],qb.stateId,qb.isFinished,qb.priorityGroup));d.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${qb.stateId}, priorityGroup=${qb.priorityGroup}, recalcFinished=${qb.isFinished}, cellsFromCalc=${qb.rangeDeltas.length}, initialCellsToRender=${Yb}, recalcedCells=${this.Jda.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);!Yb&&this.Jda.length&&
this.YHf(!1,0)}};this.$=oa;this.grid=Ba;this.qg=sa;this.Eda=ha.aMe;this.$.da.fb(268,qb=>{this.iCc=qb});this.$.da.fb(266,qb=>{this.calcManager=qb});this.CCb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.ovd=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.$vi=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=this.iCc=this.qg=
this.grid=this.$=null}Cdd(oa,Ba,sa,qb,Jb,Yb,jb){if(!Ba)return Object(Z.a)("Null");var ab=excelOnlineCalc.numfmt.renderCallback(qb,Da=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Da,Jb,!0,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),jb);let vb=oa.renderValue(Ba,ab);if(!excelOnlineCalc.util.isSuccess(vb))return Object(Z.a)("Finalize");qb=null;if(jb=excelOnlineCalc.numfmt.isHashesValue(vb.value)){if(vb=oa.renderHashesValue(vb.value,ab),!excelOnlineCalc.util.isSuccess(vb))return Object(Z.a)("Hashes")}else qb=
ha.ZJh(Ba,vb.value);ab=vb.value;oa=excelOnlineCalc.numfmt.renderedValueToString(ab);Ba=L(ab);ab=P(ab);return Object(Z.d)({text:oa,valueType:sa,fontColor:ab,Hj:Yb,CPa:qb,horizontalAlignment:Ba,isHashesValue:jb})}YHf(oa,Ba){this.$&&this.grid&&this.calcManager&&this.iCc&&this.calcManager.HB?(oa&&(this.Eda=this.iCc.Igf),this.z8i(this.grid,this.calcManager.HB,oa,Ba),!this.Eda&&this.Jda.length?Ga.Task.delay(0).np(sa=>{this.YHf(!0,sa.id);return!0},0,null,da.a.current):Ga.Task.Ra(!0)):(d.ULS.sendTraceTag(537162181,
0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Ga.Task.Ra(!1))}z8i(oa,Ba,sa,qb){const Jb=Ra.HelperMethods.Sb();for(sa=new fa(this.Jda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.Eda,void 0,void 0,void 0,sa,void 0,qb,!0,0,0,0,0,0,0);0<this.Jda.length;){qb=Ra.HelperMethods.Sb()-Jb;if(!this.Eda||qb>this.Eda){sa.numberOfCellsSkippedDueToTimeout=this.Jda.length;break}qb=Array.dequeue(this.Jda);if(aa(qb,
sa)){var Yb=u.Range.Qc(qb.rangeDelta.range.row+1,qb.rangeDelta.range.column+1);(Yb=oa.Ub(Yb))?ha.$0g(qb.stateId,Yb.cell)?(ha.Poc(oa,Yb,qb,sa),this.LSg(Ba,Yb,qb,sa)):sa.numberOfCellsUpdatedAlreadyByServer++:sa.numberOfCellsWithNoFormattedCell++}}qb=Math.round(Ra.HelperMethods.Sb()-Jb);this.I0j(qb);this.jOj(sa,qb);this.vmj(sa)}LSg(oa,Ba,sa,qb){var Jb,Yb,jb,ab,vb=Y(Ba,sa);const Da=sa.rangeDelta.data.formatted,Fa=U(sa),nb=na(sa);oa=this.Cdd(oa,Da,Fa,Ba.cell.aCa,Ba.cell.Jia,vb,!1);vb=Ba.cell.TGc;if(Object(Z.c)(oa))if(this.CCb&&
this.ovd){if(0===nb||Ba.text!==oa.value.text)this.$vi&&0===nb&&this.sVd(vb,oa.value)&&(Ba.cell.formattedText=vb),this.qg.J_a(Ba,oa.value),sa=W(sa),this.qg.lad(Ba,this.lastSetCellInstantaneousOperation,1,sa,!0,!0),0===nb&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Tyf(Ba.range):d.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),
qb.numberOfUpdatedCells++}else Ba.text!==oa.value.text&&(this.qg.J_a(Ba,oa.value),sa=W(sa),this.qg.lad(Ba,this.lastSetCellInstantaneousOperation,1,sa,!0,!0),qb.numberOfUpdatedCells++);else switch(oa.reason){case "Null":qb.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Jb=qb.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Jb?Jb:0)+1;break;case "Hashes":qb.numberOfHashFormattedValues=(null!==(Yb=qb.numberOfHashFormattedValues)&&void 0!==Yb?Yb:0)+1;break;case "Finalize":qb.newNumberFormatterFinalizeFailures=
(null!==(jb=qb.newNumberFormatterFinalizeFailures)&&void 0!==jb?jb:0)+1}Object(Z.b)(oa)&&"Null"!==oa.reason&&(qb.numberOfRecalcedCellsWithFormattedValue=(null!==(ab=qb.numberOfRecalcedCellsWithFormattedValue)&&void 0!==ab?ab:0)+1);qb=0===nb?Ba.cell.userInput:Ba.formulaBarText;ab=Object(Z.c)(oa)?oa.value.text:"";sa=Object(Z.b)(oa)?oa.reason:"";d.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${Ba.range.top}, ${Ba.range.left}) 2nd pass formatting, success: ${Object(Z.c)(oa)}, reason: ${sa}, priority: ${nb}, ifmt: ${Ba.cell.Hj}, input: '${qb?
Ya.a.JM(qb):"null"}', prediction: '${ab?Ya.a.JM(ab):"null"}',`)}I0j(oa){this.Eda=Math.max(this.Eda-Math.max(oa,1),0)}jOj(oa,Ba){oa.numberOfNonUpdatedCells=this.Jda.length;oa.totalExecutionTime=Ba;oa.newProcessingTimeLimit=this.Eda;oa.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}vmj(oa){oa=Sys.Serialization.JavaScriptSerializer.serialize(oa);d.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${oa}`)}static ZJh(oa,Ba){oa=oa.units;var sa=
Ba.units;if(oa.length!==sa.length)return d.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;Ba=[];let qb=-1;for(let Jb=0;Jb<oa.length;Jb++)switch(oa[Jb].kind){case Q.blank:Ba.push(...ia.h(" ",sa[Jb].str.length));break;case Q.string:Ba.push(oa[Jb].str);break;case Q.AIh:Ba.push("");qb=Jb;break;case Q.general:Ba.push(sa[Jb].str);break;default:d.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=qb||""===sa[qb].str)return null;sa={};sa.Start=Ba.slice(0,qb).join("");sa.Separator=oa[qb].str;sa.End=Ba.slice(qb+1,Ba.length).join("");return sa}static EQh(oa){return oa&&oa&&oa.sy?oa.sy.VE:X.a.se}static $0g(oa,Ba){if(!Ba)return!1;Ba=ha.EQh(Ba);return Ba===X.a.se||Ba===oa}static Poc(oa,Ba,sa,qb){var Jb=sa.rangeDelta.data.value.toString();const Yb=U(sa),jb=Y(Ba,sa);Jb=new Aa(Yb,Jb,jb,sa.priorityGroup);Ba.cell.Poc(Jb,
oa.Da.lya);1===na(sa)?qb.numberOfDependentRecalcedCellsInBatch++:qb.numberOfEditedRecalcedCellsInBatch++}sVd(oa,Ba){return null==oa?!1:!!oa.TextRuns&&!!oa.Fonts&&oa.Text===Ba.text&&2===Ba.valueType}}ha.aMe=20;Object(t.a)(ha,"CalcResultProcessor",null,[666,3]);class Wa{constructor(oa,Ba=null,sa=""){this.success=oa;this.Uoc=Ba;this.reason=sa}}Object(t.a)(Wa,"GetRibbonNumberFormatResult",null,[]);var ca=a(912);class ja{constructor(oa,Ba){this.Ox=null;this.Da=oa;this.d4a=Ba}peb(oa,Ba,sa,qb,Jb=!1,Yb=!1){oa&&
(oa.c1(Ba,sa,Jb,Yb),oa.verticalAlignment=qb)}TMb(oa,Ba,sa){this.Ox||(this.Ox=new ca.a(this.Da,this.d4a));this.Ox.TMb(oa,Ba,sa)}}Object(t.a)(ja,"FormatCellsActionModelAccessor",null,[660]);var ua=a(208),Za=a(28),Pa=a(29),ka=a(283),ra=a(252),ba=a(282),Ua=a(64);class Ka{constructor(){this.zmg=this.w4j=!1;this.source=0;this.Zka=this.ekc=!1}}Object(t.a)(Ka,"FormatCellInstantaneousResult",null,[]);class Oa{constructor(oa,Ba){this.success=oa;this.ly=Ba}}Object(t.a)(Oa,"FormatStringResult",null,[]);var ib=
a(21),La=a(175),db=a(1087),Ab=a(44),Mb=a(521),pb=a(51),Qb=a(201),xb=a(263),pa=a(79),Ma=a(171),ya;(function(oa){oa.InvalidInput="invalid input";oa.UnsupportedZeroResize="resizing to 0 - ignore";oa.UnsupportedSkeletonInView="skeleton in view - ignore";oa.NullSPD="ActiveSheetProcessedData is null";oa.UnsupportedHiddenInRange="hiddens in resizeRanges";oa.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(ya||(ya={}));Object(t.b)("InstantaneousRowColumnResizeFailureReason",ya);
var Ea=a(174);class Na{constructor(oa){this.Ox=this.calcManager=this.vy=this.WTa=null;this.Qjf=Ba=>{if(Ba){const sa=Ra.HelperMethods.eP.hasOwnProperty(Ba);Ba=ib.h(this.$).isFontSupported(Ba);return!sa&&Ba}d.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.isFontFromFontService: fontName cannot be null");return!1};this.yRi=(Ba,sa)=>{if(Ba&&!ka.a(Ba)&&sa){const qb=!!Ba&&!!Ba.RequestTelemetryData;ib.h(this.$).Eh.gma(sa.toString(),Ba.StateId,qb?Ba.RequestTelemetryData.EcsOperationDuration:0,qb?Ba.RequestTelemetryData.EcsRequestDuration:
0,qb?Ba.RequestTelemetryData.WfeRequestDuration:0)}};this.$=oa;this.$.da.fb(268,Ba=>{this.vy=Ba});this.OJh=new ja(ib.h(this.$).Da,this.$);this.$ha=new ha(this.$,ib.h(this.$),this);this.$.da.fb(266,Ba=>{this.calcManager=Ba});this.xb=J.EwaSettings.xb();this.Wl=J.EwaSettings.Wl();this.CCb=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.ovd=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.gOa=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.awi=J.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker");this.ql=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get wva(){return this.OJh}get HB(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.HB}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){h.a.rc([this.WTa,this.$ha]);this.$=this.$ha=this.WTa=null}KTa(oa,
Ba,sa,qb=!1,Jb="",Yb=0,jb=null){return this.THj(oa,Ba,sa,qb,Yb,Jb,jb)}lad(oa,Ba,sa,qb,Jb,Yb){oa.cell.sy.ZJ|=qb;Na.p8g(ib.h(this.$),oa,sa,Jb);this.$ha.lastSetCellInstantaneousOperation=Ba;Yb&&(ib.h(this.$).Eh.HS(Ba,Ua.BasicTelemetryCalculator.jR),J.EwaSettings.isChangeGateEnabled("OfficeVSO:7198762_AddTelemetryforCalculateDurationBetweenPhases")&&(1===sa&&1===qb?ib.h(this.$).Eh.HS(Ba,Ua.BasicTelemetryCalculator.Jgf):1!==sa&&ib.h(this.$).Eh.HS(Ba,Ua.BasicTelemetryCalculator.Kpd)))}Aea(oa,Ba,sa,qb=!1,
Jb=null,Yb=null){Yb=Yb||oa.ha.ra.selectedRanges;if(!(-1690267012===Ba&&1<Yb.length)){-1690267012===Ba&&d.ULS.shipAssertTag(537162176,0,1===Yb.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${Yb.length}`);Yb=oa.kaa("FormatCellsAction.ShowInstantaneousFormatting",Yb);try{Yb.$$rst();let jb=!1;for(;Yb.$$mn();){let ab;const vb=Yb.$$cu().bI?oa.rMb(Yb.$$cu().range):(ab=new m.a,ab.add(Yb.$$cu()),ab);for(let Da of vb)if(ib.h(this.$),!Da||Yb.hb.contains(Da.range))if(this.q$f(Ba,
Da,sa,qb,Jb,Yb.$$cu().bI),jb||(oa.Da.QV(),jb=!0),Jb)break}}finally{Yb&&Yb.dispose()}}}J_a(oa,Ba,sa=null){sa&&(sa.Zka=!0);sa=!Ba.text;const qb=Ya.a.Hlf(Ba.text);let Jb;const Yb=oa.bI?ib.h(this.$).rMb(oa.range):(Jb=new m.a,Jb.add(oa),Jb);for(let jb of Yb)this.JSg(this.$,jb,Ba.text,Ba.horizontalAlignment,Ba.fontColor,Ba.Hj,oa.cell.Hj,sa,qb,Ba.valueType,Ba.CPa);oa.cell.pFc()}v3i(oa,Ba,sa,qb,Jb=null){try{const Yb=B.D(Ba);let jb=B.D(sa);if(oa.Ab.e8a(Yb)||oa.Ab.e8a(jb))return 8;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7148128_BlockWrapTextCseForPaste")&&
-185374993!==qb&&(oa.Ab.Gof(Yb)||oa.Ab.Gof(jb)))return 18;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:7327017_BlockCondFormattingForPaste")&&-185374993!==qb&&(oa.Ab.yif(Yb)||oa.Ab.yif(jb)))return 19;if(-185374993!==qb&&this.Rti(oa,Yb,jb))return 9;if(-185374993!==qb&&(oa.Ab.O5(jb)||oa.Ab.TBb(Yb)))return 10;if(1804571062!==qb&&oa.Ab.N5(jb))return 11;if(this.yph(jb))return 12;if(this.Pui(Yb,jb))return 13;const ab=this.$.Kb.Cc("UserAction","PasteInstantaneous");ab.start();Mb.a(ab);Jb&&pb.b().BC(ab.id,
Jb.id,"actions","actions");!Yb.isSingle&&jb.isSingle&&(jb=Na.expandRange(Yb,jb),oa.ha.updateSelection(jb,jb,0));switch(qb){case 237279923:case 808159687:if(!this.N3i(Yb,jb))return 14;this.b6c(oa,Yb,jb,!0,!1);break;case 1804571062:this.b6c(oa,Yb,jb,!0,!1);break;case -185374993:this.b6c(oa,Yb,jb,!1,!0);break;default:return 2}d.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Yb){return d.ULS.sendTraceTag(537162145,0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(Yb)}`),
15}}l5g(oa,Ba){for(const sa of oa)this.E3c(sa,!0,Ba)}E3c(oa,Ba,sa=""){if(oa){var qb=ib.h(this.$);if(Ba){if(Ba=qb.jk("FormatCellsAction.ClearRangeInstantaneous",oa),qb=oa.isSingle?null:oa,Ba.$$mn()&&void 0!==Ba.$$cu()&&null!==Ba.$$cu())for(oa=Object(f.a)(new xb.a,{Text:""}),this.KTa(Ba.$$cu(),oa,!1,S.a.ssd(this.$),sa,void 0,qb);Ba.$$mn();)void 0!==Ba.$$cu()&&null!==Ba.$$cu()&&this.KTa(Ba.$$cu(),oa,!1,!1,sa)}else this.Aea(qb,-1228228458,{},void 0,void 0,[oa])}else d.ULS.shipAssertTag(537162144,0,!1,
"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}qdj(oa,Ba){if(!Ba){Ba=Ra.HelperMethods.Sb();var sa=ib.h(this.$),qb=sa.kaa("FormatCellsAction.ReformatCells",oa);try{qb.$$rst();let Jb=!1;for(;qb.$$mn();){const Yb=qb.$$cu().cell;if(0===Yb.ZE||2===Yb.ZE)this.updateSpillInformation(Yb,oa),Jb||(sa.Da.QV(),Jb=!0)}}finally{qb&&qb.dispose()}d.ULS.sendTraceTag(537162143,0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${Ra.HelperMethods.Sb()-
Ba}.`)}}rmd(oa,Ba){if(this.xb){if(oa.formulaBarText)return!Ya.a.equals(Ba.Text,oa.formulaBarText,!1);let sa=oa.cell.formattedText;sa=ra.a(sa,oa.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(sa,Ba).isEqual}return!Ya.a.equals(Ba.Text,oa.text,!1)}H_e(oa,Ba,sa,qb){if(void 0===Ba||null===Ba)return new Oa(!1,oa);const Jb={};Jb.value=oa;Jb.type=1;Ba=this.w4a(Jb,Ba,sa,qb);return Object(Z.b)(Ba)?new Oa(!1,oa):new Oa(!0,Ba.value.text)}UHj(oa,Ba,sa,qb){return c(oa,this,
Ba,sa,qb,!0)}RHj(oa,Ba,sa){if(!this.rmd(Ba,sa))return Object(Z.d)("Skip unchanged cell content");Ba=Ba.cell;sa=this.J_e(sa.Text,Ba.Hj,Ba.aCa,Ba.Jia,!0);if(Object(Z.b)(sa))oa=sa;else{sa=sa.value;var qb=Ba.hasRichValueIcon?"Unsupported rich value icon":Ba.WX?"Unsupported wrapped text":Ba.Aof||null!=Ba.VL&&0!==Ba.VL?"Unsupported rotated text":!0;!0!==qb?oa=Object(Z.a)(qb):(Ba.isCellWidthFixed?qb="Skip fixed width cell":(qb=sa.valueType,qb=0===qb?"Skip empty cell value":2===qb?"Skip string cell value":
Ba.QF&&!Ba.Hti?"Skip merged cell":Ba.$Ac?"Skip shrunk to fit":sa.isHashesValue?"Skip hashes cell value":!0),!0!==qb?oa=Object(Z.d)(qb):(sa=Ba.S9g(sa.text),sa>Ba.offsetWidth?(Ba=[Ba.getRange().clone()],oa=c(oa,this,Ba,sa,!1,!1),oa=Object(Z.b)(oa)?oa:Object(Z.d)(sa)):oa=Object(Z.d)("Column is wide enough")))}return oa}G_e(oa,Ba,sa,qb,Jb){const Yb={};Yb.value=oa;Yb.type=sa;Ba=this.w4a(Yb,Ba,qb,Jb);return Object(Z.b)(Ba)?new Oa(!1,oa):new Oa(!0,Ba.value.text)}updateSpillInformation(oa,Ba){const sa=oa.getRange();
let qb=!1;for(const Jb of Ba)if(sa.left===Jb.left){qb=!0;break}oa.uYj(qb)}THj(oa,Ba,sa,qb,Jb,Yb="",jb=null){this.CCb&&this.awi&&(oa.cell.TGc=Ba);const ab=new Ka;ab.source=0;ab.Zka=!1;oa.cell.KHb=oa.cell.Hj;let vb=Ba.Text;const Da=!vb,Fa=Ya.a.Hlf(vb);Ya.a.Uq(vb)&&(d.ULS.shipAssertTag(537162142,0,!((void 0===vb||null===vb)&&void 0!==Ba.TextRuns&&null!==Ba.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),Ba=Object(f.a)(new xb.a,{Text:""}),vb="");
oa.cell.userInput=vb;if(!this.rmd(oa,Ba))return this.H2g(oa,Jb,Da,Fa,ab);sa?this.A2g(oa,vb,this.$.workbookContext.DefaultHyperlinkStyle,ab):this.u2g(oa,Ba,vb,Da,Fa,qb,ab,jb);this.lad(oa,Yb,Jb,1,ab.ekc,ab.Zka);return ab}H2g(oa,Ba,sa,qb,Jb){Jb.zmg=!0;Jb.ekc=!0;Jb.Zka=!1;0===Ba&&ib.h(this.$).Da.QV();0===oa.cell.Iza&&(sa?oa.cell.c1(0,!1):qb&&oa.cell.c1(1,!1));this.T0d(oa.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return Jb}A2g(oa,Ba,sa,qb){qb.Zka=!0;oa.insertHyperlink(Ba,H.a.hed(Ba),sa);this.T0d(oa.range,
"FormatCellsAction.cellDataEntryCSE")}u2g(oa,Ba,sa,qb,Jb,Yb,jb,ab=null){jb.Zka=!1;const vb=oa.cell;let Da=!1;this.vy||(this.vy=this.$.da.Aa(268));this.aUj(this.vy,vb.Hj);J.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&Yb&&(Da=this.tgg(this.vy,oa,sa,ab));qb||Jb?this.w2g(oa,qb,Jb,jb):(qb=this.J_e(sa,vb.Hj,vb.aCa,vb.Jia,!1,Da),Object(Z.c)(qb)?(this.sVd(Ba.TextRuns,Ba.Fonts)&&this.y2g(oa,Ba,qb.value),this.J_a(oa,qb.value,jb),this.T0d(oa.range,"FormatCellsAction.cellDataEntryCSE")):
this.CCb&&this.ovd?this.E2g(oa,Ba.Text,jb):this.F2g(oa,Ba.Text,jb),Ba=Object(Z.c)(qb)?qb.value.text:"",Jb=Object(Z.b)(qb)?qb.reason:"",d.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${oa.range.top}, ${oa.range.left}) 1st pass formatting, success: ${Object(Z.c)(qb)}, reason: ${Jb}, ifmt: ${vb.Hj}, input: '${Ya.a.C_a(vb.userInput)}', prediction: '${Ya.a.C_a(Ba)}',`));vb.formulaBarText=sa;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||Yb&&this.tgg(this.vy,
oa,sa,ab);jb.ekc=!0}w2g(oa,Ba,sa,qb){qb.Zka=!0;oa.text="";oa.formulaBarText="";oa.cell.userInput="";this.e4b(oa,null,null,Ba,sa)}y2g(oa,Ba,sa){Ba.Text===sa.text&&2===sa.valueType&&(oa.cell.formattedText=Ba)}E2g(oa,Ba,sa){sa&&(sa.Zka=!0);oa.text=Ba;oa.formulaBarText=Ba;this.e4b(oa,1)}F2g(oa,Ba,sa){sa&&(sa.Zka=!0);oa.text=Ba;oa.formulaBarText=Ba;this.e4b(oa,1)}e4b(oa,Ba,sa=null,qb=!1,Jb=!1,Yb=!1){let jb=oa.horizontalAlignment;sa=null!=sa?sa:oa.verticalAlignment;0===oa.cell.Iza&&(null!=Ba||qb||Jb||Yb)&&
(qb?jb=0:Jb||Yb?jb=1:null!=Ba&&(jb=Ba),this.wva.peb(oa,jb,!1,sa,!0))}T0d(oa,Ba){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const sa=ib.h(this.$),qb=()=>{this.calcManager?this.calcManager.Tyf(oa):d.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${Ba}, cell ${oa}`);sa.Vb.fm(qb)};sa.Vb.Qm(qb)}}aUj(oa,Ba){(null===oa||void 0===oa?0:oa.bza)&&Ba>=
Na.gIh&&Ba>oa.bza.length-1&&(d.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${Ba}. Triggering refresh...`),oa.z_e())}tgg(oa,Ba,sa,qb=null){if(void 0===oa||null===oa)return!1;if(this.vy.Jpd)return d.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing"),!1;const Jb=this.$.da.Aa(266);return Jb?(this.$ha.Eda=ha.aMe,oa&&(this.$ha.Eda=oa.Igf),Jb.o0g(Ba,sa,this.$ha.nQf,qb)):!1}w4a(oa,Ba,
sa,qb){var Jb=this.$.da.Aa(266);if(!Jb)return Object(Z.a)("calcManager is null");if(!Jb.HB)return Object(Z.a)("calcManager.NumberFormatter is null");if(!this.vy)return Object(Z.a)("instantaneousManager is null");let Yb;if("number"===typeof Ba||"string"===typeof Ba){var jb=Jb.E5a(Ba);if(!Object(Z.c)(jb))return jb;Yb=jb.value}else Yb=Ba;jb=Jb.HB;const ab=K(oa);if(void 0===ab||null===ab)return Object(Z.a)("cellValue is null");Jb=excelOnlineCalc.calc.cellValueToReadOper(Jb.config.mathpack,ab);if(void 0===
Jb||null===Jb)return Object(Z.a)("readOper is null");Jb=jb.applyFormat(Yb,Jb,J.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(Jb)?this.$ha.Cdd(jb,Jb.value,oa.type,sa,qb,"number"===typeof Ba?Ba:-1,!1):Object(Z.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Jb.reason.kind))}J_e(oa,Ba,sa,qb,Jb,Yb){var jb=this.$.da.Aa(266);if(void 0===jb||null===jb)return Object(Z.a)("calcManager is null");if(void 0===jb.HB||null===jb.HB)return Object(Z.a)("calcManager.NumberFormatter is null");
if(void 0===this.vy||null===this.vy)return Object(Z.a)("instantaneousManager is null");if(this.CCb&&!Jb&&Yb)return Object(Z.a)("No main thread number formatter");Yb=jb.E5a(Ba);if(!Object(Z.c)(Yb))return Yb;var ab=Yb.value;Yb=jb.HB;oa=Yb.parseEdit(oa,ab);if(!excelOnlineCalc.util.isSuccess(oa))return Object(Z.a)(`ParseEdit failure: reason=${oa.reason.kind}, features=${oa.reason.features}`);if(oa.value.kind===v.a.formula)return Object(Z.a)("Main thread - skipping formula edit");jb=excelOnlineCalc.numfmt.applyValueEdit(Yb,
jb.localeInfo,ab,oa.value);if(!excelOnlineCalc.util.isSuccess(jb))return Object(Z.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(jb.reason.kind));oa=oa.value;d.ULS.shipAssertTag(537162190,0,oa.kind!==v.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");oa=excelOnlineCalc.numfmt.getValueEditOperKind(oa);ab=0;switch(oa){case 0:case 128:ab=0;break;case 1:ab=1;break;case 2:ab=2;break;case 4:ab=3;break;case 8:ab=4;break;case 16:case 32:case 64:case 256:d.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${oa} to a CellValueType`);break;default:d.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${oa}`)}return this.$ha.Cdd(Yb,jb.value,ab,sa,qb,"number"===typeof Ba?Ba:-1,Jb)}Rti(oa,Ba,sa){if(Ba.width<sa.width){const qb=oa.jk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new u.Range(Ba.top,Ba.left,Ba.bottom,Ba.left,!0,!0));for(;qb.$$mn();){let Jb=qb.$$cu();if(Jb&&
Jb.pMa())return d.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(Ba.height<sa.height)for(oa=oa.jk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new u.Range(Ba.top,Ba.left,Ba.top,Ba.right,!0,!0));oa.$$mn();)if((Ba=oa.$$cu())&&Ba.tMa())return d.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}b6c(oa,Ba,sa,qb,Jb){const Yb=Ba.MS().FirstRow,jb=Ba.MS().LastRow;
var ab=sa.MS().FirstRow;const vb=sa.MS().LastRow;let Da=Yb;for(;ab<=vb;ab++,Da++){Da>jb&&(Da=Yb);const Fa=Ba.MS();Fa.FirstRow=Fa.LastRow=Da;const nb=sa.MS();nb.FirstRow=nb.LastRow=ab;this.uah(oa,x.a.QQ(Fa),x.a.QQ(nb),qb,Jb)}}N3i(oa,Ba){const sa=this.$.da.Aa(266);return void 0!==sa&&null!==sa?(sa.j0g(oa,Ba.topLeft,this.$ha.nQf),!0):!1}Pui(oa,Ba){const sa=oa.right-oa.left+1;oa=oa.bottom-oa.top+1;const qb=Ba.right-Ba.left+1;Ba=Ba.bottom-Ba.top+1;if(qb>sa&&Ba>oa){if(!(qb%sa&&Ba%oa))return!0}else if(qb===
sa&&Ba>oa){if(!(Ba%oa))return!0}else if(qb>sa&&Ba===oa&&!(qb%sa))return!0;return!1}yph(oa){if(J.EwaSettings.oa(101)){oa=ib.h(this.$).N1(oa).gridView.getRangeInformation(oa);for(const Ba of oa)if(Object(l.a)(r.DynamicArrayRange,Ba)&&!Object(w.a)(r.DynamicArrayRange,Ba).Goc)return!0}return!1}SHe(oa,Ba,sa,qb,Jb,Yb){for(let jb of Ba)sa&&(this.yah(jb,Jb),jb.setCell(!0)),qb&&(Yb=this.K9h(Jb,jb)),Yb||(oa.Da.QV(),Yb=!0);return Yb}DVh(oa,Ba,sa){Ba=new u.Range(Ba,sa,Ba,sa,!0,!0);return oa.Ub(Ba)}uah(oa,Ba,
sa,qb,Jb){if(sa){this.WTa&&sa.equals(this.WTa.range)||(h.a.Ia(this.WTa),this.WTa=oa.jk("FormatCellsAction.CopyBetweenRows",sa));sa=this.WTa;sa.$$rst();var Yb=!1;if(J.EwaSettings.getBooleanFeatureGate(Ea.a.OKe,!1)){var jb=Ba.MS().FirstColumn+1,ab=Ba.MS().LastColumn+1;Ba=Ba.MS().FirstRow+1;let Da=jb;for(;sa.$$mn();){Da>ab&&(Da=jb);const Fa=this.DVh(oa,Ba,Da);Da+=1;var vb=void 0;const nb=sa.$$cu().bI?oa.rMb(sa.$$cu().range):(vb=new m.a,vb.add(sa.$$cu()),vb);Fa&&(Yb=this.SHe(oa,nb,qb,Jb,Fa,Yb));pa.lastOrDefault(nb)}}else for(vb=
oa.jk("FormatCellsAction.CopyBetweenRows2",Ba);sa.$$mn();)vb.$$mn()||(vb.$$rst(),vb.$$mn()),ab=vb.$$cu(),Ba=sa.$$cu().bI?oa.rMb(sa.$$cu().range):(jb=new m.a,jb.add(sa.$$cu()),jb),ab&&(Yb=this.SHe(oa,Ba,qb,Jb,ab,Yb)),pa.lastOrDefault(Ba)}else d.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}L$f(){const oa=Pa.a.dd(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");Ab.a(this.$).uj(oa)}CFi(oa,Ba){const sa={ValidMembers:32},qb=Ba.NumberFormat;switch(oa){case 1890566896:if(1001===
qb||1002===qb||1003===qb){sa.NumberFormat=14;sa.NumberFormatOptions={};switch(qb){case 1001:sa.NumberFormatOptions.TimeType=2;break;case 1002:sa.NumberFormatOptions.DateType=7;break;case 1003:sa.NumberFormatOptions.DecimalPlaces=0}sa.NumberFormatOptions.NumberFormatCategory=this.ySg(qb)}else sa.NumberFormat=qb;break;case 1886928607:sa.NumberFormat=13;break;case -992833457:sa.NumberFormat=11;break;case 218524921:sa.NumberFormat=12;break;case 996232352:sa.NumberFormat=14;sa.NumberFormatOptions=Object(f.a)(new n.a,
{DecimalPlaces:0});sa.NumberFormatOptions.NumberFormatCategory=6;break;default:return Ba}return sa}formatCells(oa,Ba,sa,qb=null,Jb=null,Yb=null,jb=null){var ab;const vb=this.$.Kb.Cc("UserAction","FormatCellsInstantaneous, command = "+pb.b().tj(oa)),Da=this.$.Kb.Qg("UserAction","FormatCellsInstantaneousFrame");Da.start();Mb.a(Da);var Fa=pb.b().tj(oa);const nb=this.$,Ta=ib.h(nb);var V=Ta.ha.ra,va=Jb||V.selectedRanges,wb=ia.g(va,hb=>hb.TC);Fa=`${Fa}, cellCount=${wb}`;ib.h(this.$).Eh.l1(1,vb.id,Fa);va=
B.r(va,this.$);V=V.activeCell;Fa=-168056295===sa.command;var fc=wb=null;if(Fa){fc=Ta.Ab.Ap(V);if(!fc){this.L$f();return}wb=fc.uda.substring(1,fc.uda.length-1);fc=fc.Ycc();if(!fc){this.L$f();return}fc=fc.Caption}Ta.yf.rH(!1,!0);const Fc=B.o(V,nb),Qa=nb.pa.xa.Wb({Fca:!0,Mba:1}),la=this.CFi(sa.command,Ba);Fa||this.Aea(Ta,oa,Ba,!1,qb,Jb);vb.stop();ib.h(this.$).Eh.HS(vb.id,Ua.BasicTelemetryCalculator.jR);sa.Jii=Za.a.Sa.zb;qb=this.$.Kb.Cc("UserAction","FormatCellsUserAction");Jb=this.ql&&this.Qjf(null===
(ab=null===Ba||void 0===Ba?void 0:Ba.Font)||void 0===ab?void 0:ab.FontName);this.MBi(oa,sa.taskId,Ba,va,V,qb.id,Jb);pb.b().BC(vb.id,qb.id,"actions","actions");pb.b().BC(Da.id,qb.id,"actions","actions");nb.userOperationManager.Ic(new T(this,va,Fc,la,Fa,wb,fc,Qa,qb,vb.id,64,Yb,jb),sa)}r3(oa,Ba,sa,qb,Jb,Yb,jb,ab,vb,Da,Fa){const nb=this.$;return(Ta,V,va)=>{nb.Py();Ta=[Ta,this.yRi];V=[V];Da&&Ta.push(Da);Fa&&V.push(Fa);return A.l(nb.pa.xa,oa,Ba,sa,qb,Jb,Yb,!1,ba.b(...Ta),ba.a(...V),va,vb,jb,ab)}}q$f(oa,
Ba,sa,qb,Jb,Yb,jb=null){if(Ba&&sa){var ab=sa.Font,vb=sa.HorizontalAlignment,Da=sa.VerticalAlignment;sa.ValidMembers&2||(vb=Ba.horizontalAlignment);sa.ValidMembers&1||(Da=Ba.verticalAlignment);var Fa=0!==vb;Na.Uki(oa)&&0===vb&&(vb=this.U4e(Ba));var nb=!1;switch(oa){case -394785302:this.wva.peb(Ba,vb,Fa,0);break;case 1041132226:this.wva.peb(Ba,vb,Fa,1);break;case -571165336:this.wva.peb(Ba,vb,Fa,2);break;case -1150205178:case -1142465846:case -286432209:this.wva.peb(Ba,vb,Fa,Da,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.gOa&&
this.nwj(Ba,sa,Fa);break;case 1650812936:this.setFillColor(Ba,sa,Yb);break;case -287251124:Ba.bold=ab.Bold;break;case -1690267012:ib.h(this.$).ha.ra.Pg&&(ab=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?jb?jb:ib.h(this.$).ha.ra.ed:ib.h(this.$).ha.ra.ed,this.wva.TMb(Ba,sa,ab));break;case 1970784898:sa=G.a.yp(Ba.color,Ba.backgroundColor);if(ua.a.compare(sa,ua.a.red)&&(Ya.a.J5(Ba.text)||Ya.a.Mbf(Ba.text)))break;sa=ua.a.IH(ab.FontColor);Ba.color=
Qb.e(G.a.BG(sa));break;case -1925065947:Ba.italic=ab.Italic;break;case -1293291468:Ba.fontName=ab.FontName;this.Wl&&Ba.s5f(ab.FontScheme);break;case 862890474:case 963349338:Ba.fontSize=ab.FontSize;this.$.af();break;case -1077965542:Ba.fontSize=ab.FontSize;break;case 1764140053:Ba.underline=ab.Underline;break;case -1685033574:Ba.doubleUnderline=ab.DoubleUnderline;break;case -1590502662:Ba.fontStrikethrough=ab.Strikethrough;break;case -848953656:case 2045211913:nb=Ba.Qrb();break;case 2105621672:sa=
Object(w.a)(db.a,Jb);if(!sa)break;ab=ua.a.TKh(sa.color);Ba.color=Qb.e(G.a.BG(ab));this.ywe(Ba,sa.Yoc);break;case -1409276245:this.ywe(Ba,sa.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.ISg(Ba,sa);break;case -1228228458:Ba.Qrb();Ba.clearFormat();this.RZc(Ba,0);nb=!0;break;case -730106152:Ba.clearFormat();this.RZc(Ba,0);break;case 932244020:this.mwj(Ba,sa,Yb);break;case -1942512156:case -1920201820:this.lyj(Ba,sa)}qb||(nb?Ba.dKb(!0):Ba.setCell(!0))}else d.ULS.shipAssertTag(537162135,
0,!Ba,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),d.ULS.shipAssertTag(537162134,0,!sa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}yah(oa,Ba){oa&&Ba?(oa.$rb(Ba),oa.Z3c(Ba),this.RZc(oa,Ba.cell.Hj)):d.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}RZc(oa,Ba){if(0>Ba)this.zca({caller:"ApplyNumberFormatIndexOnCell",cell:oa,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});
else{var sa=this.w4a(oa.vx,Ba,oa.cell.aCa,oa.cell.Jia);Object(Z.b)(sa)?this.zca({caller:"ApplyNumberFormatIndexOnCell",cell:oa,kind:"failure",reason:sa.reason}):(this.J_a(oa,sa.value),this.zca({caller:"ApplyNumberFormatIndexOnCell",cell:oa,kind:"success",ly:sa.value,format:Ba}))}}ywe(oa,Ba){if(void 0===Ba||null===Ba)this.zca({caller:"ApplyNumberFormatStringOnCell",cell:oa,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var sa=this.w4a(oa.vx,Ba,oa.cell.aCa,
oa.cell.Jia);Object(Z.b)(sa)?this.zca({caller:"ApplyNumberFormatStringOnCell",cell:oa,kind:"failure",reason:sa.reason}):(this.J_a(oa,sa.value),this.zca({caller:"ApplyNumberFormatStringOnCell",cell:oa,kind:"success",ly:sa.value,format:Ba}))}}ISg(oa,Ba=null){if(Ba)if(Ba=this.Q1h(oa,Ba),Ba.success){var sa=this.w4a(oa.vx,Ba.Uoc,oa.cell.aCa,oa.cell.Jia);Object(Z.b)(sa)?this.zca({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"failure",reason:sa.reason,format:Ba.Uoc}):(this.J_a(oa,sa.value),this.zca({caller:"ApplyNumberFormatCategoryOnCell",
cell:oa,kind:"success",ly:sa.value,format:Ba.Uoc}))}else this.zca({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"failure",reason:Ba.reason,format:Ba.Uoc});else this.zca({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}ySg(oa){switch(oa){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<oa?-1:oa}Q1h(oa,
Ba){if(!this.vy||!this.localeInfo||!Ba)return oa=this.vy?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Wa(!1,void 0,"GetRibbonNumberFormat: "+oa);Ba=Ba.NumberFormat;switch(Ba){case 0:oa=z.pLh;break;case 1:oa=z.rLh;break;case 2:oa=z.nLh;break;case 3:oa=z.lLh;break;case 4:oa=z.uLh;break;case 5:oa=z.qLh;break;case 6:oa=z.wLh;break;case 7:oa=z.sLh;break;case 8:oa=z.oLh;break;case 9:oa=z.tLh;break;case 10:oa=z.vLh;break;case 11:case 12:return this.vy.z_e(),
this.WSh(oa,Ba);case 13:oa=z.i_g;break;case 1006:oa=z.buttonPercentage;break;case 1004:oa=z.keyboardNumber;break;case 1005:oa=z.keyboardCurrency;break;case 1002:oa=z.keyboardDate;break;case 1001:oa=z.keyboardTime;break;case 1003:oa=z.keyboardPercentage;break;case 14:return oa="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",d.ULS.shipAssertTag(537162132,0,!1,oa),new Wa(!1,void 0,oa);default:return oa="GetRibbonNumberFormat: unknown NumberFormatType!",d.ULS.shipAssertTag(537162131,
0,!1,oa),new Wa(!1,void 0,oa)}return oa?(oa=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,oa))?new Wa(!0,oa):new Wa(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new Wa(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}WSh(oa,Ba){if(!this.calcManager||!this.HB)return Ba=this.calcManager?"numberFormatter is null":"calcManager is null",new Wa(!1,void 0,"GetDecimalChangeNumberFormat: "+Ba);oa=
this.calcManager.E5a(oa.cell.Hj);if(!Object(Z.c)(oa))return new Wa(!1,void 0,`getDecimalChangeNumberFormat: ${oa.reason}`);Ba=this.HB.changeFormatDecimals(oa.value,11===Ba?1:-1);return excelOnlineCalc.util.isSuccess(Ba)?void 0===Ba.value||null===Ba.value?new Wa(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new Wa(!0,Ba.value):new Wa(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}zca(oa){const Ba=oa.caller,sa=oa.cell;var qb=oa.format;qb=
null==qb?"null":"number"===typeof qb?qb:"string"===typeof qb?Ya.a.C_a(qb):Ya.a.C_a(qb.formatString);const Jb=Ya.a.C_a(sa.vx.value)||"null",Yb="success"===oa.kind?Ya.a.C_a(oa.ly.text):"null";oa=JSON.stringify({caller:Ba,"range.top":sa.range.top,"range.left":sa.range.left,result:oa.kind,reason:"success"===oa.kind?"":oa.reason,value:Jb,valueType:sa.vx.type,ifmt:qb,prediction:Yb});d.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${oa}`)}JSg(oa,Ba,sa,qb,Jb,Yb,jb,ab=!1,vb=!1,Da=
0,Fa=null){const nb=Ba.cell;nb.ZE=Da;Da=Ba.text;Da!==sa&&(nb.text=sa);nb.CPa=Fa;La.f(Da)?Ba.formulaBarText=Da:Ba.formulaBarText="";oa=ib.h(oa).Ab.mmf(Ba.range);this.e4b(Ba,qb,null,ab,vb,oa);Jb&&(Ba.color=Qb.e(G.a.BG(Jb)));Ba.cell.Hj=Yb;Ba.cell.KHb=jb;Ba.cell.ABc=Yb}MBi(oa,Ba,sa,qb,Jb,Yb,jb){const ab={};ab.a=this.$.ya.UserSessionId;ab.b=Ba;ab.c=qb.Ranges.length;ab.d=this.zeh(qb.Ranges);ab.e=Jb.toString();ab.f=oa;ab.h=Yb;1890566896===oa?ab.g=sa.NumberFormat.toString():2105621672===oa?ab.g=sa.NumberFormatOptions.NumberFormatCategory.toString():
this.ql&&-1293291468===oa&&(ab.g=`{ "isNewFont": ${jb} }`);pb.b().Qe(3,ab,!0)}zeh(oa){let Ba=0,sa=0,qb=0;for(let Jb=0;Jb<oa.length;Jb++){const Yb=B.B(oa[Jb]).TC;Ba+=Yb;Yb>qb&&(qb=Yb,sa=Jb)}oa=B.B(oa[sa]).toString();return"TotalCellCount:"+Ba+"; Max range:"+oa+"; MaxRangeSize:"+qb+";"}mwj(oa,Ba,sa){64===(Ba.ValidMembers&64)&&this.setFillColor(oa,Ba,sa);16===(Ba.ValidMembers&16)&&Na.Nxj(oa,Ba);128===(Ba.ValidMembers&128)&&this.wva.TMb(oa,Ba,oa.range);if(2===(Ba.ValidMembers&2)||1===(Ba.ValidMembers&
1)){sa=Ba.VerticalAlignment;Ba=Ba.HorizontalAlignment;const qb=0!==Ba;J.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!qb&&this.U4e(oa);this.wva.peb(oa,Ba,qb,sa)}}setFillColor(oa,Ba,sa){(J.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?oa.cR:oa.cR&&oa.Nyb&&!oa.Qyb&&!oa.Tyb)||(Ba=-1===Ba.FillColor?sa?G.a.BG(ua.a.white):null:G.a.BG(ua.a.IH(Ba.FillColor)),oa.backgroundColor=Ba?Qb.e(Ba):null)}lyj(oa,Ba){0!==oa.horizontalAlignment&&
2!==oa.horizontalAlignment||oa.c1(1,!1);0<=oa.indentation+Ba.IndentationIncrease&&(oa.indentation+=Ba.IndentationIncrease)}nwj(oa,Ba,sa){const qb=Ba.TextOrientation;qb!==X.a.verticalText&&(0>qb||180<qb)&&d.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${qb}`);oa.VL=Ba.TextOrientation;sa||oa.c1(0<=oa.VL?1:3,!1)}U4e(oa){oa=this.w4a(oa.vx,oa.cell.Hj,oa.cell.aCa,oa.cell.Jia);return Object(Z.b)(oa)?0:null!=oa.value.horizontalAlignment?
oa.value.horizontalAlignment:0}Bzj(oa,Ba,sa){this.Ox||(this.Ox=new ca.a(ib.h(this.$).Da,this.$));this.Ox.TMb(oa,Ba,sa)}K9h(oa,Ba){const sa=new xb.a;if(oa.cell.formulaBarText&&oa.cell.formulaBarText.startsWith("'"))sa.Text=oa.cell.formulaBarText;else{let qb=oa.cellValue;qb&&4!==oa.cell.ZE||(qb=oa.text);sa.Text=qb}this.KTa(Ba,sa,!1,S.a.ssd(this.$));return!0}sVd(oa,Ba){return this.xb&&!!oa&&!!Ba}static p8g(oa,Ba,sa,qb){qb&&Ba.setCell(!0);0===sa&&oa.Da.QV()}static expandRange(oa,Ba){Ba=Ba.clone();Ba.height<
oa.height&&(Ba.bottom=Ba.top+oa.height-1);Ba.width<oa.width&&(Ba.right=Ba.left+oa.width-1);return Ba}static Uki(oa){switch(oa){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}}static Nxj(oa,Ba){Ba=Ba.Font;var sa=0!==(Ba.ValidMembers&16);const qb=0!==(Ba.ValidMembers&16),Jb=0!==(Ba.ValidMembers&16);oa.bold=0!==(Ba.ValidMembers&4);oa.italic=0!==(Ba.ValidMembers&8);sa&&(oa.underline=sa);qb&&(oa.doubleUnderline=qb);Jb&&(oa.fontStrikethrough=
Jb);oa.fontName=Ba.FontName;oa.fontSize=Ba.FontSize;sa=G.a.yp(oa.color,oa.backgroundColor);ua.a.compare(sa,ua.a.red)&&(Ya.a.J5(oa.text)||Ya.a.Mbf(oa.text))||(Ba=ua.a.IH(Ba.FontColor),oa.color=Qb.e(G.a.BG(Ba)))}}Na.gIh=36;Object(t.a)(Na,"FormatCellsAction",null,[635,3]);class kb extends e.a{constructor(oa){super();this.$=oa;this.Fb()}create(){this.ob(new Na(this.$))}static la(oa){oa.da.Ga(18,new kb(oa))}}Object(t.a)(kb,"FormatCellsActionFactory",e.a,[]);a.d(E,"a",function(){return lb});const lb=()=>
{b.a.Fa(kb.la)}},1165:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(1),f=a(15),d=a(197),h=a(78),m=a(37),l=a(47),w=a(46),n=a(642),x=a(28),r=a(118);class u{constructor(){this.startTime=x.a.Sa.zb;this.Qx=new n.a}H3e(){return r.a(x.a.Sa,this.startTime)}}Object(t.a)(u,"OngoingAction",null,[]);class v extends h.a{constructor(lb,oa,Ba,sa,qb=null){super();this.nQa=this.opb=null;this.m1c=0;this.Orc=null;this.RXi=()=>{const Jb=this.nQa.H3e();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.bma}>.OnRunningLong: Operation running for more than ${Jb}ms`);
this.Orc=l.a.instance.create(this.W6,Math.max(this.vAe-Jb,0),w.a.Loe)};this.W6=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.bma}>.OnTimeout: Operation running for more than ${this.nQa.H3e()}ms, timing out. Has pending actions: ${this.o7a}`);this.m1c++;this.m1c>this.uAe&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.bma}>.OnTimeout: passed the allowed bypassed count`);this.nQa.Qx.cancel();this.oZe()};this.LR=()=>{this.o7a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.bma}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.cNa}, AggregatedActionParams not null: ${this.o7a}`);
this.Qpd()};this.jHg=lb;this.kHg=oa;this.documentVisibilityObserver=Ba;this.bma=sa;this.TL=qb;Ba&&this.documentVisibilityObserver.NGa(this.LR);this.l1c=!!Ba&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.uAe=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);oa=e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.vAe=lb.Vfd(oa);lb=
e.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.t_g=Math.max(this.vAe-oa,0)+lb}get cNa(){return!!this.nQa}get o7a(){return!!this.opb}oNf(lb){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.bma}>.PerformThrottledAction: Start. IsActionOngoing: ${this.cNa}, AggregatedActionParams not null: ${this.o7a}`);this.opb=this.kHg.jZc(lb,this.opb);this.Qpd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.JRa(this.LR);
this.bCe();super.dispose()}i6f(lb){this.l1c?(this.nQa=lb?new u:null,lb?this.startTimer():this.bCe()):this.nQa=lb?{}:null}oZe(lb=null){this.l1c&&lb&&lb.JK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.bma}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.bma}>.FinishedCallback: Start. IsActionOngoing: ${this.cNa}, AggregatedActionParams not null: ${this.o7a}`),this.i6f(!1),this.Qpd())}Qpd(){if(!this.cOb()){var lb=this.opb;this.opb=null;
this.i6f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.bma}>.InternalPerformAction: Calling PerformAction.`);var oa=this.l1c?this.nQa.Qx.token:d.a.none;m.TaskExtensions.za(this.jHg.pHd(lb),()=>{this.oZe(oa)},oa,0,this.TL)}}cOb(){return!this.o7a||this.cNa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.ki?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.bma}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}bCe(){this.Orc&&this.Orc.cancel()}startTimer(){this.m1c<=
this.uAe&&(this.Orc=l.a.instance.create(this.RXi,this.t_g,w.a.Loe))}}Object(t.a)(v,"ActionAggregator",h.a,[680,3]);var B=a(27),z=a(85),A=a(108),y=a(14),D=a(45),I=a(38),M=a(19),T=a(5),S=a(128),H=a(13),C=a(21),G=a(55);class J extends I.a{constructor(lb){super();this.Pw=this.firstElement=null;this.BNa=!1;this.dt=null;this.nDj=B.a.Jf;this.JFf=oa=>{const Ba=oa.Ca.keyCode;return Ba===z.a.Kh?this.BQi():Ba===z.a.$y&&oa.Ca.shiftKey?this.tEh(this.firstElement):!1};this.gLf=oa=>{if(!this.BNa||oa.Ca.keyCode!==
z.a.JG)return!1;J.wdf();G.Task.delay(1).np(()=>{this.Pw.focus();return!0},0,this.ka);return!0};this.o0i=()=>{document.activeElement&&document.activeElement.id===this.Pw.id||(J.wdf(),G.Task.delay(1).np(()=>{this.Pw.focus();return!0},0,this.ka))};this.LDf=()=>{this.ngg(this.Pw)};this.IFf=oa=>{oa.stopPropagation();oa.preventDefault();this.BNa&&(this.BNa=!1)};this.$=lb;(lb=this.$.ea.dc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${lb.Bta}; InWebPart = '${lb.inWebPart?"Classic":
"Non Classic"}', InEmbedView = '${lb.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);lb&&(lb.inWebPart||lb.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${lb.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${lb.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.pdh(),this.peh(),A.KeyInputManager.instance.sa(y.a.Pb,this.$.domElement,this.gLf));
this.$.da.Ga(238,this)}CNg(lb){this.addHandler("KBIS",lb)}cjj(lb){this.removeHandler("KBIS",lb)}dispose(){this.firstElement&&D.a.removeHandler(this.firstElement,y.a.focus,this.LDf);this.dt&&this.dt.detach("focus");this.Pw&&(D.a.removeHandler(this.Pw,y.a.focus,this.IFf),D.a.removeHandler(this.Pw,y.a.blur,J.onBlur),A.KeyInputManager.instance.Ba(y.a.Pb,this.Pw,this.JFf));A.KeyInputManager.instance.Ba(y.a.Pb,this.$.domElement,this.gLf);this.dt=this.Pw=this.firstElement=this.$=null;super.dispose()}pdh(){this.nDj?
(this.firstElement=document.documentElement,this.dt=S.a.instance.vH(document.parentWindow),this.dt.la("focus",this.o0i)):(this.firstElement=J.$Ie(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),D.a.addHandler(this.firstElement,y.a.focus,this.LDf))}peh(){this.Pw=J.$Ie();this.Pw.id=T.a.lQe;this.Pw.setAttribute(T.a.qv,H.a.instance.ga(862));document.body.appendChild(this.Pw);D.a.addHandler(this.Pw,y.a.focus,this.IFf);D.a.addHandler(this.Pw,y.a.blur,J.onBlur);A.KeyInputManager.instance.sa(y.a.Pb,
this.Pw,this.JFf)}tEh(lb){this.ngg(lb);return!1}BQi(){this.BNa=!0;C.h(this.$).focus();C.h(this.$).ha.zaf();this.raiseEvent("KBIS");return!0}ngg(lb){this.BNa?this.BNa=!1:(this.BNa=!0,lb&&lb.focus())}static $Ie(){const lb=document.createElement("div");lb.tabIndex=0;return lb}static wdf(){document.body.classList.add(M.a.hTe)}static onBlur(){document.body.classList.remove(M.a.hTe)}}Object(t.a)(J,"EmbedViewFocusControl",I.a,[679,3]);var L=a(4),P=a(1083),aa=a(61),U=a(523),K=a(24),Y=a(40),na=a(374),W=a(188),
X=a(284),Aa=a(116),Q=a(29),fa=a(283),Ca=a(282),ia=a(60);const Ra=(lb,oa,Ba,sa,qb,Jb,Yb,jb,ab,vb,Da=null)=>{Da=lb.Oa(1,Da);Da.selectedRange=oa;Da.richValueKeyPath=Ba;Da.singleColumn=sa;Da.searchForRange=qb;Da.calculateMajorityDataType=Jb;return ia.g(lb,"GetRichValueFieldListContextList",Da,Yb,jb,ab,vb,4)};var Ya=a(33);class Ga extends I.a{constructor(lb,oa){super();this.vLb=this.zhd=this.qxb=this.KP=null;this.rWb=!1;this.Z8d=null;this.eKd=!1;this.fSi=(Ba,sa,qb)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
qb);this.vLb&&this.vLb.stop();this.KP=null;this.raiseEvent(P.h)};this.gSi=Ba=>{fa.a(Ba)||(this.vLb&&this.vLb.stop(),this.rWb=!1,(this.KP=Ba.Result)&&0<this.KP.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.KP.length} rich value field list context for autocomplete`),this.CXa=!0,this.buc())};this.CXa=!1;this.jb=lb;this.$Ub=-1;this.tableManager=oa;this.eKd=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ya.a.SV(lb)}I0b(lb){this.addHandler(P.a,
lb)}Cvc(lb){this.removeHandler(P.a,lb)}bNg(lb){this.addHandler(P.h,lb)}Kij(lb){this.removeHandler(P.h,lb)}get O7a(){return this.CXa}get kAi(){return this.rWb}get b0e(){return this.$Ub}get f8c(){return this.Z8d}get $(){return this.jb}get al(){return this.KP}get EUh(){return!!this.qxb}dispose(){this.jb=null;this.wdb();super.dispose()}e5i(){var lb=Array(6);var oa={};oa.Name=P.f;lb[0]=oa;oa={};oa.Name=P.c;lb[1]=oa;oa={};oa.Name=P.d;lb[2]=oa;oa={};oa.Name=P.g;lb[3]=oa;oa={};oa.Name=P.e;lb[4]=oa;oa={};
oa.Name=P.b;lb[5]=oa;oa={ColumnName:"",ColumnIndex:-1};oa.FieldInfoDataList=lb;lb=[];lb[0]=oa;this.JSd(lb)}f_(lb,oa,Ba,sa=null){if(lb){this.d2c();this.U3b();var qb=null,Jb=!1;if(!sa&&({pbb:Jb,al:qb}=this.OUj(lb,oa,Ba)).returnValue)if(this.eKd||this.JSd(qb),this.rWb=!0,this.KP=qb,this.eKd){if(!Jb){this.CXa=!0;this.buc();return}}else if(this.KP&&0<this.KP.length&&(this.CXa=!0,this.buc()),!Jb)return;this.bkg(lb,sa,oa,Ba,!1)}}bkg(lb,oa,Ba,sa,qb){if(this.$.ea.Zb){this.$.Kb&&(this.vLb=this.$.Kb.Cc("WebServiceCall",
"GetRichValueFieldInfoListContext"));this.qxb=null;var Jb=this.$.pa.xa.Wb();this.qxb=Ra(this.$.pa.xa,lb,oa,Ba,sa,qb,this.gSi,this.fSi,null,Jb)}else this.KP=null}wdb(){this.KP=null;this.CXa=!1;this.d2c();this.U3b();this.qxb=null;this.$Ub=-1}d2c(){Ga.xrb(this.qxb)}U3b(){Ga.xrb(this.zhd)}buc(){this.raiseEvent(P.a)}Bn(lb){lb=Y.D(lb);--lb.left;--lb.right;return this.tableManager.Bn(lb)}nLa(lb){lb.FirstColumn=lb.FirstColumn;lb.LastColumn=lb.LastColumn;lb.FirstRow=lb.FirstRow;lb.LastRow=lb.LastRow;this.U3b();
this.zhd=null;return na.a(this.$.userOperationManager,(oa,Ba,sa)=>X.i(this.$.pa.xa,lb,Ca.b(oa,qb=>{this.pSi(qb)}),Ca.a(Ba,Ba,qb=>{this.oSi(qb)}),sa,null),oa=>new W.a(264,0,oa,80),null)}oSi(lb){lb=Aa.a.Oe(lb.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${Q.a.sc(lb)}`)}pSi(lb){if(fa.a(lb))-315732528!==lb.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${Q.a.sc(lb.Errors)}`);
else if(lb&&lb.Result){lb=lb.Result;var oa=lb.HasHeaderRow;oa=new U.AutofilterRange(lb.TableRange.FirstRow+(oa?1:0)+1,lb.TableRange.FirstColumn+1,lb.TableRange.LastRow+1,lb.TableRange.LastColumn+1,null,null,null,0,oa);this.$Ub=lb.TableRange.FirstColumn;(lb=this.pQf(!1,!0,oa))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.JSd(lb)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}OUj(lb,
oa,Ba){let sa,qb;qb=null;sa=!1;if(lb.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,pbb:sa,nLa:!1,al:qb};let Jb;this.$Ub=-1;if(Ba){Jb=this.Bn(lb);if(!Jb||!Jb.yba)return{returnValue:!1,pbb:sa,nLa:!1,al:qb};var Yb=C.h(this.$).Ab.X7e(Jb);this.Z8d=Jb;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Yb&&0<Yb.count)return--lb.FirstColumn,--lb.LastColumn,this.zhd=this.nLa(lb),{returnValue:!0,pbb:sa,nLa:!0,al:qb};Jb.top+=1;
Jb.right=Y.D(lb).right-1}else Jb=new U.AutofilterRange(lb.FirstRow+1,lb.FirstColumn+1,lb.LastRow+1,lb.LastColumn+1,null,null,null,0,!1);if(Jb.top>Jb.bottom||Jb.left>Jb.right)return{returnValue:!0,pbb:sa,nLa:!1,al:qb};lb=C.h(this.$);var jb=lb.ib.width,ab=lb.ib.height;Yb=lb.view.visibleArea;jb=new aa.a(Yb.x-jb,Yb.y-ab,Yb.width+jb,Yb.height+ab);ab=lb.fg(Jb);if(!Yb||!ab||!lb.ikc(Jb))return{returnValue:!1,pbb:sa,nLa:!1,al:qb};jb.contains(ab)||(sa=!0);qb=this.pQf(oa,Ba,Jb);return{returnValue:!0,pbb:sa,
nLa:!1,al:qb}}JSd(lb){lb&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${lb.length} rich value field contexts from block cache`);this.rWb=!0;(this.KP=lb)&&0<this.KP.length&&(this.CXa=!0,this.buc())}pQf(lb,oa,Ba){let sa;sa=null;const qb=Ba.clone();if(oa)for(let Jb=Ba.right,Yb=0;Jb>=Ba.left;--Jb){if(qb.left=Jb,qb.right=Jb,oa=this.W3e(qb,!0,Ba.left)){sa||(sa=[]);sa[Yb]=oa;if(lb)break;++Yb}}else if(lb=this.W3e(qb,!1))sa=[],sa[0]=lb;return sa}W3e(lb,oa,Ba=0){var sa=null;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var qb=
C.h(this.$).Ab.T1h(lb);if(qb&&0<qb.count){var Jb=Array(qb.count);sa=0;for(var Yb of qb.values)qb={},qb.Name=Yb,Jb[sa]=qb,++sa;Yb="";qb=-1;0<lb.top&&oa&&(lb=new K.Range(lb.top-1,lb.left,lb.top-1,lb.left,!1,!1),null!=C.h(this.$).Ub(lb)&&null!=C.h(this.$).Ub(lb).originalText&&(Yb=C.h(this.$).Ub(lb).originalText),qb=lb.left-Ba);sa={};sa.ColumnName=Yb;sa.ColumnIndex=qb;sa.FieldInfoDataList=Jb}}else if((Yb=C.h(this.$).Ab.X7e(lb))&&0<Yb.count){Jb=Array(Yb.count);sa=0;for(qb of Yb)Yb={},Yb.Name=qb,Jb[sa]=
Yb,++sa;Yb="";qb=-1;0<lb.top&&oa&&(lb=new K.Range(lb.top-1,lb.left,lb.top-1,lb.left,!1,!1),Yb=C.h(this.$).Ub(lb).originalText,qb=lb.left-Ba);sa={};sa.ColumnName=Yb;sa.ColumnIndex=qb;sa.FieldInfoDataList=Jb}return sa}static xrb(lb){lb&&L.AFrameworkApplication.zd.cu(lb.tt)}}Object(t.a)(Ga,"FieldInfoManager",I.a,[409,3]);class da extends Ga{constructor(lb,oa,Ba,sa){super(lb,oa);this.n3a=null;this.FDf=()=>{this.Cvc(this.FDf);if(this.al&&this.al.length&&this.contextMenuManager){var qb=this.contextMenuManager.Ngd("autoFilterRichFieldList"),
Jb=window.document.getElementById(this.n3a);qb.i1(null,Jb,this,null,!0)}};this.ttg=Ba;this.contextMenuManager=sa}get mH(){return this.ttg}OUh(lb,oa){this.n3a=oa;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${lb.FirstRow}, ${lb.FirstColumn}, ${lb.LastRow}, ${lb.LastColumn})`);this.bkg(lb,null,!0,!1,!0)}}Object(t.a)(da,"FilterInfoManager",Ga,[413,409,3]);var Z=a(840),ha=a(1095),Wa=a(30),ca=
a(89),ja=a(8);class ua{}ua.yyh="ewa-sharedUi-launchButton";ua.Byh="ewa-sharedUi-launchButtonWithText";ua.zyh="ewa-sharedUi-launchButtonClick";ua.Cyh="ewa-sharedUi-launchButtonWithTextClick";ua.Ayh="ewa-sharedUi-launchButtonText";Object(t.a)(ua,"CssClassNames",null,[]);var Za=a(66);a(518);var Pa=a(240),ka=a(224);I=a(238);var ra=a(287),ba=a(71),Ua=a(11),Ka=a(252),Oa=a(34);class ib extends I.a{constructor(lb,oa,Ba,sa,qb,Jb,Yb,jb,ab){super(document.createElement("div"));this.jqf=null;this.UWd=!1;this.htmlSanitizationHelper=
this.MPb=this.TTa=null;this.oO=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.nO=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.vJj=()=>{this.Woe()};this.fd=vb=>{this.raiseEvent(this.vIb,vb);this.uIb();return!0};this.hQi=vb=>{100<r.a(x.a.Sa,this.jqf)&&this.Uld(new Sys.UI.Point(Math.round(vb.clientX),Math.round(vb.clientY)))};this.jO=vb=>{ba.g(vb.Ca,!1);return!1};this.JZ=this.Be.PIa();this.set_visible(!1);this.Lkc=qb;this.vIb=Jb;this.Joc=lb;this.Y4b=oa;this.htmlSanitizationHelper=ab;this.Lkc&&
(this.TTa=l.a.instance.create(this.vJj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));lb&&this.domElement.classList.add(lb);this.MHa=document.createElement("div");this.domElement.appendChild(this.MHa);Ba&&this.MHa.classList.add(Ba);this.H1d(sa);Yb&&(this.MPb=document.createElement("div"),this.domElement.appendChild(this.MPb),this.MPb.classList.add(jb),this.MPb.innerText=Yb,this.domElement.style.padding="3px",Pa.a.instance.sa(y.a.pointerDown,this.domElement,this.jO));this.x0a=new ra.a(this.domElement,
7);ka.a.instance.sa(y.a.click,this.domElement,this.fd);e.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Pa.a.instance.sa(y.a.pointerDown,this.domElement,this.jO);lb=vb=>{ba.g(vb)};this.Gc.la("mouseup",lb);this.Gc.la("click",lb);this.Gc.la("dblclick",lb)}b3(lb){this.addHandler(this.vIb,lb)}Uda(lb){this.get_events().removeHandler(this.vIb,lb)}UNg(lb){this.addHandler("OnObjectButtonMouseOver",lb)}tjj(lb){this.get_events().removeHandler("OnObjectButtonMouseOver",
lb)}TNg(lb){this.addHandler("OnObjectButtonMouseOut",lb)}sjj(lb){this.get_events().removeHandler("OnObjectButtonMouseOut",lb)}H1d(lb){lb&&(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?this.htmlSanitizationHelper.ni(this.MHa,lb):this.MHa.innerHTML=lb)}jYj(lb,oa,Ba){e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7144167_OnObjectButton")?
this.htmlSanitizationHelper.RJ(this.MHa):this.MHa.innerHTML="";lb?lb.Jba(oa,16,16,this.MHa,16,16,void 0,Ba):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}kYj(lb,oa){lb&&(this.MPb.innerText=lb);this.domElement.title=oa}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.iD(),ca.a.rc([this.JZ,this.x0a]),ka.a.instance.Ba(y.a.click,this.domElement,this.fd),Pa.a.instance.Ba(y.a.pointerDown,this.domElement,this.jO),this.TTa&&this.TTa.dispose(),
super.dispose())}udb(){this.Y4b&&this.domElement.classList.remove(this.Y4b);this.Joc&&this.domElement.classList.add(this.Joc)}uIb(){this.Joc&&this.domElement.classList.remove(this.Joc);this.Y4b&&this.domElement.classList.add(this.Y4b);this.A3a()}A3a(){this.Lkc&&(this.TTa.cancel(),this.tcg(),this.setOpacity(1));this.set_visible(!0)}Tp(lb,oa,Ba,sa,qb=!1){lb=Oa.a(sa).zi(lb);oa=Oa.a(sa).zi(oa);Oa.a(sa).pzc(this.domElement);this.domElement.style.top=Ua.HelperMethods.uc(oa);this.domElement.style.left=this.domElement.style.right=
"";oa=lb;qb&&(oa=lb-this.domElement.offsetWidth);Ka.c(this.domElement.style,Ba,Ua.HelperMethods.uc(oa));this.set_visible(!0);this.setOpacity(1);this.Lkc&&(this.UWd=!1,this.oMj(),this.TTa.vq())}hide(){this.udb();this.set_visible(!1);this.Lkc&&(this.tcg(),this.TTa.cancel())}$9b(){this.Gc.la("mouseover",this.oO,!0);this.Gc.la("mouseout",this.nO,!0)}oMj(){this.JZ.Oi("mousemove")||this.JZ.la("mousemove",this.hQi)}tcg(){this.JZ.Oi("mousemove")&&this.JZ.detach("mousemove")}Uld(lb){if(this.domElement.parentNode){var oa=
Sys.UI.DomElement.getBounds(this.domElement);const Ba=new Sys.UI.Point(Math.round(oa.x+oa.width),Math.round(oa.y+oa.height));oa=Math.abs(Ba.x-lb.x);lb=Math.abs(Ba.y-lb.y);lb=oa>lb?oa:lb;this.UWd?this.setOpacity(ib.v0g(lb)):100>=lb&&this.Woe()}}Woe(){this.UWd=!0;this.TTa.cancel()}setOpacity(lb){B.a.setOpacity(this.domElement,lb);this.jqf=x.a.Sa.zb}static v0g(lb){return 100>=lb?1:250<=lb?0:.01*(100-(lb-100)/150*100)}}Object(t.a)(ib,"OnObjectButton",I.a,[690,75,3]);var La=a(793);const db=ua.Ayh;class Ab extends h.a{constructor(lb,
oa,Ba,sa,qb,Jb,Yb,jb,ab=""){super();this.Xka=null;this.aef=!1;this.htmlSanitizationHelper=this.goc=this.hoc=null;this.buttons={};this.TRe={};this.$=lb;this.svgIconProvider=oa;this.COi=Ba;this.Kgc=sa;this.Jgc=qb;this.altText=Jb;this.vIb=Yb;this.htmlSanitizationHelper=jb;this.buttonText=ab}get Cz(){return Oa.a(this.$).dHa(ja.a.iWi)}get v4b(){return ja.a.hWi}get buttonWidth(){return Oa.a(this.$).dHa(ja.a.jWi)}dispose(){this.soh();this.$=null;super.dispose()}getButton(lb,oa=!0){return this.Mva(lb,oa)}Mva(lb,
oa=!0){const Ba=lb.toString();Ba in this.buttons||this.reh(lb,oa);return this.buttons[Ba]}Tp(lb,oa,Ba,sa,qb=!0,Jb=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&Za.i(this.$.na)){var Yb=C.h(this.$).uS.domElement;const jb=lb+this.buttonWidth-Yb.scrollWidth;Yb=oa+this.buttonWidth-Yb.scrollHeight;lb=0<jb?lb-jb:lb;oa=0<Yb?oa-Yb:oa}this.Mva(sa,qb).Tp(lb,oa,Ba,this.$,Jb)}hide(){const lb=this.buttons;for(let oa in lb)lb[oa].hide()}$9b(lb,oa){!this.aef&&(oa=this.buttons[oa.toString()])&&(this.hoc=(Ba,
sa)=>{lb(sa,!0)},oa.UNg(this.hoc),this.goc=(Ba,sa)=>{lb(sa,!1)},oa.TNg(this.goc),this.aef=!0,oa.$9b())}reh(lb,oa){this.Xka=String.format(this.Kgc===M.a.S$b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Wa.a.rg(this.Kgc),Wa.a.rg(this.Jgc),"{0}");var Ba=String.format(this.Xka,Wa.a.rg(this.altText));oa=new ib(""===this.buttonText?ua.yyh:ua.Byh,""===this.buttonText?ua.zyh:ua.Cyh,M.a.fs,
Ba,oa,this.vIb,this.buttonText,db,this.htmlSanitizationHelper);Ba=(sa,qb)=>{this.COi(qb,lb)};oa.b3(Ba);this.buttons[lb.toString()]=oa;this.TRe[lb.toString()]=Ba;Ba=C.h(this.$).Df(lb);Ba.domElement.insertBefore(oa.domElement,Ba.domElement.firstChild)}soh(){for(const lb of La.a(this.buttons)){const oa=this.buttons[lb];oa.Uda(this.TRe[lb]);ca.a.Ia(oa);delete this.buttons[lb];this.hoc&&oa.tjj(this.hoc);this.goc&&oa.sjj(this.goc)}}domElement(lb){return this.Mva(lb).domElement}A3a(lb){this.Mva(lb).A3a()}Zjg(lb,
oa){this.Kgc=lb;this.Jgc=oa}mRb(lb,oa,Ba=!0){this.Xka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Wa.a.rg(this.Kgc),Wa.a.rg(this.Jgc),"{0}");lb=String.format(this.Xka,Wa.a.rg(lb));this.Mva(oa,Ba).H1d(lb)}qVa(lb,oa,Ba){this.Mva(Ba,!1).kYj(lb,oa)}Xjg(){this.Xka=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Wa.a.rg(this.Jgc),"{1}");const lb=String.format(this.Xka,void 0,
Wa.a.rg(void 0));this.Mva(void 0,!1).H1d(lb)}Yjg(lb,oa,Ba){this.Mva(Ba,!1).jYj(this.svgIconProvider,lb,oa)}}Object(t.a)(Ab,"OnObjectLaunchButton",h.a,[678,3]);h=a(95);class Mb extends h.a{constructor(lb,oa){super(lb);this.$Db=null;this.coh=()=>{this.display()};this.vei=Math.max(1,oa)}dispose(){ca.a.Ia(this.$Db);this.$Db=null;super.dispose()}iUa(){ca.a.Ia(this.$Db);this.$Db=l.a.instance.create(this.coh,this.vei,w.a.oAi)}oUa(){ca.a.Ia(this.$Db);this.hide()}}Object(t.a)(Mb,"LoadingIndicatorBehavior",
h.a,[662,3]);class pb extends Mb{constructor(lb,oa,Ba,sa){super(lb,oa);this.ZDb=null;this.Svg=Ba;this.Gbi=sa;this.DJg()}dispose(){this.ZDb=null;super.dispose()}display(){this.Svg(this.ZDb)}hide(){this.Gbi(this.ZDb)}DJg(){this.ZDb=document.createElement("div");this.domElement.appendChild(this.ZDb)}}Object(t.a)(pb,"ShimmerLoadingIndicatorBehavior",Mb,[]);var Qb=a(69),xb=a(52),pa=a(12);class Ma extends Mb{constructor(lb,oa,Ba,sa=null,qb=null,Jb=0){super(lb,oa);this.Uwa=this.QOa=null;this.Uwa=Ba;this.Pgc=
sa||xb.a.current.io(104);this.Yrf=Jb;this.k8c=qb;this.CJg()}dispose(){this.QOa=null;super.dispose()}display(){pa.DOMElementExtensions.setVisible(this.QOa,!0)}hide(){pa.DOMElementExtensions.setVisible(this.QOa,!1)}CJg(){this.QOa=document.createElement("div");this.QOa.classList.add(Qb.a.lxh);const lb=document.createElement("div");lb.classList.add(Qb.a.mxh);this.k8c&&""!=this.k8c&&lb.classList.add(this.k8c);var oa=0===this.Yrf?"":H.a.instance.ga(this.Yrf);const Ba=String.format('<div class="'+Qb.a.nxh+
'">{0}</div>',oa);this.Pgc?(oa=`<img src="${this.Pgc}" alt="${oa}" title="${oa}"/>`,this.Uwa?this.Uwa.ni(lb,oa+Ba):lb.innerHTML=oa+Ba):this.Uwa?this.Uwa.ni(lb,Ba):lb.innerHTML=Ba;this.QOa.appendChild(lb);this.domElement.appendChild(this.QOa)}}Object(t.a)(Ma,"SpinnerLoadingIndicatorBehavior",Mb,[]);class ya{constructor(lb){this.Uwa=lb}j7c(lb,oa,Ba){return new Z.a(lb,oa,Ba)}V6b(lb,oa,Ba,sa,qb,Jb,Yb,jb,ab,vb){return new ha.a(lb,oa,Ba,sa,qb,Jb,Yb,jb,ab,vb)}stb(lb,oa,Ba,sa,qb=0){return new Ma(lb,oa,this.Uwa,
Ba,sa,qb)}ejd(lb){return lb.da.Aa(238)||new J(lb)}Y6b(lb,oa,Ba,sa,qb,Jb,Yb,jb=""){return new Ab(lb,oa,Ba,sa,qb,Jb,Yb,this.Uwa,jb)}M6c(lb,oa){return new Ga(lb,oa)}kdh(lb,oa,Ba,sa){return new da(lb,oa,Ba,sa)}r6c(lb,oa,Ba,sa){return new v(lb,oa,Ba,sa)}}Object(t.a)(ya,"SharedUIControlsFactory",null,[625]);var Ea=a(48);class Na extends b.a{constructor(lb){super();this.$=lb;this.Fb()}create(){if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&e.EwaSettings.isChangeGateEnabled("OfficeVSO:7134912_ReduceInnerHTMLUsageSpinnerLoading")){const lb=
Ea.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya);m.TaskExtensions.za(lb,()=>{e.EwaSettings.ll()?this.ob(this.$.da.Aa(12)||new ya(lb.result)):this.ob(new ya(lb.result))},this.ka,3)}else e.EwaSettings.ll()?this.ob(this.$.da.Aa(12)||new ya(null)):this.ob(new ya(null))}static la(lb){lb.da.Ga(477,new Na(lb))}}Object(t.a)(Na,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(E,"a",function(){return kb});const kb=()=>{c.a.Fa(Na.la)}},1169:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(48),f=a(37),
d=a(1),h=a(814);class m extends b.a{constructor(Da){super();this.$=Da;this.Fb()}create(){const Da=e.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya),Fa=e.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Da,Fa],this.ka),()=>{this.ob(this.$.da.Aa(296)||this.$.da.Ga(296,new h.BorderFormatManager(this.$,Da.result,Fa.result)))},this.ka,3)}static la(Da){d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&Da.da.Ga(468,
new m(Da))}}Object(t.a)(m,"BorderFormatManagerFactory",b.a,[]);var l=a(695),w=a(15),n=a(264),x=a(171),r=a(827),u=a(27),v=a(39),B=a(30),z=a(96),A=a(261),y=a(357),D=a(354),I=a(98),M=a(187),T=a(8),S;(function(Da){Da[Da.insert=1]="insert";Da[Da.delete=2]="delete";Da[Da.rows=4]="rows";Da[Da.columns=8]="columns";Da[Da.cellsShiftHorizontal=16]="cellsShiftHorizontal";Da[Da.cellsShiftVertical=32]="cellsShiftVertical";Da[Da.insertRows=5]="insertRows";Da[Da.insertColumns=9]="insertColumns";Da[Da.insertCellsShiftRight=
17]="insertCellsShiftRight";Da[Da.insertCellsShiftDown=33]="insertCellsShiftDown";Da[Da.deleteRows=6]="deleteRows";Da[Da.deleteColumns=10]="deleteColumns";Da[Da.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";Da[Da.deleteCellsShiftUp=34]="deleteCellsShiftUp";Da[Da.insertRowsBelow=37]="insertRowsBelow"})(S||(S={}));Object(t.b)("InsertDeleteCellFlags",S);var H=a(5),C=a(425),G=a(66),J=a(76);class L{constructor(Da){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=Da}}Object(t.a)(L,
"MacroRecorderRangeInsertedOrDeletedPayload",null,[145]);var P=a(1081),aa=a(40),U=a(374),K=a(188),Y=a(60),na=a(284),W=a(138),X=a(461),Aa=a(113),Q=a(52),fa=a(199),Ca=a(92),ia=a(35),Ra=a(29),Ya=a(283),Ga=a(258),da=a(11),Z=a(184),ha=a(22),Wa=a(282);class ca{constructor(Da,Fa,nb,Ta,V=0){this.$wg=Da;this.axg=Fa;this.LEg=nb;this.hZb=Ta;this.DJh=V}get Lja(){return this.$wg}get formattedText(){return this.axg}get style(){return this.LEg}get size(){return this.hZb}get a_(){return this.DJh}static cZg(Da,Fa){return new ca(Da,
Fa,null,null,null)}static e1c(Da,Fa){return new ca(Da,null,Fa,null,null)}static dZg(Da,Fa){return new ca(Da,null,null,Fa,null)}static bZg(Da,Fa,nb){return new ca(Da,null,Fa,null,nb)}}Object(t.a)(ca,"CachedPreviewCellGroup",null,[]);var ja=a(83);b=a(285);var ua=a(100),Za=a(13);class Pa extends b.a{constructor(Da,Fa,nb){super(Da);this.Ql=null;this.A9c=0;this.qii=(Ta,V)=>{if(0===Ta)w.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Ta=
{};var va="",wb=1035996630;switch(V.selectedKey){case 0:va=1896159024===this.Mr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:va=1896159024===this.Mr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.Mr?(va="InsertRows",wb=-1113896058):(va="DeleteRows",wb=1554436520);break;case 3:1896159024===this.Mr?(va="InsertColumns",wb=1415868706):(va="DeleteColumns",wb=674605324)}w.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${va}`);
V=new Ca.a(wb,1,2,8,null);Ta[J.a.Kc]=va;this.$.Ka.Lb(V,Ta)}};this.Mr=Fa;this.selectedRanges=nb;this.isRtl=Object(ja.a)(ua.a,this.$.va.na).displayRtl}get pc(){return"InsertDeleteCellsDialog"}hg(){1896159024===this.Mr?(this.Ql=Za.a.instance.ga(23),this.A9c=0):(this.Ql=Za.a.instance.ga(22),this.A9c=1);const Da=this.selectedRanges[0].P_&&!this.selectedRanges[0].V5?0:1;this.Tb=1;this.initializeAndShow(this.Ql,this.qii,{[Pa.yu]:this.pc,["dialogToDisplay"]:this.A9c,["defaultSelectedKey"]:Da,["isRtl"]:this.isRtl})}}
Object(t.a)(Pa,"InsertDeleteCellsDialog",b.a,[]);const ka=(Da,Fa,nb,Ta,V,va,wb=null)=>{wb=Da.Oa(41,wb);wb.insertDeleteMultiRangeParameters=Fa;return Y.g(Da,"InsertDeleteCells",wb,nb,Ta,V,va,0)};class ra{constructor(Da,Fa,nb,Ta){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=Da;this.targetSheetRange=Fa;this.fillRangeType=nb;this.fillRangeDirection=Ta}}Object(t.a)(ra,"MacroRecorderRangeFilledPayload",null,[145]);var ba=a(7),Ua=a(24);
class Ka{constructor(){this.kSa=this.GHa=this.FOa=this.WUa=0}}Object(t.a)(Ka,"RangeBorders",null,[]);class Oa{constructor(){this.scenario=0;this.OQ=null}}Object(t.a)(Oa,"ScenarioInfo",null,[]);var ib=a(912),La=a(21),db=a(263),Ab=a(208),Mb=a(79);class pb{constructor(Da,Fa){this.$=Da;this.qg=Fa;this.Ox=new ib.a(La.h(this.$).Da,this.$);this.MAb=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Esd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.wjc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.lkf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Pmi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.kof=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.hkc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.ABb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.xjc=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.mqi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Xmi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.gif=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.ikf=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.Eqi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.Wvi=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}Wmi(Da,Fa){return!(void 0===Fa||null===Fa)&&!!(Fa.scenario&16384)&&!this.Ymi(Da,Fa)&&this.$hf(Fa,Da)}P5e(){var Da=v.a.Ud(),Fa=La.h(this.$),nb=Fa.ha.ra.selectedRanges;let Ta=0;var V=
0,va=nb.length;const wb=new Oa;if(1<va)return wb.scenario=4,wb;if(this.ikf&&Fa.$j("MergeCell").Pjc(nb[0]))return wb.scenario=262144,wb;this.Esd&&La.h(this.$).rtl&&(Ta|=65536);if(!Fa.NK(nb[0]))if(this.MAb)Ta|=32;else return wb.scenario=32,wb;if(Fa=Fa.Da.$va(nb[0],this.$.activeItemName)){wb.z0c=Fa;for(var fc of Fa)if(V+=1,1<V){this.MAb?(Ta|=256,wb.scenario=Ta):wb.scenario=256;if(!this.ABb)return wb;break}}V=La.h(this.$).Da.Wja(nb[0]);if(!V)return wb.scenario=32768,wb;fc=V.length;nb=nb[0];Fa=nb.bottom-
nb.top+1;va=nb.right-nb.left+1;const Fc=new Ka;for(let Qa=0;Qa<fc;Qa++)if(this.H0h(V[Qa],nb,Fc),Ta=Ta|(void 0!==V[Qa].text&&null!==V[Qa].text&&""!==V[Qa].text?1:0)|(V[Qa].QF?2:0)|(V[Qa].Fwa?8:0)|(V[Qa].Oyb?16:0)|(V[Qa].pB?64:0)|(V[Qa].cR?128:0),void 0!==V[Qa].text&&null!==V[Qa].text&&""!==V[Qa].text||V[Qa].Fwa)if(void 0===wb.OQ||null===wb.OQ)wb.OQ=La.h(this.$).Ub(V[Qa].getRange());else{if(V[Qa].getRange().top<wb.OQ.range.top||V[Qa].getRange().top==wb.OQ.range.top&&V[Qa].getRange().left<wb.OQ.range.left)wb.OQ=
La.h(this.$).Ub(V[Qa].getRange());Ta|=16384}Fc.WUa===va&&(Ta|=512);Fc.GHa===va&&(Ta|=2048);Fc.FOa===Fa&&(Ta|=4096);Fc.kSa===Fa&&(Ta|=1024);if(0<Fc.WUa&&Fc.WUa<va||0<Fc.GHa&&Fc.GHa<va||0<Fc.FOa&&Fc.FOa<Fa||0<Fc.kSa&&Fc.kSa<Fa)Ta|=8192;!d.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||nb.right!==nb.maxColumns&&nb.bottom!==nb.maxRows||(Ta|=131072);Da=v.a.Ud()-Da;w.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${Da}`);wb.scenario=
Ta;return wb}Ewf(Da,Fa){const nb=Da.command;if(void 0===Fa||null===Fa)Fa=this.P5e();if(!this.$hf(Fa,nb))return!1;Da=La.h(this.$).ha.ra.selectedRanges;var Ta=La.h(this.$).Da.Wja(Da[0]);if(!Ta)return!1;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Ta.length&&!Ta[0].QF)return-167499203===nb?(Ta[0].c1(2,!0),!0):!1;Ta=La.h(this.$).ha.ra.Ds;const V=this.$.na.sheetName;let va=!0;switch(nb){case -167499203:2===(Fa.scenario&2)&&this.wjc?this.iig(Fa.scenario,Da,
nb):va=this.lHi(Fa,Da);break;case 1097660126:(Fa=this.Fwf(Fa,Da))&&0!=Fa.length||(va=!1);break;case 155820588:this.iig(Fa.scenario,Da,nb);break;default:return!1}La.h(this.$).Y4(Da,Ta,V,null,Da[0],null,null,0,"MergeCellCommandAction");return this.ABb?va:!0}$hf(Da,Fa){const nb=this.Hli(Da,Fa);if(!this.lkf)return nb;const Ta=La.h(this.$).ha.ra.selectedRanges[0].Hw(!1);w.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${Fa.toString()}; Scenario Number: ${Da.scenario}; IsCSEPossible result: ${nb}; Range: ${Ta}`);
return nb}Hli(Da,Fa){if(-255094134===Fa)return!1;var nb=Da.scenario;if(this.ikf&&262144===nb||this.Esd&&65536===(nb&65536))return!1;if(this.jof(Fa,Da))return nb=La.h(this.$).ha.ra.selectedRanges,0===nb.length?!1:this.cvi(Fa,Da,nb[0]);this.MAb&&32===(nb&32)&&(nb&=-33);if(256==(nb&256))if(this.Dqi(Da))nb&=-257;else return!1;return 32768===nb||4===nb||128===(nb&128)||!this.MAb&&32===nb?!1:-167499203!=Fa&&1097660126!==Fa||!this.wqd(Da)?void 0!==Da.OQ&&null!==Da.OQ&&Da.OQ.WX?!1:0===nb?!0:16384===(nb&16384)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(nb&1)&&8!==(nb&8)||!d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.xjc}Lni(Da){return 131072===(Da.scenario&131072)?!0:!1}Dqi(Da){if(!this.ABb)return!1;let Fa="Multi block",nb=!0;this.wqd(Da)&&(Fa+=" with border",nb=!1);this.Lni(Da)&&(nb=!1,Fa+=" with entire row or column selected",16384===(Da.scenario&16384)&&(Fa+=" and a data loss scenario"));
nb||w.ULS.sendTraceTag(523511383,0,50,`CSE for ${Fa}, is not enabled`);return nb}wqd(Da){return 16===(Da.scenario&16)||this.qmd(Da.scenario)||this.Kmd(Da.scenario)||this.Dmd(Da.scenario)||this.Mmd(Da.scenario)||8192===(Da.scenario&8192)?!0:!1}Ymi(Da,Fa){return this.Xmi?this.jof(Da,Fa):155820588===Da}jof(Da,Fa){return 155820588===Da||(-167499203===Da||1097660126===Da)&&2===(Fa.scenario&2)&&this.wjc?!0:!1}bvi(Da){return this.Mmd(Da.scenario)||this.Dmd(Da.scenario)||this.qmd(Da.scenario)||this.Kmd(Da.scenario)?
!0:!1}Fai(Da){Da=La.h(this.$).Da.Wja(Da);if(!Da||0===Da.length)return!1;for(let Fa=0;Fa<Da.length;Fa++)if(Da[Fa].QF&&Da[Fa].WX)return!0;return!1}cvi(Da,Fa,nb){if(1097660126===Da&&2===(Fa.scenario&2))return!1;if(this.Wvi){if(this.Fai(nb))return!1}else if(this.Pmi&&void 0!==Fa.OQ&&null!==Fa.OQ&&Fa.OQ.WX)return!1;this.MAb&&32===(Fa.scenario&32)&&(Fa.scenario&=-33);return 32768===Fa.scenario||4===Fa.scenario||256===(Fa.scenario&256)&&this.mqi||128===(Fa.scenario&128)?!1:2===(Fa.scenario&2)?this.bvi(Fa)?
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}H0h(Da,Fa,nb){const Ta=Da.getRange();if(Ta.top===Fa.top)if(Da.tMa)nb.WUa+=Ta.right-Ta.left+1;else{var V=this.Ox.SQ(Ta,0);if(V)for(const wb of V)wb.nMa&&(nb.WUa+=wb.getRange().right-wb.getRange().left+1)}if(Ta.left===Fa.left)if(Da.pMa)nb.FOa+=Ta.bottom-Ta.top+1;else if(V=this.Ox.SQ(Ta,2))for(var va of V)va.rMa&&
(nb.FOa+=va.getRange().bottom-va.getRange().top+1);if(Ta.bottom===Fa.bottom)if(Da.nMa)nb.GHa+=Ta.right-Ta.left+1;else if(va=this.Ox.SQ(Ta,1))for(const wb of va)wb.tMa&&(nb.GHa+=wb.getRange().right-wb.getRange().left+1);if(Ta.right===Fa.right)if(Da.rMa)nb.kSa+=Ta.bottom-Ta.top+1;else if(Da=this.Ox.SQ(Ta,3))for(const wb of Da)wb.pMa&&(nb.kSa+=wb.getRange().bottom-wb.getRange().top+1)}wgj(Da,Fa){for(let nb of Fa.z0c){Fa=Da.He(nb.nf);Fa=La.h(this.$).Da.Wja(Fa);const Ta=Fa.length;for(let V=1;V<Ta;V++){const va=
La.h(this.$).Ub(Fa[V].getRange());this.xjc?va.cell.deleteCellFromModel():(va.Qrb(),va.clearFormat(),va.cell.xgj());va.dKb(!0)}}}G0j(Da,Fa){Da.backgroundColor=Fa.backgroundColor;Da.color=Fa.color}upg(Da,Fa){return{SpansBlocks:!0,OriginRow:Da,OriginColumn:Fa,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}lIg(Da,Fa,nb,Ta,V){nb=Da.He(nb.nf);if(!nb)return w.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),
null;var va=new Ua.Range(Da.top,Da.left,nb.top,nb.left,!1,!1);let wb;nb.top==Da.top?wb=0:(va.bottom=nb.top-1,wb=Fa.Ajd(va));nb.left==Da.left?va=0:(va.right=nb.left-1,va=Fa.Bjd(va));Fa=this.upg(Da.top-1,Da.left-1);Fa.OriginDeltaY=wb;Fa.OriginDeltaX=va;Fa.Rows=nb.bottom-nb.top;Fa.Columns=nb.right-nb.left;Fa.Height=V;Fa.Width=Ta;nb.top==Da.top&&nb.left==Da.left&&(Fa.IsOrigin=!0);Da=La.h(this.$).Ub(nb.topLeft);Da.cell.X5f(Fa);return Da}kTd(Da,Fa){let nb=[];const Ta=La.h(this.$).$j("MergeCell");if(!Ta)return nb;
const V=Ta.Ajd(Da),va=Ta.Bjd(Da);if(Fa.z0c)for(const wb of Fa.z0c)if(Fa=this.lIg(Da,Ta,wb,va,V))nb.push(Fa);else{nb=[];break}return nb}K1h(Da,Fa,nb,Ta){var V=nb.bottom-nb.top,va=nb.right-nb.left;let wb=[];const fc=Ta.scenario;if(256===(fc&256)){if(wb=this.kTd(nb,Ta),!wb||0==wb.length)return wb}else Fa.cell.kTd(V,va),wb.push(Fa);V=this.y3(this.s5(Fa),!0,0,fc,"merge");if(void 0!==Da&&null!==Da)for(const Fc of wb){va=Da.cell.formattedText;const Qa=Object(ba.a)(new db.a,{TextRuns:va.TextRuns,Fonts:va.Fonts});
Qa.Text=void 0!==Da.cell.originalText&&null!==Da.cell.originalText?Da.cell.originalText:void 0!==Da.cell.userInput&&null!==Da.cell.userInput?Da.cell.userInput:va.Text;V=this.y3(this.s5(Fc),V,1,fc,"merge");this.qg.KTa(Fc,Qa,!1,!0,"MergeCells",1);V=this.y3(this.s5(Fc),V,2,fc,"merge");this.Esd?Fc.$rb(Da):this.G0j(Fc,Da);V=this.y3(this.s5(Fc),V,3,fc,"merge");Fc.cell.wah(Da.cell);V=this.y3(this.s5(Fc),V,4,fc,"merge");Fc.cell.pFc(!1);V=this.y3(this.s5(Fc),V,6,fc,"merge")}this.wgj(nb,Ta);this.y3(this.s5(Fa),
V,5,fc,"merge");return wb}Dmd(Da){return 4096===(Da&4096)}Mmd(Da){return 512===(Da&512)}qmd(Da){return 2048===(Da&2048)}Kmd(Da){return 1024===(Da&1024)}Ccc(Da,Fa){let nb=null;for(let Ta=0;Ta<Da.length;Ta++)if(Da[Ta].BorderPosition===Fa){nb=Da[Ta];break}return nb}QXh(Da,Fa){this.hkc?(Fa=this.Ccc(Fa.cell.pN().Borders,2))&&Da.push(Fa):(Fa=Fa.cell.pN().Borders,1<Fa.length&&(Fa=[Fa[1]]),Da=[...Fa,...Da]);return Da}Y4h(Da,Fa){this.hkc?(Fa=this.Ccc(Fa.cell.pN().Borders,0))&&Da.push(Fa):(Fa=Fa.cell.pN().Borders,
1<Fa.length&&(Fa=[Fa[0]]),Da=[...Fa,...Da]);return Da}JPh(Da,Fa){Fa=this.Ox.SQ(Fa.cell.getRange(),1);if(!Fa||0===Fa.length)return Da;if(this.hkc){if(Fa=Fa[0].pN().Borders,Fa=this.Ccc(Fa,0))Fa.BorderPosition=1,Da.push(Fa)}else{let nb=[];0<Fa.length&&(nb=Fa[0].pN().Borders);nb[0].BorderPosition=1;Da=[...nb,...Da]}return Da}U1h(Da,Fa){Fa=this.Ox.SQ(Fa.cell.getRange(),3);if(!Fa||0===Fa.length)return Da;if(this.hkc){if(Fa=Fa[0].pN().Borders,Fa=this.Ccc(Fa,2))Fa.BorderPosition=3,Da.push(Fa)}else{let nb=
[];0<Fa.length&&(nb=Fa[0].pN().Borders);nb[0].BorderPosition=3;Da=[...nb,...Da]}return Da}I0h(Da,Fa,nb){this.Dmd(Da.scenario)&&(Fa=this.QXh(Fa,nb));this.Mmd(Da.scenario)&&(Fa=this.Y4h(Fa,nb));this.qmd(Da.scenario)&&(Fa=this.JPh(Fa,nb));this.Kmd(Da.scenario)&&(Fa=this.U1h(Fa,nb));return Fa}d_(Da){if(0===Da.length)return null;let Fa=[0,0,0,0],nb=[1,1,1,1],Ta=0;Da.forEach(function(va){let wb=va.BorderPosition;nb[wb]=va.BorderLineStyle;let fc=new Ab.a(va.Color.Red,va.Color.Green,va.Color.Blue);Fa[wb]=
fc.LS();Ta|=da.HelperMethods.$4a(va.BorderPosition)});Da={};Da.LineStyle=nb;Da.Color=Fa;let V={};V.BorderFormat=Da;V.Border=Ta;return V}r5d(Da,Fa,nb=null){let Ta=[];Ta=null!==nb?[...nb]:this.I0h(Fa,Ta,Da);if(Fa=this.d_(Ta))Da.cell.Qcb(Da.cell.getRange()),this.Ox.cKb(Da.cell.getRange()),this.qg.Aea(La.h(this.$),-1690267012,Fa,!1,null,[Da.cell.getRange()])}Ori(Da){return 512===(Da.scenario&512)||4096===(Da.scenario&4096)||1024===(Da.scenario&1024)||2048===(Da.scenario&2048)?!0:!1}Z4h(Da){Da=this.Ox.SQ(Da.cell.getRange(),
1);return Da&&0!==Da.length?Da[0].tMa?(Da=Da[0].pN().Borders[0],Da.BorderPosition=1,Da):null:null}$4h(Da){Da=this.Ox.SQ(Da.cell.getRange(),3);return Da&&0!==Da.length?Da[0].pMa?(Da=Da[0].pN().Borders[0],Da.BorderPosition=3,Da):null:null}u9h(Da,Fa,nb,Ta,V){Fa.cell.kkg();if(this.Ori(Da))this.r5d(Fa,Da);else{const va=8192===(Da.scenario&8192),wb=Fa.cell.getRange();va&&this.gif?(Fa.cell.Qcb(),this.Ox.cKb(wb)):V?(V=[],null!==nb&&V.push(nb),null!==Ta&&V.push(Ta),0<V.length?this.r5d(Fa,Da,V):(Fa.cell.Qcb(),
this.Ox.cKb(wb))):va&&!this.gif&&(Fa.cell.Qcb(),this.Ox.cKb(wb))}}kXh(Da,Fa){return null===Da||void 0===Da?!0:Da.cell.getRange().top===Fa.topLeft.top&&Da.cell.getRange().left===Fa.topLeft.left&&Da.cell.getRange().bottom===Fa.topLeft.bottom&&Da.cell.getRange().right===Fa.topLeft.right?!0:!1}lHi(Da,Fa){Fa=this.Fwf(Da,Fa);if(this.ABb&&(!Fa||0==Fa.length))return!1;for(let nb=0;nb<Fa.length;nb++)Fa[nb].c1(2,!0),this.y3(this.s5(Fa[nb]),!0,8,Da.scenario,"merge");return!0}e_j(Da){const Fa=La.h(this.$).Da.$va(Da,
this.$.activeItemName);if(Fa&&Mb.Ct(Fa))for(let nb of Fa)nb.f2d(Da,!0)}Fwf(Da,Fa){const nb=Da.OQ,Ta=La.h(this.$).Ub(Fa[0]);let V=null,va=null;this.xjc&&(V=this.Z4h(Ta),va=this.$4h(Ta));const wb=this.K1h(nb,Ta,Fa[0],Da);if(this.ABb&&(!wb||0==wb.length))return wb;this.Eqi?this.e_j(Fa[0]):La.h(this.$).Da.E$(Fa[0],this.$.activeItemName).f2d(Fa[0],!0);this.y3(this.s5(Ta),!0,9,Da.scenario,"merge");if(this.xjc&&this.wqd(Da)){Fa=this.kXh(nb,Fa[0]);for(const fc of wb)this.u9h(Da,fc,V,va,Fa)}return wb}wSg(Da,
Fa,nb){if(!(1>Da.Borders.length)){var Ta=this.d_(Da.Borders);nb.forEach(V=>{V=La.h(this.$).Ub(V.getRange());this.qg.q$f(-1690267012,V,Ta,!1,null,!1,Fa)})}}DWj(Da,Fa,nb){const Ta=Da.length;for(let va=0;va<Ta;va++){Da[va].cell.pFc();const wb=Da[va].cell.getRange(),fc=La.h(this.$).Da.Wja(wb),Fc=fc.length;if(-167499203===Fa&&this.wjc){var V=0;2===Da[va].cell.YKd||1===Da[va].cell.ZE?V=3:2===Da[va].cell.ZE&&(V=1);Da[va].c1(V,!1)}for(V=1;V<Fc;V++)fc[V].attachCellToModel(),fc[V].$rb(Da[va]),-167499203===
Fa&&this.wjc&&fc[V].c1(null,!1);this.kof&&nb&&this.wSg(nb[va],wb,fc)}}j1e(Da,Fa){let nb=null;for(let Ta=0;Ta<Da.length;Ta++)if(Da[Ta].BorderPosition===Fa){nb=Da[Ta];break}return nb}IPh(Da,Fa){let nb=Da.cell.pN();Da.nMa()&&Da.cell.CRa(1);Da.rMa()&&Da.cell.CRa(3);if((Da=this.Ox.SQ(Fa,0))&&Da[0].nMa){var Ta=Da[0].pN().Borders;Ta=this.j1e(Ta,1);Ta.BorderPosition=0;nb.Borders.push(Ta);Da.forEach(V=>{V.CRa(1)})}(Fa=this.Ox.SQ(Fa,2))&&Fa[0].rMa&&(Da=Fa[0].pN().Borders,Da=this.j1e(Da,3),Da.BorderPosition=
2,nb.Borders.push(Da),Fa.forEach(V=>{V.CRa(3)}));return nb}iig(Da,Fa,nb){var Ta=La.h(this.$).Da.awa(Fa[0],this.$.activeItemName);const V=La.h(this.$).Da.E$(Fa[0],this.$.activeItemName),va=[];if(void 0!==Ta&&null!==Ta&&(Fa=La.h(this.$).fka(Fa[0],Ta),void 0!==Fa&&null!==Fa)){Fa=Fa.$$ge();for(Ta=[];Fa.$$mn();){var wb=Fa.$$cu();if(wb.bI){va.push(wb);this.y3(this.s5(wb),!0,10,Da,"unmerge");wb.cell.a5g();const fc=wb.cell.getRange();this.y3(this.s5(wb),!1,11,Da,"unmerge");V.f2d(fc,!1);this.kof&&(wb=this.IPh(wb,
fc),Ta.push(wb))}}0<va.length&&(V.rf.resetCellLookup(),this.DWj(va,nb,Ta))}}y3(Da,Fa,nb,Ta,V){if(!this.lkf)return!1;Da!==Fa&&w.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${nb}; Scenario: ${Ta}; Command: ${V}; Expected: ${Fa?"populated":"empty"}; Actual: ${Da?"populated":"empty"}`);return Da}s5(Da){return!!Da.cell.cell.Merge}}Object(t.a)(pb,"MergeCellCommandAction",null,[]);var Qb=a(64),xb=a(175),pa=a(44),Ma=a(380),ya=a(290),Ea=a(51),Na=a(70),
kb=a(55),lb=a(1089),oa=a(33),Ba=a(346),sa=a(145),qb=a(211),Jb=a(4),Yb=a(174);class jb{constructor(Da,Fa,nb,Ta,V,va,wb){this.$=Da;this.gridView=Fa;this.qg=nb;this.OB=Ta;this.borderFormatManager=V;this.moreColorsHelper=va;this.fontDropdownHelper=wb;this.PC=null;this.O0a=1461300262;this.o6b=this.Hx=this.L0a=this.s$a=this.Mbc=null;this.oUi=(fc,Fc,Qa)=>{const la=!!fc&&!!fc.RequestTelemetryData;!Ya.a(fc)&&Fc&&La.h(this.$).Eh.gma(Fc,fc.StateId,la?fc.RequestTelemetryData.EcsOperationDuration:0,la?fc.RequestTelemetryData.EcsRequestDuration:
0,la?fc.RequestTelemetryData.WfeRequestDuration:0);if(d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){Fc=1;if(33===Qa||17===Qa||9===Qa||5===Qa||37===Qa)Fc=0;this.x1(Fc,fc)}};this.YQi=fc=>{d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.x1(3,fc)};this.Urb=()=>{this.gridView.Q7a&&(this.copyPasteInfrastructure&&this.copyPasteInfrastructure.Fjj(this.Urb),
this.gridView.Q7a=!1,this.gridView.yf.hm(H.a.ZQ),this.gridView.ha.cX(this.Sed),La.h(this.$).$.af())};this.Sed=()=>{var fc=this.Mbc;this.Mbc=G.d(this.$.va.na);fc===this.Mbc&&(this.gridView.ha.cX(this.Sed),this.copyPasteInfrastructure&&this.copyPasteInfrastructure.T1c(36,La.h(this.$).ha.ra.selectedRanges)?(fc=new Ca.a(1804571062,2,2,0,null),this.$.Ka.Lb(fc,{[H.a.skipClipboardAccess]:!0,[H.a.u3c]:!0,[H.a.isFormatPainter]:!0}).continueWith(()=>{this.Urb()})):this.gridView.yf.rH(!1))};this.xc=()=>{this.oK&&
w.ULS.sendTraceTag(509690145,0,50,`GridCommandHandler::onWorkbookClosing: Font Usage Telemetry - {"newFontCount":${this.oK.GBd},"oldFontCount":${this.oK.WCd},"setFontCount":${this.oK.TSd},"hoverFontCount":${this.oK.Qnd},"menuOpenCount":${this.oK.iAd}}`)};this.xb=d.EwaSettings.xb();this.mergeCellCommandAction=new pb(this.$,nb);this.CD=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Wl=d.EwaSettings.Wl();this.ql=oa.a.ql();this.uB=oa.a.uB(this.$);if(this.Tic=d.EwaSettings.isChangeGateEnabled("OfficeVSO:7376562_TelemetryForFontUsage"))this.oK=
{GBd:0,WCd:0,TSd:0,Qnd:0,iAd:0},this.$.xj(this.xc)}get anf(){return n.a.all(this.gridView.ha.ra.selectedRanges,Da=>Da.isRow)}get Xmf(){return n.a.all(this.gridView.ha.ra.selectedRanges,Da=>Da.gf)}get themesManager(){this.Hx||(this.Hx=this.$.da.Aa(422));return this.Hx}x1(Da,Fa){const nb=this.$.da.Aa(465);nb&&nb.x1(Da,Fa)}Epi(Da){return 1896159024===Da||-1554384558===Da||-1113896058===Da||1554436520===Da||1415868706===Da||674605324===Da||1035996630===Da}nc(Da,Fa){return 2054778433===Fa&&Da&1?!X.a(this.$).kkc:
600686207===Fa?!1:this.Epi(Fa)&&n.a.any(this.gridView.ha.ra.selectedRanges,nb=>nb.gf||nb.isRow)&&!this.anf&&!this.Xmf?!0:this.Jkc(Da,Fa)}executeCommand(Da,Fa,nb){return this.Lb(Fa,nb)}yc(Da,Fa,nb){if(Da=1===Da)switch(Fa.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 2007171328:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Da=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:Da=
!!nb;break;case 862825906:case 1532790410:case 46555851:case -1522760979:Da=!0;break;default:Da=!1}return Da}Lc(Da,Fa,nb){switch(Fa){case "PopulateFontColor":nb.MenuItems=this.OB.Ncc(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,nb.MenuId);break;case "PopulateFillColor":nb.MenuItems=this.OB.Ncc(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,nb.MenuId);break;case "PopulateBorderColor":nb.MenuItems=this.OB.Ncc(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,nb.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.O9h(nb);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.ql&&(this.fontDropdownHelper.Oyj(nb.MenuId),!this.fontDropdownHelper.qoi()))return!1;nb.MenuItems=this.fontDropdownHelper.E0e(-1293291468,324978188,-1428968098,nb.MenuId);this.Tic&&(this.oK.iAd+=1);break;default:return!1}return!0}Jkc(Da,Fa){const nb=La.h(this.$).ha.ra.selectedRanges;return!(new W.a(this.$.va)).xm(Da,
Fa,nb,this.gridView)}Lb(Da,Fa){var nb=this.gridView;const Ta=Da.command;var V=f.TaskExtensions.Vj();let va=!0;switch(Ta){case -1077965542:va=this.Daf(Fa,Da,!1);break;case 909774670:this.frb(Ta);va=this.Daf(Fa,Da,!0);break;case -1293291468:va=this.Baf(Fa,Da,!1);break;case 324978188:this.frb(Ta);va=this.Baf(Fa,Da,!0);break;case 862890474:case 963349338:va=this.h9h(Da);break;case -1832800737:va=this.qfc(Ta,Fa,!1,Da);break;case 1970784898:va=this.qfc(Ta,Fa,!1,Da);break;case -803000997:va=this.qfc(Ta,
Fa,!1,Da);break;case -128950598:case 1688184685:this.frb(Ta);va=this.qfc(Ta,Fa,!0,Da);break;case 1597684571:va=this.Cyb(Ta,Fa,!1,Da);break;case 87208751:Fa.Color="-1";Fa.IntColor=!0;va=this.Cyb(Ta,Fa,!1,Da);break;case -446735083:this.frb(Ta);Fa.Color="-1";Fa.IntColor=!0;va=this.Cyb(Ta,Fa,!0,Da);break;case 1650812936:va=this.Cyb(Ta,Fa,!1,Da);break;case 673562736:this.frb(Ta);va=this.Cyb(Ta,Fa,!0,Da);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.q_f(Ta);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:va=
this.T8h(Ta,Da);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 2007171328:va=this.e8h(Ta,Da);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:va=this.J9h(Ta,Da);break;case -1803452024:case -236759591:va=this.Dld(Ta,Fa,Da);break;case -2118943501:va=this.borderFormatManager.l8h(Fa,Da);break;case 1012765228:va=this.borderFormatManager.d$h(Fa,Da);break;case 1256700402:va=
this.borderFormatManager.Hld(Da);break;case -1756763834:va=this.borderFormatManager.Ild(Da);break;case -1418159950:va=this.borderFormatManager.oaf(Da);break;case -1920201820:case -1942512156:va=this.i9h(Ta,Da);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:va=this.borderFormatManager.aaf(Fa,Da);this.AGh(Fa);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:va=this.F9h(Ta,Fa,Da);break;case -693675336:case 322710748:break;case 1696566924:va=
this.U8h(Da);break;case -167499203:case -255094134:case 1097660126:case 155820588:V=this.handleMergeCellsCommand(this.gridView,Da);break;case 1896159024:case -1554384558:Fa=this.gridView.ha.ra.selectedRanges;if(this.hEj(Da.command))w.ULS.sendTraceTag(509694159,0,50,"Insert Copied Cells Keyboard Shortcut"),this.copyPasteInfrastructure.qgf(null,Da),V=kb.Task.Ra(!0);else if(this.vFj(Da,Fa))w.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Pa(this.$,
Ta,Fa)).hg(),va=!0;else if(n.a.any(Fa,wb=>this.gridView.Ab.K_(wb))){nb="";V=1461300262;const wb=-1554384558===Ta&&this.gridView.Ab.Pri(Fa[0]);Fa=Fa[0].height>Fa[0].width&&!wb;switch(Ta){case 1896159024:nb=Fa?"InsertColumnsTable":"InsertRowsTable";V=Fa?622604322:942362098;break;case -1554384558:nb=Fa?"DeleteColumnsTable":"DeleteRowsTable",V=Fa?284490184:1405456548}Fa=ia.a.zq(jb.Cpd,nb,1);new Ca.a(V,1,2,6,null);V=this.insertOrDeleteCells(Fa,Da,!0)}else V=this.insertOrDeleteCells(1896159024===Ta?1:2,
Da,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:V=this.insertOrDeleteCells(ia.a.zq(jb.Cpd,Fa[J.a.Kc],1),Da,!0);this.uB&&(Da=La.h(this.$),qb.d(this.$,Da.ha.ra.activeCell,Ta,null));break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:V=this.insertOrDeleteCells(ia.a.zq(jb.Cpd,Fa[J.a.Kc],1),Da,!1);break;case 504848446:V=nb.startEdit(!1,1,Fa[H.a.event],void 0,void 0,!0);break;case 1504715724:if(La.h(this.$).Gz&&this.borderFormatManager.YU.wB)break;
V=nb.startEdit(!0,0,Fa[H.a.event],void 0,void 0,!0);break;case 1872288872:this.Urb();break;case 41465729:V=this.fill(nb.ha.ra.ed,null,0,1,Da);break;case -1451655532:case 1972143101:V=this.fillDownAbsoluteValueAndStartEdit(nb,Fa[H.a.event],-1451655532===Ta);break;case -475861485:V=this.fill(nb.ha.ra.ed,null,nb.rtl?1:2,1,Da);break;case -978843926:V=this.fill(nb.ha.ra.ed,null,3,1,Da);break;case 2098035706:V=this.fill(nb.ha.ra.ed,null,nb.rtl?2:1,1,Da);break;case -2142700828:V=this.fill(nb.ha.sourceRange,
nb.ha.ra.ed,jb.Z3e(nb.ha.ra.ed,nb.ha.sourceRange),2,Da);break;case 1405660955:V=this.fill(nb.ha.sourceRange,nb.ha.ra.ed,jb.Z3e(nb.ha.ra.ed,nb.ha.sourceRange),4,Da);break;case 1983983164:V=this.fill(nb.ha.ra.ed,null,0,0,Da);break;case 478842689:(Da=this.$.da.Aa(376))?(Da.G$i(),va=!0):w.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:va=
nb.ha.Lb(null,Ta);break;case -208772570:this.A9h();va=!0;break;case -987339782:this.t8h();va=!0;break;case -1770246794:nb.ha.u8h();va=!0;break;case 748067091:case -381232414:this.x8h(Ta);va=!0;break;case -1522760979:this.gridView.toggleFormulaView();va=!0;break;case 886009118:V=this.f9h();break;case 894341014:this.k9h();va=!0;break;case 862825906:V=this.Taf(1970784898,Da);break;case 1532790410:V=this.Taf(1650812936,Da);break;case 46555851:V=this.w9h(Da);break;default:va=!1}va||(V=Z.a(Ta));return V}AGh(Da){Da&&
Da.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(Da.MenuItemId)&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.KWg(new Ba.a(this.gridView.ha.ra.activeRange,G.d(this.$.va.na)))}KWg(Da){f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,426,427,1),Fa=>{void Fa.result.IDc(Da,"BorderActions")},this.$.ka,3)}get copyPasteInfrastructure(){var Da;null!==(Da=this.o6b)&&void 0!==Da?Da:this.o6b=this.$.da.Aa(254,
!0);this.o6b||w.ULS.sendTraceTag(509682657,0,50,"CopyPasteInfrastructure is null");return this.o6b}hEj(Da){var Fa;return 1896159024===Da&&(null===(Fa=this.copyPasteInfrastructure)||void 0===Fa?void 0:Fa.yOe())&&Yb.a.gxi}vFj(Da,Fa){const nb=n.a.all(Fa,va=>!this.gridView.Ab.K_(va)),Ta=1<Fa.length&&!!this.gridView.Ab.ukd(Fa),V=n.a.all(Fa,va=>!this.gridView.Ab.N5(va));Fa=!n.a.any(Fa,va=>va.isRow||va.gf);return 1===Da.method&&6===Da.We&&(nb||Ta)&&V&&Fa}fillDownAbsoluteValueAndStartEdit(Da,Fa,nb){const Ta=
Da.ha.ra.activeCell,V=aa.E(Ta,this.gridView.nt);return Da.startEdit(!0,0,Fa).np(()=>{const va=Da.Ub(V),wb=Da.Ub(Ta);if(!va||!wb)return w.ULS.shipAssertTag(537159507,0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Ta.toString()} and above cell: ${V.toString()}`),kb.Task.Ra(!1);this.gridView.Vb.text=nb?va.SS:va.text;this.gridView.Vb.textBox.setCaretPositionToEnd();return kb.Task.Ra(!0)})}insertOrDeleteCells(Da,Fa,nb){const Ta=x.a.create().toString();var V=
Enum.toString(S,Da);this.gridView.Eh.l1(17,Ta,V);V=this.gridView.ha.ra.selectedRanges;var va=this.anf,wb=this.Xmf;if(!this.$.aq(null,!1,void 0,Fa.We)&&!wb&&!va&&5!==Da&&9!==Da)return kb.Task.Ra(!0);2===Da?Da=wb?10:va?6:V[0].height>V[0].width?18:34:1===Da?Da=wb?9:va?5:V[0].height>V[0].width?17:33:18===Da&&va?Da=34:34===Da&&wb&&(Da=18);V=this.oQg(V,Da);if((10===Da||6===Da)&&!this.$.aq(V,!0,1,Fa.We))return kb.Task.Ra(!0);const fc={};fc.InsertDeleteRangeItems=Array(V.length);fc.SheetName=this.$.na.sheetName;
fc.IsTableCommand=nb;for(nb=0;nb<V.length;nb++){va=V[nb];wb={};let hb,Kb;Da&4?(wb.FirstRow=va.top-1,wb.LastRow=T.a.Oz,wb.FirstColumn=0,wb.LastColumn=T.a.Sw,hb=va.bottom-va.top+1,Kb=0,6===Da?(va.gf||(wb.FirstRow=va.bottom),hb=-hb):sa.b("InsertRowsAbove"),37===Da&&(wb.FirstRow=va.bottom,sa.b("InsertRowsBelow"))):Da&8?(wb.FirstRow=0,wb.LastRow=T.a.Oz,wb.FirstColumn=va.left-1,wb.LastColumn=T.a.Sw,hb=0,Kb=va.right-va.left+1,10===Da&&(va.isRow||(wb.FirstColumn=va.right),Kb=-Kb)):Da&16?(wb.FirstRow=va.top-
1,wb.LastRow=va.bottom-1,wb.FirstColumn=va.left-1,wb.LastColumn=T.a.Sw,hb=0,Kb=va.right-va.left+1,18===Da&&(wb.FirstColumn=va.right,Kb=-Kb)):(wb.FirstRow=va.top-1,wb.LastRow=T.a.Oz,wb.FirstColumn=va.left-1,wb.LastColumn=va.right-1,hb=va.bottom-va.top+1,Kb=0,34===Da&&(wb.FirstRow=va.bottom,hb=-hb));const dc={};dc.InsertDeleteRange=wb;dc.DeltaRow=hb;dc.DeltaColumn=Kb;dc.AdjustedSelectedRange=aa.j(va);fc.InsertDeleteRangeItems[nb]=dc}this.gridView.yf.rH(!1);const Fc=d.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");
fc.IsDecoupleRecalc=Fc;const Qa=this.$.pa.xa.Wb(),la=()=>new L(fc);return U.a(this.$.userOperationManager,(hb,Kb,dc)=>{Fc&&!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.Py();return ka(this.$.pa.xa,fc,Wa.b(hb,(sb,bb)=>{this.oUi(sb,bb,Da)},()=>{this.dUj(Da,fc)}),Kb,dc,Ta,Qa)},hb=>new K.a(237,0,hb,void 0,la),Fa,d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MoveTaskCompletionToQueueItemLevelByOptingIn",!1))}dUj(Da,Fa){const nb=this.t4h(Da);if(nb&&1===
Fa.InsertDeleteRangeItems.length){var Ta=Fa.InsertDeleteRangeItems[0];1<Ta.DeltaColumn||1<Ta.DeltaRow||this.uui(nb)&&f.TaskExtensions.za(e.GetServiceTaskFactory.Na(this.$.da,426,427,1),V=>{const va=new Ba.a(aa.B(Ta.AdjustedSelectedRange),G.d(this.$.va.na));void V.result.IDc(va,nb)},this.$.ka,3)}}uui(Da){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)?"DeleteColumn"===Da||"DeleteRow"===Da?(Jb.AFrameworkApplication.Hs("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteRowColProactiveSuggestions",!1)):"InsertColumn"===Da||"InsertRow"===Da?(Jb.AFrameworkApplication.Hs("XLS-SmartView-InsertRowColProactiveSuggestions-Treatment;XLS-SmartView-InsertRowColProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertRowColProactiveSuggestions",!1)):"InsertCellShiftDown"===Da||"InsertCellShiftRight"===Da?(Jb.AFrameworkApplication.Hs("XLS-SmartView-InsertCellTableProactiveSuggestions-Treatment;XLS-SmartView-InsertCellTableProactiveSuggestions-Control"),
d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.InsertCellTableProactiveSuggestions",!1)):"DeleteCellShiftUp"===Da||"DeleteCellShiftLeft"===Da?(Jb.AFrameworkApplication.Hs("XLS-SmartView-DeleteCellTableProactiveSuggestions-Treatment;XLS-SmartView-DeleteCellTableProactiveSuggestions-Control"),d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DeleteCellTableProactiveSuggestions",!1)):!1:(Jb.AFrameworkApplication.Hs("XLS-SmartView-DeleteRowColProactiveSuggestions-Treatment;XLS-SmartView-DeleteRowColProactiveSuggestions-Control"),
!1)}t4h(Da){let Fa;switch(Da){case 5:case 37:Fa="InsertRow";break;case 33:Fa="InsertCellShiftDown";break;case 9:Fa="InsertColumn";break;case 17:Fa="InsertCellShiftRight";break;case 6:Fa="DeleteRow";break;case 34:Fa="DeleteCellShiftUp";break;case 10:Fa="DeleteColumn";break;case 18:Fa="DeleteCellShiftLeft"}return Fa}oQg(Da,Fa){return Fa&32?this.p_a(Da,nb=>nb.bottom,nb=>nb.top,(nb,Ta)=>{nb.bottom=Ta},!1,!0):Fa&16?this.gridView.rtl?this.p_a(Da,nb=>nb.left,nb=>nb.right,(nb,Ta)=>{nb.left=Ta},!1,!1):this.p_a(Da,
nb=>nb.right,nb=>nb.left,(nb,Ta)=>{nb.right=Ta},!1,!1):Fa&4?this.p_a(Da,nb=>nb.bottom,nb=>nb.top,(nb,Ta)=>{nb.bottom=Ta},!0,!0):Fa&8?this.gridView.rtl?this.p_a(Da,nb=>nb.left,nb=>nb.right,(nb,Ta)=>{nb.left=Ta},!0,!1):this.p_a(Da,nb=>nb.right,nb=>nb.left,(nb,Ta)=>{nb.right=Ta},!0,!1):Da}p_a(Da,Fa,nb,Ta,V,va){Da=aa.d(Da);Da.sort((wb,fc)=>Fa(fc)-Fa(wb));if(V){V=[];va=va?T.a.gh+1:T.a.uh+1;for(let wb=0;wb<Da.length;wb++){const fc=Da[wb];nb(fc)<va&&(Ta(fc,Math.min(Fa(fc),va-1)),V.push(fc),va=nb(fc))}Da=
V}return Da}fill(Da,Fa,nb,Ta,V){const va=this.$;if(!va.aq([Fa],!0))return kb.Task.Ra(!0);const wb=aa.v(Da,va),fc=Fa?aa.v(Fa,va):wb,Fc=this.$.pa.xa.Wb(),Qa=()=>new ra(wb,fc,Ta,nb);return U.a(this.$.userOperationManager,(la,hb,Kb)=>{this.$.Py();var dc=this.$.pa.xa;la=Wa.b(la,this.YQi);const sb=dc.Oa(9,Fc);sb.sourceRange=wb;sb.targetRange=fc;sb.fillDirection=nb;sb.fillType=Ta;return Y.g(dc,"FillRange",sb,la,hb,Kb,null,0)},la=>new K.a(155,0,la,void 0,Qa),V)}F9h(Da,Fa,nb){const Ta={ValidMembers:32};switch(Da){case 1890566896:Da=
parseInt(Fa[J.a.Kc].toString(),10);if(14===Da)return nb=new Ca.a(2105621672,nb.method,nb.mode,nb.We,nb.tabName),Fa[J.a.Kc]=null,this.$.Ka.Lb(nb,Fa),w.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Ta.NumberFormat=Da;break;case 1886928607:Ta.NumberFormat=13;break;case -992833457:Ta.NumberFormat=11;break;case 218524921:Ta.NumberFormat=12;break;case 996232352:Ta.NumberFormat=1006;break;default:return w.ULS.shipAssertTag(537159505,
0,!1,"Unexpected number formatting command "+Ea.b().tj(nb.command)),!1}w.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Ea.b().tj(nb.command)} command, with menu item ${Fa[J.a.Kc]}.`);this.qg.formatCells(1890566896,Ta,nb);this.$.af();return!0}h9h(Da){var Fa=this.gridView.Ub(this.gridView.ha.ra.activeCell);if(this.xb&&this.gridView.gb){Fa=this.gridView.Ai.t5a(Fa?xb.a(Fa).Font:null);if(!Fa)return w.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.ra.activeCell.toString()} is null while editing`),
!1;var nb=Fa.FontSize}else if(Fa)nb=Fa.fontSize;else return!1;Fa=Da.command;let Ta=0;if(862890474===Fa)for(;Ta<jb.JKa.length-1&&jb.JKa[Ta]<=nb;)Ta++;else if(963349338===Fa)for(Ta=jb.JKa.length-1;0<Ta&&jb.JKa[Ta]>=nb;)Ta--;w.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${nb} to size ${jb.JKa[Ta]}`);if(nb===jb.JKa[Ta])return!0;nb=jb.Qyc(2);nb.Font.FontSize=jb.JKa[Ta];this.xb&&this.gridView.gb?(this.Gpb(Da,!1,nb),this.$.af()):this.qg.formatCells(Fa,
nb,Da);return!0}Daf(Da,Fa,nb){Da=Da[Da[r.a.IsFreeForm]?r.a.Value:J.a.ng].toString();if(!jb.W5i.test(Da))return w.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),!0;Da=parseFloat(Da);if(8>Da||72<Da)return w.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),!0;const Ta=Math.round(2*Da)/2,V=jb.Qyc(2);V.Font.FontSize=Ta;this.xb&&this.gridView.gb?(this.Gpb(Fa,
nb,V,!0),Ta===Da||nb||this.$.af()):nb?this.qg.Aea(this.gridView,-1077965542,V,nb):(this.qg.formatCells(-1077965542,V,Fa),this.n1a());return!0}Baf(Da,Fa,nb){var Ta=Da[J.a.ng];let V;this.ql?this.fontDropdownHelper.kCc&&this.fontDropdownHelper.kCc[Ta]?V=Ta:(w.ULS.sendTraceTag(523903201,1,15,`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Ta}`),V=da.HelperMethods.eP[Ta]):V=da.HelperMethods.eP[Ta];let va=0;this.Wl&&(Da=Da.MenuItemId,Da===lb.b?(Ta==this.themesManager.zG.EAd&&
(V=Ta),va=2):Da===lb.a&&(Ta==this.themesManager.zG.qzd&&(V=Ta),va=1),w.ULS.sendTraceTag(510247702,1,50,`GridCommandHandler.handleFontFamilyCommand: Font used is theme font: ${0!==va}`));if(!V)return!0;Ta=jb.Qyc(1);Ta.Font.FontName=V;this.Wl&&(Ta.Font.FontScheme=va);this.xb&&this.gridView.gb?(this.Gpb(Fa,nb,Ta),this.$.af()):nb?(this.qg.Aea(this.gridView,-1293291468,Ta,nb),this.Tic&&(this.oK.Qnd+=1)):(this.qg.formatCells(-1293291468,Ta,Fa),this.Tic&&this.gei(Ta.Font.FontName),this.n1a());return!0}gei(Da){this.oK.TSd+=
1;this.ql&&this.qg.Qjf(Da)?this.oK.GBd+=1:this.oK.WCd+=1}qfc(Da,Fa,nb,Ta){let V=-803000997===Da||1688184685===Da?"black":Fa.Color;this.moreColorsHelper&&(-1832800737===Da?V=ha.a.compare(V,"WindowText",!0)?this.moreColorsHelper.Acb:"black":nb||(this.moreColorsHelper.Acb=V,this.moreColorsHelper.Kda(Fa,V,Ta)));Da=jb.Qyc(32);Da.Font.FontColor=fa.a.JH(V,ia.a.xg(Fa,"IntColor"));this.xb&&this.gridView.gb?this.Gpb(Ta,nb,Da,17===Ta.We):nb?this.qg.Aea(this.gridView,1970784898,Da,nb):(this.CD&&({themeColor:Fa}=
this.getThemeColor(Fa)).returnValue&&(Da.Font.ThemeFontColor=Fa,Da.Font.ColorTypeOption=1),this.qg.formatCells(1970784898,Da,Ta),this.n1a());return!0}x8h(Da){var Fa=(new Date).format(748067091===Da?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);const nb=this.gridView.Vl?Aa.a(this.gridView.$):this.gridView.Vb;Da=nb.textBox;this.gridView.gb?nb.insertText(Fa):(this.gridView.startEdit(!0,0),nb.text=Fa,Fa=Fa.length,Da.oeb(Fa),Da.caretPosition=Fa)}A9h(){this.gridView.NK(this.gridView.ha.ra.activeCell)||
this.gridView.iyc||this.gridView.ONa()||this.gridView.Eu(this.gridView.ha.ra.activeCell,3,"GridCommandHandler.HandleMoveViewportToActiveCell")}t8h(){if(!(this.gridView.iyc||this.gridView.ONa()||this.gridView.gb&&u.a.isMac)){const Da=this.gridView.ha.ra.H4;this.gridView.gg(aa.v(Da,this.$),Da,null,null,60,"GridCommandHandler.HandleMoveViewportToActiveCell")}}U8h(Da){this.Mbc=G.d(this.$.va.na);if(this.gridView.Q7a)return this.gridView.yf.rH(!1),!!this.copyPasteInfrastructure;if(!this.copyPasteInfrastructure)return w.ULS.sendTraceTag(537159494,
0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.WY(this.Sed);const Fa=String.format(H.a.cua,Q.a.current.io(108));this.gridView.yf.hm(Fa);Da=new Ca.a(-911352779,Da.method,Da.mode,Da.We,Da.tabName);this.$.Ka.Lb(Da,{[H.a.silentClipboardAccessFailures]:!0,[H.a.isFormatPainter]:!0}).continueWith(nb=>{(6>nb.status||6===nb.status&&!nb.result)&&this.Urb()});this.gridView.Q7a=!0;this.copyPasteInfrastructure.nOg(this.Urb);return!0}Cyb(Da,Fa,nb,Ta){let V=
87208751===Da?"-1":Fa.Color;this.moreColorsHelper&&(1597684571===Da?V=this.moreColorsHelper.nRa:nb||(this.moreColorsHelper.nRa=V===jb.notSet?jb.n0d:V,this.moreColorsHelper.Kda(Fa,V,Ta)));Da={ValidMembers:64};Da.FillColor=fa.a.JH(V,ia.a.xg(Fa,"IntColor"));nb?this.qg.Aea(this.gridView,1650812936,Da,!0):(this.CD&&({themeColor:Fa}=this.getThemeColor(Fa)).returnValue&&(Da.ThemeFillColor=Fa,Da.ColorTypeOption=1),this.qg.formatCells(1650812936,Da,Ta),this.n1a());return!0}k9h(){w.ULS.sendTraceTag(537159493,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const Da=this.$.da.Aa(221);if(Da){var Fa=this.gridView.Ai;if(Fa){var nb,Ta,V=({lyf:nb,AZe:Ta}=Da.sii(Fa.text,Fa.textBox.caretPosition)).returnValue;V?(Da.te=!1,Fa.text=V,Fa.textBox.selectRange(nb,nb+Ta),w.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):w.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else w.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else w.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}T8h(Da,Fa){let nb=0;const Ta=this.gridView,V=xb.a(Ta.Ub(null));this.xb&&Ta.gb&&(V.Font=Ta.Ai.t5a(V.Font));let va=V.Font;va||(va={ValidMembers:0});switch(Da){case -287251124:nb|=4;Ga.e(va,4)?va.Bold=!va.Bold:va.Bold=!0;break;case -1925065947:nb|=8;Ga.e(va,8)?va.Italic=!va.Italic:va.Italic=!0;
break;case 1764140053:nb|=16;Ga.e(va,16)?va.Underline=!va.Underline:va.Underline=!0;break;case -1685033574:nb|=64;Ga.e(va,64)?va.DoubleUnderline=!va.DoubleUnderline:va.DoubleUnderline=!0;break;case -1590502662:nb|=128,Ga.e(va,128)?va.Strikethrough=!va.Strikethrough:va.Strikethrough=!0}if(!nb)return!1;va.ValidMembers=nb;V.Font=va;V.ValidMembers=16;this.xb&&this.gridView.gb?this.Gpb(Fa,!1,V):(d.EwaSettings.oa(614)||Ta.yf.rH(!1),this.qg.formatCells(Da,V,Fa));this.$.af();return!0}e8h(Da,Fa){let nb=0;
const Ta=this.gridView,V=xb.a(Ta.Ub(null));-571165336===Da||1041132226===Da||-394785302===Da?(nb|=1,V.VerticalAlignment=ia.a.zq(jb.y_a,Da.toString(),2)):jb.hpi(Da)?(nb|=2,this.c9h(V,Da)):-1116189897===Da&&(nb|=8,V.Wrap=V.ValidMembers&8?!V.Wrap:!0);if(!nb)return!1;V.ValidMembers=nb;d.EwaSettings.oa(614)||Ta.yf.rH(!1);this.qg.formatCells(Da,V,Fa);this.$.af();return!0}c9h(Da,Fa){!d.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==
Fa&&(Fa=-1150205178===Fa?-286432209:-1150205178);Fa=ia.a.zq(jb.y_a,Fa.toString(),0);Da.HorizontalAlignment=Fa===Da.HorizontalAlignment?0:Fa}jQf(Da,Fa,nb,Ta){let V=!1;d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(V=this.mergeCellCommandAction.Ewf(Fa,nb))&&La.h(this.$).Eh.HS(this.s$a,Qb.BasicTelemetryCalculator.jR);return this.Xub(Da,Fa,!1,V,va=>{this.xVi(va,nb,Fa,V,Ta)})}handleMergeCellsCommand(Da,Fa){this.s$a=x.a.create().toString();let nb=null;nb=this.mergeCellCommandAction.P5e();
var Ta=C.a(Fa.command);const V=this.mergeCellCommandAction.Wmi(Fa.command,nb);let va=0;V?va=v.a.Ud():La.h(this.$).Eh.l1(4,this.s$a,Ta+", Scenario = "+nb.scenario.toString());Ta=Da.ha.ra.selectedRanges;w.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Ea.b().tj(Fa.command)}, Number of ranges: ${Ta.length}, Ranges: ${aa.i(Ta,",",this.$,!1)}`);Ta=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);Da.yf.rH(!1,Ta);if(10===
ia.a.zq(jb.Gwf,Fa.command.toString(),10))return kb.Task.Ra(!1);const wb=d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Ta&&wb)return V?(this.X9f(nb,Fa,!0,!0,va),kb.Task.Ra(!0)):this.jQf(Da,Fa,nb,!1);let fc=!1;Ta&&(fc=this.mergeCellCommandAction.Ewf(Fa,nb))&&La.h(this.$).Eh.HS(this.s$a,Qb.BasicTelemetryCalculator.jR);return this.Xub(Da,Fa,!1,fc,Fc=>{this.yVi(Fc,Fa,fc)})}Xub(Da,Fa,nb,Ta,V=null){const va=this.$.pa.xa.Wb(),wb=ia.a.zq(jb.Gwf,Fa.command.toString(),
10),fc=aa.r(Da.ha.ra.selectedRanges,Da.$),Fc=()=>new P.a(wb,fc),Qa=la=>{const hb=!!la&&!!la.RequestTelemetryData;La.h(this.$).Eh.gma(this.s$a,la.StateId,hb?la.RequestTelemetryData.EcsOperationDuration:0,hb?la.RequestTelemetryData.EcsRequestDuration:0,hb?la.RequestTelemetryData.WfeRequestDuration:0)};Da=(la,hb,Kb)=>{this.$.Py();la=V?Wa.b(la,V):la;la=Wa.b(la,Qa);return Y.d(this.$.pa.xa,wb,fc,nb,la,hb,Kb,null,va)};return Ta?U.a(this.$.userOperationManager,Da,la=>new K.a(156,0,la,64,Fc),Fa):U.a(this.$.userOperationManager,
Da,la=>new K.a(156,0,la,void 0,Fc),Fa)}X9f(Da,Fa,nb,Ta=!1,V=0){w.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${nb}`);var va=La.h(this.$).rtl;va=Ra.a.dd(3,2,0,va?635:634,0,514846606,"MergeCellsLoseData");f.TaskExtensions.za(pa.a(this.$).uj(va),wb=>{wb=wb.result;if(Ta){const fc=v.a.Ud()-V;w.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${fc}, and the user action is : ${wb}`)}0===wb?(w.ULS.sendTraceTag(537159456,0,50,
"MergeCellsLoseData Dialog: Ok pressed"),nb?(Ta&&(wb=C.a(Fa.command),La.h(this.$).Eh.l1(4,this.s$a,wb+", Scenario = "+Da.scenario.toString())),this.jQf(La.h(this.$),Fa,Da,!0)):this.Xub(this.gridView,Fa,!0,!1)):1===wb&&w.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ka,11)}lBi(Da,Fa,nb,Ta){Fa!==Da&&w.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${Fa} and as per server is ${Da}. The scenario is:- ${nb}, The CSE is done:- ${Ta}`)}yVi(Da,
Fa,nb){Ya.b(Da,514846606)&&(w.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Na.a(this.$).hd.CM(514846606),Da=La.h(this.$).rtl,Da=Ra.a.dd(3,2,0,Da?635:634,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.za(pa.a(this.$).uj(Da),Ta=>{Ta=Ta.result;0===Ta?(w.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.Xub(this.gridView,Fa,!0,nb)):1===Ta&&w.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ka,11))}xVi(Da,Fa,nb,
Ta,V){let va=!1;Ya.b(Da,514846606)&&(va=!0,Na.a(this.$).hd.CM(514846606),Ta&&V?window.setTimeout(()=>{this.Xub(this.gridView,nb,!0,!0)},0):this.X9f(Fa,nb,!1));this.lBi(va,V,Fa.scenario,Ta)}frb(Da){if(this.O0a!==Da&&1461300262!==this.O0a){this.q_f(this.O0a);var Fa=Ea.b().tj(Da);const nb=Ea.b().tj(this.O0a);w.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${nb} was restored before caching the style for ${Fa} command.`)}this.O0a=Da;if(this.xb&&this.gridView.gb)this.L0a||
(this.L0a=this.gridView.Ai.formattedText);else if(!this.PC){this.PC=[];Fa=this.gridView.kaa("GridCommandHandler.CacheFontStyles",this.gridView.ha.ra.selectedRanges);try{for(Fa.$$rst();Fa.$$mn();){const nb=Fa.$$cu();if(nb.cell.hasRichText)this.PC.push(ca.cZg(nb,nb.cell.formattedText));else switch(Da){case 673562736:case -446735083:this.PC.push(ca.e1c(nb,nb.backgroundColor));break;case -128950598:case 1688184685:this.PC.push(ca.e1c(nb,nb.color));break;case 909774670:this.PC.push(ca.dZg(nb,nb.fontSize));
break;case 324978188:this.Wl?this.PC.push(ca.bZg(nb,nb.fontName,nb.a_)):this.PC.push(ca.e1c(nb,nb.fontName))}}}finally{Fa&&Fa.dispose()}}}TJj(){return this.xb&&this.gridView.gb?!this.L0a:!this.PC}Mli(Da){return!!this.PC&&this.PC.length>Da&&!!this.PC[Da].formattedText}sgd(Da){return this.PC[Da].style}oQh(Da){return this.PC[Da].size}nQh(Da){return this.PC[Da].a_}q_f(Da){if(!this.TJj()){if(this.xb&&this.gridView.gb)this.L0a&&(this.gridView.Vb.formattedText=this.L0a);else{const nb=this.PC.length;for(let Ta=
0;Ta<nb;Ta++){let V;var Fa=this.PC[Ta].Lja.cell.getRange();V=this.gridView.Ub(Fa);if(!V){w.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${Fa.Hw(!1)}`);continue}let va;Fa=V.bI?this.gridView.rMb(V.range):(va=new M.a,va.add(V),va);for(let wb of Fa)if(wb.cell.hasRichText&&1457172838!==Da)this.Mli(Ta)&&(wb.cell.formattedText=this.PC[Ta].formattedText);else switch(Da){case 1457172838:wb.backgroundColor=this.sgd(Ta);break;case 2036397036:wb.color=
this.sgd(Ta);break;case -1904244080:wb.fontSize=this.oQh(Ta);break;case -1428968098:wb.fontName=this.sgd(Ta),this.Wl&&wb.s5f(this.nQh(Ta))}}}this.O0a=1461300262;this.n1a()}}n1a(){this.xb&&this.gridView.gb?this.L0a=null:this.PC=null}i9h(Da,Fa){const nb={IndentationIncrease:0};if(-1942512156===Da)nb.IndentationIncrease=1;else if(-1920201820===Da)nb.IndentationIncrease=-1;else return!0;nb.ValidMembers=256;this.qg.formatCells(Da,nb,Fa);return!0}J9h(Da,Fa){var nb=this.gridView.Ub(null);nb=xb.a(nb);var Ta=
Da;!La.h(this.$).rtl||-1649235364!==Da&&524773427!==Da||(Ta=-1649235364===Da?524773427:-1649235364);switch(Ta){case -1649235364:Ta=T.a.rotateTextUp45;break;case 524773427:Ta=T.a.jxc;break;case 1886217042:Ta=T.a.rotateTextUp90;break;case 928057943:Ta=T.a.lxc;break;case -1526602249:Ta=T.a.verticalText;break;default:return!1}nb.ValidMembers=512;const V=nb.TextOrientation;nb.TextOrientation=Ta===V||V===T.a.ixc&&Ta===T.a.jxc||V===T.a.kxc&&Ta===T.a.lxc?0:Ta;this.qg.formatCells(Da,nb,Fa);return!0}f9h(){const Da=
La.h(this.$),Fa=aa.r(Da.ha.ra.selectedRanges,this.$),nb=aa.o(Da.ha.ra.activeCell,this.$);w.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return U.a(this.$.userOperationManager,(Ta,V,va)=>na.r(this.$.pa.xa,nb,Fa,Ta,V,va,null),Ta=>new K.a(201,0,Ta),null)}Taf(Da,Fa){let nb=null;var Ta=La.h(this.$).ha.ra.selectedRanges;Ta=this.gridView.kaa("MoreColors",Ta,1,!0);try{for(Ta.$$rst();Ta.$$mn();){const V=Ta.$$cu().cell;if(!V)continue;let va=jb.black;if(1970784898===
Da)va=V.color;else if(1650812936===Da){const wb=V.backgroundColor;va=ha.a.compare(wb,jb.n0d,!0)&&ha.a.compare(wb,jb.empty,!0)?V.backgroundColor:jb.white}if(!nb)nb=va;else if(nb!==va){nb=jb.black;break}}}finally{Ta&&Ta.dispose()}this.xb&&this.gridView.gb&&1970784898===Da&&this.gridView.Ai.textBox.cze();return this.moreColorsHelper.EDb(Da,Fa,nb)}w9h(Da){const Fa=B.a.M5a(this.borderFormatManager.W3);return this.moreColorsHelper.EDb(-236759591,Da,Fa)}Gpb(Da,Fa,nb,Ta=!1){Fa?this.gridView.Ai.oPf(nb.Font):
(this.CDi(Da),Ta?window.requestAnimationFrame(()=>{z.FocusManager.instance().vk(A.AFrame.waa);this.gridView.Ai.I_e(nb.Font)}):(z.FocusManager.instance().vk(A.AFrame.waa),this.gridView.Ai.I_e(nb.Font)),this.n1a())}CDi(Da){const Fa=C.a(Da.command);Da=y.a[Da.We]+"_"+D.a[Da.method];const nb=this.gridView.jc.DCe.toString(),Ta=new Map;Ta.set("Command",Fa);Ta.set("Source",Da);Ta.set("Ribbon","React");Ta.set("CellTextRuns",nb);I.Health.instance.recordKpiUsage(ya.a.RJh,0,Ma.a.U_f,Ta)}Dld(Da,Fa,nb){Da=this.borderFormatManager.Dld(Da,
Fa,nb);this.moreColorsHelper&&this.moreColorsHelper.Kda(Fa,this.borderFormatManager.W3,nb);return Da}getThemeColor(Da){let Fa;Fa={};let nb=!1;if((Da.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return w.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Fa};let Ta;({themeIndex:Da,fCa:Ta,returnValue:nb}=this.themesManager.getThemeColor(Da.Color));nb&&(Fa.ThemeColorIndex=Da,Fa.ThemeColorRow=Ta)}return{returnValue:nb,
themeColor:Fa}}static get W5i(){return jb.Die||(jb.Die=RegExp("^[0-9]+[.]?[0-9]*$"))}static get Cpd(){return jb.$be||(jb.$be={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get y_a(){return jb.Whb||(jb.Whb={["-394785302"]:0,["-571165336"]:2,
["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3,["2007171328"]:6})}static get Gwf(){return jb.Sfe||(jb.Sfe={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static hpi(Da){return-1150205178===Da||-1142465846===Da||-286432209===Da||2007171328===Da}static Qyc(Da){const Fa={},nb={};Fa.ValidMembers=16;Fa.Font=nb;nb.ValidMembers=Da;return Fa}static Z3e(Da,Fa){let nb;nb=Da.top<Fa.top?3:Da.bottom>Fa.bottom?0:-1;return nb=Da.left<Fa.left?1:Da.right>Fa.right?2:nb}}
jb.n0d="transparent";jb.notSet="-1";jb.black="#000000";jb.empty="";jb.white="#FFFFFF";jb.$be=null;jb.Whb=null;jb.Sfe=null;jb.Die=null;jb.JKa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(t.a)(jb,"GridCommandHandler",null,[219]);class ab extends l.a{constructor(Da){super(Da)}ld(){const Da=e.GetServiceTaskFactory.create(this.$.da,111,this.ka,this.Ya),Fa=e.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya),nb=e.GetServiceTaskFactory.create(this.$.da,397,this.ka,this.Ya),Ta=e.GetServiceTaskFactory.Na(this.$.da,
502,503,this.Ya);if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const V=e.GetServiceTaskFactory.Na(this.$.da,296,468,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Da,Fa,nb,V,Ta],this.ka),()=>{this.Zc([new jb(this.$,La.h(this.$),Fa.result,Da.result,V.result,nb.result,Ta.result)])},this.ka,3)}else{const V=e.GetServiceTaskFactory.create(this.$.da,102,this.ka,this.Ya);f.TaskExtensions.za(f.TaskExtensions.Ed([Da,Fa,V,nb,Ta],this.ka),()=>{this.Zc([new jb(this.$,
La.h(this.$),Fa.result,Da.result,new h.BorderFormatManager(this.$,Fa.result,V.result),nb.result,Ta.result)])},this.ka,3)}}static la(Da){l.a.Nd(80,new ab(Da))}}Object(t.a)(ab,"GridCommandHandlerFactory",l.a,[]);a.d(E,"a",function(){return vb});const vb=()=>{c.a.Fa(ab.la);c.a.Fa(m.la)}},1175:function(t,E,a){function c(Ya){return Object(x.c)(Ya)?"cache":"client"===Ya.origin||Ya.cached?"client":"server"}function b({x:Ya,y:Ga},da,Z=document){let ha=-1,Wa=null;void 0!==Z.caretPositionFromPoint?(Ya=Z.caretPositionFromPoint(Ya,
Ga),null!==Ya&&(ha=Ya.offset,Wa=Ya.offsetNode)):void 0!==Z.caretRangeFromPoint&&(Ya=Z.caretRangeFromPoint(Ya,Ga),null!==Ya&&(ha=Ya.startOffset,Wa=Ya.startContainer));return null===Wa||-1===ha?(u.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),-1):da.contains(Wa)?e(da,Wa,ha):(u.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),-1)}function e(Ya,Ga,da){if(Ya===Ga)return da;if(Ga.textContent!==Ga.parentElement.textContent)for(;null!==
Ga.previousSibling;)Ga=Ga.previousSibling,da+=Ga.textContent.length,"div"===Ga.nodeName.toLowerCase()&&(da+=1);return e(Ya,Ga.parentElement,da)}function f(Ya,Ga){return Ya.text===Ga.text&&Ya.start===Ga.start&&Ya.length===Ga.length}function d(Ya,Ga,da){if(Ya.has(Ga))return Ya.get(Ga);da=da();Ya.set(Ga,da);return da}function h(Ya){return JSON.stringify({text:Ya.text,start:Ya.start,length:Ya.length})}function m(Ya){return Object(x.c)(Ya)?"Undefined text":""===Ya?"Empty text":null}var l=a(9);t=a(0);var w=
a(222),n=a(163),x=a(728),r=a(21),u=a(15),v=a(11),B=a(22),z=a(13),A=a(216),y=a(34),D=a(33),I=a(1096);class M{constructor(Ya){this.$=Ya;this.fJa=this.Ftb=null;this.usage={};this.results={};this.performance={};this.Jsc=-1;this.xc=(Ga,da)=>{da.If||da.rrd||this.$.sendBeaconTraceTag(388818255,50,!1,this.s_d())};this.editBox=Object(r.h)(this.$).Vb;Ya.xj(this.xc)}static getInstance(Ya){return M.instance||(M.instance=new M(Ya))}set trigger(Ya){this.Ftb=Ya;this.Jsc=I.a.$Zd}set HPd(Ya){this.fJa=Ya}setResult(Ya,
Ga){if(Object(x.c)(this.Ftb))u.ULS.sendTraceTag(512258439,0,15,"ValuePreviewTelemetry.setResult - currentTrigger undefined");else{var da=Ga===this.editBox?"cellEditor":"formulaBar",Z=this.Ftb;Ga=this.fJa;var ha=this.Jsc;Object(x.c)(this.usage[da])&&(this.usage[da]={});Object(x.c)(this.usage[da][Z])&&(this.usage[da][Z]={success:0,error:0,unavailable:0});da=this.usage[da][Z];switch(Ya.kind){case 1:this.vLd(Ya.text);da.success++;this.Ftb=this.fJa=null;this.Jsc=-1;break;case 2:da.error++;this.Ftb=null;
this.Jsc=-1;break;case 3:da.unavailable++}this.Cw(Ga,ha)}}vLd(Ya){if(!Object(x.c)(this.fJa)){Object(x.c)(this.results[this.fJa.origin])&&(this.results[this.fJa.origin]=[]);var Ga=this.results[this.fJa.origin];1E3>Ga.length&&Ga.push(Ya.length)}}Cw(Ya,Ga){if(-1!==Ga){Ya=c(Ya);this.M6e(`${Ya}_request`).q4(!0,Ga);var da=this.M6e(`${Ya}_overall`);window.requestAnimationFrame(()=>{da.q4(!0,Ga)})}}M6e(Ya){return this.performance[Ya]=this.performance[Ya]||new I.a(T)}s_d(){const Ya={};Object.keys(this.performance).forEach(Ga=>
{this.performance[Ga].QYe();var da=this.performance[Ga];Ya[Ga]={metrics:da.EW,durations:da.Hub}});return`{"usage":${JSON.stringify(this.usage)},"results":${JSON.stringify(this.results)},"performance":${JSON.stringify(Ya)}}`}}Object(t.a)(M,"ValuePreviewTelemetry",null,[]);const T=[50,80,100,130,150,170,200];class S{constructor(Ya,Ga,da){this.$=Ya;this.LKa=Ga;this.ariaLiveNotifier=da;this.Ffi();this.editBox=Object(r.h)(this.$).Vb;this.$Ej=D.a.oR(this.$)}get telemetry(){return M.getInstance(this.$)}get zoomManager(){this.zoe||
(this.zoe=Object(y.a)(this.$));return this.zoe}dispose(){this.hide()}show(Ya,Ga,da){const Z=Object.assign(Object.assign({},Ga),{ZU:Ya,e4d:da});this.Xeb(Z)&&(this.toa(Z)&&this.hide(),this.gD=Z,this.telemetry.setResult(Ga,Ya),this.Uy(),da&&this.yci())}hide(){if(this.gD){var Ya=this.gD.e4d;this.Rnh();Ya&&this.Vgj();this.gD=void 0}}Xeb(Ya){var Ga;(Ga=!this.gD)||(Ga=this.gD,Ga=!(Ga.ZU===Ya.ZU&&Ga.kind===Ya.kind&&Ga.text===Ya.text&&Ga.start===Ya.start&&Ga.length===Ya.length&&Ga.e4d===Ya.e4d));return Ga}toa(Ya){var Ga;
if(Ga=this.gD)Ga=this.gD,Ga=!(Ga.ZU===Ya.ZU&&Ga.start===Ya.start&&Ga.length===Ya.length);return Ga}yci(){this.gD.ZU.textBox.formatText(this.gD.start,this.gD.length,{background:"rgba(202,234,216,0.6)"})}Vgj(){const Ya=this.gD.ZU,Ga=this.gD.start,da=this.gD.length,Z=Ya.text;Z.length<Ga+da?u.ULS.shipAssertTag(521019917,0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${Z.length}:${Ga}:${da}`):(Ya.textBox.formatText(Ga,da,{background:!1}),this.$Ej&&Ya.aC(null))}Uy(){var Ya=
this.gD.text;switch(this.gD.kind){case 1:case 2:Ya={isLoaded:!0,value:Ya};break;case 3:Ya={isLoaded:!1,value:null};break;default:return}this.M0j();this.LKa.renderValuePreview(this.Ws,this.kQb,Ya);this.O3i(Ya)}Rnh(){this.LKa.dismiss(this.Ws)}Ffi(){this.Ws=document.createElement("div");this.kQb=document.createElement("div");this.kQb.style.position="absolute";this.kQb.style.visibility="hidden";this.$.domElement.appendChild(this.kQb)}M0j(){var Ya=this.gD.ZU,Ga=this.gD.start;const da=this.gD.length,Z=
B.a.contains(Ya.text.substring(Ga,Ga+da),"\n",!0);Ya=excelOnline.utils.getBoundingRectForText(Ya.textBox.Ke,Ga,Z?Ga:Ga+da,!1);Ga=new A.a(this.kQb.style);Ga.YB.left=this.eBc(Ya.left);Ga.YB.top=this.eBc(Ya.top);Ga.YB.width=this.eBc(Ya.width);Ga.YB.height=this.eBc(Ya.height);Ga.g3()}eBc(Ya){var Ga=this.gD.ZU;Ga=Object(x.b)(this.zoomManager)&&Ga===this.editBox;return v.HelperMethods.uc(Ga?this.zoomManager.zi(Ya):Ya)}O3i({isLoaded:Ya,value:Ga}){Ya?this.ariaLiveNotifier.readText(String.format(z.a.instance.mb(179),
Ga)):this.ariaLiveNotifier.readText(z.a.instance.ga(865))}}Object(t.a)(S,"FormulaAssistanceValuePreviewControl",null,[3]);var H=a(113);class C{constructor(Ya){this.cache=Ya}clearCache(){this.cache=void 0}}Object(t.a)(C,"Cacheable",null,[]);class G extends C{constructor(Ya,Ga){super();this.$=Ya;this.callbacks=Ga;this.pDf=(da,Z)=>{const ha=this.gridView.Ai;if(!(0<(ha.gb?ha.textBox.selection:{index:0,length:0}).length))switch(Z.state){case 0:this.onHoverEnter(da,Z.event);break;case 1:this.onHoverLeave(da);
break;default:return u.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),Z}};this.oDf=(da,Z)=>{const ha=Z.selection;Z={kind:"selection",text:Z.text,start:ha.index,length:ha.length};if(0<ha.length)this.onSelectionChange(da,Z);else this.fJf(da,Z)};this.gridView=Object(r.h)(this.$);this.editBox=this.gridView.jc;this.Oj(this.editBox);this.formulaBar=Object(H.a)(this.$);Object(x.b)(this.formulaBar)?this.Oj(this.formulaBar):Object(H.b)(this.$,da=>
{this.formulaBar=da;this.Oj(this.formulaBar);u.ULS.sendTraceTag(509870663,1,50,"FormulaAssistanceValuePreviewHandler: formulaBar async")})}get telemetry(){return M.getInstance(this.$)}dispose(){this.gk(this.editBox);this.gk(this.formulaBar)}trigger(){const Ya=this.gridView.Ai,Ga=Ya.textBox.selection;this.onSelectionChange(Ya,{kind:"shortcut",text:Ya.text,start:Ga.index,length:Ga.length})}Oj(Ya){Ya.pse(this.pDf);Ya.vMg(this.oDf)}gk(Ya){null===Ya||void 0===Ya?void 0:Ya.ZWf(this.pDf);null===Ya||void 0===
Ya?void 0:Ya.iij(this.oDf)}onHoverEnter(Ya,Ga){Ga=new Sys.UI.Point(Ga.clientX,Ga.clientY);Ga=b(Ga,Ya.textBox.Ke);if(-1!==Ga)this.onSelectionChange(Ya,{kind:"hover",text:Ya.text,start:Ga,length:0})}onHoverLeave(Ya){this.fJf(Ya)}onSelectionChange(Ya,Ga){this.qEj(Ga)&&(this.cache=Ga,this.callbacks.yFd(Ya,{index:Ga.start,length:Ga.length}),this.telemetry.trigger=Ga.kind)}fJf(Ya,Ga){this.mEj(Ga)&&(this.clearCache(),this.callbacks.MPa(Ya))}qEj(Ya){return!this.cache||!f(this.cache,Ya)}mEj(Ya){return this.cache&&
Ya?"shortcut"!==this.cache.kind||!f(this.cache,Ya):!0}}Object(t.a)(G,"FormulaAssistanceValuePreviewHandler",C,[3]);var J;(function(Ya){Ya[Ya.Failure=0]="Failure";Ya[Ya.Success=1]="Success";Ya[Ya.Error=2]="Error";Ya[Ya.Unavailable=3]="Unavailable"})(J||(J={}));Object(t.b)("ValuePreviewResultKind",J);var L=a(40),P=a(60);class aa{constructor(Ya,Ga){this.$=Ya;this.pluginScheduler=Ga;this.kS=new K(h);this.I3f=new K(h);this.AYi=(da,Z)=>ha=>{if(Object(x.c)(ha.Result))Z("No result");else if(ha=JSON.parse(ha.Result),
Object(x.c)(ha))Z("Failed to deserialize");else if(1!==Object.keys(ha).length)Z("Invalid response");else{for(var Wa in ha)var ca=ha[Wa];Wa=m(ca);Object(x.b)(Wa)?Z(Wa):da(ca)}};this.zYi=da=>()=>{da("Request failed")};this.gridView=Object(r.h)(this.$);if(this.uwb=D.a.SV(this.$))this.formulaAssistanceManager=Ya.da.Aa(464)}get telemetry(){return M.getInstance(this.$)}clearCache(){this.kS.clear();this.I3f.clear()}request(Ya){return Object(n.a)(this,void 0,void 0,function*(){return d(this.kS,Ya,()=>Object(n.a)(this,
void 0,void 0,function*(){const {kind:Ga,payload:da}=yield this.pluginScheduler.getRequester().valuePreview(Ya,this.formulaAssistanceManager?this.formulaAssistanceManager.Hbb:0);if(0!==Ga)return null;if(Object(x.c)(da))return{kind:0};this.telemetry.HPd={origin:"client"};switch(da.kind){case 0:return{kind:0};case 1:case 2:return this.U2j(da);case 3:const Z={text:Ya.text,start:da.start,length:da.length};return this.kS.has(Z)?(this.telemetry.HPd={origin:"server",cached:!0},yield this.kS.get(Z)):Object.assign(Object.assign({},
da),{kind:3,next:()=>this.Nmj(Z,Ya,da.text)})}}))})}U2j(Ya){const Ga=m(Ya.text);return Object(x.b)(Ga)?(u.ULS.sendTraceTag(509871621,1,15,`FormulaAssistanceValuePreviewRequester.validateClientSuccessResult: formula failure:${Ga}, kind:${J[Ya.kind]}`),{kind:0}):Ya}Nmj(Ya,Ga,da){return Object(n.a)(this,void 0,void 0,function*(){return d(this.I3f,Ya,()=>{const Z=new Promise(ha=>Object(n.a)(this,void 0,void 0,function*(){try{const Wa=yield this.s_h(da);this.telemetry.HPd={origin:"server"};ha({kind:1,
text:Wa,start:Ya.start,length:Ya.length})}catch(Wa){u.ULS.sendTraceTag(520495426,1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${Wa}`),ha({kind:0})}}));Z.then(()=>{this.kS.set(Ya,Z);this.kS.set(Ga,Z)}).catch(ha=>{u.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${ha}`)});return Z})})}s_h(Ya){return Object(n.a)(this,void 0,void 0,function*(){return new Promise((Ga,da)=>{const Z={Formula:Ya,
PartialFormula:Ya,SourceRange:Object(L.v)(this.gridView.ha.ra.activeCell,this.$)};U(this.$.pa.xa,Z,this.AYi(Ga,da),this.zYi(da),null,null)})})}}Object(t.a)(aa,"FormulaAssistanceValuePreviewRequester",null,[]);const U=(Ya,Ga,da,Z,ha,Wa,ca=null)=>{ca=Ya.Oa(1,ca);ca.getPartialCalcResultsParameters=Ga;return Object(P.g)(Ya,"GetPartialCalcResults",ca,da,Z,ha,Wa,4)};class K{constructor(Ya){this.t_d=Ya;this.map=new Map}has(Ya){Ya=this.t_d(Ya);return this.map.has(Ya)}get(Ya){Ya=this.t_d(Ya);return this.map.get(Ya)}set(Ya,
Ga){Ya=this.t_d(Ya);this.map.set(Ya,Ga);return this}clear(){this.map.clear()}}Object(t.a)(K,"RequestMap",null,[]);class Y{constructor(Ya,Ga,da,Z){this.$=Ya;this.yFd=(ha,Wa)=>Object(n.a)(this,void 0,void 0,function*(){const ca={text:ha.text,start:Wa.index,length:Wa.length};void this.mQf(ca,this.requester.request.bind(this.requester),ha,0===ca.length)});this.MPa=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.Fy=()=>{this.handler.clearCache();
this.requester.clearCache()};this.gridView=Object(r.h)(this.$);this.control=new S(this.$,da,Z);this.requester=new aa(this.$,Ga);this.handler=new G(this.$,{yFd:this.yFd,MPa:this.MPa});this.Oj()}trigger(){this.handler.trigger()}dispose(){this.gk();this.handler.dispose();this.control.dispose()}Oj(){this.gridView.Vb.Qm(this.reset);this.gridView.ha.sha(this.reset);this.$.ea.PE(this.Fy)}gk(){this.gridView.Vb.fm(this.reset);this.gridView.ha.wna(this.reset);this.$.ea.bE(this.Fy)}mQf(Ya,Ga,da,Z){return Object(n.a)(this,
void 0,void 0,function*(){const ha=Object.assign(Object.assign({},Ya),{ZU:da,lVd:Z});this.dJa=ha;const Wa=yield Ga(Ya);Object(x.c)(Wa)||this.tsi(ha)&&void this.n$h(Wa)})}n$h(Ya){return Object(n.a)(this,void 0,void 0,function*(){const Ga=this.dJa.text,da=this.dJa.ZU,Z=this.dJa.lVd;switch(Ya.kind){case 0:this.hide();break;case 1:case 2:this.show(da,Ya,Z);break;case 3:if(!this.Zui(Ya))break;this.show(da,Ya,Z);void this.mQf({text:Ga,start:Ya.start,length:Ya.length},Ya.next,da,Z);break;default:return Ya}})}show(Ya,
Ga,da){this.dJa=void 0;this.Asi(Ga)&&(this.control.show(Ya,Ga,da),this.Atb=Ga)}hide(){this.control.hide();this.Atb=this.dJa=void 0}tsi(Ya){var Ga;if(Ga=this.dJa)Ga=this.dJa,Ga=Ga.text===Ya.text&&Ga.start===Ya.start&&Ga.length===Ya.length&&Ga.ZU===Ya.ZU&&Ga.lVd===Ya.lVd;return Ga}Asi(Ya){return Object(x.b)(Ya.text)&&""!==Ya.text}Zui(Ya){return!this.Atb||this.Atb.start!==Ya.start||this.Atb.length!==Ya.length||3===this.Atb.kind}}Object(t.a)(Y,"FormulaAssistanceValuePreview",null,[624,3]);var na=a(48),
W=a(37);class X extends w.a{constructor(Ya){super();this.$=Ya;this.Fb()}static la(Ya){Ya.da.Ga(497,new X(Ya))}create(){let Ya=this.$.da.Aa(496);Ya&&this.ob(Ya);const Ga=na.GetServiceTaskFactory.Na(this.$.da,413,414,this.Ya),da=na.GetServiceTaskFactory.Na(this.$.da,448,449,this.Ya),Z=na.GetServiceTaskFactory.Na(this.$.da,19,153,this.Ya),ha=na.GetServiceTaskFactory.Na(this.$.da,211,212,this.Ya);W.TaskExtensions.za(W.TaskExtensions.Ed([Ga,da,Z,ha],this.ka),()=>{Ya=this.$.da.Aa(496);Ya||(Ya=new Y(this.$,
Ga.result,da.result,ha.result),this.$.da.Ga(496,Ya));this.ob(Ya)},this.ka,3)}}Object(t.a)(X,"FormulaAssistanceValuePreviewFactory",w.a,[]);var Aa=a(695),Q=a(184),fa=a(55);class Ca{constructor(Ya,Ga){this.formulaAssistanceValuePreview=Ga;this.gridView=Object(r.h)(Ya)}nc(){return!1}executeCommand(Ya,Ga){Ya=!1;Ga=Ga.command;switch(Ga){case -46938080:this.formulaAssistanceValuePreview.trigger(),Ya=!0}return Ya?fa.Task.Ra(!0):Q.a(Ga)}yc(Ya,Ga){return-46938080===Ga.command}Lc(){return!1}}Object(t.a)(Ca,
"FormulaAssistanceValuePreviewCommandHandler",null,[219]);class ia extends Aa.a{constructor(Ya){super(Ya)}ld(){const Ya=na.GetServiceTaskFactory.Na(this.$.da,496,497,this.Ya);W.TaskExtensions.za(Ya,()=>{this.Zc([new Ca(this.$,Ya.result)])},this.ka)}static la(Ya){Aa.a.Nd(515,new ia(Ya))}}Object(t.a)(ia,"FormulaAssistanceValuePreviewCommandHandlerFactory",Aa.a,[]);a.d(E,"a",function(){return Ra});const Ra=()=>{l.a.Fa(Ya=>{X.la(Ya);ia.la(Ya)})}},1181:function(t,E,a){t=a(0);var c=a(15),b=a(187),e=a(84),
f=a(83),d=a(387),h=a(99),m=a(45);class l{constructor(){this.Lda=this.Y0e=null}}Object(t.a)(l,"GestureAdapterInfo",null,[]);var w=a(4),n=a(377),x=a(228);class r{constructor(){this.yKc=null}Hzi(){if(!this.yKc){var P="hammer.min.js";w.AFrameworkApplication.fa.cq("IsServerFlavorDebug")&&(P=w.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");P=w.AFrameworkApplication.GL(String.format("{0}",P),5);P=x.a.create(P,null,null);n.a.gja(P);this.yKc=P.O9a}return this.yKc}static get instance(){r.Ma||
(r.Ma=new r);return r.Ma}}r.Ma=null;Object(t.a)(r,"HammerJsDependencyLoader",null,[677]);var u=a(14);const v=(P,aa,U=null)=>{if(void 0===aa||null===aa)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let K=null;switch(P){case u.a.pinch:K=new Hammer.Pinch(U);break;case u.a.pan:K=new Hammer.Pan(U)}K&&(K.manager=aa);return K};var B;(function(P){P[P.none=-1]="none";P[P.pinch=0]="pinch";P[P.pan=1]="pan";P[P.swipe=2]="swipe"})(B||(B={}));Object(t.b)("GestureEvent",
B);var z=a(77);class A extends z.a{constructor(P,aa,U,K,Y,na,W,X){super(P,U,K,na);this.Dib=aa;this.Oga=W;this.gY=X;this.kxg=Y}get shiftKey(){return this.Oga}get ctrlKey(){return this.gY}get clientPoint(){return this.Dib}get Gva(){return this.kxg}static create(P,aa,U,K,Y,na){if(U.rawEvent)if(na){var W=U.rawEvent;W=new Sys.UI.Point(W.clientX,W.clientY)}else W=z.a.bxb(U);else W=new Sys.UI.Point(U.clientX,U.clientY);return new A(P,W,aa,U,K,Y,U.shiftKey,U.ctrlKey,na)}}Object(t.a)(A,"GestureEventArgs",
z.a,[]);class y{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(t.a)(y,"GestureManagerData",null,[]);class D{}D.Sqg=2;D.Tqg=4;D.Uqg=8;D.Vqg=8;Object(t.a)(D,
"HammerConstants",null,[]);var I=a(93),M=a(205),T=a(30),S=a(79);class H extends m.a{constructor(P,aa){super();this.Oqa=d.a.DNh;this.ZRc=!!window.PointerEvent;this.jne=window.hasOwnProperty("ontouchstart");this.nXa=this.Slb=null;this.i9=!1;this.xT=new h.a;this.mmb=new h.a;this.lxg=new b.a;this.kqa=null;this.uWa=this.nMc=this.Q7d=this.hJc=this.RPc=this.Jje=this.W7d=this.Onb=!1;this.ulb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.HUc=null;this.Md=I.EventHandlerManager.instance;
this.ZRc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.Slb=Object(e.a)(this,this.Xqc,"onPointerEvent"),this.nXa=u.a.FNh):this.jne?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.Slb=Object(e.a)(this,this.Bza,"onTouchEvent"),this.nXa=u.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.Slb=Object(e.a)(this,this.Iqc,"onMouseEvent"),this.nXa=u.a.ENh);this.Ch=aa;this.Ofa=P;w.AFrameworkApplication.fa&&(this.Onb=w.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),
this.W7d=w.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.Jje=w.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.RPc=w.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.hJc=w.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.Q7d=w.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),this.nMc=w.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.uWa=this.Onb&&w.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&
w.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}WVh(){return this.ZRc?0:this.jne?1:2}Cn(P){super.Cn(P);this.Md.Uka(this.nXa,P,0,this.Slb)}rm(P){super.rm(P);this.Md.rJa(P,this.nXa)}yej(P,aa,U=null){w.AFrameworkApplication.Cjc()?r.instance.Hzi().continueWith(K=>{this.yMj();if(K.Of||K.rh)c.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",K.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",K.status);if(this.Q7d){K=window.Hammer;
if("undefined"===typeof K){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.SBc();return}if("undefined"===typeof K.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.SBc();return}}if(!P)throw this.SBc(),Error.argumentNull("source element can not be null");K=M.a.gwa(P,this.Oqa);if(void 0===K||null===K)K=new h.a,M.a.veb(P,this.Oqa,K),this.zej(P);var Y=null;K.kb(B[0])||(Y=Object.assign(new l,{Lda:v(B[0],this,null),Y0e:aa}),K.add(B[0],Y));if(void 0!==
U&&null!==U)for(let na=0;na<U.length;na++)if(K.kb(B[U[na]])){const W=K.ma(B[U[na]]);Y.Lda.recognizeWith(W.Lda)}}this.SBc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}yMj(){this.nMc&&(this.Ch?this.HUc=this.Ch.Cc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}SBc(){this.nMc&&(this.HUc?this.HUc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}zej(P){this.lxg.add(P);
this.Md.Uka(this.nXa,P,0,this.Slb)}recognize(P){var aa=Array(P.pointers.length);for(var U=0;U<P.pointers.length;U++)aa[U]=P.pointers[U].target;U=null;for(this.kqa=this.qYh(aa);void 0!==this.kqa&&null!==this.kqa&&(U=M.a.gwa(this.kqa,this.Oqa),void 0===U||null===U);this.kqa=this.kqa.parentNode);if(void 0!==U&&null!==U){this.curRecognizer&&this.curRecognizer.state===D.Vqg&&(this.curRecognizer=null);aa=U.keys;for(let K of aa){aa=U.ma(K);void 0!==aa&&null!==aa&&void 0!==aa.Lda&&null!==aa.Lda&&(void 0===
this.curRecognizer||null===this.curRecognizer||aa.Lda===this.curRecognizer||aa.Lda.canRecognizeWith(this.curRecognizer))&&aa.Lda.recognize(P);const Y=aa.Lda.state;this.curRecognizer||D.Sqg!==Y&&D.Tqg!==Y&&D.Uqg!==Y||(this.curRecognizer=aa.Lda)}}}emit(P,aa){if("hammer.input"!==P){this.i9=!1;aa=A.create(P,this.kqa,aa.srcEvent,aa,3,this.ZRc);var U=M.a.gwa(this.kqa,this.Oqa);if(this.qri(P))var K=0;else if(this.gri(P))K=1;else if(this.nui(P))K=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:U}=U.Ec(B[K]));void 0!==U&&null!==U&&((U=U.Y0e,U.Noi())?P.endsWith("start")?this.i9=U.LRi(aa):P.endsWith("end")?(U.JRi(aa),this.i9=!0):P.endsWith("cancel")?(U.IRi(aa),this.i9=!0):P.endsWith("move")&&(this.i9=U.KRi(aa)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",P))}}get(P){return Object(f.a)(Hammer.Recognizer,P)}qYh(P){if(1>P.length)return null;if(1===P.length)return P[0];var aa=P[0],U=!0;for(let K=1;K<P.length;K++){if(!P[K])return null;if(aa!==P[K]){U=
!1;break}}if(U)return aa;aa=this.r1e(P[0]);U=0;for(const K of P){P=this.r1e(K);if(aa.ma(aa.count-1)!==P.ma(P.count-1))return null;for(let Y=aa.count-2,na=P.count-2;Y>=U&&0<=na;Y--,na--)if(aa.ma(Y)!==P.ma(na)){U=Y+1;break}}return aa.ma(U)}r1e(P){const aa=new b.a;for(;void 0!==P&&null!==P;P=P.parentNode)aa.add(P);return aa}g5e(P){switch(P){case u.a.uf:case u.a.F$:return 1;case u.a.$f:case u.a.Rha:return 2;case u.a.we:case u.a.JHa:return 4;case u.a.ADc:case u.a.N0c:return 8}return 0}Bza(P,aa,U){P=this.g5e(P);
aa=this.WWh(U);Hammer.inputHandler(this,P,aa);this.i9&&U.preventDefault();return this.i9}ybf(){return 1<this.xT.count}W3b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Onb)for(let P of this.xT)this.YVf(P.key);else this.xT=new h.a;this.session=null}TJg(P,aa,U){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",P);if(!this.mmb.kb(P)){try{aa.setPointerCapture(P)}catch(K){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",K)}this.mmb.add(P,
aa)}this.xT.ia(P,U);this.uWa&&1<this.xT.count&&this.Ofa&&!this.Ofa.urb&&(this.Ofa.urb=!0)}YVf(P){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",P);if(this.mmb.kb(P)){try{this.mmb.ma(P).releasePointerCapture(P)}catch(aa){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",aa)}this.mmb.remove(P)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",P);this.xT.remove(P);this.uWa&&1>=this.xT.count&&this.Ofa&&this.Ofa.urb&&
(this.Ofa.urb=!1)}Xqc(P,aa,U){var K=U.rawEvent.pointerType.toString();const Y=U.rawEvent.pointerId.toString();if("touch"!==K)return!1;P=this.g5e(P);if(1!==P&&!this.xT.kb(Y))return!1;this.W7d&&1===P&&U.rawEvent.isPrimary&&this.xT.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.W3b());this.Onb?this.TJg(Y,aa,U):this.xT.ia(Y,U);this.RPc&&2===P&&(!this.hJc||this.hJc&&"function"===typeof U.rawEvent.getCoalescedEvents)&&(aa=U.rawEvent.getCoalescedEvents())&&this.ybf()&&
(this.ulb=Math.max(this.ulb,aa.length));this.Jje&&(this.i9=!1);K=this.VWh(this.xT,U,K);Hammer.inputHandler(this,P,K);if(4===P||8===P)this.Onb?this.YVf(Y):this.xT.remove(Y),this.xT.count||(this.session=null,this.RPc&&-1!==this.ulb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.ulb),this.ulb=-1));this.i9&&U.preventDefault();return this.i9}Iqc(){return!1}WWh(P){const aa=new y;var U=P.rawEvent;const K=U.touches;U=U.changedTouches;aa.pointers=Array.clone(K);aa.pointers=
Array.clone(0<K.length?K:U);aa.changedPointers=Array.clone(U);aa.srcEvent=P;aa.pointerType="touch";return aa}VWh(P,aa,U){const K=new y;K.pointers=S.toArray(P.values);K.changedPointers=[aa];K.pointerType=U;K.srcEvent=aa;return K}qri(P){return T.a.startsWith(P,u.a.pinch)}gri(P){return T.a.startsWith(P,u.a.pan)}nui(P){return T.a.startsWith(P,u.a.swipe)}}Object(t.a)(H,"GestureInputManager",m.a,[627,628]);var C=a(277),G=a(249);class J{constructor(){this.$a=null;this.yx=!1}get name(){return"Common.App.GestureInputManager"}Oh(P){P.register(H,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").wc().Ac(()=>new H(C.a.instance,w.AFrameworkApplication.ta.kE));this.$a=P}init(){this.yx||(this.$a.resolve("Common.App.GestureManager.GestureInputManager"),this.yx=!0)}dispose(){}static main(){G.a.instance.vi(new J)}}Object(t.a)(J,"GestureInputManagerPackage",null,[4,5]);a.d(E,"a",function(){return L});const L=()=>{Type.registerNamespace("Common.App.GestureManager");J.main()}},1192:function(t,E,a){var c=a(9);t=a(0);
var b=a(222),e=a(27),f=a(89),d=a(30),h=a(419),m=a(238);class l{}l.Nvh="ewa-dv";l.Ovh="ewa-dv-buttonarea";l.fvh="ewa-dlb";l.SDb="list-table";l.listItem="list-item";l.PDb="list-item-selected";l.TDb="list-table-touch";l.Mvh="ewa-dpb";l.qqh="dv-prompt-title";l.pqh="dv-prompt-message";Object(t.a)(l,"CssClassNames",null,[]);var w=a(31),n=a(735),x=a(19),r=a(50),u=a(429),v=a(76),B=a(7),z=a(15),A=a(154),y=a(823),D=a(37),I=a(13),M=a(21),T=a(263),S=a(68);class H extends A.ErrorDialog{constructor(ib,La,db){super(ib,
H.VQ(La,ib,db));this.Pc=()=>{this.setFocus()};M.h(this.$).ha.hH(this.Pc);(ib=ib.da.Aa(14).h5a(db))&&ib.options&1&&z.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){M.h(this.$).ha.kG(this.Pc);super.dispose()}setFocus(){switch(this.error.Severity){case 0:var ib=4;break;case 1:ib=3;break;case 2:ib=0;break;default:ib=this.WM}(ib=this.getButton(ib))?ib.get_element().focus():super.setFocus()}osb(){const ib=
M.h(this.$);ib.gb&&ib.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.VXd(1);if(2===this.returnValue||0===this.returnValue){const La=ib.Ub(null);if(La){ib.Da.QV();const db=Object(B.a)(new T.a,{Text:La.originalText});ib.setCell(db,La.range,0,63,null)}this.$.Xc(-798660877,v.a.Db,8,null)}super.osb()}fta(){const ib=M.h(this.$);ib.gb&&ib.Vb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.VXd(0);super.fta()}VXd(ib){const La=
M.h(this.$);D.TaskExtensions.za(La.startEdit(!1,ib),()=>{const db=La.Vb.textBox;db.text&&db.selectRange(0,db.text.length)},this.ka,11,S.a.current)}static VQ(ib,La,db){db=La.da.Aa(14).h5a(db);ib.MessageId=-1083021405;ib.MessageIdName="DataValidationError";ib.MessageIdHash=d.a.sw(ib.MessageIdName);ib.Severity=db?db.abd:1;La=(null===db||void 0===db?0:db.aKa)?d.a.rg(db.aKa):null;db=(null===db||void 0===db?0:db.error)?d.a.rg(db.error):String.format("<p>{0}</p><p>{1}</p>",I.a.instance.ga(895),I.a.instance.ga(896));
switch(ib.Severity){case 0:ib.Appearance=18;break;case 1:ib.Appearance=12;db+=String.format("<p>{0}</p>",I.a.instance.ga(897));break;default:ib.Appearance=3}ib.Caption=La;ib.Description=db;ib.HelpDescription=I.a.instance.ga(1315);ib.HelpTopicId=y.a.vLe;return ib}}Object(t.a)(H,"DataValidationErrorDeprecatedDialog",A.ErrorDialog,[]);A=a(285);var C=a(1086),G=a(5),J=a(40),L=a(284),P=a(192),aa=a(52),U=a(29),K=a(283),Y=a(1),na=a(11),W=a(282),X=a(159);class Aa extends A.a{constructor(ib,La,db){super(ib);
this.fV=this.Pq=null;this.Emf=!1;this.FX=this.Rm=this.Ocf=this.errorMessage=null;this.wLe=Ab=>{const Mb=this.$;var pb=this.Emf;this.hide();const Qb=M.h(Mb);Qb.gb&&Qb.Vb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Ab&&pb&&D.TaskExtensions.za(Qb.startEdit(!1,1),()=>{const xb=Qb.Vb.textBox;xb.text&&xb.selectRange(0,xb.text.length)},this.ka,11,S.a.current);if(1===Ab&&!pb){if(pb=Qb.Ub(null)){Qb.Da.QV();const xb=Object(B.a)(new T.a,{Text:pb.cell.userInput});Qb.setCell(xb,
pb.range,0,63,null)}Mb.Xc(-798660877,v.a.Db,8,null)}2===Ab&&D.TaskExtensions.za(Qb.startEdit(!1,0),()=>{const xb=Qb.Vb.textBox;xb.text&&xb.selectRange(0,xb.text.length)},this.ka,11,S.a.current)};this.rEd=()=>{na.HelperMethods.vW(this.$.GG,this.error.HelpTopicId,this.$.WS)};this.DTi=()=>{this.vzb();this.$.Xc(802602464,2,8,this.fV)};this.ZRi=()=>{z.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.$Ri=
Ab=>{!Ab||K.a(Ab)?z.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Ab=this.b2h(Ab.Result),this.Pq.errorInformation=Ab,this.kVa(this.aKa,this.Q5a(this.wLe),this.Pq))};this.ZDd=()=>{this.show(this.lUb)};this.IRe=db;this.sqmManager=X.a(this.$);this.error=Aa.VQ(La,ib,db);this.rb.pp=this;this.aKa=(this.xv=ib.da.Aa(14).h5a(this.IRe))&&this.xv.aKa?this.xv.aKa:I.a.instance.ga(1727);this.Xwj();this.initializeAndShow(this.aKa,
this.wLe,this.Pq)}get pc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.pp&&(this.rb.pp=null);f.a.Ia(this.Rm);this.Rm=null;super.dispose()}Xwj(){this.xv&&this.xv.error?this.errorMessage=this.xv.error:this.xv&&this.xv.options&1?(z.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=I.a.instance.ga(1729),this.Ocf=aa.a.current.io(120)):(this.errorMessage=I.a.instance.ga(1728),this.RSh(this.IRe));var ib=
this.xv?this.xv.abd:1;this.Pq={[Aa.yu]:this.pc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.Ocf};switch(ib){case 0:this.Tb=1;this.qc(1,"Retry");this.Pq.dialogIcon=2;this.Emf=!0;break;case 1:this.Tb=4;this.Pq.dialogIcon=1;this.Pq.additionalInformation=I.a.instance.ga(897);break;default:this.Tb=1,this.Pq.dialogIcon=3}this.Pq.helpLink={["type"]:"AppLinkProps",[Aa.yu]:this.error.HelpTopicId,["text"]:I.a.instance.ga(1315),["handler"]:this.rEd};ib=U.a.XZc([this.error]);this.fV={[G.a.Lac]:!0,
[G.a.jdd]:ib,[G.a.kdd]:X.a(this.$).cvb(this.error.MessageIdHash),[G.a.LQ]:this.pc,["DismissHandler"]:this.ZDd};this.Pq.giveFeedbackLink={["type"]:"AppLinkProps",[Aa.yu]:G.a.kld,["text"]:I.a.instance.ga(1766),["handler"]:this.DTi}}RSh(ib){const La=this.$.pa.xa.Wb();L.g(this.$.pa.xa,J.q(ib,this.$),W.b(this.$Ri),W.a(this.ZRi),null,La)}b2h(ib){let La;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7253041_adddatavalidationerrortypetelemetry");z.ULS.sendTraceTag(509732815,0,50,`DataValidationErrorDialog.getRuleDescriptionString: The data validation error is because of ${C.a[ib.RuleType].toString()}`);
switch(ib.RuleType){case 1:switch(ib.ConditionType){case 0:return La=I.a.instance.mb(108),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=I.a.instance.mb(109),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=I.a.instance.mb(110),String.format(La,ib.LowerBoundary);case 3:return La=I.a.instance.mb(111),String.format(La,ib.LowerBoundary);case 4:return La=I.a.instance.mb(112),String.format(La,ib.LowerBoundary);case 5:return La=I.a.instance.mb(113),String.format(La,
ib.UpperBoundary);case 6:return La=I.a.instance.mb(114),String.format(La,ib.LowerBoundary);case 7:return La=I.a.instance.mb(115),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(ib.ConditionType){case 0:return La=I.a.instance.mb(116),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=I.a.instance.mb(117),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=I.a.instance.mb(118),String.format(La,ib.LowerBoundary);case 3:return La=
I.a.instance.mb(119),String.format(La,ib.LowerBoundary);case 4:return La=I.a.instance.mb(120),String.format(La,ib.LowerBoundary);case 5:return La=I.a.instance.mb(121),String.format(La,ib.UpperBoundary);case 6:return La=I.a.instance.mb(122),String.format(La,ib.LowerBoundary);case 7:return La=I.a.instance.mb(123),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(ib.ConditionType){case 0:return La=I.a.instance.mb(124),String.format(La,ib.LowerBoundary,ib.UpperBoundary);
case 1:return La=I.a.instance.mb(125),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=I.a.instance.mb(126),String.format(La,ib.LowerBoundary);case 3:return La=I.a.instance.mb(127),String.format(La,ib.LowerBoundary);case 4:return La=I.a.instance.mb(128),String.format(La,ib.LowerBoundary);case 5:return La=I.a.instance.mb(129),String.format(La,ib.UpperBoundary);case 6:return La=I.a.instance.mb(130),String.format(La,ib.LowerBoundary);case 7:return La=I.a.instance.mb(131),String.format(La,
ib.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(ib.ConditionType){case 0:return La=I.a.instance.mb(132),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=I.a.instance.mb(133),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=I.a.instance.mb(134),String.format(La,ib.LowerBoundary);case 3:return La=I.a.instance.mb(135),String.format(La,ib.LowerBoundary);case 4:return La=I.a.instance.mb(136),String.format(La,ib.LowerBoundary);case 5:return La=
I.a.instance.mb(137),String.format(La,ib.UpperBoundary);case 6:return La=I.a.instance.mb(138),String.format(La,ib.LowerBoundary);case 7:return La=I.a.instance.mb(139),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(ib.ConditionType){case 0:return La=I.a.instance.mb(140),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=I.a.instance.mb(141),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=I.a.instance.mb(142),String.format(La,
ib.LowerBoundary);case 3:return La=I.a.instance.mb(143),String.format(La,ib.LowerBoundary);case 4:return La=I.a.instance.mb(144),String.format(La,ib.LowerBoundary);case 5:return La=I.a.instance.mb(145),String.format(La,ib.UpperBoundary);case 6:return La=I.a.instance.mb(146),String.format(La,ib.LowerBoundary);case 7:return La=I.a.instance.mb(147),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 3:return La=I.a.instance.mb(106),String.format(La,ib.LowerBoundary);case 7:return La=
I.a.instance.mb(107),String.format(La,ib.LowerBoundary);default:return"we couldn't get the details"}}VXd(ib){const La=M.h(this.$);D.TaskExtensions.za(La.startEdit(!1,ib),()=>{const db=La.Vb.textBox;db.text&&db.selectRange(0,db.text.length)},this.ka,11,S.a.current)}get ka(){this.Rm=this.Rm||new P.a;return this.Rm.token}static VQ(ib,La,db){La=La.da.Aa(14).h5a(db);ib.MessageId=-1083021405;ib.MessageIdName="DataValidationError";ib.MessageIdHash=d.a.sw(ib.MessageIdName);ib.Severity=La?La.abd:1;ib.HelpDescription=
I.a.instance.ga(1315);ib.HelpTopicId=y.a.vLe;return ib}}Object(t.a)(Aa,"DataValidationErrorDialog",A.a,[99,100,3,101]);A=a(914);var Q=a(385);class fa extends A.a{constructor(ib,La,db){super(ib,La);this.dataValidationControl=db}get TAb(){return Object(h.a)(Aa,this.$.rb.dh)}get LK(){return this.dataValidationControl.te}set LK(ib){this.dataValidationControl.te=ib}get Y6a(){return!1}get key(){return Q.a.F8c}dispose(){this.dataValidationControl=null;super.dispose()}Yh(ib,La){this.dataValidationControl.eb=
this.eb;const db=ib.keyCode;return 1461300262!==La||16!==db&&17!==db&&18!==db?super.Yh(ib,La):!1}gDd(){this.LK&&(this.dataValidationControl.eb=this.eb,this.dataValidationControl.show(this.dataValidationControl.RN,!0,!0,e.a.Hp||3===v.a.Db))}jg(){}Th(){this.dataValidationControl.show(this.dataValidationControl.RN,!0,!0,e.a.Hp||3===v.a.Db)}KJd(ib,La){return this.dataValidationControl.Yh(La)}}Object(t.a)(fa,"DataValidationListAutoCompleteBehavior",A.a,[]);var Ca=a(264);A=a(840);var ia=a(12),Ra=a(117),
Ya=a(22),Ga=a(913);class da extends A.a{constructor(ib,La,db,Ab){super(ib,La,new Ga.a(l.listItem,l.PDb,l.SDb,l.TDb));this.mJa=this.jW=this.lea=this.ie=this.$mb=null;this.NOa=0;this.LHb=[];this.ZYj=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.htmlSanitizationHelper=null;this.RDb=db;this.htmlSanitizationHelper=Ab}get Rj(){return this.$mb}set Rj(ib){this.kCa(this.$mb);if(ib){this.$mb=ib;this.RDb.innerText="";this.kCa(this.$mb);const La=this.LHb[ib.rowIndex];
this.ie=this.jW[La];this.mJa&&(this.lea=this.mJa[La],z.ULS.shipAssertTag(537163286,0,!this.LHb.length||!!this.lea,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.RDb.innerText=this.ie;this.Rxc(ib)}else this.lea=this.ie=null}get gb(){return M.h(this.$).gb}get editText(){return M.h(this.$).Vb.text}dispose(){super.dispose();this.RDb=this.$mb=null}bfa(ib,La,db,Ab){if(ib&&(!ib||ib.length)){this.d8(!1);this.mJa=ib;this.jW=[];for(var Mb=0;Mb<ib.length;Mb++)this.jW[Mb]=
ib[Mb]?ib[Mb].Name:null;Mb=`<table class='${this.k6}' aria-live='polite'><tbody>`;var pb="",Qb="";ib=0;var xb=M.h(this.$).Ub(null);Ab=this.gb?Ab?Ab.text:this.editText:xb?xb.originalText:null;xb=!Ab;var pa=0;this.LHb.length=0;var Ma=[],ya=[],Ea=[],Na=Ab?Ab.split(" "):[""];Ab=Ab.trim();for(let lb=0;lb<this.jW.length;lb++){const oa=this.jW[lb];var kb=void 0;const Ba=oa.split(" ");kb=Ca.a.all(Na,Jb=>Ca.a.any(Ba,Yb=>Ya.a.$I(Yb,Jb)));const sa=!oa,qb=Ea.includes(oa);sa||qb||this.gb&&!kb||(kb=oa?d.a.rg(d.a.gad(oa)):
"",kb=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.iW,kb),Ea.push(oa),this.gb&&Ya.a.$I(oa,Ab)?(pb+=kb,Ma.push(lb)):(Qb+=kb,ya.push(lb)),!xb&&Ya.a.equals(Ab,oa,!0)&&(ib=this.gb?Ma.length-1:pa,xb=!0),pa++)}this.NOa=pa;this.LHb.push(...Ma);this.LHb.push(...ya);Mb+=pb+Qb+"</tbody></table>";Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126089_ReduceInnerHTMLUsageForDataValidationListBox")&&this.htmlSanitizationHelper?
this.htmlSanitizationHelper.ni(this.Lf,Mb):this.Lf.innerHTML=Mb;Mb=this.Hn=ia.DOMElementExtensions.nk(this.domElement,this.k6);this.Iob(Mb,La);this.d8(!0);this.zsa(La,db);this.Rj=0<this.NOa?Mb.rows[ib]:null}}WSa(ib){var La=!1;this.gb&&ib&&(La=!this.NOa,ib.endEdit(La,"DataValidationListBox.SetCellContent",0));if(!La&&(ib=M.h(this.$),La=ib.Ub(null))){let Ab=null;if(this.lea&&-1!==this.lea.SheetId&&-1!==this.lea.Row&&-1!==this.lea.Column){var db={};db.SheetName=this.lea.SheetId.toString();db.FirstRow=
this.lea.Row;db.FirstColumn=this.lea.Column;Ab={ParameterType:6};Ab.SourceRange=db}db=Object(B.a)(new T.a,{Text:this.ie});ib.setCell(db,La.range,0,63,Ab)}return!0}zsa(ib,La){const db=ib?this.KEb:this.rI;ib=ib?this.wmc:this.xmc;0>=this.NOa?this.Lf.style.height=na.HelperMethods.uc(ib):(this.Lf.style.height="auto",this.NOa>db?(ia.DOMElementExtensions.gJ(this.Lf,this.ZYj?Math.floor(ib*db):Math.floor(this.Lf.offsetHeight*db/this.NOa)),this.Lf.style.overflowY="auto"):(this.Lf.style.height="auto",this.Lf.style.overflowY=
"hidden"));ia.DOMElementExtensions.Zv(this.Lf,La);ia.DOMElementExtensions.Zv(this.Hn,La-(this.NOa>db?Ra.a.Tu:0))}}Object(t.a)(da,"DataValidationListBox",A.a,[]);var Z=a(113),ha=a(252),Wa=a(255),ca=a(1095);const ja=`<p class='${l.qqh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,ua=`<p class='${l.pqh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var Za=x.a.gTe,Pa=x.a.gTe,ka=x.a.M5g;class ra extends m.a{constructor(ib,La){super(document.createElement("div"));this.v3b=
this.aR=this.zR=!1;this.ai=this.Rh=null;this.ani=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.bni=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.zqd=this.rtd=this.ysd=!1;this.$7b=[];this.htmlSanitizationHelper=null;this.Sh=()=>{this.Y9f(!1)};this.ZPa=(db,Ab)=>{this.show(this.RN,!this.te,!0,e.a.Hp||3===Ab.tb||3===v.a.Db);this.LDd(null,null)};this.LDd=()=>{this.gridView.setFocus()};this.OMa=()=>{this.eb.textBox.HF=
!0};this.Tt=()=>{this.pkg()};this.onContentReady=()=>{this.Y9f(this.te)};this.xc=()=>{this.ty()};this.yza=()=>{this.WSa()};this.gDf=()=>{this.pkg()};this.$=ib;this.gridView=M.h(this.$);this.oJ=this.gridView.Vb;this.htmlSanitizationHelper=La;La="<div id='dv_reader_description' class='"+w.a.xTe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+l.Ovh+" "+x.a.Co+"'></div>\r\n<div id='dv_list_box' class='"+l.fvh+" "+x.a.Do+" "+x.a.Co+"'></div>\r\n<div id='dv_prompt_box' class='"+
l.Mvh+" "+x.a.Co+"'></div>";this.domElement.className=l.Nvh;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126086_ReduceInnerHTMLUsageForDataValidationControl")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(this.domElement,La):this.domElement.innerHTML=La;ha.d(this.style,this.isGridRtl);this.Lf=$get("dv_list_box",this.domElement);this.PW=$get("dv_prompt_box",this.domElement);this.$sa=$get("dv_list_button",this.domElement);
this.RDb=$get("dv_reader_description",this.domElement);(La=Z.a(ib))&&this.$7b.push(new fa(ib,La,this));this.$7b.push(new fa(ib,this.gridView.Vb,this));this.gridView.ha.fH(this.Sh);this.gridView.pv(this.onContentReady);this.gridView.jc.IMg(this.gDf);this.$.xj(this.xc);La=this.gridView.zj;La.insertBefore(this.domElement,La.firstChild);this.onContentReady(null,null);ib.da.Ga(14,this)}get zCb(){return!!(this.$.qd&16)}get Yui(){return this.te||this.RN||this.kxa}get te(){return ia.DOMElementExtensions.isVisible(this.Lf)}set te(ib){ia.DOMElementExtensions.setVisible(this.Lf,
ib)}get RN(){return ia.DOMElementExtensions.isVisible(this.PW)}set RN(ib){ia.DOMElementExtensions.setVisible(this.PW,ib)}get kxa(){return ia.DOMElementExtensions.isVisible(this.$sa)&&!!this.Rh&&ia.DOMElementExtensions.isVisible(this.Rh.domElement)}set kxa(ib){ia.DOMElementExtensions.setVisible(this.$sa,ib);this.Rh&&ia.DOMElementExtensions.setVisible(this.Rh.domElement,ib)}get eb(){return this.oJ}set eb(ib){this.oJ=ib}get r6a(){return!!this.activeCell&&this.g$c(this.activeCell.range)}get activeCell(){return this.gridView.Ub(null)}get icf(){return this.r6a&&
!!this.xv&&!!(this.xv.options&2)&&!!this.xv.prompt}get Uyb(){return this.r6a&&!!this.xv&&!!(this.xv.options&1)}get isGridRtl(){return this.gridView.rtl}get xv(){return this.h5a(this.activeCell.range)}get HPa(){const ib=this.activeCell;return ib?this.hwa(this.gridView,ib):null}dispose(){this.$&&(this.ePb(!1),this.gridView.ha.tL(this.Sh),this.gridView.Ny(this.onContentReady),this.gridView.jc.vij(this.gDf),this.$.tl(this.xc));this.JJe(!1);this.KJe(!1);f.a.rc(this.$7b);this.$7b=this.$sa=this.Lf=this.PW=
this.oJ=this.gridView=this.$=null;super.dispose()}g$c(ib){return!!this.h5a(ib)}$sb(ib,La){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new Aa(this.$,ib,La):new H(this.$,ib,La)}h5a(ib){ib=this.gridView.getRangeInformation(ib);for(let La=0;La<ib.length;La++){const db=ib[La];if(Object(h.a)(u.DataValidationRange,db))return db}return null}ROh(){if(!this.r6a)return"";const ib=this.icf?`${this.xv.zQf} ${this.xv.prompt}`:"",La=this.Uyb?I.a.instance.ga(842):
"";return String.format(I.a.instance.mb(17),ib,La)}Yh(ib){let La=!1;if(this.te||(-569786022===ib||541421805===ib)&&this.Uyb||1872288872===ib&&this.RN)switch(ib){case -569786022:case 541421805:this.show(this.RN,!this.te,!0,e.a.Hp||3===v.a.Db);La=!0;break;case 1872288872:this.te?(this.show(this.RN,!1,!0,!1),La=!0):this.RN?(this.show(!1,!1,!0,!1),La=!0):this.eb&&(this.eb.endEdit(!1,"DataValidationControl.HandleKeyDown",0),La=!0);break;case -798660877:this.ai.BB(1);La=!0;break;case 137938150:this.ai.BB(-1);
La=!0;break;case 2091832999:this.ai.BB(this.ai.rI-1);La=!0;break;case 742457698:this.ai.BB(-(this.ai.rI-1));La=!0;break;case 125627505:case 267796030:La=this.WSa()}return La}show(ib,La,db,Ab){this.ty();if(this.zCb&&this.r6a){var Mb=this.HPa;if(Mb){if(ib||La||db)this.isVisible=!0;ha.d(this.style,this.isGridRtl);db&&this.Uyb&&(this.KJe(!0),this.gkg(Mb,!1));La&&this.Uyb&&this.LTa(Ab,Mb);ib&&this.icf&&this.HIj(Mb);this.Yui||(this.isVisible=!1)}}}hwa(ib,La){if(!La||!La.cell.Qk)return null;var db=this.gridView.jc.textBox.domElement;
var Ab=0<ia.DOMElementExtensions.getHeight(db)&&0<ia.DOMElementExtensions.getWidth(db)&&0<=db.offsetTop&&0<=db.offsetLeft;if(Ab)db=ia.DOMElementExtensions.hwa(db,ib.zj);else{db=ib.getCellBounds(La.cell);var Mb=ia.DOMElementExtensions.getBoundingClientRect(ib.zj);db=new Sys.UI.Bounds(db.x-Mb.x,db.y-Mb.y,db.width,db.height)}if(db)if(Ab)2<db.height&&2<db.height&&(db.x+=1,db.y+=1,db.height-=2,db.width-=2);else if(Ab=M.h(this.$).sK(La.cell))Ab=Ab.width+1,Mb=Ya.a.equals(Wa.a.gxb(La.cell,ib.rtl),"right",
!0),ib.rtl&&Mb&&(db.x=db.x+db.width-Ab),La.Gla&&ib.rtl===Mb&&(db.width=Ab);else return null;return db}Y9f(ib){const La=this.r6a;this.ePb(La);La?this.show(!0,ib,!0,!1):this.ty()}WSa(){let ib=!1;this.te&&(ib=this.ai.WSa(this.eb),this.show(this.RN,!1,!0,!1));return ib}ty(){this.ani?(this.te&&(this.te=!1),this.kxa&&(this.kxa=!1),this.RN&&(this.RN=!1),this.isVisible&&(this.isVisible=!1)):this.te=this.kxa=this.RN=this.isVisible=!1;this.ysd=this.zqd=this.rtd=!1}LTa(ib,La){this.Uyb&&!this.xv.mJa?this.kxa&&
this.Rh.disable():(this.JJe(!0),this.ai.bfa(this.xv.mJa,ib,this.bYh(La),this.eb),this.DCa(La,!1))}HIj(ib){this.xv.prompt&&(this.RN=!0,this.R_j(this.xv.zQf,this.xv.prompt),this.Akg(ib,!1))}gkg(ib,La){const db=ib.y;this.$sa.style.top=na.HelperMethods.uc(db);ib=this.isGridRtl?ib.x-this.$sa.offsetWidth+1:ib.x+ib.width+1;this.$sa.style.left=na.HelperMethods.uc(ib);La?this.kxa=this.gridView.flc(new r.a(ib,db))&&this.zqd:this.zqd=!0}DCa(ib,La){const db=ib.y+ib.height;ib=this.isGridRtl?ib.x+ib.width-this.Lf.offsetWidth:
ib.x;this.Lf.style.top=na.HelperMethods.uc(db);this.Lf.style.left=na.HelperMethods.uc(ib);La?this.te=this.gridView.flc(new r.a(ib,db))&&this.ysd:this.ysd=!0}Akg(ib,La){const db=ib.y+ib.height+5;var Ab=this.activeCell;Ab=Ab?Ab.width/2:32;ib=this.isGridRtl?ib.x-this.PW.offsetWidth+Ab:ib.x+ib.width-Ab;this.PW.style.top=na.HelperMethods.uc(db);this.PW.style.left=na.HelperMethods.uc(ib);La?this.RN=this.gridView.flc(new r.a(ib,db))&&this.rtd:this.rtd=!0}R_j(ib,La){if(La){var db="";ib&&(db+=String.format(ja,
d.a.rg(ib)));db+=String.format(ua,d.a.rg(La));Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl2")&&this.htmlSanitizationHelper?this.htmlSanitizationHelper.ni(this.PW,db):this.PW.innerHTML=db;ib=ia.DOMElementExtensions.nk(this.PW,"dv-prompt-titletext");if(La=ia.DOMElementExtensions.nk(this.PW,"dv-prompt-messagetext")){ib=ib?parseInt(String(Math.max(ib.offsetWidth,La.offsetWidth)),
10):La.offsetWidth;ib+=6;ia.DOMElementExtensions.Zv(this.PW,ib);for(let Ab=0,Mb=this.PW.children.length;Ab<Mb;Ab++)ia.DOMElementExtensions.Zv(this.PW.children[Ab],ib)}}}bYh(ib){return this.bni?ib.width+17-2+1:ib.width+this.$sa.clientWidth-2+1}KJe(ib){this.$&&!this.zCb||!ib?(this.edg(!1),f.a.Ia(this.Rh),this.Rh=null):(this.Rh||(this.Rh=new ca.a(this.$sa,Za,n.a.Kia,1,Pa,I.a.instance.ga(894),ka,I.a.instance.ga(893),"",-1),this.edg(!0)),this.kxa=!0,this.xv.mJa?this.Rh.isEnabled||this.Rh.enable():this.Rh.disable())}JJe(ib){this.$&&
!this.zCb||!ib?(this.sUa(!1),f.a.Ia(this.ai),this.ai=null):(this.ai||(this.ai=new da(this.$,this.Lf,this.RDb,this.htmlSanitizationHelper),this.sUa(!0)),this.te=!0)}sUa(ib){this.ai&&(ib&&!this.zR?(this.ai.f$(this.LDd),this.ai.M0b(this.OMa),this.ai.dpb(this.yza),this.zR=!0):!ib&&this.zR&&(this.ai.Wda(this.LDd),this.ai.Hvc(this.OMa),this.ai.KKb(this.yza),this.zR=!1))}ePb(ib){ib&&!this.aR?(this.gridView.view.qt(this.Tt),this.aR=!0):!ib&&this.aR&&(this.gridView.view.fr(this.Tt),this.aR=!1)}edg(ib){this.Rh&&
(ib&&!this.v3b?(this.Rh.$Xc(this.ZPa),this.Rh.lYc(this.ZPa),this.Rh.Pob(this.OMa),this.v3b=!0):!ib&&this.v3b&&(this.Rh.cNd(this.ZPa),this.Rh.oNd(this.ZPa),this.Rh.vKb(this.OMa),this.v3b=!1))}pkg(){if(this.r6a){var ib=this.HPa;ib&&(this.gkg(ib,!0),this.DCa(ib,!0),this.Akg(ib,!0))}}}Object(t.a)(ra,"DataValidationControl",m.a,[623,3]);var ba=a(48),Ua=a(55);class Ka extends b.a{constructor(ib){super();this.$=ib;this.Fb()}create(){const ib=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7126087_ReduceInnerHTMLUsageForDataValidationControl")?ba.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):Ua.Task.Ra(null);D.TaskExtensions.za(ib,()=>{this.ob(this.$.da.Aa(14)||new ra(this.$,ib.result))},this.ka,3)}}Object(t.a)(Ka,"DataValidationControlFactory",b.a,[]);a.d(E,"a",function(){return Oa});const Oa=()=>{c.a.Fa(ib=>{ib.da.Ga(150,new Ka(ib))})}},1217:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(187);const f={selectByArrowKeyCounter:0,
selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},d={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},h={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,
argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0,argumentAssistanceCardIsInitialModeDefault:!1},m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},l={parenthesesCouplingCounter:0,formulaHighlightsCounter:0},w={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,
argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},n={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0,parenthesesCouplingFlight:void 0,coloredReferencesFlight:void 0};var x;(function(C){C.RenderDown="rd";C.RenderUp="ru";C.Expand="e";C.Collapse=
"c";C.Drag="d";C.Move="m";C.GiveFeedback="gf";C.InitialModeExpanded="ie";C.InitialModeCollapsed="ic";C.LearnMore="lm"})(x||(x={}));Object(t.b)("argumentAssistanceUsageActions",x);var r=a(58),u=a(1096),v=a(1),B=a(22),z=a(41),A=a(21),y=a(99),D;(function(C){C[C.function=3]="function";C[C.namedRange=100]="namedRange";C[C.tableHeader=101]="tableHeader";C[C.letVariable=102]="letVariable";C[C.richEntity=103]="richEntity";C[C.lambda=104]="lambda";C[C.customFunction=105]="customFunction";C[C.table=106]="table";
C[C.tableSpecialStructRef=107]="tableSpecialStructRef";C[C.richEntityEmptyCellRef=108]="richEntityEmptyCellRef";C[C.rangeRef=109]="rangeRef"})(D||(D={}));Object(t.b)("CompletionItemKind",D);var I=a(33);const M={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,
170,200],["tryUpdateHighlightsFromCellContentEditor"]:[50,80,100,130,150,170,200]};class T{constructor(C){this.$=C;this.lI=null;this.yDb=-1;this.dmc=null;this.fmc=0;this.$P=Object.assign({},h);this.qK=Object.assign({},m);this.OJ=Object.assign({},f);this.uqb=Object.assign({},d);this.Rbc=Object.assign({},l);this.vX=Object.assign({},n);this.vqb={};this.F4a=Object.assign(Object.assign({},w),{isReactDialog:I.a.vlf()});this.Rpb=[];this.qHa=v.EwaSettings.isChangeGateEnabled("OfficeVSO:7376612_argumentAssistanceOrderedActionsTelemetry");
this.jg=(G,J)=>{null!=this.lI&&(1==Math.abs(this.yDb-this.$.ea.ye)&&(G=this.$.va.na.sheetId,J.rsb&&J.lk.equals(this.lI.lk)&&this.dmc===G&&this.lI.m4b!==J.m4b&&this.fmc++),1<=Math.abs(this.yDb-this.$.ea.ye)&&(this.lI=null,this.yDb=-1,this.dmc=null))};this.xc=(G,J)=>{J.If||J.rrd||(this.uAj(),this.EAj(),this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging()))};this.zbb=new y.a;C.xj(this.xc);A.h(this.$).Ai.Qm(this.jg)}dispose(){this.$&&A.h(this.$).Ai.fm(this.jg)}XB(C){C.forEach(G=>{this.zbb.kb(G)||
this.zbb.ia(G,new u.a(M[G]));this.zbb.ma(G).jUa()})}Cw(C,G=!0){C.forEach(J=>{this.zbb.kb(J)&&this.zbb.ma(J).q4(G)})}c4f(C){this.IJ(0===C?"ie":"ic")}Tvj(C){this.IJ(C?"ie":"ic")}b4f(){this.$P.argumentAssistanceCardIsInitialModeDefault=!0}Rua(C){window.requestAnimationFrame(()=>{this.Cw([C])})}cff(C){C.forEach(G=>{G=D[G.kind];this.Emg(G);this.vqb[G].shownCounter++})}bff(C){C=D[C];this.Emg(C);this.vqb[C].committedCounter++}IJ(C){if(this.qHa){const G=this.Rpb.length;0===G||this.Rpb[G-1][0]!==C?this.Rpb.push([C,
1]):this.Rpb[G-1][1]++}else switch(C){case "e":this.$P.argumentAssistanceExpandCounter++;break;case "c":this.$P.argumentAssistanceCollapseCounter++;break;case "d":this.$P.argumentAssistanceDragCounter++;break;case "m":this.$P.argumentAssistanceMoveCounter++;break;case "lm":this.$P.argumentAssistanceLearnMoreCounter++;break;case "ie":this.$P.argumentAssistanceCardInitialMode="Expanded";break;case "ic":this.$P.argumentAssistanceCardInitialMode="Collapsed"}}getJsonForLogging(){return"{"+this.$M("SessionDetails",
this.vX)+","+this.$M("ArgumentAssistanceUsage",this.$P)+","+this.$M("argumentAssistanceOrderedActions",this.Rpb)+","+this.$M("FormulaSuggestionsUsage",this.qK)+","+this.$M("FunctionDialogUsage",this.F4a)+","+this.$M("AutocompleteCardInteraction",this.OJ)+","+this.$M("AutocompleteRenderOptimization",this.uqb)+","+this.$M("AutocompleteUsageByKind",this.vqb)+","+this.$M("FormulaHighlightsUsage",this.Rbc)+","+this.H2h()+"}"}EAj(){this.qK.smartSuggestionKeptCounter=this.qK.smartSuggestionCommittedCounter-
this.fmc}uAj(){this.vX.argumentAssistanceFlight=this.Xva("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.vX.autoCompleteUIFlight=this.Xva("Microsoft.Office.Excel.","AutoCompleteNewUI");this.vX.smartFormulaBarAutoCompleteFlight=this.Xva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.vX.smartFormulaBarAutoCompletePluginFlight=this.Xva("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.vX.formulaAssistanceRedesignFlight=this.Xva("Microsoft.Office.Excel.",
"FormulaAssistanceRedesign");this.vX.NewInsertFunctionDialogFlight=this.Xva("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.vX.coloredReferencesFlight=this.Xva("Microsoft.Office.Excel.","ColoredReferences");this.vX.parenthesesCouplingFlight=this.Xva("Microsoft.Office.Excel.","ParenthesesCoupling");this.vX.smartFormulaSuggestionsFeatureEnabled=I.a.DNa(this.$)}H2h(){const C=new e.a;for(let G of this.zbb)G.value.QYe(),C.add(`"${G.key}":${r.a.fc(G.value.EW)}`);return`"PerfMeasurements": {${C.toArray().join(",")}}`}Xva(C,
G){return B.a.contains(this.$.ya.FlightHolder.FlightId,G,!0)?v.EwaSettings.getBooleanFeatureGate(C+G,!1)?"T":"C":"None"}$M(C,G){return`"${C.toString()}":${z.c(G)}`}Emg(C){this.vqb[C]||(this.vqb[C]={shownCounter:0,committedCounter:0})}}Object(t.a)(T,"FormulaAssistanceTelemetryManager",null,[621]);class S extends b.a{constructor(C){super();this.$=C;this.Fb()}static la(C){C.da.Ga(492,new S(C))}create(){var C;this.ob(null!==(C=this.$.da.Aa(491))&&void 0!==C?C:this.$.da.Ga(491,new T(this.$)))}}Object(t.a)(S,
"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(E,"a",function(){return H});const H=()=>{c.a.Fa(C=>{S.la(C)})}},1221:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(277),e=a(93),f=a(39),d=a(264),h=a(549),m=a(4),l=a(83),w=a(419),n=a(720),x=a(8),r=a(31),u=a(19),v=a(61),B=a(5),z=a(790),A=a(1049),y=a(839),D=a(13),I=a(33);class M{constructor(xb,pa,Ma,ya,Ea,Na,kb,lb){this.$=pa;this.Va=Ma;this.vl=ya;this.selectedRanges=Ea;this.grid=Na;this.Ty=lb;this.n5=kb;this.zha=d.a.all(Ea,oa=>oa.isRow);this.Dsa=
d.a.all(Ea,oa=>oa.gf);this.FFb=d.a.all(Ea,oa=>!oa.isRow&&!oa.gf);pa=Na.Ab.ukd(Ea);this.gtb=!!pa;this.pYf=!!pa&&pa.hasActiveFilter;this.menuSection=Ma.Fc();xb.tc.push(this.menuSection);this.Kba=this.zha||this.Dsa?this.menuSection:Ma.Fc();this.nua=this.zha||this.Dsa?this.menuSection:Ma.Fc()}Cfd(){this.lMh();this.PLh();const xb=this.Ty.H8a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.pb(xb?149:148))}rMh(){let xb=0;this.gtb?this.n5.xm(942362098)?xb=this.Ty.xm(this.vl,942362098,
this.selectedRanges,this.grid)?161:169:this.pYf&&(xb=this.Ty.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?177:181):this.n5.xm(-1113896058)&&(xb=this.zha?this.Ty.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?49:116:this.Ty.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==xb&&this.Kba.buttons.push(this.Va.pb(xb))}qMh(){let xb;!this.gtb&&this.n5.xm(-1113896058)&&(xb=this.zha?this.Ty.xm(this.vl,-1113896058,this.selectedRanges,this.grid)?295:296:this.Ty.xm(this.vl,-1113896058,
this.selectedRanges,this.grid)?297:298,this.Kba.buttons.push(this.Va.pb(xb)))}mMh(){let xb=0;this.gtb?this.n5.xm(622604322)&&(xb=this.grid.rtl?this.Ty.xm(this.vl,622604322,this.selectedRanges,this.grid)?191:192:this.Ty.xm(this.vl,622604322,this.selectedRanges,this.grid)?162:170):this.n5.xm(1415868706)&&(xb=this.Dsa?this.Ty.xm(this.vl,1415868706,this.selectedRanges,this.grid)?50:117:this.Ty.xm(this.vl,1415868706,this.selectedRanges,this.grid)?178:182);0!==xb&&this.Kba.buttons.push(this.Va.pb(xb))}kMh(){this.n5.xm(1035996630)&&
(this.Ty.xm(this.vl,1035996630,this.selectedRanges,this.grid)?(this.Kba.buttons.push(this.Va.pb(this.grid.rtl?187:165)),this.Kba.buttons.push(this.Va.pb(166))):(this.Kba.buttons.push(this.Va.pb(this.grid.rtl?188:173)),this.Kba.buttons.push(this.Va.pb(174))))}lMh(){const {GridContextMenu:xb}=a(1221);let pa=null;this.FFb&&(pa=this.Va.xw("ContextMenu.InsertCells",null,D.a.instance.ga(345),1896159024),pa.menu.tc.push(this.Kba));xb.nMh(this.Kba,this.Va,this.$);this.rMh();m.AFrameworkApplication.Hs("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");
I.a.psd()&&this.qMh();this.mMh();this.kMh();pa&&0<this.Kba.buttons.length&&this.menuSection.buttons.push(pa)}RLh(){let xb=0;this.gtb?this.n5.xm(1405456548)?xb=this.Ty.xm(this.vl,1405456548,this.selectedRanges,this.grid)?163:171:this.pYf&&(xb=this.Ty.xm(this.vl,1554436520,this.selectedRanges,this.grid)?179:183):this.n5.xm(1554436520)&&(xb=this.zha?this.Ty.xm(this.vl,1554436520,this.selectedRanges,this.grid)?51:118:this.Ty.xm(this.vl,1554436520,this.selectedRanges,this.grid)?179:183);0!==xb&&this.nua.buttons.push(this.Va.pb(xb))}QLh(){let xb=
0;this.gtb?this.n5.xm(284490184)&&(xb=this.Ty.xm(this.vl,284490184,this.selectedRanges,this.grid)?164:172):this.n5.xm(674605324)&&(xb=this.Dsa?this.Ty.xm(this.vl,674605324,this.selectedRanges,this.grid)?52:119:this.Ty.xm(this.vl,674605324,this.selectedRanges,this.grid)?180:184);0!==xb&&this.nua.buttons.push(this.Va.pb(xb))}OLh(){this.n5.xm(1035996630)&&(this.Ty.xm(this.vl,1035996630,this.selectedRanges,this.grid)?(this.nua.buttons.push(this.Va.pb(this.grid.rtl?189:167)),this.nua.buttons.push(this.Va.pb(168))):
(this.nua.buttons.push(this.Va.pb(this.grid.rtl?190:175)),this.nua.buttons.push(this.Va.pb(176))))}PLh(){let xb=null;this.FFb&&(xb=this.Va.xw("ContextMenu.DeleteCells",null,D.a.instance.ga(409),-1554384558),xb.menu.tc.push(this.nua));this.RLh();this.QLh();this.OLh();xb&&0<this.nua.buttons.length&&this.menuSection.buttons.push(xb)}}Object(t.a)(M,"CellsContextMenuGenerator",null,[]);var T=a(776);class S{constructor(xb){this.ranges=null;this.ranges=xb}}Object(t.a)(S,"MacroRecorderRangeHyperlinkRemovedPayload",
null,[145]);var H=a(527),C=a(24),G=a(102),J=a(76),L=a(74),P=a(40),aa=a(188),U=a(60),K=a(606),Y=a(138),na=a(37),W=a(461),X=a(556),Aa=a(1),Q=a(184),fa=a(21),Ca=a(375),ia=a(34),Ra=a(48),Ya=a(211),Ga=a(22),da=a(30),Z=a(1074),ha=a(910),Wa=a(131),ca=a(374),ja=a(284),ua=a(162),Za=a(154),Pa=a(348),ka=a(92),ra=a(29),ba=a(283),Ua=a(282),Ka=a(132),Oa=a(774),ib=a(775),La=a(112),db=a(41),Ab=a(55),Mb;(function(xb){xb[xb.none=0]="none";xb[xb.once=1]="once";xb[xb.twice=2]="twice"})(Mb||(Mb={}));Object(t.b)("ToggleState",
Mb);class pb{constructor(xb,pa,Ma,ya){this.PZc=this.lgb=this.ngb=0;this.$=xb;this.gridView=fa.h(this.$);this.namedSheetViewPublic=pa;this.qg=Ma;this.instantaneousSupportInformationManager=ya;this.QNa=Oa.a.pqd()}Roh(){var xb=this.tV();xb={["CommandValueId"]:db.c(xb)};const pa=new ka.a(-2058042992,2,this.$.Hc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Lb(pa,xb)}hph(){const xb=new ka.a(644342024,2,this.$.Hc,
19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Lb(xb)}Woh(){const xb=this.gridView.ha.ra.activeCell,pa=this.$.da.Aa(66).Kg,Ma=this.$.da.Aa(66).Qwb(xb);return pa||Ma?this.Yoh(pa,Ma,xb):this.Xoh(xb)}Yoh(xb,pa,Ma){if(this.q3g(xb,pa,Ma))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Ab.Task.Ra(!1);if(null!=
xb&&xb.hasAutoFilter||null!=pa&&pa.ata.every(ya=>0!=ya.length))return this.ngb=Mb.none,this.NZc();this.ngb=Mb.once;return this.q9b(Mb.once)}Xoh(xb){var pa=P.v(this.gridView.ha.ra.ed,this.$);pa=this.gridView.$.va.getItemByName(pa.SheetName);const Ma=P.D(pa.g1);if(this.p3g(Ma,xb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Ab.Task.Ra(!1);if(pa.hasAutoFilter){if(Ma&&Ma.contains(this.gridView.ha.ra.activeCell))return this.ngb=
Mb.none,this.NZc();this.ngb=Mb.twice;return this.q9b(Mb.twice)}this.ngb=Mb.once;return this.q9b(Mb.once)}q9b(xb){const pa=P.v(this.gridView.ha.ra.ed,this.$);if(!pa)return Ab.Task.Ra(!1);this.lgb||(this.lgb=Date.now());const Ma=new ka.a(368460465,2,this.$.Hc,19,null),ya=this.$.pa.xa.Wb(),Ea=()=>new Z.a(pa),Na=kb=>{ba.a(kb)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),
xb===Mb.twice?this.q9b(Mb.once):this.NZc())};return ca.a(this.$.userOperationManager,(kb,lb,oa)=>ja.B(this.$.pa.xa,pa,Ua.b(kb,Na),lb,oa,null,ya),kb=>new aa.a(516,0,kb,64,Ea),Ma)}q3g(xb,pa,Ma){return null!=xb&&ua.d(xb)&&Ma.top===xb.usedRange.top||null!=pa&&pa.yba&&Ma.top===pa.top?(this.cuc(this.$,223),!0):null!=xb&&ua.g(xb)&&Ma.top===xb.usedRange.bottom?(this.cuc(this.$,224),!0):!1}p3g(xb,pa){if(xb&&xb.contains(pa)&&pa.top===xb.top||!xb&&this.r2g(pa.top,pa.left))return this.cuc(this.$,225),!0;xb=new C.Range(pa.top,
pa.left,pa.top+1,pa.left+1,!1,!1);return this.gridView.Ab.Mxa(xb)?(this.cuc(this.$,226),!0):!1}cuc(xb,pa){pa=ra.a.dd(1,1,751,pa,0,147079615,"ContextMenuFilterByCellValueError");Aa.EwaSettings.Lz()?new Pa.a(xb,pa):(xb=new Za.ErrorDialog(xb,pa),xb.initialize(),xb.vg())}NZc(){this.PZc=Date.now();const xb=this.d6h();if(!xb)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Ab.Task.Ra(!1);const pa=this.tV(),Ma={FirstRow:0};Ma.FirstColumn=
pa.Column;Ma.SheetName=pa.SheetName;Ka.b(this.$).vd(Wa.a.FAf,this.vm(),void 0,!0);const ya=this.y6c(pa,Ma),Ea=kb=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.ngb,["ApplyFilterTime"]:this.PZc?Date.now()-this.PZc:-1,["ToggleAndApplyFilterTime"]:this.lgb?Date.now()-this.lgb:-1,["FilterByValueType"]:pa.AutoFilterType})}`);this.lgb&&(this.lgb=0);if(Oa.a.tAc(kb)){const lb=Oa.a.wcc(kb);this.QNa?Oa.a.RRa(ib.a.filterByCellValue,
lb.MessageIdName,La.a.yHa,!0,Oa.a.isSessionEndingError(lb.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${lb.MessageIdName}`)}ba.a(kb)?(kb=ra.a.sc(kb.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${kb}`)):(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Ka.b(this.$).vd(Wa.a.lEf,this.vm(),void 0,!0),kb=
{},kb.FirstRow=this.PUh(),kb.FirstColumn=pa.Column,-1!==kb.FirstRow&&(kb=P.C(kb),this.PS(kb)))},Na=new aa.a(208,0,(kb,lb,oa)=>U.a(this.$.pa.xa,ya,xb,Ua.b(kb,Ea),lb,oa,null,null),6,()=>new ha.a(xb,ya));this.namedSheetViewPublic?this.namedSheetViewPublic.MTa().continueWith(kb=>{kb.result&&this.$.userOperationManager.Ic(Na,null)}):this.$.userOperationManager.Ic(Na,null);return Ab.Task.Ra(!0)}PS(xb){I.a.Cla(this.$)&&na.TaskExtensions.za(Ra.GetServiceTaskFactory.Na(this.$.da,430,431,1),pa=>{pa.result.Zea(xb);
c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.ka,3)}vm(){return{["Location"]:"contextMenu"}}tV(){var xb=0,pa=this.gridView.ha.ra.activeCell;var Ma=this.$.da.Aa(66).Kg;const ya=this.$.da.Aa(66).Qwb(pa);if(Ma){var Ea="Table";xb=Ma.objectId}else ya?(Ea="Table",xb=ya.id):Ea="Sheet";Ma=pa.left;pa={};pa.AutoFilterType=Ea;pa.Column=Ma;pa.Id=xb;Ea={};this.$.pk(Ea);Ea.FirstRow=0;Ea.FirstColumn=pa.Column;xb=
this.$.ea.isNamedObjectViewMode;pa.NamedObjectView=xb;pa.SheetName=xb?Ea.NamedObjectName:Ea.SheetName;pa.ItemListOptions=null;return pa}r2g(xb,pa){xb=C.Range.Qc(xb,pa);return this.gridView.Da.E$(xb,this.$.na.name)&&(xb=this.gridView.Da.CLa(xb))&&xb.autoFilterMenu?!0:!1}d6h(){var xb=null;const pa=this.gridView.Ub(this.gridView.ha.ra.activeCell);if(!pa)return null;const Ma=pa.cell.ABc;let ya;({category:ya}=this.instantaneousSupportInformationManager.wCa(Ma,!1));if(1===pa.vx.type)if(3===ya){if(!pa.cell.CPa)return c.ULS.sendTraceTag(527500290,
0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${ya}. NumFmt is null. `),null;xb=(pa.cell.CPa.Start+pa.cell.CPa.End).trim()}else if(!ya&&(Ga.a.T1a(pa.vx.value,"E")||Ga.a.T1a(pa.originalText,"E"))){xb=this.qg.G_e(pa.vx.value,Ma,1,Number.POSITIVE_INFINITY,pa.cell.Jia);if(!xb.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${ya}. Failed to acquire formatted value`),null;xb=xb.ly}xb||(xb=pa.originalText);return da.a.sDe(xb)?
["[Blanks]"]:["i"+xb.trim()]}PUh(){const xb=this.gridView.ha.ra.activeCell;var pa=this.$.da.Aa(66).Kg;const Ma=this.$.da.Aa(66).Qwb(xb);if(pa)return pa.usedRange.top;if(null!=Ma)return Ma.top;pa=this.$.va.getItemByName(this.$.na.sheetName);return(pa=P.D(pa.g1))&&pa.contains(xb)?pa.top:-1}y6c(xb,pa){const Ma={};Ma.Location=pa;Ma.FieldId=xb.Id.toString();Ma.DataSourceIndex=-1;Ma.FilterType=xb.AutoFilterType;Ma.AnchorType=0;Ma.ChartId=null;Ma.AnchorValue1=-1;Ma.AnchorValue2=-1;Ma.Property=xb.RichProperty;
return Ma}}Object(t.a)(pb,"GridContextMenuFilter",null,[]);a.d(E,"GridContextMenu",function(){return Qb});class Qb extends n.a{constructor(xb,pa,Ma,ya){super(xb,"PopulateGridContextMenu",1247109494,-2064931494,Qb.M7h,!0,!1,Qb.ILb,pa,Ma,!0,ya);this.Vkc=this.expandCollapse=this.refresh=this.TZ=this.Owa=this.EBa=!1;this.xJe=!0;this.grid=fa.h(xb);this.Lnc=!0;if(this.nic=Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const Ea=Ra.GetServiceTaskFactory.Na(this.$.da,
309,310,3),Na=Ra.GetServiceTaskFactory.create(this.$.da,18,this.ka,3);na.TaskExtensions.za(na.TaskExtensions.Ed([Ea,Na],this.ka),()=>{this.$.da.fb(268,kb=>{this.f6a=new pb(xb,Ea.result,Na.result,kb)})},this.ka,3)}}get ax(){return"PopulateGridContextMenu"}get PB(){return B.a.tSf}dispose(){super.dispose();this.grid=null}nc(xb,pa){xb=!this.Ktd(xb,pa);if(!xb)switch(pa){case -1977666927:xb=null==this.f6a||this.MDj();break;case 1549396389:xb=null==this.f6a||!this.Tli();break;case 2045563128:case 1803952894:xb=
null==this.f6a||!this.$.isEditMode&&!this.Uli();break;case -425234874:xb=this.QDj()}return xb}Ktd(xb,pa){const Ma=this.grid.ha.ra.selectedRanges;return(new Y.a(this.$.va)).xm(xb,pa,Ma,this.grid)}executeCommand(xb,pa,Ma){const ya=pa.command;xb=null;switch(ya){case -1396319072:if(pa=this.grid.Ub(null))b.a.instance.b2c(!0),e.EventHandlerManager.instance.Led(),Qb.K0i(pa);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ra.selectedRanges,pa);break;case 324156914:xb=this.grid.startEdit(!1,
1);break;case 1441131127:this.showGridContextMenu(Ma);break;case -1977666927:xb=this.f6a.Roh();break;case 1549396389:xb=this.f6a.hph();break;case 1803952894:xb=this.f6a.Woh();break;default:xb=Q.a(ya)}return xb||na.TaskExtensions.sba()}yc(xb,pa,Ma){xb=!1;switch(pa.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:xb=!0;break;case 1441131127:xb=!!Ma}return xb}xZ(xb=!1){let pa=!1,Ma=!1,ya=0;Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&
(ya=f.a.Ud());const Ea=this.Va.gq(this.menuId);var Na=this.grid.ha.ra;const kb=Na.Pg,lb=kb&&Na.ed.gf,oa=kb&&Na.ed.isRow;Na=Na.selectedRanges;const Ba=d.a.all(Na,Yb=>Yb.gf),sa=d.a.all(Na,Yb=>Yb.isRow),qb=P.O(Na),Jb=P.P(Na);this.Ylf(lb,oa)?(pa=!0,this.UMh(Ea)):this.$.isEditMode?Ca.a(this.$)?this.VMh(Ea,lb,oa):(this.SLh(Ea,!(oa||lb||!this.Vkc)),this.oMh(Ea,Na,xb),this.dMh(Ea,Ba,sa,qb,Jb),this.R0e(Ea,kb,lb,oa),this.kNh(Ea),this.w0e(Ea,lb,oa),this.KMh(Ea,kb,lb,oa,Na),this.VLh(Ea),this.TLh(Ea,Na),this.wMh(Ea),
this.fNh(Ea,kb),Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.iMh(Ea)):(Ma=!0,Ca.a(this.$)?this.M0e(Ea):this.ANh(Ea,kb,lb,oa,Na));Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(xb=f.a.Ud()-ya,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${xb}, isPivotMenu: ${pa}, isViewMenu: ${Ma}, firstTimeEntry: ${this.xJe}`));this.xJe=!1;return Ea}rLa(xb){const pa=[];if(Ca.a(this.$))return pa;
if(3===xb){xb=this.grid.ha.ra;const ya=xb.Pg,Ea=ya&&xb.ed.gf,Na=ya&&xb.ed.isRow;let kb=!1;var Ma=!1;let lb=!1;this.$.isMobileMode&&(Ma=xb.selectedRanges,kb=P.O(Ma),Ma=P.P(Ma));if(ya){const oa=fa.f(this.grid);oa&&oa.range.contains(xb.ed)&&this.VV(oa)&&(lb=!0)}this.$.isEditMode?this.Ylf(Ea,Na)?pa.push(...[y.a.CNf,y.a.ENf]):Ea||Na?(pa.push(y.a.clipboard),Na?pa.push(y.a.dqj):Ea&&pa.push(y.a.R6g)):(pa.push(...[y.a.edit,y.a.clipboard]),lb?pa.push(y.a.hyperlink):pa.push(y.a.color),ya&&pa.push(y.a.TUg)):
(pa.push(y.a.copy),lb&&pa.push(y.a.openHyperlink),!Na||this.$.isMobileMode&&Ma?!Ea||this.$.isMobileMode&&kb||pa.push(y.a.N3j):pa.push(y.a.O3j));pa.push(y.a.D7h)}else 2===xb&&pa.push(y.a.yCe);return pa}Ylf(xb,pa){return(this.EBa||this.Owa||this.TZ||this.refresh||this.expandCollapse)&&!(xb||pa)}showGridContextMenu(xb){this.expandCollapse=this.refresh=this.TZ=this.Owa=this.EBa=!1;var pa=this.$,Ma=W.a(pa).HLa(),ya=this.grid.ha.ra;const Ea=ya.Pg;var Na=Ea&&ya.ed.gf;ya=Ea&&ya.ed.isRow;if(Ma&&!Na&&!ya){Na=
X.a(pa);if(null===Na||void 0===Na?0:Na.dVd)this.EBa=Na=G.f(pa.lg),this.Owa=!Na;Na=pa.dc;this.TZ=Ma.supportsBIExplore&&!!z.a(pa)&&Na.h3(32768);Na.allowInteractivity&&(pa=this.grid.Ub(null),(null===pa||void 0===pa?0:pa.cell)&&(pa.cell.R1c||pa.cell.l9f)&&(this.expandCollapse=!0),Na.allowManualDataRefresh&&(this.refresh=!0))}pa=null;Ma=1;Na=Object(l.a)(h.a,xb.eventArgs);xb=Object(l.a)(A.a,xb.creationParams);ya=this.VRh();xb?(pa=xb.clientPoint,Ma=xb.inputMethod):Na&&1!==Na.tb?(pa=new Sys.UI.Point(Na.clientPoint.x,
Na.clientPoint.y),Ma=Na.tb):ya&&(pa=new Sys.UI.Point(ya.x+(this.$.isChromeRtl?0:ya.width),ya.y+ya.height));J.a.Db=Ma;this.Vkc=3===Ma;xb=r.a.vvb;this.Tp(pa,!Na||Na.Ca.target.className!==xb,Ma)}removeHyperlinksFromRange(xb,pa){if(!Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.aq(xb,!0)){var Ma=P.r(xb,this.$),ya=this.$.pa.xa.Wb();this.$.userOperationManager.Ic(new aa.a(125,0,(Ea,Na,kb)=>{this.$.Py();return U.b(this.$.pa.xa,Ma,"","",
!0,!1,127,Ea,Na,kb,null,ya)},void 0,()=>new S(Ma)),pa);this.grid.yf.rH(!1)}}VRh(){var xb=this.grid.Ub(null);if((null===xb||void 0===xb?0:xb.cell.Qk)&&this.hlf(xb))return this.grid.getCellBounds(xb.cell);xb=this.grid.ha.ra.activeCell;return(xb=this.hbc(new C.Range(xb.top,xb.left,x.a.gh,xb.left,!1,!1),2,!0)||this.hbc(new C.Range(1,xb.left,xb.top,xb.left,!1,!1),2,!1)||this.hbc(new C.Range(xb.top,xb.right,xb.top,x.a.uh,!1,!1),1,!0)||this.hbc(new C.Range(xb.top,1,xb.top,xb.right,!1,!1),1,!1)||null)&&xb.Qk?
this.grid.getCellBounds(xb):Sys.UI.DomElement.getBounds(this.grid.Jwa.mc)}hlf(xb){var pa=this.grid.rtl,Ma=this.$.isChromeRtl;xb=xb.cell;var ya=fa.h(this.$).sK(xb);return ya?(ya=ya.topLeft,pa=ya.x+=pa===Ma?xb.offsetWidth:0,Ma=ya.y+=xb.offsetHeight,this.grid.view.visibleArea.contains(new v.a(pa,Ma,0,0))):!1}hbc(xb,pa,Ma){xb=this.grid.jk("GridContextMenu.FindFirstCellInViewportArea",xb,pa,Ma);try{for(xb.$$rst();xb.$$mn();){const ya=xb.$$cu();if(ya&&this.hlf(ya))return ya.cell}}finally{xb&&xb.dispose()}return null}UMh(xb){const pa=
this.Va,Ma=pa.Fc();this.refresh&&Ma.buttons.push(pa.pb(100));this.TZ&&Ma.buttons.push(pa.pb(99));this.EBa?Ma.buttons.push(pa.pb(59)):this.Owa&&Ma.buttons.push(pa.pb(58));if(this.expandCollapse){let ya;ya=pa.xw("ContextMenu.PivotExpandCollapse",null,D.a.instance.ga(1163),589118293);const Ea=pa.Fc();Ea.buttons.push(pa.pb(243));Ea.buttons.push(pa.pb(244));Ea.buttons.push(pa.pb(245));Ea.buttons.push(pa.pb(246));ya.menu.tc.push(Ea);ya&&0<Ea.buttons.length&&Ma.buttons.push(ya)}xb.tc.push(Ma)}R0e(xb,pa,
Ma,ya){if(pa&&!Ma&&!ya){pa=this.Va.Fc();this.nic&&!this.$.MK&&this.Gfd(pa);this.Pfd(pa);this.oNh(pa);if(Aa.EwaSettings.oa(448)&&fa.h(this.$).ha.ra.IK()&&fa.h(this.$).ha.ra.U5)switch(Aa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:pa.buttons.push(this.Va.pb(237));break;case 2:pa.buttons.push(this.Va.pb(238));break;default:pa.buttons.push(this.Va.pb(236))}xb.tc.push(pa)}}Pfd(xb){if(this.$.dc.allowSorting&&(!this.$.isMobileMode||
(new Y.a(this.$.va)).Qd(2048))){var pa=this.Va.Fc();pa.buttons.push(this.Va.pb(223));pa.buttons.push(this.Va.pb(224));pa.buttons.push(this.Va.pb(292));pa.buttons.push(this.Va.pb(293));pa.buttons.push(this.Va.pb(294));this.$.isMobileMode||pa.buttons.push(this.Va.pb(225));var Ma=this.Va.xw("ContextMenu.sort",null,D.a.instance.ga(227),-864298118);Ma.menu.tc.push(pa);xb.buttons.push(Ma)}}Gfd(xb){const pa=this.Va.xw("ContextMenu.filter",null,D.a.instance.ga(1964),2045563128),Ma=this.Va.Fc();var ya=this.sWh();
const Ea=this.Va.pb(234);Ea.label=ya;Ma.buttons.push(Ea);Ma.buttons.push(this.Va.pb(235));ya=this.Va.Fc();ya.buttons.push(this.Va.pb(233));pa.menu.tc.push(Ma);pa.menu.tc.push(ya);xb.buttons.push(pa)}oNh(xb){if(fa.h(this.$).ha.ra.IK()){const pa=this.Va.Fc();pa.buttons.push(this.Va.pb(232));pa.buttons.push(this.Va.pb(285));pa.buttons.push(this.Va.pb(286));const Ma=this.Va.xw("ContextMenu.table",null,D.a.instance.ga(1963),-697806646);Ma.menu.tc.push(pa);xb.buttons.push(Ma)}}H0e(xb,pa,Ma,ya,Ea){if(pa){const kb=
P.K(Ea);var Na=fa.f(this.grid);if(Na&&!Ma&&!ya){Ma=new Y.a(this.$.va);if(Na.range.contains(kb)&&this.VV(Na)){(pa=!Na.Cxa&&!Ma.li)&&this.$.isEditMode&&xb.buttons.push(this.Va.pb(45));Na.wba&&xb.buttons.push(this.Va.pb(53));pa&&this.$.isEditMode&&xb.buttons.push(this.Va.pb(47));return}!Na.Cxa&&this.$.isEditMode&&(Na=Ma.Qd(128),xb.buttons.push(this.Va.pb(Na?46:121)))}}this.Qaj(Ea)&&xb.buttons.push(this.Va.pb(48));(Na=this.$.va.na)&&Na.Hd&&(Na=Na.Hd.Kv||Na.Hd.hI,!pa||this.$.MK||!Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||!T.g(this.$)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||Na||(pa=P.K(Ea),this.Paj(pa)?xb.buttons.push(this.Va.pb(276)):pa.gf||pa.isRow||xb.buttons.push(this.Va.pb(275))))}Qaj(xb){for(const pa of xb){xb=this.grid.getRangeInformation(pa);for(let Ma=0;Ma<xb.length;Ma++)if(Object(w.a)(H.HyperlinkRange,xb[Ma])){const ya=this.grid.Ub(xb[Ma]);if(ya&&this.VV(ya)&&!ya.Cxa)return!0}}return!1}Paj(xb){if(fa.h(this.$).ha.ra.IK()){const pa=fa.h(this.$).Ab.Cj(xb);if(pa&&pa.usedRange.equals(xb))return!0}return!1}w0e(xb,
pa,Ma){var ya,Ea;if(1===fa.h(this.$).ha.Ne&&!pa&&!Ma){pa=Ca.a(this.$);Ma=this.Va;var Na=Ma.Fc(),kb=this.$.da.Aa(65);(null===(ya=null===kb||void 0===kb?void 0:kb.Xm)||void 0===ya?0:ya.CF)&&!pa&&Na.buttons.push(Ma.pb(227));kb&&kb.isCommentOperationEnabled(3)&&Na.buttons.push(Ma.pb(221));(null===(Ea=null===kb||void 0===kb?void 0:kb.Xm)||void 0===Ea?0:Ea.Hmd)&&!pa&&Na.buttons.push(Ma.pb(228));(null===kb||void 0===kb?0:kb.hasCommentAtActiveCell)?kb.YC.isResolved||Na.buttons.push(Ma.pb(159)):kb&&kb.hasCommentAtActiveCell||
(kb&&kb.Xm&&kb.Xm.CF?pa||(Na.buttons.push(Ma.pb(229)),Na.buttons.push(Ma.pb(230))):(Na.buttons.push(Ma.pb(160)),pa||Na.buttons.push(Ma.pb(226))));xb.tc.push(Na)}}kNh(xb){if(Aa.EwaSettings.oa(132)){const pa=this.Va,Ma=pa.Fc();Ma.buttons.push(pa.pb(250));xb.tc.push(Ma)}}oMh(xb,pa,Ma){if(!Ma){Ma=this.$.Ka.NH();var ya=new Y.a(this.$.va),Ea=new K.a(Ma,pa,this.grid);(new M(xb,this.$,this.Va,Ma,pa,this.grid,Ea,ya)).Cfd()}}dMh(xb,pa,Ma,ya,Ea){const Na=(new Y.a(this.$.va)).Qd(8),kb=this.Va,lb=kb.Fc();pa&&
lb.buttons.push(kb.pb(Na?152:153));Ma&&lb.buttons.push(kb.pb(Na?150:151));pa&&(ya||lb.buttons.push(kb.pb(Na?109:155)),lb.buttons.push(kb.pb(Na?111:157)));Ma&&(Ea||lb.buttons.push(kb.pb(Na?108:154)),lb.buttons.push(kb.pb(Na?110:156)));xb.tc.push(lb)}SLh(xb,pa){const Ma=this.Va,ya=Ma.Fc();xb.tc.push(ya);pa&&ya.buttons.push(Ma.pb(102));ya.buttons.push(Ma.pb(42));ya.buttons.push(Ma.pb(43));pa=this.RMh(Ma);xb.tc.push(pa)}RMh(xb){const pa=xb.Fc();pa.title=D.a.instance.ga(1143);pa.iag=!1;pa.hag=!1;pa.sfg=
!1;let Ma=5;const ya=I.a.jvd(this.$);ya&&(Ma=6);xb=xb.$A("PasteOptionsGallery",Ma,"Size24by24",pa.title);pa.buttons.push(xb);xb.nu("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1144,void 0,"Paste_24",1,u.a.Yzh);xb.nu("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1145,void 0,"PasteValues_24",1,u.a.cAh);xb.nu("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1146,void 0,"PasteFormulas_24",1,u.a.$zh);xb.nu("ContextMenu.PasteTranspose",
-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"PasteTranspose_24",1,u.a.bAh);xb.nu("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteFormatting_24",1,u.a.Zzh);ya&&xb.nu("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteLink_24",1,u.a.aAh);return pa}ANh(xb,pa,Ma,ya,Ea){var Na;const kb=this.Va;var lb=kb.Fc();lb.buttons.push(kb.pb(43));xb.tc.push(lb);this.nic&&!this.$.MK&&(lb=this.Va.Fc(),
this.Gfd(lb),xb.tc.push(lb));Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.dc.isMobileMode&&this.$.ea.dc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(lb=this.Va.Fc(),this.Pfd(lb),xb.tc.push(lb),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));lb=this.$.da.Aa(65);if(null===(Na=null===lb||void 0===lb?
void 0:lb.Xm)||void 0===Na?0:Na.CF)Na=this.Va.Fc(),Na.buttons.push(kb.pb(229)),xb.tc.push(Na);Na=this.Va.Fc();this.H0e(Na,pa,Ma,ya,Ea);xb.tc.push(Na);m.AFrameworkApplication.isMobileMode&&!L.a(this.$.ya,29)&&(pa=kb.Fc(),pa.buttons.push(kb.pb(272)),xb.tc.push(pa))}KMh(xb,pa,Ma,ya,Ea){const Na=this.Va.Fc();this.LMh(Na);this.H0e(Na,pa,Ma,ya,Ea);0<Na.buttons.length&&xb.tc.push(Na)}LMh(xb){xb.buttons.push(this.Va.pb(135))}iMh(xb){const pa=this.Va.Fc();pa.buttons.push(this.Va.pb(185));xb.tc.push(pa)}fNh(xb,
pa){Aa.EwaSettings.oa(449)&&pa&&(pa=this.Va.Fc(),pa.buttons.push(this.Va.pb(262)),xb.tc.push(pa))}wMh(xb){var pa=this.grid.ha.ra.selectedRanges;if(pa&&pa.length){var Ma=!1;for(var ya=0;ya<pa.length;ya++)if(this.grid.Ab.Sxa(pa[ya])){Ma=!0;break}if(Ma){Ma=!1;for(ya=0;ya<pa.length;ya++){var Ea=this.grid.Ab.G_h(pa[ya]);if(null!=Ea&&null!=Ea[0]){for(var Na=0;Na<Ea.length;Na++)if(this.grid.Ab.Sxa(Ea[Na])){Ma=!0;break}if(Ma)break}}Na=this.Va;ya=Na.Fc();Ea=Na.Fc();var kb=1===pa.length&&(pa[0].isSingle||this.grid.Ab.bOa(pa[0])),
lb=!1,oa=!1,Ba=!1,sa=!1;for(let qb=0;qb<pa.length&&!(lb&&Ba&&oa&&sa);qb++)!lb&&this.grid.Ab.Pqi(pa[qb])&&(lb=!0),!Ba&&this.grid.Ab.Zkf(pa[qb],!1)&&(Ba=!0),!oa&&this.grid.Ab.Btd(pa[qb])&&(oa=!0),!sa&&this.grid.Ab.hif(pa[qb])&&(sa=!0);Aa.EwaSettings.oa(102)&&kb&&!this.grid.Ab.xAb(pa[0])&&(sa?ya.buttons.push(Na.pb(217)):ya.buttons.push(Na.pb(216)));sa=lb;sa=!(new Y.a(this.$.va)).li&&sa;Ba&&!Ma&&(Aa.EwaSettings.oa(128)&&G.l(this.$.lg)&&(Aa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(Aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Ea.buttons.push(Na.pb(220)):Ea.buttons.push(Na.pb(sa?220:271))),oa&&Ea.buttons.push(Na.pb(sa?218:269)),kb&&(this.grid.Ab.Btd(pa[0])||this.grid.Ab.xAb(pa[0]))&&Ea.buttons.push(Na.pb(sa?219:270))),Ea.buttons.push(Na.pb(sa?215:268)));0<Ea.buttons.length&&(pa=Na.xw(lb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,D.a.instance.ga(1774),798637440),
pa.menu.tc.push(Ea),ya.buttons.push(pa));0<ya.buttons.length&&xb.tc.push(ya)}}}TLh(xb,pa){this.grid.Ab.ojf(pa)&&(pa=this.Va.Fc(),this.grid.ha.ra.hca()?(pa.buttons.push(this.Va.pb(241)),pa.buttons.push(this.Va.pb(239))):pa.buttons.push(this.Va.pb(240)),xb.tc.push(pa))}VV(xb){return xb.cell.hasHyperlink}M0e(xb){this.WMh(xb);var pa=this.Va.Fc();this.Pfd(pa);xb.tc.push(pa);this.nic&&(pa=this.Va.Fc(),this.Gfd(pa),xb.tc.push(pa))}VMh(xb,pa,Ma){this.M0e(xb);this.w0e(xb,pa,Ma)}WMh(xb){if(this.grid.ha.ra.Pg&&
!this.grid.ib.rj){var pa=this.Va,Ma=pa.Fc();ia.a(this.$).HVd()?Ma.buttons.push(pa.pb(265)):Ma.buttons.push(pa.pb(264));xb.tc.push(Ma)}}static K0i(xb){const pa=xb.xLa(Qb.Ynd);pa&&pa.Opd&Qb.Ynd&&xb.invoke(Qb.Ynd,null)}static nMh(xb,pa,Ma){(Ma=Ma.da.Aa(254))?(Ma.osd()&&Ma.kqf()&&xb.buttons.push(pa.pb(212)),Ma.osd()&&Ma.Qlc()&&xb.buttons.push(pa.pb(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}MDj(){const xb=
this.$.da.Aa(66).Kg,pa=this.grid.ha.ra.activeCell;return null!=xb&&!xb.hasActiveFilter||Ya.c(this.$,pa)||!this.Vli(pa)}Vli(xb){const pa=xb.left;var Ma=this.Cec();if(null!=Ma&&null!=Ma.Yac&&Ma.Yac.includes(pa-1))return!0;Ma=this.uec();return null!=Ma&&P.D(Ma).contains(xb)&&null!=Ma.FilteredColumns&&Ma.FilteredColumns.includes(pa-1)?!0:!1}Tli(){var xb=this.$.da.Aa(66).Kg;const pa=this.Cec();if(null!=xb)return xb.hasAutoFilter&&xb.hasActiveFilter;if(null!=pa)return null!=pa.Yac&&0<pa.Yac.length;xb=this.uec();
return null!=xb&&null!=xb.FilteredColumns&&0<xb.FilteredColumns.length}Uli(){var xb=this.$.da.Aa(66).Kg;const pa=this.Cec();if(null!=xb&&xb.hasAutoFilter||null!=pa&&pa.ata.every(Ma=>0!=Ma.length))return!0;xb=P.D(this.uec());return null!=xb&&xb.contains(this.grid.ha.ra.activeCell)?!0:!1}Cec(){const xb=this.$.da.Aa(66);xb.Bn(this.grid.ha.ra.activeCell);return xb.Qwb(this.grid.ha.ra.activeCell)}uec(){return this.$.va.getItemByName(this.$.na.sheetName).g1}sWh(){var xb=this.grid.ha.ra.activeCell,pa=0,
Ma=!1,ya=this.$.da.Aa(66),Ea=this.Cec();ya=ya.Kg;null!=ya?(pa=ya.usedRange.top,Ma=!0):null!=Ea?(pa=Ea.top,Ma=!0):(Ea=this.uec(),null!=Ea&&P.D(Ea).contains(xb)&&(pa=Ea.FirstRow+1,Ma=!0));return Ma?(xb=xb.left,pa=C.Range.Qc(pa,xb),pa=this.grid.Ub(pa),Ma="",null!=pa&&(Ma=pa.text),this.ZXg(Ma,xb)):D.a.instance.ga(220)}ZXg(xb,pa){return null==xb||Ga.a.sh(xb.trim())?String.format(D.a.instance.mb(157),C.Range.nQ(pa)):xb.length>Qb.g5d?String.format(D.a.instance.mb(155),xb.substring(0,Qb.g5d)):String.format(D.a.instance.mb(156),
xb)}QDj(){const xb=this.grid.ha.ra.selectedRanges;if(!xb||!xb.length)return!0;for(let pa=0;pa<xb.length;pa++)if(!this.grid.Ab.Mxa(xb[pa]))return!1;return!0}}Qb.ILb="GridContextMenuRootName";Qb.M7h=B.a.kHe;Qb.Ynd=192;Qb.g5d=26;Object(t.a)(Qb,"GridContextMenu",n.a,[])},1222:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(89),e=a(1092),f=a(8),d=a(778);class h{}h.WYd="suggested_cells_list_box";Object(t.a)(h,"CssElementIds",null,[]);var m=a(5),l=a(1093);class w{constructor(na,W){this.stg=na;this.rtg=W}get A$(){return this.stg}get J_c(){return this.rtg}}
Object(t.a)(w,"CellAutoCompleteItem",null,[675]);var n=a(4),x=a(83),r=a(914),u=a(385),v=a(40),B=a(1),z=a(22),A=a(21);class y extends r.a{constructor(na,W,X){super(na,W);this.oTb=null;this.Klc=0;this.r1=this.D9a=null;this.J6=(Aa,Q)=>{if(Aa=this.cellAutoCompleteControl.items)if(1===Aa.length&&this.cellAutoCompleteControl.p2a.length<Aa[0].A$.length&&this.cellAutoCompleteControl.Rwa&&z.a.$I(Aa[0].A$,this.cellAutoCompleteControl.p2a)&&(Q.newValue=Aa[0].A$),this.eb&&B.EwaSettings.oa(133)){let fa=-1;1<Aa.length?
fa=this.cellAutoCompleteControl.zec(this.eb.text,!0):1===Aa.length&&(this.cellAutoCompleteControl.Rwa||this.cellAutoCompleteControl.rgc)&&(fa=0);if(0<=fa&&Aa.length>fa&&Aa[fa].J_c){const Ca=v.C(Aa[fa].J_c);Ca&&A.h(this.$).Ab.Sxa(Ca)&&(Q.fif=!0,Q.tCe=Aa[fa].J_c)}}};this.pHb=()=>{this.cellAutoCompleteControl.Rwa=!1};this.eb.XZa(this.J6);if(this.CAb=B.EwaSettings.ll())this.oTb=X;this.r1=this.Be.oe(this.eb.textBox.domElement);this.r1.la("mousedown",this.pHb)}get TAb(){return!1}get LK(){return this.cellAutoCompleteControl.te}set LK(na){this.cellAutoCompleteControl.te=
na}get Y6a(){return!1}get key(){return u.a.F2c}get cellAutoCompleteControl(){if(this.CAb)return this.oTb;const {CellAutoCompleteControl:na}=a(1222);return this.oTb||(this.oTb=Object(x.a)(na,this.$.da.Aa(1)))}dispose(){this.eb.wKb(this.J6);super.dispose()}nZ(na){na&&!this.cellAutoCompleteControl.te||super.nZ(na)}Yh(na,W){this.cellAutoCompleteControl.eb=this.eb;this.Klc=na.keyCode;if(this.eb.gb){const X=this.eb.text;z.a.equals(this.D9a,X,!1)||(this.D9a=X)}else this.D9a=null;if(237279923===W)return this.cellAutoCompleteControl.te=
!1;B.EwaSettings.oa(133)&&17===this.Klc&&this.cellAutoCompleteControl.Rwa&&(this.cellAutoCompleteControl.rgc=!0);return super.Yh(na,W)}gDd(){var na;if(!B.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!n.AFrameworkApplication.Og)if(this.cellAutoCompleteControl.eb=this.eb,this.cellAutoCompleteControl.Rwa=!1,this.eb.gb){const W=!z.a.equals(this.D9a,this.eb.text,!0),X=this.eb.prd;X||!W&&229!==this.Klc?X&&(this.cellAutoCompleteControl.te&&(this.cellAutoCompleteControl.te=
!1),null===(na=this.cellAutoCompleteControl.LOa)||void 0===na?void 0:na.cancel()):this.cellAutoCompleteControl.ITg(this.Klc)}else this.D9a=null}Th(){}jg(){this.LK=!1;this.cellAutoCompleteControl.set_visible(!1);this.D9a=null;this.cellAutoCompleteControl.Rwa=!1;this.cellAutoCompleteControl.rgc=!1;this.cellAutoCompleteControl.LOa&&this.cellAutoCompleteControl.LOa.cancel()}KJd(na,W){return this.cellAutoCompleteControl.Yh(na,W)}}Object(t.a)(y,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var D=a(30);
r=a(1094);var I=a(12),M=a(11),T=a(117);class S extends r.a{constructor(na,W,X,Aa){super(na,W);this.htmlSanitizationHelper=this.Pra=this.cellAutoCompleteControl=null;this.htmlSanitizationHelper=X;if(this.CAb=B.EwaSettings.ll())this.cellAutoCompleteControl=Aa;this.xp=[]}get Rj(){return this.Pra}set Rj(na){this.kCa(this.Rj);this.Pra=na;const W=this.kCa(this.Rj);this.ie=na?W.innerText:null;this.Rxc(na)}get te(){return super.te}set te(na){super.te=na;na||(this.Rj=null)}get UUa(){return null}get wHa(){return this.CAb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}dispose(){super.dispose();this.Pra=null}rCc(na){this.d8(!1);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")){var W=document.createElement("table");W.classList.add(this.k6);W.T6j=m.a.sHa;var X=document.createElement("tbody");for(let Aa=0,Q=this.xp.length;Aa<Q;Aa++){const fa=
document.createElement("tr"),Ca=document.createElement("td");Ca.classList.add(this.iW);const ia=document.createElement("span");ia.classList.add(S.f4b);ia.setAttribute(m.a.sZc,na[this.xp[Aa]].A$);ia.innerText=na[this.xp[Aa]].A$;Ca.appendChild(ia);fa.appendChild(Ca);X.appendChild(fa)}W.appendChild(X);this.htmlSanitizationHelper.RJ(this.Lf);this.Lf.appendChild(W)}else{W=`<table class='${this.k6}' aria-live='polite'><tbody>`;for(let Aa=0,Q=this.xp.length;Aa<Q;Aa++)X=D.a.rg(na[this.xp[Aa]].A$),X=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.iW,S.f4b,m.a.sZc,X,D.a.gad(X)),W+=X;W+="</tbody></table>";this.Lf.innerHTML=W}this.Hn=I.DOMElementExtensions.nk(this.domElement,this.k6);this.d8(!0);this.zsa()}AKa(na,W){if(na&&na.length){var X=[];if(W)for(let Aa=0,Q=na.length;Aa<Q;Aa++)z.a.$I(na[Aa].A$,W)&&X.push(Aa);this.xp=X;this.rCc(na)}else this.te=!1,this.Pra=null}Rya(){}e0g(na,W,X){let Aa=Math.min(na,Math.max(200,X));W&&na<X&&(Aa+=T.a.Tu);I.DOMElementExtensions.Zv(this.Lf,Aa);W&&(Aa-=T.a.Tu);return Aa}zsa(){super.zsa();var na=I.DOMElementExtensions.nk(this.get_element(),
this.k6),W=this.xp.length>this.rI,X=A.h(this.$);if(X=X.Ub(X.ha.ra.activeCell))for(na=this.e0g(na.offsetWidth,W,X.width),W=this.Lf.getElementsByClassName(S.f4b),X=0;X<W.length;X++)W[X].style.maxWidth=M.HelperMethods.uc(na);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(na){if(na=super.onItemClick(na)){const W=A.h(this.$);W.Xo(!1);W.focus()}return na}}S.f4b=d.a.rzh;Object(t.a)(S,"CellAutoCompleteListBox",
r.a,[]);var H=a(24),C=a(66),G=a(113),J=a(172),L=a(46),P=a(35),aa=a(252),U=a(19);a.d(E,"CellAutoCompleteControl",function(){return Y});const K=`<div id='${h.WYd}' class='${d.a.L$b} ${U.a.Do}' ></div>`;class Y extends e.a{constructor(na,W,X){super(na);this.TDa=null;this.E2c=[];this.l9d=null;this.rgc=this.Rwa=!1;this.$ee=this.Eq=null;this.ePe=()=>{this.kZ.AKa(this.items,this.TDa);this.raiseEvent("ACLBUpdated",new l.a(this.items.length));this.show()};this.tableManager=W;this.domElement.className=d.a.dSe;
B.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&B.EwaSettings.isChangeGateEnabled("OfficeVSO:7141407_FilterDialog_InnerHtml_CleanUp")?(W=document.createElement("div"),W.classList.add(d.a.L$b),W.classList.add(U.a.Do),W.id=h.WYd,this.domElement.appendChild(W)):this.domElement.innerHTML=K;I.DOMElementExtensions.setVisible(this.domElement,!1);aa.d(this.style,this.$.isChromeRtl);this.Jjf=B.EwaSettings.ll();this.sCe=$get(h.WYd,this.domElement);this.kZ=new S(this.$,this.sCe,
X,this);this.sUa(!0);this.$.domElement.appendChild(this.domElement);this.jqb(na,G.a(na));this.jqb(na,A.h(na).Vb);this.Jjf||this.$.da.Ga(1,this);this.$li=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}R0b(na){this.addHandler("ACLBUpdated",na)}Kvc(na){this.removeHandler("ACLBUpdated",na)}d3(na){this.addHandler("ACLBSelectionChanged",na)}Yda(na){this.removeHandler("ACLBSelectionChanged",na)}xNg(na){this.addHandler("ACLBMatchedItem",na)}Yij(na){this.removeHandler("ACLBMatchedItem",
na)}get qu(){return this.kZ}get p2a(){return this.TDa}get ie(){return this.kZ.ie}get items(){return this.Eq}get LOa(){return this.$ee}get activeCell(){return A.h(this.$).ha.ra.activeCell}get dataValidationControl(){return this.l9d||(this.l9d=this.$.da.Aa(14))}Ecg(na){for(let W=0;W<na.length;W++){const X=na.charCodeAt(W);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?z.a.isLetter(X):z.a.wsd(X))return!0}return!1}Exa(){return!this.items}dispose(){if(this.$){this.sUa(!1);
const na=A.h(this.$);na&&na.view.fr(this.iqc)}b.a.rc([this.kZ,this.LOa]);b.a.rc(this.E2c);this.E2c=this.sCe=this.kZ=this.eb=null;super.dispose()}Yh(na,W){let X=!1;if(this.nEj())switch(W){case -798660877:if(1===this.items.length&&this.ie)break;this.qu.BB(1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,this.zec(this.ie),this.ie));X=this.mz(!1);break;case 137938150:if(1===this.items.length&&this.ie)break;this.qu.BB(-1);this.raiseEvent("ACLBSelectionChanged",new l.a(this.items.length,
this.zec(this.ie),this.ie));X=this.mz(!1);break;case 2091832999:this.qu.BB(this.rI-1);X=this.mz(!1);break;case 742457698:this.qu.BB(-(this.rI-1));X=this.mz(!1);break;case 125627505:this.eb.textBox.caretPosition=this.eb.text.length;this.te=!1;X=!0;break;case 267796030:this.mz(!0);break;default:X=super.Yh(na,W)}return X}show(){this.items&&this.items.length&&(this.kZ.Rj=this.ie?this.qu.Hn.rows[this.zec(this.ie)]:null,this.te=0<this.kZ.xp.length,this.DCa(!0),this.kZ.Rya())}ITg(na){const W=!!this.eb&&
!C.f(this.$.na);this.rgc=this.Rwa=!1;this.eb&&!this.eb.gb?this.set_visible(!1):W&&!this.zjh(this.activeCell)&&this.WHj(na)}zjh(na){return!!this.dataValidationControl&&this.dataValidationControl.g$c(na)}mz(na){if(!this.eb||!this.te)return!1;const W=this.TDa;if(this.ie){var X=I.DOMElementExtensions.c_(I.DOMElementExtensions.nk(this.kZ.Rj,S.f4b),m.a.sZc,"");const Aa=X.substring(W.length,X.length);na?this.eb.text=X:this.eb.insertTextAt(Aa,W.length,this.eb.text.length)}X=A.h(this.$);X.Vl&&(X=X.Vb,X.text=
this.eb.text,X.setCaretPosition(this.eb.textBox.caretPosition));na?this.te=!1:this.eb.textBox.selectRange(W.length,this.eb.text.length);return!0}zec(na,W=!1){if(!this.kZ.Hn)return-1;const X=this.kZ.Hn.children[0],Aa=X.children.length;let Q;for(let fa=0;fa<Aa;++fa)if(Q=X.children[fa],z.a.equals(Q.innerText.trim(),na,W))return fa;return-1}yIg(na,W,X,Aa,Q,fa,Ca){const ia=X.originalText.replace(Y.Iyf,String.fromCharCode(32)),Ra=new H.Range(na.top-1,na.left,na.bottom-1,na.right,!1,!1),Ya=Ca?Ca.Bn(X.range):
null;(!X.bI||X.range.left===na.left)&&1<ia.length&&!Aa.kb(ia.toUpperCase())&&z.a.$I(ia,W)&&!z.a.equals(ia,W,!0)&&!Y.xZe(W)&&this.Ecg(ia)&&(!Q&&!Ya||!Q&&Ya.equals(Ca.Bn(Ra))||Q&&X.range.Fd(fa)&&X.range.top!==fa.top)&&(na=X.formulaBarText,z.a.equals(na,X.text,!1)||!na)&&(na={},na.FirstRow=X.range.top-1,na.FirstColumn=X.range.left-1,X=new w(ia,na),Aa.add(ia.toUpperCase(),X))}WHj(na){this.Eq=this.Z3h();this.LOa&&this.LOa.cancel();0<this.eb.text.length&&0!==na?this.items&&((1<this.items.length||this.te)&&
this.bqh(),8!==na&&127!==na&&46!==na&&(1===this.items.length?this.uod(!1):this.kZ.Rj&&this.mz(!1))):this.te=!1}bqh(){this.te?this.ePe():this.$ee=J.AsyncMethodContext.Dr(this.ePe,500,L.a.p2g,this.LOa)}uod(na){c.ULS.shipAssertTag(537167966,0,!this.Exa()&&1===this.items.length,"Invalid Items");let W=this.items[0].A$,X=this.eb.text,Aa=W.substring(X.length,W.length);if(na&&!Aa.length)this.eb.text=W;else if(!na&&0<Aa.length)this.eb.appendText(Aa),this.eb.textBox.selectRange(X.length,this.eb.text.length);
else return;this.raiseEvent("ACLBMatchedItem",new l.a(this.items.length,0,W));this.Rwa=!0}Z3h(){this.Eq=null;const na=new P.a(!1);var W=this.activeCell;this.TDa=this.eb.text.replace(Y.Iyf,String.fromCharCode(32));const X=this.tableManager.Bn(W),Aa=W.Fd(X);if(Y.xZe(this.TDa)||!this.Ecg(this.TDa))return this.items;const Q=new H.Range(1,W.left,W.top-1,W.left,!1,!1);var fa=new H.Range(W.top+1,W.left,f.a.gh,W.left,!1,!1);let Ca;const ia=A.h(this.$);fa=ia.jk("CellAutoCompleteControl.GetSuggestedCells",
fa);try{const Ra=ia.jk("CellAutoCompleteControl.GetSuggestedCells2",Q);try{for(const Ya of[Ra,fa])for(;Ya.$$mn();)Ca=Ya.$$cu(),this.yIg(W,this.TDa,Ca,na,Aa,X,this.tableManager)}finally{Ra&&Ra.dispose()}}finally{fa&&fa.dispose()}this.Eq=Array(na.values.length);for(W=0;W<this.items.length;W++)this.items[W]=na.values[W];this.items.sort((Ra,Ya)=>Ra.A$.localeCompare(Ya.A$));return this.items}jqb(na,W){na&&W&&this.E2c.push(new y(na,W,this.Jjf?this:void 0))}nEj(){return this.$li?this.p2a&&!this.Exa()&&this.te?
this.get_visible():!1:this.p2a&&!this.Exa()&&this.get_visible()&&this.te}static get Iyf(){return Y.Jge||(Y.Jge=new RegExp(String.fromCharCode(160),"g"))}static xZe(na){na=0<na.length?na.charCodeAt(0):-1;return 35===na||61===na||43===na||45===na||64===na}}Y.Jge=null;Object(t.a)(Y,"CellAutoCompleteControl",e.a,[631,632,633,3])},1228:function(t,E,a){t=a(0);var c=a(567),b=a(562),e=a(559),f=a(1002);class d{$fh(I,M){if(I&&!(1>I.length)&&M){var T=Object.assign(new e.a,{ExternalId:"msPresenceOuter",ControlList:[]});
this.tdh(I,T.ControlList);M.push(T)}}tdh(I,M){const T=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(M,T);M=Object.assign(new e.a,{Title:"",ControlList:[]});Array.add(T.Menu.MenuSectionList,M);this.Ffh(I,M.ControlList)}Ffh(I,M){for(let T=0;T<I.length;T++){const S=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",
T),Command:"336231556",DisplayName:I[T].userName,LabelText:I[T].userName,ImageBackColor:I[T].color,PersonaId:I[T].email,IsAnonymous:I[T].isAnonymous});Array.add(M,S)}}}Object(t.a)(d,"PresenceContextMenuSectionBuilder",null,[639]);var h=a(84),m=a(4),l=a(176),w=a(560),n=a(107),x=a(133),r=a(89),u=a(82),v=a(106),B=a(25);class z{constructor(I,M,T,S){this.k7d=this.W1=this.Xi=this.vE=this.I8=null;this.fZb=I;this.XDg=S;this.fZb.lNa&&(this.Xi=new n.a(3,2,5E3,Object(h.a)(this,this.KUg,"authenticationCheckTask"),
2),m.AFrameworkApplication.Fi.Eg(this.Xi),this.Hg(M,T));this.fZb.Nob(()=>{this.NAf()});this.fZb.VZa(()=>{this.OAf()})}get businessBar(){return this.W1||(this.W1=u.a.instance.yg("CommonUI.IBusinessBar"))}get gAe(){return this.k7d||(this.k7d=u.a.instance.yg("CommonUI.IBusinessBarEntryFactory"))}Hg(I,M){const T=m.AFrameworkApplication.ub;T.Me(B.a.authenticationLost,v.a.frame,I,96);T.Me(B.a.Yxe,v.a.frame,M,96);T.Nb(B.a.$Be,v.a.frame,l.ActionManager.$9c);T.Nb(B.a.aCe,v.a.frame,l.ActionManager.$9c);T.Nb(B.a.Dwd,
v.a.frame,l.ActionManager.$9c)}NAf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);m.AFrameworkApplication.ub.processAction(B.a.authenticationLost,2)}OAf(){this.KPj();m.AFrameworkApplication.ub.processAction(B.a.Yxe,2)}KUg(){this.fZb.authenticationCheck()}KPj(){this.vE&&(this.vE.hide(),this.vE.dispose(),this.vE=null);this.I8&&this.businessBar&&(m.AFrameworkApplication.Og||this.businessBar.removeEntry(this.I8),this.I8.dispose(),this.I8=null)}showDialog(I){r.a.Ia(this.vE);this.vE=new x.StandardDialog;
this.XDg||(this.vE.Lt=!1,this.vE.Tb=0);this.vE.qc(1,CommonUIStrings.l_SignIn);this.vE.CX(CommonUIStrings.l_DefaultDialogTitle,I,Object(h.a)(this,this.zw,"dialogHandler"))}zw(I){1===I?(w.a.d7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),m.AFrameworkApplication.ub.processAction(B.a.Dwd,2)):(this.UVd(),m.AFrameworkApplication.ub.processAction(B.a.aCe,2))}UVd(){this.businessBar&&this.gAe&&(this.I8=this.gAe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,
null),this.I8.closeable=!0,this.I8.addButton(CommonUIStrings.l_SignIn,z.c_g,""),this.I8.U$=Object(h.a)(this,this.f_g,"businessBarEntryCloseHandler"),this.businessBar.KE(this.I8,!1))}f_g(){this.Dnh();m.AFrameworkApplication.ub.processAction(B.a.$Be,2)}Dnh(){this.Xi&&(m.AFrameworkApplication.Fi.rp(this.Xi),this.Xi=null)}dispose(){this.Xi=this.vE=this.I8=null}static c_g(){w.a.d7();m.AFrameworkApplication.ub.processAction(B.a.Dwd,2)}}Object(t.a)(z,"SignOutResponseUI",null,[3]);var A=a(249);class y{get name(){return"Common.App.UI"}Oh(I){I.register(d,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").wc()}init(){}dispose(){r.a.Ia(y.E2);y.E2=null}static main(){A.a.instance.vi(new y)}}y.E2=null;Object(t.a)(y,"CommonAppUIPackage",null,[4,5]);a.d(E,"a",function(){return D});const D=()=>{Type.registerNamespace("CAUI");y.main()}},1229:function(t,E,a){t=a(0);var c=a(55),b=a(222),e=a(1222),f=a(48),d=a(37),h=a(1),m=a(698);class l extends b.a{constructor(B){super();this.$=B;this.Fb()}create(){const B=
this.$.da,z=f.GetServiceTaskFactory.create(B,134,this.ka,this.Ya),A=f.GetServiceTaskFactory.Na(B,213,214,this.Ya),y=h.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:7253099_CellAutoCompleteListBox_InnerHtml_CleanUp")?f.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):c.Task.Ra(null);d.TaskExtensions.za(d.TaskExtensions.Ed([z,A,y],this.ka),()=>{if(h.EwaSettings.ll())this.ob(Object(m.a)(this.$.da,1,()=>{const D=new e.CellAutoCompleteControl(this.$,
z.result,y.result);A.result.la(D);return D}));else{let D=B.Aa(1);D||(D=new e.CellAutoCompleteControl(this.$,z.result,y.result),A.result.la(D));this.ob(D)}},this.ka,3)}static la(B){B.da.Ga(151,new l(B))}}Object(t.a)(l,"CellAutoCompleteControlFactory",b.a,[]);var w=a(15),n=a(13);class x{constructor(B,z){this.c0a=null;this.PHf=(A,y)=>{1<y.length&&(A=n.a.instance.ga(857),this.ariaLiveNotifier.JSf(A,y.length))};this.QHf=(A,y)=>{w.ULS.shipAssertTag(537167961,0,0<=y.selectedIndex&&0<=y.length&&y.selectedIndex<
y.length,"Invalid ListEventArgs: SelectedIndex/Length");w.ULS.shipAssertTag(537167960,0,!!y.rG,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.Wbj(y.rG,y.selectedIndex+1,y.length)};this.RHf=(A,y)=>{this.ariaLiveNotifier.gRa(y.rG)};this.ariaLiveNotifier=B;h.EwaSettings.ll()||z.Ga(213,this)}dispose(){this.o1d();this.c0a=null}la(B){B&&(this.c0a=B,B.R0b(this.PHf),B.d3(this.QHf),B.xNg(this.RHf))}o1d(){this.c0a&&(this.c0a.Kvc(this.PHf),this.c0a.Yda(this.QHf),this.c0a.Yij(this.RHf))}}
Object(t.a)(x,"CellAutoCompleteReadoutHandler",null,[637,3]);class r extends b.a{constructor(B){super();this.$=B;this.Fb()}create(){const B=this.$.da;d.TaskExtensions.za(f.GetServiceTaskFactory.Na(B,211,212,this.Ya),z=>{if(h.EwaSettings.ll())this.ob(Object(m.a)(B,213,()=>new x(z.result,B)));else{const A=B.Aa(213)||new x(z.result,B);this.ob(A)}},this.ka,3)}static la(B){B.da.Ga(214,new r(B))}}Object(t.a)(r,"CellAutoCompleteReadoutHandlerFactory",b.a,[]);var u=a(9);a.d(E,"a",function(){return v});const v=
()=>{u.a.Fa(l.la);u.a.Fa(r.la)}},1230:function(t,E,a){var c=a(9);t=a(0);var b=a(235),e=a(222),f=a(48),d=a(37),h=a(1),m=a(15),l=a(89),w=a(4),n=a(78),x=a(8),r=a(24),u=a(66),v=a(40),B=a(138),z=a(47),A=a(46),y=a(12),D=a(13),I=a(21),M=a(27),T=a(19),S=a(52);class H extends n.a{constructor(aa,U,K,Y){super();this.isMac=M.a.isMac;this.qxa=!1;this.$=aa;this.ariaLiveNotifier=Y;this.zo=K.Y6b(aa,null,U,T.a.YUe,S.a.de(9),D.a.instance.ga(1731),"PulloutPointerDown")}gjg(aa){this.qxa!==aa&&(this.hide(),(this.qxa=
aa)?this.zo.Zjg(T.a.cBh,S.a.de(3)):this.zo.Zjg(T.a.YUe,S.a.de(9)))}get Cz(){return this.zo.Cz}get buttonWidth(){return this.zo.buttonWidth}dispose(){this.zo.dispose();this.$=null;super.dispose()}domElement(aa){return this.zo.domElement(aa)}getButton(aa){return this.zo.getButton(aa,!1)}mRb(aa,U){this.zo.mRb(aa,U,!1)}DBa(aa,U){const K=I.h(this.$),Y=K.ib.Mi(aa);this.zo.mRb(this.qxa?D.a.instance.ga(1733):U?D.a.instance.ga(1731):D.a.instance.ga(1732),Y);U=this.isMac?U?D.a.instance.ga(1736):D.a.instance.ga(1737):
U?D.a.instance.ga(1734):D.a.instance.ga(1735);var na=K.fg(aa,Y);aa=K.Df(Y).$m;if(na&&0<=na.x&&0<=na.y){const W=na.bottomRight.x+this.Cz;na=na.topLeft.y-this.Cz-this.buttonWidth;if(na<aa.topLeft.y+this.Cz){if(K.ib.nCa){this.hide();return}na=aa.topLeft.y+this.Cz}this.Tp(W,na,K.rtl,Y);this.ariaLiveNotifier.gRa(U)}else this.hide()}Tp(aa,U,K,Y){this.zo.Tp(aa,U,K,Y,!1)}hide(){this.zo.hide()}}Object(t.a)(H,"PulloutLaunchButton",n.a,[]);var C=a(33),G=a(22);class J extends n.a{constructor(aa,U,K,Y,na){super();
this.VYa=this.UQc=this.Wxc=this.wGa=this.pS=this.qP=null;this.$ie=0;this.jEb=this.QAb=this.GHc=!1;this.Cg=()=>{this.hxa&&(this.gridView?1===this.gridView.ha.Ne?(this.gridView.ha.ra.activeCell.equals(this.wGa)||this.UN||this.ty(),this.eqb.vq()):this.ty():m.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.Th=()=>{this.ty()};this.$c=()=>{this.AX()};this.xc=()=>{this.ty()};this.fd=()=>{this.showCallout()};this.oza=()=>{if(this.Wg.al&&this.Wg.al.length)if(this.j1c)this.Wg.kAi||
(this.GHc=this.Wg.al[0].BlockingDataForExpand),this.Wg.EUh&&m.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.$ie=this.Wg.f8c&&this.Wg.b0e<this.Wg.f8c.left-1?this.Wg.f8c.left-1-this.Wg.b0e:-1,this.showCallout();else if(this.gridView.ha.ra.Pg){var W=this.gridView.ha.ra.activeCell;if(W&&this.pS){var X=this.tableManager.Bn(W);this.HOc=!!X;const Aa=this.gridView.ha.ra.ed;X=this.UN&&this.pS.Fd(X);const Q=this.uld&&!this.UN&&Aa.equals(this.selectedRange);
X||Q?(m.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.Oac=!0,h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.UN&&this.tableManager.oka(W)?m.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.UN?this.Fh.DBa(this.pS,this.UN):this.Fh.DBa(Aa,this.UN):this.Fh.DBa(this.pS,
this.UN),this.Gwc())):m.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.Kj=()=>{this.j8a()&&this.Fh.hide();1===this.gridView.ha.Ne&&this.AX()};this.MR=()=>{const W=this.gridView.ha.Ne;this.gridView.ha.ra.activeCell&&1===W&&this.AX()};this.Tt=()=>{if(h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.UN){if(this.pS&&this.wGa){var W=this.tableManager.Bn(this.wGa);W&&1<W.bottom-W.top&&(--W.bottom,
this.gridView.dca(W)&&this.eqb.vq())}}else this.gridView.ha.ra.Pg&&this.gridView.dca(this.gridView.ha.ra.ed)&&this.eqb.vq();else this.pS&&this.wGa&&this.UN&&(W=this.tableManager.Bn(this.wGa))&&1<W.bottom-W.top&&(--W.bottom,this.gridView.dca(W)&&this.eqb.vq())};this.AX=()=>{if(this.$&&this.gridView){if(this.Oac&&this.UN){const W=this.gridView.ha.ra.activeCell;this.pS=this.gZe();const X=!!this.Wxc&&this.Wxc.contains(W);if(this.pS&&(W.equals(this.wGa)||X)){this.Fh.DBa(this.pS,this.UN);return}}this.Oac=
!1;(this.pS=this.gZe())&&this.sma&&this.gridView&&this.gridView.Da.rs(this.sma)?(this.j1c=!1,this.f_()):(this.Wg.d2c(),this.Wg.U3b());this.Oac||this.Fh.hide()}};this.$=aa;this.tableManager=K;this.contextMenuManager=Y;this.Fh=new H(aa,this.fd,U,na);this.Wg=U.M6c(aa,K);this.Oac=this.j1c=!1;this.uld=h.EwaSettings.oa(133);this.HOc=!0;this.MEa=!1;this.gridView=I.h(this.$);this.gridView.Vb.Zk(this.Th);this.gridView.pv(this.MR);this.$.$k(this.$c);this.$.xj(this.xc);this.$.DC(this.Kj);this.gridView.view.qt(this.Tt);
this.gridView.ha.bU(this.Cg);this.eqb=z.a.instance.create(this.AX,250,A.a.h9i);m.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Wg.I0b(this.oza);C.a.RAb()&&(this.QAb=!0);this.AX();aa.da.Ga(261,this)}get mc(){return this.Fh.domElement(1)}get sma(){return this.UQc}get selectedRange(){return this.VYa}get UN(){return this.HOc}get qxa(){return this.MEa}get GQf(){return this.$ie}get DDb(){const aa=this.Fh.domElement(this.ifa);return aa?y.DOMElementExtensions.isVisible(aa):!1}get hxa(){return this.$.isEditMode&&
h.EwaSettings.oa(133)?!(new B.a(this.$.va)).li:!1}get $Pg(){return this.GHc}get ifa(){return this.sma?this.gridView.ib.Mi(this.qP):1}dispose(){this.gridView&&(this.gridView.ha.iS(this.Cg),this.gridView.view.fr(this.Tt),this.gridView.Vb&&this.gridView.Vb.Uk(this.Th));if(this.$){const aa=this.$;aa.ul(this.$c);aa.tl(this.xc);aa.jG(this.Kj);I.h(aa).Ny(this.MR)}this.Wg&&this.Wg.Cvc(this.oza);l.a.Ia(this.Fh);this.Wg=this.$=this.gridView=this.eqb=this.Fh=null;super.dispose()}ty(){this.Fh.hide()}dea(){this.Fh?
this.Fh.getButton(this.ifa).udb():m.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Inj(){this.pS=null}aQf(){this.Fh&&this.Fh.hide()}a6h(){if(!this.uld||1!==this.selectedRange.width)return null;const aa=this.selectedRange.clone();for(;this.gridView.dca(aa);){aa.left+=1;aa.right+=1;if(!this.gridView.Df(this.gridView.ib.Mi(aa)).ui.He(aa))break;if(!this.gridView.Da.rs(aa))continue;const U=this.gridView.jk("PulloutManager.GetValidatedRangeToFill",aa,2);try{if(J.I2j(U))return aa}finally{U&&
U.dispose()}}return null}Gwc(){this.Wg.wdb()}showCallout(){this.hxa&&(this.Wg.O7a?(this.Fh.getButton(this.ifa).uIb(),h.EwaSettings.ll()?d.TaskExtensions.za(f.GetServiceTaskFactory.Na(this.$.da,8,9,0),aa=>{this.L9f(aa.result)},this.$.ka,3):this.L9f(this.contextMenuManager)):(this.j1c=!0,this.f_()))}L9f(aa){aa.Ngd("tableFieldList").i1(null,this.Fh.domElement(this.ifa),this.Wg,null,!0);this.Gwc()}gZe(){if(!this.hxa||!this.gridView||this.gridView.ha.Ta.$b||!this.gridView.ha.ra.Pg)return null;var aa=this.gridView.ha.ra.activeCell,
U=I.h(this.$).ib.Mi(aa);if(!aa)return null;this.wGa=aa.clone();var K=this.tableManager.Bn(aa);this.HOc=!!K;if(this.UN){this.Fh.mRb(D.a.instance.ga(1731),U);this.qP=J.qmg(K);if(!this.qP)return null;aa=!1;U=({dZ:aa}=this.tableManager.YHe(K,this.gridView)).returnValue||aa;this.GHc=aa;if(U)return this.Wxc=new r.Range(K.top,K.left,K.bottom,K.right,!1,!1),this.UQc=new r.Range(this.qP.top,this.qP.right+1,this.qP.top,this.qP.right+1,!1,!1),this.QAb&&(this.MEa=!1,this.Fh.gjg(this.MEa)),this.qP}else if(this.uld){this.VYa=
this.gridView.ha.ra.ed.clone();K=this.selectedRange.isSingle&&I.h(this.$).Ab.Qif(this.selectedRange);const Y=I.h(this.$).Ab.Sxa(this.selectedRange);this.QAb&&(this.MEa=K&&!Y);this.Fh.mRb(this.MEa?D.a.instance.ga(1733):D.a.instance.ga(1732),U);K&&!Y&&!this.jEb&&h.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&G.a.equals(w.AFrameworkApplication.uiCulture,"en-us",!0)&&(w.AFrameworkApplication.Hs("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.jEb=
!0);this.qP=J.qmg(this.selectedRange);if(!(this.QAb&&K||Y)||!this.qP||!this.selectedRange||h.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.oka(this.selectedRange))return null;this.UQc=this.a6h();if((h.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.dca(this.selectedRange):this.gridView.dca(this.qP))&&this.sma)return this.QAb&&this.Fh.gjg(this.MEa),this.Wxc=this.qP,m.ULS.sendTraceTag(537154137,
0,50,`PulloutManager:FindSelection, NextRange, ${this.sma?this.sma.toString():"null"}, RightColumnHeader, ${this.qP?this.qP.toString():"null"}, ActiveCell, ${aa?aa.toString():"null"}`),this.qP}return null}f_(){this.UN?this.Wg.f_(v.v(this.sma,this.$),!1,!0):this.MEa?this.Wg.e5i():h.EwaSettings.oa(133)&&this.Wg.f_(v.v(this.selectedRange,this.$),!0,!1)}j8a(){return this.$.ea.isNamedObjectViewMode&&u.f(this.$.na)}static I2j(aa){for(;aa.$$mn();)if(aa.$$cu().text||aa.$$cu().bI||aa.$$cu().ki||aa.ao.acf)return!1;
return!0}static qmg(aa){return aa.right===x.a.uh?null:new r.Range(aa.top,aa.right,aa.top,aa.right,!1,!1)}}Object(t.a)(J,"PulloutManager",n.a,[622,3]);class L extends e.a{constructor(aa){super();this.$=aa;this.Fb()}create(){c.a.Fa(aa=>{const U=f.GetServiceTaskFactory.Na(aa.da,12,477,this.Ya),K=f.GetServiceTaskFactory.Na(aa.da,66,134,this.Ya),Y=f.GetServiceTaskFactory.Na(aa.da,211,212,this.Ya);let na=b.a.Ra(null);const W=!h.EwaSettings.ll();W&&(na=f.GetServiceTaskFactory.Na(aa.da,8,9,this.Ya));d.TaskExtensions.za(d.TaskExtensions.Ed([U,
K,na,Y],aa.ka),()=>{W?this.ob(this.$.da.Aa(261)||new J(this.$,U.result,K.result,na.result,Y.result)):this.ob(this.$.da.Aa(261)||new J(this.$,U.result,K.result,null,Y.result))},aa.ka)})}static la(aa){aa.da.Ga(262,new L(aa))}}Object(t.a)(L,"PulloutManagerFactory",e.a,[]);a.d(E,"a",function(){return P});const P=()=>{c.a.Fa(aa=>{aa.oa(133)&&L.la(aa)})}},1239:function(t,E,a){t=a(0);var c=a(187);class b{IOj(r,u){r.set_visible(!1);u.set_visible(!0)}}Object(t.a)(b,"DefaultTabSwitchBehaviour",null,[351]);
class e{}e.wPj="TabsContainer";e.ePj="TabTitlesContainer";e.cPj="TabTitle";e.dPj="TabTitleText";e.uZd="TabTitleActive";Object(t.a)(e,"MultitabControlStyles",null,[]);var f=a(84),d=a(45),h=a(85),m=a(87),l=a(56);class w{constructor(r,u,v){this.wk=r;this.Zp=u;this.pJc=v;this.dga=document.createElement("a");l.a.bzc(this.dga,this.Zp);Sys.UI.DomElement.addCssClass(this.dga,e.dPj);Sys.UI.DomElement.addCssClass(this.wk,e.cPj);this.wk.appendChild(this.dga);this.dga.tabIndex=0;this.vEc();d.a.addHandler(this.wk,
"click",this.pJc);d.a.addHandler(this.wk,"keyup",Object(f.a)(this,this.Nab,"onTitleKeyUp"))}get mc(){return this.wk}get title(){return this.Zp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.wk,e.uZd)}set isActive(r){this.setActive(r)}dispose(){d.a.removeHandler(this.wk,"keyup",Object(f.a)(this,this.Nab,"onTitleKeyUp"));d.a.removeHandler(this.wk,"click",this.pJc);this.wk=this.dga=null}setActive(r){r?Sys.UI.DomElement.addCssClass(this.wk,e.uZd):Sys.UI.DomElement.removeCssClass(this.wk,
e.uZd);this.dga&&this.dga.setAttribute(m.a.v$,r)}Nab(r){r.keyCode!==h.a.Kh&&r.keyCode!==h.a.nfa||this.pJc(r)}vEc(){this.wk.setAttribute(m.a.Ad,m.a.Oq);this.dga.setAttribute(m.a.qv,this.Zp);this.dga.setAttribute(m.a.Ad,m.a.Xpb)}}Object(t.a)(w,"TabTitleControl",null,[3]);var n=a(39);a.d(E,"a",function(){return x});class x{constructor(r,u=null,v=null){this.wnb=this.Enb=null;this.R1=-1;this.wk=r;this.Uga=u||new c.a;this.WEg=v||new b;this.YFa=new c.a;r=0;for(let B of this.Uga)this.avd(this.R1)||(this.R1=
r),u=r++,this.YFa.add(new w(document.createElement("li"),B.title,this.fdh(u)))}get uCc(){return this.Uga.count}get activeTab(){return this.R1}set activeTab(r){this.Ldg(r)}get mc(){return this.wk}get visible(){return n.a.isVisible(this.wk)}set visible(r){this.wk.style.visibility=r?"visible":"hidden"}MXf(){this.Enb=document.createElement("ul");this.Enb.className=e.ePj;this.wnb=document.createElement("div");this.wnb.className=e.wPj;for(let r=0;r<this.uCc;++r){const u=this.Uga.ma(r),v=this.YFa.ma(r);
u.set_visible(!1);v.isActive=!1;const B=document.createElement("div");u.render(B);this.wnb.appendChild(B);this.Enb.appendChild(v.mc)}this.mc.appendChild(this.Enb);this.mc.appendChild(this.wnb);this.avd(this.R1)&&(this.YFa.ma(this.R1).isActive=!0,this.Uga.ma(this.R1).set_visible(!0))}dispose(){for(let r=0;r<this.uCc;++r)this.Uga.ma(r).dispose(),this.YFa.ma(r).dispose();this.YFa=this.Uga=this.wk=this.wnb=this.Enb=null}setFocus(){this.Uga.ma(this.R1).setFocus()}avd(r){return 0<=r&&r<this.uCc}Ldg(r){this.R1!==
r&&this.avd(r)&&(this.WEg.IOj(this.Uga.ma(this.R1),this.Uga.ma(r)),this.YFa.ma(this.R1).isActive=!1,this.YFa.ma(r).isActive=!0,this.R1=r,this.setFocus())}fdh(r){return()=>{this.Ldg(r)}}}Object(t.a)(x,"MultitabControl",null,[329,3])},1252:function(t,E,a){var c=a(9);t=a(0);var b=a(7),e=a(222),f=a(48),d=a(37);class h{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(t.a)(h,"FormulaAssistanceUIContext",null,[]);var m=a(185);class l extends e.a{constructor(n){super();this.ksj="formulaAssistance";
this.$=n;this.Fb()}create(){let n=this.$.da.Aa(448);if(n)this.ob(n);else{var x=f.GetServiceTaskFactory.Na(this.$.da,283,284,this.Ya);d.TaskExtensions.za(x,()=>{d.TaskExtensions.za(m.c(x.result.kn.loadScript(this.ksj)),()=>{n=this.$.da.Aa(448);if(!n){const r=Object(b.a)(new h,{isFeedbackAllowed:this.$.isFeedbackEnabled});n=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(r));this.$.lDe(()=>{const u={};u.isFeedbackAllowed=this.$.isFeedbackEnabled;n.updateContext(u)})}this.ob(n)},
this.$.ka,3)},this.$.ka,3)}}static la(n){n.da.Ga(449,new l(n))}}Object(t.a)(l,"FormulaAssistanceUIControlFactory",e.a,[]);a.d(E,"a",function(){return w});const w=()=>{c.a.Fa(n=>{l.la(n)})}},1253:function(t,E,a){var c=a(9);t=a(0);var b=a(55),e=a(222),f=a(48),d=a(37),h=a(21),m=a(15),l=a(31),w=a(209),n=a(24),x=a(66),r=a(1),u=a(1090),v=a(11),B=a(155),z=a(14),A=a(178),y=a(224),D=a(148),I=a(65),M=a(88);class T{constructor(C,G,J){this.BOa=1;this.W9=[];this.active=!1;this.htmlSanitizationHelper=null;this.oBb=
!1;this.onPointerDown=L=>{D.a.slim(L.Ca.rawEvent);return!1};this.Yw=()=>{const L=this.gridView.Lkd();if(!(0>=L||L===this.BOa||this.gridView.Tr)){var P=!1,aa=[],U=[];for(var K=this.W9.length-1;0<=K;K--){var Y=this.W9[K];if(this.Kkd(Y)>L||Y.bottom<L)aa.push(Y),this.W9.splice(K,1),P=!0}for(K=this.tableManager.rangeList.length-1;0<=K;K--){Y=this.tableManager.rangeList[K];const na=this.Kkd(Y);na<=L&&Y.bottom>=L&&!(na<=this.BOa&&Y.bottom>=this.BOa)&&Y.yba&&(U.push(Y),P=!0)}if(P){Y=this.gridView.hsc;for(let na of Y)for(let W of na)for(let X of W)this.oBb?
this.U3g(X,aa,U):this.V3g(X,aa,U,P)}else m.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.BOa=L}};this.XEf=(L,P)=>{P.isRow||P.MYc(this.Pfc)};this.YEf=(L,P)=>{P.isRow||(this.tableManager.rangeList.length||this.deactivate(),P.ONd(this.Pfc))};this.Pfc=(L,P)=>{if(this.Qd())this.activate();else if(L=this.active,this.deactivate(),!L){m.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");
return}(P=P.jo)&&this.abg(P.f5,P)};this.JHf=(L,P)=>{!this.gridView.Tr&&(this.Qd()?this.activate():(L=this.active,this.deactivate(),L||m.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),P=P.jo)&&(L=u.a(P.f5),this.abg(L,P)&&P.YSd(L))};this.ue=()=>{this.gridView.ib.c5?this.deactivate():this.activate()};this.tableManager=C;this.gridView=G;this.$=G.$;this.htmlSanitizationHelper=J;C.yYc(this.JHf);G.fNg(this.XEf);G.gNg(this.YEf);this.$.va.Wf(this.ue);
this.$.Cb.Wf(this.ue);this.xwe(L=>{L.MYc(this.Pfc)});this.oBb=this.gridView.ela;this.Qd()&&(this.activate(),this.Yw(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.CNd(this.JHf),this.gridView.Mij(this.XEf),this.gridView.Nij(this.YEf),this.$.va.Dg(this.ue),this.$.Cb.Dg(this.ue),this.xwe(C=>{C.ONd(this.Pfc)}));this.gridView=this.tableManager=this.W9=null}mDc(C,G,J){if(!x.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.nCa)return!0;const L=
J.O9e();var P=L.length;if(L[P-1]<C.left)return!1;var aa=v.HelperMethods.ow(new w.a(L),0,P,C.left,v.HelperMethods.GB);if(0>aa)return!1;const U=C.r_d;P=Math.min(U.length+aa,P);let K=0;for(;aa<P;aa++){const Y=L[aa];G?(J.updateCellText(aa,U[K]),this.Gqe(C,K,Y)):(J.updateCellText(aa,n.Range.nQ(Y)),this.fPe(Y));G&&J.$xj();J.cn("HeaderSnappingFeature::toggleHeaderSnapping",aa);K++}C.KBa=G;return!0}nDc(C,G,J,L){if(!x.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.nCa)return!0;if(!J.length)return!1;
var P=L.length;if(L[P-1]<C.left)return!1;var aa=v.HelperMethods.ow(new w.a(L),0,P,C.left,v.HelperMethods.GB);if(0>aa)return!1;const U=C.r_d,K=!!C.ata&&0<C.ata.length,Y=!!C.menuModel&&0<C.menuModel.length;for(let X=aa,Aa=0,Q=Math.min(U.length+aa,P);X<Q;X++,Aa++)if(P=J[X]){var na=null;(aa=P.getElementsByClassName(l.a.ocd))&&(na=aa[0]);if(na&&na.innerText){if(aa=P.getElementsByClassName(l.a.due))for(var W=aa.length-1;0<=W;W--)P.removeChild(aa[W]);aa=L[X];G?(na.innerText=U[Aa],P.classList.add(l.a.tWe),
K&&C.ata[Aa]&&(na=document.createElement("div"),r.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")&&this.htmlSanitizationHelper?(this.htmlSanitizationHelper.ni(na,C.ata[Aa]),W=C.ata[Aa].split(I.a.FRg),m.ULS.shipAssertTag(509678873,0,3===W.length,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain command data for ShowAutoFilterMenu"),W=M.a.xf(W[1]),
this.BIg(na.firstChild,W),B.a.instance.sa(z.a.uf,na.firstChild,this.onPointerDown),A.a.instance.sa(z.a.Mp,na.firstChild,this.onPointerDown)):na.innerHTML=C.ata[Aa],Y&&C.menuModel[Aa]&&this.Gqe(C,Aa,aa),P.appendChild(na.firstChild))):(P.classList.remove(l.a.tWe),na.textContent=n.Range.nQ(aa),this.fPe(aa))}}C.KBa=G;return!0}BIg(C,G){y.a.instance.sa(z.a.click,C,J=>{G&&D.a.hrc(J.Ca.rawEvent,966232027,G,this.$.get_id());return!0})}Gqe(C,G,J){this.$.da.fb(8,L=>{L.Xac.LTi(C,G,J)})}fPe(C){this.$.da.fb(8,
G=>{G.Xac.MTi(C)})}V3g(C,G,J,L){const P=C.Mt,aa=u.a(C.f5);let U;for(let K=G.length-1;0<=K;K--)U=G[K],this.nDc(U,!1,aa,P)&&G.splice(K,1);for(G=J.length-1;0<=G;G--)U=J[G],this.nDc(U,!0,aa,P)&&this.W9.push(U);L&&C.YSd(aa)}U3g(C,G,J){if(C.X0g()){for(var L=G.length-1;0<=L;L--)this.mDc(G[L],!1,C)&&G.splice(L,1);for(G=J.length-1;0<=G;G--)L=J[G],this.mDc(L,!0,C)&&this.W9.push(L)}}abg(C,G){const J=this.oBb?G.O9e():G.Mt;var L=J[0];const P=J[J.length-1],aa=this.z5h(L,P);let U=!1;for(let K=this.W9.length-1;0<=
K;K--){const Y=this.W9[K];P>=Y.left&&L<=Y.right&&(this.oBb?this.mDc(Y,!1,G):this.nDc(Y,!1,C,J),this.W9.splice(K,1),U=!0)}for(let K=0,Y=aa.length;K<Y;K++)if(L=aa[K],this.oBb?this.mDc(L,!0,G):this.nDc(L,!0,C,J))this.W9.push(aa[K]),U=!0;return U}activate(){this.Qd()&&!this.active&&(this.gridView.view.qt(this.Yw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.fr(this.Yw),this.active=!1)}Qd(){return x.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.ib.uP&&0<this.tableManager.rangeList.length}xwe(C){const G=
this.gridView.hsc;for(let J of G)for(let L of J)for(let P of L)C(P)}z5h(C,G){const J=[];if(!this.active)return J;this.BOa=this.gridView.Lkd();for(let L=this.tableManager.rangeList.length-1;0<=L;L--){const P=this.tableManager.rangeList[L];P.bottom>=this.BOa&&this.Kkd(P)<=this.BOa&&P.left>=C&&P.right<=G&&P.yba&&J.push(P)}return J}Kkd(C){const G=this.gridView.Ab.Cj(C);return G&&this.tableManager.dkf(C,G.usedRange.topLeft)?C.top+1:C.top}}Object(t.a)(T,"HeaderSnappingFeature",null,[3]);class S extends e.a{constructor(C){super();
this.$=C;this.Fb()}create(){const C=f.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),G=r.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:7126100_ReduceInnerHTMLUsageForHeaderSnappingFeature")?f.GetServiceTaskFactory.Na(this.$.da,498,499,this.Ya):b.Task.Ra(null);d.TaskExtensions.za(d.TaskExtensions.Ed([G],this.ka),()=>{d.TaskExtensions.za(d.TaskExtensions.Ed([C],this.ka),()=>{this.ob(this.$.da.Aa(68)||new T(C.result,
h.h(this.$),G.result))},this.ka,11)},this.ka,3)}static la(C){C.da.Ga(67,new S(C))}}Object(t.a)(S,"HeaderSnappingFactory",e.a,[]);a.d(E,"a",function(){return H});const H=()=>{c.a.Fa(S.la)}},1278:function(t,E,a){var c=a(9);t=a(0);var b=a(15),e=a(876),f=a(27),d=a(197),h=a(222),m=a(227),l=a(1),w=a(51),n=a(55),x=a(185),r=a(33);class u{constructor(){this._list={}}addHandler(y,D){var I;this._list[y]=[...(null!==(I=this._list[y])&&void 0!==I?I:[]),D]}removeHandler(y,D){const I=this._list[y];void 0!==I&&(D=
I.indexOf(D),0<=D&&(this._list[y]=[...I.slice(0,D),...I.slice(D+1)]))}getHandler(y){const D=this._list[y];return D&&0!==D.length?(I,M)=>{for(const T of D)T(I,M)}:null}static VKb(){Sys.EventHandlerList.prototype.addHandler=u.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=u.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=u.prototype.removeHandler}}Object(t.a)(u,"EventHandlerListOptimized",null,[]);class v{constructor(){this._list={}}addHandler(y,D){this.invalidate(y);
void 0===this._list[y]?this._list[y]=[D]:this._list[y].push(D)}invalidate(y){void 0!==this.zA&&this.zA.delete(y)}removeHandler(y,D){const I=this._list[y];void 0!==I&&0!==I.length&&(D=I.indexOf(D),0<=D&&(this.invalidate(y),I.splice(D,1)))}getHandler(y){void 0===this.zA&&(this.zA=new Map);var D=this.zA.get(y);return void 0===D?(D=this.makeHandler(y),this.zA.set(y,D),D):D}makeHandler(y){y=this._list[y];if(!y||0===y.length)return null;const D=[...y];return(I,M)=>{for(let T=0;T<D.length;++T)D[T](I,M)}}static VKb(){Sys.EventHandlerList.prototype.addHandler=
v.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=v.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=v.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=v.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=v.prototype.invalidate}}Object(t.a)(v,"EventHandlerListMemoized",null,[]);class B{constructor(y){this.a=y;this.preventDefault=B.YLf.preventDefault;this.stopPropagation=B.YLf.stopPropagation;const D=this.type=y.type.toLowerCase();this.rawEvent=
y;this.altKey=y.altKey;"undefined"!==typeof y.button&&(this.button="undefined"!==typeof y.which?y.button:4===y.button?Sys.UI.MouseButton.middleButton:2===y.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);"keypress"===D?this.charCode=y.charCode||y.keyCode:this.keyCode=y.keyCode&&46===y.keyCode?127:y.keyCode;this.clientX=y.clientX;this.clientY=y.clientY;this.ctrlKey=y.ctrlKey;this.target=y.target?y.target:y.srcElement;this.screenX=y.screenX;this.screenY=y.screenY;this.shiftKey=
y.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const y=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-y.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const y=
Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-y.y}}}static VKb(){Sys.UI.DomEvent=B;B.registerClass("Sys.UI.DomEvent",void 0,void 0)}}B.addHandler=Sys.UI.DomEvent.addHandler;B.addHandlers=Sys.UI.DomEvent.addHandlers;B.removeHandler=Sys.UI.DomEvent.removeHandler;B.clearHandlers=Sys.UI.DomEvent.clearHandlers;B._removeHandler=Sys.UI.DomEvent._removeHandler;B._clearHandlers=Sys.UI.DomEvent._clearHandlers;B._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;
B.YLf=Sys.UI.DomEvent.prototype;B.registerClass=function(y,D,I){this.prototype.constructor=this;this.__typeName=y;this.__class=!0;D&&(this.__baseType=D,this.__basePrototypePending=!0);Sys.__upperCaseTypes[y.toUpperCase()]=this;if(I){this.__interfaces=[];for(let M=2,T=arguments.length;M<T;M++)this.__interfaces.push(arguments[M])}return this};Object(t.a)(B,"DomEventLazy",null,[588]);class z extends h.a{constructor(y){super();this.$=y;this.$6b=null;this.Fb()}create(){b.ULS.sendTraceTag(537154643,0,50,
"PluginSchedulerFactory.Create: Loading scheduler slice");e.a.then(this.Nfh(),y=>{this.ob(y)})}Nfh(){if(this.$6b)return this.$6b;const y=m.a.l2a(w.b(),d.a.none,"LoadResource","x10Scheduler loading");if(l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var D=String.prototype;if(void 0===D.startsWithOriginal||void 0===D.endsWithOriginal)if(l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const I=document.createElement("frame");
document.body.appendChild(I);const M=I.contentWindow.String.prototype;document.body.removeChild(I);D.startsWithOriginal=M.startsWith;D.endsWithOriginal=M.endsWith}else D.startsWithOriginal=function(I,M=0){return this.lastIndexOf(I,M)===M},D.endsWithOriginal=function(I){return-1!==this.indexOf(I,this.length-I.length)};D.startsWith=D.startsWithOriginal;D.endsWith=D.endsWithOriginal}l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&u.VKb();l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",
!1)&&v.VKb();l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&B.VKb();if(l.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&f.a.Lw)return D=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,D),y.setResult(D),this.$6b=y.task;this.$.da.fb(266,()=>{this.$.da.fb(283,I=>{const M=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();I=x.b(n.Task.Ra(I.kn));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(I,0),r.a.nqb(this.$)?
excelOnlineCalc.x10.ensureGroupAttached(I,2):0]).then(T=>T.some(S=>0<S)).then(T=>{this.$.da.Ga(413,M);y.setResult(M);l.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&this.$.da.fb(491,S=>{S.vX.anyPluginInitialized=T})})})});return this.$6b=y.task}static la(y){y.da.Ga(414,new z(y))}}Object(t.a)(z,"PluginSchedulerFactory",h.a,[]);a.d(E,"a",function(){return A});const A=()=>{c.a.Fa(y=>{z.la(y)})}},1279:function(t,E,a){var c=a(9);t=a(0);var b=a(222),e=a(698),f=a(48),d=a(37);
class h extends b.a{constructor(l){super();this.$=l;this.Fb()}static la(l){l.da.Ga(521,new h(l))}create(){const l=()=>excelOnlineCalc.FormulaAuthoringHelperSingletonGlobal.instance();d.TaskExtensions.za(f.GetServiceTaskFactory.Na(this.$.da,266,265,0),()=>{this.ob(Object(e.a)(this.$.da,520,l))},this.$.ka,3)}}Object(t.a)(h,"FormulaAuthoringHelperFactory",b.a,[]);a.d(E,"a",function(){return m});const m=()=>{c.a.Fa(l=>{h.la(l)})}},1443:function(t,E,a){a.r(E);var c=a(1080),b=a(0),e=a(695),f=a(15),d=a(179),
h=a(60);const m=(mb,Nb,ic,gb,Eb,Lc)=>{if(Nb){const Ec=mb.textBox;mb.gb||mb.startEdit(Nb,!0);mb.qtd=!0;mb.text=ic;Ec.caretPosition=Eb;Eb<Lc&&(gb&&mb.MBa(),Ec.selectRange(0,Lc+1),Ec.selectRange(Eb,Lc))}};var l=a(76);class w{constructor(mb,Nb){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=mb;this.type=Nb}R5a(){return this.sharedSheetRange}}Object(b.a)(w,"MacroRecorderAutoSumPayload",null,[145]);var n=a(40),x=a(374),r=a(188),u=a(48),v=a(37),B=a(154),z=a(348),A=a(29),y=a(1),D=a(184),I=a(282),
M=a(21),T=a(124),S=a(564),H=a(55);class C extends d.a{constructor(mb){super();this.nNi=Nb=>{const ic=M.h(this.$);if(Nb=Nb.Result){let gb=n.D(Nb.NewSelection),Eb=n.D(Nb.NewActiveCell);if(gb&&Eb)if(!Nb.Committed&&Nb.AutoSumFormula){const Lc=ic.Ub(Eb);Lc&&(ic.ha.updateSelection(gb,Eb,60),gb=Eb=n.D(Nb.MarkedArea),ic.hK=2,m(ic.jc,Lc,Nb.AutoSumFormula,!!gb,Nb.FormulaMarkStart,Nb.FormulaMarkEnd),gb&&Eb&&ic.ha.updateSelection(gb,Eb,0),ic.jc.qtd=!1,v.TaskExtensions.za(u.GetServiceTaskFactory.create(this.$.da,
153,this.ka,0),Ec=>{Ec.result.XJa(null)},this.ka,3))}else ic.ha.updateSelection(gb,Eb,60)}};this.$=mb}nc(){return!1}executeCommand(mb,Nb,ic){mb=Nb.command;switch(mb){case 1220954656:case 505713221:Nb=this.mOe(0,Nb);break;case -1537138325:Nb=this.mOe(parseInt(ic[l.a.Kc].toString(),10),Nb);break;default:Nb=D.a(mb)}return Nb}yc(mb,Nb){if(mb=1===mb)switch(Nb.command){case 1220954656:case 505713221:case -1537138325:break;default:mb=!1}return mb}Lc(){return!1}mOe(mb,Nb){const ic=M.h(this.$);ic.yf.rH(!1);
if(!M.h(this.$).ha.ra.Pg)return Nb=M.h(this.$).ha.ra.YF,f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${mb} due to discontinuous selection. Number of selected ranges is ${Nb}`),this.Vza(),H.Task.Ra(!1);const gb=ic.BF();if(!gb)return null;const Eb=n.v(ic.ha.ra.ed,this.$),Lc=n.o(ic.ha.ra.activeCell,this.$),Ec=n.o(gb,this.$),Cb=this.$.pa.xa.Wb(),eb=()=>new w(Eb,mb);return this.$.aq(ic.ha.ra.selectedRanges,!0)?x.a(this.$.userOperationManager,(Sb,ld,bd)=>
{var ec=this.$.pa.xa;Sb=I.b(Sb,this.nNi);const sc=ec.Oa(9,Cb);sc.selectedRange=Eb;sc.activeCell=Lc;sc.autoSumType=mb;sc.topLeftCell=Ec;return h.g(ec,"AutoSum",sc,Sb,ld,bd,mb,0)},Sb=>new r.a(502,0,Sb,64,eb),Nb):H.Task.Ra(!1)}Vza(){S.a(T.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var mb=A.a.dd(1,1,751,2186,0,371863010,"DiscontinuousSelectionBlocking");y.EwaSettings.Lz()?new z.a(this.$,mb):(mb=new B.ErrorDialog(this.$,mb),mb.initialize(),mb.vg())}}Object(b.a)(C,"AutoSumCommandHandler",
d.a,[219]);class G extends e.a{constructor(mb){super(mb)}ld(){this.Zc([new C(this.$)])}static la(mb){e.a.Nd(96,new G(mb))}}Object(b.a)(G,"AutoSumCommandHandlerFactory",e.a,[]);var J=a(9),L=a(171),P=a(264),aa=a(38),U=a(324),K=a(1081),Y=a(283),na=a(64);class W extends aa.a{constructor(mb,Nb,ic){super();this.wOi=(gb,Eb)=>{if(!Y.a(gb)&&Eb){const Lc=!!gb&&!!gb.RequestTelemetryData;M.h(this.$).Eh.gma(Eb.toString(),gb.StateId,Lc?gb.RequestTelemetryData.EcsOperationDuration:0,Lc?gb.RequestTelemetryData.EcsRequestDuration:
0,Lc?gb.RequestTelemetryData.WfeRequestDuration:0)}};this.$=mb;this.tableManager=Nb;this.qg=ic}iMg(mb){this.addHandler("ekcvc",mb)}Xhj(mb){this.removeHandler("ekcvc",mb)}nc(){return!1}executeCommand(mb,Nb){mb=Nb.command;switch(mb){case -730106152:Nb=this.Eld(Nb,3);break;case -1228228458:Nb=this.Eld(Nb,4);break;case -848953656:case 2045211913:if(this.Cri()){Nb=H.Task.Ra(!0);break}Nb=this.Eld(Nb,1);break;default:Nb=D.a(mb)}return Nb}yc(mb,Nb){if(mb=1===mb)switch(Nb.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;
default:mb=!1}return mb}Lc(){return!1}Eld(mb,Nb){const ic=M.h(this.$),gb=ic.ha.ra.selectedRanges,Eb=mb.command,Lc=L.a.create().toString();if(!this.$.aq(gb,!0)&&-730106152!==Eb)return H.Task.Ra(!0);const Ec=n.r(gb,this.$);this.SHj(Eb,ic,gb,Lc);y.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.s$i();const Cb=this.$.pa.xa.Wb({Fca:!0,Mba:1}),eb=()=>new K.a(Nb,Ec);return x.a(this.$.userOperationManager,(Sb,ld,bd)=>{this.$.Py();return h.d(this.$.pa.xa,Nb,
Ec,!1,I.b(Sb,this.wOi),ld,bd,Lc,Cb)},Sb=>new r.a(508,0,Sb,67,eb),mb)}SHj(mb,Nb,ic,gb){if(-848953656!==mb&&2045211913!==mb&&-730106152!==mb&&-1228228458!==mb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${mb}.`);else if(!P.a.any(ic,Lc=>0<Nb.getRangeInformation(Lc).length)){var Eb=P.a.any(ic,Lc=>this.tableManager.Bud(Lc));if(-730106152!==mb&&-1228228458!==mb||!Eb)this.QLj(Nb,mb,gb,ic),-730106152!==mb&&-1228228458!==mb||this.qg.Aea(Nb,-730106152,{}),
-1228228458!==mb&&2045211913!==mb&&-848953656!==mb||this.qg.l5g(ic,gb),Nb.Eh.HS(gb,na.BasicTelemetryCalculator.jR)}}QLj(mb,Nb,ic,gb){let Eb="";switch(Nb){case -1228228458:Eb="ClearAll";break;case 2045211913:case -848953656:Eb="ClearContent";break;case -730106152:Eb="ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${Nb}.`)}Nb=gb.length;gb=n.b(gb);mb.Eh.l1(15,ic,Eb+(", ranges to clear: "+Nb+", cells to clear: "+
gb))}s$i(){this.raiseEvent("ekcvc",new U.a)}Cri(){if(M.h(this.$).Gz){const mb=this.$.da.Aa(296);return!!mb&&mb.YU.wB}return!1}}Object(b.a)(W,"ClearCommandHandler",aa.a,[219,638]);class X extends e.a{constructor(mb){super(mb)}ld(){const mb=u.GetServiceTaskFactory.create(this.$.da,134,this.ka,this.Ya),Nb=u.GetServiceTaskFactory.create(this.$.da,18,this.ka,this.Ya);v.TaskExtensions.za(v.TaskExtensions.Ed([mb,Nb],this.ka),()=>{const ic=new W(this.$,mb.result,Nb.result);this.Zc([ic]);this.$.da.Ga(313,
ic)},this.ka,3)}static la(mb){e.a.Nd(101,new X(mb))}}Object(b.a)(X,"ClearCommandHandlerFactory",e.a,[]);var Aa=a(1228),Q=a(1082),fa=a(1140),Ca=a(1084),ia=a(1085),Ra=a(1152),Ya=a(89),Ga=a(222),da=a(4),Z=a(106),ha=a(45),Wa=a(11),ca=a(84),ja=a(146);class ua{}ua.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(ua,"FileUploadDialogHTML",null,[]);var Za=a(152),Pa=a(25);class ka extends ja.a{constructor(mb){super(!1,!1,ka.$u);this.Xyd=!1;this.kvf=!0;this.tuf=0;this.Tb=1;this.qc(1,CommonUIStrings.l_Send);this.qc(0,CommonUIStrings.l_NoThanks);this.og=ua.HTML;this.muf=mb;this.Ee=ka.D_g}uj(mb,Nb,ic,gb=!1,Eb=!0){this.Xyd=gb;this.bHj(Nb);this.tuf=mb;Eb&&da.AFrameworkApplication.mG(mb)}bHj(mb){if(ka.$u)this.JIj(mb);else{var Nb={};Nb[ka.z_g]=mb;Nb[ka.F_g]=CommonUIStrings.l_SendFileErrorReportMessage;Nb[ka.G_g]=
CommonUIStrings.l_SendFileErrorReportTextCaption;Nb[ka.v1c]="";Nb[ka.C_g]=CommonUIStrings.l_UserReportLinkText;Nb[ka.A3b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ca.a)(this,this.Nyi,"legacyDialogHandler"),Nb);this.wX(ka.L_g)}}JIj(mb){mb={["id"]:this.Ee,["bodyControls"]:{["reportErrorCheckboxProps"]:this.Xyd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.kvf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:da.AFrameworkApplication.kna,["target"]:"_blank"}}},["errorMessage"]:mb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ca.a)(this,this.CKd,"reactDialogHandler"),mb)}rab(){if(!ka.$u){var mb=document.getElementById(ka.I_g);mb&&(mb.className=ka.H_g,mb.appendChild(Za.createClusteredImage(32,32,ka.E_g,null,!0,CommonUIStrings.l_DialogError)));
if(mb=document.getElementById(ka.J_g))mb.innerText=CommonUIStrings.l_PrivacyStatement,mb.href=da.AFrameworkApplication.kna,ha.a.addHandler(mb,"click",Object(ca.a)(this,this.UWi,"onPrivacyClickHandler"));this.kvf||(mb=document.getElementById(ka.v1c))&&mb.parentNode&&mb.parentNode.removeChild(mb);this.Xyd||(mb=document.getElementById(ka.B_g))&&mb.parentNode&&mb.parentNode.removeChild(mb)}}VI(){ka.$u||(super.VI(),document.getElementById(this.mi("WACDialogPanel")).style.width=String.format("{0}px",400))}Nyi(mb,
Nb){const ic=Nb[ka.v1c]||"";let gb=!0;void 0!==Nb[ka.A3b]&&null!==Nb[ka.A3b]&&(gb=Nb[ka.A3b]);this.zw(mb,ic,gb)}CKd(mb,Nb){this.zw(mb,Nb.text||"",Nb.reportErrorChecked)}zw(mb,Nb,ic){this.muf&&(ic&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.tuf),this.muf(mb,Nb,ic))}UWi(mb){da.AFrameworkApplication.ub.$d(Pa.a.YIb,2,mb)}get hZ(){return!1}static get $u(){return da.AFrameworkApplication.ta.Pa.Lv&&da.AFrameworkApplication.ta.Pa.dsi}}ka.z_g="WACDialogErrorMessage";ka.F_g=
"WACDialogErrorReportMessage";ka.G_g="WACDialogErrorTextPrompt";ka.v1c="WACDialogInput";ka.J_g="WACDialogPrivacyText";ka.I_g="WACDialogIconPanel";ka.E_g="CancelRequest_32x32x32";ka.H_g="WACDialogIcon";ka.L_g="WACDialogTextPanel";ka.A3b="WACDialogSendFileCheckbox";ka.B_g="WACDialogSendFileCheckboxContainer";ka.C_g="WACDialogSendFileCheckboxText";ka.D_g="FileUploadErrorDialog";Object(b.a)(ka,"FileUploadErrorDialog",ja.a,[]);class ra extends aa.a{constructor(mb){super();this.tPf=0;this.BH=null;this.Pgj=
Nb=>{this.fij(Nb)};this.D6g=(Nb,ic)=>{if(1===Nb&&this.BH.FileCollectionErrorStateId){Nb=this.$.pa.xa;var gb=this.BH.MessageId,Eb=this.BH.OriginalEcsServerId,Lc=this.BH.FileCollectionErrorStateId;const Ec=Nb.Oa(0);Ec.errorMessageId=gb;Ec.ecsServerId=Eb;Ec.fileCollectionErrorStateId=Lc;Ec.userComment=ic;Nb.N1c("CollectFile",Ec,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=mb}sMg(mb){this.addHandler("fileCollectionComplete",mb)}fij(mb){this.removeHandler("fileCollectionComplete",
mb)}C6g(mb,Nb,ic){this.tPf=Nb;this.BH=mb;this.sMg(ic);da.AFrameworkApplication.kna=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;mb=new ka(this.D6g);da.AFrameworkApplication.ub.Nb(Pa.a.YIb,Z.a.frame,ra.W7i);mb.uj(0,"",null,!1,!1)}static W7i(mb,Nb,ic,gb,Eb){ha.a.su(Eb);da.AFrameworkApplication.kna&&Wa.HelperMethods.kf(da.AFrameworkApplication.kna,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(ra,"FileCollectionOperation",aa.a,[636,3]);class ba extends Ga.a{constructor(mb){super();
this.MUb=null;this.$=mb;this.Fb()}get NFh(){return this.MUb||(this.MUb=new ra(this.$))}create(){v.TaskExtensions.za(u.GetServiceTaskFactory.create(this.$.da,155,this.ka,this.Ya),()=>{this.ob(this.NFh)},this.ka,3)}dispose(){Ya.a.Ia(this.MUb);this.MUb=null;super.dispose()}static la(mb){mb.da.Ga(125,new ba(mb))}}Object(b.a)(ba,"FileCollectionCommandHandlerFactory",Ga.a,[]);var Ua=a(1155),Ka=a(1088),Oa=a(1252),ib=a(7),La=a(645);class db{}Object(b.a)(db,"FreezePanesCommandParameters",null,[]);var Ab=a(8),
Mb=a(183),pb=a(24),Qb=a(389),xb=a(28),pa=a(269),Ma=a(271),ya=a(117);const Ea=(mb,Nb,ic,gb,Eb,Lc,Ec=null)=>{Ec=mb.Oa(9,Ec);Ec.freezeSettings=Nb;return h.g(mb,"FreezeOrUnfreezePanes",Ec,ic,gb,Eb,Lc,0)};class Na{constructor(mb){this.freezeOptions=null;this.freezeOptions=mb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(Na,"MacroRecorderSheetPaneFrozenPayload",null,[145]);var kb=a(44);class lb{constructor(mb,Nb){this.Ubc=this.GJd=null;this.dEf=()=>{y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.Iwc();if(this.Ubc){const ic=pa.a(xb.a.Sa.ve,this.Ubc);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${ic}`);this.Ubc=null}this.NLf()};this.$=mb;this.gridView=M.h(mb);this.ED=Nb.stb(this.$.domElement,500,null,null);this.bMa=this.aMa=-1}nc(mb,Nb){let ic=!1;switch(Nb){case 1844679312:ic=1!==mb&&!this.gridView.ib.c5}return ic}executeCommand(mb,Nb){mb=this.gridView.ib;const ic=this.gridView.ald();
da.AFrameworkApplication.ta.Pa.Nw&&this.$.O_&&(1844679312===Nb.command||340334732===Nb.command||-806625837===Nb.command)&&La.ShyRibbon.PJ(1,2);switch(Nb.command){case 1844679312:return this.setFreezePanes(Nb,ic,mb.rj);case 340334732:return mb.obc?H.Task.Ra(!1):this.Sxj(Nb,ic);case -806625837:return mb.nCa?H.Task.Ra(!1):this.Txj(Nb,ic)}return H.Task.Ra(!1)}yc(mb,Nb){mb=!1;switch(Nb.command){case 1844679312:case 340334732:case -806625837:case 1745254833:mb=!0}return mb}Lc(){return!1}setFreezePanes(mb,
Nb,ic){if(ic)return this.nyc(mb,!1,0,0,0,0,Nb,null);var gb=this.gridView.ha.ra;ic=gb.activeCell.clone();gb=gb.activeRange;gb.gf&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${ic.top}) and firstUnfreezeCell.Bottom (${ic.bottom}) to equal topLeftRange.Top (${Nb.top})`),ic.top=ic.bottom=Nb.top);gb.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${ic.left}) and firstUnfreezeCell.Right (${ic.right}) to equal topLeftRange.Left (${Nb.left})`),
ic.left=ic.right=Nb.left);ic.top===Nb.top&&ic.left===Nb.left&&(ic=pb.Range.Qc(ic.top+1,ic.left));gb=ic.top-1;const Eb=ic.left-1,Lc=gb-(Nb.top-1),Ec=Eb-(Nb.left-1);return this.X2j(ic,Lc,Ec)?this.nyc(mb,!0,gb,Eb,Lc,Ec,Nb,ic):(this.$.af(),this.NLf(),H.Task.Ra(!0))}Sxj(mb,Nb){return this.nyc(mb,!0,0,Nb.left,0,1,Nb,null)}Txj(mb,Nb){return this.nyc(mb,!0,Nb.top,0,1,0,Nb,null)}X2j(mb,Nb,ic){const gb=this.gridView.fg(mb),Eb=this.gridView.view.visibleArea;return!gb||Eb.topLeft.y>gb.bottomRight.y||Eb.topLeft.x>
gb.bottomRight.x||Eb.bottomRight.y<gb.bottomRight.y||Eb.bottomRight.x<gb.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${mb}, rangeViewportArea=${gb?gb.toString():"null"}, visibleArea=${Eb.toString()}`),mb=A.a.dd(1,0,26,1486,0,2105967339,"FreezePaneSelectionNotInViewErr"),y.EwaSettings.Lz()?new z.a(this.$,mb):(mb=new B.ErrorDialog(this.$,mb),mb.initialize(),mb.vg()),!1):0>=
Nb&&0>=ic?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),mb=M.h(this.$).rtl?1488:1487,Nb=M.h(this.$).rtl?-2131054257:-1953454131,mb=A.a.dd(1,0,26,mb,0,Nb,"FreezePaneA1SelectedErr"),y.EwaSettings.Lz()?new z.a(this.$,mb):(mb=new B.ErrorDialog(this.$,mb),mb.initialize(),mb.vg()),!1):!0}nyc(mb,Nb,ic,gb,Eb,Lc,Ec,Cb){this.GJd=kb.a(this.$).c$(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.$T(this.dEf);this.ED.iUa();
this.gridView.sMj(Nb?"":"UnsetFreezePane");this.pAj(mb,Nb,this.gridView.ib);const eb=Object(ib.a)(new db,{SheetName:this.$.na.name,Freeze:Nb,FrozenRows:Eb,FrozenColumns:Lc,FirstRow:ic,FirstColumn:gb});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${Nb}, FrozenRows=${Eb}, FrozenColumns=${Lc}, FirstRow=${ic}, FirstColumn=${gb} `);const Sb=()=>new Na(eb);this.Ubc=xb.a.Sa.ve;return x.a(this.$.userOperationManager,(ld,bd,ec)=>{if(y.EwaSettings.oa(59)){var sc=
window.performance;sc.clearMarks();sc.mark("FreezePanes request sent")}(sc=this.gridView.nt)?(sc=this.Zth(eb,sc,Ec,Cb),this.ETj(sc)):this.$.Py();return Ea(this.$.pa.xa,eb,ld,bd,ec,Nb)},ld=>new r.a(151,0,ld,void 0,Sb),mb)}Zth(mb,Nb,ic,gb){f.ULS.shipAssertTag(537159580,1,!!Nb,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!mb.Freeze)return null;const Eb=Ma.a();Eb.State=1;Eb.IsEstimated=!0;let Lc=!1,Ec=!1;const Cb=Nb.uV(pb.Range.Qc(ic.top,ic.left));
let eb=mb.FrozenRows;var Sb=mb.FrozenColumns;1!==mb.FrozenRows||mb.FrozenColumns?mb.FrozenRows||1!==mb.FrozenColumns?(Sb=Nb.uV(pb.Range.Qc(mb.FirstRow+1,mb.FirstColumn+1)),Nb=Nb.uV(pb.Range.Qc(ic.top,ic.left)),Eb.Width=Sb.yj-Cb.yj,Eb.Height=Sb.Qj-Cb.Qj,0<mb.FrozenRows&&(Eb.AbsoluteTop=Sb.Qj,Ec=!0),0<mb.FrozenColumns&&(Eb.AbsoluteLeft=Sb.yj,Lc=!0),eb=Sb.CL-Nb.CL,Sb=Sb.TJ-Nb.TJ):(Eb.Width=Nb.Bjd(Mb.a.Qc(ic.top,ic.left)),gb=pb.Range.Qc(ic.top,ic.left+1),Eb.AbsoluteLeft=Cb.yj+Eb.Width,Lc=!0):(Eb.Height=
Nb.Ajd(Mb.a.Qc(ic.top,ic.left)),gb=pb.Range.Qc(ic.top+1,ic.left),Eb.AbsoluteTop=Cb.Qj+Eb.Height,Ec=!0);Ec&&(Eb.FirstFrozenRow=ic.top,Eb.FirstScrollableRow=gb.top);Lc&&(Eb.FirstFrozenColumn=ic.left,Eb.FirstScrollableColumn=gb.left);Eb.VisibleRows=eb;Eb.VisibleColumns=Sb;return Eb}ETj(mb){H.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.na&&this.$.ea&&(this.$.ea.NX(Ab.a.se,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Qb.b(this.$.na,mb,-1,void 0,!0))})}pAj(mb,
Nb,ic){if(!y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(mb.command){case 1844679312:if(Nb||-1===this.aMa&&-1===this.bMa)this.aMa=ic.Lx-ic.width+this.gridView.scrollLeft,this.bMa=ic.Mx-ic.height+this.gridView.scrollTop;break;case 340334732:if(Nb||-1===this.aMa)this.aMa=ic.Lx-ic.width+this.gridView.scrollLeft;break;case -806625837:if(Nb||-1===this.bMa)this.bMa=ic.Mx-ic.height+this.gridView.scrollTop}}Iwc(){const mb=this.gridView.ib;0<mb.width?
this.gridView.scrollLeft=ya.a.k3b(this.gridView.domElement,M.h(this.$).rtl,0):-1!==this.aMa&&(this.gridView.scrollLeft=this.aMa,this.aMa=-1);0<mb.height?this.gridView.scrollTop=0:-1!==this.bMa&&(this.gridView.scrollTop=this.bMa,this.bMa=-1)}NLf(){this.ED.oUa();Ya.a.Ia(this.GJd);this.GJd=null;this.gridView.IO(this.dEf)}}Object(b.a)(lb,"FreezePanesCommandHandler",null,[219]);class oa extends e.a{constructor(mb){super(mb)}ld(){v.TaskExtensions.za(u.GetServiceTaskFactory.Na(this.$.da,12,477,this.Ya),
mb=>{this.Zc([new lb(this.$,mb.result)])},this.$.ka)}static la(mb){mb.da.Ga(116,new oa(mb))}}Object(b.a)(oa,"FreezePanesCommandHandlerFactory",e.a,[]);var Ba=a(1169),sa=a(27),qb=a(562),Jb=a(559),Yb=a(30),jb=a(996),ab=a(1089);a(316);var vb=a(13),Da=a(33);class Fa{constructor(mb,Nb){this.$=mb;this.fontServiceManager=Nb;this.menuId=this.k1c=this.eP=this.uva=null;this.Fed=0;this.THi="+mn-lt";this.VEi="+mj-lt";this.xRi=()=>{this.Q4f()};this.QWi=ic=>{this.amf=!0;this.$.qy(gb=>{gb.LQa("FontName_New")});
f.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${ic}`)};this.Dli=!!String.fromCodePoint&&!sa.a.Jv&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.amf=!1;this.Wl=y.EwaSettings.Wl();this.gridView=M.h(this.$);(this.ql=Da.a.ql())&&this.fontServiceManager&&(this.fontServiceManager.Ric?this.Q4f():this.fontServiceManager.Nse(this.xRi))}get themesManager(){this.Hx||(this.Hx=this.$.da.Aa(422));return this.Hx}Q4f(){this.eP=this.fontServiceManager.kCc;this.uva=
this.fontServiceManager.CJh;this.Fed=2}get kCc(){return this.eP}E0e(mb,Nb,ic,gb=null){const Eb=Object.assign(new qb.a,{Id:"FontDropdownMenu"});Eb.MenuSectionList=[];if(this.Wl&&this.themesManager){this.themesManager.tdd(gb);if((null==this.themesManager.zG||this.themesManager.Gud)&&!y.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return Eb;gb=Object.assign(new Jb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:vb.a.instance.ga(1332),ControlList:this.G4h(mb,Nb,ic)});Eb.MenuSectionList.push(gb)}gb=
Object.assign(new Jb.a,{ControlsId:"FontsMenuSectionControl"});if(this.Wl||this.ql)gb.Title=vb.a.instance.ga(1333);gb.ControlList=this.rVh(mb,Nb,ic);Eb.MenuSectionList.push(gb);return Eb}G4h(mb,Nb,ic){var gb;const Eb=[];var Lc=this.gridView.ha.Ta.$b;Lc=5===(null===(gb=null===Lc||void 0===Lc?void 0:Lc.floatingObject)||void 0===gb?void 0:gb.type);let Ec,Cb;this.themesManager.zG?(Ec=this.themesManager.zG.EAd,Cb=this.themesManager.zG.qzd):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(gb=this.AKe(Cb,
1,Lc,mb,Nb,ic))&&Eb.push(gb);(mb=this.AKe(Ec,2,Lc,mb,Nb,ic))&&Eb.push(mb);return Eb}AKe(mb,Nb,ic,gb,Eb,Lc){var Ec=2===Nb?this.THi:this.VEi;let Cb;if(mb)ic=ic?Ec:Yb.a.Xe(mb),Ec=Yb.a.Xe(Wa.HelperMethods.Gec(mb,Nb)),Cb=Yb.a.Xe(mb);else{if(!y.EwaSettings.isChangeGateEnabled("OfficeVSO:7395874_UnblockFontMenuOpen"))return null;ic=ic?Ec:void 0;Ec=Yb.a.Xe(String.fromCodePoint(0));Cb="msofp"}return Object.assign(new jb.a,{MenuItemId:2===Nb?ab.b:ab.a,CommandValueId:ic,LabelText:Ec,LabelCss:String.format("font-size:12pt;font-family:{0};",
Cb),Styles:Fa.Qxb(Cb),AriaLabel:Ec,Alt:Ec,Command:gb.toString(),CommandPreviewId:Eb.toString(),CommandRevertId:Lc.toString(),Disabled:!mb})}rVh(mb,Nb,ic){if(this.k1c)return this.k1c.P8c;let gb;const Eb=Wa.HelperMethods.v6(()=>{const Lc=this.Dli&&!this.amf;let Ec=!1;this.uva||(this.Vff(),Ec=!0);gb=this.aJe(mb,Nb,ic,this.uva,Lc,Ec);gb.jAc&&!Ec&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Vff(),gb=this.aJe(mb,
Nb,ic,this.uva,Lc,gb.jAc));this.ql&&!gb.jAc&&(this.k1c=gb);Lc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.QWi)});10<Eb&&f.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${Eb}`);return gb.P8c}aJe(mb,Nb,ic,gb,Eb,Lc){const Ec=[];let Cb;const eb=this.ql&&!Lc;Cb=eb?"msofpNew":"msofp";for(let sc in gb){var Sb=sc,ld=gb[sc],bd=Yb.a.Xe(Sb),ec=void 0;if(eb)if(ec=this.eP?this.eP[Sb]:null)ec=Yb.a.Xe(ec);else return f.ULS.sendTraceTag(520710161,
1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Sb}`),{jAc:!0,P8c:[]};else ec=Yb.a.Xe(Wa.HelperMethods.eP[Sb]);Sb=Yb.a.Xe(Sb);Eb||(ld=0);bd=Object.assign(new jb.a,{MenuItemId:bd,CommandValueId:bd,LabelText:Eb&&0<ld?Yb.a.Xe(String.fromCodePoint(ld)):ec,LabelCss:String.format("font-size:12pt;font-family:{0};",Eb&&0<ld?Cb:Sb),Styles:Fa.Qxb(Eb&&0<ld?Cb:Sb),AriaLabel:ec,Alt:ec,Command:mb.toString(),CommandPreviewId:Nb.toString(),CommandRevertId:ic.toString()});
Ec.push(bd)}return{jAc:Lc,P8c:Ec}}Oyj(mb){this.menuId=mb}qoi(){return 2!==this.Fed&&3!==this.Fed?!1:!0}Vff(){this.uva={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,
["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,
["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static Qxb(mb){const Nb={};Nb["font-family"]=mb;Nb["font-size"]="12pt";mb={};mb.optionText=Nb;return mb}}Object(b.a)(Fa,"FontDropdownHelper",null,[626]);var nb=a(698);class Ta extends Ga.a{constructor(mb){super();this.$=mb;this.Fb()}create(){y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.fb(504,mb=>{this.ob(Object(nb.a)(this.$.da,
502,()=>new Fa(this.$,mb)))}):this.ob(Object(nb.a)(this.$.da,502,()=>new Fa(this.$,null)))}static la(mb){mb.da.Ga(503,new Ta(mb))}}Object(b.a)(Ta,"FontDropdownHelperFactory",Ga.a,[]);var V=a(1253),va=a(1091),wb=a(1229),fc=a(1192),Fc=a(1138),Qa=a(1165),la=a(1278),hb=a(1230),Kb=a(1217);class dc{constructor(mb){this.$=mb}nc(){return!1}executeCommand(mb,Nb){mb=!1;Nb=Nb.command;switch(Nb){case 1910465940:mb=!0}return mb?H.Task.Ra(!0):D.a(Nb)}yc(mb,Nb){switch(Nb.command){case 1910465940:return!0;default:return!1}}Lc(){return!1}}
Object(b.a)(dc,"NameManagerCommandHandler",null,[219]);class sb extends e.a{constructor(mb){super(mb)}ld(){this.Zc([new dc(this.$)])}static la(mb){e.a.Nd(493,new sb(mb))}}Object(b.a)(sb,"NameManagerCommandHandlerFactory",e.a,[]);var bb=a(1175),Ob=a(1181),gc=a(1279);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(c.a)();J.a.Fa(G.la);J.a.Fa(X.la);Object(Aa.a)();Object(Q.a)();Object(fa.a)();Object(Ca.a)();Object(ia.a)();Object(Ra.a)();J.a.Fa(ba.la);Object(Ua.a)();Object(Ka.a)();Object(Oa.a)();(()=>{J.a.Fa(mb=>{oa.la(mb)})})();Object(Ba.a)();Object(V.a)();Object(va.a)();Object(wb.a)();Object(fc.a)();Object(Fc.a)();
Object(Qa.a)();Object(la.a)();Object(hb.a)();Object(Ob.a)();Object(Kb.a)();Object(bb.a)();Object(gc.a)();(()=>{J.a.Fa(mb=>{sb.la(mb)})})();(()=>{J.a.Fa(mb=>{Ta.la(mb)})})()},720:function(t,E,a){a.d(E,"a",function(){return L});t=a(0);var c=a(7),b=a(15),e=a(562),f=a(89),d=a(559),h=a(378),m=a(591),l=a(567),w=a(111),n=a(264),x=a(82),r=a(419),u=a(1400);E=a(78);var v=a(19),B=a(5),z=a(776),A=a(76),y=a(40),D=a(59),I=a(138),M=a(113),T=a(1),S=a(11),H=a(22),C=a(13),G=a(21),J=a(34);class L extends E.a{constructor(P,
aa,U,K,Y,na,W,X,Aa,Q,fa,Ca){super();this.Lnc=!1;this.cJc=this.SLc=this.contextMenuController=null;this.Rrd=!1;this.fxc=this.rub=null;this.kD=()=>{this.contextMenuController?this.contextMenuController.kD():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.vig()};this.jb=P;this.Bwf=Y;this.Mmb=Q;this.$Nf=na;this.populateOnlyOnce=W;this.uai=fa;this.vUf(Ca)}get contextMenuRoot(){return this.fxc}get $(){return this.jb}get Va(){return this.Mmb}get menuId(){return this.$.Eb+
this.Bwf}get wwb(){this.SLc||(this.SLc=M.a(this.$));return this.SLc}get Drb(){this.cJc||(this.cJc=G.h(this.$).Vb);return this.cJc}nc(P,aa){P=!0;switch(aa){case 1651433993:case 1675506831:case 966232027:P=this.Qd(4096)||this.Qd(2048);break;case 2045563128:P=this.Qd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:P=this.Qd(8192)}return!P}Lc(P,aa,U){U.IsShadowMenuOpen||z.i(this.$,z.d);P=!1;aa===this.ax&&(U.IsShadowMenuOpen||z.i(this.$,z.a),aa=Object(c.a)(new e.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]}),this.MHd(aa,U.IsShadowMenuOpen),U.MenuItems=aa,U.IsShadowMenuOpen||z.i(this.$,z.c),P=!0);P&&this.Lnc&&S.HelperMethods.l3b&&!U.IsShadowMenuOpen&&z.k(this.$);return P}MHd(P,aa){(aa=this.xZ(aa))?(this.gef(aa),P.MenuSectionList.push(...aa.NC().MenuSectionList),this.mKg(P)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}xZ(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}i1(P,aa,U,K,Y){P=Sys.UI.DomElement.getBounds(aa);aa=new Sys.UI.Point(P.x,P.y+P.height);this.$.isChromeRtl&&(aa.x+=P.width);this.Tp(aa,Y)}Tp(P,aa,U=0){aa&&(P=J.a(this.$).qka(P));aa=!0;if(this.uai){let K;3===U?(K=this.rLa(3))&&0<K.length?(aa=!1,this.showFloatie(K,new Sys.UI.Bounds(P.x,P.y,0,0),U)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):
2===U&&this.$.isEditMode&&((K=this.rLa(2))&&0<K.length?K[0]!==L.QZe?(aa=!1,this.fWd(K,new Sys.UI.Bounds(P.x,P.y,0,0),U)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}aa&&this.showContextMenu(new Sys.UI.Bounds(P.x,P.y,
0,0),U)}rLa(){return null}vjd(P,aa=null){let U="";3===P?U="touch":2===P&&(U="mouse");return{["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!D.a.Ag&&D.a.Ag.QK,["IsReactMLR"]:!!D.a.Ag&&D.a.Ag.ZV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:U,["FloatieGroups"]:JSON.stringify(aa)}}showContextMenu(P,aa=0){const U=this.vjd(aa);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(U)}`);this.contextMenuController?this.PB!==
B.a.DKd&&this.PB!==B.a.EKd||0===aa?this.contextMenuController.eWd(this.PB,P,A.a.Db):this.contextMenuController.eWd(this.PB,P,aa):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(P,aa,U){const K=this.vjd(U,P);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(K)}`);this.contextMenuController?(this.DUf(),this.contextMenuController.LAc(P,
aa,U)):(P=JSON.stringify(P),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${P}.`))}fWd(P,aa,U){var K=this.vjd(U,P);K=JSON.stringify(K);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${K}`);this.contextMenuController?(this.DUf(),this.contextMenuController.dWd(P,aa,U,this.PB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}vUf(P){this.contextMenuController=
P}dispose(){this.$&&this.$.Ka.Rcb(this);this.jb=null;this.vig();this.fxc&&(f.a.Ia(this.fxc),this.fxc=null);super.dispose()}VLh(P){var aa=this.$.da.Aa(204);aa&&(aa=aa.CMh(this.Bwf))&&P.tc.push(aa)}Qd(P){return(new I.a(this.$.va)).Qd(P)}gef(P){for(const aa of P.tc)if(Object(r.a)(311,aa)){P=aa;P.title&&(P.title=L.xf(P.title));for(const U of P.buttons)Object(r.a)(312,U)?(P=U,P.label=L.xf(P.label),P.yS(L.xf(P.alt))):Object(r.a)(313,U)&&this.gef(U.menu)}}ywf(P,aa=!1){const U=[];for(const K of P)U.push(this.eD(K,
aa));return U}eD(P){const aa=[];for(const U of P.MenuItems)switch(U.Type){case 3:aa.push(this.Xbh(U));break;case 2:aa.push(this.Jhh(U));break;case 1:aa.push(this.udh(U))}return Object(c.a)(new d.a,{ControlList:aa,Title:P.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Ifd(P,aa){aa=[this.rub,P.RibbonCommand.toString(),aa?this.K4e(aa):this.K4e(P.Label),P.Disabled?P.Disabled.toString():"False"];let U=P.CommandData;U=H.a.hashCode(U).toString();
aa.push(U,P.Identifier.toString());aa=aa.join("_");P.IsChecked&&(aa+="_Checked");return aa}DMh(P){const aa=[this.rub,H.a.hashCode(P.Title).toString()];for(const U of P.MenuItems)aa.push(U.RibbonCommand.toString());return aa.join("_")}D0e(P){var aa=P.Label;aa=H.a.hashCode(aa).toString();aa=[this.rub,aa];T.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&P.Id&&aa.push(H.a.hashCode(P.Id).toString());aa=aa.join("_");P.IsChecked&&(aa+="_Checked");return aa}Xbh(P){let aa,
U,K;({label:U,KMa:K,Mr:aa}=this.fcc(P,!1));const Y=this.Ifd(P,U);return Object(c.a)(new h.a,{Command:P.Disabled?(-251203935).toString():aa.toString(),ExternalId:Y,Id:Y,Image16by16Class:K,LabelText:U||P.Label,MenuItemId:P.CommandData,CommandValueId:P.CommandData})}Jhh(P){let aa,U,K;({label:U,KMa:K,Mr:aa}=this.fcc(P,P.IsChecked));const Y=this.Ifd(P,U);return Object(c.a)(new m.a,{Command:P.Disabled?(-251203935).toString():aa.toString(),ExternalId:Y,Id:Y,Image16by16Class:K,LabelText:U||P.Label,MenuItemId:P.CommandData,
CommandValueId:P.CommandData,IsChecked:P.IsChecked})}udh(P){let aa;var U;({label:aa,KMa:U}=this.N0e(P));const K=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});K.MenuSectionList.push(...this.ywf(P.SubMenu.Sections,!0));const Y=this.D0e(P);P=aa||P.Label;return Object(c.a)(new l.a,{ExternalId:Y,Id:Y,LabelText:P,PopulateOnlyOnce:!1,Menu:K,Image16by16Class:U,ImageIsVisible:!!U})}N0e(P){let aa,U;({label:P,KMa:aa,Mr:U}=this.fcc(P,!0));return{label:P,KMa:aa,Mr:U}}fcc(P,aa){let U;switch(P.Identifier){case 26:U=
912804500;aa=v.a.bWe;P=C.a.instance.ga(1942);break;case 3:U=-1902148570;aa=aa?v.a.Iaa:null;P=C.a.instance.ga(1902);break;case 4:U=-1902148570;aa=aa?v.a.Iaa:null;P=C.a.instance.ga(1903);break;case 5:U=-1902148570;aa=aa?v.a.Iaa:null;P=null;break;case 1:U=-1677817820;aa=v.a.Y$b;P=C.a.instance.ga(233);break;case 2:U=-1649376918;aa=P.IsChecked?v.a.bva:null;P=C.a.instance.ga(2116);break;case 23:U=1701016594;aa=P.IsChecked?v.a.bva:null;P=C.a.instance.ga(2116);break;case 6:U=-87741481;aa=null;P=C.a.instance.ga(2117);
break;case 7:U=1948650742;aa=v.a.MUe;P=C.a.instance.ga(1940);break;case 8:U=1933713114;aa=v.a.LUe;P=C.a.instance.ga(1941);break;case 14:U=504133448;aa=v.a.gKa;P=C.a.instance.ga(145);break;case 30:U=504133448;aa=v.a.gKa;P=C.a.instance.Ua(744);break;case 32:U=504133448;aa=v.a.gKa;P=C.a.instance.ga(149);break;case 34:U=504133448;aa=v.a.gKa;P=C.a.instance.ga(151);break;case 27:U=1701016594;aa=aa?v.a.$$b:v.a.gKa;P=C.a.instance.ga(145);break;case 15:U=-798968736;aa=v.a.hKa;P=C.a.instance.ga(147);break;
case 31:U=-798968736;aa=v.a.hKa;P=C.a.instance.Ua(745);break;case 33:U=-798968736;aa=v.a.hKa;P=C.a.instance.ga(150);break;case 35:U=-798968736;aa=v.a.hKa;P=C.a.instance.ga(152);break;case 28:U=1701016594;aa=aa?v.a.aac:v.a.hKa;P=C.a.instance.ga(147);break;case 21:U=-2058042992;aa=v.a.R3a;P=null;break;case 29:U=1701016594;aa=v.a.R3a;P=null;break;case 9:U=1701016594;P=aa=null;break;case 11:U=-1494291901;P=aa=null;break;case 25:U=-1045020714;aa=P.IsChecked?v.a.bva:null;P=null;break;case 13:U=1701016594;
aa=P.IsChecked?v.a.bva:null;P=C.a.instance.ga(154);break;case 16:U=1701016594;aa=v.a.Q$b;P=C.a.instance.ga(1078);break;case 17:U=1701016594;aa=v.a.Q3a;P=null;break;case 18:U=1701016594;aa=v.a.P3a;P=null;break;case 19:U=1701016594;aa=v.a.R$b;P=C.a.instance.ga(1083);break;case 20:U=1701016594;aa=v.a.Lbd;P=C.a.instance.ga(1084);break;case 24:U=1675506831;P=aa=null;break;case 22:U=P.RibbonCommand;aa=P.IsChecked?v.a.Iaa:null;P=null;break;case 36:U=1461300262;aa=null;P=C.a.instance.ga(153);break;case 38:U=
P.RibbonCommand;aa=v.a.$bd;P=C.a.instance.ga(1813);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(P)}`),U=1461300262,P=aa=null}return{label:P,KMa:aa,Mr:U}}K4e(P){return H.a.hashCode(P+S.HelperMethods.Dvj).toString()}mKg(P){if(!this.$.ea.amIAlone){var aa=this.$.da.Aa(25);if(aa&&!w.a.isEmpty(aa.PCa)&&(aa=aa.p6h(),!n.a.sh(aa))){var U=[];x.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").$fh(aa,U);P.MenuSectionList.push(...U)}}}DUf(){this.Rrd||
(this.wwb&&this.wwb.P0b(this.kD),this.Drb&&this.Drb.P0b(this.kD),this.Rrd=!!this.wwb||!!this.Drb)}vig(){this.wwb&&this.wwb.Jvc(this.kD);this.Drb&&this.Drb.Jvc(this.kD);this.Rrd=!1}static Tqd(P,aa){aa=y.C(aa);P=G.h(P).Da.CLa(aa);return!(null===P||void 0===P||!P.Qk)}static Ogd(P,aa,U){aa=y.C(aa);var K=G.h(P).Da.CLa(aa);aa=G.h(P).getCellBounds(K);const Y=K.WUg;K=K.VUg;let na=aa.x+Y.x;aa=aa.y+Y.y;U&&T.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(G.h(P).rtl||(na+=K),aa-=
K);return new Sys.UI.Point(na,aa)}static XDh(P){try{Object(u.a)(P.CommandValueId)}catch(aa){}}static xf(P){const aa=L.Bua.parseFromString(P,"text/html");return aa?aa.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),P)}}L.Bua=new DOMParser;L.QZe="Unsupported";Object(t.a)(L,"ContextMenuBase",E.a,[219,314,3])},776:function(t,E,a){a.d(E,"j",function(){return"ContextMenuPerf.A"});a.d(E,"b",function(){return"ContextMenuPerf.B"});a.d(E,"d",function(){return"ContextMenuPerf.C1"});
a.d(E,"a",function(){return"ContextMenuPerf.C2"});a.d(E,"c",function(){return"ContextMenuPerf.D"});a.d(E,"e",function(){return w});a.d(E,"f",function(){return r});a.d(E,"h",function(){return u});a.d(E,"i",function(){return v});a.d(E,"k",function(){return B});a.d(E,"g",function(){return A});var c=a(15),b=a(323),e=a(8),f=a(61),d=a(24),h=a(11),m=a(21),l=a(1);const w=(y,D)=>{var I=y.Ub(null);if((null===I||void 0===I?0:I.cell.Qk)&&n(I,y,D))return y.getCellBounds(I.cell);I=y.ha.ra.activeCell;return(D=x(new d.Range(I.top,
I.left,e.a.gh,I.left,!1,!1),2,!0,y,D)||x(new d.Range(1,I.left,I.top,I.left,!1,!1),2,!1,y,D)||x(new d.Range(I.top,I.right,I.top,e.a.uh,!1,!1),1,!0,y,D)||x(new d.Range(I.top,1,I.top,I.right,!1,!1),1,!1,y,D)||null)&&D.Qk?y.getCellBounds(D):Sys.UI.DomElement.getBounds(y.Jwa.mc)},n=(y,D,I)=>{var M=D.rtl,T=I.isChromeRtl;y=y.cell;return(I=m.h(I).sK(y))?(I=I.topLeft,M=I.x+=M===T?y.offsetWidth:0,T=I.y+=y.offsetHeight,D.view.visibleArea.contains(new f.a(M,T,0,0))):!1},x=(y,D,I,M,T)=>{y=M.jk("ContextMenuHelper.FindFirstCellInViewportArea",
y,D,I);try{for(y.$$rst();y.$$mn();){const S=y.$$cu();if(S&&n(S,M,T))return S.cell}}finally{y&&y.dispose()}return null},r=y=>y.Ab.N5(y.ha.ra.activeCell),u=y=>{y=m.h(y).ha.ra;return y.Pg&&(y.ed.isRow||y.ed.gf)},v=(y,D)=>{h.HelperMethods.Q0c&&window.performance.mark(D)},B=()=>{if(b.a.Oqb){const y=z("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),D=z("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),I=z("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,
0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${y}], PrepInfraWork=[${D}], EWAPopulation =[${I}]`)}},z=(y,D,I)=>{window.performance.measure(y,D,I);D=window.performance.getEntriesByName(y);D.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${y}] returned no measures.`);return D[D.length-1]?D[D.length-1].duration:-1},A=y=>l.EwaSettings.isChangeGateEnabled("OfficeVSO:7214067_CheckShareModeCapability")?y.qd&33554432?!0:!1:!0},778:function(t,
E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.dSe="ewa-ac";c.suh="ewa-ac-param";c.tTe="ewa-function-help-link";c.L$b="ewa-lb";c.oTe="ewa-fb-refactor";c.listItem="list-item";c.PDb="list-item-selected";c.TDb="list-table-touch";c.SDb="list-table";c.rzh="ewa-suggested-cell-name";c.Q6g="columnName-header";c.qUe="ewa-tt";c.Swh="ewa-function-link-container";c.uTe="ewa-function-udf-name";c.rtl="rtl";Object(t.a)(c,"CssClassNames",null,[])},814:function(t,E,a){a.r(E);t=a(0);var c=a(15),b=a(819),e=
a(726),f=a(5),d=a(76),h=a(52),m=a(199),l=a(35),w=a(1),n=a(13);class x{constructor(P,aa,U,K,Y,na,W,X){this.Htg=P;this.Itg=aa;this.Gtg=U;this.dha=K;this.IEg=Y;this.$Ag=na;this.elb=W;this.$zg=X}get mze(){return this.Htg}get c3b(){return this.Itg}get lze(){return this.Gtg}get width(){return this.dha}get FNj(){return this.IEg}get QLi(){return this.$Ag}get lineHeight(){return this.elb}get jzi(){return this.$zg}static NXg(){return new x("BorderStyleSolidLine",1957,1,"1","",1,8,0)}static JXg(){return new x("BorderStyleDashedLine",
1958,3,"1","5,3",1,8,0)}static KXg(){return new x("BorderStyleDottedLine",1959,4,"1","1,1",1,8,0)}static MXg(){return new x("BorderStyleMediumLine",1960,2,"2","",1,8,0)}static OXg(){return new x("BorderStyleThickLine",1961,5,"3","",1,8,0)}static LXg(){return new x("BorderStyleDoubleLine",1962,6,"1","",2,8,3)}}Object(t.a)(x,"BorderLineStyleProperties",null,[]);class r{constructor(){this.iconName=this.title=this.key=null}}Object(t.a)(r,"BorderLineStyleProps",null,[]);class u{constructor(P){P.OUf()}getBorderLineStyleProps(){const P=
a(814).BorderFormatManager.u0a,aa=Array(Object.keys(P).length);let U=0;for(let na in P){var K=na,Y=P[na];aa[U]=new r;aa[U].key=K;K=Y;aa[U].title=n.a.instance.ga(K.c3b);aa[U].iconName=K.mze;U++}return aa}}Object(t.a)(u,"BorderMenuController",null,[667]);var v=a(264),B=a(85),z=a(240),A=a(14),y=a(108),D=a(24),I=a(47),M=a(46),T=a(208),S=a(11),H=a(21),C=a(34),G=a(40);class J{constructor(P,aa){this.QIb=this.ribbonCommandInfo=this.cellFormat=this.ds=this.qb=this.ha=null;this.Suc=!1;this.qPf=this.VMa=this.ZId=
this.Fbe=this.bAa=this.hna=null;this.e3b=this.Hua=this.wPf=0;this.borderStyle=this.v0a=this.borderColor=null;this.wB=!1;this.currentSelectedRange=this.Tbb=null;this.M0=()=>{if(!this.wB||H.h(this.$).Gz)this.wB=!1,H.h(this.$).Gz=!1,this.Hua=0,H.h(this.$).yf.hm(f.a.ZQ),1===this.$.Ka.NH()&&(H.h(this.$).Y4(w.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?G.d(this.ZId):v.a.clone(this.ZId),this.wPf,this.$.na?this.$.na.sheetName:null,null,this.qPf.clone(),null,null,0,"DrawBorderBehavior.ResetBehavior",
!0),H.h(this.$).OTa(!0)),this.Yv(),this.l1d(),this.gk(),this.Suc=!1,this.bAa=this.hna=null,this.ds&&(this.ds.cancel(),this.ds.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=U=>{try{if(U=this.Vd(U),H.h(this.$).Gz=!0,this.hna={},this.bAa={},this.Tbb=null,this.Rqb(this.e3b),2===U.tb){const K=H.h(this.$).ha.mo(U.clientPoint,U.Gb,5,void 0,void 0,!1);K&&(this.currentSelectedRange=this.VMa=K,this.kej())}}catch(K){H.h(this.$).Gz=
!1}return!0};this.Hh=U=>{try{U=this.Vd(U);const K=H.h(this.$).ha.mo(U.clientPoint,U.Gb,5,void 0,void 0,!1),Y=H.h(this.$).Da.rs(K);if(!this.QIb||Y&&(Y.gR!==this.QIb.gR||Y.fR!==this.QIb.fR))if(this.wB=!0,this.QIb=Y,K){let na=new D.Range(this.VMa.top,this.VMa.left,this.VMa.top,this.VMa.left,!0,!1);na.union(K);na=H.h(this.$).ha.G0h(na);this.j3b(K);this.o_f(this.Tbb,na);if(this.bottomRightCorner(na.bottom,na.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;const W=new D.Range(na.top,na.left,na.bottom+1,na.right+1,!0,!1),X=H.h(this.$).kaa("DrawBorderBehavior.OnPointerMove",[W]);if(this.hna&&this.bAa)for(;X.$$mn();){const Aa=X.$$cu(),Q=Aa.cell.getRange().toString();Q in this.hna&&1!==this.Hua||(this.hna[Q]=Aa,this.bAa[Q]=Aa.cell.pN())}this.Tbb=W;this.currentSelectedRange=na;H.h(this.$).Y4([na],0,this.$.na.sheetName,null,na.topLeft,null,null,0,"DrawBorderBehavior.OnPointerMove",!0);this.qg.Aea(H.h(this.$),-1690267012,this.cellFormat,!0,null,[na])}return!0}catch(K){return H.h(this.$).Gz=
!1}};this.Qf=U=>{U=this.Vd(U);(U=H.h(this.$).ha.mo(U.clientPoint,U.Gb,5,void 0,void 0,!1))?this.wB&&(this.j3b(U),this.VMa.union(U),3===this.Hua?this.Rqb(0):this.Rqb(this.e3b),H.h(this.$).Y4([this.VMa],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp1",!0),this.qg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.Hua?this.Rqb(0):this.Rqb(this.e3b),H.h(this.$).Y4([this.currentSelectedRange],0,this.$.na.sheetName,null,null,null,null,0,"DrawBorderBehavior.OnPointerUp2",
!0),this.qg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));this.wB=!1;this.l1d();this.bAa=this.hna=null;return!0};this.onKeyDown=U=>{U=this.Vd(U);if(this.wB||[17,16,18,20].includes(U.Ca.keyCode))return!0;this.M0();return!1};this.onKeyUp=U=>{U=this.Vd(U);if(U.Ca.keyCode===B.a.JG&&this.wB)return this.wB=!1,this.o_f(this.Tbb,this.currentSelectedRange,!0),this.l1d(),!0;if(this.wB||U.Ca.keyCode===B.a.L1||U.Ca.keyCode===B.a.$Gc||U.Ca.keyCode===B.a.ZGc||[17,16,18,20,37,39,38,40,33,34,9,
13].includes(U.Ca.keyCode)||U.Ca.keyCode===B.a.D5d||U.Ca.keyCode===B.a.z5d||U.Ca.keyCode===B.a.v5d)return!0;this.M0();return!1};this.KR=(U,K)=>{H.h(this.$).Gz&&!this.wdi.includes(K.Wd.command)&&(U=JSON.stringify(K.Wd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${U} `),this.M0())};this.$=P;this.qg=aa}get wdi(){return this.Fbe||(this.Fbe=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,
-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}qHg(P){c.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=H.h(this.$).ha;this.qb=H.h(this.$).qb;this.ribbonCommandInfo=P;this.ZId=w.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?G.d(this.ha.ra.selectedRanges):v.a.clone(this.ha.ra.selectedRanges);this.wPf=this.ha.ra.Ds;this.qPf=this.ha.ra.activeCell.clone();this.qb&&
this.qb.jnd();this.Ss();this.Oj()}dispose(){this.M0();this.QIb=this.ribbonCommandInfo=this.cellFormat=null}Rqb(P){var {BorderFormatManager:aa}=a(814);this.cellFormat={};const U={};this.borderColor=this.borderColor||aa.V8c;var K=m.a.JH(this.borderColor,!1);U.Color=[K,K,K,K];w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.v0a&&(U.ThemeBorderColor=[this.v0a,this.v0a,this.v0a,this.v0a],U.ColorTypeOption=1);K=a(814).BorderFormatManager.u0a;this.borderStyle=this.borderStyle||
aa.borderStyleSolidLine;aa=K[this.borderStyle].lze;U.LineStyle=[aa,aa,aa,aa];this.cellFormat.BorderFormat=U;this.cellFormat.ValidMembers=128;this.cellFormat.Border=P}Ss(){for(const P of H.h(this.$).Ln)z.a.instance.sa(A.a.pointerDown,P.domElement,this.onPointerDown);y.KeyInputManager.instance.sa(A.a.Pb,document.documentElement,this.onKeyDown);y.KeyInputManager.instance.sa(A.a.Gd,document.documentElement,this.onKeyUp)}kej(){for(const P of H.h(this.$).Ln)z.a.instance.sa(A.a.Mj,P.domElement,this.Hh),
z.a.instance.sa(A.a.Rf,P.domElement,this.Qf);z.a.instance.sa(A.a.Rf,document.documentElement,this.Qf);z.a.instance.sa(A.a.NB,document.documentElement,this.Qf);this.Suc=!0}Yv(){try{for(const P of H.h(this.$).Ln)z.a.instance.Ba(A.a.pointerDown,P.domElement,this.onPointerDown);y.KeyInputManager.instance.Ba(A.a.Pb,document.documentElement,this.onKeyDown);y.KeyInputManager.instance.Ba(A.a.Gd,document.documentElement,this.onKeyUp)}catch(P){H.h(this.$).Gz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${P}`)}}l1d(){if(this.Suc)try{this.Suc=
!1;for(const P of H.h(this.$).Ln)z.a.instance.Ba(A.a.Mj,P.domElement,this.Hh),z.a.instance.Ba(A.a.Rf,P.domElement,this.Qf);z.a.instance.Ba(A.a.Rf,document.documentElement,this.Qf);z.a.instance.Ba(A.a.NB,document.documentElement,this.Qf)}catch(P){H.h(this.$).Gz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${P}`)}}Oj(){this.$.va.Wf(this.M0);H.h(this.$).Vb.Zk(this.M0);H.h(this.$).FC(this.M0);this.$.Ka.LGa(this.KR)}gk(){this.$.va.Dg(this.M0);
H.h(this.$).Vb.Uk(this.M0);H.h(this.$).aE(this.M0);this.$.Ka.GAa(this.KR)}o_f(P,aa,U=!1){if(P&&this.hna&&this.bAa)for(P=H.h(this.$).kaa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[P]);P.$$mn();){var K=P.$$cu().cell.getRange();if(U||!aa.contains(K)||1===this.Hua){K=K.toString();const Y=l.a.Ec(this.hna,K);if(Y){const na=l.a.Ec(this.bAa,K);this.setBorders(Y,na);delete this.hna[K];delete this.bAa[K]}}}}setBorders(P,aa){var U=P.cell;const K=U.getRange();U.Qcb();K.right!==this.Tbb.right&&(U=new D.Range(K.top,
K.left-1,K.bottom,K.left-1,!0,!1),H.h(this.$).Da.rs(U).CRa(3));K.bottom!==this.Tbb.bottom&&(U=new D.Range(K.top-1,K.left,K.top-1,K.right,!0,!1),H.h(this.$).Da.rs(U).CRa(1));if(null===aa||void 0===aa?0:aa.Borders.length){U={};let W=0;const X=Array(4),Aa=Array(4);for(var Y=0;4>Y;Y++)X[Y]=1,Aa[Y]=0;for(var na of aa.Borders)aa=na.BorderPosition,X[aa]=na.BorderLineStyle,Y=new T.a(na.Color.Red,na.Color.Green,na.Color.Blue),Aa[aa]=Y.LS(),W|=S.HelperMethods.$4a(na.BorderPosition);U.LineStyle=X;U.Color=Aa;
na={};na.BorderFormat=U;na.Border=W;this.qg.Bzj(P,na,K)}}j3b(P){const aa=new D.Range(Math.max(1,P.top-1),Math.max(1,P.left-1),P.bottom+1,P.right+1,!1,!1);H.h(this.$).NK(aa)||this.ds&&this.ds.qq||(this.ds=I.a.instance.create(()=>{H.h(this.$).Eu(aa,60,"DrawBorderBehavior.BringRangeIntoView")},40,M.a.Xph))}bottomRightCorner(P,aa){return 1048576<=P||16384<=aa?!0:!1}Vd(P){return C.a(this.$).Vd(P)}}Object(t.a)(J,"DrawBorderBehavior",null,[3]);a.d(E,"BorderFormatManager",function(){return L});class L{constructor(P,
aa,U){this.aTb=null;this.gG={};this.RTb=this.Hx=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=P;this.T8d=L.V8c;this.U8d=L.borderStyleSolidLine;this.qg=aa;this.Va=U;w.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.YU=new J(this.$,this.qg);this.CD=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get WIa(){return this.U8d}get W3(){return this.T8d}get Xta(){return this.RTb}get themesManager(){this.Hx||
(this.Hx=this.$.da.Aa(422));return this.Hx}aaf(P,aa){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${aa.command.toString()}`);const U={},K={};var Y=m.a.JH(this.W3,!1);K.Color=[Y,Y,Y,Y];this.CD&&this.Xta&&(K.ThemeBorderColor=[this.Xta,this.Xta,this.Xta,this.Xta],K.ColorTypeOption=1);P=-600086683===aa.command?"OutsideBorders":P[d.a.Kc];K.LineStyle=l.a.Ec(L.EOf,P);K.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${P}`):
(Y=L.u0a[this.WIa].lze,K.LineStyle=[Y,Y,Y,Y],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.WIa}`));Y=l.a.zq(L.LWg,P,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${P}, the border color selected is ${this.W3}`);U.BorderFormat=K;4!==Y&&8!==Y||!this.$.na.displayRtl||(Y=4===Y?8:4);U.ValidMembers=128;U.Border=Y;this.qg.formatCells(-1690267012,
U,aa);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${aa.command.toString()}`);return!0}Dld(P,aa,U){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${P.toString()} is being executed, the previous border color is ${this.W3}`);if(this.CD){if((aa.SqmControlId||"").includes("ThemeColorPicker")){let K,Y;({themeIndex:K,fCa:Y}=this.themesManager.getThemeColor(aa.Color)).returnValue?(this.RTb={},this.Xta.ThemeColorIndex=K,this.Xta.ThemeColorRow=Y):this.RTb=
null}else this.RTb=null;this.YU.v0a=this.Xta}this.T8d=-1803452024===P?L.V8c:aa.Color;this.YU.borderColor=this.W3;this.xQe(U);this.$.af();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${P.toString()} is being executed, the updated border color is ${this.W3}`);return!0}O9h(P){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const aa=this.Va.gq();var U=this.Va.Fc();aa.tc.push(U);const K=this.Va.$A("StyleDashGallery",1,"Size120by20");U.buttons.push(K);U=
L.u0a;for(let Y in U){const na=Y,W=U[Y],X=n.a.instance.ga(W.c3b);K.nu(na,-2118943501,"QueryBorderStyle",W.c3b,na,na,void 0,void 0,X)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");P.MenuItems=aa.NC();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}l8h(P,aa){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.WIa}`);P=P[d.a.Kc];if(L.nvi(P))this.U8d=P,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.WIa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${P}`),!0;this.YU.borderStyle=this.WIa;this.xQe(aa);this.$.af();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.WIa}`);return!0}Hld(P){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${P.command.toString()}`);this.DWc(P,64,this.W3,110,1);return!0}Ild(P){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${P.command.toString()}`);this.DWc(P,112,this.W3,111,2);return!0}oaf(P){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${P.command.toString()}`);this.DWc(P,112,"white",112,3);return!0}T9h(P){this.cyj(this.NWg,P,P.MenuItemId?P.MenuItemId:L.borderStyleSolidLine)}cyj(P,aa,U){U in P?(P=P[U],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${U}`),
this.eyj(aa,P)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${U}' in BorderLineStyleButtons dictionary`)}d$h(P,aa){const U=P[d.a.Kc];return"DrawBorder"===U?this.Hld(aa):"DrawBorderGrid"===U?this.Ild(aa):"EraseBorder"===U?this.oaf(aa):this.aaf(P,aa)}OUf(){this.aTb||this.PXg()}HPh(){return new u(this)}get NWg(){this.OUf();return this.aTb}PXg(){this.aTb={};let P=0;const aa=L.u0a;for(let U in aa){const K=aa[U],Y=K.mze;n.a.instance.ga(K.c3b);this.aTb[Y]=Y;this.Jcb(Y,
()=>appChrome.buildBorderStyleIconNew(K.FNj,K.width,K.QLi,K.lineHeight,K.jzi));P++}}Jcb(P,aa){if(!(P in this.gG)){const U={};aa=aa();U[P]=aa;appChrome.api.registerIconProvider(()=>U);this.gG[P]=!0}return P}eyj(P,aa){P.MenuItemId&&(P[b.a.On]=P.MenuItemId===this.WIa,P[e.a.Icon]=aa)}DWc(P,aa,U,K,Y){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.C3g(P,Y)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.YU.M0()):(H.h(this.$).Gz&&this.YU.M0(),h.a.current&&(K=String.format(f.a.cua,h.a.current.io(K)),H.h(this.$).yf.hm(K)),this.YU.e3b=aa,this.YU.borderColor=U,H.h(this.$).Gz=!0,this.YU.qHg(P),this.YU.Hua=Y)}xQe(P){if(P)switch(this.YU.Hua){case 2:this.Ild(P);break;default:this.Hld(P)}}C3g(P,aa){return this.YU.Hua===aa&&-236759591!==P.command&&-2118943501!==P.command?!0:!1}static get u0a(){return L.d7d||(L.d7d={["BorderStyleSolidLine"]:x.NXg(),["BorderStyleDashedLine"]:x.JXg(),["BorderStyleDottedLine"]:x.KXg(),
["BorderStyleMediumLine"]:x.MXg(),["BorderStyleThickLine"]:x.OXg(),["BorderStyleDoubleLine"]:x.LXg()})}static get LWg(){return L.c7d||(L.c7d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get EOf(){return L.Gie||
(L.Gie={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:L.zkh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static nvi(P){return P?P in L.EOf||P in L.u0a:!1}}L.c7d=null;L.d7d=null;L.Gie=null;L.V8c="black";L.borderStyleSolidLine="BorderStyleSolidLine";L.zkh=[1,1,1,1];Object(t.a)(L,"BorderFormatManager",null,[634])},839:function(t,E,a){a.d(E,"a",function(){return c});t=a(0);class c{}c.edit="Edit";c.clipboard=
"Clipboard";c.copy="Copy";c.color="Color";c.TUg="AutoFill";c.dqj="RowOperations";c.R6g="ColumnOperations";c.O3j="ViewModeRowOperations";c.N3j="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.kCj="ShapeStyle";c.IIh="FloatingObjectClipboard";c.CNf="PivotTableCopyDelete";c.ENf="PivotTableFieldListActions";c.yCe="CellFloatie";c.gCj="ShapeFloatie";c.contextMenu="ContextMenu";c.D7h="GridContextMenu";c.p4i="PivotTableContextMenu";c.JIh="FloatingObjectContextMenu";c.G2g=
"CellRTEFloatie";c.K7f="ShapeRTEFloatie";Object(t.a)(c,"FloatieGroupIdentifiers",null,[])},840:function(t,E,a){a.d(E,"a",function(){return l});t=a(0);var c=a(89),b=a(224),e=a(14),f=a(240);E=a(238);var d=a(12),h=a(71),m=a(21);class l extends E.a{constructor(w,n,x){super(n);this.ymc=this.zR=!1;this.Hn=this._selectedRowListBox=this.KOa=null;this.uFf=r=>this.onItemClick(r);this.DEd=r=>{h.g(r.Ca);this.raiseEvent(l.c6a);this.raiseEvent(l.tSd);return!0};this.onScroll=r=>{h.g(r);this.hKd();this.raiseEvent(l.c6a)};
this.onBlur=r=>{h.g(r);this.hKd()};this.onPointerDown=()=>{this.hKd();this.raiseEvent(l.c6a);this.raiseEvent(l.IQa);return!1};this.JGb=r=>{const u=r.Ca;if(u.button===Sys.UI.MouseButton.leftButton||u.button===Sys.UI.MouseButton.rightButton||u.type.includes("touch"))this.Rj=this.Jcc(u),this.onPointerDown(r);this.raiseEvent(l.tvd);return!1};this.jb=w;this.ODb=x;this.RBa(!0)}f$(w){this.get_events().addHandler(l.c6a,w)}Wda(w){this.get_events().removeHandler(l.c6a,w)}M0b(w){this.get_events().addHandler(l.eod,
w)}Hvc(w){this.get_events().removeHandler(l.eod,w)}dpb(w){this.get_events().addHandler(l.tSd,w)}KKb(w){this.get_events().removeHandler(l.tSd,w)}bpb(w){this.get_events().addHandler(l.IQa,w)}GKb(w){this.get_events().removeHandler(l.IQa,w)}kYc(w){this.get_events().addHandler(l.tvd,w)}nNd(w){this.get_events().removeHandler(l.tvd,w)}get Rj(){return this._selectedRowListBox}set Rj(w){this.kCa(this._selectedRowListBox);w?(this._selectedRowListBox=w,this.kCa(this._selectedRowListBox),this.Rxc(w)):this._selectedRowListBox=
null}get iW(){return this.ODb.ListCellClass}get k6(){return this.ODb.ListTableClass}get rI(){return 8}get KEb(){return 5}get xmc(){return 24}get wmc(){return 35}get Lf(){return this.domElement}get $(){return this.jb}dispose(){this.d8(!1);this.RBa(!1);c.a.rc([this.KOa]);this.KOa=null;super.dispose()}Jcc(w){return d.DOMElementExtensions.Ehd(w.target,"tr",!0)}BB(w){if(w){if(!this.Rj){var n=this.Hn;if(!n||!n.rows.length)return;this.Rj=n.rows[0];0<w?w--:w++}n=this.Rj;for(let x=0,r=Math.abs(w);x<r;x++)if(0>
w){if(!n.previousSibling)break;n=n.previousSibling}else{if(!n.nextSibling)break;n=n.nextSibling}n&&(this.Rj=n)}}Iob(w,n){d.DOMElementExtensions.toggleCssClass(w,this.ODb.ListTableClassInTouch,n)}d8(w){const n=this.Hn;n&&(w&&!this.ymc?(b.a.instance.sa(e.a.click,n,this.uFf),b.a.instance.sa(e.a.Dk,n,this.DEd),f.a.instance.sa(e.a.pointerDown,n,this.JGb),this.ymc=!0):this.ymc&&(b.a.instance.Ba(e.a.click,n,this.uFf),b.a.instance.Ba(e.a.Dk,n,this.DEd),f.a.instance.Ba(e.a.pointerDown,n,this.JGb),this.ymc=
!1))}kCa(w){let n=null;w&&(n=d.DOMElementExtensions.nk(w,this.ODb.ListCellClass))&&n.classList.toggle(this.ODb.ListCellSelectedClass);return n}RBa(w){this.Lf&&(w&&!this.zR?(this.KOa=this.Be.oe(this.Lf),this.KOa.la("scroll",this.onScroll),this.KOa.la("blur",this.onBlur),f.a.instance.sa(e.a.pointerDown,this.domElement,this.onPointerDown),this.zR=!0):this.zR&&(c.a.Ia(this.KOa),this.KOa=null,f.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.zR=!1))}onItemClick(w){return this.DEd(w)}Rxc(w){if(w){var n=
w.offsetTop,x=this.Lf.scrollTop;n<x?this.k2f(!0):n+w.offsetHeight>x+this.Lf.clientHeight&&this.k2f(!1)}}k2f(w){this.Lf.scrollTop=w?this.Rj.offsetTop:this.Rj.offsetTop+this.Rj.offsetHeight-this.Lf.clientHeight}hKd(){m.h(this.$).gb&&this.raiseEvent(l.eod)}}l.c6a="GotFocus";l.eod="IgnoreBlur";l.tSd="SetCell";l.IQa="PointerDown";l.tvd="ItemPointerDown";Object(t.a)(l,"ListBox",E.a,[661,3])},911:function(t,E,a){a.d(E,"a",function(){return b});t=a(0);var c=a(22);class b{compare(e,f){return c.a.compare(e,
f,!0)}}Object(t.a)(b,"IgnoreCaseComparer",null,[421])},912:function(t,E,a){a.d(E,"a",function(){return f});t=a(0);var c=a(24),b=a(11),e=a(175);class f{constructor(d,h){this.Da=d;this.d4a=h}TMb(d,h,m){const l=h.Border;h=h.BorderFormat;let w=0,n=!1;if(0===l)d.cell.Qcb(),this.cKb(d.cell.getRange());else{for(let x=0;3>=x;x++)f.vDj(d,m,x,l)&&(w|=b.HelperMethods.$4a(x),this.G1d(d.cell.getRange(),x,h),n=!0);b.HelperMethods.nR(l,16)&&!e.c(d,0,m)&&(w|=2,this.G1d(d.cell.getRange(),0,h),n=!0);b.HelperMethods.nR(l,
32)&&!e.c(d,2,m)&&(w|=4,this.G1d(d.cell.getRange(),2,h),n=!0);n&&(m=d.cell.sy.nf,b.HelperMethods.nR(w,2)&&this.X8f(d,m,0)&&(w&=-3),b.HelperMethods.nR(w,1)&&this.W8f(d,m,1)&&(w&=-2),b.HelperMethods.nR(w,4)&&this.X8f(d,m,2)&&(w&=-5),b.HelperMethods.nR(w,8)&&this.W8f(d,m,3)&&(w&=-9),d.cell.setBorders(h,w,!1))}}SQ(d,h){d=f.k1e(d,h);return d.Mz?(d=this.Da.Wja(d))&&d.length?d:null:null}cKb(d){for(let m=0;3>=m;m++){var h=f.k1e(d,m);if(!h.Mz)continue;h=this.Da.Wja(h);if(!h||!h.length)continue;const l=f.G6e(m);
for(let w=0;w<h.length;w++)h[w].CRa(l)}}G1d(d,h,m){if(d=this.SQ(d,h)){var l=f.G6e(h),w=b.HelperMethods.$4a(l);for(let n=0;n<d.length;n++){const x=d[n];this.Ali(x,l)&&f.setBorders(x,m,w,h,l)}}}Ali(d,h){const m=d.sy.nf;var l=d.getRange();l=this.SQ(l,h);let w=!1,n=!1,x=!1,r=!1;l&&(w=f.d8a(l,!0),n=f.d8a(l,!1),r=f.Fsd(l),x=1===l.length?!0:!1);switch(h){case 0:return f.Oki(d,m,r,n,x);case 1:return f.Lki(d,m,r,w,x);case 2:return f.Mki(d,m,r,w,x);case 3:return f.Nki(d,m,r,n,x)}return!1}X8f(d,h,m){if(!d.cell.QF)return!1;
const l=d.range,w=this.SQ(l,m),n=e.c(d,m,h);let x=!1;h=0===m?l.top<h.top:l.left<h.left;!f.BBb(d.cell)&&w&&1!==w.length&&(x=(0===m?f.d8a(w,!0):f.d8a(w,!1))?!1:!0);return!n&&x||h?!0:!1}W8f(d,h,m){const l=d.cell,w=this.SQ(l.getRange(),m);d=e.c(d,m,h);h=!1;if(w){const x=f.d8a(w,!0);var n=f.d8a(w,!1);const r=x&&!n;n=n&&!x;1!==m||f.DCb(l)?3!==m||f.rBb(l)||f.CDj(l,w,n,r)&&(h=!0):f.BDj(l,w,x,n)&&(h=!0)}return!d&&h||f.BBb(l)?!0:!1}static IXg(d,h,m){const l={};l.LineStyle=Array(4);l.LineStyle[m]=d.LineStyle[h];
l.Color=Array(4);l.Color[m]=d.Color[h];return l}static Xhf(d,h,m,l,w){return b.HelperMethods.nR(d,w)&&e.c(h,m,l)}static vDj(d,h,m,l){return f.Xhf(l,d,m,h,b.HelperMethods.$4a(m))||f.Xhf(l,d,m,h,64)||112===l}static setBorders(d,h,m,l,w){h=f.IXg(h,l,w);d.setBorders(h,m,!1)}static k1e(d,h){switch(h){case 0:return new c.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new c.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new c.Range(d.bottom+1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new c.Range(d.top,
d.right+1,d.bottom,d.right+1,!1,!1)}return d}static G6e(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static d8a(d,h){for(let m=0;m<d.length;m++){const l=d[m];if(l.QF)return h?f.rBb(l):f.DCb(l)}return!1}static BBb(d){const h=d.sy.nf,m=d.getRange();return d.QF&&(m.top<h.top||m.bottom>h.bottom||m.left<h.left||m.right>h.right)?!0:!1}static Fsd(d){for(let h=0;h<d.length;h++)if(f.BBb(d[h]))return!0;return!1}static BDj(d,h,m,l){if(!d.QF){if(!m||f.Fsd(h))return!0}else if(f.rBb(d)&&
(1===h.length&&f.bTg(d,h[0])||!m))return!0;return l}static CDj(d,h,m,l){if(!d.QF){if(!m||f.Fsd(h))return!0}else if(f.DCb(d)&&(1===h.length&&f.cTg(d,h[0])||!m))return!0;return d.Gla||l}static Oki(d,h,m,l,w){const n=d.getRange();return f.rBb(d)?f.BBb(d)||w:h.top===n.top||!l||m}static Lki(d,h,m,l,w){const n=d.getRange();return f.rBb(d)?h.bottom===n.bottom&&w:l&&!m||h.bottom===n.bottom}static Mki(d,h,m,l,w){const n=d.getRange();return f.DCb(d)?f.BBb(d)||w:h.left===n.left||!l||m}static Nki(d,h,m,l,w){const n=
d.getRange();return d.Gla?!1:f.DCb(d)?h.right===n.right&&w:l&&!m||h.right===n.right}static rBb(d){return 0<d.getRange().right-d.getRange().left}static DCb(d){return 0<d.getRange().bottom-d.getRange().top}static cTg(d,h){d=d.getRange();h=h.getRange();return d.top===h.top&&d.bottom===h.bottom}static bTg(d,h){d=d.getRange();h=h.getRange();return d.left===h.left&&d.right===h.right}}Object(t.a)(f,"BorderModelAccessorHelper",null,[])},914:function(t,E,a){a.d(E,"a",function(){return d});t=a(0);var c=a(89);
E=a(95);var b=a(47),e=a(46),f=a(71);class d extends E.a{constructor(h,m){super(m.textBox.domElement);this.K_c=null;this.kNi=()=>{this.gDd()};this.jDf=(l,w)=>{this.jg(l,w)};this.nDf=(l,w)=>{this.Th(l,w)};this.jb=h;this.oJ=m;m.k3&&(m.k3.add(this),m.Zk(this.nDf),m.Qm(this.jDf))}get $(){return this.jb}get eb(){return this.oJ}dispose(){const h=this.oJ;if(null===h||void 0===h?0:h.k3)h.k3.remove(this),h.Uk(this.nDf),h.fm(this.jDf);c.a.Ia(this.K_c);this.oJ=null;super.dispose()}Yh(h,m){switch(m){case -1470715894:case -1231471547:this.nZ(!1);
break;default:if(this.KJd(h,m))return f.g(h),!0;d.Jqi(m)||this.nZ(!1)}return!1}nZ(){c.a.Ia(this.K_c);this.K_c=b.a.instance.create(this.kNi,10,e.a.qzi)}Th(){this.nZ(!1)}static Jqi(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(t.a)(d,"ListAutoCompleteBehavior",E.a,[688,3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/310b6757cd76f27f2046c64d07466eed/EwaDSEsNext.kpae.js.map